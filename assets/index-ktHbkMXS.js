(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const y of m.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&a(y)}).observe(document,{childList:!0,subtree:!0});function t(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function a(d){if(d.ep)return;d.ep=!0;const m=t(d);fetch(d.href,m)}})();function S_(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Vb={exports:{}},ky={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v2;function _M(){if(v2)return ky;v2=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,d,m){var y=null;if(m!==void 0&&(y=""+m),d.key!==void 0&&(y=""+d.key),"key"in d){m={};for(var c in d)c!=="key"&&(m[c]=d[c])}else m=d;return d=m.ref,{$$typeof:r,type:a,key:y,ref:d!==void 0?d:null,props:m}}return ky.Fragment=e,ky.jsx=t,ky.jsxs=t,ky}var b2;function vM(){return b2||(b2=1,Vb.exports=_M()),Vb.exports}var He=vM(),Fb={exports:{}},Zn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x2;function bM(){if(x2)return Zn;x2=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),y=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),X=Symbol.iterator;function G(ze){return ze===null||typeof ze!="object"?null:(ze=X&&ze[X]||ze["@@iterator"],typeof ze=="function"?ze:null)}var W={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ie=Object.assign,Ie={};function Re(ze,xt,It){this.props=ze,this.context=xt,this.refs=Ie,this.updater=It||W}Re.prototype.isReactComponent={},Re.prototype.setState=function(ze,xt){if(typeof ze!="object"&&typeof ze!="function"&&ze!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ze,xt,"setState")},Re.prototype.forceUpdate=function(ze){this.updater.enqueueForceUpdate(this,ze,"forceUpdate")};function Oe(){}Oe.prototype=Re.prototype;function Ke(ze,xt,It){this.props=ze,this.context=xt,this.refs=Ie,this.updater=It||W}var mt=Ke.prototype=new Oe;mt.constructor=Ke,ie(mt,Re.prototype),mt.isPureReactComponent=!0;var qe=Array.isArray,Fe={H:null,A:null,T:null,S:null,V:null},We=Object.prototype.hasOwnProperty;function pe(ze,xt,It,Rt,Yt,wn){return It=wn.ref,{$$typeof:r,type:ze,key:xt,ref:It!==void 0?It:null,props:wn}}function oe(ze,xt){return pe(ze.type,xt,void 0,void 0,void 0,ze.props)}function me(ze){return typeof ze=="object"&&ze!==null&&ze.$$typeof===r}function be(ze){var xt={"=":"=0",":":"=2"};return"$"+ze.replace(/[=:]/g,function(It){return xt[It]})}var Ce=/\/+/g;function Ve(ze,xt){return typeof ze=="object"&&ze!==null&&ze.key!=null?be(""+ze.key):xt.toString(36)}function Ee(){}function Yn(ze){switch(ze.status){case"fulfilled":return ze.value;case"rejected":throw ze.reason;default:switch(typeof ze.status=="string"?ze.then(Ee,Ee):(ze.status="pending",ze.then(function(xt){ze.status==="pending"&&(ze.status="fulfilled",ze.value=xt)},function(xt){ze.status==="pending"&&(ze.status="rejected",ze.reason=xt)})),ze.status){case"fulfilled":return ze.value;case"rejected":throw ze.reason}}throw ze}function jn(ze,xt,It,Rt,Yt){var wn=typeof ze;(wn==="undefined"||wn==="boolean")&&(ze=null);var fn=!1;if(ze===null)fn=!0;else switch(wn){case"bigint":case"string":case"number":fn=!0;break;case"object":switch(ze.$$typeof){case r:case e:fn=!0;break;case B:return fn=ze._init,jn(fn(ze._payload),xt,It,Rt,Yt)}}if(fn)return Yt=Yt(ze),fn=Rt===""?"."+Ve(ze,0):Rt,qe(Yt)?(It="",fn!=null&&(It=fn.replace(Ce,"$&/")+"/"),jn(Yt,xt,It,"",function(Ir){return Ir})):Yt!=null&&(me(Yt)&&(Yt=oe(Yt,It+(Yt.key==null||ze&&ze.key===Yt.key?"":(""+Yt.key).replace(Ce,"$&/")+"/")+fn)),xt.push(Yt)),1;fn=0;var ii=Rt===""?".":Rt+":";if(qe(ze))for(var wr=0;wr<ze.length;wr++)Rt=ze[wr],wn=ii+Ve(Rt,wr),fn+=jn(Rt,xt,It,wn,Yt);else if(wr=G(ze),typeof wr=="function")for(ze=wr.call(ze),wr=0;!(Rt=ze.next()).done;)Rt=Rt.value,wn=ii+Ve(Rt,wr++),fn+=jn(Rt,xt,It,wn,Yt);else if(wn==="object"){if(typeof ze.then=="function")return jn(Yn(ze),xt,It,Rt,Yt);throw xt=String(ze),Error("Objects are not valid as a React child (found: "+(xt==="[object Object]"?"object with keys {"+Object.keys(ze).join(", ")+"}":xt)+"). If you meant to render a collection of children, use an array instead.")}return fn}function gt(ze,xt,It){if(ze==null)return ze;var Rt=[],Yt=0;return jn(ze,Rt,"","",function(wn){return xt.call(It,wn,Yt++)}),Rt}function Bt(ze){if(ze._status===-1){var xt=ze._result;xt=xt(),xt.then(function(It){(ze._status===0||ze._status===-1)&&(ze._status=1,ze._result=It)},function(It){(ze._status===0||ze._status===-1)&&(ze._status=2,ze._result=It)}),ze._status===-1&&(ze._status=0,ze._result=xt)}if(ze._status===1)return ze._result.default;throw ze._result}var nn=typeof reportError=="function"?reportError:function(ze){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var xt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ze=="object"&&ze!==null&&typeof ze.message=="string"?String(ze.message):String(ze),error:ze});if(!window.dispatchEvent(xt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ze);return}console.error(ze)};function Kn(){}return Zn.Children={map:gt,forEach:function(ze,xt,It){gt(ze,function(){xt.apply(this,arguments)},It)},count:function(ze){var xt=0;return gt(ze,function(){xt++}),xt},toArray:function(ze){return gt(ze,function(xt){return xt})||[]},only:function(ze){if(!me(ze))throw Error("React.Children.only expected to receive a single React element child.");return ze}},Zn.Component=Re,Zn.Fragment=t,Zn.Profiler=d,Zn.PureComponent=Ke,Zn.StrictMode=a,Zn.Suspense=P,Zn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Fe,Zn.__COMPILER_RUNTIME={__proto__:null,c:function(ze){return Fe.H.useMemoCache(ze)}},Zn.cache=function(ze){return function(){return ze.apply(null,arguments)}},Zn.cloneElement=function(ze,xt,It){if(ze==null)throw Error("The argument must be a React element, but you passed "+ze+".");var Rt=ie({},ze.props),Yt=ze.key,wn=void 0;if(xt!=null)for(fn in xt.ref!==void 0&&(wn=void 0),xt.key!==void 0&&(Yt=""+xt.key),xt)!We.call(xt,fn)||fn==="key"||fn==="__self"||fn==="__source"||fn==="ref"&&xt.ref===void 0||(Rt[fn]=xt[fn]);var fn=arguments.length-2;if(fn===1)Rt.children=It;else if(1<fn){for(var ii=Array(fn),wr=0;wr<fn;wr++)ii[wr]=arguments[wr+2];Rt.children=ii}return pe(ze.type,Yt,void 0,void 0,wn,Rt)},Zn.createContext=function(ze){return ze={$$typeof:y,_currentValue:ze,_currentValue2:ze,_threadCount:0,Provider:null,Consumer:null},ze.Provider=ze,ze.Consumer={$$typeof:m,_context:ze},ze},Zn.createElement=function(ze,xt,It){var Rt,Yt={},wn=null;if(xt!=null)for(Rt in xt.key!==void 0&&(wn=""+xt.key),xt)We.call(xt,Rt)&&Rt!=="key"&&Rt!=="__self"&&Rt!=="__source"&&(Yt[Rt]=xt[Rt]);var fn=arguments.length-2;if(fn===1)Yt.children=It;else if(1<fn){for(var ii=Array(fn),wr=0;wr<fn;wr++)ii[wr]=arguments[wr+2];Yt.children=ii}if(ze&&ze.defaultProps)for(Rt in fn=ze.defaultProps,fn)Yt[Rt]===void 0&&(Yt[Rt]=fn[Rt]);return pe(ze,wn,void 0,void 0,null,Yt)},Zn.createRef=function(){return{current:null}},Zn.forwardRef=function(ze){return{$$typeof:c,render:ze}},Zn.isValidElement=me,Zn.lazy=function(ze){return{$$typeof:B,_payload:{_status:-1,_result:ze},_init:Bt}},Zn.memo=function(ze,xt){return{$$typeof:k,type:ze,compare:xt===void 0?null:xt}},Zn.startTransition=function(ze){var xt=Fe.T,It={};Fe.T=It;try{var Rt=ze(),Yt=Fe.S;Yt!==null&&Yt(It,Rt),typeof Rt=="object"&&Rt!==null&&typeof Rt.then=="function"&&Rt.then(Kn,nn)}catch(wn){nn(wn)}finally{Fe.T=xt}},Zn.unstable_useCacheRefresh=function(){return Fe.H.useCacheRefresh()},Zn.use=function(ze){return Fe.H.use(ze)},Zn.useActionState=function(ze,xt,It){return Fe.H.useActionState(ze,xt,It)},Zn.useCallback=function(ze,xt){return Fe.H.useCallback(ze,xt)},Zn.useContext=function(ze){return Fe.H.useContext(ze)},Zn.useDebugValue=function(){},Zn.useDeferredValue=function(ze,xt){return Fe.H.useDeferredValue(ze,xt)},Zn.useEffect=function(ze,xt,It){var Rt=Fe.H;if(typeof It=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Rt.useEffect(ze,xt)},Zn.useId=function(){return Fe.H.useId()},Zn.useImperativeHandle=function(ze,xt,It){return Fe.H.useImperativeHandle(ze,xt,It)},Zn.useInsertionEffect=function(ze,xt){return Fe.H.useInsertionEffect(ze,xt)},Zn.useLayoutEffect=function(ze,xt){return Fe.H.useLayoutEffect(ze,xt)},Zn.useMemo=function(ze,xt){return Fe.H.useMemo(ze,xt)},Zn.useOptimistic=function(ze,xt){return Fe.H.useOptimistic(ze,xt)},Zn.useReducer=function(ze,xt,It){return Fe.H.useReducer(ze,xt,It)},Zn.useRef=function(ze){return Fe.H.useRef(ze)},Zn.useState=function(ze){return Fe.H.useState(ze)},Zn.useSyncExternalStore=function(ze,xt,It){return Fe.H.useSyncExternalStore(ze,xt,It)},Zn.useTransition=function(){return Fe.H.useTransition()},Zn.version="19.1.0",Zn}var w2;function D1(){return w2||(w2=1,Fb.exports=bM()),Fb.exports}var ct=D1();const L1=S_(ct);var Ub={exports:{}},Dy={},jb={exports:{}},$b={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T2;function xM(){return T2||(T2=1,function(r){function e(gt,Bt){var nn=gt.length;gt.push(Bt);e:for(;0<nn;){var Kn=nn-1>>>1,ze=gt[Kn];if(0<d(ze,Bt))gt[Kn]=Bt,gt[nn]=ze,nn=Kn;else break e}}function t(gt){return gt.length===0?null:gt[0]}function a(gt){if(gt.length===0)return null;var Bt=gt[0],nn=gt.pop();if(nn!==Bt){gt[0]=nn;e:for(var Kn=0,ze=gt.length,xt=ze>>>1;Kn<xt;){var It=2*(Kn+1)-1,Rt=gt[It],Yt=It+1,wn=gt[Yt];if(0>d(Rt,nn))Yt<ze&&0>d(wn,Rt)?(gt[Kn]=wn,gt[Yt]=nn,Kn=Yt):(gt[Kn]=Rt,gt[It]=nn,Kn=It);else if(Yt<ze&&0>d(wn,nn))gt[Kn]=wn,gt[Yt]=nn,Kn=Yt;else break e}}return Bt}function d(gt,Bt){var nn=gt.sortIndex-Bt.sortIndex;return nn!==0?nn:gt.id-Bt.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;r.unstable_now=function(){return m.now()}}else{var y=Date,c=y.now();r.unstable_now=function(){return y.now()-c}}var P=[],k=[],B=1,X=null,G=3,W=!1,ie=!1,Ie=!1,Re=!1,Oe=typeof setTimeout=="function"?setTimeout:null,Ke=typeof clearTimeout=="function"?clearTimeout:null,mt=typeof setImmediate<"u"?setImmediate:null;function qe(gt){for(var Bt=t(k);Bt!==null;){if(Bt.callback===null)a(k);else if(Bt.startTime<=gt)a(k),Bt.sortIndex=Bt.expirationTime,e(P,Bt);else break;Bt=t(k)}}function Fe(gt){if(Ie=!1,qe(gt),!ie)if(t(P)!==null)ie=!0,We||(We=!0,Ve());else{var Bt=t(k);Bt!==null&&jn(Fe,Bt.startTime-gt)}}var We=!1,pe=-1,oe=5,me=-1;function be(){return Re?!0:!(r.unstable_now()-me<oe)}function Ce(){if(Re=!1,We){var gt=r.unstable_now();me=gt;var Bt=!0;try{e:{ie=!1,Ie&&(Ie=!1,Ke(pe),pe=-1),W=!0;var nn=G;try{t:{for(qe(gt),X=t(P);X!==null&&!(X.expirationTime>gt&&be());){var Kn=X.callback;if(typeof Kn=="function"){X.callback=null,G=X.priorityLevel;var ze=Kn(X.expirationTime<=gt);if(gt=r.unstable_now(),typeof ze=="function"){X.callback=ze,qe(gt),Bt=!0;break t}X===t(P)&&a(P),qe(gt)}else a(P);X=t(P)}if(X!==null)Bt=!0;else{var xt=t(k);xt!==null&&jn(Fe,xt.startTime-gt),Bt=!1}}break e}finally{X=null,G=nn,W=!1}Bt=void 0}}finally{Bt?Ve():We=!1}}}var Ve;if(typeof mt=="function")Ve=function(){mt(Ce)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Yn=Ee.port2;Ee.port1.onmessage=Ce,Ve=function(){Yn.postMessage(null)}}else Ve=function(){Oe(Ce,0)};function jn(gt,Bt){pe=Oe(function(){gt(r.unstable_now())},Bt)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(gt){gt.callback=null},r.unstable_forceFrameRate=function(gt){0>gt||125<gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):oe=0<gt?Math.floor(1e3/gt):5},r.unstable_getCurrentPriorityLevel=function(){return G},r.unstable_next=function(gt){switch(G){case 1:case 2:case 3:var Bt=3;break;default:Bt=G}var nn=G;G=Bt;try{return gt()}finally{G=nn}},r.unstable_requestPaint=function(){Re=!0},r.unstable_runWithPriority=function(gt,Bt){switch(gt){case 1:case 2:case 3:case 4:case 5:break;default:gt=3}var nn=G;G=gt;try{return Bt()}finally{G=nn}},r.unstable_scheduleCallback=function(gt,Bt,nn){var Kn=r.unstable_now();switch(typeof nn=="object"&&nn!==null?(nn=nn.delay,nn=typeof nn=="number"&&0<nn?Kn+nn:Kn):nn=Kn,gt){case 1:var ze=-1;break;case 2:ze=250;break;case 5:ze=1073741823;break;case 4:ze=1e4;break;default:ze=5e3}return ze=nn+ze,gt={id:B++,callback:Bt,priorityLevel:gt,startTime:nn,expirationTime:ze,sortIndex:-1},nn>Kn?(gt.sortIndex=nn,e(k,gt),t(P)===null&&gt===t(k)&&(Ie?(Ke(pe),pe=-1):Ie=!0,jn(Fe,nn-Kn))):(gt.sortIndex=ze,e(P,gt),ie||W||(ie=!0,We||(We=!0,Ve()))),gt},r.unstable_shouldYield=be,r.unstable_wrapCallback=function(gt){var Bt=G;return function(){var nn=G;G=Bt;try{return gt.apply(this,arguments)}finally{G=nn}}}}($b)),$b}var S2;function wM(){return S2||(S2=1,jb.exports=xM()),jb.exports}var qb={exports:{}},Ys={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E2;function TM(){if(E2)return Ys;E2=1;var r=D1();function e(P){var k="https://react.dev/errors/"+P;if(1<arguments.length){k+="?args[]="+encodeURIComponent(arguments[1]);for(var B=2;B<arguments.length;B++)k+="&args[]="+encodeURIComponent(arguments[B])}return"Minified React error #"+P+"; visit "+k+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},d=Symbol.for("react.portal");function m(P,k,B){var X=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:X==null?null:""+X,children:P,containerInfo:k,implementation:B}}var y=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(P,k){if(P==="font")return"";if(typeof k=="string")return k==="use-credentials"?k:""}return Ys.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Ys.createPortal=function(P,k){var B=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!k||k.nodeType!==1&&k.nodeType!==9&&k.nodeType!==11)throw Error(e(299));return m(P,k,null,B)},Ys.flushSync=function(P){var k=y.T,B=a.p;try{if(y.T=null,a.p=2,P)return P()}finally{y.T=k,a.p=B,a.d.f()}},Ys.preconnect=function(P,k){typeof P=="string"&&(k?(k=k.crossOrigin,k=typeof k=="string"?k==="use-credentials"?k:"":void 0):k=null,a.d.C(P,k))},Ys.prefetchDNS=function(P){typeof P=="string"&&a.d.D(P)},Ys.preinit=function(P,k){if(typeof P=="string"&&k&&typeof k.as=="string"){var B=k.as,X=c(B,k.crossOrigin),G=typeof k.integrity=="string"?k.integrity:void 0,W=typeof k.fetchPriority=="string"?k.fetchPriority:void 0;B==="style"?a.d.S(P,typeof k.precedence=="string"?k.precedence:void 0,{crossOrigin:X,integrity:G,fetchPriority:W}):B==="script"&&a.d.X(P,{crossOrigin:X,integrity:G,fetchPriority:W,nonce:typeof k.nonce=="string"?k.nonce:void 0})}},Ys.preinitModule=function(P,k){if(typeof P=="string")if(typeof k=="object"&&k!==null){if(k.as==null||k.as==="script"){var B=c(k.as,k.crossOrigin);a.d.M(P,{crossOrigin:B,integrity:typeof k.integrity=="string"?k.integrity:void 0,nonce:typeof k.nonce=="string"?k.nonce:void 0})}}else k==null&&a.d.M(P)},Ys.preload=function(P,k){if(typeof P=="string"&&typeof k=="object"&&k!==null&&typeof k.as=="string"){var B=k.as,X=c(B,k.crossOrigin);a.d.L(P,B,{crossOrigin:X,integrity:typeof k.integrity=="string"?k.integrity:void 0,nonce:typeof k.nonce=="string"?k.nonce:void 0,type:typeof k.type=="string"?k.type:void 0,fetchPriority:typeof k.fetchPriority=="string"?k.fetchPriority:void 0,referrerPolicy:typeof k.referrerPolicy=="string"?k.referrerPolicy:void 0,imageSrcSet:typeof k.imageSrcSet=="string"?k.imageSrcSet:void 0,imageSizes:typeof k.imageSizes=="string"?k.imageSizes:void 0,media:typeof k.media=="string"?k.media:void 0})}},Ys.preloadModule=function(P,k){if(typeof P=="string")if(k){var B=c(k.as,k.crossOrigin);a.d.m(P,{as:typeof k.as=="string"&&k.as!=="script"?k.as:void 0,crossOrigin:B,integrity:typeof k.integrity=="string"?k.integrity:void 0})}else a.d.m(P)},Ys.requestFormReset=function(P){a.d.r(P)},Ys.unstable_batchedUpdates=function(P,k){return P(k)},Ys.useFormState=function(P,k,B){return y.H.useFormState(P,k,B)},Ys.useFormStatus=function(){return y.H.useHostTransitionStatus()},Ys.version="19.1.0",Ys}var A2;function SM(){if(A2)return qb.exports;A2=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),qb.exports=TM(),qb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I2;function EM(){if(I2)return Dy;I2=1;var r=wM(),e=D1(),t=SM();function a(s){var h="https://react.dev/errors/"+s;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+s+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function m(s){var h=s,g=s;if(s.alternate)for(;h.return;)h=h.return;else{s=h;do h=s,(h.flags&4098)!==0&&(g=h.return),s=h.return;while(s)}return h.tag===3?g:null}function y(s){if(s.tag===13){var h=s.memoizedState;if(h===null&&(s=s.alternate,s!==null&&(h=s.memoizedState)),h!==null)return h.dehydrated}return null}function c(s){if(m(s)!==s)throw Error(a(188))}function P(s){var h=s.alternate;if(!h){if(h=m(s),h===null)throw Error(a(188));return h!==s?null:s}for(var g=s,x=h;;){var C=g.return;if(C===null)break;var L=C.alternate;if(L===null){if(x=C.return,x!==null){g=x;continue}break}if(C.child===L.child){for(L=C.child;L;){if(L===g)return c(C),s;if(L===x)return c(C),h;L=L.sibling}throw Error(a(188))}if(g.return!==x.return)g=C,x=L;else{for(var Q=!1,ae=C.child;ae;){if(ae===g){Q=!0,g=C,x=L;break}if(ae===x){Q=!0,x=C,g=L;break}ae=ae.sibling}if(!Q){for(ae=L.child;ae;){if(ae===g){Q=!0,g=L,x=C;break}if(ae===x){Q=!0,x=L,g=C;break}ae=ae.sibling}if(!Q)throw Error(a(189))}}if(g.alternate!==x)throw Error(a(190))}if(g.tag!==3)throw Error(a(188));return g.stateNode.current===g?s:h}function k(s){var h=s.tag;if(h===5||h===26||h===27||h===6)return s;for(s=s.child;s!==null;){if(h=k(s),h!==null)return h;s=s.sibling}return null}var B=Object.assign,X=Symbol.for("react.element"),G=Symbol.for("react.transitional.element"),W=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),Ie=Symbol.for("react.strict_mode"),Re=Symbol.for("react.profiler"),Oe=Symbol.for("react.provider"),Ke=Symbol.for("react.consumer"),mt=Symbol.for("react.context"),qe=Symbol.for("react.forward_ref"),Fe=Symbol.for("react.suspense"),We=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),oe=Symbol.for("react.lazy"),me=Symbol.for("react.activity"),be=Symbol.for("react.memo_cache_sentinel"),Ce=Symbol.iterator;function Ve(s){return s===null||typeof s!="object"?null:(s=Ce&&s[Ce]||s["@@iterator"],typeof s=="function"?s:null)}var Ee=Symbol.for("react.client.reference");function Yn(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Ee?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case ie:return"Fragment";case Re:return"Profiler";case Ie:return"StrictMode";case Fe:return"Suspense";case We:return"SuspenseList";case me:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case W:return"Portal";case mt:return(s.displayName||"Context")+".Provider";case Ke:return(s._context.displayName||"Context")+".Consumer";case qe:var h=s.render;return s=s.displayName,s||(s=h.displayName||h.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case pe:return h=s.displayName||null,h!==null?h:Yn(s.type)||"Memo";case oe:h=s._payload,s=s._init;try{return Yn(s(h))}catch{}}return null}var jn=Array.isArray,gt=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Bt=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,nn={pending:!1,data:null,method:null,action:null},Kn=[],ze=-1;function xt(s){return{current:s}}function It(s){0>ze||(s.current=Kn[ze],Kn[ze]=null,ze--)}function Rt(s,h){ze++,Kn[ze]=s.current,s.current=h}var Yt=xt(null),wn=xt(null),fn=xt(null),ii=xt(null);function wr(s,h){switch(Rt(fn,h),Rt(wn,s),Rt(Yt,null),h.nodeType){case 9:case 11:s=(s=h.documentElement)&&(s=s.namespaceURI)?_y(s):0;break;default:if(s=h.tagName,h=h.namespaceURI)h=_y(h),s=vy(h,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}It(Yt),Rt(Yt,s)}function Ir(){It(Yt),It(wn),It(fn)}function ks(s){s.memoizedState!==null&&Rt(ii,s);var h=Yt.current,g=vy(h,s.type);h!==g&&(Rt(wn,s),Rt(Yt,g))}function gi(s){wn.current===s&&(It(Yt),It(wn)),ii.current===s&&(It(ii),le._currentValue=nn)}var io=Object.prototype.hasOwnProperty,Tr=r.unstable_scheduleCallback,ya=r.unstable_cancelCallback,_a=r.unstable_shouldYield,nl=r.unstable_requestPaint,Cr=r.unstable_now,za=r.unstable_getCurrentPriorityLevel,na=r.unstable_ImmediatePriority,Ds=r.unstable_UserBlockingPriority,Wa=r.unstable_NormalPriority,_u=r.unstable_LowPriority,Ls=r.unstable_IdlePriority,os=r.log,Ro=r.unstable_setDisableYieldValue,fr=null,zn=null;function di(s){if(typeof os=="function"&&Ro(s),zn&&typeof zn.setStrictMode=="function")try{zn.setStrictMode(fr,s)}catch{}}var Ri=Math.clz32?Math.clz32:$e,vu=Math.log,ao=Math.LN2;function $e(s){return s>>>=0,s===0?32:31-(vu(s)/ao|0)|0}var ne=256,re=4194304;function ue(s){var h=s&42;if(h!==0)return h;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function xe(s,h,g){var x=s.pendingLanes;if(x===0)return 0;var C=0,L=s.suspendedLanes,Q=s.pingedLanes;s=s.warmLanes;var ae=x&134217727;return ae!==0?(x=ae&~L,x!==0?C=ue(x):(Q&=ae,Q!==0?C=ue(Q):g||(g=ae&~s,g!==0&&(C=ue(g))))):(ae=x&~L,ae!==0?C=ue(ae):Q!==0?C=ue(Q):g||(g=x&~s,g!==0&&(C=ue(g)))),C===0?0:h!==0&&h!==C&&(h&L)===0&&(L=C&-C,g=h&-h,L>=g||L===32&&(g&4194048)!==0)?h:C}function De(s,h){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&h)===0}function je(s,h){switch(s){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Je(){var s=ne;return ne<<=1,(ne&4194048)===0&&(ne=256),s}function Be(){var s=re;return re<<=1,(re&62914560)===0&&(re=4194304),s}function lt(s){for(var h=[],g=0;31>g;g++)h.push(s);return h}function it(s,h){s.pendingLanes|=h,h!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ge(s,h,g,x,C,L){var Q=s.pendingLanes;s.pendingLanes=g,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=g,s.entangledLanes&=g,s.errorRecoveryDisabledLanes&=g,s.shellSuspendCounter=0;var ae=s.entanglements,Pe=s.expirationTimes,rt=s.hiddenUpdates;for(g=Q&~g;0<g;){var _t=31-Ri(g),Tt=1<<_t;ae[_t]=0,Pe[_t]=-1;var ot=rt[_t];if(ot!==null)for(rt[_t]=null,_t=0;_t<ot.length;_t++){var ut=ot[_t];ut!==null&&(ut.lane&=-536870913)}g&=~Tt}x!==0&&ft(s,x,0),L!==0&&C===0&&s.tag!==0&&(s.suspendedLanes|=L&~(Q&~h))}function ft(s,h,g){s.pendingLanes|=h,s.suspendedLanes&=~h;var x=31-Ri(h);s.entangledLanes|=h,s.entanglements[x]=s.entanglements[x]|1073741824|g&4194090}function ke(s,h){var g=s.entangledLanes|=h;for(s=s.entanglements;g;){var x=31-Ri(g),C=1<<x;C&h|s[x]&h&&(s[x]|=h),g&=~C}}function Lt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function rn(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Vt(){var s=Bt.p;return s!==0?s:(s=window.event,s===void 0?32:Gt(s.type))}function Kt(s,h){var g=Bt.p;try{return Bt.p=s,h()}finally{Bt.p=g}}var Ht=Math.random().toString(36).slice(2),Tn="__reactFiber$"+Ht,gn="__reactProps$"+Ht,Sn="__reactContainer$"+Ht,on="__reactEvents$"+Ht,Bn="__reactListeners$"+Ht,Wr="__reactHandles$"+Ht,Pt="__reactResources$"+Ht,ai="__reactMarker$"+Ht;function cr(s){delete s[Tn],delete s[gn],delete s[on],delete s[Bn],delete s[Wr]}function va(s){var h=s[Tn];if(h)return h;for(var g=s.parentNode;g;){if(h=g[Sn]||g[Tn]){if(g=h.alternate,h.child!==null||g!==null&&g.child!==null)for(s=xv(s);s!==null;){if(g=s[Tn])return g;s=xv(s)}return h}s=g,g=s.parentNode}return null}function ba(s){if(s=s[Tn]||s[Sn]){var h=s.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return s}return null}function Mt(s){var h=s.tag;if(h===5||h===26||h===27||h===6)return s.stateNode;throw Error(a(33))}function ln(s){var h=s[Pt];return h||(h=s[Pt]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Qt(s){s[ai]=!0}var ha=new Set,rl={};function ki(s,h){pn(s,h),pn(s+"Capture",h)}function pn(s,h){for(rl[s]=h,s=0;s<h.length;s++)ha.add(h[s])}var zs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ko={},kr={};function Dl(s){return io.call(kr,s)?!0:io.call(ko,s)?!1:zs.test(s)?kr[s]=!0:(ko[s]=!0,!1)}function Os(s,h,g){if(Dl(h))if(g===null)s.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":s.removeAttribute(h);return;case"boolean":var x=h.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(h);return}}s.setAttribute(h,""+g)}}function ra(s,h,g){if(g===null)s.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttribute(h,""+g)}}function yi(s,h,g,x){if(x===null)s.removeAttribute(g);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(g);return}s.setAttributeNS(h,g,""+x)}}var Gi,Dr;function Do(s){if(Gi===void 0)try{throw Error()}catch(g){var h=g.stack.trim().match(/\n( *(at )?)/);Gi=h&&h[1]||"",Dr=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Gi+s+Dr}var Lo=!1;function il(s,h){if(!s||Lo)return"";Lo=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(h){var Tt=function(){throw Error()};if(Object.defineProperty(Tt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Tt,[])}catch(ut){var ot=ut}Reflect.construct(s,[],Tt)}else{try{Tt.call()}catch(ut){ot=ut}s.call(Tt.prototype)}}else{try{throw Error()}catch(ut){ot=ut}(Tt=s())&&typeof Tt.catch=="function"&&Tt.catch(function(){})}}catch(ut){if(ut&&ot&&typeof ut.stack=="string")return[ut.stack,ot.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=x.DetermineComponentFrameRoot(),Q=L[0],ae=L[1];if(Q&&ae){var Pe=Q.split(`
`),rt=ae.split(`
`);for(C=x=0;x<Pe.length&&!Pe[x].includes("DetermineComponentFrameRoot");)x++;for(;C<rt.length&&!rt[C].includes("DetermineComponentFrameRoot");)C++;if(x===Pe.length||C===rt.length)for(x=Pe.length-1,C=rt.length-1;1<=x&&0<=C&&Pe[x]!==rt[C];)C--;for(;1<=x&&0<=C;x--,C--)if(Pe[x]!==rt[C]){if(x!==1||C!==1)do if(x--,C--,0>C||Pe[x]!==rt[C]){var _t=`
`+Pe[x].replace(" at new "," at ");return s.displayName&&_t.includes("<anonymous>")&&(_t=_t.replace("<anonymous>",s.displayName)),_t}while(1<=x&&0<=C);break}}}finally{Lo=!1,Error.prepareStackTrace=g}return(g=s?s.displayName||s.name:"")?Do(g):""}function so(s){switch(s.tag){case 26:case 27:case 5:return Do(s.type);case 16:return Do("Lazy");case 13:return Do("Suspense");case 19:return Do("SuspenseList");case 0:case 15:return il(s.type,!1);case 11:return il(s.type.render,!1);case 1:return il(s.type,!0);case 31:return Do("Activity");default:return""}}function ls(s){try{var h="";do h+=so(s),s=s.return;while(s);return h}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function xa(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function _c(s){var h=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function ld(s){var h=_c(s)?"checked":"value",g=Object.getOwnPropertyDescriptor(s.constructor.prototype,h),x=""+s[h];if(!s.hasOwnProperty(h)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var C=g.get,L=g.set;return Object.defineProperty(s,h,{configurable:!0,get:function(){return C.call(this)},set:function(Q){x=""+Q,L.call(this,Q)}}),Object.defineProperty(s,h,{enumerable:g.enumerable}),{getValue:function(){return x},setValue:function(Q){x=""+Q},stopTracking:function(){s._valueTracker=null,delete s[h]}}}}function oo(s){s._valueTracker||(s._valueTracker=ld(s))}function vc(s){if(!s)return!1;var h=s._valueTracker;if(!h)return!0;var g=h.getValue(),x="";return s&&(x=_c(s)?s.checked?"true":"false":s.value),s=x,s!==g?(h.setValue(s),!0):!1}function Ll(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var bu=/[\n"\\]/g;function Di(s){return s.replace(bu,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Xa(s,h,g,x,C,L,Q,ae){s.name="",Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?s.type=Q:s.removeAttribute("type"),h!=null?Q==="number"?(h===0&&s.value===""||s.value!=h)&&(s.value=""+xa(h)):s.value!==""+xa(h)&&(s.value=""+xa(h)):Q!=="submit"&&Q!=="reset"||s.removeAttribute("value"),h!=null?zo(s,Q,xa(h)):g!=null?zo(s,Q,xa(g)):x!=null&&s.removeAttribute("value"),C==null&&L!=null&&(s.defaultChecked=!!L),C!=null&&(s.checked=C&&typeof C!="function"&&typeof C!="symbol"),ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?s.name=""+xa(ae):s.removeAttribute("name")}function Ns(s,h,g,x,C,L,Q,ae){if(L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(s.type=L),h!=null||g!=null){if(!(L!=="submit"&&L!=="reset"||h!=null))return;g=g!=null?""+xa(g):"",h=h!=null?""+xa(h):g,ae||h===s.value||(s.value=h),s.defaultValue=h}x=x??C,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=ae?s.checked:!!x,s.defaultChecked=!!x,Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(s.name=Q)}function zo(s,h,g){h==="number"&&Ll(s.ownerDocument)===s||s.defaultValue===""+g||(s.defaultValue=""+g)}function lo(s,h,g,x){if(s=s.options,h){h={};for(var C=0;C<g.length;C++)h["$"+g[C]]=!0;for(g=0;g<s.length;g++)C=h.hasOwnProperty("$"+s[g].value),s[g].selected!==C&&(s[g].selected=C),C&&x&&(s[g].defaultSelected=!0)}else{for(g=""+xa(g),h=null,C=0;C<s.length;C++){if(s[C].value===g){s[C].selected=!0,x&&(s[C].defaultSelected=!0);return}h!==null||s[C].disabled||(h=s[C])}h!==null&&(h.selected=!0)}}function Sr(s,h,g){if(h!=null&&(h=""+xa(h),h!==s.value&&(s.value=h),g==null)){s.defaultValue!==h&&(s.defaultValue=h);return}s.defaultValue=g!=null?""+xa(g):""}function Oo(s,h,g,x){if(h==null){if(x!=null){if(g!=null)throw Error(a(92));if(jn(x)){if(1<x.length)throw Error(a(93));x=x[0]}g=x}g==null&&(g=""),h=g}g=xa(h),s.defaultValue=g,x=s.textContent,x===g&&x!==""&&x!==null&&(s.value=x)}function Oa(s,h){if(h){var g=s.firstChild;if(g&&g===s.lastChild&&g.nodeType===3){g.nodeValue=h;return}}s.textContent=h}var wa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rn(s,h,g){var x=h.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?x?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="":x?s.setProperty(h,g):typeof g!="number"||g===0||wa.has(h)?h==="float"?s.cssFloat=g:s[h]=(""+g).trim():s[h]=g+"px"}function us(s,h,g){if(h!=null&&typeof h!="object")throw Error(a(62));if(s=s.style,g!=null){for(var x in g)!g.hasOwnProperty(x)||h!=null&&h.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var C in h)x=h[C],h.hasOwnProperty(C)&&g[C]!==x&&Rn(s,C,x)}else for(var L in h)h.hasOwnProperty(L)&&Rn(s,L,h[L])}function cs(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var al=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function zl(s){return dh.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Li=null;function zi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var vn=null,hs=null;function Ol(s){var h=ba(s);if(h&&(s=h.stateNode)){var g=s[gn]||null;e:switch(s=h.stateNode,h.type){case"input":if(Xa(s,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),h=g.name,g.type==="radio"&&h!=null){for(g=s;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Di(""+h)+'"][type="radio"]'),h=0;h<g.length;h++){var x=g[h];if(x!==s&&x.form===s.form){var C=x[gn]||null;if(!C)throw Error(a(90));Xa(x,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(h=0;h<g.length;h++)x=g[h],x.form===s.form&&vc(x)}break e;case"textarea":Sr(s,g.value,g.defaultValue);break e;case"select":h=g.value,h!=null&&lo(s,!!g.multiple,h,!1)}}}var Bs=!1;function Hi(s,h,g){if(Bs)return s(h,g);Bs=!0;try{var x=s(h);return x}finally{if(Bs=!1,(vn!==null||hs!==null)&&(Si(),vn&&(h=vn,s=hs,hs=vn=null,Ol(h),s)))for(h=0;h<s.length;h++)Ol(s[h])}}function jr(s,h){var g=s.stateNode;if(g===null)return null;var x=g[gn]||null;if(x===null)return null;g=x[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(g&&typeof g!="function")throw Error(a(231,h,typeof g));return g}var $r=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Er=!1;if($r)try{var pr={};Object.defineProperty(pr,"passive",{get:function(){Er=!0}}),window.addEventListener("test",pr,pr),window.removeEventListener("test",pr,pr)}catch{Er=!1}var ds=null,En=null,fi=null;function mn(){if(fi)return fi;var s,h=En,g=h.length,x,C="value"in ds?ds.value:ds.textContent,L=C.length;for(s=0;s<g&&h[s]===C[s];s++);var Q=g-s;for(x=1;x<=Q&&h[g-x]===C[L-x];x++);return fi=C.slice(s,1<x?1-x:void 0)}function dn(s){var h=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&h===13&&(s=13)):s=h,s===10&&(s=13),32<=s||s===13?s:0}function Ta(){return!0}function an(){return!1}function Jr(s){function h(g,x,C,L,Q){this._reactName=g,this._targetInst=C,this.type=x,this.nativeEvent=L,this.target=Q,this.currentTarget=null;for(var ae in s)s.hasOwnProperty(ae)&&(g=s[ae],this[ae]=g?g(L):L[ae]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?Ta:an,this.isPropagationStopped=an,this}return B(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Ta)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Ta)},persist:function(){},isPersistent:Ta}),h}var Mn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uo=Jr(Mn),ia=B({},Mn,{view:0,detail:0}),bc=Jr(ia),Na,xu,co,ho=B({},ia,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_i,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==co&&(co&&s.type==="mousemove"?(Na=s.screenX-co.screenX,xu=s.screenY-co.screenY):xu=Na=0,co=s),Na)},movementY:function(s){return"movementY"in s?s.movementY:xu}}),Sa=Jr(ho),Ya=B({},ho,{dataTransfer:0}),Oi=Jr(Ya),Vs=B({},ia,{relatedTarget:0}),No=Jr(Vs),Bo=B({},Mn,{animationName:0,elapsedTime:0,pseudoElement:0}),Xr=Jr(Bo),Nl=B({},Mn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),fo=Jr(Nl),Bl=B({},Mn,{data:0}),fh=Jr(Bl),Qa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ph(s){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(s):(s=xc[s])?!!h[s]:!1}function _i(){return ph}var sl=B({},ia,{key:function(s){if(s.key){var h=Qa[s.key]||s.key;if(h!=="Unidentified")return h}return s.type==="keypress"?(s=dn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Vl[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_i,charCode:function(s){return s.type==="keypress"?dn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?dn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),aa=Jr(sl),da=B({},ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wu=Jr(da),fs=B({},ia,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_i}),ol=Jr(fs),wc=B({},Mn,{propertyName:0,elapsedTime:0,pseudoElement:0}),ud=Jr(wc),cd=B({},ho,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Tc=Jr(cd),Ba=B({},Mn,{newState:0,oldState:0}),Tu=Jr(Ba),Su=[9,13,27,32],ps=$r&&"CompositionEvent"in window,A=null;$r&&"documentMode"in document&&(A=document.documentMode);var F=$r&&"TextEvent"in window&&!A,Z=$r&&(!ps||A&&8<A&&11>=A),ce=" ",Qe=!1;function dt(s,h){switch(s){case"keyup":return Su.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nt(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var $n=!1;function Ni(s,h){switch(s){case"compositionend":return Nt(h);case"keypress":return h.which!==32?null:(Qe=!0,ce);case"textInput":return s=h.data,s===ce&&Qe?null:s;default:return null}}function qn(s,h){if($n)return s==="compositionend"||!ps&&dt(s,h)?(s=mn(),fi=En=ds=null,$n=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Z&&h.locale!=="ko"?null:h.data;default:return null}}var Zi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ei(s){var h=s&&s.nodeName&&s.nodeName.toLowerCase();return h==="input"?!!Zi[s.type]:h==="textarea"}function ll(s,h,g,x){vn?hs?hs.push(x):hs=[x]:vn=x,h=dp(h,"onChange"),0<h.length&&(g=new uo("onChange","change",null,g,x),s.push({event:g,listeners:h}))}var sa=null,Vo=null;function Fl(s){gv(s,0)}function Sc(s){var h=Mt(s);if(vc(h))return s}function Sf(s,h){if(s==="change")return h}var Ef=!1;if($r){var mh;if($r){var gh="oninput"in document;if(!gh){var Ul=document.createElement("div");Ul.setAttribute("oninput","return;"),gh=typeof Ul.oninput=="function"}mh=gh}else mh=!1;Ef=mh&&(!document.documentMode||9<document.documentMode)}function Af(){sa&&(sa.detachEvent("onpropertychange",hd),Vo=sa=null)}function hd(s){if(s.propertyName==="value"&&Sc(Vo)){var h=[];ll(h,Vo,s,zi(s)),Hi(Fl,h)}}function Ec(s,h,g){s==="focusin"?(Af(),sa=h,Vo=g,sa.attachEvent("onpropertychange",hd)):s==="focusout"&&Af()}function Eg(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Sc(Vo)}function dd(s,h){if(s==="click")return Sc(h)}function Ag(s,h){if(s==="input"||s==="change")return Sc(h)}function Xp(s,h){return s===h&&(s!==0||1/s===1/h)||s!==s&&h!==h}var Ja=typeof Object.is=="function"?Object.is:Xp;function Ac(s,h){if(Ja(s,h))return!0;if(typeof s!="object"||s===null||typeof h!="object"||h===null)return!1;var g=Object.keys(s),x=Object.keys(h);if(g.length!==x.length)return!1;for(x=0;x<g.length;x++){var C=g[x];if(!io.call(h,C)||!Ja(s[C],h[C]))return!1}return!0}function If(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function fd(s,h){var g=If(s);s=0;for(var x;g;){if(g.nodeType===3){if(x=s+g.textContent.length,s<=h&&x>=h)return{node:g,offset:h-s};s=x}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=If(g)}}function nr(s,h){return s&&h?s===h?!0:s&&s.nodeType===3?!1:h&&h.nodeType===3?nr(s,h.parentNode):"contains"in s?s.contains(h):s.compareDocumentPosition?!!(s.compareDocumentPosition(h)&16):!1:!1}function yh(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var h=Ll(s.document);h instanceof s.HTMLIFrameElement;){try{var g=typeof h.contentWindow.location.href=="string"}catch{g=!1}if(g)s=h.contentWindow;else break;h=Ll(s.document)}return h}function po(s){var h=s&&s.nodeName&&s.nodeName.toLowerCase();return h&&(h==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||h==="textarea"||s.contentEditable==="true")}var Cf=$r&&"documentMode"in document&&11>=document.documentMode,jl=null,_h=null,Ic=null,vh=!1;function $l(s,h,g){var x=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;vh||jl==null||jl!==Ll(x)||(x=jl,"selectionStart"in x&&po(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Ic&&Ac(Ic,x)||(Ic=x,x=dp(_h,"onSelect"),0<x.length&&(h=new uo("onSelect","select",null,h,g),s.push({event:h,listeners:x}),h.target=jl)))}function ul(s,h){var g={};return g[s.toLowerCase()]=h.toLowerCase(),g["Webkit"+s]="webkit"+h,g["Moz"+s]="moz"+h,g}var Cc={animationend:ul("Animation","AnimationEnd"),animationiteration:ul("Animation","AnimationIteration"),animationstart:ul("Animation","AnimationStart"),transitionrun:ul("Transition","TransitionRun"),transitionstart:ul("Transition","TransitionStart"),transitioncancel:ul("Transition","TransitionCancel"),transitionend:ul("Transition","TransitionEnd")},Pf={},Yp={};$r&&(Yp=document.createElement("div").style,"AnimationEvent"in window||(delete Cc.animationend.animation,delete Cc.animationiteration.animation,delete Cc.animationstart.animation),"TransitionEvent"in window||delete Cc.transitionend.transition);function Eu(s){if(Pf[s])return Pf[s];if(!Cc[s])return s;var h=Cc[s],g;for(g in h)if(h.hasOwnProperty(g)&&g in Yp)return Pf[s]=h[g];return s}var Mf=Eu("animationend"),Qp=Eu("animationiteration"),Rf=Eu("animationstart"),pd=Eu("transitionrun"),md=Eu("transitionstart"),gd=Eu("transitioncancel"),yd=Eu("transitionend"),ql=new Map,Au="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Au.push("scrollEnd");function Ea(s,h){ql.set(s,h),ki(h,[s])}var ms=new WeakMap;function gs(s,h){if(typeof s=="object"&&s!==null){var g=ms.get(s);return g!==void 0?g:(h={value:s,source:h,stack:ls(h)},ms.set(s,h),h)}return{value:s,source:h,stack:ls(h)}}var ys=[],Gl=0,cl=0;function Iu(){for(var s=Gl,h=cl=Gl=0;h<s;){var g=ys[h];ys[h++]=null;var x=ys[h];ys[h++]=null;var C=ys[h];ys[h++]=null;var L=ys[h];if(ys[h++]=null,x!==null&&C!==null){var Q=x.pending;Q===null?C.next=C:(C.next=Q.next,Q.next=C),x.pending=C}L!==0&&kf(g,C,L)}}function Cu(s,h,g,x){ys[Gl++]=s,ys[Gl++]=h,ys[Gl++]=g,ys[Gl++]=x,cl|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function Pu(s,h,g,x){return Cu(s,h,g,x),hl(s)}function mo(s,h){return Cu(s,null,null,h),hl(s)}function kf(s,h,g){s.lanes|=g;var x=s.alternate;x!==null&&(x.lanes|=g);for(var C=!1,L=s.return;L!==null;)L.childLanes|=g,x=L.alternate,x!==null&&(x.childLanes|=g),L.tag===22&&(s=L.stateNode,s===null||s._visibility&1||(C=!0)),s=L,L=L.return;return s.tag===3?(L=s.stateNode,C&&h!==null&&(C=31-Ri(g),s=L.hiddenUpdates,x=s[C],x===null?s[C]=[h]:x.push(h),h.lane=g|536870912),L):null}function hl(s){if(50<ap)throw ap=0,Yg=null,Error(a(185));for(var h=s.return;h!==null;)s=h,h=s.return;return s.tag===3?s.stateNode:null}var go={};function Df(s,h,g,x){this.tag=s,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Va(s,h,g,x){return new Df(s,h,g,x)}function kn(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Fa(s,h){var g=s.alternate;return g===null?(g=Va(s.tag,h,s.key,s.mode),g.elementType=s.elementType,g.type=s.type,g.stateNode=s.stateNode,g.alternate=s,s.alternate=g):(g.pendingProps=h,g.type=s.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=s.flags&65011712,g.childLanes=s.childLanes,g.lanes=s.lanes,g.child=s.child,g.memoizedProps=s.memoizedProps,g.memoizedState=s.memoizedState,g.updateQueue=s.updateQueue,h=s.dependencies,g.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},g.sibling=s.sibling,g.index=s.index,g.ref=s.ref,g.refCleanup=s.refCleanup,g}function Lf(s,h){s.flags&=65011714;var g=s.alternate;return g===null?(s.childLanes=0,s.lanes=h,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=g.childLanes,s.lanes=g.lanes,s.child=g.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=g.memoizedProps,s.memoizedState=g.memoizedState,s.updateQueue=g.updateQueue,s.type=g.type,h=g.dependencies,s.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),s}function bh(s,h,g,x,C,L){var Q=0;if(x=s,typeof s=="function")kn(s)&&(Q=1);else if(typeof s=="string")Q=S(s,g,Yt.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case me:return s=Va(31,g,h,C),s.elementType=me,s.lanes=L,s;case ie:return yo(g.children,C,L,h);case Ie:Q=8,C|=24;break;case Re:return s=Va(12,g,h,C|2),s.elementType=Re,s.lanes=L,s;case Fe:return s=Va(13,g,h,C),s.elementType=Fe,s.lanes=L,s;case We:return s=Va(19,g,h,C),s.elementType=We,s.lanes=L,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Oe:case mt:Q=10;break e;case Ke:Q=9;break e;case qe:Q=11;break e;case pe:Q=14;break e;case oe:Q=16,x=null;break e}Q=29,g=Error(a(130,s===null?"null":typeof s,"")),x=null}return h=Va(Q,g,h,C),h.elementType=s,h.type=x,h.lanes=L,h}function yo(s,h,g,x){return s=Va(7,s,x,h),s.lanes=g,s}function zf(s,h,g){return s=Va(6,s,null,h),s.lanes=g,s}function Of(s,h,g){return h=Va(4,s.children!==null?s.children:[],s.key,h),h.lanes=g,h.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},h}var Mu=[],Ru=0,ku=null,Du=0,Ua=[],Aa=0,Fo=null,_o=1,_s="";function Fs(s,h){Mu[Ru++]=Du,Mu[Ru++]=ku,ku=s,Du=h}function Lu(s,h,g){Ua[Aa++]=_o,Ua[Aa++]=_s,Ua[Aa++]=Fo,Fo=s;var x=_o;s=_s;var C=32-Ri(x)-1;x&=~(1<<C),g+=1;var L=32-Ri(h)+C;if(30<L){var Q=C-C%5;L=(x&(1<<Q)-1).toString(32),x>>=Q,C-=Q,_o=1<<32-Ri(h)+C|g<<C|x,_s=L+s}else _o=1<<L|g<<C|x,_s=s}function zu(s){s.return!==null&&(Fs(s,1),Lu(s,1,0))}function xh(s){for(;s===ku;)ku=Mu[--Ru],Mu[Ru]=null,Du=Mu[--Ru],Mu[Ru]=null;for(;s===Fo;)Fo=Ua[--Aa],Ua[Aa]=null,_s=Ua[--Aa],Ua[Aa]=null,_o=Ua[--Aa],Ua[Aa]=null}var pi=null,mi=null,or=!1,Uo=null,Us=!1,_d=Error(a(519));function Hl(s){var h=Error(a(418,""));throw js(gs(h,s)),_d}function Pc(s){var h=s.stateNode,g=s.type,x=s.memoizedProps;switch(h[Tn]=s,h[gn]=x,g){case"dialog":er("cancel",h),er("close",h);break;case"iframe":case"object":case"embed":er("load",h);break;case"video":case"audio":for(g=0;g<hp.length;g++)er(hp[g],h);break;case"source":er("error",h);break;case"img":case"image":case"link":er("error",h),er("load",h);break;case"details":er("toggle",h);break;case"input":er("invalid",h),Ns(h,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),oo(h);break;case"select":er("invalid",h);break;case"textarea":er("invalid",h),Oo(h,x.value,x.defaultValue,x.children),oo(h)}g=x.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||h.textContent===""+g||x.suppressHydrationWarning===!0||Gd(h.textContent,g)?(x.popover!=null&&(er("beforetoggle",h),er("toggle",h)),x.onScroll!=null&&er("scroll",h),x.onScrollEnd!=null&&er("scrollend",h),x.onClick!=null&&(h.onclick=fp),h=!0):h=!1,h||Hl(s)}function wh(s){for(pi=s.return;pi;)switch(pi.tag){case 5:case 13:Us=!1;return;case 27:case 3:Us=!0;return;default:pi=pi.return}}function Zl(s){if(s!==pi)return!1;if(!or)return wh(s),or=!0,!1;var h=s.tag,g;if((g=h!==3&&h!==27)&&((g=h===5)&&(g=s.type,g=!(g!=="form"&&g!=="button")||by(s.type,s.memoizedProps)),g=!g),g&&mi&&Hl(s),wh(s),h===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,h=0;s;){if(s.nodeType===8)if(g=s.data,g==="/$"){if(h===0){mi=Ws(s.nextSibling);break e}h--}else g!=="$"&&g!=="$!"&&g!=="$?"||h++;s=s.nextSibling}mi=null}}else h===27?(h=mi,Gc(s.type)?(s=Sy,Sy=null,mi=s):mi=h):mi=pi?Ws(s.stateNode.nextSibling):null;return!0}function Mc(){mi=pi=null,or=!1}function ti(){var s=Uo;return s!==null&&(Zs===null?Zs=s:Zs.push.apply(Zs,s),Uo=null),s}function js(s){Uo===null?Uo=[s]:Uo.push(s)}var es=xt(null),jo=null,vs=null;function bs(s,h,g){Rt(es,h._currentValue),h._currentValue=g}function ts(s){s._currentValue=es.current,It(es)}function Th(s,h,g){for(;s!==null;){var x=s.alternate;if((s.childLanes&h)!==h?(s.childLanes|=h,x!==null&&(x.childLanes|=h)):x!==null&&(x.childLanes&h)!==h&&(x.childLanes|=h),s===g)break;s=s.return}}function Ou(s,h,g,x){var C=s.child;for(C!==null&&(C.return=s);C!==null;){var L=C.dependencies;if(L!==null){var Q=C.child;L=L.firstContext;e:for(;L!==null;){var ae=L;L=C;for(var Pe=0;Pe<h.length;Pe++)if(ae.context===h[Pe]){L.lanes|=g,ae=L.alternate,ae!==null&&(ae.lanes|=g),Th(L.return,g,s),x||(Q=null);break e}L=ae.next}}else if(C.tag===18){if(Q=C.return,Q===null)throw Error(a(341));Q.lanes|=g,L=Q.alternate,L!==null&&(L.lanes|=g),Th(Q,g,s),Q=null}else Q=C.child;if(Q!==null)Q.return=C;else for(Q=C;Q!==null;){if(Q===s){Q=null;break}if(C=Q.sibling,C!==null){C.return=Q.return,Q=C;break}Q=Q.return}C=Q}}function Nu(s,h,g,x){s=null;for(var C=h,L=!1;C!==null;){if(!L){if((C.flags&524288)!==0)L=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var Q=C.alternate;if(Q===null)throw Error(a(387));if(Q=Q.memoizedProps,Q!==null){var ae=C.type;Ja(C.pendingProps.value,Q.value)||(s!==null?s.push(ae):s=[ae])}}else if(C===ii.current){if(Q=C.alternate,Q===null)throw Error(a(387));Q.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(s!==null?s.push(le):s=[le])}C=C.return}s!==null&&Ou(h,s,g,x),h.flags|=262144}function Sh(s){for(s=s.firstContext;s!==null;){if(!Ja(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Kl(s){jo=s,vs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function vi(s){return ja(jo,s)}function dl(s,h){return jo===null&&Kl(s),ja(s,h)}function ja(s,h){var g=h._currentValue;if(h={context:h,memoizedValue:g,next:null},vs===null){if(s===null)throw Error(a(308));vs=h,s.dependencies={lanes:0,firstContext:h},s.flags|=524288}else vs=vs.next=h;return g}var vo=typeof AbortController<"u"?AbortController:function(){var s=[],h=this.signal={aborted:!1,addEventListener:function(g,x){s.push(x)}};this.abort=function(){h.aborted=!0,s.forEach(function(g){return g()})}},Nf=r.unstable_scheduleCallback,Jp=r.unstable_NormalPriority,Bi={$$typeof:mt,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Wl(){return{controller:new vo,data:new Map,refCount:0}}function Bu(s){s.refCount--,s.refCount===0&&Nf(Jp,function(){s.controller.abort()})}var Xl=null,vd=0,fl=0,pl=null;function Rc(s,h){if(Xl===null){var g=Xl=[];vd=0,fl=$c(),pl={status:"pending",value:void 0,then:function(x){g.push(x)}}}return vd++,h.then(xs,xs),h}function xs(){if(--vd===0&&Xl!==null){pl!==null&&(pl.status="fulfilled");var s=Xl;Xl=null,fl=0,pl=null;for(var h=0;h<s.length;h++)(0,s[h])()}}function bo(s,h){var g=[],x={status:"pending",value:null,reason:null,then:function(C){g.push(C)}};return s.then(function(){x.status="fulfilled",x.value=h;for(var C=0;C<g.length;C++)(0,g[C])(h)},function(C){for(x.status="rejected",x.reason=C,C=0;C<g.length;C++)(0,g[C])(void 0)}),x}var Bf=gt.S;gt.S=function(s,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&Rc(s,h),Bf!==null&&Bf(s,h)};var bi=xt(null);function Yl(){var s=bi.current;return s!==null?s:Mr.pooledCache}function bd(s,h){h===null?Rt(bi,bi.current):Rt(bi,h.pool)}function Eh(){var s=Yl();return s===null?null:{parent:Bi._currentValue,pool:s}}var Ah=Error(a(460)),xd=Error(a(474)),Ql=Error(a(542)),Jl={then:function(){}};function xo(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ft(){}function wd(s,h,g){switch(g=s[g],g===void 0?s.push(h):g!==h&&(h.then(Ft,Ft),h=g),h.status){case"fulfilled":return h.value;case"rejected":throw s=h.reason,kc(s),s;default:if(typeof h.status=="string")h.then(Ft,Ft);else{if(s=Mr,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=h,s.status="pending",s.then(function(x){if(h.status==="pending"){var C=h;C.status="fulfilled",C.value=x}},function(x){if(h.status==="pending"){var C=h;C.status="rejected",C.reason=x}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw s=h.reason,kc(s),s}throw ml=h,Ah}}var ml=null;function Td(){if(ml===null)throw Error(a(459));var s=ml;return ml=null,s}function kc(s){if(s===Ah||s===Ql)throw Error(a(483))}var ws=!1;function Ih(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Dn(s,h){s=s.updateQueue,h.updateQueue===s&&(h.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function $o(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function gl(s,h,g){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Pr&2)!==0){var C=x.pending;return C===null?h.next=h:(h.next=C.next,C.next=h),x.pending=h,h=hl(s),kf(s,null,g),h}return Cu(s,x,h,g),hl(s)}function eu(s,h,g){if(h=h.updateQueue,h!==null&&(h=h.shared,(g&4194048)!==0)){var x=h.lanes;x&=s.pendingLanes,g|=x,h.lanes=g,ke(s,g)}}function Vf(s,h){var g=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,g===x)){var C=null,L=null;if(g=g.firstBaseUpdate,g!==null){do{var Q={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};L===null?C=L=Q:L=L.next=Q,g=g.next}while(g!==null);L===null?C=L=h:L=L.next=h}else C=L=h;g={baseState:x.baseState,firstBaseUpdate:C,lastBaseUpdate:L,shared:x.shared,callbacks:x.callbacks},s.updateQueue=g;return}s=g.lastBaseUpdate,s===null?g.firstBaseUpdate=h:s.next=h,g.lastBaseUpdate=h}var Ff=!1;function Vu(){if(Ff){var s=pl;if(s!==null)throw s}}function tu(s,h,g,x){Ff=!1;var C=s.updateQueue;ws=!1;var L=C.firstBaseUpdate,Q=C.lastBaseUpdate,ae=C.shared.pending;if(ae!==null){C.shared.pending=null;var Pe=ae,rt=Pe.next;Pe.next=null,Q===null?L=rt:Q.next=rt,Q=Pe;var _t=s.alternate;_t!==null&&(_t=_t.updateQueue,ae=_t.lastBaseUpdate,ae!==Q&&(ae===null?_t.firstBaseUpdate=rt:ae.next=rt,_t.lastBaseUpdate=Pe))}if(L!==null){var Tt=C.baseState;Q=0,_t=rt=Pe=null,ae=L;do{var ot=ae.lane&-536870913,ut=ot!==ae.lane;if(ut?(rr&ot)===ot:(x&ot)===ot){ot!==0&&ot===fl&&(Ff=!0),_t!==null&&(_t=_t.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var cn=s,yn=ae;ot=h;var Ur=g;switch(yn.tag){case 1:if(cn=yn.payload,typeof cn=="function"){Tt=cn.call(Ur,Tt,ot);break e}Tt=cn;break e;case 3:cn.flags=cn.flags&-65537|128;case 0:if(cn=yn.payload,ot=typeof cn=="function"?cn.call(Ur,Tt,ot):cn,ot==null)break e;Tt=B({},Tt,ot);break e;case 2:ws=!0}}ot=ae.callback,ot!==null&&(s.flags|=64,ut&&(s.flags|=8192),ut=C.callbacks,ut===null?C.callbacks=[ot]:ut.push(ot))}else ut={lane:ot,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},_t===null?(rt=_t=ut,Pe=Tt):_t=_t.next=ut,Q|=ot;if(ae=ae.next,ae===null){if(ae=C.shared.pending,ae===null)break;ut=ae,ae=ut.next,ut.next=null,C.lastBaseUpdate=ut,C.shared.pending=null}}while(!0);_t===null&&(Pe=Tt),C.baseState=Pe,C.firstBaseUpdate=rt,C.lastBaseUpdate=_t,L===null&&(C.shared.lanes=0),Uc|=Q,s.lanes=Q,s.memoizedState=Tt}}function Sd(s,h){if(typeof s!="function")throw Error(a(191,s));s.call(h)}function Uf(s,h){var g=s.callbacks;if(g!==null)for(s.callbacks=null,s=0;s<g.length;s++)Sd(g[s],h)}var qo=xt(null),Ed=xt(0);function Ad(s,h){s=lu,Rt(Ed,s),Rt(qo,h),lu=s|h.baseLanes}function Go(){Rt(Ed,lu),Rt(qo,qo.current)}function Lr(){lu=Ed.current,It(qo),It(Ed)}var $s=0,Ln=null,mr=null,xi=null,Ch=!1,Dc=!1,Ia=!1,Fu=0,jt=0,Jt=null,Id=0;function si(){throw Error(a(321))}function Uu(s,h){if(h===null)return!1;for(var g=0;g<h.length&&g<s.length;g++)if(!Ja(s[g],h[g]))return!1;return!0}function fa(s,h,g,x,C,L){return $s=L,Ln=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,gt.H=s===null||s.memoizedState===null?Hs:bl,Ia=!1,L=g(x,C),Ia=!1,Dc&&(L=oa(h,g,x,C)),jf(s),L}function jf(s){gt.H=ma;var h=mr!==null&&mr.next!==null;if($s=0,xi=mr=Ln=null,Ch=!1,jt=0,Jt=null,h)throw Error(a(300));s===null||Pa||(s=s.dependencies,s!==null&&Sh(s)&&(Pa=!0))}function oa(s,h,g,x){Ln=s;var C=0;do{if(Dc&&(Jt=null),jt=0,Dc=!1,25<=C)throw Error(a(301));if(C+=1,xi=mr=null,s.updateQueue!=null){var L=s.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}gt.H=Gu,L=h(g,x)}while(Dc);return L}function em(){var s=gt.H,h=s.useState()[0];return h=typeof h.then=="function"?ju(h):h,s=s.useState()[0],(mr!==null?mr.memoizedState:null)!==s&&(Ln.flags|=1024),h}function yl(){var s=Fu!==0;return Fu=0,s}function qr(s,h,g){h.updateQueue=s.updateQueue,h.flags&=-2053,s.lanes&=~g}function Yr(s){if(Ch){for(s=s.memoizedState;s!==null;){var h=s.queue;h!==null&&(h.pending=null),s=s.next}Ch=!1}$s=0,xi=mr=Ln=null,Dc=!1,jt=Fu=0,Jt=null}function $a(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?Ln.memoizedState=xi=s:xi=xi.next=s,xi}function zr(){if(mr===null){var s=Ln.alternate;s=s!==null?s.memoizedState:null}else s=mr.next;var h=xi===null?Ln.memoizedState:xi.next;if(h!==null)xi=h,mr=s;else{if(s===null)throw Ln.alternate===null?Error(a(467)):Error(a(310));mr=s,s={memoizedState:mr.memoizedState,baseState:mr.baseState,baseQueue:mr.baseQueue,queue:mr.queue,next:null},xi===null?Ln.memoizedState=xi=s:xi=xi.next=s}return xi}function Ho(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ju(s){var h=jt;return jt+=1,Jt===null&&(Jt=[]),s=wd(Jt,s,h),h=Ln,(xi===null?h.memoizedState:xi.next)===null&&(h=h.alternate,gt.H=h===null||h.memoizedState===null?Hs:bl),s}function $u(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return ju(s);if(s.$$typeof===mt)return vi(s)}throw Error(a(438,String(s)))}function _l(s){var h=null,g=Ln.updateQueue;if(g!==null&&(h=g.memoCache),h==null){var x=Ln.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(h={data:x.data.map(function(C){return C.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),g===null&&(g=Ho(),Ln.updateQueue=g),g.memoCache=h,g=h.data[h.index],g===void 0)for(g=h.data[h.index]=Array(s),x=0;x<s;x++)g[x]=be;return h.index++,g}function Ts(s,h){return typeof h=="function"?h(s):h}function Lc(s){var h=zr();return zc(h,mr,s)}function zc(s,h,g){var x=s.queue;if(x===null)throw Error(a(311));x.lastRenderedReducer=g;var C=s.baseQueue,L=x.pending;if(L!==null){if(C!==null){var Q=C.next;C.next=L.next,L.next=Q}h.baseQueue=C=L,x.pending=null}if(L=s.baseState,C===null)s.memoizedState=L;else{h=C.next;var ae=Q=null,Pe=null,rt=h,_t=!1;do{var Tt=rt.lane&-536870913;if(Tt!==rt.lane?(rr&Tt)===Tt:($s&Tt)===Tt){var ot=rt.revertLane;if(ot===0)Pe!==null&&(Pe=Pe.next={lane:0,revertLane:0,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),Tt===fl&&(_t=!0);else if(($s&ot)===ot){rt=rt.next,ot===fl&&(_t=!0);continue}else Tt={lane:0,revertLane:rt.revertLane,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},Pe===null?(ae=Pe=Tt,Q=L):Pe=Pe.next=Tt,Ln.lanes|=ot,Uc|=ot;Tt=rt.action,Ia&&g(L,Tt),L=rt.hasEagerState?rt.eagerState:g(L,Tt)}else ot={lane:Tt,revertLane:rt.revertLane,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},Pe===null?(ae=Pe=ot,Q=L):Pe=Pe.next=ot,Ln.lanes|=Tt,Uc|=Tt;rt=rt.next}while(rt!==null&&rt!==h);if(Pe===null?Q=L:Pe.next=ae,!Ja(L,s.memoizedState)&&(Pa=!0,_t&&(g=pl,g!==null)))throw g;s.memoizedState=L,s.baseState=Q,s.baseQueue=Pe,x.lastRenderedState=L}return C===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function Ph(s){var h=zr(),g=h.queue;if(g===null)throw Error(a(311));g.lastRenderedReducer=s;var x=g.dispatch,C=g.pending,L=h.memoizedState;if(C!==null){g.pending=null;var Q=C=C.next;do L=s(L,Q.action),Q=Q.next;while(Q!==C);Ja(L,h.memoizedState)||(Pa=!0),h.memoizedState=L,h.baseQueue===null&&(h.baseState=L),g.lastRenderedState=L}return[L,x]}function b(s,h,g){var x=Ln,C=zr(),L=or;if(L){if(g===void 0)throw Error(a(407));g=g()}else g=h();var Q=!Ja((mr||C).memoizedState,g);Q&&(C.memoizedState=g,Pa=!0),C=C.queue;var ae=p.bind(null,x,C,s);if(Ne(2048,8,ae,[s]),C.getSnapshot!==h||Q||xi!==null&&xi.memoizedState.tag&1){if(x.flags|=2048,_e(9,Ae(),l.bind(null,x,C,g,h),null),Mr===null)throw Error(a(349));L||($s&124)!==0||n(x,h,g)}return g}function n(s,h,g){s.flags|=16384,s={getSnapshot:h,value:g},h=Ln.updateQueue,h===null?(h=Ho(),Ln.updateQueue=h,h.stores=[s]):(g=h.stores,g===null?h.stores=[s]:g.push(s))}function l(s,h,g,x){h.value=g,h.getSnapshot=x,_(h)&&w(s)}function p(s,h,g){return g(function(){_(h)&&w(s)})}function _(s){var h=s.getSnapshot;s=s.value;try{var g=h();return!Ja(s,g)}catch{return!0}}function w(s){var h=mo(s,2);h!==null&&Eo(h,s,2)}function E(s){var h=$a();if(typeof s=="function"){var g=s;if(s=g(),Ia){di(!0);try{g()}finally{di(!1)}}}return h.memoizedState=h.baseState=s,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:s},h}function M(s,h,g,x){return s.baseState=g,zc(s,mr,typeof x=="function"?x:Ts)}function D(s,h,g,x,C){if(ru(s))throw Error(a(485));if(s=h.action,s!==null){var L={payload:C,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Q){L.listeners.push(Q)}};gt.T!==null?g(!0):L.isTransition=!1,x(L),g=h.pending,g===null?(L.next=h.pending=L,O(h,L)):(L.next=g.next,h.pending=g.next=L)}}function O(s,h){var g=h.action,x=h.payload,C=s.state;if(h.isTransition){var L=gt.T,Q={};gt.T=Q;try{var ae=g(C,x),Pe=gt.S;Pe!==null&&Pe(Q,ae),V(s,h,ae)}catch(rt){j(s,h,rt)}finally{gt.T=L}}else try{L=g(C,x),V(s,h,L)}catch(rt){j(s,h,rt)}}function V(s,h,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(x){$(s,h,x)},function(x){return j(s,h,x)}):$(s,h,g)}function $(s,h,g){h.status="fulfilled",h.value=g,H(h),s.state=g,h=s.pending,h!==null&&(g=h.next,g===h?s.pending=null:(g=g.next,h.next=g,O(s,g)))}function j(s,h,g){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do h.status="rejected",h.reason=g,H(h),h=h.next;while(h!==x)}s.action=null}function H(s){s=s.listeners;for(var h=0;h<s.length;h++)(0,s[h])()}function ee(s,h){return h}function de(s,h){if(or){var g=Mr.formState;if(g!==null){e:{var x=Ln;if(or){if(mi){t:{for(var C=mi,L=Us;C.nodeType!==8;){if(!L){C=null;break t}if(C=Ws(C.nextSibling),C===null){C=null;break t}}L=C.data,C=L==="F!"||L==="F"?C:null}if(C){mi=Ws(C.nextSibling),x=C.data==="F!";break e}}Hl(x)}x=!1}x&&(h=g[0])}}return g=$a(),g.memoizedState=g.baseState=h,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ee,lastRenderedState:h},g.queue=x,g=vl.bind(null,Ln,x),x.dispatch=g,x=E(!1),L=Gs.bind(null,Ln,!1,x.queue),x=$a(),C={state:h,dispatch:null,action:s,pending:null},x.queue=C,g=D.bind(null,Ln,C,L,g),C.dispatch=g,x.memoizedState=s,[h,g,!1]}function he(s){var h=zr();return fe(h,mr,s)}function fe(s,h,g){if(h=zc(s,h,ee)[0],s=Lc(Ts)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var x=ju(h)}catch(Q){throw Q===Ah?Ql:Q}else x=h;h=zr();var C=h.queue,L=C.dispatch;return g!==h.memoizedState&&(Ln.flags|=2048,_e(9,Ae(),ye.bind(null,C,g),null)),[x,L,s]}function ye(s,h){s.action=h}function Te(s){var h=zr(),g=mr;if(g!==null)return fe(h,g,s);zr(),h=h.memoizedState,g=zr();var x=g.queue.dispatch;return g.memoizedState=s,[h,x,!1]}function _e(s,h,g,x){return s={tag:s,create:g,deps:x,inst:h,next:null},h=Ln.updateQueue,h===null&&(h=Ho(),Ln.updateQueue=h),g=h.lastEffect,g===null?h.lastEffect=s.next=s:(x=g.next,g.next=s,s.next=x,h.lastEffect=s),s}function Ae(){return{destroy:void 0,resource:void 0}}function Me(){return zr().memoizedState}function ve(s,h,g,x){var C=$a();x=x===void 0?null:x,Ln.flags|=s,C.memoizedState=_e(1|h,Ae(),g,x)}function Ne(s,h,g,x){var C=zr();x=x===void 0?null:x;var L=C.memoizedState.inst;mr!==null&&x!==null&&Uu(x,mr.memoizedState.deps)?C.memoizedState=_e(h,L,g,x):(Ln.flags|=s,C.memoizedState=_e(1|h,L,g,x))}function tt(s,h){ve(8390656,8,s,h)}function Xe(s,h){Ne(2048,8,s,h)}function Ye(s,h){return Ne(4,2,s,h)}function at(s,h){return Ne(4,4,s,h)}function Dt(s,h){if(typeof h=="function"){s=s();var g=h(s);return function(){typeof g=="function"?g():h(null)}}if(h!=null)return s=s(),h.current=s,function(){h.current=null}}function kt(s,h,g){g=g!=null?g.concat([s]):null,Ne(4,4,Dt.bind(null,h,s),g)}function vt(){}function qt(s,h){var g=zr();h=h===void 0?null:h;var x=g.memoizedState;return h!==null&&Uu(h,x[1])?x[0]:(g.memoizedState=[s,h],s)}function An(s,h){var g=zr();h=h===void 0?null:h;var x=g.memoizedState;if(h!==null&&Uu(h,x[1]))return x[0];if(x=s(),Ia){di(!0);try{s()}finally{di(!1)}}return g.memoizedState=[x,h],x}function Qn(s,h,g){return g===void 0||($s&1073741824)!==0?s.memoizedState=h:(s.memoizedState=g,s=sv(),Ln.lanes|=s,Uc|=s,g)}function Qr(s,h,g,x){return Ja(g,h)?g:qo.current!==null?(s=Qn(s,g,x),Ja(s,h)||(Pa=!0),s):($s&42)===0?(Pa=!0,s.memoizedState=g):(s=sv(),Ln.lanes|=s,Uc|=s,h)}function gr(s,h,g,x,C){var L=Bt.p;Bt.p=L!==0&&8>L?L:8;var Q=gt.T,ae={};gt.T=ae,Gs(s,!1,h,g);try{var Pe=C(),rt=gt.S;if(rt!==null&&rt(ae,Pe),Pe!==null&&typeof Pe=="object"&&typeof Pe.then=="function"){var _t=bo(Pe,x);qs(s,h,_t,Ks(s))}else qs(s,h,x,Ks(s))}catch(Tt){qs(s,h,{then:function(){},status:"rejected",reason:Tt},Ks())}finally{Bt.p=L,gt.T=Q}}function ni(){}function yr(s,h,g,x){if(s.tag!==5)throw Error(a(476));var C=_r(s).queue;gr(s,C,h,nn,g===null?ni:function(){return Ar(s),g(x)})}function _r(s){var h=s.memoizedState;if(h!==null)return h;h={memoizedState:nn,baseState:nn,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:nn},next:null};var g={};return h.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:g},next:null},s.memoizedState=h,s=s.alternate,s!==null&&(s.memoizedState=h),h}function Ar(s){var h=_r(s).next.queue;qs(s,h,{},Ks())}function Ki(){return vi(le)}function Gn(){return zr().memoizedState}function Wi(){return zr().memoizedState}function pa(s){for(var h=s.return;h!==null;){switch(h.tag){case 24:case 3:var g=Ks();s=$o(g);var x=gl(h,s,g);x!==null&&(Eo(x,h,g),eu(x,h,g)),h={cache:Wl()},s.payload=h;return}h=h.return}}function nu(s,h,g){var x=Ks();g={lane:x,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null},ru(s)?Oc(h,g):(g=Pu(s,h,g,x),g!==null&&(Eo(g,s,x),qu(g,h,x)))}function vl(s,h,g){var x=Ks();qs(s,h,g,x)}function qs(s,h,g,x){var C={lane:x,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null};if(ru(s))Oc(h,C);else{var L=s.alternate;if(s.lanes===0&&(L===null||L.lanes===0)&&(L=h.lastRenderedReducer,L!==null))try{var Q=h.lastRenderedState,ae=L(Q,g);if(C.hasEagerState=!0,C.eagerState=ae,Ja(ae,Q))return Cu(s,h,C,0),Mr===null&&Iu(),!1}catch{}finally{}if(g=Pu(s,h,C,x),g!==null)return Eo(g,s,x),qu(g,h,x),!0}return!1}function Gs(s,h,g,x){if(x={lane:2,revertLane:$c(),action:x,hasEagerState:!1,eagerState:null,next:null},ru(s)){if(h)throw Error(a(479))}else h=Pu(s,g,x,2),h!==null&&Eo(h,s,2)}function ru(s){var h=s.alternate;return s===Ln||h!==null&&h===Ln}function Oc(s,h){Dc=Ch=!0;var g=s.pending;g===null?h.next=h:(h.next=g.next,g.next=h),s.pending=h}function qu(s,h,g){if((g&4194048)!==0){var x=h.lanes;x&=s.pendingLanes,g|=x,h.lanes=g,ke(s,g)}}var ma={readContext:vi,use:$u,useCallback:si,useContext:si,useEffect:si,useImperativeHandle:si,useLayoutEffect:si,useInsertionEffect:si,useMemo:si,useReducer:si,useRef:si,useState:si,useDebugValue:si,useDeferredValue:si,useTransition:si,useSyncExternalStore:si,useId:si,useHostTransitionStatus:si,useFormState:si,useActionState:si,useOptimistic:si,useMemoCache:si,useCacheRefresh:si},Hs={readContext:vi,use:$u,useCallback:function(s,h){return $a().memoizedState=[s,h===void 0?null:h],s},useContext:vi,useEffect:tt,useImperativeHandle:function(s,h,g){g=g!=null?g.concat([s]):null,ve(4194308,4,Dt.bind(null,h,s),g)},useLayoutEffect:function(s,h){return ve(4194308,4,s,h)},useInsertionEffect:function(s,h){ve(4,2,s,h)},useMemo:function(s,h){var g=$a();h=h===void 0?null:h;var x=s();if(Ia){di(!0);try{s()}finally{di(!1)}}return g.memoizedState=[x,h],x},useReducer:function(s,h,g){var x=$a();if(g!==void 0){var C=g(h);if(Ia){di(!0);try{g(h)}finally{di(!1)}}}else C=h;return x.memoizedState=x.baseState=C,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:C},x.queue=s,s=s.dispatch=nu.bind(null,Ln,s),[x.memoizedState,s]},useRef:function(s){var h=$a();return s={current:s},h.memoizedState=s},useState:function(s){s=E(s);var h=s.queue,g=vl.bind(null,Ln,h);return h.dispatch=g,[s.memoizedState,g]},useDebugValue:vt,useDeferredValue:function(s,h){var g=$a();return Qn(g,s,h)},useTransition:function(){var s=E(!1);return s=gr.bind(null,Ln,s.queue,!0,!1),$a().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,h,g){var x=Ln,C=$a();if(or){if(g===void 0)throw Error(a(407));g=g()}else{if(g=h(),Mr===null)throw Error(a(349));(rr&124)!==0||n(x,h,g)}C.memoizedState=g;var L={value:g,getSnapshot:h};return C.queue=L,tt(p.bind(null,x,L,s),[s]),x.flags|=2048,_e(9,Ae(),l.bind(null,x,L,g,h),null),g},useId:function(){var s=$a(),h=Mr.identifierPrefix;if(or){var g=_s,x=_o;g=(x&~(1<<32-Ri(x)-1)).toString(32)+g,h="«"+h+"R"+g,g=Fu++,0<g&&(h+="H"+g.toString(32)),h+="»"}else g=Id++,h="«"+h+"r"+g.toString(32)+"»";return s.memoizedState=h},useHostTransitionStatus:Ki,useFormState:de,useActionState:de,useOptimistic:function(s){var h=$a();h.memoizedState=h.baseState=s;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=g,h=Gs.bind(null,Ln,!0,g),g.dispatch=h,[s,h]},useMemoCache:_l,useCacheRefresh:function(){return $a().memoizedState=pa.bind(null,Ln)}},bl={readContext:vi,use:$u,useCallback:qt,useContext:vi,useEffect:Xe,useImperativeHandle:kt,useInsertionEffect:Ye,useLayoutEffect:at,useMemo:An,useReducer:Lc,useRef:Me,useState:function(){return Lc(Ts)},useDebugValue:vt,useDeferredValue:function(s,h){var g=zr();return Qr(g,mr.memoizedState,s,h)},useTransition:function(){var s=Lc(Ts)[0],h=zr().memoizedState;return[typeof s=="boolean"?s:ju(s),h]},useSyncExternalStore:b,useId:Gn,useHostTransitionStatus:Ki,useFormState:he,useActionState:he,useOptimistic:function(s,h){var g=zr();return M(g,mr,s,h)},useMemoCache:_l,useCacheRefresh:Wi},Gu={readContext:vi,use:$u,useCallback:qt,useContext:vi,useEffect:Xe,useImperativeHandle:kt,useInsertionEffect:Ye,useLayoutEffect:at,useMemo:An,useReducer:Ph,useRef:Me,useState:function(){return Ph(Ts)},useDebugValue:vt,useDeferredValue:function(s,h){var g=zr();return mr===null?Qn(g,s,h):Qr(g,mr.memoizedState,s,h)},useTransition:function(){var s=Ph(Ts)[0],h=zr().memoizedState;return[typeof s=="boolean"?s:ju(s),h]},useSyncExternalStore:b,useId:Gn,useHostTransitionStatus:Ki,useFormState:Te,useActionState:Te,useOptimistic:function(s,h){var g=zr();return mr!==null?M(g,mr,s,h):(g.baseState=s,[s,g.queue.dispatch])},useMemoCache:_l,useCacheRefresh:Wi},Or=null,vr=0;function la(s){var h=vr;return vr+=1,Or===null&&(Or=[]),wd(Or,s,h)}function oi(s,h){h=h.props.ref,s.ref=h!==void 0?h:null}function Mh(s,h){throw h.$$typeof===X?Error(a(525)):(s=Object.prototype.toString.call(h),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":s)))}function tm(s){var h=s._init;return h(s._payload)}function Cd(s){function h(Ze,Ue){if(s){var nt=Ze.deletions;nt===null?(Ze.deletions=[Ue],Ze.flags|=16):nt.push(Ue)}}function g(Ze,Ue){if(!s)return null;for(;Ue!==null;)h(Ze,Ue),Ue=Ue.sibling;return null}function x(Ze){for(var Ue=new Map;Ze!==null;)Ze.key!==null?Ue.set(Ze.key,Ze):Ue.set(Ze.index,Ze),Ze=Ze.sibling;return Ue}function C(Ze,Ue){return Ze=Fa(Ze,Ue),Ze.index=0,Ze.sibling=null,Ze}function L(Ze,Ue,nt){return Ze.index=nt,s?(nt=Ze.alternate,nt!==null?(nt=nt.index,nt<Ue?(Ze.flags|=67108866,Ue):nt):(Ze.flags|=67108866,Ue)):(Ze.flags|=1048576,Ue)}function Q(Ze){return s&&Ze.alternate===null&&(Ze.flags|=67108866),Ze}function ae(Ze,Ue,nt,wt){return Ue===null||Ue.tag!==6?(Ue=zf(nt,Ze.mode,wt),Ue.return=Ze,Ue):(Ue=C(Ue,nt),Ue.return=Ze,Ue)}function Pe(Ze,Ue,nt,wt){var en=nt.type;return en===ie?_t(Ze,Ue,nt.props.children,wt,nt.key):Ue!==null&&(Ue.elementType===en||typeof en=="object"&&en!==null&&en.$$typeof===oe&&tm(en)===Ue.type)?(Ue=C(Ue,nt.props),oi(Ue,nt),Ue.return=Ze,Ue):(Ue=bh(nt.type,nt.key,nt.props,null,Ze.mode,wt),oi(Ue,nt),Ue.return=Ze,Ue)}function rt(Ze,Ue,nt,wt){return Ue===null||Ue.tag!==4||Ue.stateNode.containerInfo!==nt.containerInfo||Ue.stateNode.implementation!==nt.implementation?(Ue=Of(nt,Ze.mode,wt),Ue.return=Ze,Ue):(Ue=C(Ue,nt.children||[]),Ue.return=Ze,Ue)}function _t(Ze,Ue,nt,wt,en){return Ue===null||Ue.tag!==7?(Ue=yo(nt,Ze.mode,wt,en),Ue.return=Ze,Ue):(Ue=C(Ue,nt),Ue.return=Ze,Ue)}function Tt(Ze,Ue,nt){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return Ue=zf(""+Ue,Ze.mode,nt),Ue.return=Ze,Ue;if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case G:return nt=bh(Ue.type,Ue.key,Ue.props,null,Ze.mode,nt),oi(nt,Ue),nt.return=Ze,nt;case W:return Ue=Of(Ue,Ze.mode,nt),Ue.return=Ze,Ue;case oe:var wt=Ue._init;return Ue=wt(Ue._payload),Tt(Ze,Ue,nt)}if(jn(Ue)||Ve(Ue))return Ue=yo(Ue,Ze.mode,nt,null),Ue.return=Ze,Ue;if(typeof Ue.then=="function")return Tt(Ze,la(Ue),nt);if(Ue.$$typeof===mt)return Tt(Ze,dl(Ze,Ue),nt);Mh(Ze,Ue)}return null}function ot(Ze,Ue,nt,wt){var en=Ue!==null?Ue.key:null;if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return en!==null?null:ae(Ze,Ue,""+nt,wt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case G:return nt.key===en?Pe(Ze,Ue,nt,wt):null;case W:return nt.key===en?rt(Ze,Ue,nt,wt):null;case oe:return en=nt._init,nt=en(nt._payload),ot(Ze,Ue,nt,wt)}if(jn(nt)||Ve(nt))return en!==null?null:_t(Ze,Ue,nt,wt,null);if(typeof nt.then=="function")return ot(Ze,Ue,la(nt),wt);if(nt.$$typeof===mt)return ot(Ze,Ue,dl(Ze,nt),wt);Mh(Ze,nt)}return null}function ut(Ze,Ue,nt,wt,en){if(typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint")return Ze=Ze.get(nt)||null,ae(Ue,Ze,""+wt,en);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case G:return Ze=Ze.get(wt.key===null?nt:wt.key)||null,Pe(Ue,Ze,wt,en);case W:return Ze=Ze.get(wt.key===null?nt:wt.key)||null,rt(Ue,Ze,wt,en);case oe:var Wn=wt._init;return wt=Wn(wt._payload),ut(Ze,Ue,nt,wt,en)}if(jn(wt)||Ve(wt))return Ze=Ze.get(nt)||null,_t(Ue,Ze,wt,en,null);if(typeof wt.then=="function")return ut(Ze,Ue,nt,la(wt),en);if(wt.$$typeof===mt)return ut(Ze,Ue,nt,dl(Ue,wt),en);Mh(Ue,wt)}return null}function cn(Ze,Ue,nt,wt){for(var en=null,Wn=null,un=Ue,bn=Ue=0,Zr=null;un!==null&&bn<nt.length;bn++){un.index>bn?(Zr=un,un=null):Zr=un.sibling;var ir=ot(Ze,un,nt[bn],wt);if(ir===null){un===null&&(un=Zr);break}s&&un&&ir.alternate===null&&h(Ze,un),Ue=L(ir,Ue,bn),Wn===null?en=ir:Wn.sibling=ir,Wn=ir,un=Zr}if(bn===nt.length)return g(Ze,un),or&&Fs(Ze,bn),en;if(un===null){for(;bn<nt.length;bn++)un=Tt(Ze,nt[bn],wt),un!==null&&(Ue=L(un,Ue,bn),Wn===null?en=un:Wn.sibling=un,Wn=un);return or&&Fs(Ze,bn),en}for(un=x(un);bn<nt.length;bn++)Zr=ut(un,Ze,bn,nt[bn],wt),Zr!==null&&(s&&Zr.alternate!==null&&un.delete(Zr.key===null?bn:Zr.key),Ue=L(Zr,Ue,bn),Wn===null?en=Zr:Wn.sibling=Zr,Wn=Zr);return s&&un.forEach(function(ic){return h(Ze,ic)}),or&&Fs(Ze,bn),en}function yn(Ze,Ue,nt,wt){if(nt==null)throw Error(a(151));for(var en=null,Wn=null,un=Ue,bn=Ue=0,Zr=null,ir=nt.next();un!==null&&!ir.done;bn++,ir=nt.next()){un.index>bn?(Zr=un,un=null):Zr=un.sibling;var ic=ot(Ze,un,ir.value,wt);if(ic===null){un===null&&(un=Zr);break}s&&un&&ic.alternate===null&&h(Ze,un),Ue=L(ic,Ue,bn),Wn===null?en=ic:Wn.sibling=ic,Wn=ic,un=Zr}if(ir.done)return g(Ze,un),or&&Fs(Ze,bn),en;if(un===null){for(;!ir.done;bn++,ir=nt.next())ir=Tt(Ze,ir.value,wt),ir!==null&&(Ue=L(ir,Ue,bn),Wn===null?en=ir:Wn.sibling=ir,Wn=ir);return or&&Fs(Ze,bn),en}for(un=x(un);!ir.done;bn++,ir=nt.next())ir=ut(un,Ze,bn,ir.value,wt),ir!==null&&(s&&ir.alternate!==null&&un.delete(ir.key===null?bn:ir.key),Ue=L(ir,Ue,bn),Wn===null?en=ir:Wn.sibling=ir,Wn=ir);return s&&un.forEach(function(Bb){return h(Ze,Bb)}),or&&Fs(Ze,bn),en}function Ur(Ze,Ue,nt,wt){if(typeof nt=="object"&&nt!==null&&nt.type===ie&&nt.key===null&&(nt=nt.props.children),typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case G:e:{for(var en=nt.key;Ue!==null;){if(Ue.key===en){if(en=nt.type,en===ie){if(Ue.tag===7){g(Ze,Ue.sibling),wt=C(Ue,nt.props.children),wt.return=Ze,Ze=wt;break e}}else if(Ue.elementType===en||typeof en=="object"&&en!==null&&en.$$typeof===oe&&tm(en)===Ue.type){g(Ze,Ue.sibling),wt=C(Ue,nt.props),oi(wt,nt),wt.return=Ze,Ze=wt;break e}g(Ze,Ue);break}else h(Ze,Ue);Ue=Ue.sibling}nt.type===ie?(wt=yo(nt.props.children,Ze.mode,wt,nt.key),wt.return=Ze,Ze=wt):(wt=bh(nt.type,nt.key,nt.props,null,Ze.mode,wt),oi(wt,nt),wt.return=Ze,Ze=wt)}return Q(Ze);case W:e:{for(en=nt.key;Ue!==null;){if(Ue.key===en)if(Ue.tag===4&&Ue.stateNode.containerInfo===nt.containerInfo&&Ue.stateNode.implementation===nt.implementation){g(Ze,Ue.sibling),wt=C(Ue,nt.children||[]),wt.return=Ze,Ze=wt;break e}else{g(Ze,Ue);break}else h(Ze,Ue);Ue=Ue.sibling}wt=Of(nt,Ze.mode,wt),wt.return=Ze,Ze=wt}return Q(Ze);case oe:return en=nt._init,nt=en(nt._payload),Ur(Ze,Ue,nt,wt)}if(jn(nt))return cn(Ze,Ue,nt,wt);if(Ve(nt)){if(en=Ve(nt),typeof en!="function")throw Error(a(150));return nt=en.call(nt),yn(Ze,Ue,nt,wt)}if(typeof nt.then=="function")return Ur(Ze,Ue,la(nt),wt);if(nt.$$typeof===mt)return Ur(Ze,Ue,dl(Ze,nt),wt);Mh(Ze,nt)}return typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint"?(nt=""+nt,Ue!==null&&Ue.tag===6?(g(Ze,Ue.sibling),wt=C(Ue,nt),wt.return=Ze,Ze=wt):(g(Ze,Ue),wt=zf(nt,Ze.mode,wt),wt.return=Ze,Ze=wt),Q(Ze)):g(Ze,Ue)}return function(Ze,Ue,nt,wt){try{vr=0;var en=Ur(Ze,Ue,nt,wt);return Or=null,en}catch(un){if(un===Ah||un===Ql)throw un;var Wn=Va(29,un,null,Ze.mode);return Wn.lanes=wt,Wn.return=Ze,Wn}finally{}}}var Zo=Cd(!0),Hu=Cd(!1),Vi=xt(null),Gr=null;function Ca(s){var h=s.alternate;Rt(wi,wi.current&1),Rt(Vi,s),Gr===null&&(h===null||qo.current!==null||h.memoizedState!==null)&&(Gr=s)}function Pd(s){if(s.tag===22){if(Rt(wi,wi.current),Rt(Vi,s),Gr===null){var h=s.alternate;h!==null&&h.memoizedState!==null&&(Gr=s)}}else qa()}function qa(){Rt(wi,wi.current),Rt(Vi,Vi.current)}function wo(s){It(Vi),Gr===s&&(Gr=null),It(wi)}var wi=xt(0);function iu(s){for(var h=s;h!==null;){if(h.tag===13){var g=h.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||Zd(g)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===s)break;for(;h.sibling===null;){if(h.return===null||h.return===s)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function nm(s,h,g,x){h=s.memoizedState,g=g(x,h),g=g==null?h:B({},h,g),s.memoizedState=g,s.lanes===0&&(s.updateQueue.baseState=g)}var Zu={enqueueSetState:function(s,h,g){s=s._reactInternals;var x=Ks(),C=$o(x);C.payload=h,g!=null&&(C.callback=g),h=gl(s,C,x),h!==null&&(Eo(h,s,x),eu(h,s,x))},enqueueReplaceState:function(s,h,g){s=s._reactInternals;var x=Ks(),C=$o(x);C.tag=1,C.payload=h,g!=null&&(C.callback=g),h=gl(s,C,x),h!==null&&(Eo(h,s,x),eu(h,s,x))},enqueueForceUpdate:function(s,h){s=s._reactInternals;var g=Ks(),x=$o(g);x.tag=2,h!=null&&(x.callback=h),h=gl(s,x,g),h!==null&&(Eo(h,s,g),eu(h,s,g))}};function Nc(s,h,g,x,C,L,Q){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,L,Q):h.prototype&&h.prototype.isPureReactComponent?!Ac(g,x)||!Ac(C,L):!0}function Ig(s,h,g,x){s=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(g,x),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(g,x),h.state!==s&&Zu.enqueueReplaceState(h,h.state,null)}function Rh(s,h){var g=h;if("ref"in h){g={};for(var x in h)x!=="ref"&&(g[x]=h[x])}if(s=s.defaultProps){g===h&&(g=B({},g));for(var C in s)g[C]===void 0&&(g[C]=s[C])}return g}var Md=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Cg(s){Md(s)}function H_(s){console.error(s)}function Pg(s){Md(s)}function rm(s,h){try{var g=s.onUncaughtError;g(h.value,{componentStack:h.stack})}catch(x){setTimeout(function(){throw x})}}function im(s,h,g){try{var x=s.onCaughtError;x(g.value,{componentStack:g.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Mg(s,h,g){return g=$o(g),g.tag=3,g.payload={element:null},g.callback=function(){rm(s,h)},g}function am(s){return s=$o(s),s.tag=3,s}function Rg(s,h,g,x){var C=g.type.getDerivedStateFromError;if(typeof C=="function"){var L=x.value;s.payload=function(){return C(L)},s.callback=function(){im(h,g,x)}}var Q=g.stateNode;Q!==null&&typeof Q.componentDidCatch=="function"&&(s.callback=function(){im(h,g,x),typeof C!="function"&&(Qu===null?Qu=new Set([this]):Qu.add(this));var ae=x.stack;this.componentDidCatch(x.value,{componentStack:ae!==null?ae:""})})}function Z_(s,h,g,x,C){if(g.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(h=g.alternate,h!==null&&Nu(h,g,C,!0),g=Vi.current,g!==null){switch(g.tag){case 13:return Gr===null?ty():g.alternate===null&&Fi===0&&(Fi=3),g.flags&=-257,g.flags|=65536,g.lanes=C,x===Jl?g.flags|=16384:(h=g.updateQueue,h===null?g.updateQueue=new Set([x]):h.add(x),ly(s,x,C)),!1;case 22:return g.flags|=65536,x===Jl?g.flags|=16384:(h=g.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([x])},g.updateQueue=h):(g=h.retryQueue,g===null?h.retryQueue=new Set([x]):g.add(x)),ly(s,x,C)),!1}throw Error(a(435,g.tag))}return ly(s,x,C),ty(),!1}if(or)return h=Vi.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=C,x!==_d&&(s=Error(a(422),{cause:x}),js(gs(s,g)))):(x!==_d&&(h=Error(a(423),{cause:x}),js(gs(h,g))),s=s.current.alternate,s.flags|=65536,C&=-C,s.lanes|=C,x=gs(x,g),C=Mg(s.stateNode,x,C),Vf(s,C),Fi!==4&&(Fi=2)),!1;var L=Error(a(520),{cause:x});if(L=gs(L,g),rp===null?rp=[L]:rp.push(L),Fi!==4&&(Fi=2),h===null)return!0;x=gs(x,g),g=h;do{switch(g.tag){case 3:return g.flags|=65536,s=C&-C,g.lanes|=s,s=Mg(g.stateNode,x,s),Vf(g,s),!1;case 1:if(h=g.type,L=g.stateNode,(g.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(Qu===null||!Qu.has(L))))return g.flags|=65536,C&=-C,g.lanes|=C,C=am(C),Rg(C,s,g,x),Vf(g,C),!1}g=g.return}while(g!==null);return!1}var kh=Error(a(461)),Pa=!1;function Xi(s,h,g,x){h.child=s===null?Hu(h,null,g,x):Zo(h,s.child,g,x)}function $f(s,h,g,x,C){g=g.render;var L=h.ref;if("ref"in x){var Q={};for(var ae in x)ae!=="ref"&&(Q[ae]=x[ae])}else Q=x;return Kl(h),x=fa(s,h,g,Q,L,C),ae=yl(),s!==null&&!Pa?(qr(s,h,C),Ku(s,h,C)):(or&&ae&&zu(h),h.flags|=1,Xi(s,h,x,C),h.child)}function qf(s,h,g,x,C){if(s===null){var L=g.type;return typeof L=="function"&&!kn(L)&&L.defaultProps===void 0&&g.compare===null?(h.tag=15,h.type=L,kg(s,h,L,x,C)):(s=bh(g.type,null,x,h,h.mode,C),s.ref=h.ref,s.return=h,h.child=s)}if(L=s.child,!cm(s,C)){var Q=L.memoizedProps;if(g=g.compare,g=g!==null?g:Ac,g(Q,x)&&s.ref===h.ref)return Ku(s,h,C)}return h.flags|=1,s=Fa(L,x),s.ref=h.ref,s.return=h,h.child=s}function kg(s,h,g,x,C){if(s!==null){var L=s.memoizedProps;if(Ac(L,x)&&s.ref===h.ref)if(Pa=!1,h.pendingProps=x=L,cm(s,C))(s.flags&131072)!==0&&(Pa=!0);else return h.lanes=s.lanes,Ku(s,h,C)}return om(s,h,g,x,C)}function Dg(s,h,g){var x=h.pendingProps,C=x.children,L=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((h.flags&128)!==0){if(x=L!==null?L.baseLanes|g:g,s!==null){for(C=h.child=s.child,L=0;C!==null;)L=L|C.lanes|C.childLanes,C=C.sibling;h.childLanes=L&~x}else h.childLanes=0,h.child=null;return K_(s,h,x,g)}if((g&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},s!==null&&bd(h,L!==null?L.cachePool:null),L!==null?Ad(h,L):Go(),Pd(h);else return h.lanes=h.childLanes=536870912,K_(s,h,L!==null?L.baseLanes|g:g,g)}else L!==null?(bd(h,L.cachePool),Ad(h,L),qa(),h.memoizedState=null):(s!==null&&bd(h,null),Go(),qa());return Xi(s,h,C,g),h.child}function K_(s,h,g,x){var C=Yl();return C=C===null?null:{parent:Bi._currentValue,pool:C},h.memoizedState={baseLanes:g,cachePool:C},s!==null&&bd(h,null),Go(),Pd(h),s!==null&&Nu(s,h,x,!0),null}function sm(s,h){var g=h.ref;if(g===null)s!==null&&s.ref!==null&&(h.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(a(284));(s===null||s.ref!==g)&&(h.flags|=4194816)}}function om(s,h,g,x,C){return Kl(h),g=fa(s,h,g,x,void 0,C),x=yl(),s!==null&&!Pa?(qr(s,h,C),Ku(s,h,C)):(or&&x&&zu(h),h.flags|=1,Xi(s,h,g,C),h.child)}function Lg(s,h,g,x,C,L){return Kl(h),h.updateQueue=null,g=oa(h,x,g,C),jf(s),x=yl(),s!==null&&!Pa?(qr(s,h,L),Ku(s,h,L)):(or&&x&&zu(h),h.flags|=1,Xi(s,h,g,L),h.child)}function zg(s,h,g,x,C){if(Kl(h),h.stateNode===null){var L=go,Q=g.contextType;typeof Q=="object"&&Q!==null&&(L=vi(Q)),L=new g(x,L),h.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=Zu,h.stateNode=L,L._reactInternals=h,L=h.stateNode,L.props=x,L.state=h.memoizedState,L.refs={},Ih(h),Q=g.contextType,L.context=typeof Q=="object"&&Q!==null?vi(Q):go,L.state=h.memoizedState,Q=g.getDerivedStateFromProps,typeof Q=="function"&&(nm(h,g,Q,x),L.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(Q=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),Q!==L.state&&Zu.enqueueReplaceState(L,L.state,null),tu(h,x,L,C),Vu(),L.state=h.memoizedState),typeof L.componentDidMount=="function"&&(h.flags|=4194308),x=!0}else if(s===null){L=h.stateNode;var ae=h.memoizedProps,Pe=Rh(g,ae);L.props=Pe;var rt=L.context,_t=g.contextType;Q=go,typeof _t=="object"&&_t!==null&&(Q=vi(_t));var Tt=g.getDerivedStateFromProps;_t=typeof Tt=="function"||typeof L.getSnapshotBeforeUpdate=="function",ae=h.pendingProps!==ae,_t||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(ae||rt!==Q)&&Ig(h,L,x,Q),ws=!1;var ot=h.memoizedState;L.state=ot,tu(h,x,L,C),Vu(),rt=h.memoizedState,ae||ot!==rt||ws?(typeof Tt=="function"&&(nm(h,g,Tt,x),rt=h.memoizedState),(Pe=ws||Nc(h,g,Pe,x,ot,rt,Q))?(_t||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(h.flags|=4194308)):(typeof L.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=x,h.memoizedState=rt),L.props=x,L.state=rt,L.context=Q,x=Pe):(typeof L.componentDidMount=="function"&&(h.flags|=4194308),x=!1)}else{L=h.stateNode,Dn(s,h),Q=h.memoizedProps,_t=Rh(g,Q),L.props=_t,Tt=h.pendingProps,ot=L.context,rt=g.contextType,Pe=go,typeof rt=="object"&&rt!==null&&(Pe=vi(rt)),ae=g.getDerivedStateFromProps,(rt=typeof ae=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(Q!==Tt||ot!==Pe)&&Ig(h,L,x,Pe),ws=!1,ot=h.memoizedState,L.state=ot,tu(h,x,L,C),Vu();var ut=h.memoizedState;Q!==Tt||ot!==ut||ws||s!==null&&s.dependencies!==null&&Sh(s.dependencies)?(typeof ae=="function"&&(nm(h,g,ae,x),ut=h.memoizedState),(_t=ws||Nc(h,g,_t,x,ot,ut,Pe)||s!==null&&s.dependencies!==null&&Sh(s.dependencies))?(rt||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(x,ut,Pe),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(x,ut,Pe)),typeof L.componentDidUpdate=="function"&&(h.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof L.componentDidUpdate!="function"||Q===s.memoizedProps&&ot===s.memoizedState||(h.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||Q===s.memoizedProps&&ot===s.memoizedState||(h.flags|=1024),h.memoizedProps=x,h.memoizedState=ut),L.props=x,L.state=ut,L.context=Pe,x=_t):(typeof L.componentDidUpdate!="function"||Q===s.memoizedProps&&ot===s.memoizedState||(h.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||Q===s.memoizedProps&&ot===s.memoizedState||(h.flags|=1024),x=!1)}return L=x,sm(s,h),x=(h.flags&128)!==0,L||x?(L=h.stateNode,g=x&&typeof g.getDerivedStateFromError!="function"?null:L.render(),h.flags|=1,s!==null&&x?(h.child=Zo(h,s.child,null,C),h.child=Zo(h,null,g,C)):Xi(s,h,g,C),h.memoizedState=L.state,s=h.child):s=Ku(s,h,C),s}function W_(s,h,g,x){return Mc(),h.flags|=256,Xi(s,h,g,x),h.child}var Gf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function lm(s){return{baseLanes:s,cachePool:Eh()}}function Hf(s,h,g){return s=s!==null?s.childLanes&~g:0,h&&(s|=Yo),s}function Rd(s,h,g){var x=h.pendingProps,C=!1,L=(h.flags&128)!==0,Q;if((Q=L)||(Q=s!==null&&s.memoizedState===null?!1:(wi.current&2)!==0),Q&&(C=!0,h.flags&=-129),Q=(h.flags&32)!==0,h.flags&=-33,s===null){if(or){if(C?Ca(h):qa(),or){var ae=mi,Pe;if(Pe=ae){e:{for(Pe=ae,ae=Us;Pe.nodeType!==8;){if(!ae){ae=null;break e}if(Pe=Ws(Pe.nextSibling),Pe===null){ae=null;break e}}ae=Pe}ae!==null?(h.memoizedState={dehydrated:ae,treeContext:Fo!==null?{id:_o,overflow:_s}:null,retryLane:536870912,hydrationErrors:null},Pe=Va(18,null,null,0),Pe.stateNode=ae,Pe.return=h,h.child=Pe,pi=h,mi=null,Pe=!0):Pe=!1}Pe||Hl(h)}if(ae=h.memoizedState,ae!==null&&(ae=ae.dehydrated,ae!==null))return Zd(ae)?h.lanes=32:h.lanes=536870912,null;wo(h)}return ae=x.children,x=x.fallback,C?(qa(),C=h.mode,ae=Zf({mode:"hidden",children:ae},C),x=yo(x,C,g,null),ae.return=h,x.return=h,ae.sibling=x,h.child=ae,C=h.child,C.memoizedState=lm(g),C.childLanes=Hf(s,Q,g),h.memoizedState=Gf,x):(Ca(h),Ga(h,ae))}if(Pe=s.memoizedState,Pe!==null&&(ae=Pe.dehydrated,ae!==null)){if(L)h.flags&256?(Ca(h),h.flags&=-257,h=Kf(s,h,g)):h.memoizedState!==null?(qa(),h.child=s.child,h.flags|=128,h=null):(qa(),C=x.fallback,ae=h.mode,x=Zf({mode:"visible",children:x.children},ae),C=yo(C,ae,g,null),C.flags|=2,x.return=h,C.return=h,x.sibling=C,h.child=x,Zo(h,s.child,null,g),x=h.child,x.memoizedState=lm(g),x.childLanes=Hf(s,Q,g),h.memoizedState=Gf,h=C);else if(Ca(h),Zd(ae)){if(Q=ae.nextSibling&&ae.nextSibling.dataset,Q)var rt=Q.dgst;Q=rt,x=Error(a(419)),x.stack="",x.digest=Q,js({value:x,source:null,stack:null}),h=Kf(s,h,g)}else if(Pa||Nu(s,h,g,!1),Q=(g&s.childLanes)!==0,Pa||Q){if(Q=Mr,Q!==null&&(x=g&-g,x=(x&42)!==0?1:Lt(x),x=(x&(Q.suspendedLanes|g))!==0?0:x,x!==0&&x!==Pe.retryLane))throw Pe.retryLane=x,mo(s,x),Eo(Q,s,x),kh;ae.data==="$?"||ty(),h=Kf(s,h,g)}else ae.data==="$?"?(h.flags|=192,h.child=s.child,h=null):(s=Pe.treeContext,mi=Ws(ae.nextSibling),pi=h,or=!0,Uo=null,Us=!1,s!==null&&(Ua[Aa++]=_o,Ua[Aa++]=_s,Ua[Aa++]=Fo,_o=s.id,_s=s.overflow,Fo=h),h=Ga(h,x.children),h.flags|=4096);return h}return C?(qa(),C=x.fallback,ae=h.mode,Pe=s.child,rt=Pe.sibling,x=Fa(Pe,{mode:"hidden",children:x.children}),x.subtreeFlags=Pe.subtreeFlags&65011712,rt!==null?C=Fa(rt,C):(C=yo(C,ae,g,null),C.flags|=2),C.return=h,x.return=h,x.sibling=C,h.child=x,x=C,C=h.child,ae=s.child.memoizedState,ae===null?ae=lm(g):(Pe=ae.cachePool,Pe!==null?(rt=Bi._currentValue,Pe=Pe.parent!==rt?{parent:rt,pool:rt}:Pe):Pe=Eh(),ae={baseLanes:ae.baseLanes|g,cachePool:Pe}),C.memoizedState=ae,C.childLanes=Hf(s,Q,g),h.memoizedState=Gf,x):(Ca(h),g=s.child,s=g.sibling,g=Fa(g,{mode:"visible",children:x.children}),g.return=h,g.sibling=null,s!==null&&(Q=h.deletions,Q===null?(h.deletions=[s],h.flags|=16):Q.push(s)),h.child=g,h.memoizedState=null,g)}function Ga(s,h){return h=Zf({mode:"visible",children:h},s.mode),h.return=s,s.child=h}function Zf(s,h){return s=Va(22,s,null,h),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Kf(s,h,g){return Zo(h,s.child,null,g),s=Ga(h,h.pendingProps.children),s.flags|=2,h.memoizedState=null,s}function X_(s,h,g){s.lanes|=h;var x=s.alternate;x!==null&&(x.lanes|=h),Th(s.return,h,g)}function um(s,h,g,x,C){var L=s.memoizedState;L===null?s.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:x,tail:g,tailMode:C}:(L.isBackwards=h,L.rendering=null,L.renderingStartTime=0,L.last=x,L.tail=g,L.tailMode=C)}function Y_(s,h,g){var x=h.pendingProps,C=x.revealOrder,L=x.tail;if(Xi(s,h,x.children,g),x=wi.current,(x&2)!==0)x=x&1|2,h.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=h.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&X_(s,g,h);else if(s.tag===19)X_(s,g,h);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===h)break e;for(;s.sibling===null;){if(s.return===null||s.return===h)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(Rt(wi,x),C){case"forwards":for(g=h.child,C=null;g!==null;)s=g.alternate,s!==null&&iu(s)===null&&(C=g),g=g.sibling;g=C,g===null?(C=h.child,h.child=null):(C=g.sibling,g.sibling=null),um(h,!1,C,g,L);break;case"backwards":for(g=null,C=h.child,h.child=null;C!==null;){if(s=C.alternate,s!==null&&iu(s)===null){h.child=C;break}s=C.sibling,C.sibling=g,g=C,C=s}um(h,!0,g,null,L);break;case"together":um(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Ku(s,h,g){if(s!==null&&(h.dependencies=s.dependencies),Uc|=h.lanes,(g&h.childLanes)===0)if(s!==null){if(Nu(s,h,g,!1),(g&h.childLanes)===0)return null}else return null;if(s!==null&&h.child!==s.child)throw Error(a(153));if(h.child!==null){for(s=h.child,g=Fa(s,s.pendingProps),h.child=g,g.return=h;s.sibling!==null;)s=s.sibling,g=g.sibling=Fa(s,s.pendingProps),g.return=h;g.sibling=null}return h.child}function cm(s,h){return(s.lanes&h)!==0?!0:(s=s.dependencies,!!(s!==null&&Sh(s)))}function Cb(s,h,g){switch(h.tag){case 3:wr(h,h.stateNode.containerInfo),bs(h,Bi,s.memoizedState.cache),Mc();break;case 27:case 5:ks(h);break;case 4:wr(h,h.stateNode.containerInfo);break;case 10:bs(h,h.type,h.memoizedProps.value);break;case 13:var x=h.memoizedState;if(x!==null)return x.dehydrated!==null?(Ca(h),h.flags|=128,null):(g&h.child.childLanes)!==0?Rd(s,h,g):(Ca(h),s=Ku(s,h,g),s!==null?s.sibling:null);Ca(h);break;case 19:var C=(s.flags&128)!==0;if(x=(g&h.childLanes)!==0,x||(Nu(s,h,g,!1),x=(g&h.childLanes)!==0),C){if(x)return Y_(s,h,g);h.flags|=128}if(C=h.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),Rt(wi,wi.current),x)break;return null;case 22:case 23:return h.lanes=0,Dg(s,h,g);case 24:bs(h,Bi,s.memoizedState.cache)}return Ku(s,h,g)}function hm(s,h,g){if(s!==null)if(s.memoizedProps!==h.pendingProps)Pa=!0;else{if(!cm(s,g)&&(h.flags&128)===0)return Pa=!1,Cb(s,h,g);Pa=(s.flags&131072)!==0}else Pa=!1,or&&(h.flags&1048576)!==0&&Lu(h,Du,h.index);switch(h.lanes=0,h.tag){case 16:e:{s=h.pendingProps;var x=h.elementType,C=x._init;if(x=C(x._payload),h.type=x,typeof x=="function")kn(x)?(s=Rh(x,s),h.tag=1,h=zg(null,h,x,s,g)):(h.tag=0,h=om(null,h,x,s,g));else{if(x!=null){if(C=x.$$typeof,C===qe){h.tag=11,h=$f(null,h,x,s,g);break e}else if(C===pe){h.tag=14,h=qf(null,h,x,s,g);break e}}throw h=Yn(x)||x,Error(a(306,h,""))}}return h;case 0:return om(s,h,h.type,h.pendingProps,g);case 1:return x=h.type,C=Rh(x,h.pendingProps),zg(s,h,x,C,g);case 3:e:{if(wr(h,h.stateNode.containerInfo),s===null)throw Error(a(387));x=h.pendingProps;var L=h.memoizedState;C=L.element,Dn(s,h),tu(h,x,null,g);var Q=h.memoizedState;if(x=Q.cache,bs(h,Bi,x),x!==L.cache&&Ou(h,[Bi],g,!0),Vu(),x=Q.element,L.isDehydrated)if(L={element:x,isDehydrated:!1,cache:Q.cache},h.updateQueue.baseState=L,h.memoizedState=L,h.flags&256){h=W_(s,h,x,g);break e}else if(x!==C){C=gs(Error(a(424)),h),js(C),h=W_(s,h,x,g);break e}else{switch(s=h.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(mi=Ws(s.firstChild),pi=h,or=!0,Uo=null,Us=!0,g=Hu(h,null,x,g),h.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(Mc(),x===C){h=Ku(s,h,g);break e}Xi(s,h,x,g)}h=h.child}return h;case 26:return sm(s,h),s===null?(g=My(h.type,null,h.pendingProps,null))?h.memoizedState=g:or||(g=h.type,s=h.pendingProps,x=pp(fn.current).createElement(g),x[Tn]=h,x[gn]=s,Br(x,g,s),Qt(x),h.stateNode=x):h.memoizedState=My(h.type,s.memoizedProps,h.pendingProps,s.memoizedState),null;case 27:return ks(h),s===null&&or&&(x=h.stateNode=wv(h.type,h.pendingProps,fn.current),pi=h,Us=!0,C=mi,Gc(h.type)?(Sy=C,mi=Ws(x.firstChild)):mi=C),Xi(s,h,h.pendingProps.children,g),sm(s,h),s===null&&(h.flags|=4194304),h.child;case 5:return s===null&&or&&((C=x=mi)&&(x=km(x,h.type,h.pendingProps,Us),x!==null?(h.stateNode=x,pi=h,mi=Ws(x.firstChild),Us=!1,C=!0):C=!1),C||Hl(h)),ks(h),C=h.type,L=h.pendingProps,Q=s!==null?s.memoizedProps:null,x=L.children,by(C,L)?x=null:Q!==null&&by(C,Q)&&(h.flags|=32),h.memoizedState!==null&&(C=fa(s,h,em,null,null,g),le._currentValue=C),sm(s,h),Xi(s,h,x,g),h.child;case 6:return s===null&&or&&((s=g=mi)&&(g=bv(g,h.pendingProps,Us),g!==null?(h.stateNode=g,pi=h,mi=null,s=!0):s=!1),s||Hl(h)),null;case 13:return Rd(s,h,g);case 4:return wr(h,h.stateNode.containerInfo),x=h.pendingProps,s===null?h.child=Zo(h,null,x,g):Xi(s,h,x,g),h.child;case 11:return $f(s,h,h.type,h.pendingProps,g);case 7:return Xi(s,h,h.pendingProps,g),h.child;case 8:return Xi(s,h,h.pendingProps.children,g),h.child;case 12:return Xi(s,h,h.pendingProps.children,g),h.child;case 10:return x=h.pendingProps,bs(h,h.type,x.value),Xi(s,h,x.children,g),h.child;case 9:return C=h.type._context,x=h.pendingProps.children,Kl(h),C=vi(C),x=x(C),h.flags|=1,Xi(s,h,x,g),h.child;case 14:return qf(s,h,h.type,h.pendingProps,g);case 15:return kg(s,h,h.type,h.pendingProps,g);case 19:return Y_(s,h,g);case 31:return x=h.pendingProps,g=h.mode,x={mode:x.mode,children:x.children},s===null?(g=Zf(x,g),g.ref=h.ref,h.child=g,g.return=h,h=g):(g=Fa(s.child,x),g.ref=h.ref,h.child=g,g.return=h,h=g),h;case 22:return Dg(s,h,g);case 24:return Kl(h),x=vi(Bi),s===null?(C=Yl(),C===null&&(C=Mr,L=Wl(),C.pooledCache=L,L.refCount++,L!==null&&(C.pooledCacheLanes|=g),C=L),h.memoizedState={parent:x,cache:C},Ih(h),bs(h,Bi,C)):((s.lanes&g)!==0&&(Dn(s,h),tu(h,null,null,g),Vu()),C=s.memoizedState,L=h.memoizedState,C.parent!==x?(C={parent:x,cache:x},h.memoizedState=C,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=C),bs(h,Bi,x)):(x=L.cache,bs(h,Bi,x),x!==C.cache&&Ou(h,[Bi],g,!0))),Xi(s,h,h.pendingProps.children,g),h.child;case 29:throw h.pendingProps}throw Error(a(156,h.tag))}function au(s){s.flags|=4}function Og(s,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!I(h)){if(h=Vi.current,h!==null&&((rr&4194048)===rr?Gr!==null:(rr&62914560)!==rr&&(rr&536870912)===0||h!==Gr))throw ml=Jl,xd;s.flags|=8192}}function dm(s,h){h!==null&&(s.flags|=4),s.flags&16384&&(h=s.tag!==22?Be():536870912,s.lanes|=h,Nd|=h)}function Wf(s,h){if(!or)switch(s.tailMode){case"hidden":h=s.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?s.tail=null:g.sibling=null;break;case"collapsed":g=s.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?h||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Ti(s){var h=s.alternate!==null&&s.alternate.child===s.child,g=0,x=0;if(h)for(var C=s.child;C!==null;)g|=C.lanes|C.childLanes,x|=C.subtreeFlags&65011712,x|=C.flags&65011712,C.return=s,C=C.sibling;else for(C=s.child;C!==null;)g|=C.lanes|C.childLanes,x|=C.subtreeFlags,x|=C.flags,C.return=s,C=C.sibling;return s.subtreeFlags|=x,s.childLanes=g,h}function Ng(s,h,g){var x=h.pendingProps;switch(xh(h),h.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ti(h),null;case 1:return Ti(h),null;case 3:return g=h.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),h.memoizedState.cache!==x&&(h.flags|=2048),ts(Bi),Ir(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(s===null||s.child===null)&&(Zl(h)?au(h):s===null||s.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,ti())),Ti(h),null;case 26:return g=h.memoizedState,s===null?(au(h),g!==null?(Ti(h),Og(h,g)):(Ti(h),h.flags&=-16777217)):g?g!==s.memoizedState?(au(h),Ti(h),Og(h,g)):(Ti(h),h.flags&=-16777217):(s.memoizedProps!==x&&au(h),Ti(h),h.flags&=-16777217),null;case 27:gi(h),g=fn.current;var C=h.type;if(s!==null&&h.stateNode!=null)s.memoizedProps!==x&&au(h);else{if(!x){if(h.stateNode===null)throw Error(a(166));return Ti(h),null}s=Yt.current,Zl(h)?Pc(h):(s=wv(C,x,g),h.stateNode=s,au(h))}return Ti(h),null;case 5:if(gi(h),g=h.type,s!==null&&h.stateNode!=null)s.memoizedProps!==x&&au(h);else{if(!x){if(h.stateNode===null)throw Error(a(166));return Ti(h),null}if(s=Yt.current,Zl(h))Pc(h);else{switch(C=pp(fn.current),s){case 1:s=C.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:s=C.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":s=C.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":s=C.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":s=C.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?C.createElement("select",{is:x.is}):C.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?C.createElement(g,{is:x.is}):C.createElement(g)}}s[Tn]=h,s[gn]=x;e:for(C=h.child;C!==null;){if(C.tag===5||C.tag===6)s.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===h)break e;for(;C.sibling===null;){if(C.return===null||C.return===h)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}h.stateNode=s;e:switch(Br(s,g,x),g){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&au(h)}}return Ti(h),h.flags&=-16777217,null;case 6:if(s&&h.stateNode!=null)s.memoizedProps!==x&&au(h);else{if(typeof x!="string"&&h.stateNode===null)throw Error(a(166));if(s=fn.current,Zl(h)){if(s=h.stateNode,g=h.memoizedProps,x=null,C=pi,C!==null)switch(C.tag){case 27:case 5:x=C.memoizedProps}s[Tn]=h,s=!!(s.nodeValue===g||x!==null&&x.suppressHydrationWarning===!0||Gd(s.nodeValue,g)),s||Hl(h)}else s=pp(s).createTextNode(x),s[Tn]=h,h.stateNode=s}return Ti(h),null;case 13:if(x=h.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(C=Zl(h),x!==null&&x.dehydrated!==null){if(s===null){if(!C)throw Error(a(318));if(C=h.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(a(317));C[Tn]=h}else Mc(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ti(h),C=!1}else C=ti(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=C),C=!0;if(!C)return h.flags&256?(wo(h),h):(wo(h),null)}if(wo(h),(h.flags&128)!==0)return h.lanes=g,h;if(g=x!==null,s=s!==null&&s.memoizedState!==null,g){x=h.child,C=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(C=x.alternate.memoizedState.cachePool.pool);var L=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(L=x.memoizedState.cachePool.pool),L!==C&&(x.flags|=2048)}return g!==s&&g&&(h.child.flags|=8192),dm(h,h.updateQueue),Ti(h),null;case 4:return Ir(),s===null&&py(h.stateNode.containerInfo),Ti(h),null;case 10:return ts(h.type),Ti(h),null;case 19:if(It(wi),C=h.memoizedState,C===null)return Ti(h),null;if(x=(h.flags&128)!==0,L=C.rendering,L===null)if(x)Wf(C,!1);else{if(Fi!==0||s!==null&&(s.flags&128)!==0)for(s=h.child;s!==null;){if(L=iu(s),L!==null){for(h.flags|=128,Wf(C,!1),s=L.updateQueue,h.updateQueue=s,dm(h,s),h.subtreeFlags=0,s=g,g=h.child;g!==null;)Lf(g,s),g=g.sibling;return Rt(wi,wi.current&1|2),h.child}s=s.sibling}C.tail!==null&&Cr()>ip&&(h.flags|=128,x=!0,Wf(C,!1),h.lanes=4194304)}else{if(!x)if(s=iu(L),s!==null){if(h.flags|=128,x=!0,s=s.updateQueue,h.updateQueue=s,dm(h,s),Wf(C,!0),C.tail===null&&C.tailMode==="hidden"&&!L.alternate&&!or)return Ti(h),null}else 2*Cr()-C.renderingStartTime>ip&&g!==536870912&&(h.flags|=128,x=!0,Wf(C,!1),h.lanes=4194304);C.isBackwards?(L.sibling=h.child,h.child=L):(s=C.last,s!==null?s.sibling=L:h.child=L,C.last=L)}return C.tail!==null?(h=C.tail,C.rendering=h,C.tail=h.sibling,C.renderingStartTime=Cr(),h.sibling=null,s=wi.current,Rt(wi,x?s&1|2:s&1),h):(Ti(h),null);case 22:case 23:return wo(h),Lr(),x=h.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(h.flags|=8192):x&&(h.flags|=8192),x?(g&536870912)!==0&&(h.flags&128)===0&&(Ti(h),h.subtreeFlags&6&&(h.flags|=8192)):Ti(h),g=h.updateQueue,g!==null&&dm(h,g.retryQueue),g=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(g=s.memoizedState.cachePool.pool),x=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==g&&(h.flags|=2048),s!==null&&It(bi),null;case 24:return g=null,s!==null&&(g=s.memoizedState.cache),h.memoizedState.cache!==g&&(h.flags|=2048),ts(Bi),Ti(h),null;case 25:return null;case 30:return null}throw Error(a(156,h.tag))}function Bg(s,h){switch(xh(h),h.tag){case 1:return s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 3:return ts(Bi),Ir(),s=h.flags,(s&65536)!==0&&(s&128)===0?(h.flags=s&-65537|128,h):null;case 26:case 27:case 5:return gi(h),null;case 13:if(wo(h),s=h.memoizedState,s!==null&&s.dehydrated!==null){if(h.alternate===null)throw Error(a(340));Mc()}return s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 19:return It(wi),null;case 4:return Ir(),null;case 10:return ts(h.type),null;case 22:case 23:return wo(h),Lr(),s!==null&&It(bi),s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 24:return ts(Bi),null;case 25:return null;default:return null}}function Vg(s,h){switch(xh(h),h.tag){case 3:ts(Bi),Ir();break;case 26:case 27:case 5:gi(h);break;case 4:Ir();break;case 13:wo(h);break;case 19:It(wi);break;case 10:ts(h.type);break;case 22:case 23:wo(h),Lr(),s!==null&&It(bi);break;case 24:ts(Bi)}}function xl(s,h){try{var g=h.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var C=x.next;g=C;do{if((g.tag&s)===s){x=void 0;var L=g.create,Q=g.inst;x=L(),Q.destroy=x}g=g.next}while(g!==C)}}catch(ae){Nr(h,h.return,ae)}}function Ko(s,h,g){try{var x=h.updateQueue,C=x!==null?x.lastEffect:null;if(C!==null){var L=C.next;x=L;do{if((x.tag&s)===s){var Q=x.inst,ae=Q.destroy;if(ae!==void 0){Q.destroy=void 0,C=h;var Pe=g,rt=ae;try{rt()}catch(_t){Nr(C,Pe,_t)}}}x=x.next}while(x!==L)}}catch(_t){Nr(h,h.return,_t)}}function Q_(s){var h=s.updateQueue;if(h!==null){var g=s.stateNode;try{Uf(h,g)}catch(x){Nr(s,s.return,x)}}}function J_(s,h,g){g.props=Rh(s.type,s.memoizedProps),g.state=s.memoizedState;try{g.componentWillUnmount()}catch(x){Nr(s,h,x)}}function Xf(s,h){try{var g=s.ref;if(g!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof g=="function"?s.refCleanup=g(x):g.current=x}}catch(C){Nr(s,h,C)}}function su(s,h){var g=s.ref,x=s.refCleanup;if(g!==null)if(typeof x=="function")try{x()}catch(C){Nr(s,h,C)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(C){Nr(s,h,C)}else g.current=null}function ev(s){var h=s.type,g=s.memoizedProps,x=s.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":g.autoFocus&&x.focus();break e;case"img":g.src?x.src=g.src:g.srcSet&&(x.srcset=g.srcSet)}}catch(C){Nr(s,s.return,C)}}function Fg(s,h,g){try{var x=s.stateNode;Hd(x,s.type,g,h),x[gn]=h}catch(C){Nr(s,s.return,C)}}function tv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Gc(s.type)||s.tag===4}function Yf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||tv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Gc(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ug(s,h,g){var x=s.tag;if(x===5||x===6)s=s.stateNode,h?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(s,h):(h=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,h.appendChild(s),g=g._reactRootContainer,g!=null||h.onclick!==null||(h.onclick=fp));else if(x!==4&&(x===27&&Gc(s.type)&&(g=s.stateNode,h=null),s=s.child,s!==null))for(Ug(s,h,g),s=s.sibling;s!==null;)Ug(s,h,g),s=s.sibling}function Qf(s,h,g){var x=s.tag;if(x===5||x===6)s=s.stateNode,h?g.insertBefore(s,h):g.appendChild(s);else if(x!==4&&(x===27&&Gc(s.type)&&(g=s.stateNode),s=s.child,s!==null))for(Qf(s,h,g),s=s.sibling;s!==null;)Qf(s,h,g),s=s.sibling}function kd(s){var h=s.stateNode,g=s.memoizedProps;try{for(var x=s.type,C=h.attributes;C.length;)h.removeAttributeNode(C[0]);Br(h,x,g),h[Tn]=s,h[gn]=g}catch(L){Nr(s,s.return,L)}}var Wu=!1,On=!1,Bc=!1,jg=typeof WeakSet=="function"?WeakSet:Set,Yi=null;function fm(s,h){if(s=s.containerInfo,rc=yt,s=yh(s),po(s)){if("selectionStart"in s)var g={start:s.selectionStart,end:s.selectionEnd};else e:{g=(g=s.ownerDocument)&&g.defaultView||window;var x=g.getSelection&&g.getSelection();if(x&&x.rangeCount!==0){g=x.anchorNode;var C=x.anchorOffset,L=x.focusNode;x=x.focusOffset;try{g.nodeType,L.nodeType}catch{g=null;break e}var Q=0,ae=-1,Pe=-1,rt=0,_t=0,Tt=s,ot=null;t:for(;;){for(var ut;Tt!==g||C!==0&&Tt.nodeType!==3||(ae=Q+C),Tt!==L||x!==0&&Tt.nodeType!==3||(Pe=Q+x),Tt.nodeType===3&&(Q+=Tt.nodeValue.length),(ut=Tt.firstChild)!==null;)ot=Tt,Tt=ut;for(;;){if(Tt===s)break t;if(ot===g&&++rt===C&&(ae=Q),ot===L&&++_t===x&&(Pe=Q),(ut=Tt.nextSibling)!==null)break;Tt=ot,ot=Tt.parentNode}Tt=ut}g=ae===-1||Pe===-1?null:{start:ae,end:Pe}}else g=null}g=g||{start:0,end:0}}else g=null;for(Pm={focusedElem:s,selectionRange:g},yt=!1,Yi=h;Yi!==null;)if(h=Yi,s=h.child,(h.subtreeFlags&1024)!==0&&s!==null)s.return=h,Yi=s;else for(;Yi!==null;){switch(h=Yi,L=h.alternate,s=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&L!==null){s=void 0,g=h,C=L.memoizedProps,L=L.memoizedState,x=g.stateNode;try{var cn=Rh(g.type,C,g.elementType===g.type);s=x.getSnapshotBeforeUpdate(cn,L),x.__reactInternalSnapshotBeforeUpdate=s}catch(yn){Nr(g,g.return,yn)}}break;case 3:if((s&1024)!==0){if(s=h.stateNode.containerInfo,g=s.nodeType,g===9)Rm(s);else if(g===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Rm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=h.sibling,s!==null){s.return=h.return,Yi=s;break}Yi=h.return}}function Dd(s,h,g){var x=g.flags;switch(g.tag){case 0:case 11:case 15:Xo(s,g),x&4&&xl(5,g);break;case 1:if(Xo(s,g),x&4)if(s=g.stateNode,h===null)try{s.componentDidMount()}catch(Q){Nr(g,g.return,Q)}else{var C=Rh(g.type,h.memoizedProps);h=h.memoizedState;try{s.componentDidUpdate(C,h,s.__reactInternalSnapshotBeforeUpdate)}catch(Q){Nr(g,g.return,Q)}}x&64&&Q_(g),x&512&&Xf(g,g.return);break;case 3:if(Xo(s,g),x&64&&(s=g.updateQueue,s!==null)){if(h=null,g.child!==null)switch(g.child.tag){case 27:case 5:h=g.child.stateNode;break;case 1:h=g.child.stateNode}try{Uf(s,h)}catch(Q){Nr(g,g.return,Q)}}break;case 27:h===null&&x&4&&kd(g);case 26:case 5:Xo(s,g),h===null&&x&4&&ev(g),x&512&&Xf(g,g.return);break;case 12:Xo(s,g);break;case 13:Xo(s,g),x&4&&Jf(s,g),x&64&&(s=g.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(g=Mb.bind(null,g),Dm(s,g))));break;case 22:if(x=g.memoizedState!==null||Wu,!x){h=h!==null&&h.memoizedState!==null||On,C=Wu;var L=On;Wu=x,(On=h)&&!L?Yu(s,g,(g.subtreeFlags&8772)!==0):Xo(s,g),Wu=C,On=L}break;case 30:break;default:Xo(s,g)}}function $g(s){var h=s.alternate;h!==null&&(s.alternate=null,$g(h)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(h=s.stateNode,h!==null&&cr(h)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var li=null,Ma=!1;function wl(s,h,g){for(g=g.child;g!==null;)Dh(s,h,g),g=g.sibling}function Dh(s,h,g){if(zn&&typeof zn.onCommitFiberUnmount=="function")try{zn.onCommitFiberUnmount(fr,g)}catch{}switch(g.tag){case 26:On||su(g,h),wl(s,h,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:On||su(g,h);var x=li,C=Ma;Gc(g.type)&&(li=g.stateNode,Ma=!1),wl(s,h,g),hu(g.stateNode),li=x,Ma=C;break;case 5:On||su(g,h);case 6:if(x=li,C=Ma,li=null,wl(s,h,g),li=x,Ma=C,li!==null)if(Ma)try{(li.nodeType===9?li.body:li.nodeName==="HTML"?li.ownerDocument.body:li).removeChild(g.stateNode)}catch(L){Nr(g,h,L)}else try{li.removeChild(g.stateNode)}catch(L){Nr(g,h,L)}break;case 18:li!==null&&(Ma?(s=li,Ty(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,g.stateNode),hi(s)):Ty(li,g.stateNode));break;case 4:x=li,C=Ma,li=g.stateNode.containerInfo,Ma=!0,wl(s,h,g),li=x,Ma=C;break;case 0:case 11:case 14:case 15:On||Ko(2,g,h),On||Ko(4,g,h),wl(s,h,g);break;case 1:On||(su(g,h),x=g.stateNode,typeof x.componentWillUnmount=="function"&&J_(g,h,x)),wl(s,h,g);break;case 21:wl(s,h,g);break;case 22:On=(x=On)||g.memoizedState!==null,wl(s,h,g),On=x;break;default:wl(s,h,g)}}function Jf(s,h){if(h.memoizedState===null&&(s=h.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{hi(s)}catch(g){Nr(h,h.return,g)}}function Ld(s){switch(s.tag){case 13:case 19:var h=s.stateNode;return h===null&&(h=s.stateNode=new jg),h;case 22:return s=s.stateNode,h=s._retryCache,h===null&&(h=s._retryCache=new jg),h;default:throw Error(a(435,s.tag))}}function Lh(s,h){var g=Ld(s);h.forEach(function(x){var C=Rb.bind(null,s,x);g.has(x)||(g.add(x),x.then(C,C))})}function To(s,h){var g=h.deletions;if(g!==null)for(var x=0;x<g.length;x++){var C=g[x],L=s,Q=h,ae=Q;e:for(;ae!==null;){switch(ae.tag){case 27:if(Gc(ae.type)){li=ae.stateNode,Ma=!1;break e}break;case 5:li=ae.stateNode,Ma=!1;break e;case 3:case 4:li=ae.stateNode.containerInfo,Ma=!0;break e}ae=ae.return}if(li===null)throw Error(a(160));Dh(L,Q,C),li=null,Ma=!1,L=C.alternate,L!==null&&(L.return=null),C.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)Vc(h,s),h=h.sibling}var Wo=null;function Vc(s,h){var g=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:To(h,s),So(s),x&4&&(Ko(3,s,s.return),xl(3,s),Ko(5,s,s.return));break;case 1:To(h,s),So(s),x&512&&(On||g===null||su(g,g.return)),x&64&&Wu&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(g=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=g===null?x:g.concat(x))));break;case 26:var C=Wo;if(To(h,s),So(s),x&512&&(On||g===null||su(g,g.return)),x&4){var L=g!==null?g.memoizedState:null;if(x=s.memoizedState,g===null)if(x===null)if(s.stateNode===null){e:{x=s.type,g=s.memoizedProps,C=C.ownerDocument||C;t:switch(x){case"title":L=C.getElementsByTagName("title")[0],(!L||L[ai]||L[Tn]||L.namespaceURI==="http://www.w3.org/2000/svg"||L.hasAttribute("itemprop"))&&(L=C.createElement(x),C.head.insertBefore(L,C.querySelector("head > title"))),Br(L,x,g),L[Tn]=s,Qt(L),x=L;break e;case"link":var Q=v("link","href",C).get(x+(g.href||""));if(Q){for(var ae=0;ae<Q.length;ae++)if(L=Q[ae],L.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&L.getAttribute("rel")===(g.rel==null?null:g.rel)&&L.getAttribute("title")===(g.title==null?null:g.title)&&L.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){Q.splice(ae,1);break t}}L=C.createElement(x),Br(L,x,g),C.head.appendChild(L);break;case"meta":if(Q=v("meta","content",C).get(x+(g.content||""))){for(ae=0;ae<Q.length;ae++)if(L=Q[ae],L.getAttribute("content")===(g.content==null?null:""+g.content)&&L.getAttribute("name")===(g.name==null?null:g.name)&&L.getAttribute("property")===(g.property==null?null:g.property)&&L.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&L.getAttribute("charset")===(g.charSet==null?null:g.charSet)){Q.splice(ae,1);break t}}L=C.createElement(x),Br(L,x,g),C.head.appendChild(L);break;default:throw Error(a(468,x))}L[Tn]=s,Qt(L),x=L}s.stateNode=x}else T(C,s.type,s.stateNode);else s.stateNode=Ev(C,x,s.memoizedProps);else L!==x?(L===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):L.count--,x===null?T(C,s.type,s.stateNode):Ev(C,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Fg(s,s.memoizedProps,g.memoizedProps)}break;case 27:To(h,s),So(s),x&512&&(On||g===null||su(g,g.return)),g!==null&&x&4&&Fg(s,s.memoizedProps,g.memoizedProps);break;case 5:if(To(h,s),So(s),x&512&&(On||g===null||su(g,g.return)),s.flags&32){C=s.stateNode;try{Oa(C,"")}catch(ut){Nr(s,s.return,ut)}}x&4&&s.stateNode!=null&&(C=s.memoizedProps,Fg(s,C,g!==null?g.memoizedProps:C)),x&1024&&(Bc=!0);break;case 6:if(To(h,s),So(s),x&4){if(s.stateNode===null)throw Error(a(162));x=s.memoizedProps,g=s.stateNode;try{g.nodeValue=x}catch(ut){Nr(s,s.return,ut)}}break;case 3:if(f=null,C=Wo,Wo=mp(h.containerInfo),To(h,s),Wo=C,So(s),x&4&&g!==null&&g.memoizedState.isDehydrated)try{hi(h.containerInfo)}catch(ut){Nr(s,s.return,ut)}Bc&&(Bc=!1,qg(s));break;case 4:x=Wo,Wo=mp(s.stateNode.containerInfo),To(h,s),So(s),Wo=x;break;case 12:To(h,s),So(s);break;case 13:To(h,s),So(s),s.child.flags&8192&&s.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Wg=Cr()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Lh(s,x)));break;case 22:C=s.memoizedState!==null;var Pe=g!==null&&g.memoizedState!==null,rt=Wu,_t=On;if(Wu=rt||C,On=_t||Pe,To(h,s),On=_t,Wu=rt,So(s),x&8192)e:for(h=s.stateNode,h._visibility=C?h._visibility&-2:h._visibility|1,C&&(g===null||Pe||Wu||On||Xu(s)),g=null,h=s;;){if(h.tag===5||h.tag===26){if(g===null){Pe=g=h;try{if(L=Pe.stateNode,C)Q=L.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none";else{ae=Pe.stateNode;var Tt=Pe.memoizedProps.style,ot=Tt!=null&&Tt.hasOwnProperty("display")?Tt.display:null;ae.style.display=ot==null||typeof ot=="boolean"?"":(""+ot).trim()}}catch(ut){Nr(Pe,Pe.return,ut)}}}else if(h.tag===6){if(g===null){Pe=h;try{Pe.stateNode.nodeValue=C?"":Pe.memoizedProps}catch(ut){Nr(Pe,Pe.return,ut)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===s)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===s)break e;for(;h.sibling===null;){if(h.return===null||h.return===s)break e;g===h&&(g=null),h=h.return}g===h&&(g=null),h.sibling.return=h.return,h=h.sibling}x&4&&(x=s.updateQueue,x!==null&&(g=x.retryQueue,g!==null&&(x.retryQueue=null,Lh(s,g))));break;case 19:To(h,s),So(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Lh(s,x)));break;case 30:break;case 21:break;default:To(h,s),So(s)}}function So(s){var h=s.flags;if(h&2){try{for(var g,x=s.return;x!==null;){if(tv(x)){g=x;break}x=x.return}if(g==null)throw Error(a(160));switch(g.tag){case 27:var C=g.stateNode,L=Yf(s);Qf(s,L,C);break;case 5:var Q=g.stateNode;g.flags&32&&(Oa(Q,""),g.flags&=-33);var ae=Yf(s);Qf(s,ae,Q);break;case 3:case 4:var Pe=g.stateNode.containerInfo,rt=Yf(s);Ug(s,rt,Pe);break;default:throw Error(a(161))}}catch(_t){Nr(s,s.return,_t)}s.flags&=-3}h&4096&&(s.flags&=-4097)}function qg(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var h=s;qg(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),s=s.sibling}}function Xo(s,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)Dd(s,h.alternate,h),h=h.sibling}function Xu(s){for(s=s.child;s!==null;){var h=s;switch(h.tag){case 0:case 11:case 14:case 15:Ko(4,h,h.return),Xu(h);break;case 1:su(h,h.return);var g=h.stateNode;typeof g.componentWillUnmount=="function"&&J_(h,h.return,g),Xu(h);break;case 27:hu(h.stateNode);case 26:case 5:su(h,h.return),Xu(h);break;case 22:h.memoizedState===null&&Xu(h);break;case 30:Xu(h);break;default:Xu(h)}s=s.sibling}}function Yu(s,h,g){for(g=g&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var x=h.alternate,C=s,L=h,Q=L.flags;switch(L.tag){case 0:case 11:case 15:Yu(C,L,g),xl(4,L);break;case 1:if(Yu(C,L,g),x=L,C=x.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(rt){Nr(x,x.return,rt)}if(x=L,C=x.updateQueue,C!==null){var ae=x.stateNode;try{var Pe=C.shared.hiddenCallbacks;if(Pe!==null)for(C.shared.hiddenCallbacks=null,C=0;C<Pe.length;C++)Sd(Pe[C],ae)}catch(rt){Nr(x,x.return,rt)}}g&&Q&64&&Q_(L),Xf(L,L.return);break;case 27:kd(L);case 26:case 5:Yu(C,L,g),g&&x===null&&Q&4&&ev(L),Xf(L,L.return);break;case 12:Yu(C,L,g);break;case 13:Yu(C,L,g),g&&Q&4&&Jf(C,L);break;case 22:L.memoizedState===null&&Yu(C,L,g),Xf(L,L.return);break;case 30:break;default:Yu(C,L,g)}h=h.sibling}}function pm(s,h){var g=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(g=s.memoizedState.cachePool.pool),s=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(s=h.memoizedState.cachePool.pool),s!==g&&(s!=null&&s.refCount++,g!=null&&Bu(g))}function Gg(s,h){s=null,h.alternate!==null&&(s=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==s&&(h.refCount++,s!=null&&Bu(s))}function ou(s,h,g,x){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)nv(s,h,g,x),h=h.sibling}function nv(s,h,g,x){var C=h.flags;switch(h.tag){case 0:case 11:case 15:ou(s,h,g,x),C&2048&&xl(9,h);break;case 1:ou(s,h,g,x);break;case 3:ou(s,h,g,x),C&2048&&(s=null,h.alternate!==null&&(s=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==s&&(h.refCount++,s!=null&&Bu(s)));break;case 12:if(C&2048){ou(s,h,g,x),s=h.stateNode;try{var L=h.memoizedProps,Q=L.id,ae=L.onPostCommit;typeof ae=="function"&&ae(Q,h.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Pe){Nr(h,h.return,Pe)}}else ou(s,h,g,x);break;case 13:ou(s,h,g,x);break;case 23:break;case 22:L=h.stateNode,Q=h.alternate,h.memoizedState!==null?L._visibility&2?ou(s,h,g,x):ep(s,h):L._visibility&2?ou(s,h,g,x):(L._visibility|=2,zd(s,h,g,x,(h.subtreeFlags&10256)!==0)),C&2048&&pm(Q,h);break;case 24:ou(s,h,g,x),C&2048&&Gg(h.alternate,h);break;default:ou(s,h,g,x)}}function zd(s,h,g,x,C){for(C=C&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var L=s,Q=h,ae=g,Pe=x,rt=Q.flags;switch(Q.tag){case 0:case 11:case 15:zd(L,Q,ae,Pe,C),xl(8,Q);break;case 23:break;case 22:var _t=Q.stateNode;Q.memoizedState!==null?_t._visibility&2?zd(L,Q,ae,Pe,C):ep(L,Q):(_t._visibility|=2,zd(L,Q,ae,Pe,C)),C&&rt&2048&&pm(Q.alternate,Q);break;case 24:zd(L,Q,ae,Pe,C),C&&rt&2048&&Gg(Q.alternate,Q);break;default:zd(L,Q,ae,Pe,C)}h=h.sibling}}function ep(s,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var g=s,x=h,C=x.flags;switch(x.tag){case 22:ep(g,x),C&2048&&pm(x.alternate,x);break;case 24:ep(g,x),C&2048&&Gg(x.alternate,x);break;default:ep(g,x)}h=h.sibling}}var zh=8192;function Oh(s){if(s.subtreeFlags&zh)for(s=s.child;s!==null;)mm(s),s=s.sibling}function mm(s){switch(s.tag){case 26:Oh(s),s.flags&zh&&s.memoizedState!==null&&N(Wo,s.memoizedState,s.memoizedProps);break;case 5:Oh(s);break;case 3:case 4:var h=Wo;Wo=mp(s.stateNode.containerInfo),Oh(s),Wo=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=zh,zh=16777216,Oh(s),zh=h):Oh(s));break;default:Oh(s)}}function Hg(s){var h=s.alternate;if(h!==null&&(s=h.child,s!==null)){h.child=null;do h=s.sibling,s.sibling=null,s=h;while(s!==null)}}function Nh(s){var h=s.deletions;if((s.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var x=h[g];Yi=x,np(x,s)}Hg(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Zg(s),s=s.sibling}function Zg(s){switch(s.tag){case 0:case 11:case 15:Nh(s),s.flags&2048&&Ko(9,s,s.return);break;case 3:Nh(s);break;case 12:Nh(s);break;case 22:var h=s.stateNode;s.memoizedState!==null&&h._visibility&2&&(s.return===null||s.return.tag!==13)?(h._visibility&=-3,tp(s)):Nh(s);break;default:Nh(s)}}function tp(s){var h=s.deletions;if((s.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var x=h[g];Yi=x,np(x,s)}Hg(s)}for(s=s.child;s!==null;){switch(h=s,h.tag){case 0:case 11:case 15:Ko(8,h,h.return),tp(h);break;case 22:g=h.stateNode,g._visibility&2&&(g._visibility&=-3,tp(h));break;default:tp(h)}s=s.sibling}}function np(s,h){for(;Yi!==null;){var g=Yi;switch(g.tag){case 0:case 11:case 15:Ko(8,g,h);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var x=g.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Bu(g.memoizedState.cache)}if(x=g.child,x!==null)x.return=g,Yi=x;else e:for(g=s;Yi!==null;){x=Yi;var C=x.sibling,L=x.return;if($g(x),x===g){Yi=null;break e}if(C!==null){C.return=L,Yi=C;break e}Yi=L}}}var rv={getCacheForType:function(s){var h=vi(Bi),g=h.data.get(s);return g===void 0&&(g=s(),h.data.set(s,g)),g}},iv=typeof WeakMap=="function"?WeakMap:Map,Pr=0,Mr=null,Jn=null,rr=0,hr=0,Ss=null,Fc=!1,Od=!1,gm=!1,lu=0,Fi=0,Uc=0,Tl=0,ym=0,Yo=0,Nd=0,rp=null,Zs=null,Kg=!1,Wg=0,ip=1/0,Bd=null,Qu=null,Ra=0,Ju=null,Vd=null,ec=0,Xg=0,_m=null,av=null,ap=0,Yg=null;function Ks(){if((Pr&2)!==0&&rr!==0)return rr&-rr;if(gt.T!==null){var s=fl;return s!==0?s:$c()}return Vt()}function sv(){Yo===0&&(Yo=(rr&536870912)===0||or?Je():536870912);var s=Vi.current;return s!==null&&(s.flags|=32),Yo}function Eo(s,h,g){(s===Mr&&(hr===2||hr===9)||s.cancelPendingCommit!==null)&&(Ud(s,0),tc(s,rr,Yo,!1)),it(s,g),((Pr&2)===0||s!==Mr)&&(s===Mr&&((Pr&2)===0&&(Tl|=g),Fi===4&&tc(s,rr,Yo,!1)),Jo(s))}function Fd(s,h,g){if((Pr&6)!==0)throw Error(a(327));var x=!g&&(h&124)===0&&(h&s.expiredLanes)===0||De(s,h),C=x?ov(s,h):ny(s,h,!0),L=x;do{if(C===0){Od&&!x&&tc(s,h,0,!1);break}else{if(g=s.current.alternate,L&&!Jg(g)){C=ny(s,h,!1),L=!1;continue}if(C===2){if(L=h,s.errorRecoveryDisabledLanes&L)var Q=0;else Q=s.pendingLanes&-536870913,Q=Q!==0?Q:Q&536870912?536870912:0;if(Q!==0){h=Q;e:{var ae=s;C=rp;var Pe=ae.current.memoizedState.isDehydrated;if(Pe&&(Ud(ae,Q).flags|=256),Q=ny(ae,Q,!1),Q!==2){if(gm&&!Pe){ae.errorRecoveryDisabledLanes|=L,Tl|=L,C=4;break e}L=Zs,Zs=C,L!==null&&(Zs===null?Zs=L:Zs.push.apply(Zs,L))}C=Q}if(L=!1,C!==2)continue}}if(C===1){Ud(s,0),tc(s,h,0,!0);break}e:{switch(x=s,L=C,L){case 0:case 1:throw Error(a(345));case 4:if((h&4194048)!==h)break;case 6:tc(x,h,Yo,!Fc);break e;case 2:Zs=null;break;case 3:case 5:break;default:throw Error(a(329))}if((h&62914560)===h&&(C=Wg+300-Cr(),10<C)){if(tc(x,h,Yo,!Fc),xe(x,0,!0)!==0)break e;x.timeoutHandle=xy(Qg.bind(null,x,g,Zs,Bd,Kg,h,Yo,Tl,Nd,Fc,L,2,-0,0),C);break e}Qg(x,g,Zs,Bd,Kg,h,Yo,Tl,Nd,Fc,L,0,-0,0)}}break}while(!0);Jo(s)}function Qg(s,h,g,x,C,L,Q,ae,Pe,rt,_t,Tt,ot,ut){if(s.timeoutHandle=-1,Tt=h.subtreeFlags,(Tt&8192||(Tt&16785408)===16785408)&&(R={stylesheets:null,count:0,unsuspend:z},mm(h),Tt=U(),Tt!==null)){s.cancelPendingCommit=Tt(lv.bind(null,s,h,L,g,x,C,Q,ae,Pe,_t,1,ot,ut)),tc(s,L,Q,!rt);return}lv(s,h,L,g,x,C,Q,ae,Pe)}function Jg(s){for(var h=s;;){var g=h.tag;if((g===0||g===11||g===15)&&h.flags&16384&&(g=h.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var x=0;x<g.length;x++){var C=g[x],L=C.getSnapshot;C=C.value;try{if(!Ja(L(),C))return!1}catch{return!1}}if(g=h.child,h.subtreeFlags&16384&&g!==null)g.return=h,h=g;else{if(h===s)break;for(;h.sibling===null;){if(h.return===null||h.return===s)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function tc(s,h,g,x){h&=~ym,h&=~Tl,s.suspendedLanes|=h,s.pingedLanes&=~h,x&&(s.warmLanes|=h),x=s.expirationTimes;for(var C=h;0<C;){var L=31-Ri(C),Q=1<<L;x[L]=-1,C&=~Q}g!==0&&ft(s,g,h)}function Si(){return(Pr&6)===0?(up(0),!1):!0}function sp(){if(Jn!==null){if(hr===0)var s=Jn.return;else s=Jn,vs=jo=null,Yr(s),Or=null,vr=0,s=Jn;for(;s!==null;)Vg(s.alternate,s),s=s.return;Jn=null}}function Ud(s,h){var g=s.timeoutHandle;g!==-1&&(s.timeoutHandle=-1,_v(g)),g=s.cancelPendingCommit,g!==null&&(s.cancelPendingCommit=null,g()),sp(),Mr=s,Jn=g=Fa(s.current,null),rr=h,hr=0,Ss=null,Fc=!1,Od=De(s,h),gm=!1,Nd=Yo=ym=Tl=Uc=Fi=0,Zs=rp=null,Kg=!1,(h&8)!==0&&(h|=h&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=h;0<x;){var C=31-Ri(x),L=1<<C;h|=s[C],x&=~L}return lu=h,Iu(),g}function ey(s,h){Ln=null,gt.H=ma,h===Ah||h===Ql?(h=Td(),hr=3):h===xd?(h=Td(),hr=4):hr=h===kh?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,Ss=h,Jn===null&&(Fi=1,rm(s,gs(h,s.current)))}function nc(){var s=gt.H;return gt.H=ma,s===null?ma:s}function vm(){var s=gt.A;return gt.A=rv,s}function ty(){Fi=4,Fc||(rr&4194048)!==rr&&Vi.current!==null||(Od=!0),(Uc&134217727)===0&&(Tl&134217727)===0||Mr===null||tc(Mr,rr,Yo,!1)}function ny(s,h,g){var x=Pr;Pr|=2;var C=nc(),L=vm();(Mr!==s||rr!==h)&&(Bd=null,Ud(s,h)),h=!1;var Q=Fi;e:do try{if(hr!==0&&Jn!==null){var ae=Jn,Pe=Ss;switch(hr){case 8:sp(),Q=6;break e;case 3:case 2:case 9:case 6:Vi.current===null&&(h=!0);var rt=hr;if(hr=0,Ss=null,Sl(s,ae,Pe,rt),g&&Od){Q=0;break e}break;default:rt=hr,hr=0,Ss=null,Sl(s,ae,Pe,rt)}}Pb(),Q=Fi;break}catch(_t){ey(s,_t)}while(!0);return h&&s.shellSuspendCounter++,vs=jo=null,Pr=x,gt.H=C,gt.A=L,Jn===null&&(Mr=null,rr=0,Iu()),Q}function Pb(){for(;Jn!==null;)iy(Jn)}function ov(s,h){var g=Pr;Pr|=2;var x=nc(),C=vm();Mr!==s||rr!==h?(Bd=null,ip=Cr()+500,Ud(s,h)):Od=De(s,h);e:do try{if(hr!==0&&Jn!==null){h=Jn;var L=Ss;t:switch(hr){case 1:hr=0,Ss=null,Sl(s,h,L,1);break;case 2:case 9:if(xo(L)){hr=0,Ss=null,jd(h);break}h=function(){hr!==2&&hr!==9||Mr!==s||(hr=7),Jo(s)},L.then(h,h);break e;case 3:hr=7;break e;case 4:hr=5;break e;case 7:xo(L)?(hr=0,Ss=null,jd(h)):(hr=0,Ss=null,Sl(s,h,L,7));break;case 5:var Q=null;switch(Jn.tag){case 26:Q=Jn.memoizedState;case 5:case 27:var ae=Jn;if(!Q||I(Q)){hr=0,Ss=null;var Pe=ae.sibling;if(Pe!==null)Jn=Pe;else{var rt=ae.return;rt!==null?(Jn=rt,Bh(rt)):Jn=null}break t}}hr=0,Ss=null,Sl(s,h,L,5);break;case 6:hr=0,Ss=null,Sl(s,h,L,6);break;case 8:sp(),Fi=6;break e;default:throw Error(a(462))}}ry();break}catch(_t){ey(s,_t)}while(!0);return vs=jo=null,gt.H=x,gt.A=C,Pr=g,Jn!==null?0:(Mr=null,rr=0,Iu(),Fi)}function ry(){for(;Jn!==null&&!_a();)iy(Jn)}function iy(s){var h=hm(s.alternate,s,lu);s.memoizedProps=s.pendingProps,h===null?Bh(s):Jn=h}function jd(s){var h=s,g=h.alternate;switch(h.tag){case 15:case 0:h=Lg(g,h,h.pendingProps,h.type,void 0,rr);break;case 11:h=Lg(g,h,h.pendingProps,h.type.render,h.ref,rr);break;case 5:Yr(h);default:Vg(g,h),h=Jn=Lf(h,lu),h=hm(g,h,lu)}s.memoizedProps=s.pendingProps,h===null?Bh(s):Jn=h}function Sl(s,h,g,x){vs=jo=null,Yr(h),Or=null,vr=0;var C=h.return;try{if(Z_(s,C,h,g,rr)){Fi=1,rm(s,gs(g,s.current)),Jn=null;return}}catch(L){if(C!==null)throw Jn=C,L;Fi=1,rm(s,gs(g,s.current)),Jn=null;return}h.flags&32768?(or||x===1?s=!0:Od||(rr&536870912)!==0?s=!1:(Fc=s=!0,(x===2||x===9||x===3||x===6)&&(x=Vi.current,x!==null&&x.tag===13&&(x.flags|=16384))),op(h,s)):Bh(h)}function Bh(s){var h=s;do{if((h.flags&32768)!==0){op(h,Fc);return}s=h.return;var g=Ng(h.alternate,h,lu);if(g!==null){Jn=g;return}if(h=h.sibling,h!==null){Jn=h;return}Jn=h=s}while(h!==null);Fi===0&&(Fi=5)}function op(s,h){do{var g=Bg(s.alternate,s);if(g!==null){g.flags&=32767,Jn=g;return}if(g=s.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!h&&(s=s.sibling,s!==null)){Jn=s;return}Jn=s=g}while(s!==null);Fi=6,Jn=null}function lv(s,h,g,x,C,L,Q,ae,Pe){s.cancelPendingCommit=null;do lp();while(Ra!==0);if((Pr&6)!==0)throw Error(a(327));if(h!==null){if(h===s.current)throw Error(a(177));if(L=h.lanes|h.childLanes,L|=cl,Ge(s,g,L,Q,ae,Pe),s===Mr&&(Jn=Mr=null,rr=0),Vd=h,Ju=s,ec=g,Xg=L,_m=C,av=x,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,kb(Wa,function(){return oy(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||x){x=gt.T,gt.T=null,C=Bt.p,Bt.p=2,Q=Pr,Pr|=4;try{fm(s,h,g)}finally{Pr=Q,Bt.p=C,gt.T=x}}Ra=1,uv(),ay(),sy()}}function uv(){if(Ra===1){Ra=0;var s=Ju,h=Vd,g=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||g){g=gt.T,gt.T=null;var x=Bt.p;Bt.p=2;var C=Pr;Pr|=4;try{Vc(h,s);var L=Pm,Q=yh(s.containerInfo),ae=L.focusedElem,Pe=L.selectionRange;if(Q!==ae&&ae&&ae.ownerDocument&&nr(ae.ownerDocument.documentElement,ae)){if(Pe!==null&&po(ae)){var rt=Pe.start,_t=Pe.end;if(_t===void 0&&(_t=rt),"selectionStart"in ae)ae.selectionStart=rt,ae.selectionEnd=Math.min(_t,ae.value.length);else{var Tt=ae.ownerDocument||document,ot=Tt&&Tt.defaultView||window;if(ot.getSelection){var ut=ot.getSelection(),cn=ae.textContent.length,yn=Math.min(Pe.start,cn),Ur=Pe.end===void 0?yn:Math.min(Pe.end,cn);!ut.extend&&yn>Ur&&(Q=Ur,Ur=yn,yn=Q);var Ze=fd(ae,yn),Ue=fd(ae,Ur);if(Ze&&Ue&&(ut.rangeCount!==1||ut.anchorNode!==Ze.node||ut.anchorOffset!==Ze.offset||ut.focusNode!==Ue.node||ut.focusOffset!==Ue.offset)){var nt=Tt.createRange();nt.setStart(Ze.node,Ze.offset),ut.removeAllRanges(),yn>Ur?(ut.addRange(nt),ut.extend(Ue.node,Ue.offset)):(nt.setEnd(Ue.node,Ue.offset),ut.addRange(nt))}}}}for(Tt=[],ut=ae;ut=ut.parentNode;)ut.nodeType===1&&Tt.push({element:ut,left:ut.scrollLeft,top:ut.scrollTop});for(typeof ae.focus=="function"&&ae.focus(),ae=0;ae<Tt.length;ae++){var wt=Tt[ae];wt.element.scrollLeft=wt.left,wt.element.scrollTop=wt.top}}yt=!!rc,Pm=rc=null}finally{Pr=C,Bt.p=x,gt.T=g}}s.current=h,Ra=2}}function ay(){if(Ra===2){Ra=0;var s=Ju,h=Vd,g=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||g){g=gt.T,gt.T=null;var x=Bt.p;Bt.p=2;var C=Pr;Pr|=4;try{Dd(s,h.alternate,h)}finally{Pr=C,Bt.p=x,gt.T=g}}Ra=3}}function sy(){if(Ra===4||Ra===3){Ra=0,nl();var s=Ju,h=Vd,g=ec,x=av;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Ra=5:(Ra=0,Vd=Ju=null,cv(s,s.pendingLanes));var C=s.pendingLanes;if(C===0&&(Qu=null),rn(g),h=h.stateNode,zn&&typeof zn.onCommitFiberRoot=="function")try{zn.onCommitFiberRoot(fr,h,void 0,(h.current.flags&128)===128)}catch{}if(x!==null){h=gt.T,C=Bt.p,Bt.p=2,gt.T=null;try{for(var L=s.onRecoverableError,Q=0;Q<x.length;Q++){var ae=x[Q];L(ae.value,{componentStack:ae.stack})}}finally{gt.T=h,Bt.p=C}}(ec&3)!==0&&lp(),Jo(s),C=s.pendingLanes,(g&4194090)!==0&&(C&42)!==0?s===Yg?ap++:(ap=0,Yg=s):ap=0,up(0)}}function cv(s,h){(s.pooledCacheLanes&=h)===0&&(h=s.pooledCache,h!=null&&(s.pooledCache=null,Bu(h)))}function lp(s){return uv(),ay(),sy(),oy()}function oy(){if(Ra!==5)return!1;var s=Ju,h=Xg;Xg=0;var g=rn(ec),x=gt.T,C=Bt.p;try{Bt.p=32>g?32:g,gt.T=null,g=_m,_m=null;var L=Ju,Q=ec;if(Ra=0,Vd=Ju=null,ec=0,(Pr&6)!==0)throw Error(a(331));var ae=Pr;if(Pr|=4,Zg(L.current),nv(L,L.current,Q,g),Pr=ae,up(0,!1),zn&&typeof zn.onPostCommitFiberRoot=="function")try{zn.onPostCommitFiberRoot(fr,L)}catch{}return!0}finally{Bt.p=C,gt.T=x,cv(s,h)}}function bm(s,h,g){h=gs(g,h),h=Mg(s.stateNode,h,2),s=gl(s,h,2),s!==null&&(it(s,2),Jo(s))}function Nr(s,h,g){if(s.tag===3)bm(s,s,g);else for(;h!==null;){if(h.tag===3){bm(h,s,g);break}else if(h.tag===1){var x=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Qu===null||!Qu.has(x))){s=gs(g,s),g=am(2),x=gl(h,g,2),x!==null&&(Rg(g,x,h,s),it(x,2),Jo(x));break}}h=h.return}}function ly(s,h,g){var x=s.pingCache;if(x===null){x=s.pingCache=new iv;var C=new Set;x.set(h,C)}else C=x.get(h),C===void 0&&(C=new Set,x.set(h,C));C.has(g)||(gm=!0,C.add(g),s=hv.bind(null,s,h,g),h.then(s,s))}function hv(s,h,g){var x=s.pingCache;x!==null&&x.delete(h),s.pingedLanes|=s.suspendedLanes&g,s.warmLanes&=~g,Mr===s&&(rr&g)===g&&(Fi===4||Fi===3&&(rr&62914560)===rr&&300>Cr()-Wg?(Pr&2)===0&&Ud(s,0):ym|=g,Nd===rr&&(Nd=0)),Jo(s)}function dv(s,h){h===0&&(h=Be()),s=mo(s,h),s!==null&&(it(s,h),Jo(s))}function Mb(s){var h=s.memoizedState,g=0;h!==null&&(g=h.retryLane),dv(s,g)}function Rb(s,h){var g=0;switch(s.tag){case 13:var x=s.stateNode,C=s.memoizedState;C!==null&&(g=C.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(a(314))}x!==null&&x.delete(h),dv(s,g)}function kb(s,h){return Tr(s,h)}var xm=null,Vh=null,wm=!1,Qo=!1,uu=!1,jc=0;function Jo(s){s!==Vh&&s.next===null&&(Vh===null?xm=Vh=s:Vh=Vh.next=s),Qo=!0,wm||(wm=!0,uy())}function up(s,h){if(!uu&&Qo){uu=!0;do for(var g=!1,x=xm;x!==null;){if(s!==0){var C=x.pendingLanes;if(C===0)var L=0;else{var Q=x.suspendedLanes,ae=x.pingedLanes;L=(1<<31-Ri(42|s)+1)-1,L&=C&~(Q&~ae),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(g=!0,Sm(x,L))}else L=rr,L=xe(x,x===Mr?L:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(L&3)===0||De(x,L)||(g=!0,Sm(x,L));x=x.next}while(g);uu=!1}}function Db(){cp()}function cp(){Qo=wm=!1;var s=0;jc!==0&&(qc()&&(s=jc),jc=0);for(var h=Cr(),g=null,x=xm;x!==null;){var C=x.next,L=Tm(x,h);L===0?(x.next=null,g===null?xm=C:g.next=C,C===null&&(Vh=g)):(g=x,(s!==0||(L&3)!==0)&&(Qo=!0)),x=C}up(s)}function Tm(s,h){for(var g=s.suspendedLanes,x=s.pingedLanes,C=s.expirationTimes,L=s.pendingLanes&-62914561;0<L;){var Q=31-Ri(L),ae=1<<Q,Pe=C[Q];Pe===-1?((ae&g)===0||(ae&x)!==0)&&(C[Q]=je(ae,h)):Pe<=h&&(s.expiredLanes|=ae),L&=~ae}if(h=Mr,g=rr,g=xe(s,s===h?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,g===0||s===h&&(hr===2||hr===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&ya(x),s.callbackNode=null,s.callbackPriority=0;if((g&3)===0||De(s,g)){if(h=g&-g,h===s.callbackPriority)return h;switch(x!==null&&ya(x),rn(g)){case 2:case 8:g=Ds;break;case 32:g=Wa;break;case 268435456:g=Ls;break;default:g=Wa}return x=fv.bind(null,s),g=Tr(g,x),s.callbackPriority=h,s.callbackNode=g,h}return x!==null&&x!==null&&ya(x),s.callbackPriority=2,s.callbackNode=null,2}function fv(s,h){if(Ra!==0&&Ra!==5)return s.callbackNode=null,s.callbackPriority=0,null;var g=s.callbackNode;if(lp()&&s.callbackNode!==g)return null;var x=rr;return x=xe(s,s===Mr?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(Fd(s,x,h),Tm(s,Cr()),s.callbackNode!=null&&s.callbackNode===g?fv.bind(null,s):null)}function Sm(s,h){if(lp())return null;Fd(s,h,!0)}function uy(){vv(function(){(Pr&6)!==0?Tr(na,Db):cp()})}function $c(){return jc===0&&(jc=Je()),jc}function cy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:zl(""+s)}function hy(s,h){var g=h.ownerDocument.createElement("input");return g.name=h.name,g.value=h.value,s.id&&g.setAttribute("form",s.id),h.parentNode.insertBefore(g,h),s=new FormData(s),g.parentNode.removeChild(g),s}function dy(s,h,g,x,C){if(h==="submit"&&g&&g.stateNode===C){var L=cy((C[gn]||null).action),Q=x.submitter;Q&&(h=(h=Q[gn]||null)?cy(h.formAction):Q.getAttribute("formAction"),h!==null&&(L=h,Q=null));var ae=new uo("action","action",null,x,C);s.push({event:ae,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(jc!==0){var Pe=Q?hy(C,Q):new FormData(C);yr(g,{pending:!0,data:Pe,method:C.method,action:L},null,Pe)}}else typeof L=="function"&&(ae.preventDefault(),Pe=Q?hy(C,Q):new FormData(C),yr(g,{pending:!0,data:Pe,method:C.method,action:L},L,Pe))},currentTarget:C}]})}}for(var Em=0;Em<Au.length;Em++){var $d=Au[Em],pv=$d.toLowerCase(),Lb=$d[0].toUpperCase()+$d.slice(1);Ea(pv,"on"+Lb)}Ea(Mf,"onAnimationEnd"),Ea(Qp,"onAnimationIteration"),Ea(Rf,"onAnimationStart"),Ea("dblclick","onDoubleClick"),Ea("focusin","onFocus"),Ea("focusout","onBlur"),Ea(pd,"onTransitionRun"),Ea(md,"onTransitionStart"),Ea(gd,"onTransitionCancel"),Ea(yd,"onTransitionEnd"),pn("onMouseEnter",["mouseout","mouseover"]),pn("onMouseLeave",["mouseout","mouseover"]),pn("onPointerEnter",["pointerout","pointerover"]),pn("onPointerLeave",["pointerout","pointerover"]),ki("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ki("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ki("onBeforeInput",["compositionend","keypress","textInput","paste"]),ki("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ki("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ki("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hp));function gv(s,h){h=(h&4)!==0;for(var g=0;g<s.length;g++){var x=s[g],C=x.event;x=x.listeners;e:{var L=void 0;if(h)for(var Q=x.length-1;0<=Q;Q--){var ae=x[Q],Pe=ae.instance,rt=ae.currentTarget;if(ae=ae.listener,Pe!==L&&C.isPropagationStopped())break e;L=ae,C.currentTarget=rt;try{L(C)}catch(_t){Md(_t)}C.currentTarget=null,L=Pe}else for(Q=0;Q<x.length;Q++){if(ae=x[Q],Pe=ae.instance,rt=ae.currentTarget,ae=ae.listener,Pe!==L&&C.isPropagationStopped())break e;L=ae,C.currentTarget=rt;try{L(C)}catch(_t){Md(_t)}C.currentTarget=null,L=Pe}}}}function er(s,h){var g=h[on];g===void 0&&(g=h[on]=new Set);var x=s+"__bubble";g.has(x)||(Im(h,s,2,!1),g.add(x))}function fy(s,h,g){var x=0;h&&(x|=4),Im(g,s,x,h)}var Am="_reactListening"+Math.random().toString(36).slice(2);function py(s){if(!s[Am]){s[Am]=!0,ha.forEach(function(g){g!=="selectionchange"&&(mv.has(g)||fy(g,!1,s),fy(g,!0,s))});var h=s.nodeType===9?s:s.ownerDocument;h===null||h[Am]||(h[Am]=!0,fy("selectionchange",!1,h))}}function Im(s,h,g,x){switch(Gt(h)){case 2:var C=st;break;case 8:C=ht;break;default:C=St}g=C.bind(null,h,g,s),C=void 0,!Er||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(C=!0),x?C!==void 0?s.addEventListener(h,g,{capture:!0,passive:C}):s.addEventListener(h,g,!0):C!==void 0?s.addEventListener(h,g,{passive:C}):s.addEventListener(h,g,!1)}function cu(s,h,g,x,C){var L=x;if((h&1)===0&&(h&2)===0&&x!==null)e:for(;;){if(x===null)return;var Q=x.tag;if(Q===3||Q===4){var ae=x.stateNode.containerInfo;if(ae===C)break;if(Q===4)for(Q=x.return;Q!==null;){var Pe=Q.tag;if((Pe===3||Pe===4)&&Q.stateNode.containerInfo===C)return;Q=Q.return}for(;ae!==null;){if(Q=va(ae),Q===null)return;if(Pe=Q.tag,Pe===5||Pe===6||Pe===26||Pe===27){x=L=Q;continue e}ae=ae.parentNode}}x=x.return}Hi(function(){var rt=L,_t=zi(g),Tt=[];e:{var ot=ql.get(s);if(ot!==void 0){var ut=uo,cn=s;switch(s){case"keypress":if(dn(g)===0)break e;case"keydown":case"keyup":ut=aa;break;case"focusin":cn="focus",ut=No;break;case"focusout":cn="blur",ut=No;break;case"beforeblur":case"afterblur":ut=No;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ut=Sa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ut=Oi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ut=ol;break;case Mf:case Qp:case Rf:ut=Xr;break;case yd:ut=ud;break;case"scroll":case"scrollend":ut=bc;break;case"wheel":ut=Tc;break;case"copy":case"cut":case"paste":ut=fo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ut=wu;break;case"toggle":case"beforetoggle":ut=Tu}var yn=(h&4)!==0,Ur=!yn&&(s==="scroll"||s==="scrollend"),Ze=yn?ot!==null?ot+"Capture":null:ot;yn=[];for(var Ue=rt,nt;Ue!==null;){var wt=Ue;if(nt=wt.stateNode,wt=wt.tag,wt!==5&&wt!==26&&wt!==27||nt===null||Ze===null||(wt=jr(Ue,Ze),wt!=null&&yn.push(qd(Ue,wt,nt))),Ur)break;Ue=Ue.return}0<yn.length&&(ot=new ut(ot,cn,null,g,_t),Tt.push({event:ot,listeners:yn}))}}if((h&7)===0){e:{if(ot=s==="mouseover"||s==="pointerover",ut=s==="mouseout"||s==="pointerout",ot&&g!==Li&&(cn=g.relatedTarget||g.fromElement)&&(va(cn)||cn[Sn]))break e;if((ut||ot)&&(ot=_t.window===_t?_t:(ot=_t.ownerDocument)?ot.defaultView||ot.parentWindow:window,ut?(cn=g.relatedTarget||g.toElement,ut=rt,cn=cn?va(cn):null,cn!==null&&(Ur=m(cn),yn=cn.tag,cn!==Ur||yn!==5&&yn!==27&&yn!==6)&&(cn=null)):(ut=null,cn=rt),ut!==cn)){if(yn=Sa,wt="onMouseLeave",Ze="onMouseEnter",Ue="mouse",(s==="pointerout"||s==="pointerover")&&(yn=wu,wt="onPointerLeave",Ze="onPointerEnter",Ue="pointer"),Ur=ut==null?ot:Mt(ut),nt=cn==null?ot:Mt(cn),ot=new yn(wt,Ue+"leave",ut,g,_t),ot.target=Ur,ot.relatedTarget=nt,wt=null,va(_t)===rt&&(yn=new yn(Ze,Ue+"enter",cn,g,_t),yn.target=nt,yn.relatedTarget=Ur,wt=yn),Ur=wt,ut&&cn)t:{for(yn=ut,Ze=cn,Ue=0,nt=yn;nt;nt=Fh(nt))Ue++;for(nt=0,wt=Ze;wt;wt=Fh(wt))nt++;for(;0<Ue-nt;)yn=Fh(yn),Ue--;for(;0<nt-Ue;)Ze=Fh(Ze),nt--;for(;Ue--;){if(yn===Ze||Ze!==null&&yn===Ze.alternate)break t;yn=Fh(yn),Ze=Fh(Ze)}yn=null}else yn=null;ut!==null&&my(Tt,ot,ut,yn,!1),cn!==null&&Ur!==null&&my(Tt,Ur,cn,yn,!0)}}e:{if(ot=rt?Mt(rt):window,ut=ot.nodeName&&ot.nodeName.toLowerCase(),ut==="select"||ut==="input"&&ot.type==="file")var en=Sf;else if(ei(ot))if(Ef)en=Ag;else{en=Eg;var Wn=Ec}else ut=ot.nodeName,!ut||ut.toLowerCase()!=="input"||ot.type!=="checkbox"&&ot.type!=="radio"?rt&&cs(rt.elementType)&&(en=Sf):en=dd;if(en&&(en=en(s,rt))){ll(Tt,en,g,_t);break e}Wn&&Wn(s,ot,rt),s==="focusout"&&rt&&ot.type==="number"&&rt.memoizedProps.value!=null&&zo(ot,"number",ot.value)}switch(Wn=rt?Mt(rt):window,s){case"focusin":(ei(Wn)||Wn.contentEditable==="true")&&(jl=Wn,_h=rt,Ic=null);break;case"focusout":Ic=_h=jl=null;break;case"mousedown":vh=!0;break;case"contextmenu":case"mouseup":case"dragend":vh=!1,$l(Tt,g,_t);break;case"selectionchange":if(Cf)break;case"keydown":case"keyup":$l(Tt,g,_t)}var un;if(ps)e:{switch(s){case"compositionstart":var bn="onCompositionStart";break e;case"compositionend":bn="onCompositionEnd";break e;case"compositionupdate":bn="onCompositionUpdate";break e}bn=void 0}else $n?dt(s,g)&&(bn="onCompositionEnd"):s==="keydown"&&g.keyCode===229&&(bn="onCompositionStart");bn&&(Z&&g.locale!=="ko"&&($n||bn!=="onCompositionStart"?bn==="onCompositionEnd"&&$n&&(un=mn()):(ds=_t,En="value"in ds?ds.value:ds.textContent,$n=!0)),Wn=dp(rt,bn),0<Wn.length&&(bn=new fh(bn,s,null,g,_t),Tt.push({event:bn,listeners:Wn}),un?bn.data=un:(un=Nt(g),un!==null&&(bn.data=un)))),(un=F?Ni(s,g):qn(s,g))&&(bn=dp(rt,"onBeforeInput"),0<bn.length&&(Wn=new fh("onBeforeInput","beforeinput",null,g,_t),Tt.push({event:Wn,listeners:bn}),Wn.data=un)),dy(Tt,s,rt,g,_t)}gv(Tt,h)})}function qd(s,h,g){return{instance:s,listener:h,currentTarget:g}}function dp(s,h){for(var g=h+"Capture",x=[];s!==null;){var C=s,L=C.stateNode;if(C=C.tag,C!==5&&C!==26&&C!==27||L===null||(C=jr(s,g),C!=null&&x.unshift(qd(s,C,L)),C=jr(s,h),C!=null&&x.push(qd(s,C,L))),s.tag===3)return x;s=s.return}return[]}function Fh(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function my(s,h,g,x,C){for(var L=h._reactName,Q=[];g!==null&&g!==x;){var ae=g,Pe=ae.alternate,rt=ae.stateNode;if(ae=ae.tag,Pe!==null&&Pe===x)break;ae!==5&&ae!==26&&ae!==27||rt===null||(Pe=rt,C?(rt=jr(g,L),rt!=null&&Q.unshift(qd(g,rt,Pe))):C||(rt=jr(g,L),rt!=null&&Q.push(qd(g,rt,Pe)))),g=g.return}Q.length!==0&&s.push({event:h,listeners:Q})}var yv=/\r\n?/g,gy=/\u0000|\uFFFD/g;function yy(s){return(typeof s=="string"?s:""+s).replace(yv,`
`).replace(gy,"")}function Gd(s,h){return h=yy(h),yy(s)===h}function fp(){}function Rr(s,h,g,x,C,L){switch(g){case"children":typeof x=="string"?h==="body"||h==="textarea"&&x===""||Oa(s,x):(typeof x=="number"||typeof x=="bigint")&&h!=="body"&&Oa(s,""+x);break;case"className":ra(s,"class",x);break;case"tabIndex":ra(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":ra(s,g,x);break;case"style":us(s,x,L);break;case"data":if(h!=="object"){ra(s,"data",x);break}case"src":case"href":if(x===""&&(h!=="a"||g!=="href")){s.removeAttribute(g);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(g);break}x=zl(""+x),s.setAttribute(g,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof L=="function"&&(g==="formAction"?(h!=="input"&&Rr(s,h,"name",C.name,C,null),Rr(s,h,"formEncType",C.formEncType,C,null),Rr(s,h,"formMethod",C.formMethod,C,null),Rr(s,h,"formTarget",C.formTarget,C,null)):(Rr(s,h,"encType",C.encType,C,null),Rr(s,h,"method",C.method,C,null),Rr(s,h,"target",C.target,C,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(g);break}x=zl(""+x),s.setAttribute(g,x);break;case"onClick":x!=null&&(s.onclick=fp);break;case"onScroll":x!=null&&er("scroll",s);break;case"onScrollEnd":x!=null&&er("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(a(61));if(g=x.__html,g!=null){if(C.children!=null)throw Error(a(60));s.innerHTML=g}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}g=zl(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(g,""+x):s.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(g,""):s.removeAttribute(g);break;case"capture":case"download":x===!0?s.setAttribute(g,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(g,x):s.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(g,x):s.removeAttribute(g);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(g):s.setAttribute(g,x);break;case"popover":er("beforetoggle",s),er("toggle",s),Os(s,"popover",x);break;case"xlinkActuate":yi(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":yi(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":yi(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":yi(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":yi(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":yi(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":yi(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":yi(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":yi(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Os(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=al.get(g)||g,Os(s,g,x))}}function Cm(s,h,g,x,C,L){switch(g){case"style":us(s,x,L);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(a(61));if(g=x.__html,g!=null){if(C.children!=null)throw Error(a(60));s.innerHTML=g}}break;case"children":typeof x=="string"?Oa(s,x):(typeof x=="number"||typeof x=="bigint")&&Oa(s,""+x);break;case"onScroll":x!=null&&er("scroll",s);break;case"onScrollEnd":x!=null&&er("scrollend",s);break;case"onClick":x!=null&&(s.onclick=fp);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!rl.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(C=g.endsWith("Capture"),h=g.slice(2,C?g.length-7:void 0),L=s[gn]||null,L=L!=null?L[g]:null,typeof L=="function"&&s.removeEventListener(h,L,C),typeof x=="function")){typeof L!="function"&&L!==null&&(g in s?s[g]=null:s.hasAttribute(g)&&s.removeAttribute(g)),s.addEventListener(h,x,C);break e}g in s?s[g]=x:x===!0?s.setAttribute(g,""):Os(s,g,x)}}}function Br(s,h,g){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":er("error",s),er("load",s);var x=!1,C=!1,L;for(L in g)if(g.hasOwnProperty(L)){var Q=g[L];if(Q!=null)switch(L){case"src":x=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,h));default:Rr(s,h,L,Q,g,null)}}C&&Rr(s,h,"srcSet",g.srcSet,g,null),x&&Rr(s,h,"src",g.src,g,null);return;case"input":er("invalid",s);var ae=L=Q=C=null,Pe=null,rt=null;for(x in g)if(g.hasOwnProperty(x)){var _t=g[x];if(_t!=null)switch(x){case"name":C=_t;break;case"type":Q=_t;break;case"checked":Pe=_t;break;case"defaultChecked":rt=_t;break;case"value":L=_t;break;case"defaultValue":ae=_t;break;case"children":case"dangerouslySetInnerHTML":if(_t!=null)throw Error(a(137,h));break;default:Rr(s,h,x,_t,g,null)}}Ns(s,L,ae,Pe,rt,Q,C,!1),oo(s);return;case"select":er("invalid",s),x=Q=L=null;for(C in g)if(g.hasOwnProperty(C)&&(ae=g[C],ae!=null))switch(C){case"value":L=ae;break;case"defaultValue":Q=ae;break;case"multiple":x=ae;default:Rr(s,h,C,ae,g,null)}h=L,g=Q,s.multiple=!!x,h!=null?lo(s,!!x,h,!1):g!=null&&lo(s,!!x,g,!0);return;case"textarea":er("invalid",s),L=C=x=null;for(Q in g)if(g.hasOwnProperty(Q)&&(ae=g[Q],ae!=null))switch(Q){case"value":x=ae;break;case"defaultValue":C=ae;break;case"children":L=ae;break;case"dangerouslySetInnerHTML":if(ae!=null)throw Error(a(91));break;default:Rr(s,h,Q,ae,g,null)}Oo(s,x,C,L),oo(s);return;case"option":for(Pe in g)if(g.hasOwnProperty(Pe)&&(x=g[Pe],x!=null))switch(Pe){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Rr(s,h,Pe,x,g,null)}return;case"dialog":er("beforetoggle",s),er("toggle",s),er("cancel",s),er("close",s);break;case"iframe":case"object":er("load",s);break;case"video":case"audio":for(x=0;x<hp.length;x++)er(hp[x],s);break;case"image":er("error",s),er("load",s);break;case"details":er("toggle",s);break;case"embed":case"source":case"link":er("error",s),er("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(rt in g)if(g.hasOwnProperty(rt)&&(x=g[rt],x!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,h));default:Rr(s,h,rt,x,g,null)}return;default:if(cs(h)){for(_t in g)g.hasOwnProperty(_t)&&(x=g[_t],x!==void 0&&Cm(s,h,_t,x,g,void 0));return}}for(ae in g)g.hasOwnProperty(ae)&&(x=g[ae],x!=null&&Rr(s,h,ae,x,g,null))}function Hd(s,h,g,x){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,L=null,Q=null,ae=null,Pe=null,rt=null,_t=null;for(ut in g){var Tt=g[ut];if(g.hasOwnProperty(ut)&&Tt!=null)switch(ut){case"checked":break;case"value":break;case"defaultValue":Pe=Tt;default:x.hasOwnProperty(ut)||Rr(s,h,ut,null,x,Tt)}}for(var ot in x){var ut=x[ot];if(Tt=g[ot],x.hasOwnProperty(ot)&&(ut!=null||Tt!=null))switch(ot){case"type":L=ut;break;case"name":C=ut;break;case"checked":rt=ut;break;case"defaultChecked":_t=ut;break;case"value":Q=ut;break;case"defaultValue":ae=ut;break;case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(a(137,h));break;default:ut!==Tt&&Rr(s,h,ot,ut,x,Tt)}}Xa(s,Q,ae,Pe,rt,_t,L,C);return;case"select":ut=Q=ae=ot=null;for(L in g)if(Pe=g[L],g.hasOwnProperty(L)&&Pe!=null)switch(L){case"value":break;case"multiple":ut=Pe;default:x.hasOwnProperty(L)||Rr(s,h,L,null,x,Pe)}for(C in x)if(L=x[C],Pe=g[C],x.hasOwnProperty(C)&&(L!=null||Pe!=null))switch(C){case"value":ot=L;break;case"defaultValue":ae=L;break;case"multiple":Q=L;default:L!==Pe&&Rr(s,h,C,L,x,Pe)}h=ae,g=Q,x=ut,ot!=null?lo(s,!!g,ot,!1):!!x!=!!g&&(h!=null?lo(s,!!g,h,!0):lo(s,!!g,g?[]:"",!1));return;case"textarea":ut=ot=null;for(ae in g)if(C=g[ae],g.hasOwnProperty(ae)&&C!=null&&!x.hasOwnProperty(ae))switch(ae){case"value":break;case"children":break;default:Rr(s,h,ae,null,x,C)}for(Q in x)if(C=x[Q],L=g[Q],x.hasOwnProperty(Q)&&(C!=null||L!=null))switch(Q){case"value":ot=C;break;case"defaultValue":ut=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(a(91));break;default:C!==L&&Rr(s,h,Q,C,x,L)}Sr(s,ot,ut);return;case"option":for(var cn in g)if(ot=g[cn],g.hasOwnProperty(cn)&&ot!=null&&!x.hasOwnProperty(cn))switch(cn){case"selected":s.selected=!1;break;default:Rr(s,h,cn,null,x,ot)}for(Pe in x)if(ot=x[Pe],ut=g[Pe],x.hasOwnProperty(Pe)&&ot!==ut&&(ot!=null||ut!=null))switch(Pe){case"selected":s.selected=ot&&typeof ot!="function"&&typeof ot!="symbol";break;default:Rr(s,h,Pe,ot,x,ut)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var yn in g)ot=g[yn],g.hasOwnProperty(yn)&&ot!=null&&!x.hasOwnProperty(yn)&&Rr(s,h,yn,null,x,ot);for(rt in x)if(ot=x[rt],ut=g[rt],x.hasOwnProperty(rt)&&ot!==ut&&(ot!=null||ut!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(a(137,h));break;default:Rr(s,h,rt,ot,x,ut)}return;default:if(cs(h)){for(var Ur in g)ot=g[Ur],g.hasOwnProperty(Ur)&&ot!==void 0&&!x.hasOwnProperty(Ur)&&Cm(s,h,Ur,void 0,x,ot);for(_t in x)ot=x[_t],ut=g[_t],!x.hasOwnProperty(_t)||ot===ut||ot===void 0&&ut===void 0||Cm(s,h,_t,ot,x,ut);return}}for(var Ze in g)ot=g[Ze],g.hasOwnProperty(Ze)&&ot!=null&&!x.hasOwnProperty(Ze)&&Rr(s,h,Ze,null,x,ot);for(Tt in x)ot=x[Tt],ut=g[Tt],!x.hasOwnProperty(Tt)||ot===ut||ot==null&&ut==null||Rr(s,h,Tt,ot,x,ut)}var rc=null,Pm=null;function pp(s){return s.nodeType===9?s:s.ownerDocument}function _y(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vy(s,h){if(s===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&h==="foreignObject"?0:s}function by(s,h){return s==="textarea"||s==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Mm=null;function qc(){var s=window.event;return s&&s.type==="popstate"?s===Mm?!1:(Mm=s,!0):(Mm=null,!1)}var xy=typeof setTimeout=="function"?setTimeout:void 0,_v=typeof clearTimeout=="function"?clearTimeout:void 0,wy=typeof Promise=="function"?Promise:void 0,vv=typeof queueMicrotask=="function"?queueMicrotask:typeof wy<"u"?function(s){return wy.resolve(null).then(s).catch(zb)}:xy;function zb(s){setTimeout(function(){throw s})}function Gc(s){return s==="head"}function Ty(s,h){var g=h,x=0,C=0;do{var L=g.nextSibling;if(s.removeChild(g),L&&L.nodeType===8)if(g=L.data,g==="/$"){if(0<x&&8>x){g=x;var Q=s.ownerDocument;if(g&1&&hu(Q.documentElement),g&2&&hu(Q.body),g&4)for(g=Q.head,hu(g),Q=g.firstChild;Q;){var ae=Q.nextSibling,Pe=Q.nodeName;Q[ai]||Pe==="SCRIPT"||Pe==="STYLE"||Pe==="LINK"&&Q.rel.toLowerCase()==="stylesheet"||g.removeChild(Q),Q=ae}}if(C===0){s.removeChild(L),hi(h);return}C--}else g==="$"||g==="$?"||g==="$!"?C++:x=g.charCodeAt(0)-48;else x=0;g=L}while(g);hi(h)}function Rm(s){var h=s.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var g=h;switch(h=h.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":Rm(g),cr(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}s.removeChild(g)}}function km(s,h,g,x){for(;s.nodeType===1;){var C=g;if(s.nodeName.toLowerCase()!==h.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[ai])switch(h){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(L=s.getAttribute("rel"),L==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(L!==C.rel||s.getAttribute("href")!==(C.href==null||C.href===""?null:C.href)||s.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||s.getAttribute("title")!==(C.title==null?null:C.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(L=s.getAttribute("src"),(L!==(C.src==null?null:C.src)||s.getAttribute("type")!==(C.type==null?null:C.type)||s.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&L&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(h==="input"&&s.type==="hidden"){var L=C.name==null?null:""+C.name;if(C.type==="hidden"&&s.getAttribute("name")===L)return s}else return s;if(s=Ws(s.nextSibling),s===null)break}return null}function bv(s,h,g){if(h==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!g||(s=Ws(s.nextSibling),s===null))return null;return s}function Zd(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Dm(s,h){var g=s.ownerDocument;if(s.data!=="$?"||g.readyState==="complete")h();else{var x=function(){h(),g.removeEventListener("DOMContentLoaded",x)};g.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Ws(s){for(;s!=null;s=s.nextSibling){var h=s.nodeType;if(h===1||h===3)break;if(h===8){if(h=s.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return s}var Sy=null;function xv(s){s=s.previousSibling;for(var h=0;s;){if(s.nodeType===8){var g=s.data;if(g==="$"||g==="$!"||g==="$?"){if(h===0)return s;h--}else g==="/$"&&h++}s=s.previousSibling}return null}function wv(s,h,g){switch(h=pp(g),s){case"html":if(s=h.documentElement,!s)throw Error(a(452));return s;case"head":if(s=h.head,!s)throw Error(a(453));return s;case"body":if(s=h.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function hu(s){for(var h=s.attributes;h.length;)s.removeAttributeNode(h[0]);cr(s)}var Vr=new Map,Lm=new Set;function mp(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var du=Bt.d;Bt.d={f:Ey,r:Ob,D:Nb,C:Tv,L:Iy,m:Cy,X:gp,S:Sv,M:Py};function Ey(){var s=du.f(),h=Si();return s||h}function Ob(s){var h=ba(s);h!==null&&h.tag===5&&h.type==="form"?Ar(h):du.r(s)}var Uh=typeof document>"u"?null:document;function Ay(s,h,g){var x=Uh;if(x&&typeof h=="string"&&h){var C=Di(h);C='link[rel="'+s+'"][href="'+C+'"]',typeof g=="string"&&(C+='[crossorigin="'+g+'"]'),Lm.has(C)||(Lm.add(C),s={rel:s,crossOrigin:g,href:h},x.querySelector(C)===null&&(h=x.createElement("link"),Br(h,"link",s),Qt(h),x.head.appendChild(h)))}}function Nb(s){du.D(s),Ay("dns-prefetch",s,null)}function Tv(s,h){du.C(s,h),Ay("preconnect",s,h)}function Iy(s,h,g){du.L(s,h,g);var x=Uh;if(x&&s&&h){var C='link[rel="preload"][as="'+Di(h)+'"]';h==="image"&&g&&g.imageSrcSet?(C+='[imagesrcset="'+Di(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(C+='[imagesizes="'+Di(g.imageSizes)+'"]')):C+='[href="'+Di(s)+'"]';var L=C;switch(h){case"style":L=Hc(s);break;case"script":L=Kc(s)}Vr.has(L)||(s=B({rel:"preload",href:h==="image"&&g&&g.imageSrcSet?void 0:s,as:h},g),Vr.set(L,s),x.querySelector(C)!==null||h==="style"&&x.querySelector(Zc(L))||h==="script"&&x.querySelector(jh(L))||(h=x.createElement("link"),Br(h,"link",s),Qt(h),x.head.appendChild(h)))}}function Cy(s,h){du.m(s,h);var g=Uh;if(g&&s){var x=h&&typeof h.as=="string"?h.as:"script",C='link[rel="modulepreload"][as="'+Di(x)+'"][href="'+Di(s)+'"]',L=C;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":L=Kc(s)}if(!Vr.has(L)&&(s=B({rel:"modulepreload",href:s},h),Vr.set(L,s),g.querySelector(C)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(jh(L)))return}x=g.createElement("link"),Br(x,"link",s),Qt(x),g.head.appendChild(x)}}}function Sv(s,h,g){du.S(s,h,g);var x=Uh;if(x&&s){var C=ln(x).hoistableStyles,L=Hc(s);h=h||"default";var Q=C.get(L);if(!Q){var ae={loading:0,preload:null};if(Q=x.querySelector(Zc(L)))ae.loading=5;else{s=B({rel:"stylesheet",href:s,"data-precedence":h},g),(g=Vr.get(L))&&i(s,g);var Pe=Q=x.createElement("link");Qt(Pe),Br(Pe,"link",s),Pe._p=new Promise(function(rt,_t){Pe.onload=rt,Pe.onerror=_t}),Pe.addEventListener("load",function(){ae.loading|=1}),Pe.addEventListener("error",function(){ae.loading|=2}),ae.loading|=4,u(Q,h,x)}Q={type:"stylesheet",instance:Q,count:1,state:ae},C.set(L,Q)}}}function gp(s,h){du.X(s,h);var g=Uh;if(g&&s){var x=ln(g).hoistableScripts,C=Kc(s),L=x.get(C);L||(L=g.querySelector(jh(C)),L||(s=B({src:s,async:!0},h),(h=Vr.get(C))&&o(s,h),L=g.createElement("script"),Qt(L),Br(L,"link",s),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},x.set(C,L))}}function Py(s,h){du.M(s,h);var g=Uh;if(g&&s){var x=ln(g).hoistableScripts,C=Kc(s),L=x.get(C);L||(L=g.querySelector(jh(C)),L||(s=B({src:s,async:!0,type:"module"},h),(h=Vr.get(C))&&o(s,h),L=g.createElement("script"),Qt(L),Br(L,"link",s),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},x.set(C,L))}}function My(s,h,g,x){var C=(C=fn.current)?mp(C):null;if(!C)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(h=Hc(g.href),g=ln(C).hoistableStyles,x=g.get(h),x||(x={type:"style",instance:null,count:0,state:null},g.set(h,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){s=Hc(g.href);var L=ln(C).hoistableStyles,Q=L.get(s);if(Q||(C=C.ownerDocument||C,Q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},L.set(s,Q),(L=C.querySelector(Zc(s)))&&!L._p&&(Q.instance=L,Q.state.loading=5),Vr.has(s)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Vr.set(s,g),L||Ry(C,s,g,Q.state))),h&&x===null)throw Error(a(528,""));return Q}if(h&&x!==null)throw Error(a(529,""));return null;case"script":return h=g.async,g=g.src,typeof g=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Kc(g),g=ln(C).hoistableScripts,x=g.get(h),x||(x={type:"script",instance:null,count:0,state:null},g.set(h,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Hc(s){return'href="'+Di(s)+'"'}function Zc(s){return'link[rel="stylesheet"]['+s+"]"}function Kd(s){return B({},s,{"data-precedence":s.precedence,precedence:null})}function Ry(s,h,g,x){s.querySelector('link[rel="preload"][as="style"]['+h+"]")?x.loading=1:(h=s.createElement("link"),x.preload=h,h.addEventListener("load",function(){return x.loading|=1}),h.addEventListener("error",function(){return x.loading|=2}),Br(h,"link",g),Qt(h),s.head.appendChild(h))}function Kc(s){return'[src="'+Di(s)+'"]'}function jh(s){return"script[async]"+s}function Ev(s,h,g){if(h.count++,h.instance===null)switch(h.type){case"style":var x=s.querySelector('style[data-href~="'+Di(g.href)+'"]');if(x)return h.instance=x,Qt(x),x;var C=B({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),Qt(x),Br(x,"style",C),u(x,g.precedence,s),h.instance=x;case"stylesheet":C=Hc(g.href);var L=s.querySelector(Zc(C));if(L)return h.state.loading|=4,h.instance=L,Qt(L),L;x=Kd(g),(C=Vr.get(C))&&i(x,C),L=(s.ownerDocument||s).createElement("link"),Qt(L);var Q=L;return Q._p=new Promise(function(ae,Pe){Q.onload=ae,Q.onerror=Pe}),Br(L,"link",x),h.state.loading|=4,u(L,g.precedence,s),h.instance=L;case"script":return L=Kc(g.src),(C=s.querySelector(jh(L)))?(h.instance=C,Qt(C),C):(x=g,(C=Vr.get(L))&&(x=B({},g),o(x,C)),s=s.ownerDocument||s,C=s.createElement("script"),Qt(C),Br(C,"link",x),s.head.appendChild(C),h.instance=C);case"void":return null;default:throw Error(a(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(x=h.instance,h.state.loading|=4,u(x,g.precedence,s));return h.instance}function u(s,h,g){for(var x=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=x.length?x[x.length-1]:null,L=C,Q=0;Q<x.length;Q++){var ae=x[Q];if(ae.dataset.precedence===h)L=ae;else if(L!==C)break}L?L.parentNode.insertBefore(s,L.nextSibling):(h=g.nodeType===9?g.head:g,h.insertBefore(s,h.firstChild))}function i(s,h){s.crossOrigin==null&&(s.crossOrigin=h.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=h.referrerPolicy),s.title==null&&(s.title=h.title)}function o(s,h){s.crossOrigin==null&&(s.crossOrigin=h.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=h.referrerPolicy),s.integrity==null&&(s.integrity=h.integrity)}var f=null;function v(s,h,g){if(f===null){var x=new Map,C=f=new Map;C.set(g,x)}else C=f,x=C.get(g),x||(x=new Map,C.set(g,x));if(x.has(s))return x;for(x.set(s,null),g=g.getElementsByTagName(s),C=0;C<g.length;C++){var L=g[C];if(!(L[ai]||L[Tn]||s==="link"&&L.getAttribute("rel")==="stylesheet")&&L.namespaceURI!=="http://www.w3.org/2000/svg"){var Q=L.getAttribute(h)||"";Q=s+Q;var ae=x.get(Q);ae?ae.push(L):x.set(Q,[L])}}return x}function T(s,h,g){s=s.ownerDocument||s,s.head.insertBefore(g,h==="title"?s.querySelector("head > title"):null)}function S(s,h,g){if(g===1||h.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return s=h.disabled,typeof h.precedence=="string"&&s==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function I(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var R=null;function z(){}function N(s,h,g){if(R===null)throw Error(a(475));var x=R;if(h.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var C=Hc(g.href),L=s.querySelector(Zc(C));if(L){s=L._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=q.bind(x),s.then(x,x)),h.state.loading|=4,h.instance=L,Qt(L);return}L=s.ownerDocument||s,g=Kd(g),(C=Vr.get(C))&&i(g,C),L=L.createElement("link"),Qt(L);var Q=L;Q._p=new Promise(function(ae,Pe){Q.onload=ae,Q.onerror=Pe}),Br(L,"link",g),h.instance=L}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(h,s),(s=h.state.preload)&&(h.state.loading&3)===0&&(x.count++,h=q.bind(x),s.addEventListener("load",h),s.addEventListener("error",h))}}function U(){if(R===null)throw Error(a(475));var s=R;return s.stylesheets&&s.count===0&&J(s,s.stylesheets),0<s.count?function(h){var g=setTimeout(function(){if(s.stylesheets&&J(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=h,function(){s.unsuspend=null,clearTimeout(g)}}:null}function q(){if(this.count--,this.count===0){if(this.stylesheets)J(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Y=null;function J(s,h){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Y=new Map,h.forEach(te,s),Y=null,q.call(s))}function te(s,h){if(!(h.state.loading&4)){var g=Y.get(s);if(g)var x=g.get(null);else{g=new Map,Y.set(s,g);for(var C=s.querySelectorAll("link[data-precedence],style[data-precedence]"),L=0;L<C.length;L++){var Q=C[L];(Q.nodeName==="LINK"||Q.getAttribute("media")!=="not all")&&(g.set(Q.dataset.precedence,Q),x=Q)}x&&g.set(null,x)}C=h.instance,Q=C.getAttribute("data-precedence"),L=g.get(Q)||x,L===x&&g.set(null,C),g.set(Q,C),this.count++,x=q.bind(this),C.addEventListener("load",x),C.addEventListener("error",x),L?L.parentNode.insertBefore(C,L.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(C,s.firstChild)),h.state.loading|=4}}var le={$$typeof:mt,Provider:null,Consumer:null,_currentValue:nn,_currentValue2:nn,_threadCount:0};function ge(s,h,g,x,C,L,Q,ae){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=lt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lt(0),this.hiddenUpdates=lt(null),this.identifierPrefix=x,this.onUncaughtError=C,this.onCaughtError=L,this.onRecoverableError=Q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function Le(s,h,g,x,C,L,Q,ae,Pe,rt,_t,Tt){return s=new ge(s,h,g,Q,ae,Pe,rt,Tt),h=1,L===!0&&(h|=24),L=Va(3,null,null,h),s.current=L,L.stateNode=s,h=Wl(),h.refCount++,s.pooledCache=h,h.refCount++,L.memoizedState={element:x,isDehydrated:g,cache:h},Ih(L),s}function we(s){return s?(s=go,s):go}function K(s,h,g,x,C,L){C=we(C),x.context===null?x.context=C:x.pendingContext=C,x=$o(h),x.payload={element:g},L=L===void 0?null:L,L!==null&&(x.callback=L),g=gl(s,x,h),g!==null&&(Eo(g,s,h),eu(g,s,h))}function se(s,h){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var g=s.retryLane;s.retryLane=g!==0&&g<h?g:h}}function Se(s,h){se(s,h),(s=s.alternate)&&se(s,h)}function et(s){if(s.tag===13){var h=mo(s,67108864);h!==null&&Eo(h,s,67108864),Se(s,67108864)}}var yt=!0;function st(s,h,g,x){var C=gt.T;gt.T=null;var L=Bt.p;try{Bt.p=2,St(s,h,g,x)}finally{Bt.p=L,gt.T=C}}function ht(s,h,g,x){var C=gt.T;gt.T=null;var L=Bt.p;try{Bt.p=8,St(s,h,g,x)}finally{Bt.p=L,gt.T=C}}function St(s,h,g,x){if(yt){var C=bt(x);if(C===null)cu(s,h,x,Ct,g),ns(s,x);else if(ri(C,s,h,g,x))x.stopPropagation();else if(ns(s,x),h&4&&-1<Ao.indexOf(s)){for(;C!==null;){var L=ba(C);if(L!==null)switch(L.tag){case 3:if(L=L.stateNode,L.current.memoizedState.isDehydrated){var Q=ue(L.pendingLanes);if(Q!==0){var ae=L;for(ae.pendingLanes|=2,ae.entangledLanes|=2;Q;){var Pe=1<<31-Ri(Q);ae.entanglements[1]|=Pe,Q&=~Pe}Jo(L),(Pr&6)===0&&(ip=Cr()+500,up(0))}}break;case 13:ae=mo(L,2),ae!==null&&Eo(ae,L,2),Si(),Se(L,2)}if(L=bt(x),L===null&&cu(s,h,x,Ct,g),L===C)break;C=L}C!==null&&x.stopPropagation()}else cu(s,h,x,null,g)}}function bt(s){return s=zi(s),pt(s)}var Ct=null;function pt(s){if(Ct=null,s=va(s),s!==null){var h=m(s);if(h===null)s=null;else{var g=h.tag;if(g===13){if(s=y(h),s!==null)return s;s=null}else if(g===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;s=null}else h!==s&&(s=null)}}return Ct=s,null}function Gt(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(za()){case na:return 2;case Ds:return 8;case Wa:case _u:return 32;case Ls:return 268435456;default:return 32}default:return 32}}var tn=!1,Zt=null,$t=null,xn=null,Fr=new Map,ui=new Map,ci=[],Ao="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ns(s,h){switch(s){case"focusin":case"focusout":Zt=null;break;case"dragenter":case"dragleave":$t=null;break;case"mouseover":case"mouseout":xn=null;break;case"pointerover":case"pointerout":Fr.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":ui.delete(h.pointerId)}}function Ei(s,h,g,x,C,L){return s===null||s.nativeEvent!==L?(s={blockedOn:h,domEventName:g,eventSystemFlags:x,nativeEvent:L,targetContainers:[C]},h!==null&&(h=ba(h),h!==null&&et(h)),s):(s.eventSystemFlags|=x,h=s.targetContainers,C!==null&&h.indexOf(C)===-1&&h.push(C),s)}function ri(s,h,g,x,C){switch(h){case"focusin":return Zt=Ei(Zt,s,h,g,x,C),!0;case"dragenter":return $t=Ei($t,s,h,g,x,C),!0;case"mouseover":return xn=Ei(xn,s,h,g,x,C),!0;case"pointerover":var L=C.pointerId;return Fr.set(L,Ei(Fr.get(L)||null,s,h,g,x,C)),!0;case"gotpointercapture":return L=C.pointerId,ui.set(L,Ei(ui.get(L)||null,s,h,g,x,C)),!0}return!1}function Qi(s){var h=va(s.target);if(h!==null){var g=m(h);if(g!==null){if(h=g.tag,h===13){if(h=y(g),h!==null){s.blockedOn=h,Kt(s.priority,function(){if(g.tag===13){var x=Ks();x=Lt(x);var C=mo(g,x);C!==null&&Eo(C,g,x),Se(g,x)}});return}}else if(h===3&&g.stateNode.current.memoizedState.isDehydrated){s.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ui(s){if(s.blockedOn!==null)return!1;for(var h=s.targetContainers;0<h.length;){var g=bt(s.nativeEvent);if(g===null){g=s.nativeEvent;var x=new g.constructor(g.type,g);Li=x,g.target.dispatchEvent(x),Li=null}else return h=ba(g),h!==null&&et(h),s.blockedOn=g,!1;h.shift()}return!0}function ua(s,h,g){Ui(s)&&g.delete(h)}function rs(){tn=!1,Zt!==null&&Ui(Zt)&&(Zt=null),$t!==null&&Ui($t)&&($t=null),xn!==null&&Ui(xn)&&(xn=null),Fr.forEach(ua),ui.forEach(ua)}function is(s,h){s.blockedOn===h&&(s.blockedOn=null,tn||(tn=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,rs)))}var Ai=null;function as(s){Ai!==s&&(Ai=s,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Ai===s&&(Ai=null);for(var h=0;h<s.length;h+=3){var g=s[h],x=s[h+1],C=s[h+2];if(typeof x!="function"){if(pt(x||g)===null)continue;break}var L=ba(g);L!==null&&(s.splice(h,3),h-=3,yr(L,{pending:!0,data:C,method:g.method,action:x},x,C))}}))}function hi(s){function h(Pe){return is(Pe,s)}Zt!==null&&is(Zt,s),$t!==null&&is($t,s),xn!==null&&is(xn,s),Fr.forEach(h),ui.forEach(h);for(var g=0;g<ci.length;g++){var x=ci[g];x.blockedOn===s&&(x.blockedOn=null)}for(;0<ci.length&&(g=ci[0],g.blockedOn===null);)Qi(g),g.blockedOn===null&&ci.shift();if(g=(s.ownerDocument||s).$$reactFormReplay,g!=null)for(x=0;x<g.length;x+=3){var C=g[x],L=g[x+1],Q=C[gn]||null;if(typeof L=="function")Q||as(g);else if(Q){var ae=null;if(L&&L.hasAttribute("formAction")){if(C=L,Q=L[gn]||null)ae=Q.formAction;else if(pt(C)!==null)continue}else ae=Q.action;typeof ae=="function"?g[x+1]=ae:(g.splice(x,3),x-=3),as(g)}}}function ji(s){this._internalRoot=s}Ii.prototype.render=ji.prototype.render=function(s){var h=this._internalRoot;if(h===null)throw Error(a(409));var g=h.current,x=Ks();K(g,x,s,h,null,null)},Ii.prototype.unmount=ji.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var h=s.containerInfo;K(s.current,2,null,s,null,null),Si(),h[Sn]=null}};function Ii(s){this._internalRoot=s}Ii.prototype.unstable_scheduleHydration=function(s){if(s){var h=Vt();s={blockedOn:null,target:s,priority:h};for(var g=0;g<ci.length&&h!==0&&h<ci[g].priority;g++);ci.splice(g,0,s),g===0&&Qi(s)}};var Ci=e.version;if(Ci!=="19.1.0")throw Error(a(527,Ci,"19.1.0"));Bt.findDOMNode=function(s){var h=s._reactInternals;if(h===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=P(h),s=s!==null?k(s):null,s=s===null?null:s.stateNode,s};var Hr={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:gt,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xs.isDisabled&&Xs.supportsFiber)try{fr=Xs.inject(Hr),zn=Xs}catch{}}return Dy.createRoot=function(s,h){if(!d(s))throw Error(a(299));var g=!1,x="",C=Cg,L=H_,Q=Pg,ae=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onUncaughtError!==void 0&&(C=h.onUncaughtError),h.onCaughtError!==void 0&&(L=h.onCaughtError),h.onRecoverableError!==void 0&&(Q=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(ae=h.unstable_transitionCallbacks)),h=Le(s,1,!1,null,null,g,x,C,L,Q,ae,null),s[Sn]=h.current,py(s),new ji(h)},Dy.hydrateRoot=function(s,h,g){if(!d(s))throw Error(a(299));var x=!1,C="",L=Cg,Q=H_,ae=Pg,Pe=null,rt=null;return g!=null&&(g.unstable_strictMode===!0&&(x=!0),g.identifierPrefix!==void 0&&(C=g.identifierPrefix),g.onUncaughtError!==void 0&&(L=g.onUncaughtError),g.onCaughtError!==void 0&&(Q=g.onCaughtError),g.onRecoverableError!==void 0&&(ae=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Pe=g.unstable_transitionCallbacks),g.formState!==void 0&&(rt=g.formState)),h=Le(s,1,!0,h,g??null,x,C,L,Q,ae,Pe,rt),h.context=we(null),g=h.current,x=Ks(),x=Lt(x),C=$o(x),C.callback=null,gl(g,C,x),g=x,h.current.lanes=g,it(h,g),Jo(h),s[Sn]=h.current,py(s),new Ii(h)},Dy.version="19.1.0",Dy}var C2;function AM(){if(C2)return Ub.exports;C2=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Ub.exports=EM(),Ub.exports}var IM=AM();const CM=S_(IM);var Ly={},P2;function PM(){if(P2)return Ly;P2=1,Object.defineProperty(Ly,"__esModule",{value:!0}),Ly.parse=y,Ly.serialize=k;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,d=Object.prototype.toString,m=(()=>{const G=function(){};return G.prototype=Object.create(null),G})();function y(G,W){const ie=new m,Ie=G.length;if(Ie<2)return ie;const Re=(W==null?void 0:W.decode)||B;let Oe=0;do{const Ke=G.indexOf("=",Oe);if(Ke===-1)break;const mt=G.indexOf(";",Oe),qe=mt===-1?Ie:mt;if(Ke>qe){Oe=G.lastIndexOf(";",Ke-1)+1;continue}const Fe=c(G,Oe,Ke),We=P(G,Ke,Fe),pe=G.slice(Fe,We);if(ie[pe]===void 0){let oe=c(G,Ke+1,qe),me=P(G,qe,oe);const be=Re(G.slice(oe,me));ie[pe]=be}Oe=qe+1}while(Oe<Ie);return ie}function c(G,W,ie){do{const Ie=G.charCodeAt(W);if(Ie!==32&&Ie!==9)return W}while(++W<ie);return ie}function P(G,W,ie){for(;W>ie;){const Ie=G.charCodeAt(--W);if(Ie!==32&&Ie!==9)return W+1}return ie}function k(G,W,ie){const Ie=(ie==null?void 0:ie.encode)||encodeURIComponent;if(!r.test(G))throw new TypeError(`argument name is invalid: ${G}`);const Re=Ie(W);if(!e.test(Re))throw new TypeError(`argument val is invalid: ${W}`);let Oe=G+"="+Re;if(!ie)return Oe;if(ie.maxAge!==void 0){if(!Number.isInteger(ie.maxAge))throw new TypeError(`option maxAge is invalid: ${ie.maxAge}`);Oe+="; Max-Age="+ie.maxAge}if(ie.domain){if(!t.test(ie.domain))throw new TypeError(`option domain is invalid: ${ie.domain}`);Oe+="; Domain="+ie.domain}if(ie.path){if(!a.test(ie.path))throw new TypeError(`option path is invalid: ${ie.path}`);Oe+="; Path="+ie.path}if(ie.expires){if(!X(ie.expires)||!Number.isFinite(ie.expires.valueOf()))throw new TypeError(`option expires is invalid: ${ie.expires}`);Oe+="; Expires="+ie.expires.toUTCString()}if(ie.httpOnly&&(Oe+="; HttpOnly"),ie.secure&&(Oe+="; Secure"),ie.partitioned&&(Oe+="; Partitioned"),ie.priority)switch(typeof ie.priority=="string"?ie.priority.toLowerCase():void 0){case"low":Oe+="; Priority=Low";break;case"medium":Oe+="; Priority=Medium";break;case"high":Oe+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${ie.priority}`)}if(ie.sameSite)switch(typeof ie.sameSite=="string"?ie.sameSite.toLowerCase():ie.sameSite){case!0:case"strict":Oe+="; SameSite=Strict";break;case"lax":Oe+="; SameSite=Lax";break;case"none":Oe+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${ie.sameSite}`)}return Oe}function B(G){if(G.indexOf("%")===-1)return G;try{return decodeURIComponent(G)}catch{return G}}function X(G){return d.call(G)==="[object Date]"}return Ly}PM();var M2="popstate";function MM(r={}){function e(d,m){let{pathname:y="/",search:c="",hash:P=""}=$p(d.location.hash.substring(1));return!y.startsWith("/")&&!y.startsWith(".")&&(y="/"+y),Sx("",{pathname:y,search:c,hash:P},m.state&&m.state.usr||null,m.state&&m.state.key||"default")}function t(d,m){let y=d.document.querySelector("base"),c="";if(y&&y.getAttribute("href")){let P=d.location.href,k=P.indexOf("#");c=k===-1?P:P.slice(0,k)}return c+"#"+(typeof m=="string"?m:n_(m))}function a(d,m){dc(d.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(m)})`)}return kM(e,t,a,r)}function ea(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function dc(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function RM(){return Math.random().toString(36).substring(2,10)}function R2(r,e){return{usr:r.state,key:r.key,idx:e}}function Sx(r,e,t=null,a){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?$p(e):e,state:t,key:e&&e.key||a||RM()}}function n_({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function $p(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let a=r.indexOf("?");a>=0&&(e.search=r.substring(a),r=r.substring(0,a)),r&&(e.pathname=r)}return e}function kM(r,e,t,a={}){let{window:d=document.defaultView,v5Compat:m=!1}=a,y=d.history,c="POP",P=null,k=B();k==null&&(k=0,y.replaceState({...y.state,idx:k},""));function B(){return(y.state||{idx:null}).idx}function X(){c="POP";let Re=B(),Oe=Re==null?null:Re-k;k=Re,P&&P({action:c,location:Ie.location,delta:Oe})}function G(Re,Oe){c="PUSH";let Ke=Sx(Ie.location,Re,Oe);t&&t(Ke,Re),k=B()+1;let mt=R2(Ke,k),qe=Ie.createHref(Ke);try{y.pushState(mt,"",qe)}catch(Fe){if(Fe instanceof DOMException&&Fe.name==="DataCloneError")throw Fe;d.location.assign(qe)}m&&P&&P({action:c,location:Ie.location,delta:1})}function W(Re,Oe){c="REPLACE";let Ke=Sx(Ie.location,Re,Oe);t&&t(Ke,Re),k=B();let mt=R2(Ke,k),qe=Ie.createHref(Ke);y.replaceState(mt,"",qe),m&&P&&P({action:c,location:Ie.location,delta:0})}function ie(Re){return DM(Re)}let Ie={get action(){return c},get location(){return r(d,y)},listen(Re){if(P)throw new Error("A history only accepts one active listener");return d.addEventListener(M2,X),P=Re,()=>{d.removeEventListener(M2,X),P=null}},createHref(Re){return e(d,Re)},createURL:ie,encodeLocation(Re){let Oe=ie(Re);return{pathname:Oe.pathname,search:Oe.search,hash:Oe.hash}},push:G,replace:W,go(Re){return y.go(Re)}};return Ie}function DM(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ea(t,"No window.location.(origin|href) available to create URL");let a=typeof r=="string"?r:n_(r);return a=a.replace(/ $/,"%20"),!e&&a.startsWith("//")&&(a=t+a),new URL(a,t)}function RE(r,e,t="/"){return LM(r,e,t,!1)}function LM(r,e,t,a){let d=typeof e=="string"?$p(e):e,m=Yh(d.pathname||"/",t);if(m==null)return null;let y=kE(r);zM(y);let c=null;for(let P=0;c==null&&P<y.length;++P){let k=HM(m);c=qM(y[P],k,a)}return c}function kE(r,e=[],t=[],a=""){let d=(m,y,c)=>{let P={relativePath:c===void 0?m.path||"":c,caseSensitive:m.caseSensitive===!0,childrenIndex:y,route:m};P.relativePath.startsWith("/")&&(ea(P.relativePath.startsWith(a),`Absolute route path "${P.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),P.relativePath=P.relativePath.slice(a.length));let k=Hh([a,P.relativePath]),B=t.concat(P);m.children&&m.children.length>0&&(ea(m.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),kE(m.children,e,B,k)),!(m.path==null&&!m.index)&&e.push({path:k,score:jM(k,m.index),routesMeta:B})};return r.forEach((m,y)=>{var c;if(m.path===""||!((c=m.path)!=null&&c.includes("?")))d(m,y);else for(let P of DE(m.path))d(m,y,P)}),e}function DE(r){let e=r.split("/");if(e.length===0)return[];let[t,...a]=e,d=t.endsWith("?"),m=t.replace(/\?$/,"");if(a.length===0)return d?[m,""]:[m];let y=DE(a.join("/")),c=[];return c.push(...y.map(P=>P===""?m:[m,P].join("/"))),d&&c.push(...y),c.map(P=>r.startsWith("/")&&P===""?"/":P)}function zM(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:$M(e.routesMeta.map(a=>a.childrenIndex),t.routesMeta.map(a=>a.childrenIndex)))}var OM=/^:[\w-]+$/,NM=3,BM=2,VM=1,FM=10,UM=-2,k2=r=>r==="*";function jM(r,e){let t=r.split("/"),a=t.length;return t.some(k2)&&(a+=UM),e&&(a+=BM),t.filter(d=>!k2(d)).reduce((d,m)=>d+(OM.test(m)?NM:m===""?VM:FM),a)}function $M(r,e){return r.length===e.length&&r.slice(0,-1).every((a,d)=>a===e[d])?r[r.length-1]-e[e.length-1]:0}function qM(r,e,t=!1){let{routesMeta:a}=r,d={},m="/",y=[];for(let c=0;c<a.length;++c){let P=a[c],k=c===a.length-1,B=m==="/"?e:e.slice(m.length)||"/",X=a0({path:P.relativePath,caseSensitive:P.caseSensitive,end:k},B),G=P.route;if(!X&&k&&t&&!a[a.length-1].route.index&&(X=a0({path:P.relativePath,caseSensitive:P.caseSensitive,end:!1},B)),!X)return null;Object.assign(d,X.params),y.push({params:d,pathname:Hh([m,X.pathname]),pathnameBase:XM(Hh([m,X.pathnameBase])),route:G}),X.pathnameBase!=="/"&&(m=Hh([m,X.pathnameBase]))}return y}function a0(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,a]=GM(r.path,r.caseSensitive,r.end),d=e.match(t);if(!d)return null;let m=d[0],y=m.replace(/(.)\/+$/,"$1"),c=d.slice(1);return{params:a.reduce((k,{paramName:B,isOptional:X},G)=>{if(B==="*"){let ie=c[G]||"";y=m.slice(0,m.length-ie.length).replace(/(.)\/+$/,"$1")}const W=c[G];return X&&!W?k[B]=void 0:k[B]=(W||"").replace(/%2F/g,"/"),k},{}),pathname:m,pathnameBase:y,pattern:r}}function GM(r,e=!1,t=!0){dc(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let a=[],d="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(y,c,P)=>(a.push({paramName:c,isOptional:P!=null}),P?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(a.push({paramName:"*"}),d+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?d+="\\/*$":r!==""&&r!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,e?void 0:"i"),a]}function HM(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return dc(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function Yh(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,a=r.charAt(t);return a&&a!=="/"?null:r.slice(t)||"/"}function ZM(r,e="/"){let{pathname:t,search:a="",hash:d=""}=typeof r=="string"?$p(r):r;return{pathname:t?t.startsWith("/")?t:KM(t,e):e,search:YM(a),hash:QM(d)}}function KM(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(d=>{d===".."?t.length>1&&t.pop():d!=="."&&t.push(d)}),t.length>1?t.join("/"):"/"}function Gb(r,e,t,a){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function WM(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function LE(r){let e=WM(r);return e.map((t,a)=>a===e.length-1?t.pathname:t.pathnameBase)}function zE(r,e,t,a=!1){let d;typeof r=="string"?d=$p(r):(d={...r},ea(!d.pathname||!d.pathname.includes("?"),Gb("?","pathname","search",d)),ea(!d.pathname||!d.pathname.includes("#"),Gb("#","pathname","hash",d)),ea(!d.search||!d.search.includes("#"),Gb("#","search","hash",d)));let m=r===""||d.pathname==="",y=m?"/":d.pathname,c;if(y==null)c=t;else{let X=e.length-1;if(!a&&y.startsWith("..")){let G=y.split("/");for(;G[0]==="..";)G.shift(),X-=1;d.pathname=G.join("/")}c=X>=0?e[X]:"/"}let P=ZM(d,c),k=y&&y!=="/"&&y.endsWith("/"),B=(m||y===".")&&t.endsWith("/");return!P.pathname.endsWith("/")&&(k||B)&&(P.pathname+="/"),P}var Hh=r=>r.join("/").replace(/\/\/+/g,"/"),XM=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),YM=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,QM=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function JM(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var OE=["POST","PUT","PATCH","DELETE"];new Set(OE);var eR=["GET",...OE];new Set(eR);var fg=ct.createContext(null);fg.displayName="DataRouter";var B0=ct.createContext(null);B0.displayName="DataRouterState";var NE=ct.createContext({isTransitioning:!1});NE.displayName="ViewTransition";var tR=ct.createContext(new Map);tR.displayName="Fetchers";var nR=ct.createContext(null);nR.displayName="Await";var hh=ct.createContext(null);hh.displayName="Navigation";var E_=ct.createContext(null);E_.displayName="Location";var ad=ct.createContext({outlet:null,matches:[],isDataRoute:!1});ad.displayName="Route";var z1=ct.createContext(null);z1.displayName="RouteError";function rR(r,{relative:e}={}){ea(A_(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:a}=ct.useContext(hh),{hash:d,pathname:m,search:y}=I_(r,{relative:e}),c=m;return t!=="/"&&(c=m==="/"?t:Hh([t,m])),a.createHref({pathname:c,search:y,hash:d})}function A_(){return ct.useContext(E_)!=null}function qp(){return ea(A_(),"useLocation() may be used only in the context of a <Router> component."),ct.useContext(E_).location}var BE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function VE(r){ct.useContext(hh).static||ct.useLayoutEffect(r)}function iR(){let{isDataRoute:r}=ct.useContext(ad);return r?yR():aR()}function aR(){ea(A_(),"useNavigate() may be used only in the context of a <Router> component.");let r=ct.useContext(fg),{basename:e,navigator:t}=ct.useContext(hh),{matches:a}=ct.useContext(ad),{pathname:d}=qp(),m=JSON.stringify(LE(a)),y=ct.useRef(!1);return VE(()=>{y.current=!0}),ct.useCallback((P,k={})=>{if(dc(y.current,BE),!y.current)return;if(typeof P=="number"){t.go(P);return}let B=zE(P,JSON.parse(m),d,k.relative==="path");r==null&&e!=="/"&&(B.pathname=B.pathname==="/"?e:Hh([e,B.pathname])),(k.replace?t.replace:t.push)(B,k.state,k)},[e,t,m,d,r])}ct.createContext(null);function I_(r,{relative:e}={}){let{matches:t}=ct.useContext(ad),{pathname:a}=qp(),d=JSON.stringify(LE(t));return ct.useMemo(()=>zE(r,JSON.parse(d),a,e==="path"),[r,d,a,e])}function sR(r,e){return FE(r,e)}function FE(r,e,t,a){var Oe;ea(A_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:d}=ct.useContext(hh),{matches:m}=ct.useContext(ad),y=m[m.length-1],c=y?y.params:{},P=y?y.pathname:"/",k=y?y.pathnameBase:"/",B=y&&y.route;{let Ke=B&&B.path||"";UE(P,!B||Ke.endsWith("*")||Ke.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${P}" (under <Route path="${Ke}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Ke}"> to <Route path="${Ke==="/"?"*":`${Ke}/*`}">.`)}let X=qp(),G;if(e){let Ke=typeof e=="string"?$p(e):e;ea(k==="/"||((Oe=Ke.pathname)==null?void 0:Oe.startsWith(k)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${k}" but pathname "${Ke.pathname}" was given in the \`location\` prop.`),G=Ke}else G=X;let W=G.pathname||"/",ie=W;if(k!=="/"){let Ke=k.replace(/^\//,"").split("/");ie="/"+W.replace(/^\//,"").split("/").slice(Ke.length).join("/")}let Ie=RE(r,{pathname:ie});dc(B||Ie!=null,`No routes matched location "${G.pathname}${G.search}${G.hash}" `),dc(Ie==null||Ie[Ie.length-1].route.element!==void 0||Ie[Ie.length-1].route.Component!==void 0||Ie[Ie.length-1].route.lazy!==void 0,`Matched leaf route at location "${G.pathname}${G.search}${G.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Re=hR(Ie&&Ie.map(Ke=>Object.assign({},Ke,{params:Object.assign({},c,Ke.params),pathname:Hh([k,d.encodeLocation?d.encodeLocation(Ke.pathname).pathname:Ke.pathname]),pathnameBase:Ke.pathnameBase==="/"?k:Hh([k,d.encodeLocation?d.encodeLocation(Ke.pathnameBase).pathname:Ke.pathnameBase])})),m,t,a);return e&&Re?ct.createElement(E_.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...G},navigationType:"POP"}},Re):Re}function oR(){let r=gR(),e=JM(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,a="rgba(200,200,200, 0.5)",d={padding:"0.5rem",backgroundColor:a},m={padding:"2px 4px",backgroundColor:a},y=null;return console.error("Error handled by React Router default ErrorBoundary:",r),y=ct.createElement(ct.Fragment,null,ct.createElement("p",null,"💿 Hey developer 👋"),ct.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ct.createElement("code",{style:m},"ErrorBoundary")," or"," ",ct.createElement("code",{style:m},"errorElement")," prop on your route.")),ct.createElement(ct.Fragment,null,ct.createElement("h2",null,"Unexpected Application Error!"),ct.createElement("h3",{style:{fontStyle:"italic"}},e),t?ct.createElement("pre",{style:d},t):null,y)}var lR=ct.createElement(oR,null),uR=class extends ct.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?ct.createElement(ad.Provider,{value:this.props.routeContext},ct.createElement(z1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function cR({routeContext:r,match:e,children:t}){let a=ct.useContext(fg);return a&&a.static&&a.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=e.route.id),ct.createElement(ad.Provider,{value:r},t)}function hR(r,e=[],t=null,a=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let d=r,m=t==null?void 0:t.errors;if(m!=null){let P=d.findIndex(k=>k.route.id&&(m==null?void 0:m[k.route.id])!==void 0);ea(P>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(m).join(",")}`),d=d.slice(0,Math.min(d.length,P+1))}let y=!1,c=-1;if(t)for(let P=0;P<d.length;P++){let k=d[P];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(c=P),k.route.id){let{loaderData:B,errors:X}=t,G=k.route.loader&&!B.hasOwnProperty(k.route.id)&&(!X||X[k.route.id]===void 0);if(k.route.lazy||G){y=!0,c>=0?d=d.slice(0,c+1):d=[d[0]];break}}}return d.reduceRight((P,k,B)=>{let X,G=!1,W=null,ie=null;t&&(X=m&&k.route.id?m[k.route.id]:void 0,W=k.route.errorElement||lR,y&&(c<0&&B===0?(UE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),G=!0,ie=null):c===B&&(G=!0,ie=k.route.hydrateFallbackElement||null)));let Ie=e.concat(d.slice(0,B+1)),Re=()=>{let Oe;return X?Oe=W:G?Oe=ie:k.route.Component?Oe=ct.createElement(k.route.Component,null):k.route.element?Oe=k.route.element:Oe=P,ct.createElement(cR,{match:k,routeContext:{outlet:P,matches:Ie,isDataRoute:t!=null},children:Oe})};return t&&(k.route.ErrorBoundary||k.route.errorElement||B===0)?ct.createElement(uR,{location:t.location,revalidation:t.revalidation,component:W,error:X,children:Re(),routeContext:{outlet:null,matches:Ie,isDataRoute:!0}}):Re()},null)}function O1(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dR(r){let e=ct.useContext(fg);return ea(e,O1(r)),e}function fR(r){let e=ct.useContext(B0);return ea(e,O1(r)),e}function pR(r){let e=ct.useContext(ad);return ea(e,O1(r)),e}function N1(r){let e=pR(r),t=e.matches[e.matches.length-1];return ea(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function mR(){return N1("useRouteId")}function gR(){var a;let r=ct.useContext(z1),e=fR("useRouteError"),t=N1("useRouteError");return r!==void 0?r:(a=e.errors)==null?void 0:a[t]}function yR(){let{router:r}=dR("useNavigate"),e=N1("useNavigate"),t=ct.useRef(!1);return VE(()=>{t.current=!0}),ct.useCallback(async(d,m={})=>{dc(t.current,BE),t.current&&(typeof d=="number"?r.navigate(d):await r.navigate(d,{fromRouteId:e,...m}))},[r,e])}var D2={};function UE(r,e,t){!e&&!D2[r]&&(D2[r]=!0,dc(!1,t))}ct.memo(_R);function _R({routes:r,future:e,state:t}){return FE(r,void 0,t,e)}function Js(r){ea(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function vR({basename:r="/",children:e=null,location:t,navigationType:a="POP",navigator:d,static:m=!1}){ea(!A_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let y=r.replace(/^\/*/,"/"),c=ct.useMemo(()=>({basename:y,navigator:d,static:m,future:{}}),[y,d,m]);typeof t=="string"&&(t=$p(t));let{pathname:P="/",search:k="",hash:B="",state:X=null,key:G="default"}=t,W=ct.useMemo(()=>{let ie=Yh(P,y);return ie==null?null:{location:{pathname:ie,search:k,hash:B,state:X,key:G},navigationType:a}},[y,P,k,B,X,G,a]);return dc(W!=null,`<Router basename="${y}"> is not able to match the URL "${P}${k}${B}" because it does not start with the basename, so the <Router> won't render anything.`),W==null?null:ct.createElement(hh.Provider,{value:c},ct.createElement(E_.Provider,{children:e,value:W}))}function bR({children:r,location:e}){return sR(Ex(r),e)}function Ex(r,e=[]){let t=[];return ct.Children.forEach(r,(a,d)=>{if(!ct.isValidElement(a))return;let m=[...e,d];if(a.type===ct.Fragment){t.push.apply(t,Ex(a.props.children,m));return}ea(a.type===Js,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ea(!a.props.index||!a.props.children,"An index route cannot have child routes.");let y={id:a.props.id||m.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(y.children=Ex(a.props.children,m)),t.push(y)}),t}var Uv="get",jv="application/x-www-form-urlencoded";function V0(r){return r!=null&&typeof r.tagName=="string"}function xR(r){return V0(r)&&r.tagName.toLowerCase()==="button"}function wR(r){return V0(r)&&r.tagName.toLowerCase()==="form"}function TR(r){return V0(r)&&r.tagName.toLowerCase()==="input"}function SR(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function ER(r,e){return r.button===0&&(!e||e==="_self")&&!SR(r)}var Av=null;function AR(){if(Av===null)try{new FormData(document.createElement("form"),0),Av=!1}catch{Av=!0}return Av}var IR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Hb(r){return r!=null&&!IR.has(r)?(dc(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${jv}"`),null):r}function CR(r,e){let t,a,d,m,y;if(wR(r)){let c=r.getAttribute("action");a=c?Yh(c,e):null,t=r.getAttribute("method")||Uv,d=Hb(r.getAttribute("enctype"))||jv,m=new FormData(r)}else if(xR(r)||TR(r)&&(r.type==="submit"||r.type==="image")){let c=r.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let P=r.getAttribute("formaction")||c.getAttribute("action");if(a=P?Yh(P,e):null,t=r.getAttribute("formmethod")||c.getAttribute("method")||Uv,d=Hb(r.getAttribute("formenctype"))||Hb(c.getAttribute("enctype"))||jv,m=new FormData(c,r),!AR()){let{name:k,type:B,value:X}=r;if(B==="image"){let G=k?`${k}.`:"";m.append(`${G}x`,"0"),m.append(`${G}y`,"0")}else k&&m.append(k,X)}}else{if(V0(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Uv,a=null,d=jv,y=r}return m&&d==="text/plain"&&(y=m,m=void 0),{action:a,method:t.toLowerCase(),encType:d,formData:m,body:y}}function B1(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}async function PR(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function MR(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function RR(r,e,t){let a=await Promise.all(r.map(async d=>{let m=e.routes[d.route.id];if(m){let y=await PR(m,t);return y.links?y.links():[]}return[]}));return zR(a.flat(1).filter(MR).filter(d=>d.rel==="stylesheet"||d.rel==="preload").map(d=>d.rel==="stylesheet"?{...d,rel:"prefetch",as:"style"}:{...d,rel:"prefetch"}))}function L2(r,e,t,a,d,m){let y=(P,k)=>t[k]?P.route.id!==t[k].route.id:!0,c=(P,k)=>{var B;return t[k].pathname!==P.pathname||((B=t[k].route.path)==null?void 0:B.endsWith("*"))&&t[k].params["*"]!==P.params["*"]};return m==="assets"?e.filter((P,k)=>y(P,k)||c(P,k)):m==="data"?e.filter((P,k)=>{var X;let B=a.routes[P.route.id];if(!B||!B.hasLoader)return!1;if(y(P,k)||c(P,k))return!0;if(P.route.shouldRevalidate){let G=P.route.shouldRevalidate({currentUrl:new URL(d.pathname+d.search+d.hash,window.origin),currentParams:((X=t[0])==null?void 0:X.params)||{},nextUrl:new URL(r,window.origin),nextParams:P.params,defaultShouldRevalidate:!0});if(typeof G=="boolean")return G}return!0}):[]}function kR(r,e,{includeHydrateFallback:t}={}){return DR(r.map(a=>{let d=e.routes[a.route.id];if(!d)return[];let m=[d.module];return d.clientActionModule&&(m=m.concat(d.clientActionModule)),d.clientLoaderModule&&(m=m.concat(d.clientLoaderModule)),t&&d.hydrateFallbackModule&&(m=m.concat(d.hydrateFallbackModule)),d.imports&&(m=m.concat(d.imports)),m}).flat(1))}function DR(r){return[...new Set(r)]}function LR(r){let e={},t=Object.keys(r).sort();for(let a of t)e[a]=r[a];return e}function zR(r,e){let t=new Set;return new Set(e),r.reduce((a,d)=>{let m=JSON.stringify(LR(d));return t.has(m)||(t.add(m),a.push({key:m,link:d})),a},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var OR=new Set([100,101,204,205]);function NR(r,e){let t=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return t.pathname==="/"?t.pathname="_root.data":e&&Yh(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function jE(){let r=ct.useContext(fg);return B1(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function BR(){let r=ct.useContext(B0);return B1(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var V1=ct.createContext(void 0);V1.displayName="FrameworkContext";function $E(){let r=ct.useContext(V1);return B1(r,"You must render this element inside a <HydratedRouter> element"),r}function VR(r,e){let t=ct.useContext(V1),[a,d]=ct.useState(!1),[m,y]=ct.useState(!1),{onFocus:c,onBlur:P,onMouseEnter:k,onMouseLeave:B,onTouchStart:X}=e,G=ct.useRef(null);ct.useEffect(()=>{if(r==="render"&&y(!0),r==="viewport"){let Ie=Oe=>{Oe.forEach(Ke=>{y(Ke.isIntersecting)})},Re=new IntersectionObserver(Ie,{threshold:.5});return G.current&&Re.observe(G.current),()=>{Re.disconnect()}}},[r]),ct.useEffect(()=>{if(a){let Ie=setTimeout(()=>{y(!0)},100);return()=>{clearTimeout(Ie)}}},[a]);let W=()=>{d(!0)},ie=()=>{d(!1),y(!1)};return t?r!=="intent"?[m,G,{}]:[m,G,{onFocus:zy(c,W),onBlur:zy(P,ie),onMouseEnter:zy(k,W),onMouseLeave:zy(B,ie),onTouchStart:zy(X,W)}]:[!1,G,{}]}function zy(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function FR({page:r,...e}){let{router:t}=jE(),a=ct.useMemo(()=>RE(t.routes,r,t.basename),[t.routes,r,t.basename]);return a?ct.createElement(jR,{page:r,matches:a,...e}):null}function UR(r){let{manifest:e,routeModules:t}=$E(),[a,d]=ct.useState([]);return ct.useEffect(()=>{let m=!1;return RR(r,e,t).then(y=>{m||d(y)}),()=>{m=!0}},[r,e,t]),a}function jR({page:r,matches:e,...t}){let a=qp(),{manifest:d,routeModules:m}=$E(),{basename:y}=jE(),{loaderData:c,matches:P}=BR(),k=ct.useMemo(()=>L2(r,e,P,d,a,"data"),[r,e,P,d,a]),B=ct.useMemo(()=>L2(r,e,P,d,a,"assets"),[r,e,P,d,a]),X=ct.useMemo(()=>{if(r===a.pathname+a.search+a.hash)return[];let ie=new Set,Ie=!1;if(e.forEach(Oe=>{var mt;let Ke=d.routes[Oe.route.id];!Ke||!Ke.hasLoader||(!k.some(qe=>qe.route.id===Oe.route.id)&&Oe.route.id in c&&((mt=m[Oe.route.id])!=null&&mt.shouldRevalidate)||Ke.hasClientLoader?Ie=!0:ie.add(Oe.route.id))}),ie.size===0)return[];let Re=NR(r,y);return Ie&&ie.size>0&&Re.searchParams.set("_routes",e.filter(Oe=>ie.has(Oe.route.id)).map(Oe=>Oe.route.id).join(",")),[Re.pathname+Re.search]},[y,c,a,d,k,e,r,m]),G=ct.useMemo(()=>kR(B,d),[B,d]),W=UR(B);return ct.createElement(ct.Fragment,null,X.map(ie=>ct.createElement("link",{key:ie,rel:"prefetch",as:"fetch",href:ie,...t})),G.map(ie=>ct.createElement("link",{key:ie,rel:"modulepreload",href:ie,...t})),W.map(({key:ie,link:Ie})=>ct.createElement("link",{key:ie,...Ie})))}function $R(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var qE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{qE&&(window.__reactRouterVersion="7.6.2")}catch{}function qR({basename:r,children:e,window:t}){let a=ct.useRef();a.current==null&&(a.current=MM({window:t,v5Compat:!0}));let d=a.current,[m,y]=ct.useState({action:d.action,location:d.location}),c=ct.useCallback(P=>{ct.startTransition(()=>y(P))},[y]);return ct.useLayoutEffect(()=>d.listen(c),[d,c]),ct.createElement(vR,{basename:r,children:e,location:m.location,navigationType:m.action,navigator:d})}var GE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Co=ct.forwardRef(function({onClick:e,discover:t="render",prefetch:a="none",relative:d,reloadDocument:m,replace:y,state:c,target:P,to:k,preventScrollReset:B,viewTransition:X,...G},W){let{basename:ie}=ct.useContext(hh),Ie=typeof k=="string"&&GE.test(k),Re,Oe=!1;if(typeof k=="string"&&Ie&&(Re=k,qE))try{let me=new URL(window.location.href),be=k.startsWith("//")?new URL(me.protocol+k):new URL(k),Ce=Yh(be.pathname,ie);be.origin===me.origin&&Ce!=null?k=Ce+be.search+be.hash:Oe=!0}catch{dc(!1,`<Link to="${k}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Ke=rR(k,{relative:d}),[mt,qe,Fe]=VR(a,G),We=KR(k,{replace:y,state:c,target:P,preventScrollReset:B,relative:d,viewTransition:X});function pe(me){e&&e(me),me.defaultPrevented||We(me)}let oe=ct.createElement("a",{...G,...Fe,href:Re||Ke,onClick:Oe||m?e:pe,ref:$R(W,qe),target:P,"data-discover":!Ie&&t==="render"?"true":void 0});return mt&&!Ie?ct.createElement(ct.Fragment,null,oe,ct.createElement(FR,{page:Ke})):oe});Co.displayName="Link";var GR=ct.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:a="",end:d=!1,style:m,to:y,viewTransition:c,children:P,...k},B){let X=I_(y,{relative:k.relative}),G=qp(),W=ct.useContext(B0),{navigator:ie,basename:Ie}=ct.useContext(hh),Re=W!=null&&JR(X)&&c===!0,Oe=ie.encodeLocation?ie.encodeLocation(X).pathname:X.pathname,Ke=G.pathname,mt=W&&W.navigation&&W.navigation.location?W.navigation.location.pathname:null;t||(Ke=Ke.toLowerCase(),mt=mt?mt.toLowerCase():null,Oe=Oe.toLowerCase()),mt&&Ie&&(mt=Yh(mt,Ie)||mt);const qe=Oe!=="/"&&Oe.endsWith("/")?Oe.length-1:Oe.length;let Fe=Ke===Oe||!d&&Ke.startsWith(Oe)&&Ke.charAt(qe)==="/",We=mt!=null&&(mt===Oe||!d&&mt.startsWith(Oe)&&mt.charAt(Oe.length)==="/"),pe={isActive:Fe,isPending:We,isTransitioning:Re},oe=Fe?e:void 0,me;typeof a=="function"?me=a(pe):me=[a,Fe?"active":null,We?"pending":null,Re?"transitioning":null].filter(Boolean).join(" ");let be=typeof m=="function"?m(pe):m;return ct.createElement(Co,{...k,"aria-current":oe,className:me,ref:B,style:be,to:y,viewTransition:c},typeof P=="function"?P(pe):P)});GR.displayName="NavLink";var HR=ct.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:a,replace:d,state:m,method:y=Uv,action:c,onSubmit:P,relative:k,preventScrollReset:B,viewTransition:X,...G},W)=>{let ie=YR(),Ie=QR(c,{relative:k}),Re=y.toLowerCase()==="get"?"get":"post",Oe=typeof c=="string"&&GE.test(c),Ke=mt=>{if(P&&P(mt),mt.defaultPrevented)return;mt.preventDefault();let qe=mt.nativeEvent.submitter,Fe=(qe==null?void 0:qe.getAttribute("formmethod"))||y;ie(qe||mt.currentTarget,{fetcherKey:e,method:Fe,navigate:t,replace:d,state:m,relative:k,preventScrollReset:B,viewTransition:X})};return ct.createElement("form",{ref:W,method:Re,action:Ie,onSubmit:a?P:Ke,...G,"data-discover":!Oe&&r==="render"?"true":void 0})});HR.displayName="Form";function ZR(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function HE(r){let e=ct.useContext(fg);return ea(e,ZR(r)),e}function KR(r,{target:e,replace:t,state:a,preventScrollReset:d,relative:m,viewTransition:y}={}){let c=iR(),P=qp(),k=I_(r,{relative:m});return ct.useCallback(B=>{if(ER(B,e)){B.preventDefault();let X=t!==void 0?t:n_(P)===n_(k);c(r,{replace:X,state:a,preventScrollReset:d,relative:m,viewTransition:y})}},[P,c,k,t,a,e,r,d,m,y])}var WR=0,XR=()=>`__${String(++WR)}__`;function YR(){let{router:r}=HE("useSubmit"),{basename:e}=ct.useContext(hh),t=mR();return ct.useCallback(async(a,d={})=>{let{action:m,method:y,encType:c,formData:P,body:k}=CR(a,e);if(d.navigate===!1){let B=d.fetcherKey||XR();await r.fetch(B,t,d.action||m,{preventScrollReset:d.preventScrollReset,formData:P,body:k,formMethod:d.method||y,formEncType:d.encType||c,flushSync:d.flushSync})}else await r.navigate(d.action||m,{preventScrollReset:d.preventScrollReset,formData:P,body:k,formMethod:d.method||y,formEncType:d.encType||c,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[r,e,t])}function QR(r,{relative:e}={}){let{basename:t}=ct.useContext(hh),a=ct.useContext(ad);ea(a,"useFormAction must be used inside a RouteContext");let[d]=a.matches.slice(-1),m={...I_(r||".",{relative:e})},y=qp();if(r==null){m.search=y.search;let c=new URLSearchParams(m.search),P=c.getAll("index");if(P.some(B=>B==="")){c.delete("index"),P.filter(X=>X).forEach(X=>c.append("index",X));let B=c.toString();m.search=B?`?${B}`:""}}return(!r||r===".")&&d.route.index&&(m.search=m.search?m.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(m.pathname=m.pathname==="/"?t:Hh([t,m.pathname])),n_(m)}function JR(r,e={}){let t=ct.useContext(NE);ea(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=HE("useViewTransitionState"),d=I_(r,{relative:e.relative});if(!t.isTransitioning)return!1;let m=Yh(t.currentLocation.pathname,a)||t.currentLocation.pathname,y=Yh(t.nextLocation.pathname,a)||t.nextLocation.pathname;return a0(d.pathname,y)!=null||a0(d.pathname,m)!=null}[...OR];const ek=()=>{};var z2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE=function(r){const e=[];let t=0;for(let a=0;a<r.length;a++){let d=r.charCodeAt(a);d<128?e[t++]=d:d<2048?(e[t++]=d>>6|192,e[t++]=d&63|128):(d&64512)===55296&&a+1<r.length&&(r.charCodeAt(a+1)&64512)===56320?(d=65536+((d&1023)<<10)+(r.charCodeAt(++a)&1023),e[t++]=d>>18|240,e[t++]=d>>12&63|128,e[t++]=d>>6&63|128,e[t++]=d&63|128):(e[t++]=d>>12|224,e[t++]=d>>6&63|128,e[t++]=d&63|128)}return e},tk=function(r){const e=[];let t=0,a=0;for(;t<r.length;){const d=r[t++];if(d<128)e[a++]=String.fromCharCode(d);else if(d>191&&d<224){const m=r[t++];e[a++]=String.fromCharCode((d&31)<<6|m&63)}else if(d>239&&d<365){const m=r[t++],y=r[t++],c=r[t++],P=((d&7)<<18|(m&63)<<12|(y&63)<<6|c&63)-65536;e[a++]=String.fromCharCode(55296+(P>>10)),e[a++]=String.fromCharCode(56320+(P&1023))}else{const m=r[t++],y=r[t++];e[a++]=String.fromCharCode((d&15)<<12|(m&63)<<6|y&63)}}return e.join("")},KE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let d=0;d<r.length;d+=3){const m=r[d],y=d+1<r.length,c=y?r[d+1]:0,P=d+2<r.length,k=P?r[d+2]:0,B=m>>2,X=(m&3)<<4|c>>4;let G=(c&15)<<2|k>>6,W=k&63;P||(W=64,y||(G=64)),a.push(t[B],t[X],t[G],t[W])}return a.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(ZE(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):tk(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let d=0;d<r.length;){const m=t[r.charAt(d++)],c=d<r.length?t[r.charAt(d)]:0;++d;const k=d<r.length?t[r.charAt(d)]:64;++d;const X=d<r.length?t[r.charAt(d)]:64;if(++d,m==null||c==null||k==null||X==null)throw new nk;const G=m<<2|c>>4;if(a.push(G),k!==64){const W=c<<4&240|k>>2;if(a.push(W),X!==64){const ie=k<<6&192|X;a.push(ie)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class nk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rk=function(r){const e=ZE(r);return KE.encodeByteArray(e,!0)},s0=function(r){return rk(r).replace(/\./g,"")},WE=function(r){try{return KE.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ik(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=()=>ik().__FIREBASE_DEFAULTS__,sk=()=>{if(typeof process>"u"||typeof z2>"u")return;const r=z2.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},ok=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&WE(r[1]);return e&&JSON.parse(e)},F0=()=>{try{return ek()||ak()||sk()||ok()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},XE=r=>{var e,t;return(t=(e=F0())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},lk=r=>{const e=XE(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},YE=()=>{var r;return(r=F0())===null||r===void 0?void 0:r.config},QE=r=>{var e;return(e=F0())===null||e===void 0?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C_(r){return r.endsWith(".cloudworkstations.dev")}async function JE(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",d=r.iat||0,m=r.sub||r.user_id;if(!m)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const y=Object.assign({iss:`https://securetoken.google.com/${a}`,aud:a,iat:d,exp:d+3600,auth_time:d,sub:m,user_id:m,firebase:{sign_in_provider:"custom",identities:{}}},r);return[s0(JSON.stringify(t)),s0(JSON.stringify(y)),""].join(".")}const qy={};function hk(){const r={prod:[],emulator:[]};for(const e of Object.keys(qy))qy[e]?r.emulator.push(e):r.prod.push(e);return r}function dk(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let O2=!1;function eA(r,e){if(typeof window>"u"||typeof document>"u"||!C_(window.location.host)||qy[r]===e||qy[r]||O2)return;qy[r]=e;function t(G){return`__firebase__banner__${G}`}const a="__firebase__banner",m=hk().prod.length>0;function y(){const G=document.getElementById(a);G&&G.remove()}function c(G){G.style.display="flex",G.style.background="#7faaf0",G.style.position="fixed",G.style.bottom="5px",G.style.left="5px",G.style.padding=".5em",G.style.borderRadius="5px",G.style.alignItems="center"}function P(G,W){G.setAttribute("width","24"),G.setAttribute("id",W),G.setAttribute("height","24"),G.setAttribute("viewBox","0 0 24 24"),G.setAttribute("fill","none"),G.style.marginLeft="-6px"}function k(){const G=document.createElement("span");return G.style.cursor="pointer",G.style.marginLeft="16px",G.style.fontSize="24px",G.innerHTML=" &times;",G.onclick=()=>{O2=!0,y()},G}function B(G,W){G.setAttribute("id",W),G.innerText="Learn more",G.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",G.setAttribute("target","__blank"),G.style.paddingLeft="5px",G.style.textDecoration="underline"}function X(){const G=dk(a),W=t("text"),ie=document.getElementById(W)||document.createElement("span"),Ie=t("learnmore"),Re=document.getElementById(Ie)||document.createElement("a"),Oe=t("preprendIcon"),Ke=document.getElementById(Oe)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(G.created){const mt=G.element;c(mt),B(Re,Ie);const qe=k();P(Ke,Oe),mt.append(Ke,ie,Re,qe),document.body.appendChild(mt)}m?(ie.innerText="Preview backend disconnected.",Ke.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Ke.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,ie.innerText="Preview backend running in this workspace."),ie.setAttribute("id",W)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",X):X()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function no(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(no())}function pk(){var r;const e=(r=F0())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function gk(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function yk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _k(){const r=no();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function vk(){return!pk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function bk(){try{return typeof indexedDB=="object"}catch{return!1}}function xk(){return new Promise((r,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",d=self.indexedDB.open(a);d.onsuccess=()=>{d.result.close(),t||self.indexedDB.deleteDatabase(a),r(!0)},d.onupgradeneeded=()=>{t=!1},d.onerror=()=>{var m;e(((m=d.error)===null||m===void 0?void 0:m.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk="FirebaseError";class sd extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=wk,Object.setPrototypeOf(this,sd.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,P_.prototype.create)}}class P_{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},d=`${this.service}/${e}`,m=this.errors[e],y=m?Tk(m,a):"Error",c=`${this.serviceName}: ${y} (${d}).`;return new sd(d,c,a)}}function Tk(r,e){return r.replace(Sk,(t,a)=>{const d=e[a];return d!=null?String(d):`<${a}?>`})}const Sk=/\{\$([^}]+)}/g;function Ek(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Dp(r,e){if(r===e)return!0;const t=Object.keys(r),a=Object.keys(e);for(const d of t){if(!a.includes(d))return!1;const m=r[d],y=e[d];if(N2(m)&&N2(y)){if(!Dp(m,y))return!1}else if(m!==y)return!1}for(const d of a)if(!t.includes(d))return!1;return!0}function N2(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M_(r){const e=[];for(const[t,a]of Object.entries(r))Array.isArray(a)?a.forEach(d=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(d))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function Oy(r){const e={};return r.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[d,m]=a.split("=");e[decodeURIComponent(d)]=decodeURIComponent(m)}}),e}function Ny(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function Ak(r,e){const t=new Ik(r,e);return t.subscribe.bind(t)}class Ik{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let d;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");Ck(e,["next","error","complete"])?d=e:d={next:e,error:t,complete:a},d.next===void 0&&(d.next=Zb),d.error===void 0&&(d.error=Zb),d.complete===void 0&&(d.complete=Zb);const m=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?d.error(this.finalError):d.complete()}catch{}}),this.observers.push(d),m}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ck(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function Zb(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(r){return r&&r._delegate?r._delegate:r}class Lp{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new uk;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const d=this.getOrInitializeService({instanceIdentifier:t});d&&a.resolve(d)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const a=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),d=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(a)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:a})}catch(m){if(d)return null;throw m}else{if(d)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Rk(e))try{this.getOrInitializeService({instanceIdentifier:xp})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(t);try{const m=this.getOrInitializeService({instanceIdentifier:d});a.resolve(m)}catch{}}}}clearInstance(e=xp){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xp){return this.instances.has(e)}getOptions(e=xp){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const d=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[m,y]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(m);a===c&&y.resolve(d)}return d}onInit(e,t){var a;const d=this.normalizeInstanceIdentifier(t),m=(a=this.onInitCallbacks.get(d))!==null&&a!==void 0?a:new Set;m.add(e),this.onInitCallbacks.set(d,m);const y=this.instances.get(d);return y&&e(y,d),()=>{m.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const d of a)try{d(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:Mk(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=xp){return this.component?this.component.multipleInstances?e:xp:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Mk(r){return r===xp?void 0:r}function Rk(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Pk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lr;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(lr||(lr={}));const Dk={debug:lr.DEBUG,verbose:lr.VERBOSE,info:lr.INFO,warn:lr.WARN,error:lr.ERROR,silent:lr.SILENT},Lk=lr.INFO,zk={[lr.DEBUG]:"log",[lr.VERBOSE]:"log",[lr.INFO]:"info",[lr.WARN]:"warn",[lr.ERROR]:"error"},Ok=(r,e,...t)=>{if(e<r.logLevel)return;const a=new Date().toISOString(),d=zk[e];if(d)console[d](`[${a}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class F1{constructor(e){this.name=e,this._logLevel=Lk,this._logHandler=Ok,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in lr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Dk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,lr.DEBUG,...e),this._logHandler(this,lr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,lr.VERBOSE,...e),this._logHandler(this,lr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,lr.INFO,...e),this._logHandler(this,lr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,lr.WARN,...e),this._logHandler(this,lr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,lr.ERROR,...e),this._logHandler(this,lr.ERROR,...e)}}const Nk=(r,e)=>e.some(t=>r instanceof t);let B2,V2;function Bk(){return B2||(B2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Vk(){return V2||(V2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tA=new WeakMap,Ax=new WeakMap,nA=new WeakMap,Kb=new WeakMap,U1=new WeakMap;function Fk(r){const e=new Promise((t,a)=>{const d=()=>{r.removeEventListener("success",m),r.removeEventListener("error",y)},m=()=>{t(af(r.result)),d()},y=()=>{a(r.error),d()};r.addEventListener("success",m),r.addEventListener("error",y)});return e.then(t=>{t instanceof IDBCursor&&tA.set(t,r)}).catch(()=>{}),U1.set(e,r),e}function Uk(r){if(Ax.has(r))return;const e=new Promise((t,a)=>{const d=()=>{r.removeEventListener("complete",m),r.removeEventListener("error",y),r.removeEventListener("abort",y)},m=()=>{t(),d()},y=()=>{a(r.error||new DOMException("AbortError","AbortError")),d()};r.addEventListener("complete",m),r.addEventListener("error",y),r.addEventListener("abort",y)});Ax.set(r,e)}let Ix={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Ax.get(r);if(e==="objectStoreNames")return r.objectStoreNames||nA.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return af(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function jk(r){Ix=r(Ix)}function $k(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=r.call(Wb(this),e,...t);return nA.set(a,e.sort?e.sort():[e]),af(a)}:Vk().includes(r)?function(...e){return r.apply(Wb(this),e),af(tA.get(this))}:function(...e){return af(r.apply(Wb(this),e))}}function qk(r){return typeof r=="function"?$k(r):(r instanceof IDBTransaction&&Uk(r),Nk(r,Bk())?new Proxy(r,Ix):r)}function af(r){if(r instanceof IDBRequest)return Fk(r);if(Kb.has(r))return Kb.get(r);const e=qk(r);return e!==r&&(Kb.set(r,e),U1.set(e,r)),e}const Wb=r=>U1.get(r);function Gk(r,e,{blocked:t,upgrade:a,blocking:d,terminated:m}={}){const y=indexedDB.open(r,e),c=af(y);return a&&y.addEventListener("upgradeneeded",P=>{a(af(y.result),P.oldVersion,P.newVersion,af(y.transaction),P)}),t&&y.addEventListener("blocked",P=>t(P.oldVersion,P.newVersion,P)),c.then(P=>{m&&P.addEventListener("close",()=>m()),d&&P.addEventListener("versionchange",k=>d(k.oldVersion,k.newVersion,k))}).catch(()=>{}),c}const Hk=["get","getKey","getAll","getAllKeys","count"],Zk=["put","add","delete","clear"],Xb=new Map;function F2(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Xb.get(e))return Xb.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,d=Zk.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(d||Hk.includes(t)))return;const m=async function(y,...c){const P=this.transaction(y,d?"readwrite":"readonly");let k=P.store;return a&&(k=k.index(c.shift())),(await Promise.all([k[t](...c),d&&P.done]))[0]};return Xb.set(e,m),m}jk(r=>({...r,get:(e,t,a)=>F2(e,t)||r.get(e,t,a),has:(e,t)=>!!F2(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Wk(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function Wk(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Cx="@firebase/app",U2="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh=new F1("@firebase/app"),Xk="@firebase/app-compat",Yk="@firebase/analytics-compat",Qk="@firebase/analytics",Jk="@firebase/app-check-compat",eD="@firebase/app-check",tD="@firebase/auth",nD="@firebase/auth-compat",rD="@firebase/database",iD="@firebase/data-connect",aD="@firebase/database-compat",sD="@firebase/functions",oD="@firebase/functions-compat",lD="@firebase/installations",uD="@firebase/installations-compat",cD="@firebase/messaging",hD="@firebase/messaging-compat",dD="@firebase/performance",fD="@firebase/performance-compat",pD="@firebase/remote-config",mD="@firebase/remote-config-compat",gD="@firebase/storage",yD="@firebase/storage-compat",_D="@firebase/firestore",vD="@firebase/ai",bD="@firebase/firestore-compat",xD="firebase",wD="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px="[DEFAULT]",TD={[Cx]:"fire-core",[Xk]:"fire-core-compat",[Qk]:"fire-analytics",[Yk]:"fire-analytics-compat",[eD]:"fire-app-check",[Jk]:"fire-app-check-compat",[tD]:"fire-auth",[nD]:"fire-auth-compat",[rD]:"fire-rtdb",[iD]:"fire-data-connect",[aD]:"fire-rtdb-compat",[sD]:"fire-fn",[oD]:"fire-fn-compat",[lD]:"fire-iid",[uD]:"fire-iid-compat",[cD]:"fire-fcm",[hD]:"fire-fcm-compat",[dD]:"fire-perf",[fD]:"fire-perf-compat",[pD]:"fire-rc",[mD]:"fire-rc-compat",[gD]:"fire-gcs",[yD]:"fire-gcs-compat",[_D]:"fire-fst",[bD]:"fire-fst-compat",[vD]:"fire-vertex","fire-js":"fire-js",[xD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0=new Map,SD=new Map,Mx=new Map;function j2(r,e){try{r.container.addComponent(e)}catch(t){Qh.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ng(r){const e=r.name;if(Mx.has(e))return Qh.debug(`There were multiple attempts to register component ${e}.`),!1;Mx.set(e,r);for(const t of o0.values())j2(t,r);for(const t of SD.values())j2(t,r);return!0}function j1(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function mu(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},sf=new P_("app","Firebase",ED);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,t,a){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new Lp("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sf.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pg=wD;function rA(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const a=Object.assign({name:Px,automaticDataCollectionEnabled:!0},e),d=a.name;if(typeof d!="string"||!d)throw sf.create("bad-app-name",{appName:String(d)});if(t||(t=YE()),!t)throw sf.create("no-options");const m=o0.get(d);if(m){if(Dp(t,m.options)&&Dp(a,m.config))return m;throw sf.create("duplicate-app",{appName:d})}const y=new kk(d);for(const P of Mx.values())y.addComponent(P);const c=new AD(t,a,y);return o0.set(d,c),c}function iA(r=Px){const e=o0.get(r);if(!e&&r===Px&&YE())return rA();if(!e)throw sf.create("no-app",{appName:r});return e}function of(r,e,t){var a;let d=(a=TD[r])!==null&&a!==void 0?a:r;t&&(d+=`-${t}`);const m=d.match(/\s|\//),y=e.match(/\s|\//);if(m||y){const c=[`Unable to register library "${d}" with version "${e}":`];m&&c.push(`library name "${d}" contains illegal characters (whitespace or "/")`),m&&y&&c.push("and"),y&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qh.warn(c.join(" "));return}ng(new Lp(`${d}-version`,()=>({library:d,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID="firebase-heartbeat-database",CD=1,r_="firebase-heartbeat-store";let Yb=null;function aA(){return Yb||(Yb=Gk(ID,CD,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(r_)}catch(t){console.warn(t)}}}}).catch(r=>{throw sf.create("idb-open",{originalErrorMessage:r.message})})),Yb}async function PD(r){try{const t=(await aA()).transaction(r_),a=await t.objectStore(r_).get(sA(r));return await t.done,a}catch(e){if(e instanceof sd)Qh.warn(e.message);else{const t=sf.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qh.warn(t.message)}}}async function $2(r,e){try{const a=(await aA()).transaction(r_,"readwrite");await a.objectStore(r_).put(e,sA(r)),await a.done}catch(t){if(t instanceof sd)Qh.warn(t.message);else{const a=sf.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Qh.warn(a.message)}}}function sA(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD=1024,RD=30;class kD{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new LD(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const d=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),m=q2();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===m||this._heartbeatsCache.heartbeats.some(y=>y.date===m))return;if(this._heartbeatsCache.heartbeats.push({date:m,agent:d}),this._heartbeatsCache.heartbeats.length>RD){const y=zD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(y,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Qh.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=q2(),{heartbeatsToSend:a,unsentEntries:d}=DD(this._heartbeatsCache.heartbeats),m=s0(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,d.length>0?(this._heartbeatsCache.heartbeats=d,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),m}catch(t){return Qh.warn(t),""}}}function q2(){return new Date().toISOString().substring(0,10)}function DD(r,e=MD){const t=[];let a=r.slice();for(const d of r){const m=t.find(y=>y.agent===d.agent);if(m){if(m.dates.push(d.date),G2(t)>e){m.dates.pop();break}}else if(t.push({agent:d.agent,dates:[d.date]}),G2(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class LD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bk()?xk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await PD(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const d=await this.read();return $2(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:d.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const d=await this.read();return $2(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:d.lastSentHeartbeatDate,heartbeats:[...d.heartbeats,...e.heartbeats]})}else return}}function G2(r){return s0(JSON.stringify({version:2,heartbeats:r})).length}function zD(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let a=1;a<r.length;a++)r[a].date<t&&(t=r[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OD(r){ng(new Lp("platform-logger",e=>new Kk(e),"PRIVATE")),ng(new Lp("heartbeat",e=>new kD(e),"PRIVATE")),of(Cx,U2,r),of(Cx,U2,"esm2017"),of("fire-js","")}OD("");var ND="firebase",BD="11.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */of(ND,BD,"app");function $1(r,e){var t={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&e.indexOf(a)<0&&(t[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,a=Object.getOwnPropertySymbols(r);d<a.length;d++)e.indexOf(a[d])<0&&Object.prototype.propertyIsEnumerable.call(r,a[d])&&(t[a[d]]=r[a[d]]);return t}function oA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VD=oA,lA=new P_("auth","Firebase",oA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l0=new F1("@firebase/auth");function FD(r,...e){l0.logLevel<=lr.WARN&&l0.warn(`Auth (${pg}): ${r}`,...e)}function $v(r,...e){l0.logLevel<=lr.ERROR&&l0.error(`Auth (${pg}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(r,...e){throw q1(r,...e)}function nh(r,...e){return q1(r,...e)}function uA(r,e,t){const a=Object.assign(Object.assign({},VD()),{[e]:t});return new P_("auth","Firebase",a).create(e,{appName:r.name})}function Zh(r){return uA(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function q1(r,...e){if(typeof r!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=r.name),r._errorFactory.create(t,...a)}return lA.create(r,...e)}function Cn(r,e,...t){if(!r)throw q1(e,...t)}function qh(r){const e="INTERNAL ASSERTION FAILED: "+r;throw $v(e),new Error(e)}function Jh(r,e){r||qh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.href)||""}function UD(){return H2()==="http:"||H2()==="https:"}function H2(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(UD()||gk()||"connection"in navigator)?navigator.onLine:!0}function $D(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,t){this.shortDelay=e,this.longDelay=t,Jh(t>e,"Short delay should be less than long delay!"),this.isMobile=fk()||yk()}get(){return jD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G1(r,e){Jh(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],HD=new R_(3e4,6e4);function vf(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}async function bf(r,e,t,a,d={}){return hA(r,d,async()=>{let m={},y={};a&&(e==="GET"?y=a:m={body:JSON.stringify(a)});const c=M_(Object.assign({key:r.config.apiKey},y)).slice(1),P=await r._getAdditionalHeaders();P["Content-Type"]="application/json",r.languageCode&&(P["X-Firebase-Locale"]=r.languageCode);const k=Object.assign({method:e,headers:P},m);return mk()||(k.referrerPolicy="no-referrer"),r.emulatorConfig&&C_(r.emulatorConfig.host)&&(k.credentials="include"),cA.fetch()(await dA(r,r.config.apiHost,t,c),k)})}async function hA(r,e,t){r._canInitEmulator=!1;const a=Object.assign(Object.assign({},qD),e);try{const d=new KD(r),m=await Promise.race([t(),d.promise]);d.clearNetworkTimeout();const y=await m.json();if("needConfirmation"in y)throw Iv(r,"account-exists-with-different-credential",y);if(m.ok&&!("errorMessage"in y))return y;{const c=m.ok?y.errorMessage:y.error.message,[P,k]=c.split(" : ");if(P==="FEDERATED_USER_ID_ALREADY_LINKED")throw Iv(r,"credential-already-in-use",y);if(P==="EMAIL_EXISTS")throw Iv(r,"email-already-in-use",y);if(P==="USER_DISABLED")throw Iv(r,"user-disabled",y);const B=a[P]||P.toLowerCase().replace(/[_\s]+/g,"-");if(k)throw uA(r,B,k);fc(r,B)}}catch(d){if(d instanceof sd)throw d;fc(r,"network-request-failed",{message:String(d)})}}async function k_(r,e,t,a,d={}){const m=await bf(r,e,t,a,d);return"mfaPendingCredential"in m&&fc(r,"multi-factor-auth-required",{_serverResponse:m}),m}async function dA(r,e,t,a){const d=`${e}${t}?${a}`,m=r,y=m.config.emulator?G1(r.config,d):`${r.config.apiScheme}://${d}`;return GD.includes(t)&&(await m._persistenceManagerAvailable,m._getPersistenceType()==="COOKIE")?m._getPersistence()._getFinalTarget(y).toString():y}function ZD(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class KD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(nh(this.auth,"network-request-failed")),HD.get())})}}function Iv(r,e,t){const a={appName:r.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const d=nh(r,e,a);return d.customData._tokenResponse=t,d}function Z2(r){return r!==void 0&&r.enterprise!==void 0}class WD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ZD(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function XD(r,e){return bf(r,"GET","/v2/recaptchaConfig",vf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YD(r,e){return bf(r,"POST","/v1/accounts:delete",e)}async function u0(r,e){return bf(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function QD(r,e=!1){const t=Ms(r),a=await t.getIdToken(e),d=H1(a);Cn(d&&d.exp&&d.auth_time&&d.iat,t.auth,"internal-error");const m=typeof d.firebase=="object"?d.firebase:void 0,y=m==null?void 0:m.sign_in_provider;return{claims:d,token:a,authTime:Gy(Qb(d.auth_time)),issuedAtTime:Gy(Qb(d.iat)),expirationTime:Gy(Qb(d.exp)),signInProvider:y||null,signInSecondFactor:(m==null?void 0:m.sign_in_second_factor)||null}}function Qb(r){return Number(r)*1e3}function H1(r){const[e,t,a]=r.split(".");if(e===void 0||t===void 0||a===void 0)return $v("JWT malformed, contained fewer than 3 sections"),null;try{const d=WE(t);return d?JSON.parse(d):($v("Failed to decode base64 JWT payload"),null)}catch(d){return $v("Caught error parsing JWT payload as JSON",d==null?void 0:d.toString()),null}}function K2(r){const e=H1(r);return Cn(e,"internal-error"),Cn(typeof e.exp<"u","internal-error"),Cn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i_(r,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof sd&&JD(a)&&r.auth.currentUser===r&&await r.auth.signOut(),a}}function JD({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const d=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,d)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gy(this.lastLoginAt),this.creationTime=Gy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c0(r){var e;const t=r.auth,a=await r.getIdToken(),d=await i_(r,u0(t,{idToken:a}));Cn(d==null?void 0:d.users.length,t,"internal-error");const m=d.users[0];r._notifyReloadListener(m);const y=!((e=m.providerUserInfo)===null||e===void 0)&&e.length?fA(m.providerUserInfo):[],c=n5(r.providerData,y),P=r.isAnonymous,k=!(r.email&&m.passwordHash)&&!(c!=null&&c.length),B=P?k:!1,X={uid:m.localId,displayName:m.displayName||null,photoURL:m.photoUrl||null,email:m.email||null,emailVerified:m.emailVerified||!1,phoneNumber:m.phoneNumber||null,tenantId:m.tenantId||null,providerData:c,metadata:new kx(m.createdAt,m.lastLoginAt),isAnonymous:B};Object.assign(r,X)}async function t5(r){const e=Ms(r);await c0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function n5(r,e){return[...r.filter(a=>!e.some(d=>d.providerId===a.providerId)),...e]}function fA(r){return r.map(e=>{var{providerId:t}=e,a=$1(e,["providerId"]);return{providerId:t,uid:a.rawId||"",displayName:a.displayName||null,email:a.email||null,phoneNumber:a.phoneNumber||null,photoURL:a.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r5(r,e){const t=await hA(r,{},async()=>{const a=M_({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:d,apiKey:m}=r.config,y=await dA(r,d,"/v1/token",`key=${m}`),c=await r._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",cA.fetch()(y,{method:"POST",headers:c,body:a})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function i5(r,e){return bf(r,"POST","/v2/accounts:revokeToken",vf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Cn(e.idToken,"internal-error"),Cn(typeof e.idToken<"u","internal-error"),Cn(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):K2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Cn(e.length!==0,"internal-error");const t=K2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Cn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:d,expiresIn:m}=await r5(e,t);this.updateTokensAndExpiration(a,d,Number(m))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:d,expirationTime:m}=t,y=new Zm;return a&&(Cn(typeof a=="string","internal-error",{appName:e}),y.refreshToken=a),d&&(Cn(typeof d=="string","internal-error",{appName:e}),y.accessToken=d),m&&(Cn(typeof m=="number","internal-error",{appName:e}),y.expirationTime=m),y}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zm,this.toJSON())}_performRefresh(){return qh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wd(r,e){Cn(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class lc{constructor(e){var{uid:t,auth:a,stsTokenManager:d}=e,m=$1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new e5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=a,this.stsTokenManager=d,this.accessToken=d.accessToken,this.displayName=m.displayName||null,this.email=m.email||null,this.emailVerified=m.emailVerified||!1,this.phoneNumber=m.phoneNumber||null,this.photoURL=m.photoURL||null,this.isAnonymous=m.isAnonymous||!1,this.tenantId=m.tenantId||null,this.providerData=m.providerData?[...m.providerData]:[],this.metadata=new kx(m.createdAt||void 0,m.lastLoginAt||void 0)}async getIdToken(e){const t=await i_(this,this.stsTokenManager.getToken(this.auth,e));return Cn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return QD(this,e)}reload(){return t5(this)}_assign(e){this!==e&&(Cn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new lc(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Cn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await c0(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(mu(this.auth.app))return Promise.reject(Zh(this.auth));const e=await this.getIdToken();return await i_(this,YD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var a,d,m,y,c,P,k,B;const X=(a=t.displayName)!==null&&a!==void 0?a:void 0,G=(d=t.email)!==null&&d!==void 0?d:void 0,W=(m=t.phoneNumber)!==null&&m!==void 0?m:void 0,ie=(y=t.photoURL)!==null&&y!==void 0?y:void 0,Ie=(c=t.tenantId)!==null&&c!==void 0?c:void 0,Re=(P=t._redirectEventId)!==null&&P!==void 0?P:void 0,Oe=(k=t.createdAt)!==null&&k!==void 0?k:void 0,Ke=(B=t.lastLoginAt)!==null&&B!==void 0?B:void 0,{uid:mt,emailVerified:qe,isAnonymous:Fe,providerData:We,stsTokenManager:pe}=t;Cn(mt&&pe,e,"internal-error");const oe=Zm.fromJSON(this.name,pe);Cn(typeof mt=="string",e,"internal-error"),Wd(X,e.name),Wd(G,e.name),Cn(typeof qe=="boolean",e,"internal-error"),Cn(typeof Fe=="boolean",e,"internal-error"),Wd(W,e.name),Wd(ie,e.name),Wd(Ie,e.name),Wd(Re,e.name),Wd(Oe,e.name),Wd(Ke,e.name);const me=new lc({uid:mt,auth:e,email:G,emailVerified:qe,displayName:X,isAnonymous:Fe,photoURL:ie,phoneNumber:W,tenantId:Ie,stsTokenManager:oe,createdAt:Oe,lastLoginAt:Ke});return We&&Array.isArray(We)&&(me.providerData=We.map(be=>Object.assign({},be))),Re&&(me._redirectEventId=Re),me}static async _fromIdTokenResponse(e,t,a=!1){const d=new Zm;d.updateFromServerResponse(t);const m=new lc({uid:t.localId,auth:e,stsTokenManager:d,isAnonymous:a});return await c0(m),m}static async _fromGetAccountInfoResponse(e,t,a){const d=t.users[0];Cn(d.localId!==void 0,"internal-error");const m=d.providerUserInfo!==void 0?fA(d.providerUserInfo):[],y=!(d.email&&d.passwordHash)&&!(m!=null&&m.length),c=new Zm;c.updateFromIdToken(a);const P=new lc({uid:d.localId,auth:e,stsTokenManager:c,isAnonymous:y}),k={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:m,metadata:new kx(d.createdAt,d.lastLoginAt),isAnonymous:!(d.email&&d.passwordHash)&&!(m!=null&&m.length)};return Object.assign(P,k),P}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W2=new Map;function Gh(r){Jh(r instanceof Function,"Expected a class definition");let e=W2.get(r);return e?(Jh(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,W2.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}pA.type="NONE";const X2=pA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qv(r,e,t){return`firebase:${r}:${e}:${t}`}class Km{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:d,name:m}=this.auth;this.fullUserKey=qv(this.userKey,d.apiKey,m),this.fullPersistenceKey=qv("persistence",d.apiKey,m),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await u0(this.auth,{idToken:e}).catch(()=>{});return t?lc._fromGetAccountInfoResponse(this.auth,t,e):null}return lc._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new Km(Gh(X2),e,a);const d=(await Promise.all(t.map(async k=>{if(await k._isAvailable())return k}))).filter(k=>k);let m=d[0]||Gh(X2);const y=qv(a,e.config.apiKey,e.name);let c=null;for(const k of t)try{const B=await k._get(y);if(B){let X;if(typeof B=="string"){const G=await u0(e,{idToken:B}).catch(()=>{});if(!G)break;X=await lc._fromGetAccountInfoResponse(e,G,B)}else X=lc._fromJSON(e,B);k!==m&&(c=X),m=k;break}}catch{}const P=d.filter(k=>k._shouldAllowMigration);return!m._shouldAllowMigration||!P.length?new Km(m,e,a):(m=P[0],c&&await m._set(y,c.toJSON()),await Promise.all(t.map(async k=>{if(k!==m)try{await k._remove(y)}catch{}})),new Km(m,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y2(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_A(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(mA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(bA(e))return"Blackberry";if(xA(e))return"Webos";if(gA(e))return"Safari";if((e.includes("chrome/")||yA(e))&&!e.includes("edge/"))return"Chrome";if(vA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=r.match(t);if((a==null?void 0:a.length)===2)return a[1]}return"Other"}function mA(r=no()){return/firefox\//i.test(r)}function gA(r=no()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yA(r=no()){return/crios\//i.test(r)}function _A(r=no()){return/iemobile/i.test(r)}function vA(r=no()){return/android/i.test(r)}function bA(r=no()){return/blackberry/i.test(r)}function xA(r=no()){return/webos/i.test(r)}function Z1(r=no()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function a5(r=no()){var e;return Z1(r)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function s5(){return _k()&&document.documentMode===10}function wA(r=no()){return Z1(r)||vA(r)||xA(r)||bA(r)||/windows phone/i.test(r)||_A(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(r,e=[]){let t;switch(r){case"Browser":t=Y2(no());break;case"Worker":t=`${Y2(no())}-${r}`;break;default:t=r}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${pg}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=m=>new Promise((y,c)=>{try{const P=e(m);y(P)}catch(P){c(P)}});a.onAbort=t,this.queue.push(a);const d=this.queue.length-1;return()=>{this.queue[d]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const d of t)try{d()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a==null?void 0:a.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l5(r,e={}){return bf(r,"GET","/v2/passwordPolicy",vf(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5=6;class c5{constructor(e){var t,a,d,m;const y=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=y.minPasswordLength)!==null&&t!==void 0?t:u5,y.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=y.maxPasswordLength),y.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=y.containsLowercaseCharacter),y.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=y.containsUppercaseCharacter),y.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=y.containsNumericCharacter),y.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=y.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(d=(a=e.allowedNonAlphanumericCharacters)===null||a===void 0?void 0:a.join(""))!==null&&d!==void 0?d:"",this.forceUpgradeOnSignin=(m=e.forceUpgradeOnSignin)!==null&&m!==void 0?m:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,a,d,m,y,c;const P={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,P),this.validatePasswordCharacterOptions(e,P),P.isValid&&(P.isValid=(t=P.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),P.isValid&&(P.isValid=(a=P.meetsMaxPasswordLength)!==null&&a!==void 0?a:!0),P.isValid&&(P.isValid=(d=P.containsLowercaseLetter)!==null&&d!==void 0?d:!0),P.isValid&&(P.isValid=(m=P.containsUppercaseLetter)!==null&&m!==void 0?m:!0),P.isValid&&(P.isValid=(y=P.containsNumericCharacter)!==null&&y!==void 0?y:!0),P.isValid&&(P.isValid=(c=P.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),P}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,d=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),d&&(t.meetsMaxPasswordLength=e.length<=d)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let d=0;d<e.length;d++)a=e.charAt(d),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,d,m){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=d)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e,t,a,d){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=d,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Q2(this),this.idTokenSubscription=new Q2(this),this.beforeStateQueue=new o5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=lA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=d.sdkClientVersion,this._persistenceManagerAvailable=new Promise(m=>this._resolvePersistenceManagerAvailable=m)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Gh(t)),this._initializationPromise=this.queue(async()=>{var a,d,m;if(!this._deleted&&(this.persistenceManager=await Km.create(this,e),(a=this._resolvePersistenceManagerAvailable)===null||a===void 0||a.call(this),!this._deleted)){if(!((d=this._popupRedirectResolver)===null||d===void 0)&&d._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((m=this.currentUser)===null||m===void 0?void 0:m.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await u0(this,{idToken:e}),a=await lc._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(mu(this.app)){const y=this.app.settings.authIdToken;return y?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(y).then(c,c))}):this.directlySetCurrentUser(null)}const a=await this.assertedPersistence.getCurrentUser();let d=a,m=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const y=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=d==null?void 0:d._redirectEventId,P=await this.tryRedirectSignIn(e);(!y||y===c)&&(P!=null&&P.user)&&(d=P.user,m=!0)}if(!d)return this.directlySetCurrentUser(null);if(!d._redirectEventId){if(m)try{await this.beforeStateQueue.runMiddleware(d)}catch(y){d=a,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(y))}return d?this.reloadAndSetCurrentUserOrClear(d):this.directlySetCurrentUser(null)}return Cn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===d._redirectEventId?this.directlySetCurrentUser(d):this.reloadAndSetCurrentUserOrClear(d)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await c0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$D()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(mu(this.app))return Promise.reject(Zh(this));const t=e?Ms(e):null;return t&&Cn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Cn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return mu(this.app)?Promise.reject(Zh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return mu(this.app)?Promise.reject(Zh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await l5(this),t=new c5(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new P_("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await i5(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Gh(e)||this._popupRedirectResolver;Cn(t,this,"argument-error"),this.redirectPersistenceManager=await Km.create(this,[Gh(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const a=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,d){if(this._deleted)return()=>{};const m=typeof t=="function"?t:t.next.bind(t);let y=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Cn(c,this,"internal-error"),c.then(()=>{y||m(this.currentUser)}),typeof t=="function"){const P=e.addObserver(t,a,d);return()=>{y=!0,P()}}else{const P=e.addObserver(t);return()=>{y=!0,P()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Cn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=TA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const a=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());a&&(t["X-Firebase-Client"]=a);const d=await this._getAppCheckToken();return d&&(t["X-Firebase-AppCheck"]=d),t}async _getAppCheckToken(){var e;if(mu(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&FD(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Gp(r){return Ms(r)}class Q2{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ak(t=>this.observer=t)}get next(){return Cn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let U0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function d5(r){U0=r}function SA(r){return U0.loadJS(r)}function f5(){return U0.recaptchaEnterpriseScript}function p5(){return U0.gapiScript}function m5(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class g5{constructor(){this.enterprise=new y5}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class y5{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const _5="recaptcha-enterprise",EA="NO_RECAPTCHA";class v5{constructor(e){this.type=_5,this.auth=Gp(e)}async verify(e="verify",t=!1){async function a(m){if(!t){if(m.tenantId==null&&m._agentRecaptchaConfig!=null)return m._agentRecaptchaConfig.siteKey;if(m.tenantId!=null&&m._tenantRecaptchaConfigs[m.tenantId]!==void 0)return m._tenantRecaptchaConfigs[m.tenantId].siteKey}return new Promise(async(y,c)=>{XD(m,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(P=>{if(P.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const k=new WD(P);return m.tenantId==null?m._agentRecaptchaConfig=k:m._tenantRecaptchaConfigs[m.tenantId]=k,y(k.siteKey)}}).catch(P=>{c(P)})})}function d(m,y,c){const P=window.grecaptcha;Z2(P)?P.enterprise.ready(()=>{P.enterprise.execute(m,{action:e}).then(k=>{y(k)}).catch(()=>{y(EA)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new g5().execute("siteKey",{action:"verify"}):new Promise((m,y)=>{a(this.auth).then(c=>{if(!t&&Z2(window.grecaptcha))d(c,m,y);else{if(typeof window>"u"){y(new Error("RecaptchaVerifier is only supported in browser"));return}let P=f5();P.length!==0&&(P+=c),SA(P).then(()=>{d(c,m,y)}).catch(k=>{y(k)})}}).catch(c=>{y(c)})})}}async function J2(r,e,t,a=!1,d=!1){const m=new v5(r);let y;if(d)y=EA;else try{y=await m.verify(t)}catch{y=await m.verify(t,!0)}const c=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const P=c.phoneEnrollmentInfo.phoneNumber,k=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:P,recaptchaToken:k,captchaResponse:y,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const P=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:P,captchaResponse:y,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return a?Object.assign(c,{captchaResp:y}):Object.assign(c,{captchaResponse:y}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Dx(r,e,t,a,d){var m;if(!((m=r._getRecaptchaConfig())===null||m===void 0)&&m.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const y=await J2(r,e,t,t==="getOobCode");return a(r,y)}else return a(r,e).catch(async y=>{if(y.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await J2(r,e,t,t==="getOobCode");return a(r,c)}else return Promise.reject(y)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b5(r,e){const t=j1(r,"auth");if(t.isInitialized()){const d=t.getImmediate(),m=t.getOptions();if(Dp(m,e??{}))return d;fc(d,"already-initialized")}return t.initialize({options:e})}function x5(r,e){const t=(e==null?void 0:e.persistence)||[],a=(Array.isArray(t)?t:[t]).map(Gh);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(a,e==null?void 0:e.popupRedirectResolver)}function w5(r,e,t){const a=Gp(r);Cn(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const d=!1,m=AA(e),{host:y,port:c}=T5(e),P=c===null?"":`:${c}`,k={url:`${m}//${y}${P}/`},B=Object.freeze({host:y,port:c,protocol:m.replace(":",""),options:Object.freeze({disableWarnings:d})});if(!a._canInitEmulator){Cn(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Cn(Dp(k,a.config.emulator)&&Dp(B,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=k,a.emulatorConfig=B,a.settings.appVerificationDisabledForTesting=!0,C_(y)?(JE(`${m}//${y}${P}`),eA("Auth",!0)):S5()}function AA(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function T5(r){const e=AA(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",d=/^(\[[^\]]+\])(:|$)/.exec(a);if(d){const m=d[1];return{host:m,port:eT(a.substr(m.length+1))}}else{const[m,y]=a.split(":");return{host:m,port:eT(y)}}}function eT(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function S5(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return qh("not implemented")}_getIdTokenResponse(e){return qh("not implemented")}_linkToIdToken(e,t){return qh("not implemented")}_getReauthenticationResolver(e){return qh("not implemented")}}async function E5(r,e){return bf(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A5(r,e){return k_(r,"POST","/v1/accounts:signInWithPassword",vf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I5(r,e){return k_(r,"POST","/v1/accounts:signInWithEmailLink",vf(r,e))}async function C5(r,e){return k_(r,"POST","/v1/accounts:signInWithEmailLink",vf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_ extends K1{constructor(e,t,a,d=null){super("password",a),this._email=e,this._password=t,this._tenantId=d}static _fromEmailAndPassword(e,t){return new a_(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new a_(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dx(e,t,"signInWithPassword",A5);case"emailLink":return I5(e,{email:this._email,oobCode:this._password});default:fc(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dx(e,a,"signUpPassword",E5);case"emailLink":return C5(e,{idToken:t,email:this._email,oobCode:this._password});default:fc(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wm(r,e){return k_(r,"POST","/v1/accounts:signInWithIdp",vf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P5="http://localhost";class zp extends K1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new zp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):fc("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:d}=t,m=$1(t,["providerId","signInMethod"]);if(!a||!d)return null;const y=new zp(a,d);return y.idToken=m.idToken||void 0,y.accessToken=m.accessToken||void 0,y.secret=m.secret,y.nonce=m.nonce,y.pendingToken=m.pendingToken||null,y}_getIdTokenResponse(e){const t=this.buildRequest();return Wm(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,Wm(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Wm(e,t)}buildRequest(){const e={requestUri:P5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=M_(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M5(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function R5(r){const e=Oy(Ny(r)).link,t=e?Oy(Ny(e)).deep_link_id:null,a=Oy(Ny(r)).deep_link_id;return(a?Oy(Ny(a)).link:null)||a||t||e||r}class W1{constructor(e){var t,a,d,m,y,c;const P=Oy(Ny(e)),k=(t=P.apiKey)!==null&&t!==void 0?t:null,B=(a=P.oobCode)!==null&&a!==void 0?a:null,X=M5((d=P.mode)!==null&&d!==void 0?d:null);Cn(k&&B&&X,"argument-error"),this.apiKey=k,this.operation=X,this.code=B,this.continueUrl=(m=P.continueUrl)!==null&&m!==void 0?m:null,this.languageCode=(y=P.lang)!==null&&y!==void 0?y:null,this.tenantId=(c=P.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const t=R5(e);try{return new W1(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(){this.providerId=mg.PROVIDER_ID}static credential(e,t){return a_._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=W1.parseLink(t);return Cn(a,"argument-error"),a_._fromEmailAndCode(e,a.code,a.tenantId)}}mg.PROVIDER_ID="password";mg.EMAIL_PASSWORD_SIGN_IN_METHOD="password";mg.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_ extends IA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd extends D_{constructor(){super("facebook.com")}static credential(e){return zp._fromParams({providerId:Qd.PROVIDER_ID,signInMethod:Qd.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qd.credentialFromTaggedObject(e)}static credentialFromError(e){return Qd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qd.credential(e.oauthAccessToken)}catch{return null}}}Qd.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qd.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd extends D_{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return zp._fromParams({providerId:Jd.PROVIDER_ID,signInMethod:Jd.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Jd.credentialFromTaggedObject(e)}static credentialFromError(e){return Jd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return Jd.credential(t,a)}catch{return null}}}Jd.GOOGLE_SIGN_IN_METHOD="google.com";Jd.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef extends D_{constructor(){super("github.com")}static credential(e){return zp._fromParams({providerId:ef.PROVIDER_ID,signInMethod:ef.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ef.credentialFromTaggedObject(e)}static credentialFromError(e){return ef.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ef.credential(e.oauthAccessToken)}catch{return null}}}ef.GITHUB_SIGN_IN_METHOD="github.com";ef.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends D_{constructor(){super("twitter.com")}static credential(e,t){return zp._fromParams({providerId:tf.PROVIDER_ID,signInMethod:tf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return tf.credentialFromTaggedObject(e)}static credentialFromError(e){return tf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return tf.credential(t,a)}catch{return null}}}tf.TWITTER_SIGN_IN_METHOD="twitter.com";tf.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k5(r,e){return k_(r,"POST","/v1/accounts:signUp",vf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,d=!1){const m=await lc._fromIdTokenResponse(e,a,d),y=tT(a);return new Op({user:m,providerId:y,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const d=tT(a);return new Op({user:e,providerId:d,_tokenResponse:a,operationType:t})}}function tT(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0 extends sd{constructor(e,t,a,d){var m;super(t.code,t.message),this.operationType=a,this.user=d,Object.setPrototypeOf(this,h0.prototype),this.customData={appName:e.name,tenantId:(m=e.tenantId)!==null&&m!==void 0?m:void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,d){return new h0(e,t,a,d)}}function CA(r,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(m=>{throw m.code==="auth/multi-factor-auth-required"?h0._fromErrorAndOperation(r,m,e,a):m})}async function D5(r,e,t=!1){const a=await i_(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Op._forOperation(r,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L5(r,e,t=!1){const{auth:a}=r;if(mu(a.app))return Promise.reject(Zh(a));const d="reauthenticate";try{const m=await i_(r,CA(a,d,e,r),t);Cn(m.idToken,a,"internal-error");const y=H1(m.idToken);Cn(y,a,"internal-error");const{sub:c}=y;return Cn(r.uid===c,a,"user-mismatch"),Op._forOperation(r,d,m)}catch(m){throw(m==null?void 0:m.code)==="auth/user-not-found"&&fc(a,"user-mismatch"),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PA(r,e,t=!1){if(mu(r.app))return Promise.reject(Zh(r));const a="signIn",d=await CA(r,a,e),m=await Op._fromIdTokenResponse(r,a,d);return t||await r._updateCurrentUser(m.user),m}async function z5(r,e){return PA(Gp(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MA(r){const e=Gp(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function O5(r,e,t){if(mu(r.app))return Promise.reject(Zh(r));const a=Gp(r),y=await Dx(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",k5).catch(P=>{throw P.code==="auth/password-does-not-meet-requirements"&&MA(r),P}),c=await Op._fromIdTokenResponse(a,"signIn",y);return await a._updateCurrentUser(c.user),c}function RA(r,e,t){return mu(r.app)?Promise.reject(Zh(r)):z5(Ms(r),mg.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&MA(r),a})}function N5(r,e,t,a){return Ms(r).onIdTokenChanged(e,t,a)}function B5(r,e,t){return Ms(r).beforeAuthStateChanged(e,t)}function V5(r){return Ms(r).signOut()}const d0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(d0,"1"),this.storage.removeItem(d0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F5=1e3,U5=10;class DA extends kA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=wA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),d=this.localCache[t];a!==d&&e(t,d,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((y,c,P)=>{this.notifyListeners(y,P)});return}const a=e.key;t?this.detachListener():this.stopPolling();const d=()=>{const y=this.storage.getItem(a);!t&&this.localCache[a]===y||this.notifyListeners(a,y)},m=this.storage.getItem(a);s5()&&m!==e.newValue&&e.newValue!==e.oldValue?setTimeout(d,U5):d()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const d of Array.from(a))d(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},F5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}DA.type="LOCAL";const j5=DA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA extends kA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}LA.type="SESSION";const zA=LA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $5(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(d=>d.isListeningto(e));if(t)return t;const a=new j0(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:d,data:m}=t.data,y=this.handlersMap[d];if(!(y!=null&&y.size))return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:d});const c=Array.from(y).map(async k=>k(t.origin,m)),P=await $5(c);t.ports[0].postMessage({status:"done",eventId:a,eventType:d,response:P})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}j0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X1(r="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const d=typeof MessageChannel<"u"?new MessageChannel:null;if(!d)throw new Error("connection_unavailable");let m,y;return new Promise((c,P)=>{const k=X1("",20);d.port1.start();const B=setTimeout(()=>{P(new Error("unsupported_event"))},a);y={messageChannel:d,onMessage(X){const G=X;if(G.data.eventId===k)switch(G.data.status){case"ack":clearTimeout(B),m=setTimeout(()=>{P(new Error("timeout"))},3e3);break;case"done":clearTimeout(m),c(G.data.response);break;default:clearTimeout(B),clearTimeout(m),P(new Error("invalid_response"));break}}},this.handlers.add(y),d.port1.addEventListener("message",y.onMessage),this.target.postMessage({eventType:e,eventId:k,data:t},[d.port2])}).finally(()=>{y&&this.removeMessageHandler(y)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(){return window}function G5(r){rh().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(){return typeof rh().WorkerGlobalScope<"u"&&typeof rh().importScripts=="function"}async function H5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Z5(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)===null||r===void 0?void 0:r.controller)||null}function K5(){return OA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA="firebaseLocalStorageDb",W5=1,f0="firebaseLocalStorage",BA="fbase_key";class L_{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $0(r,e){return r.transaction([f0],e?"readwrite":"readonly").objectStore(f0)}function X5(){const r=indexedDB.deleteDatabase(NA);return new L_(r).toPromise()}function Lx(){const r=indexedDB.open(NA,W5);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const a=r.result;try{a.createObjectStore(f0,{keyPath:BA})}catch(d){t(d)}}),r.addEventListener("success",async()=>{const a=r.result;a.objectStoreNames.contains(f0)?e(a):(a.close(),await X5(),e(await Lx()))})})}async function nT(r,e,t){const a=$0(r,!0).put({[BA]:e,value:t});return new L_(a).toPromise()}async function Y5(r,e){const t=$0(r,!1).get(e),a=await new L_(t).toPromise();return a===void 0?null:a.value}function rT(r,e){const t=$0(r,!0).delete(e);return new L_(t).toPromise()}const Q5=800,J5=3;class VA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Lx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>J5)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return OA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=j0._getInstance(K5()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await H5(),!this.activeServiceWorker)return;this.sender=new q5(this.activeServiceWorker);const a=await this.sender._send("ping",{},800);a&&!((e=a[0])===null||e===void 0)&&e.fulfilled&&!((t=a[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Z5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Lx();return await nT(e,d0,"1"),await rT(e,d0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>nT(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>Y5(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>rT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(d=>{const m=$0(d,!1).getAll();return new L_(m).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:d,value:m}of e)a.add(d),JSON.stringify(this.localCache[d])!==JSON.stringify(m)&&(this.notifyListeners(d,m),t.push(d));for(const d of Object.keys(this.localCache))this.localCache[d]&&!a.has(d)&&(this.notifyListeners(d,null),t.push(d));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const d of Array.from(a))d(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Q5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}VA.type="LOCAL";const e3=VA;new R_(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(r,e){return e?Gh(e):(Cn(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1 extends K1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Wm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Wm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function n3(r){return PA(r.auth,new Y1(r),r.bypassAuthState)}function r3(r){const{auth:e,user:t}=r;return Cn(t,e,"internal-error"),L5(t,new Y1(r),r.bypassAuthState)}async function i3(r){const{auth:e,user:t}=r;return Cn(t,e,"internal-error"),D5(t,new Y1(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e,t,a,d,m=!1){this.auth=e,this.resolver=a,this.user=d,this.bypassAuthState=m,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:d,tenantId:m,error:y,type:c}=e;if(y){this.reject(y);return}const P={auth:this.auth,requestUri:t,sessionId:a,tenantId:m||void 0,postBody:d||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(P))}catch(k){this.reject(k)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return n3;case"linkViaPopup":case"linkViaRedirect":return i3;case"reauthViaPopup":case"reauthViaRedirect":return r3;default:fc(this.auth,"internal-error")}}resolve(e){Jh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Jh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3=new R_(2e3,1e4);class qm extends FA{constructor(e,t,a,d,m){super(e,t,d,m),this.provider=a,this.authWindow=null,this.pollId=null,qm.currentPopupAction&&qm.currentPopupAction.cancel(),qm.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Cn(e,this.auth,"internal-error"),e}async onExecution(){Jh(this.filter.length===1,"Popup operations only handle one event");const e=X1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(nh(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(nh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qm.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if(!((a=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||a===void 0)&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nh(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,a3.get())};e()}}qm.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s3="pendingRedirect",Gv=new Map;class o3 extends FA{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=Gv.get(this.auth._key());if(!e){try{const a=await l3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}Gv.set(this.auth._key(),e)}return this.bypassAuthState||Gv.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function l3(r,e){const t=h3(e),a=c3(r);if(!await a._isAvailable())return!1;const d=await a._get(t)==="true";return await a._remove(t),d}function u3(r,e){Gv.set(r._key(),e)}function c3(r){return Gh(r._redirectPersistence)}function h3(r){return qv(s3,r.config.apiKey,r.name)}async function d3(r,e,t=!1){if(mu(r.app))return Promise.reject(Zh(r));const a=Gp(r),d=t3(a,e),y=await new o3(a,d,t).execute();return y&&!t&&(delete y.user._redirectEventId,await a._persistUserIfCurrent(y.user),await a._setRedirectUser(null,e)),y}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3=10*60*1e3;class p3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!m3(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!UA(e)){const d=((a=e.error.code)===null||a===void 0?void 0:a.split("auth/")[1])||"internal-error";t.onError(nh(this.auth,d))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=f3&&this.cachedEventUids.clear(),this.cachedEventUids.has(iT(e))}saveEventToCache(e){this.cachedEventUids.add(iT(e)),this.lastProcessedEventTime=Date.now()}}function iT(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function UA({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function m3(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return UA(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g3(r,e={}){return bf(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_3=/^https?/;async function v3(r){if(r.config.emulator)return;const{authorizedDomains:e}=await g3(r);for(const t of e)try{if(b3(t))return}catch{}fc(r,"unauthorized-domain")}function b3(r){const e=Rx(),{protocol:t,hostname:a}=new URL(e);if(r.startsWith("chrome-extension://")){const y=new URL(r);return y.hostname===""&&a===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&y.hostname===a}if(!_3.test(t))return!1;if(y3.test(r))return a===r;const d=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+d+"|"+d+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x3=new R_(3e4,6e4);function aT(){const r=rh().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function w3(r){return new Promise((e,t)=>{var a,d,m;function y(){aT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{aT(),t(nh(r,"network-request-failed"))},timeout:x3.get()})}if(!((d=(a=rh().gapi)===null||a===void 0?void 0:a.iframes)===null||d===void 0)&&d.Iframe)e(gapi.iframes.getContext());else if(!((m=rh().gapi)===null||m===void 0)&&m.load)y();else{const c=m5("iframefcb");return rh()[c]=()=>{gapi.load?y():t(nh(r,"network-request-failed"))},SA(`${p5()}?onload=${c}`).catch(P=>t(P))}}).catch(e=>{throw Hv=null,e})}let Hv=null;function T3(r){return Hv=Hv||w3(r),Hv}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=new R_(5e3,15e3),E3="__/auth/iframe",A3="emulator/auth/iframe",I3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},C3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function P3(r){const e=r.config;Cn(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?G1(e,A3):`https://${r.config.authDomain}/${E3}`,a={apiKey:e.apiKey,appName:r.name,v:pg},d=C3.get(r.config.apiHost);d&&(a.eid=d);const m=r._getFrameworks();return m.length&&(a.fw=m.join(",")),`${t}?${M_(a).slice(1)}`}async function M3(r){const e=await T3(r),t=rh().gapi;return Cn(t,r,"internal-error"),e.open({where:document.body,url:P3(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:I3,dontclear:!0},a=>new Promise(async(d,m)=>{await a.restyle({setHideOnLeave:!1});const y=nh(r,"network-request-failed"),c=rh().setTimeout(()=>{m(y)},S3.get());function P(){rh().clearTimeout(c),d(a)}a.ping(P).then(P,()=>{m(y)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},k3=500,D3=600,L3="_blank",z3="http://localhost";class sT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function O3(r,e,t,a=k3,d=D3){const m=Math.max((window.screen.availHeight-d)/2,0).toString(),y=Math.max((window.screen.availWidth-a)/2,0).toString();let c="";const P=Object.assign(Object.assign({},R3),{width:a.toString(),height:d.toString(),top:m,left:y}),k=no().toLowerCase();t&&(c=yA(k)?L3:t),mA(k)&&(e=e||z3,P.scrollbars="yes");const B=Object.entries(P).reduce((G,[W,ie])=>`${G}${W}=${ie},`,"");if(a5(k)&&c!=="_self")return N3(e||"",c),new sT(null);const X=window.open(e||"",c,B);Cn(X,r,"popup-blocked");try{X.focus()}catch{}return new sT(X)}function N3(r,e){const t=document.createElement("a");t.href=r,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3="__/auth/handler",V3="emulator/auth/handler",F3=encodeURIComponent("fac");async function oT(r,e,t,a,d,m){Cn(r.config.authDomain,r,"auth-domain-config-required"),Cn(r.config.apiKey,r,"invalid-api-key");const y={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:a,v:pg,eventId:d};if(e instanceof IA){e.setDefaultLanguage(r.languageCode),y.providerId=e.providerId||"",Ek(e.getCustomParameters())||(y.customParameters=JSON.stringify(e.getCustomParameters()));for(const[B,X]of Object.entries({}))y[B]=X}if(e instanceof D_){const B=e.getScopes().filter(X=>X!=="");B.length>0&&(y.scopes=B.join(","))}r.tenantId&&(y.tid=r.tenantId);const c=y;for(const B of Object.keys(c))c[B]===void 0&&delete c[B];const P=await r._getAppCheckToken(),k=P?`#${F3}=${encodeURIComponent(P)}`:"";return`${U3(r)}?${M_(c).slice(1)}${k}`}function U3({config:r}){return r.emulator?G1(r,V3):`https://${r.authDomain}/${B3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jb="webStorageSupport";class j3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zA,this._completeRedirectFn=d3,this._overrideRedirectResult=u3}async _openPopup(e,t,a,d){var m;Jh((m=this.eventManagers[e._key()])===null||m===void 0?void 0:m.manager,"_initialize() not called before _openPopup()");const y=await oT(e,t,a,Rx(),d);return O3(e,y,X1())}async _openRedirect(e,t,a,d){await this._originValidation(e);const m=await oT(e,t,a,Rx(),d);return G5(m),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:d,promise:m}=this.eventManagers[t];return d?Promise.resolve(d):(Jh(m,"If manager is not set, promise should be"),m)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await M3(e),a=new p3(e);return t.register("authEvent",d=>(Cn(d==null?void 0:d.authEvent,e,"invalid-auth-event"),{status:a.onEvent(d.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Jb,{type:Jb},d=>{var m;const y=(m=d==null?void 0:d[0])===null||m===void 0?void 0:m[Jb];y!==void 0&&t(!!y),fc(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=v3(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return wA()||gA()||Z1()}}const $3=j3;var lT="@firebase/auth",uT="1.10.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e((a==null?void 0:a.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Cn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G3(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function H3(r){ng(new Lp("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),d=e.getProvider("heartbeat"),m=e.getProvider("app-check-internal"),{apiKey:y,authDomain:c}=a.options;Cn(y&&!y.includes(":"),"invalid-api-key",{appName:a.name});const P={apiKey:y,authDomain:c,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:TA(r)},k=new h5(a,d,m,P);return x5(k,t),k},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),ng(new Lp("auth-internal",e=>{const t=Gp(e.getProvider("auth").getImmediate());return(a=>new q3(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),of(lT,uT,G3(r)),of(lT,uT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3=5*60,K3=QE("authIdTokenMaxAge")||Z3;let cT=null;const W3=r=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>K3)return;const d=t==null?void 0:t.token;cT!==d&&(cT=d,await fetch(r,{method:d?"POST":"DELETE",headers:d?{Authorization:`Bearer ${d}`}:{}}))};function X3(r=iA()){const e=j1(r,"auth");if(e.isInitialized())return e.getImmediate();const t=b5(r,{popupRedirectResolver:$3,persistence:[e3,j5,zA]}),a=QE("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const m=new URL(a,location.origin);if(location.origin===m.origin){const y=W3(m.toString());B5(t,y,()=>y(t.currentUser)),N5(t,c=>y(c))}}const d=XE("auth");return d&&w5(t,`http://${d}`),t}function Y3(){var r,e;return(e=(r=document.getElementsByTagName("head"))===null||r===void 0?void 0:r[0])!==null&&e!==void 0?e:document}d5({loadJS(r){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",r),a.onload=e,a.onerror=d=>{const m=nh("internal-error");m.customData=d,t(m)},a.type="text/javascript",a.charset="UTF-8",Y3().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});H3("Browser");var hT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var lf,jA;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(pe,oe){function me(){}me.prototype=oe.prototype,pe.D=oe.prototype,pe.prototype=new me,pe.prototype.constructor=pe,pe.C=function(be,Ce,Ve){for(var Ee=Array(arguments.length-2),Yn=2;Yn<arguments.length;Yn++)Ee[Yn-2]=arguments[Yn];return oe.prototype[Ce].apply(be,Ee)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function d(pe,oe,me){me||(me=0);var be=Array(16);if(typeof oe=="string")for(var Ce=0;16>Ce;++Ce)be[Ce]=oe.charCodeAt(me++)|oe.charCodeAt(me++)<<8|oe.charCodeAt(me++)<<16|oe.charCodeAt(me++)<<24;else for(Ce=0;16>Ce;++Ce)be[Ce]=oe[me++]|oe[me++]<<8|oe[me++]<<16|oe[me++]<<24;oe=pe.g[0],me=pe.g[1],Ce=pe.g[2];var Ve=pe.g[3],Ee=oe+(Ve^me&(Ce^Ve))+be[0]+3614090360&4294967295;oe=me+(Ee<<7&4294967295|Ee>>>25),Ee=Ve+(Ce^oe&(me^Ce))+be[1]+3905402710&4294967295,Ve=oe+(Ee<<12&4294967295|Ee>>>20),Ee=Ce+(me^Ve&(oe^me))+be[2]+606105819&4294967295,Ce=Ve+(Ee<<17&4294967295|Ee>>>15),Ee=me+(oe^Ce&(Ve^oe))+be[3]+3250441966&4294967295,me=Ce+(Ee<<22&4294967295|Ee>>>10),Ee=oe+(Ve^me&(Ce^Ve))+be[4]+4118548399&4294967295,oe=me+(Ee<<7&4294967295|Ee>>>25),Ee=Ve+(Ce^oe&(me^Ce))+be[5]+1200080426&4294967295,Ve=oe+(Ee<<12&4294967295|Ee>>>20),Ee=Ce+(me^Ve&(oe^me))+be[6]+2821735955&4294967295,Ce=Ve+(Ee<<17&4294967295|Ee>>>15),Ee=me+(oe^Ce&(Ve^oe))+be[7]+4249261313&4294967295,me=Ce+(Ee<<22&4294967295|Ee>>>10),Ee=oe+(Ve^me&(Ce^Ve))+be[8]+1770035416&4294967295,oe=me+(Ee<<7&4294967295|Ee>>>25),Ee=Ve+(Ce^oe&(me^Ce))+be[9]+2336552879&4294967295,Ve=oe+(Ee<<12&4294967295|Ee>>>20),Ee=Ce+(me^Ve&(oe^me))+be[10]+4294925233&4294967295,Ce=Ve+(Ee<<17&4294967295|Ee>>>15),Ee=me+(oe^Ce&(Ve^oe))+be[11]+2304563134&4294967295,me=Ce+(Ee<<22&4294967295|Ee>>>10),Ee=oe+(Ve^me&(Ce^Ve))+be[12]+1804603682&4294967295,oe=me+(Ee<<7&4294967295|Ee>>>25),Ee=Ve+(Ce^oe&(me^Ce))+be[13]+4254626195&4294967295,Ve=oe+(Ee<<12&4294967295|Ee>>>20),Ee=Ce+(me^Ve&(oe^me))+be[14]+2792965006&4294967295,Ce=Ve+(Ee<<17&4294967295|Ee>>>15),Ee=me+(oe^Ce&(Ve^oe))+be[15]+1236535329&4294967295,me=Ce+(Ee<<22&4294967295|Ee>>>10),Ee=oe+(Ce^Ve&(me^Ce))+be[1]+4129170786&4294967295,oe=me+(Ee<<5&4294967295|Ee>>>27),Ee=Ve+(me^Ce&(oe^me))+be[6]+3225465664&4294967295,Ve=oe+(Ee<<9&4294967295|Ee>>>23),Ee=Ce+(oe^me&(Ve^oe))+be[11]+643717713&4294967295,Ce=Ve+(Ee<<14&4294967295|Ee>>>18),Ee=me+(Ve^oe&(Ce^Ve))+be[0]+3921069994&4294967295,me=Ce+(Ee<<20&4294967295|Ee>>>12),Ee=oe+(Ce^Ve&(me^Ce))+be[5]+3593408605&4294967295,oe=me+(Ee<<5&4294967295|Ee>>>27),Ee=Ve+(me^Ce&(oe^me))+be[10]+38016083&4294967295,Ve=oe+(Ee<<9&4294967295|Ee>>>23),Ee=Ce+(oe^me&(Ve^oe))+be[15]+3634488961&4294967295,Ce=Ve+(Ee<<14&4294967295|Ee>>>18),Ee=me+(Ve^oe&(Ce^Ve))+be[4]+3889429448&4294967295,me=Ce+(Ee<<20&4294967295|Ee>>>12),Ee=oe+(Ce^Ve&(me^Ce))+be[9]+568446438&4294967295,oe=me+(Ee<<5&4294967295|Ee>>>27),Ee=Ve+(me^Ce&(oe^me))+be[14]+3275163606&4294967295,Ve=oe+(Ee<<9&4294967295|Ee>>>23),Ee=Ce+(oe^me&(Ve^oe))+be[3]+4107603335&4294967295,Ce=Ve+(Ee<<14&4294967295|Ee>>>18),Ee=me+(Ve^oe&(Ce^Ve))+be[8]+1163531501&4294967295,me=Ce+(Ee<<20&4294967295|Ee>>>12),Ee=oe+(Ce^Ve&(me^Ce))+be[13]+2850285829&4294967295,oe=me+(Ee<<5&4294967295|Ee>>>27),Ee=Ve+(me^Ce&(oe^me))+be[2]+4243563512&4294967295,Ve=oe+(Ee<<9&4294967295|Ee>>>23),Ee=Ce+(oe^me&(Ve^oe))+be[7]+1735328473&4294967295,Ce=Ve+(Ee<<14&4294967295|Ee>>>18),Ee=me+(Ve^oe&(Ce^Ve))+be[12]+2368359562&4294967295,me=Ce+(Ee<<20&4294967295|Ee>>>12),Ee=oe+(me^Ce^Ve)+be[5]+4294588738&4294967295,oe=me+(Ee<<4&4294967295|Ee>>>28),Ee=Ve+(oe^me^Ce)+be[8]+2272392833&4294967295,Ve=oe+(Ee<<11&4294967295|Ee>>>21),Ee=Ce+(Ve^oe^me)+be[11]+1839030562&4294967295,Ce=Ve+(Ee<<16&4294967295|Ee>>>16),Ee=me+(Ce^Ve^oe)+be[14]+4259657740&4294967295,me=Ce+(Ee<<23&4294967295|Ee>>>9),Ee=oe+(me^Ce^Ve)+be[1]+2763975236&4294967295,oe=me+(Ee<<4&4294967295|Ee>>>28),Ee=Ve+(oe^me^Ce)+be[4]+1272893353&4294967295,Ve=oe+(Ee<<11&4294967295|Ee>>>21),Ee=Ce+(Ve^oe^me)+be[7]+4139469664&4294967295,Ce=Ve+(Ee<<16&4294967295|Ee>>>16),Ee=me+(Ce^Ve^oe)+be[10]+3200236656&4294967295,me=Ce+(Ee<<23&4294967295|Ee>>>9),Ee=oe+(me^Ce^Ve)+be[13]+681279174&4294967295,oe=me+(Ee<<4&4294967295|Ee>>>28),Ee=Ve+(oe^me^Ce)+be[0]+3936430074&4294967295,Ve=oe+(Ee<<11&4294967295|Ee>>>21),Ee=Ce+(Ve^oe^me)+be[3]+3572445317&4294967295,Ce=Ve+(Ee<<16&4294967295|Ee>>>16),Ee=me+(Ce^Ve^oe)+be[6]+76029189&4294967295,me=Ce+(Ee<<23&4294967295|Ee>>>9),Ee=oe+(me^Ce^Ve)+be[9]+3654602809&4294967295,oe=me+(Ee<<4&4294967295|Ee>>>28),Ee=Ve+(oe^me^Ce)+be[12]+3873151461&4294967295,Ve=oe+(Ee<<11&4294967295|Ee>>>21),Ee=Ce+(Ve^oe^me)+be[15]+530742520&4294967295,Ce=Ve+(Ee<<16&4294967295|Ee>>>16),Ee=me+(Ce^Ve^oe)+be[2]+3299628645&4294967295,me=Ce+(Ee<<23&4294967295|Ee>>>9),Ee=oe+(Ce^(me|~Ve))+be[0]+4096336452&4294967295,oe=me+(Ee<<6&4294967295|Ee>>>26),Ee=Ve+(me^(oe|~Ce))+be[7]+1126891415&4294967295,Ve=oe+(Ee<<10&4294967295|Ee>>>22),Ee=Ce+(oe^(Ve|~me))+be[14]+2878612391&4294967295,Ce=Ve+(Ee<<15&4294967295|Ee>>>17),Ee=me+(Ve^(Ce|~oe))+be[5]+4237533241&4294967295,me=Ce+(Ee<<21&4294967295|Ee>>>11),Ee=oe+(Ce^(me|~Ve))+be[12]+1700485571&4294967295,oe=me+(Ee<<6&4294967295|Ee>>>26),Ee=Ve+(me^(oe|~Ce))+be[3]+2399980690&4294967295,Ve=oe+(Ee<<10&4294967295|Ee>>>22),Ee=Ce+(oe^(Ve|~me))+be[10]+4293915773&4294967295,Ce=Ve+(Ee<<15&4294967295|Ee>>>17),Ee=me+(Ve^(Ce|~oe))+be[1]+2240044497&4294967295,me=Ce+(Ee<<21&4294967295|Ee>>>11),Ee=oe+(Ce^(me|~Ve))+be[8]+1873313359&4294967295,oe=me+(Ee<<6&4294967295|Ee>>>26),Ee=Ve+(me^(oe|~Ce))+be[15]+4264355552&4294967295,Ve=oe+(Ee<<10&4294967295|Ee>>>22),Ee=Ce+(oe^(Ve|~me))+be[6]+2734768916&4294967295,Ce=Ve+(Ee<<15&4294967295|Ee>>>17),Ee=me+(Ve^(Ce|~oe))+be[13]+1309151649&4294967295,me=Ce+(Ee<<21&4294967295|Ee>>>11),Ee=oe+(Ce^(me|~Ve))+be[4]+4149444226&4294967295,oe=me+(Ee<<6&4294967295|Ee>>>26),Ee=Ve+(me^(oe|~Ce))+be[11]+3174756917&4294967295,Ve=oe+(Ee<<10&4294967295|Ee>>>22),Ee=Ce+(oe^(Ve|~me))+be[2]+718787259&4294967295,Ce=Ve+(Ee<<15&4294967295|Ee>>>17),Ee=me+(Ve^(Ce|~oe))+be[9]+3951481745&4294967295,pe.g[0]=pe.g[0]+oe&4294967295,pe.g[1]=pe.g[1]+(Ce+(Ee<<21&4294967295|Ee>>>11))&4294967295,pe.g[2]=pe.g[2]+Ce&4294967295,pe.g[3]=pe.g[3]+Ve&4294967295}a.prototype.u=function(pe,oe){oe===void 0&&(oe=pe.length);for(var me=oe-this.blockSize,be=this.B,Ce=this.h,Ve=0;Ve<oe;){if(Ce==0)for(;Ve<=me;)d(this,pe,Ve),Ve+=this.blockSize;if(typeof pe=="string"){for(;Ve<oe;)if(be[Ce++]=pe.charCodeAt(Ve++),Ce==this.blockSize){d(this,be),Ce=0;break}}else for(;Ve<oe;)if(be[Ce++]=pe[Ve++],Ce==this.blockSize){d(this,be),Ce=0;break}}this.h=Ce,this.o+=oe},a.prototype.v=function(){var pe=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);pe[0]=128;for(var oe=1;oe<pe.length-8;++oe)pe[oe]=0;var me=8*this.o;for(oe=pe.length-8;oe<pe.length;++oe)pe[oe]=me&255,me/=256;for(this.u(pe),pe=Array(16),oe=me=0;4>oe;++oe)for(var be=0;32>be;be+=8)pe[me++]=this.g[oe]>>>be&255;return pe};function m(pe,oe){var me=c;return Object.prototype.hasOwnProperty.call(me,pe)?me[pe]:me[pe]=oe(pe)}function y(pe,oe){this.h=oe;for(var me=[],be=!0,Ce=pe.length-1;0<=Ce;Ce--){var Ve=pe[Ce]|0;be&&Ve==oe||(me[Ce]=Ve,be=!1)}this.g=me}var c={};function P(pe){return-128<=pe&&128>pe?m(pe,function(oe){return new y([oe|0],0>oe?-1:0)}):new y([pe|0],0>pe?-1:0)}function k(pe){if(isNaN(pe)||!isFinite(pe))return X;if(0>pe)return Re(k(-pe));for(var oe=[],me=1,be=0;pe>=me;be++)oe[be]=pe/me|0,me*=4294967296;return new y(oe,0)}function B(pe,oe){if(pe.length==0)throw Error("number format error: empty string");if(oe=oe||10,2>oe||36<oe)throw Error("radix out of range: "+oe);if(pe.charAt(0)=="-")return Re(B(pe.substring(1),oe));if(0<=pe.indexOf("-"))throw Error('number format error: interior "-" character');for(var me=k(Math.pow(oe,8)),be=X,Ce=0;Ce<pe.length;Ce+=8){var Ve=Math.min(8,pe.length-Ce),Ee=parseInt(pe.substring(Ce,Ce+Ve),oe);8>Ve?(Ve=k(Math.pow(oe,Ve)),be=be.j(Ve).add(k(Ee))):(be=be.j(me),be=be.add(k(Ee)))}return be}var X=P(0),G=P(1),W=P(16777216);r=y.prototype,r.m=function(){if(Ie(this))return-Re(this).m();for(var pe=0,oe=1,me=0;me<this.g.length;me++){var be=this.i(me);pe+=(0<=be?be:4294967296+be)*oe,oe*=4294967296}return pe},r.toString=function(pe){if(pe=pe||10,2>pe||36<pe)throw Error("radix out of range: "+pe);if(ie(this))return"0";if(Ie(this))return"-"+Re(this).toString(pe);for(var oe=k(Math.pow(pe,6)),me=this,be="";;){var Ce=qe(me,oe).g;me=Oe(me,Ce.j(oe));var Ve=((0<me.g.length?me.g[0]:me.h)>>>0).toString(pe);if(me=Ce,ie(me))return Ve+be;for(;6>Ve.length;)Ve="0"+Ve;be=Ve+be}},r.i=function(pe){return 0>pe?0:pe<this.g.length?this.g[pe]:this.h};function ie(pe){if(pe.h!=0)return!1;for(var oe=0;oe<pe.g.length;oe++)if(pe.g[oe]!=0)return!1;return!0}function Ie(pe){return pe.h==-1}r.l=function(pe){return pe=Oe(this,pe),Ie(pe)?-1:ie(pe)?0:1};function Re(pe){for(var oe=pe.g.length,me=[],be=0;be<oe;be++)me[be]=~pe.g[be];return new y(me,~pe.h).add(G)}r.abs=function(){return Ie(this)?Re(this):this},r.add=function(pe){for(var oe=Math.max(this.g.length,pe.g.length),me=[],be=0,Ce=0;Ce<=oe;Ce++){var Ve=be+(this.i(Ce)&65535)+(pe.i(Ce)&65535),Ee=(Ve>>>16)+(this.i(Ce)>>>16)+(pe.i(Ce)>>>16);be=Ee>>>16,Ve&=65535,Ee&=65535,me[Ce]=Ee<<16|Ve}return new y(me,me[me.length-1]&-2147483648?-1:0)};function Oe(pe,oe){return pe.add(Re(oe))}r.j=function(pe){if(ie(this)||ie(pe))return X;if(Ie(this))return Ie(pe)?Re(this).j(Re(pe)):Re(Re(this).j(pe));if(Ie(pe))return Re(this.j(Re(pe)));if(0>this.l(W)&&0>pe.l(W))return k(this.m()*pe.m());for(var oe=this.g.length+pe.g.length,me=[],be=0;be<2*oe;be++)me[be]=0;for(be=0;be<this.g.length;be++)for(var Ce=0;Ce<pe.g.length;Ce++){var Ve=this.i(be)>>>16,Ee=this.i(be)&65535,Yn=pe.i(Ce)>>>16,jn=pe.i(Ce)&65535;me[2*be+2*Ce]+=Ee*jn,Ke(me,2*be+2*Ce),me[2*be+2*Ce+1]+=Ve*jn,Ke(me,2*be+2*Ce+1),me[2*be+2*Ce+1]+=Ee*Yn,Ke(me,2*be+2*Ce+1),me[2*be+2*Ce+2]+=Ve*Yn,Ke(me,2*be+2*Ce+2)}for(be=0;be<oe;be++)me[be]=me[2*be+1]<<16|me[2*be];for(be=oe;be<2*oe;be++)me[be]=0;return new y(me,0)};function Ke(pe,oe){for(;(pe[oe]&65535)!=pe[oe];)pe[oe+1]+=pe[oe]>>>16,pe[oe]&=65535,oe++}function mt(pe,oe){this.g=pe,this.h=oe}function qe(pe,oe){if(ie(oe))throw Error("division by zero");if(ie(pe))return new mt(X,X);if(Ie(pe))return oe=qe(Re(pe),oe),new mt(Re(oe.g),Re(oe.h));if(Ie(oe))return oe=qe(pe,Re(oe)),new mt(Re(oe.g),oe.h);if(30<pe.g.length){if(Ie(pe)||Ie(oe))throw Error("slowDivide_ only works with positive integers.");for(var me=G,be=oe;0>=be.l(pe);)me=Fe(me),be=Fe(be);var Ce=We(me,1),Ve=We(be,1);for(be=We(be,2),me=We(me,2);!ie(be);){var Ee=Ve.add(be);0>=Ee.l(pe)&&(Ce=Ce.add(me),Ve=Ee),be=We(be,1),me=We(me,1)}return oe=Oe(pe,Ce.j(oe)),new mt(Ce,oe)}for(Ce=X;0<=pe.l(oe);){for(me=Math.max(1,Math.floor(pe.m()/oe.m())),be=Math.ceil(Math.log(me)/Math.LN2),be=48>=be?1:Math.pow(2,be-48),Ve=k(me),Ee=Ve.j(oe);Ie(Ee)||0<Ee.l(pe);)me-=be,Ve=k(me),Ee=Ve.j(oe);ie(Ve)&&(Ve=G),Ce=Ce.add(Ve),pe=Oe(pe,Ee)}return new mt(Ce,pe)}r.A=function(pe){return qe(this,pe).h},r.and=function(pe){for(var oe=Math.max(this.g.length,pe.g.length),me=[],be=0;be<oe;be++)me[be]=this.i(be)&pe.i(be);return new y(me,this.h&pe.h)},r.or=function(pe){for(var oe=Math.max(this.g.length,pe.g.length),me=[],be=0;be<oe;be++)me[be]=this.i(be)|pe.i(be);return new y(me,this.h|pe.h)},r.xor=function(pe){for(var oe=Math.max(this.g.length,pe.g.length),me=[],be=0;be<oe;be++)me[be]=this.i(be)^pe.i(be);return new y(me,this.h^pe.h)};function Fe(pe){for(var oe=pe.g.length+1,me=[],be=0;be<oe;be++)me[be]=pe.i(be)<<1|pe.i(be-1)>>>31;return new y(me,pe.h)}function We(pe,oe){var me=oe>>5;oe%=32;for(var be=pe.g.length-me,Ce=[],Ve=0;Ve<be;Ve++)Ce[Ve]=0<oe?pe.i(Ve+me)>>>oe|pe.i(Ve+me+1)<<32-oe:pe.i(Ve+me);return new y(Ce,pe.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,jA=a,y.prototype.add=y.prototype.add,y.prototype.multiply=y.prototype.j,y.prototype.modulo=y.prototype.A,y.prototype.compare=y.prototype.l,y.prototype.toNumber=y.prototype.m,y.prototype.toString=y.prototype.toString,y.prototype.getBits=y.prototype.i,y.fromNumber=k,y.fromString=B,lf=y}).apply(typeof hT<"u"?hT:typeof self<"u"?self:typeof window<"u"?window:{});var Cv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $A,By,qA,Zv,zx,GA,HA,ZA;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(A,F,Z){return A==Array.prototype||A==Object.prototype||(A[F]=Z.value),A};function t(A){A=[typeof globalThis=="object"&&globalThis,A,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cv=="object"&&Cv];for(var F=0;F<A.length;++F){var Z=A[F];if(Z&&Z.Math==Math)return Z}throw Error("Cannot find global object")}var a=t(this);function d(A,F){if(F)e:{var Z=a;A=A.split(".");for(var ce=0;ce<A.length-1;ce++){var Qe=A[ce];if(!(Qe in Z))break e;Z=Z[Qe]}A=A[A.length-1],ce=Z[A],F=F(ce),F!=ce&&F!=null&&e(Z,A,{configurable:!0,writable:!0,value:F})}}function m(A,F){A instanceof String&&(A+="");var Z=0,ce=!1,Qe={next:function(){if(!ce&&Z<A.length){var dt=Z++;return{value:F(dt,A[dt]),done:!1}}return ce=!0,{done:!0,value:void 0}}};return Qe[Symbol.iterator]=function(){return Qe},Qe}d("Array.prototype.values",function(A){return A||function(){return m(this,function(F,Z){return Z})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var y=y||{},c=this||self;function P(A){var F=typeof A;return F=F!="object"?F:A?Array.isArray(A)?"array":F:"null",F=="array"||F=="object"&&typeof A.length=="number"}function k(A){var F=typeof A;return F=="object"&&A!=null||F=="function"}function B(A,F,Z){return A.call.apply(A.bind,arguments)}function X(A,F,Z){if(!A)throw Error();if(2<arguments.length){var ce=Array.prototype.slice.call(arguments,2);return function(){var Qe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Qe,ce),A.apply(F,Qe)}}return function(){return A.apply(F,arguments)}}function G(A,F,Z){return G=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?B:X,G.apply(null,arguments)}function W(A,F){var Z=Array.prototype.slice.call(arguments,1);return function(){var ce=Z.slice();return ce.push.apply(ce,arguments),A.apply(this,ce)}}function ie(A,F){function Z(){}Z.prototype=F.prototype,A.aa=F.prototype,A.prototype=new Z,A.prototype.constructor=A,A.Qb=function(ce,Qe,dt){for(var Nt=Array(arguments.length-2),$n=2;$n<arguments.length;$n++)Nt[$n-2]=arguments[$n];return F.prototype[Qe].apply(ce,Nt)}}function Ie(A){const F=A.length;if(0<F){const Z=Array(F);for(let ce=0;ce<F;ce++)Z[ce]=A[ce];return Z}return[]}function Re(A,F){for(let Z=1;Z<arguments.length;Z++){const ce=arguments[Z];if(P(ce)){const Qe=A.length||0,dt=ce.length||0;A.length=Qe+dt;for(let Nt=0;Nt<dt;Nt++)A[Qe+Nt]=ce[Nt]}else A.push(ce)}}class Oe{constructor(F,Z){this.i=F,this.j=Z,this.h=0,this.g=null}get(){let F;return 0<this.h?(this.h--,F=this.g,this.g=F.next,F.next=null):F=this.i(),F}}function Ke(A){return/^[\s\xa0]*$/.test(A)}function mt(){var A=c.navigator;return A&&(A=A.userAgent)?A:""}function qe(A){return qe[" "](A),A}qe[" "]=function(){};var Fe=mt().indexOf("Gecko")!=-1&&!(mt().toLowerCase().indexOf("webkit")!=-1&&mt().indexOf("Edge")==-1)&&!(mt().indexOf("Trident")!=-1||mt().indexOf("MSIE")!=-1)&&mt().indexOf("Edge")==-1;function We(A,F,Z){for(const ce in A)F.call(Z,A[ce],ce,A)}function pe(A,F){for(const Z in A)F.call(void 0,A[Z],Z,A)}function oe(A){const F={};for(const Z in A)F[Z]=A[Z];return F}const me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function be(A,F){let Z,ce;for(let Qe=1;Qe<arguments.length;Qe++){ce=arguments[Qe];for(Z in ce)A[Z]=ce[Z];for(let dt=0;dt<me.length;dt++)Z=me[dt],Object.prototype.hasOwnProperty.call(ce,Z)&&(A[Z]=ce[Z])}}function Ce(A){var F=1;A=A.split(":");const Z=[];for(;0<F&&A.length;)Z.push(A.shift()),F--;return A.length&&Z.push(A.join(":")),Z}function Ve(A){c.setTimeout(()=>{throw A},0)}function Ee(){var A=Kn;let F=null;return A.g&&(F=A.g,A.g=A.g.next,A.g||(A.h=null),F.next=null),F}class Yn{constructor(){this.h=this.g=null}add(F,Z){const ce=jn.get();ce.set(F,Z),this.h?this.h.next=ce:this.g=ce,this.h=ce}}var jn=new Oe(()=>new gt,A=>A.reset());class gt{constructor(){this.next=this.g=this.h=null}set(F,Z){this.h=F,this.g=Z,this.next=null}reset(){this.next=this.g=this.h=null}}let Bt,nn=!1,Kn=new Yn,ze=()=>{const A=c.Promise.resolve(void 0);Bt=()=>{A.then(xt)}};var xt=()=>{for(var A;A=Ee();){try{A.h.call(A.g)}catch(Z){Ve(Z)}var F=jn;F.j(A),100>F.h&&(F.h++,A.next=F.g,F.g=A)}nn=!1};function It(){this.s=this.s,this.C=this.C}It.prototype.s=!1,It.prototype.ma=function(){this.s||(this.s=!0,this.N())},It.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Rt(A,F){this.type=A,this.g=this.target=F,this.defaultPrevented=!1}Rt.prototype.h=function(){this.defaultPrevented=!0};var Yt=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var A=!1,F=Object.defineProperty({},"passive",{get:function(){A=!0}});try{const Z=()=>{};c.addEventListener("test",Z,F),c.removeEventListener("test",Z,F)}catch{}return A}();function wn(A,F){if(Rt.call(this,A?A.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,A){var Z=this.type=A.type,ce=A.changedTouches&&A.changedTouches.length?A.changedTouches[0]:null;if(this.target=A.target||A.srcElement,this.g=F,F=A.relatedTarget){if(Fe){e:{try{qe(F.nodeName);var Qe=!0;break e}catch{}Qe=!1}Qe||(F=null)}}else Z=="mouseover"?F=A.fromElement:Z=="mouseout"&&(F=A.toElement);this.relatedTarget=F,ce?(this.clientX=ce.clientX!==void 0?ce.clientX:ce.pageX,this.clientY=ce.clientY!==void 0?ce.clientY:ce.pageY,this.screenX=ce.screenX||0,this.screenY=ce.screenY||0):(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0),this.button=A.button,this.key=A.key||"",this.ctrlKey=A.ctrlKey,this.altKey=A.altKey,this.shiftKey=A.shiftKey,this.metaKey=A.metaKey,this.pointerId=A.pointerId||0,this.pointerType=typeof A.pointerType=="string"?A.pointerType:fn[A.pointerType]||"",this.state=A.state,this.i=A,A.defaultPrevented&&wn.aa.h.call(this)}}ie(wn,Rt);var fn={2:"touch",3:"pen",4:"mouse"};wn.prototype.h=function(){wn.aa.h.call(this);var A=this.i;A.preventDefault?A.preventDefault():A.returnValue=!1};var ii="closure_listenable_"+(1e6*Math.random()|0),wr=0;function Ir(A,F,Z,ce,Qe){this.listener=A,this.proxy=null,this.src=F,this.type=Z,this.capture=!!ce,this.ha=Qe,this.key=++wr,this.da=this.fa=!1}function ks(A){A.da=!0,A.listener=null,A.proxy=null,A.src=null,A.ha=null}function gi(A){this.src=A,this.g={},this.h=0}gi.prototype.add=function(A,F,Z,ce,Qe){var dt=A.toString();A=this.g[dt],A||(A=this.g[dt]=[],this.h++);var Nt=Tr(A,F,ce,Qe);return-1<Nt?(F=A[Nt],Z||(F.fa=!1)):(F=new Ir(F,this.src,dt,!!ce,Qe),F.fa=Z,A.push(F)),F};function io(A,F){var Z=F.type;if(Z in A.g){var ce=A.g[Z],Qe=Array.prototype.indexOf.call(ce,F,void 0),dt;(dt=0<=Qe)&&Array.prototype.splice.call(ce,Qe,1),dt&&(ks(F),A.g[Z].length==0&&(delete A.g[Z],A.h--))}}function Tr(A,F,Z,ce){for(var Qe=0;Qe<A.length;++Qe){var dt=A[Qe];if(!dt.da&&dt.listener==F&&dt.capture==!!Z&&dt.ha==ce)return Qe}return-1}var ya="closure_lm_"+(1e6*Math.random()|0),_a={};function nl(A,F,Z,ce,Qe){if(Array.isArray(F)){for(var dt=0;dt<F.length;dt++)nl(A,F[dt],Z,ce,Qe);return null}return Z=Ro(Z),A&&A[ii]?A.K(F,Z,k(ce)?!!ce.capture:!1,Qe):Cr(A,F,Z,!1,ce,Qe)}function Cr(A,F,Z,ce,Qe,dt){if(!F)throw Error("Invalid event type");var Nt=k(Qe)?!!Qe.capture:!!Qe,$n=Ls(A);if($n||(A[ya]=$n=new gi(A)),Z=$n.add(F,Z,ce,Nt,dt),Z.proxy)return Z;if(ce=za(),Z.proxy=ce,ce.src=A,ce.listener=Z,A.addEventListener)Yt||(Qe=Nt),Qe===void 0&&(Qe=!1),A.addEventListener(F.toString(),ce,Qe);else if(A.attachEvent)A.attachEvent(Wa(F.toString()),ce);else if(A.addListener&&A.removeListener)A.addListener(ce);else throw Error("addEventListener and attachEvent are unavailable.");return Z}function za(){function A(Z){return F.call(A.src,A.listener,Z)}const F=_u;return A}function na(A,F,Z,ce,Qe){if(Array.isArray(F))for(var dt=0;dt<F.length;dt++)na(A,F[dt],Z,ce,Qe);else ce=k(ce)?!!ce.capture:!!ce,Z=Ro(Z),A&&A[ii]?(A=A.i,F=String(F).toString(),F in A.g&&(dt=A.g[F],Z=Tr(dt,Z,ce,Qe),-1<Z&&(ks(dt[Z]),Array.prototype.splice.call(dt,Z,1),dt.length==0&&(delete A.g[F],A.h--)))):A&&(A=Ls(A))&&(F=A.g[F.toString()],A=-1,F&&(A=Tr(F,Z,ce,Qe)),(Z=-1<A?F[A]:null)&&Ds(Z))}function Ds(A){if(typeof A!="number"&&A&&!A.da){var F=A.src;if(F&&F[ii])io(F.i,A);else{var Z=A.type,ce=A.proxy;F.removeEventListener?F.removeEventListener(Z,ce,A.capture):F.detachEvent?F.detachEvent(Wa(Z),ce):F.addListener&&F.removeListener&&F.removeListener(ce),(Z=Ls(F))?(io(Z,A),Z.h==0&&(Z.src=null,F[ya]=null)):ks(A)}}}function Wa(A){return A in _a?_a[A]:_a[A]="on"+A}function _u(A,F){if(A.da)A=!0;else{F=new wn(F,this);var Z=A.listener,ce=A.ha||A.src;A.fa&&Ds(A),A=Z.call(ce,F)}return A}function Ls(A){return A=A[ya],A instanceof gi?A:null}var os="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ro(A){return typeof A=="function"?A:(A[os]||(A[os]=function(F){return A.handleEvent(F)}),A[os])}function fr(){It.call(this),this.i=new gi(this),this.M=this,this.F=null}ie(fr,It),fr.prototype[ii]=!0,fr.prototype.removeEventListener=function(A,F,Z,ce){na(this,A,F,Z,ce)};function zn(A,F){var Z,ce=A.F;if(ce)for(Z=[];ce;ce=ce.F)Z.push(ce);if(A=A.M,ce=F.type||F,typeof F=="string")F=new Rt(F,A);else if(F instanceof Rt)F.target=F.target||A;else{var Qe=F;F=new Rt(ce,A),be(F,Qe)}if(Qe=!0,Z)for(var dt=Z.length-1;0<=dt;dt--){var Nt=F.g=Z[dt];Qe=di(Nt,ce,!0,F)&&Qe}if(Nt=F.g=A,Qe=di(Nt,ce,!0,F)&&Qe,Qe=di(Nt,ce,!1,F)&&Qe,Z)for(dt=0;dt<Z.length;dt++)Nt=F.g=Z[dt],Qe=di(Nt,ce,!1,F)&&Qe}fr.prototype.N=function(){if(fr.aa.N.call(this),this.i){var A=this.i,F;for(F in A.g){for(var Z=A.g[F],ce=0;ce<Z.length;ce++)ks(Z[ce]);delete A.g[F],A.h--}}this.F=null},fr.prototype.K=function(A,F,Z,ce){return this.i.add(String(A),F,!1,Z,ce)},fr.prototype.L=function(A,F,Z,ce){return this.i.add(String(A),F,!0,Z,ce)};function di(A,F,Z,ce){if(F=A.i.g[String(F)],!F)return!0;F=F.concat();for(var Qe=!0,dt=0;dt<F.length;++dt){var Nt=F[dt];if(Nt&&!Nt.da&&Nt.capture==Z){var $n=Nt.listener,Ni=Nt.ha||Nt.src;Nt.fa&&io(A.i,Nt),Qe=$n.call(Ni,ce)!==!1&&Qe}}return Qe&&!ce.defaultPrevented}function Ri(A,F,Z){if(typeof A=="function")Z&&(A=G(A,Z));else if(A&&typeof A.handleEvent=="function")A=G(A.handleEvent,A);else throw Error("Invalid listener argument");return 2147483647<Number(F)?-1:c.setTimeout(A,F||0)}function vu(A){A.g=Ri(()=>{A.g=null,A.i&&(A.i=!1,vu(A))},A.l);const F=A.h;A.h=null,A.m.apply(null,F)}class ao extends It{constructor(F,Z){super(),this.m=F,this.l=Z,this.h=null,this.i=!1,this.g=null}j(F){this.h=arguments,this.g?this.i=!0:vu(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $e(A){It.call(this),this.h=A,this.g={}}ie($e,It);var ne=[];function re(A){We(A.g,function(F,Z){this.g.hasOwnProperty(Z)&&Ds(F)},A),A.g={}}$e.prototype.N=function(){$e.aa.N.call(this),re(this)},$e.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ue=c.JSON.stringify,xe=c.JSON.parse,De=class{stringify(A){return c.JSON.stringify(A,void 0)}parse(A){return c.JSON.parse(A,void 0)}};function je(){}je.prototype.h=null;function Je(A){return A.h||(A.h=A.i())}function Be(){}var lt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function it(){Rt.call(this,"d")}ie(it,Rt);function Ge(){Rt.call(this,"c")}ie(Ge,Rt);var ft={},ke=null;function Lt(){return ke=ke||new fr}ft.La="serverreachability";function rn(A){Rt.call(this,ft.La,A)}ie(rn,Rt);function Vt(A){const F=Lt();zn(F,new rn(F))}ft.STAT_EVENT="statevent";function Kt(A,F){Rt.call(this,ft.STAT_EVENT,A),this.stat=F}ie(Kt,Rt);function Ht(A){const F=Lt();zn(F,new Kt(F,A))}ft.Ma="timingevent";function Tn(A,F){Rt.call(this,ft.Ma,A),this.size=F}ie(Tn,Rt);function gn(A,F){if(typeof A!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){A()},F)}function Sn(){this.g=!0}Sn.prototype.xa=function(){this.g=!1};function on(A,F,Z,ce,Qe,dt){A.info(function(){if(A.g)if(dt)for(var Nt="",$n=dt.split("&"),Ni=0;Ni<$n.length;Ni++){var qn=$n[Ni].split("=");if(1<qn.length){var Zi=qn[0];qn=qn[1];var ei=Zi.split("_");Nt=2<=ei.length&&ei[1]=="type"?Nt+(Zi+"="+qn+"&"):Nt+(Zi+"=redacted&")}}else Nt=null;else Nt=dt;return"XMLHTTP REQ ("+ce+") [attempt "+Qe+"]: "+F+`
`+Z+`
`+Nt})}function Bn(A,F,Z,ce,Qe,dt,Nt){A.info(function(){return"XMLHTTP RESP ("+ce+") [ attempt "+Qe+"]: "+F+`
`+Z+`
`+dt+" "+Nt})}function Wr(A,F,Z,ce){A.info(function(){return"XMLHTTP TEXT ("+F+"): "+ai(A,Z)+(ce?" "+ce:"")})}function Pt(A,F){A.info(function(){return"TIMEOUT: "+F})}Sn.prototype.info=function(){};function ai(A,F){if(!A.g)return F;if(!F)return null;try{var Z=JSON.parse(F);if(Z){for(A=0;A<Z.length;A++)if(Array.isArray(Z[A])){var ce=Z[A];if(!(2>ce.length)){var Qe=ce[1];if(Array.isArray(Qe)&&!(1>Qe.length)){var dt=Qe[0];if(dt!="noop"&&dt!="stop"&&dt!="close")for(var Nt=1;Nt<Qe.length;Nt++)Qe[Nt]=""}}}}return ue(Z)}catch{return F}}var cr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},va={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ba;function Mt(){}ie(Mt,je),Mt.prototype.g=function(){return new XMLHttpRequest},Mt.prototype.i=function(){return{}},ba=new Mt;function ln(A,F,Z,ce){this.j=A,this.i=F,this.l=Z,this.R=ce||1,this.U=new $e(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qt}function Qt(){this.i=null,this.g="",this.h=!1}var ha={},rl={};function ki(A,F,Z){A.L=1,A.v=Oo(Xa(F)),A.m=Z,A.P=!0,pn(A,null)}function pn(A,F){A.F=Date.now(),kr(A),A.A=Xa(A.v);var Z=A.A,ce=A.R;Array.isArray(ce)||(ce=[String(ce)]),Ol(Z.i,"t",ce),A.C=0,Z=A.j.J,A.h=new Qt,A.g=ud(A.j,Z?F:null,!A.m),0<A.O&&(A.M=new ao(G(A.Y,A,A.g),A.O)),F=A.U,Z=A.g,ce=A.ca;var Qe="readystatechange";Array.isArray(Qe)||(Qe&&(ne[0]=Qe.toString()),Qe=ne);for(var dt=0;dt<Qe.length;dt++){var Nt=nl(Z,Qe[dt],ce||F.handleEvent,!1,F.h||F);if(!Nt)break;F.g[Nt.key]=Nt}F=A.H?oe(A.H):{},A.m?(A.u||(A.u="POST"),F["Content-Type"]="application/x-www-form-urlencoded",A.g.ea(A.A,A.u,A.m,F)):(A.u="GET",A.g.ea(A.A,A.u,null,F)),Vt(),on(A.i,A.u,A.A,A.l,A.R,A.m)}ln.prototype.ca=function(A){A=A.target;const F=this.M;F&&Sa(A)==3?F.j():this.Y(A)},ln.prototype.Y=function(A){try{if(A==this.g)e:{const ei=Sa(this.g);var F=this.g.Ba();const ll=this.g.Z();if(!(3>ei)&&(ei!=3||this.g&&(this.h.h||this.g.oa()||Ya(this.g)))){this.J||ei!=4||F==7||(F==8||0>=ll?Vt(3):Vt(2)),Os(this);var Z=this.g.Z();this.X=Z;t:if(zs(this)){var ce=Ya(this.g);A="";var Qe=ce.length,dt=Sa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yi(this),ra(this);var Nt="";break t}this.h.i=new c.TextDecoder}for(F=0;F<Qe;F++)this.h.h=!0,A+=this.h.i.decode(ce[F],{stream:!(dt&&F==Qe-1)});ce.length=0,this.h.g+=A,this.C=0,Nt=this.h.g}else Nt=this.g.oa();if(this.o=Z==200,Bn(this.i,this.u,this.A,this.l,this.R,ei,Z),this.o){if(this.T&&!this.K){t:{if(this.g){var $n,Ni=this.g;if(($n=Ni.g?Ni.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ke($n)){var qn=$n;break t}}qn=null}if(Z=qn)Wr(this.i,this.l,Z,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gi(this,Z);else{this.o=!1,this.s=3,Ht(12),yi(this),ra(this);break e}}if(this.P){Z=!0;let sa;for(;!this.J&&this.C<Nt.length;)if(sa=ko(this,Nt),sa==rl){ei==4&&(this.s=4,Ht(14),Z=!1),Wr(this.i,this.l,null,"[Incomplete Response]");break}else if(sa==ha){this.s=4,Ht(15),Wr(this.i,this.l,Nt,"[Invalid Chunk]"),Z=!1;break}else Wr(this.i,this.l,sa,null),Gi(this,sa);if(zs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ei!=4||Nt.length!=0||this.h.h||(this.s=1,Ht(16),Z=!1),this.o=this.o&&Z,!Z)Wr(this.i,this.l,Nt,"[Invalid Chunked Response]"),yi(this),ra(this);else if(0<Nt.length&&!this.W){this.W=!0;var Zi=this.j;Zi.g==this&&Zi.ba&&!Zi.M&&(Zi.j.info("Great, no buffering proxy detected. Bytes received: "+Nt.length),_i(Zi),Zi.M=!0,Ht(11))}}else Wr(this.i,this.l,Nt,null),Gi(this,Nt);ei==4&&yi(this),this.o&&!this.J&&(ei==4?da(this.j,this):(this.o=!1,kr(this)))}else Oi(this.g),Z==400&&0<Nt.indexOf("Unknown SID")?(this.s=3,Ht(12)):(this.s=0,Ht(13)),yi(this),ra(this)}}}catch{}finally{}};function zs(A){return A.g?A.u=="GET"&&A.L!=2&&A.j.Ca:!1}function ko(A,F){var Z=A.C,ce=F.indexOf(`
`,Z);return ce==-1?rl:(Z=Number(F.substring(Z,ce)),isNaN(Z)?ha:(ce+=1,ce+Z>F.length?rl:(F=F.slice(ce,ce+Z),A.C=ce+Z,F)))}ln.prototype.cancel=function(){this.J=!0,yi(this)};function kr(A){A.S=Date.now()+A.I,Dl(A,A.I)}function Dl(A,F){if(A.B!=null)throw Error("WatchDog timer not null");A.B=gn(G(A.ba,A),F)}function Os(A){A.B&&(c.clearTimeout(A.B),A.B=null)}ln.prototype.ba=function(){this.B=null;const A=Date.now();0<=A-this.S?(Pt(this.i,this.A),this.L!=2&&(Vt(),Ht(17)),yi(this),this.s=2,ra(this)):Dl(this,this.S-A)};function ra(A){A.j.G==0||A.J||da(A.j,A)}function yi(A){Os(A);var F=A.M;F&&typeof F.ma=="function"&&F.ma(),A.M=null,re(A.U),A.g&&(F=A.g,A.g=null,F.abort(),F.ma())}function Gi(A,F){try{var Z=A.j;if(Z.G!=0&&(Z.g==A||so(Z.h,A))){if(!A.K&&so(Z.h,A)&&Z.G==3){try{var ce=Z.Da.g.parse(F)}catch{ce=null}if(Array.isArray(ce)&&ce.length==3){var Qe=ce;if(Qe[0]==0){e:if(!Z.u){if(Z.g)if(Z.g.F+3e3<A.F)aa(Z),Xr(Z);else break e;ph(Z),Ht(18)}}else Z.za=Qe[1],0<Z.za-Z.T&&37500>Qe[2]&&Z.F&&Z.v==0&&!Z.C&&(Z.C=gn(G(Z.Za,Z),6e3));if(1>=il(Z.h)&&Z.ca){try{Z.ca()}catch{}Z.ca=void 0}}else fs(Z,11)}else if((A.K||Z.g==A)&&aa(Z),!Ke(F))for(Qe=Z.Da.g.parse(F),F=0;F<Qe.length;F++){let qn=Qe[F];if(Z.T=qn[0],qn=qn[1],Z.G==2)if(qn[0]=="c"){Z.K=qn[1],Z.ia=qn[2];const Zi=qn[3];Zi!=null&&(Z.la=Zi,Z.j.info("VER="+Z.la));const ei=qn[4];ei!=null&&(Z.Aa=ei,Z.j.info("SVER="+Z.Aa));const ll=qn[5];ll!=null&&typeof ll=="number"&&0<ll&&(ce=1.5*ll,Z.L=ce,Z.j.info("backChannelRequestTimeoutMs_="+ce)),ce=Z;const sa=A.g;if(sa){const Vo=sa.g?sa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vo){var dt=ce.h;dt.g||Vo.indexOf("spdy")==-1&&Vo.indexOf("quic")==-1&&Vo.indexOf("h2")==-1||(dt.j=dt.l,dt.g=new Set,dt.h&&(ls(dt,dt.h),dt.h=null))}if(ce.D){const Fl=sa.g?sa.g.getResponseHeader("X-HTTP-Session-Id"):null;Fl&&(ce.ya=Fl,Sr(ce.I,ce.D,Fl))}}Z.G=3,Z.l&&Z.l.ua(),Z.ba&&(Z.R=Date.now()-A.F,Z.j.info("Handshake RTT: "+Z.R+"ms")),ce=Z;var Nt=A;if(ce.qa=wc(ce,ce.J?ce.ia:null,ce.W),Nt.K){xa(ce.h,Nt);var $n=Nt,Ni=ce.L;Ni&&($n.I=Ni),$n.B&&(Os($n),kr($n)),ce.g=Nt}else xc(ce);0<Z.i.length&&fo(Z)}else qn[0]!="stop"&&qn[0]!="close"||fs(Z,7);else Z.G==3&&(qn[0]=="stop"||qn[0]=="close"?qn[0]=="stop"?fs(Z,7):Bo(Z):qn[0]!="noop"&&Z.l&&Z.l.ta(qn),Z.v=0)}}Vt(4)}catch{}}var Dr=class{constructor(A,F){this.g=A,this.map=F}};function Do(A){this.l=A||10,c.PerformanceNavigationTiming?(A=c.performance.getEntriesByType("navigation"),A=0<A.length&&(A[0].nextHopProtocol=="hq"||A[0].nextHopProtocol=="h2")):A=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=A?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Lo(A){return A.h?!0:A.g?A.g.size>=A.j:!1}function il(A){return A.h?1:A.g?A.g.size:0}function so(A,F){return A.h?A.h==F:A.g?A.g.has(F):!1}function ls(A,F){A.g?A.g.add(F):A.h=F}function xa(A,F){A.h&&A.h==F?A.h=null:A.g&&A.g.has(F)&&A.g.delete(F)}Do.prototype.cancel=function(){if(this.i=_c(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const A of this.g.values())A.cancel();this.g.clear()}};function _c(A){if(A.h!=null)return A.i.concat(A.h.D);if(A.g!=null&&A.g.size!==0){let F=A.i;for(const Z of A.g.values())F=F.concat(Z.D);return F}return Ie(A.i)}function ld(A){if(A.V&&typeof A.V=="function")return A.V();if(typeof Map<"u"&&A instanceof Map||typeof Set<"u"&&A instanceof Set)return Array.from(A.values());if(typeof A=="string")return A.split("");if(P(A)){for(var F=[],Z=A.length,ce=0;ce<Z;ce++)F.push(A[ce]);return F}F=[],Z=0;for(ce in A)F[Z++]=A[ce];return F}function oo(A){if(A.na&&typeof A.na=="function")return A.na();if(!A.V||typeof A.V!="function"){if(typeof Map<"u"&&A instanceof Map)return Array.from(A.keys());if(!(typeof Set<"u"&&A instanceof Set)){if(P(A)||typeof A=="string"){var F=[];A=A.length;for(var Z=0;Z<A;Z++)F.push(Z);return F}F=[],Z=0;for(const ce in A)F[Z++]=ce;return F}}}function vc(A,F){if(A.forEach&&typeof A.forEach=="function")A.forEach(F,void 0);else if(P(A)||typeof A=="string")Array.prototype.forEach.call(A,F,void 0);else for(var Z=oo(A),ce=ld(A),Qe=ce.length,dt=0;dt<Qe;dt++)F.call(void 0,ce[dt],Z&&Z[dt],A)}var Ll=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bu(A,F){if(A){A=A.split("&");for(var Z=0;Z<A.length;Z++){var ce=A[Z].indexOf("="),Qe=null;if(0<=ce){var dt=A[Z].substring(0,ce);Qe=A[Z].substring(ce+1)}else dt=A[Z];F(dt,Qe?decodeURIComponent(Qe.replace(/\+/g," ")):"")}}}function Di(A){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,A instanceof Di){this.h=A.h,Ns(this,A.j),this.o=A.o,this.g=A.g,zo(this,A.s),this.l=A.l;var F=A.i,Z=new Li;Z.i=F.i,F.g&&(Z.g=new Map(F.g),Z.h=F.h),lo(this,Z),this.m=A.m}else A&&(F=String(A).match(Ll))?(this.h=!1,Ns(this,F[1]||"",!0),this.o=Oa(F[2]||""),this.g=Oa(F[3]||"",!0),zo(this,F[4]),this.l=Oa(F[5]||"",!0),lo(this,F[6]||"",!0),this.m=Oa(F[7]||"")):(this.h=!1,this.i=new Li(null,this.h))}Di.prototype.toString=function(){var A=[],F=this.j;F&&A.push(wa(F,us,!0),":");var Z=this.g;return(Z||F=="file")&&(A.push("//"),(F=this.o)&&A.push(wa(F,us,!0),"@"),A.push(encodeURIComponent(String(Z)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),Z=this.s,Z!=null&&A.push(":",String(Z))),(Z=this.l)&&(this.g&&Z.charAt(0)!="/"&&A.push("/"),A.push(wa(Z,Z.charAt(0)=="/"?al:cs,!0))),(Z=this.i.toString())&&A.push("?",Z),(Z=this.m)&&A.push("#",wa(Z,zl)),A.join("")};function Xa(A){return new Di(A)}function Ns(A,F,Z){A.j=Z?Oa(F,!0):F,A.j&&(A.j=A.j.replace(/:$/,""))}function zo(A,F){if(F){if(F=Number(F),isNaN(F)||0>F)throw Error("Bad port number "+F);A.s=F}else A.s=null}function lo(A,F,Z){F instanceof Li?(A.i=F,Hi(A.i,A.h)):(Z||(F=wa(F,dh)),A.i=new Li(F,A.h))}function Sr(A,F,Z){A.i.set(F,Z)}function Oo(A){return Sr(A,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),A}function Oa(A,F){return A?F?decodeURI(A.replace(/%25/g,"%2525")):decodeURIComponent(A):""}function wa(A,F,Z){return typeof A=="string"?(A=encodeURI(A).replace(F,Rn),Z&&(A=A.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A):null}function Rn(A){return A=A.charCodeAt(0),"%"+(A>>4&15).toString(16)+(A&15).toString(16)}var us=/[#\/\?@]/g,cs=/[#\?:]/g,al=/[#\?]/g,dh=/[#\?@]/g,zl=/#/g;function Li(A,F){this.h=this.g=null,this.i=A||null,this.j=!!F}function zi(A){A.g||(A.g=new Map,A.h=0,A.i&&bu(A.i,function(F,Z){A.add(decodeURIComponent(F.replace(/\+/g," ")),Z)}))}r=Li.prototype,r.add=function(A,F){zi(this),this.i=null,A=Bs(this,A);var Z=this.g.get(A);return Z||this.g.set(A,Z=[]),Z.push(F),this.h+=1,this};function vn(A,F){zi(A),F=Bs(A,F),A.g.has(F)&&(A.i=null,A.h-=A.g.get(F).length,A.g.delete(F))}function hs(A,F){return zi(A),F=Bs(A,F),A.g.has(F)}r.forEach=function(A,F){zi(this),this.g.forEach(function(Z,ce){Z.forEach(function(Qe){A.call(F,Qe,ce,this)},this)},this)},r.na=function(){zi(this);const A=Array.from(this.g.values()),F=Array.from(this.g.keys()),Z=[];for(let ce=0;ce<F.length;ce++){const Qe=A[ce];for(let dt=0;dt<Qe.length;dt++)Z.push(F[ce])}return Z},r.V=function(A){zi(this);let F=[];if(typeof A=="string")hs(this,A)&&(F=F.concat(this.g.get(Bs(this,A))));else{A=Array.from(this.g.values());for(let Z=0;Z<A.length;Z++)F=F.concat(A[Z])}return F},r.set=function(A,F){return zi(this),this.i=null,A=Bs(this,A),hs(this,A)&&(this.h-=this.g.get(A).length),this.g.set(A,[F]),this.h+=1,this},r.get=function(A,F){return A?(A=this.V(A),0<A.length?String(A[0]):F):F};function Ol(A,F,Z){vn(A,F),0<Z.length&&(A.i=null,A.g.set(Bs(A,F),Ie(Z)),A.h+=Z.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const A=[],F=Array.from(this.g.keys());for(var Z=0;Z<F.length;Z++){var ce=F[Z];const dt=encodeURIComponent(String(ce)),Nt=this.V(ce);for(ce=0;ce<Nt.length;ce++){var Qe=dt;Nt[ce]!==""&&(Qe+="="+encodeURIComponent(String(Nt[ce]))),A.push(Qe)}}return this.i=A.join("&")};function Bs(A,F){return F=String(F),A.j&&(F=F.toLowerCase()),F}function Hi(A,F){F&&!A.j&&(zi(A),A.i=null,A.g.forEach(function(Z,ce){var Qe=ce.toLowerCase();ce!=Qe&&(vn(this,ce),Ol(this,Qe,Z))},A)),A.j=F}function jr(A,F){const Z=new Sn;if(c.Image){const ce=new Image;ce.onload=W(Er,Z,"TestLoadImage: loaded",!0,F,ce),ce.onerror=W(Er,Z,"TestLoadImage: error",!1,F,ce),ce.onabort=W(Er,Z,"TestLoadImage: abort",!1,F,ce),ce.ontimeout=W(Er,Z,"TestLoadImage: timeout",!1,F,ce),c.setTimeout(function(){ce.ontimeout&&ce.ontimeout()},1e4),ce.src=A}else F(!1)}function $r(A,F){const Z=new Sn,ce=new AbortController,Qe=setTimeout(()=>{ce.abort(),Er(Z,"TestPingServer: timeout",!1,F)},1e4);fetch(A,{signal:ce.signal}).then(dt=>{clearTimeout(Qe),dt.ok?Er(Z,"TestPingServer: ok",!0,F):Er(Z,"TestPingServer: server error",!1,F)}).catch(()=>{clearTimeout(Qe),Er(Z,"TestPingServer: error",!1,F)})}function Er(A,F,Z,ce,Qe){try{Qe&&(Qe.onload=null,Qe.onerror=null,Qe.onabort=null,Qe.ontimeout=null),ce(Z)}catch{}}function pr(){this.g=new De}function ds(A,F,Z){const ce=Z||"";try{vc(A,function(Qe,dt){let Nt=Qe;k(Qe)&&(Nt=ue(Qe)),F.push(ce+dt+"="+encodeURIComponent(Nt))})}catch(Qe){throw F.push(ce+"type="+encodeURIComponent("_badmap")),Qe}}function En(A){this.l=A.Ub||null,this.j=A.eb||!1}ie(En,je),En.prototype.g=function(){return new fi(this.l,this.j)},En.prototype.i=function(A){return function(){return A}}({});function fi(A,F){fr.call(this),this.D=A,this.o=F,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}ie(fi,fr),r=fi.prototype,r.open=function(A,F){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=A,this.A=F,this.readyState=1,Ta(this)},r.send=function(A){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const F={headers:this.u,method:this.B,credentials:this.m,cache:void 0};A&&(F.body=A),(this.D||c).fetch(new Request(this.A,F)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,dn(this)),this.readyState=0},r.Sa=function(A){if(this.g&&(this.l=A,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=A.headers,this.readyState=2,Ta(this)),this.g&&(this.readyState=3,Ta(this),this.g)))if(this.responseType==="arraybuffer")A.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in A){if(this.j=A.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;mn(this)}else A.text().then(this.Ra.bind(this),this.ga.bind(this))};function mn(A){A.j.read().then(A.Pa.bind(A)).catch(A.ga.bind(A))}r.Pa=function(A){if(this.g){if(this.o&&A.value)this.response.push(A.value);else if(!this.o){var F=A.value?A.value:new Uint8Array(0);(F=this.v.decode(F,{stream:!A.done}))&&(this.response=this.responseText+=F)}A.done?dn(this):Ta(this),this.readyState==3&&mn(this)}},r.Ra=function(A){this.g&&(this.response=this.responseText=A,dn(this))},r.Qa=function(A){this.g&&(this.response=A,dn(this))},r.ga=function(){this.g&&dn(this)};function dn(A){A.readyState=4,A.l=null,A.j=null,A.v=null,Ta(A)}r.setRequestHeader=function(A,F){this.u.append(A,F)},r.getResponseHeader=function(A){return this.h&&this.h.get(A.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const A=[],F=this.h.entries();for(var Z=F.next();!Z.done;)Z=Z.value,A.push(Z[0]+": "+Z[1]),Z=F.next();return A.join(`\r
`)};function Ta(A){A.onreadystatechange&&A.onreadystatechange.call(A)}Object.defineProperty(fi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(A){this.m=A?"include":"same-origin"}});function an(A){let F="";return We(A,function(Z,ce){F+=ce,F+=":",F+=Z,F+=`\r
`}),F}function Jr(A,F,Z){e:{for(ce in Z){var ce=!1;break e}ce=!0}ce||(Z=an(Z),typeof A=="string"?Z!=null&&encodeURIComponent(String(Z)):Sr(A,F,Z))}function Mn(A){fr.call(this),this.headers=new Map,this.o=A||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}ie(Mn,fr);var uo=/^https?$/i,ia=["POST","PUT"];r=Mn.prototype,r.Ha=function(A){this.J=A},r.ea=function(A,F,Z,ce){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+A);F=F?F.toUpperCase():"GET",this.D=A,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ba.g(),this.v=this.o?Je(this.o):Je(ba),this.g.onreadystatechange=G(this.Ea,this);try{this.B=!0,this.g.open(F,String(A),!0),this.B=!1}catch(dt){bc(this,dt);return}if(A=Z||"",Z=new Map(this.headers),ce)if(Object.getPrototypeOf(ce)===Object.prototype)for(var Qe in ce)Z.set(Qe,ce[Qe]);else if(typeof ce.keys=="function"&&typeof ce.get=="function")for(const dt of ce.keys())Z.set(dt,ce.get(dt));else throw Error("Unknown input type for opt_headers: "+String(ce));ce=Array.from(Z.keys()).find(dt=>dt.toLowerCase()=="content-type"),Qe=c.FormData&&A instanceof c.FormData,!(0<=Array.prototype.indexOf.call(ia,F,void 0))||ce||Qe||Z.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[dt,Nt]of Z)this.g.setRequestHeader(dt,Nt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ho(this),this.u=!0,this.g.send(A),this.u=!1}catch(dt){bc(this,dt)}};function bc(A,F){A.h=!1,A.g&&(A.j=!0,A.g.abort(),A.j=!1),A.l=F,A.m=5,Na(A),co(A)}function Na(A){A.A||(A.A=!0,zn(A,"complete"),zn(A,"error"))}r.abort=function(A){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=A||7,zn(this,"complete"),zn(this,"abort"),co(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),co(this,!0)),Mn.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?xu(this):this.bb())},r.bb=function(){xu(this)};function xu(A){if(A.h&&typeof y<"u"&&(!A.v[1]||Sa(A)!=4||A.Z()!=2)){if(A.u&&Sa(A)==4)Ri(A.Ea,0,A);else if(zn(A,"readystatechange"),Sa(A)==4){A.h=!1;try{const Nt=A.Z();e:switch(Nt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var F=!0;break e;default:F=!1}var Z;if(!(Z=F)){var ce;if(ce=Nt===0){var Qe=String(A.D).match(Ll)[1]||null;!Qe&&c.self&&c.self.location&&(Qe=c.self.location.protocol.slice(0,-1)),ce=!uo.test(Qe?Qe.toLowerCase():"")}Z=ce}if(Z)zn(A,"complete"),zn(A,"success");else{A.m=6;try{var dt=2<Sa(A)?A.g.statusText:""}catch{dt=""}A.l=dt+" ["+A.Z()+"]",Na(A)}}finally{co(A)}}}}function co(A,F){if(A.g){ho(A);const Z=A.g,ce=A.v[0]?()=>{}:null;A.g=null,A.v=null,F||zn(A,"ready");try{Z.onreadystatechange=ce}catch{}}}function ho(A){A.I&&(c.clearTimeout(A.I),A.I=null)}r.isActive=function(){return!!this.g};function Sa(A){return A.g?A.g.readyState:0}r.Z=function(){try{return 2<Sa(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(A){if(this.g){var F=this.g.responseText;return A&&F.indexOf(A)==0&&(F=F.substring(A.length)),xe(F)}};function Ya(A){try{if(!A.g)return null;if("response"in A.g)return A.g.response;switch(A.H){case"":case"text":return A.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in A.g)return A.g.mozResponseArrayBuffer}return null}catch{return null}}function Oi(A){const F={};A=(A.g&&2<=Sa(A)&&A.g.getAllResponseHeaders()||"").split(`\r
`);for(let ce=0;ce<A.length;ce++){if(Ke(A[ce]))continue;var Z=Ce(A[ce]);const Qe=Z[0];if(Z=Z[1],typeof Z!="string")continue;Z=Z.trim();const dt=F[Qe]||[];F[Qe]=dt,dt.push(Z)}pe(F,function(ce){return ce.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vs(A,F,Z){return Z&&Z.internalChannelParams&&Z.internalChannelParams[A]||F}function No(A){this.Aa=0,this.i=[],this.j=new Sn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Vs("failFast",!1,A),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Vs("baseRetryDelayMs",5e3,A),this.cb=Vs("retryDelaySeedMs",1e4,A),this.Wa=Vs("forwardChannelMaxRetries",2,A),this.wa=Vs("forwardChannelRequestTimeoutMs",2e4,A),this.pa=A&&A.xmlHttpFactory||void 0,this.Xa=A&&A.Tb||void 0,this.Ca=A&&A.useFetchStreams||!1,this.L=void 0,this.J=A&&A.supportsCrossDomainXhr||!1,this.K="",this.h=new Do(A&&A.concurrentRequestLimit),this.Da=new pr,this.P=A&&A.fastHandshake||!1,this.O=A&&A.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=A&&A.Rb||!1,A&&A.xa&&this.j.xa(),A&&A.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&A&&A.detectBufferingProxy||!1,this.ja=void 0,A&&A.longPollingTimeout&&0<A.longPollingTimeout&&(this.ja=A.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=No.prototype,r.la=8,r.G=1,r.connect=function(A,F,Z,ce){Ht(0),this.W=A,this.H=F||{},Z&&ce!==void 0&&(this.H.OSID=Z,this.H.OAID=ce),this.F=this.X,this.I=wc(this,null,this.W),fo(this)};function Bo(A){if(Nl(A),A.G==3){var F=A.U++,Z=Xa(A.I);if(Sr(Z,"SID",A.K),Sr(Z,"RID",F),Sr(Z,"TYPE","terminate"),Qa(A,Z),F=new ln(A,A.j,F),F.L=2,F.v=Oo(Xa(Z)),Z=!1,c.navigator&&c.navigator.sendBeacon)try{Z=c.navigator.sendBeacon(F.v.toString(),"")}catch{}!Z&&c.Image&&(new Image().src=F.v,Z=!0),Z||(F.g=ud(F.j,null),F.g.ea(F.v)),F.F=Date.now(),kr(F)}ol(A)}function Xr(A){A.g&&(_i(A),A.g.cancel(),A.g=null)}function Nl(A){Xr(A),A.u&&(c.clearTimeout(A.u),A.u=null),aa(A),A.h.cancel(),A.s&&(typeof A.s=="number"&&c.clearTimeout(A.s),A.s=null)}function fo(A){if(!Lo(A.h)&&!A.s){A.s=!0;var F=A.Ga;Bt||ze(),nn||(Bt(),nn=!0),Kn.add(F,A),A.B=0}}function Bl(A,F){return il(A.h)>=A.h.j-(A.s?1:0)?!1:A.s?(A.i=F.D.concat(A.i),!0):A.G==1||A.G==2||A.B>=(A.Va?0:A.Wa)?!1:(A.s=gn(G(A.Ga,A,F),wu(A,A.B)),A.B++,!0)}r.Ga=function(A){if(this.s)if(this.s=null,this.G==1){if(!A){this.U=Math.floor(1e5*Math.random()),A=this.U++;const Qe=new ln(this,this.j,A);let dt=this.o;if(this.S&&(dt?(dt=oe(dt),be(dt,this.S)):dt=this.S),this.m!==null||this.O||(Qe.H=dt,dt=null),this.P)e:{for(var F=0,Z=0;Z<this.i.length;Z++){t:{var ce=this.i[Z];if("__data__"in ce.map&&(ce=ce.map.__data__,typeof ce=="string")){ce=ce.length;break t}ce=void 0}if(ce===void 0)break;if(F+=ce,4096<F){F=Z;break e}if(F===4096||Z===this.i.length-1){F=Z+1;break e}}F=1e3}else F=1e3;F=Vl(this,Qe,F),Z=Xa(this.I),Sr(Z,"RID",A),Sr(Z,"CVER",22),this.D&&Sr(Z,"X-HTTP-Session-Id",this.D),Qa(this,Z),dt&&(this.O?F="headers="+encodeURIComponent(String(an(dt)))+"&"+F:this.m&&Jr(Z,this.m,dt)),ls(this.h,Qe),this.Ua&&Sr(Z,"TYPE","init"),this.P?(Sr(Z,"$req",F),Sr(Z,"SID","null"),Qe.T=!0,ki(Qe,Z,null)):ki(Qe,Z,F),this.G=2}}else this.G==3&&(A?fh(this,A):this.i.length==0||Lo(this.h)||fh(this))};function fh(A,F){var Z;F?Z=F.l:Z=A.U++;const ce=Xa(A.I);Sr(ce,"SID",A.K),Sr(ce,"RID",Z),Sr(ce,"AID",A.T),Qa(A,ce),A.m&&A.o&&Jr(ce,A.m,A.o),Z=new ln(A,A.j,Z,A.B+1),A.m===null&&(Z.H=A.o),F&&(A.i=F.D.concat(A.i)),F=Vl(A,Z,1e3),Z.I=Math.round(.5*A.wa)+Math.round(.5*A.wa*Math.random()),ls(A.h,Z),ki(Z,ce,F)}function Qa(A,F){A.H&&We(A.H,function(Z,ce){Sr(F,ce,Z)}),A.l&&vc({},function(Z,ce){Sr(F,ce,Z)})}function Vl(A,F,Z){Z=Math.min(A.i.length,Z);var ce=A.l?G(A.l.Na,A.l,A):null;e:{var Qe=A.i;let dt=-1;for(;;){const Nt=["count="+Z];dt==-1?0<Z?(dt=Qe[0].g,Nt.push("ofs="+dt)):dt=0:Nt.push("ofs="+dt);let $n=!0;for(let Ni=0;Ni<Z;Ni++){let qn=Qe[Ni].g;const Zi=Qe[Ni].map;if(qn-=dt,0>qn)dt=Math.max(0,Qe[Ni].g-100),$n=!1;else try{ds(Zi,Nt,"req"+qn+"_")}catch{ce&&ce(Zi)}}if($n){ce=Nt.join("&");break e}}}return A=A.i.splice(0,Z),F.D=A,ce}function xc(A){if(!A.g&&!A.u){A.Y=1;var F=A.Fa;Bt||ze(),nn||(Bt(),nn=!0),Kn.add(F,A),A.v=0}}function ph(A){return A.g||A.u||3<=A.v?!1:(A.Y++,A.u=gn(G(A.Fa,A),wu(A,A.v)),A.v++,!0)}r.Fa=function(){if(this.u=null,sl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var A=2*this.R;this.j.info("BP detection timer enabled: "+A),this.A=gn(G(this.ab,this),A)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ht(10),Xr(this),sl(this))};function _i(A){A.A!=null&&(c.clearTimeout(A.A),A.A=null)}function sl(A){A.g=new ln(A,A.j,"rpc",A.Y),A.m===null&&(A.g.H=A.o),A.g.O=0;var F=Xa(A.qa);Sr(F,"RID","rpc"),Sr(F,"SID",A.K),Sr(F,"AID",A.T),Sr(F,"CI",A.F?"0":"1"),!A.F&&A.ja&&Sr(F,"TO",A.ja),Sr(F,"TYPE","xmlhttp"),Qa(A,F),A.m&&A.o&&Jr(F,A.m,A.o),A.L&&(A.g.I=A.L);var Z=A.g;A=A.ia,Z.L=1,Z.v=Oo(Xa(F)),Z.m=null,Z.P=!0,pn(Z,A)}r.Za=function(){this.C!=null&&(this.C=null,Xr(this),ph(this),Ht(19))};function aa(A){A.C!=null&&(c.clearTimeout(A.C),A.C=null)}function da(A,F){var Z=null;if(A.g==F){aa(A),_i(A),A.g=null;var ce=2}else if(so(A.h,F))Z=F.D,xa(A.h,F),ce=1;else return;if(A.G!=0){if(F.o)if(ce==1){Z=F.m?F.m.length:0,F=Date.now()-F.F;var Qe=A.B;ce=Lt(),zn(ce,new Tn(ce,Z)),fo(A)}else xc(A);else if(Qe=F.s,Qe==3||Qe==0&&0<F.X||!(ce==1&&Bl(A,F)||ce==2&&ph(A)))switch(Z&&0<Z.length&&(F=A.h,F.i=F.i.concat(Z)),Qe){case 1:fs(A,5);break;case 4:fs(A,10);break;case 3:fs(A,6);break;default:fs(A,2)}}}function wu(A,F){let Z=A.Ta+Math.floor(Math.random()*A.cb);return A.isActive()||(Z*=2),Z*F}function fs(A,F){if(A.j.info("Error code "+F),F==2){var Z=G(A.fb,A),ce=A.Xa;const Qe=!ce;ce=new Di(ce||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Ns(ce,"https"),Oo(ce),Qe?jr(ce.toString(),Z):$r(ce.toString(),Z)}else Ht(2);A.G=0,A.l&&A.l.sa(F),ol(A),Nl(A)}r.fb=function(A){A?(this.j.info("Successfully pinged google.com"),Ht(2)):(this.j.info("Failed to ping google.com"),Ht(1))};function ol(A){if(A.G=0,A.ka=[],A.l){const F=_c(A.h);(F.length!=0||A.i.length!=0)&&(Re(A.ka,F),Re(A.ka,A.i),A.h.i.length=0,Ie(A.i),A.i.length=0),A.l.ra()}}function wc(A,F,Z){var ce=Z instanceof Di?Xa(Z):new Di(Z);if(ce.g!="")F&&(ce.g=F+"."+ce.g),zo(ce,ce.s);else{var Qe=c.location;ce=Qe.protocol,F=F?F+"."+Qe.hostname:Qe.hostname,Qe=+Qe.port;var dt=new Di(null);ce&&Ns(dt,ce),F&&(dt.g=F),Qe&&zo(dt,Qe),Z&&(dt.l=Z),ce=dt}return Z=A.D,F=A.ya,Z&&F&&Sr(ce,Z,F),Sr(ce,"VER",A.la),Qa(A,ce),ce}function ud(A,F,Z){if(F&&!A.J)throw Error("Can't create secondary domain capable XhrIo object.");return F=A.Ca&&!A.pa?new Mn(new En({eb:Z})):new Mn(A.pa),F.Ha(A.J),F}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function cd(){}r=cd.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Tc(){}Tc.prototype.g=function(A,F){return new Ba(A,F)};function Ba(A,F){fr.call(this),this.g=new No(F),this.l=A,this.h=F&&F.messageUrlParams||null,A=F&&F.messageHeaders||null,F&&F.clientProtocolHeaderRequired&&(A?A["X-Client-Protocol"]="webchannel":A={"X-Client-Protocol":"webchannel"}),this.g.o=A,A=F&&F.initMessageHeaders||null,F&&F.messageContentType&&(A?A["X-WebChannel-Content-Type"]=F.messageContentType:A={"X-WebChannel-Content-Type":F.messageContentType}),F&&F.va&&(A?A["X-WebChannel-Client-Profile"]=F.va:A={"X-WebChannel-Client-Profile":F.va}),this.g.S=A,(A=F&&F.Sb)&&!Ke(A)&&(this.g.m=A),this.v=F&&F.supportsCrossDomainXhr||!1,this.u=F&&F.sendRawJson||!1,(F=F&&F.httpSessionIdParam)&&!Ke(F)&&(this.g.D=F,A=this.h,A!==null&&F in A&&(A=this.h,F in A&&delete A[F])),this.j=new ps(this)}ie(Ba,fr),Ba.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ba.prototype.close=function(){Bo(this.g)},Ba.prototype.o=function(A){var F=this.g;if(typeof A=="string"){var Z={};Z.__data__=A,A=Z}else this.u&&(Z={},Z.__data__=ue(A),A=Z);F.i.push(new Dr(F.Ya++,A)),F.G==3&&fo(F)},Ba.prototype.N=function(){this.g.l=null,delete this.j,Bo(this.g),delete this.g,Ba.aa.N.call(this)};function Tu(A){it.call(this),A.__headers__&&(this.headers=A.__headers__,this.statusCode=A.__status__,delete A.__headers__,delete A.__status__);var F=A.__sm__;if(F){e:{for(const Z in F){A=Z;break e}A=void 0}(this.i=A)&&(A=this.i,F=F!==null&&A in F?F[A]:void 0),this.data=F}else this.data=A}ie(Tu,it);function Su(){Ge.call(this),this.status=1}ie(Su,Ge);function ps(A){this.g=A}ie(ps,cd),ps.prototype.ua=function(){zn(this.g,"a")},ps.prototype.ta=function(A){zn(this.g,new Tu(A))},ps.prototype.sa=function(A){zn(this.g,new Su)},ps.prototype.ra=function(){zn(this.g,"b")},Tc.prototype.createWebChannel=Tc.prototype.g,Ba.prototype.send=Ba.prototype.o,Ba.prototype.open=Ba.prototype.m,Ba.prototype.close=Ba.prototype.close,ZA=function(){return new Tc},HA=function(){return Lt()},GA=ft,zx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cr.NO_ERROR=0,cr.TIMEOUT=8,cr.HTTP_ERROR=6,Zv=cr,va.COMPLETE="complete",qA=va,Be.EventType=lt,lt.OPEN="a",lt.CLOSE="b",lt.ERROR="c",lt.MESSAGE="d",fr.prototype.listen=fr.prototype.K,By=Be,Mn.prototype.listenOnce=Mn.prototype.L,Mn.prototype.getLastError=Mn.prototype.Ka,Mn.prototype.getLastErrorCode=Mn.prototype.Ba,Mn.prototype.getStatus=Mn.prototype.Z,Mn.prototype.getResponseJson=Mn.prototype.Oa,Mn.prototype.getResponseText=Mn.prototype.oa,Mn.prototype.send=Mn.prototype.ea,Mn.prototype.setWithCredentials=Mn.prototype.Ha,$A=Mn}).apply(typeof Cv<"u"?Cv:typeof self<"u"?self:typeof window<"u"?window:{});const dT="@firebase/firestore",fT="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}eo.UNAUTHENTICATED=new eo(null),eo.GOOGLE_CREDENTIALS=new eo("google-credentials-uid"),eo.FIRST_PARTY=new eo("first-party-uid"),eo.MOCK_USER=new eo("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gg="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np=new F1("@firebase/firestore");function zm(){return Np.logLevel}function Wt(r,...e){if(Np.logLevel<=lr.DEBUG){const t=e.map(Q1);Np.debug(`Firestore (${gg}): ${r}`,...t)}}function ed(r,...e){if(Np.logLevel<=lr.ERROR){const t=e.map(Q1);Np.error(`Firestore (${gg}): ${r}`,...t)}}function rg(r,...e){if(Np.logLevel<=lr.WARN){const t=e.map(Q1);Np.warn(`Firestore (${gg}): ${r}`,...t)}}function Q1(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(r,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,KA(r,a,t)}function KA(r,e,t){let a=`FIRESTORE (${gg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw ed(a),new Error(a)}function Kr(r,e,t,a){let d="Unexpected state";typeof t=="string"?d=t:a=t,r||KA(e,d,a)}function Vn(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Et={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xt extends sd{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Q3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(eo.UNAUTHENTICATED))}shutdown(){}}class J3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class eL{constructor(e){this.t=e,this.currentUser=eo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Kr(this.o===void 0,42304);let a=this.i;const d=P=>this.i!==a?(a=this.i,t(P)):Promise.resolve();let m=new Kh;this.o=()=>{this.i++,this.currentUser=this.u(),m.resolve(),m=new Kh,e.enqueueRetryable(()=>d(this.currentUser))};const y=()=>{const P=m;e.enqueueRetryable(async()=>{await P.promise,await d(this.currentUser)})},c=P=>{Wt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=P,this.o&&(this.auth.addAuthTokenListener(this.o),y())};this.t.onInit(P=>c(P)),setTimeout(()=>{if(!this.auth){const P=this.t.getImmediate({optional:!0});P?c(P):(Wt("FirebaseAuthCredentialsProvider","Auth not yet detected"),m.resolve(),m=new Kh)}},0),y()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(a=>this.i!==e?(Wt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Kr(typeof a.accessToken=="string",31837,{l:a}),new WA(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Kr(e===null||typeof e=="string",2055,{h:e}),new eo(e)}}class tL{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=eo.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class nL{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new tL(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(eo.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class pT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rL{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,mu(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Kr(this.o===void 0,3512);const a=m=>{m.error!=null&&Wt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${m.error.message}`);const y=m.token!==this.m;return this.m=m.token,Wt("FirebaseAppCheckTokenProvider",`Received ${y?"new":"existing"} token.`),y?t(m.token):Promise.resolve()};this.o=m=>{e.enqueueRetryable(()=>a(m))};const d=m=>{Wt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=m,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(m=>d(m)),setTimeout(()=>{if(!this.appCheck){const m=this.V.getImmediate({optional:!0});m?d(m):Wt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new pT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Kr(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new pT(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<r;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XA(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const d=iL(40);for(let m=0;m<d.length;++m)a.length<20&&d[m]<t&&(a+=e.charAt(d[m]%62))}return a}}function tr(r,e){return r<e?-1:r>e?1:0}function Ox(r,e){let t=0;for(;t<r.length&&t<e.length;){const a=r.codePointAt(t),d=e.codePointAt(t);if(a!==d){if(a<128&&d<128)return tr(a,d);{const m=XA(),y=aL(m.encode(mT(r,t)),m.encode(mT(e,t)));return y!==0?y:tr(a,d)}}t+=a>65535?2:1}return tr(r.length,e.length)}function mT(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function aL(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return tr(r[t],e[t]);return tr(r.length,e.length)}function ig(r,e,t){return r.length===e.length&&r.every((a,d)=>t(a,e[d]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT=-62135596800,yT=1e6;class Za{static now(){return Za.fromMillis(Date.now())}static fromDate(e){return Za.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*yT);return new Za(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Xt(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Xt(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<gT)throw new Xt(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Xt(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yT}_compareTo(e){return this.seconds===e.seconds?tr(this.nanoseconds,e.nanoseconds):tr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-gT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{static fromTimestamp(e){return new Nn(e)}static min(){return new Nn(new Za(0,0))}static max(){return new Nn(new Za(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T="__name__";class Yc{constructor(e,t,a){t===void 0?t=0:t>e.length&&Pn(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&Pn(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Yc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yc?e.forEach(a=>{t.push(a)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let d=0;d<a;d++){const m=Yc.compareSegments(e.get(d),t.get(d));if(m!==0)return m}return tr(e.length,t.length)}static compareSegments(e,t){const a=Yc.isNumericId(e),d=Yc.isNumericId(t);return a&&!d?-1:!a&&d?1:a&&d?Yc.extractNumericId(e).compare(Yc.extractNumericId(t)):Ox(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return lf.fromString(e.substring(4,e.length-2))}}class Pi extends Yc{construct(e,t,a){return new Pi(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new Xt(Et.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter(d=>d.length>0))}return new Pi(t)}static emptyPath(){return new Pi([])}}const sL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ps extends Yc{construct(e,t,a){return new Ps(e,t,a)}static isValidIdentifier(e){return sL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ps.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_T}static keyField(){return new Ps([_T])}static fromServerFormat(e){const t=[];let a="",d=0;const m=()=>{if(a.length===0)throw new Xt(Et.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let y=!1;for(;d<e.length;){const c=e[d];if(c==="\\"){if(d+1===e.length)throw new Xt(Et.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const P=e[d+1];if(P!=="\\"&&P!=="."&&P!=="`")throw new Xt(Et.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=P,d+=2}else c==="`"?(y=!y,d++):c!=="."||y?(a+=c,d++):(m(),d++)}if(m(),y)throw new Xt(Et.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ps(t)}static emptyPath(){return new Ps([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.path=e}static fromPath(e){return new _n(Pi.fromString(e))}static fromName(e){return new _n(Pi.fromString(e).popFirst(5))}static empty(){return new _n(Pi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pi.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pi.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _n(new Pi(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_=-1;function oL(r,e){const t=r.toTimestamp().seconds,a=r.toTimestamp().nanoseconds+1,d=Nn.fromTimestamp(a===1e9?new Za(t+1,0):new Za(t,a));return new cf(d,_n.empty(),e)}function lL(r){return new cf(r.readTime,r.key,s_)}class cf{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new cf(Nn.min(),_n.empty(),s_)}static max(){return new cf(Nn.max(),_n.empty(),s_)}}function uL(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=_n.comparator(r.documentKey,e.documentKey),t!==0?t:tr(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yg(r){if(r.code!==Et.FAILED_PRECONDITION||r.message!==cL)throw r;Wt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Pn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new At((a,d)=>{this.nextCallback=m=>{this.wrapSuccess(e,m).next(a,d)},this.catchCallback=m=>{this.wrapFailure(t,m).next(a,d)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof At?t:At.resolve(t)}catch(t){return At.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):At.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):At.reject(t)}static resolve(e){return new At((t,a)=>{t(e)})}static reject(e){return new At((t,a)=>{a(e)})}static waitFor(e){return new At((t,a)=>{let d=0,m=0,y=!1;e.forEach(c=>{++d,c.next(()=>{++m,y&&m===d&&t()},P=>a(P))}),y=!0,m===d&&t()})}static or(e){let t=At.resolve(!1);for(const a of e)t=t.next(d=>d?At.resolve(d):a());return t}static forEach(e,t){const a=[];return e.forEach((d,m)=>{a.push(t.call(this,d,m))}),this.waitFor(a)}static mapArray(e,t){return new At((a,d)=>{const m=e.length,y=new Array(m);let c=0;for(let P=0;P<m;P++){const k=P;t(e[k]).next(B=>{y[k]=B,++c,c===m&&a(y)},B=>d(B))}})}static doWhile(e,t){return new At((a,d)=>{const m=()=>{e()===!0?t().next(()=>{m()},d):a()};m()})}}function dL(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function _g(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ue(a),this.ce=a=>t.writeSequenceNumber(a))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}q0.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1=-1;function G0(r){return r==null}function p0(r){return r===0&&1/r==-1/0}function fL(r){return typeof r=="number"&&Number.isInteger(r)&&!p0(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QA="";function pL(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=vT(e)),e=mL(r.get(t),e);return vT(e)}function mL(r,e){let t=e;const a=r.length;for(let d=0;d<a;d++){const m=r.charAt(d);switch(m){case"\0":t+="";break;case QA:t+="";break;default:t+=m}}return t}function vT(r){return r+QA+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function xf(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function JA(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e,t){this.comparator=e,this.root=t||Cs.EMPTY}insert(e,t){return new ta(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Cs.BLACK,null,null))}remove(e){return new ta(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const d=this.comparator(e,a.key);if(d===0)return t+a.left.size;d<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,a)=>(e(t,a),!1))}toString(){const e=[];return this.inorderTraversal((t,a)=>(e.push(`${t}:${a}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pv(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pv(this.root,e,this.comparator,!0)}}class Pv{constructor(e,t,a,d){this.isReverse=d,this.nodeStack=[];let m=1;for(;!e.isEmpty();)if(m=t?a(e.key,t):1,t&&d&&(m*=-1),m<0)e=this.isReverse?e.left:e.right;else{if(m===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Cs{constructor(e,t,a,d,m){this.key=e,this.value=t,this.color=a??Cs.RED,this.left=d??Cs.EMPTY,this.right=m??Cs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,d,m){return new Cs(e??this.key,t??this.value,a??this.color,d??this.left,m??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let d=this;const m=a(e,d.key);return d=m<0?d.copy(null,null,null,d.left.insert(e,t,a),null):m===0?d.copy(null,t,null,null,null):d.copy(null,null,null,null,d.right.insert(e,t,a)),d.fixUp()}removeMin(){if(this.left.isEmpty())return Cs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,d=this;if(t(e,d.key)<0)d.left.isEmpty()||d.left.isRed()||d.left.left.isRed()||(d=d.moveRedLeft()),d=d.copy(null,null,null,d.left.remove(e,t),null);else{if(d.left.isRed()&&(d=d.rotateRight()),d.right.isEmpty()||d.right.isRed()||d.right.left.isRed()||(d=d.moveRedRight()),t(e,d.key)===0){if(d.right.isEmpty())return Cs.EMPTY;a=d.right.min(),d=d.copy(a.key,a.value,null,null,d.right.removeMin())}d=d.copy(null,null,null,null,d.right.remove(e,t))}return d.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Cs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Cs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pn(27949);return e+(this.isRed()?0:1)}}Cs.EMPTY=null,Cs.RED=!0,Cs.BLACK=!1;Cs.EMPTY=new class{constructor(){this.size=0}get key(){throw Pn(57766)}get value(){throw Pn(16141)}get color(){throw Pn(16727)}get left(){throw Pn(29726)}get right(){throw Pn(36894)}copy(e,t,a,d,m){return this}insert(e,t,a){return new Cs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e){this.comparator=e,this.data=new ta(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,a)=>(e(t),!1))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const d=a.getNext();if(this.comparator(d.key,e[1])>=0)return;t(d.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new xT(this.data.getIterator())}getIteratorFrom(e){return new xT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(a=>{t=t.add(a)}),t}isEqual(e){if(!(e instanceof Ka)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const d=t.getNext().key,m=a.getNext().key;if(this.comparator(d,m)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ka(this.comparator);return t.data=e,t}}class xT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e){this.fields=e,e.sort(Ps.comparator)}static empty(){return new Pl([])}unionWith(e){let t=new Ka(Ps.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new Pl(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ig(this.fields,e.fields,(t,a)=>t.isEqual(a))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(d){try{return atob(d)}catch(m){throw typeof DOMException<"u"&&m instanceof DOMException?new eI("Invalid base64 string: "+m):m}}(e);return new Rs(t)}static fromUint8Array(e){const t=function(d){let m="";for(let y=0;y<d.length;++y)m+=String.fromCharCode(d[y]);return m}(e);return new Rs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const a=new Uint8Array(t.length);for(let d=0;d<t.length;d++)a[d]=t.charCodeAt(d);return a}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rs.EMPTY_BYTE_STRING=new Rs("");const gL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hf(r){if(Kr(!!r,39018),typeof r=="string"){let e=0;const t=gL.exec(r);if(Kr(!!t,46558,{timestamp:r}),t[1]){let d=t[1];d=(d+"000000000").substr(0,9),e=Number(d)}const a=new Date(r);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:ga(r.seconds),nanos:ga(r.nanos)}}function ga(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function df(r){return typeof r=="string"?Rs.fromBase64String(r):Rs.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI="server_timestamp",nI="__type__",rI="__previous_value__",iI="__local_write_time__";function ew(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[nI])===null||t===void 0?void 0:t.stringValue)===tI}function H0(r){const e=r.mapValue.fields[rI];return ew(e)?H0(e):e}function o_(r){const e=hf(r.mapValue.fields[iI].timestampValue);return new Za(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e,t,a,d,m,y,c,P,k,B){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=d,this.ssl=m,this.forceLongPolling=y,this.autoDetectLongPolling=c,this.longPollingOptions=P,this.useFetchStreams=k,this.isUsingEmulator=B}}const m0="(default)";class l_{constructor(e,t){this.projectId=e,this.database=t||m0}static empty(){return new l_("","")}get isDefaultDatabase(){return this.database===m0}isEqual(e){return e instanceof l_&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI="__type__",_L="__max__",Mv={mapValue:{}},sI="__vector__",g0="value";function ff(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?ew(r)?4:bL(r)?9007199254740991:vL(r)?10:11:Pn(28295,{value:r})}function ch(r,e){if(r===e)return!0;const t=ff(r);if(t!==ff(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return o_(r).isEqual(o_(e));case 3:return function(d,m){if(typeof d.timestampValue=="string"&&typeof m.timestampValue=="string"&&d.timestampValue.length===m.timestampValue.length)return d.timestampValue===m.timestampValue;const y=hf(d.timestampValue),c=hf(m.timestampValue);return y.seconds===c.seconds&&y.nanos===c.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(d,m){return df(d.bytesValue).isEqual(df(m.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(d,m){return ga(d.geoPointValue.latitude)===ga(m.geoPointValue.latitude)&&ga(d.geoPointValue.longitude)===ga(m.geoPointValue.longitude)}(r,e);case 2:return function(d,m){if("integerValue"in d&&"integerValue"in m)return ga(d.integerValue)===ga(m.integerValue);if("doubleValue"in d&&"doubleValue"in m){const y=ga(d.doubleValue),c=ga(m.doubleValue);return y===c?p0(y)===p0(c):isNaN(y)&&isNaN(c)}return!1}(r,e);case 9:return ig(r.arrayValue.values||[],e.arrayValue.values||[],ch);case 10:case 11:return function(d,m){const y=d.mapValue.fields||{},c=m.mapValue.fields||{};if(bT(y)!==bT(c))return!1;for(const P in y)if(y.hasOwnProperty(P)&&(c[P]===void 0||!ch(y[P],c[P])))return!1;return!0}(r,e);default:return Pn(52216,{left:r})}}function u_(r,e){return(r.values||[]).find(t=>ch(t,e))!==void 0}function ag(r,e){if(r===e)return 0;const t=ff(r),a=ff(e);if(t!==a)return tr(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return tr(r.booleanValue,e.booleanValue);case 2:return function(m,y){const c=ga(m.integerValue||m.doubleValue),P=ga(y.integerValue||y.doubleValue);return c<P?-1:c>P?1:c===P?0:isNaN(c)?isNaN(P)?0:-1:1}(r,e);case 3:return wT(r.timestampValue,e.timestampValue);case 4:return wT(o_(r),o_(e));case 5:return Ox(r.stringValue,e.stringValue);case 6:return function(m,y){const c=df(m),P=df(y);return c.compareTo(P)}(r.bytesValue,e.bytesValue);case 7:return function(m,y){const c=m.split("/"),P=y.split("/");for(let k=0;k<c.length&&k<P.length;k++){const B=tr(c[k],P[k]);if(B!==0)return B}return tr(c.length,P.length)}(r.referenceValue,e.referenceValue);case 8:return function(m,y){const c=tr(ga(m.latitude),ga(y.latitude));return c!==0?c:tr(ga(m.longitude),ga(y.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return TT(r.arrayValue,e.arrayValue);case 10:return function(m,y){var c,P,k,B;const X=m.fields||{},G=y.fields||{},W=(c=X[g0])===null||c===void 0?void 0:c.arrayValue,ie=(P=G[g0])===null||P===void 0?void 0:P.arrayValue,Ie=tr(((k=W==null?void 0:W.values)===null||k===void 0?void 0:k.length)||0,((B=ie==null?void 0:ie.values)===null||B===void 0?void 0:B.length)||0);return Ie!==0?Ie:TT(W,ie)}(r.mapValue,e.mapValue);case 11:return function(m,y){if(m===Mv.mapValue&&y===Mv.mapValue)return 0;if(m===Mv.mapValue)return 1;if(y===Mv.mapValue)return-1;const c=m.fields||{},P=Object.keys(c),k=y.fields||{},B=Object.keys(k);P.sort(),B.sort();for(let X=0;X<P.length&&X<B.length;++X){const G=Ox(P[X],B[X]);if(G!==0)return G;const W=ag(c[P[X]],k[B[X]]);if(W!==0)return W}return tr(P.length,B.length)}(r.mapValue,e.mapValue);default:throw Pn(23264,{Pe:t})}}function wT(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return tr(r,e);const t=hf(r),a=hf(e),d=tr(t.seconds,a.seconds);return d!==0?d:tr(t.nanos,a.nanos)}function TT(r,e){const t=r.values||[],a=e.values||[];for(let d=0;d<t.length&&d<a.length;++d){const m=ag(t[d],a[d]);if(m)return m}return tr(t.length,a.length)}function sg(r){return Nx(r)}function Nx(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const a=hf(t);return`time(${a.seconds},${a.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return df(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return _n.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let a="[",d=!0;for(const m of t.values||[])d?d=!1:a+=",",a+=Nx(m);return a+"]"}(r.arrayValue):"mapValue"in r?function(t){const a=Object.keys(t.fields||{}).sort();let d="{",m=!0;for(const y of a)m?m=!1:d+=",",d+=`${y}:${Nx(t.fields[y])}`;return d+"}"}(r.mapValue):Pn(61005,{value:r})}function Kv(r){switch(ff(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=H0(r);return e?16+Kv(e):16;case 5:return 2*r.stringValue.length;case 6:return df(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(a){return(a.values||[]).reduce((d,m)=>d+Kv(m),0)}(r.arrayValue);case 10:case 11:return function(a){let d=0;return xf(a.fields,(m,y)=>{d+=m.length+Kv(y)}),d}(r.mapValue);default:throw Pn(13486,{value:r})}}function ST(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Bx(r){return!!r&&"integerValue"in r}function tw(r){return!!r&&"arrayValue"in r}function ET(r){return!!r&&"nullValue"in r}function AT(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Wv(r){return!!r&&"mapValue"in r}function vL(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[aI])===null||t===void 0?void 0:t.stringValue)===sI}function Hy(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return xf(r.mapValue.fields,(t,a)=>e.mapValue.fields[t]=Hy(a)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Hy(r.arrayValue.values[t]);return e}return Object.assign({},r)}function bL(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===_L}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e){this.value=e}static empty(){return new tl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!Wv(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hy(t)}setAll(e){let t=Ps.emptyPath(),a={},d=[];e.forEach((y,c)=>{if(!t.isImmediateParentOf(c)){const P=this.getFieldsMap(t);this.applyChanges(P,a,d),a={},d=[],t=c.popLast()}y?a[c.lastSegment()]=Hy(y):d.push(c.lastSegment())});const m=this.getFieldsMap(t);this.applyChanges(m,a,d)}delete(e){const t=this.field(e.popLast());Wv(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ch(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let d=t.mapValue.fields[e.get(a)];Wv(d)&&d.mapValue.fields||(d={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=d),t=d}return t.mapValue.fields}applyChanges(e,t,a){xf(t,(d,m)=>e[d]=m);for(const d of a)delete e[d]}clone(){return new tl(Hy(this.value))}}function oI(r){const e=[];return xf(r.fields,(t,a)=>{const d=new Ps([t]);if(Wv(a)){const m=oI(a.mapValue).fields;if(m.length===0)e.push(d);else for(const y of m)e.push(d.child(y))}else e.push(d)}),new Pl(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,t,a,d,m,y,c){this.key=e,this.documentType=t,this.version=a,this.readTime=d,this.createTime=m,this.data=y,this.documentState=c}static newInvalidDocument(e){return new to(e,0,Nn.min(),Nn.min(),Nn.min(),tl.empty(),0)}static newFoundDocument(e,t,a,d){return new to(e,1,t,Nn.min(),a,d,0)}static newNoDocument(e,t){return new to(e,2,t,Nn.min(),Nn.min(),tl.empty(),0)}static newUnknownDocument(e,t){return new to(e,3,t,Nn.min(),Nn.min(),tl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Nn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=tl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=tl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Nn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof to&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new to(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,t){this.position=e,this.inclusive=t}}function IT(r,e,t){let a=0;for(let d=0;d<r.position.length;d++){const m=e[d],y=r.position[d];if(m.field.isKeyField()?a=_n.comparator(_n.fromName(y.referenceValue),t.key):a=ag(y,t.data.field(m.field)),m.dir==="desc"&&(a*=-1),a!==0)break}return a}function CT(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!ch(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e,t="asc"){this.field=e,this.dir=t}}function xL(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{}class Da extends lI{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new TL(e,t,a):t==="array-contains"?new AL(e,a):t==="in"?new IL(e,a):t==="not-in"?new CL(e,a):t==="array-contains-any"?new PL(e,a):new Da(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new SL(e,a):new EL(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ag(t,this.value)):t!==null&&ff(this.value)===ff(t)&&this.matchesComparison(ag(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pc extends lI{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new pc(e,t)}matches(e){return uI(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function uI(r){return r.op==="and"}function cI(r){return wL(r)&&uI(r)}function wL(r){for(const e of r.filters)if(e instanceof pc)return!1;return!0}function Vx(r){if(r instanceof Da)return r.field.canonicalString()+r.op.toString()+sg(r.value);if(cI(r))return r.filters.map(e=>Vx(e)).join(",");{const e=r.filters.map(t=>Vx(t)).join(",");return`${r.op}(${e})`}}function hI(r,e){return r instanceof Da?function(a,d){return d instanceof Da&&a.op===d.op&&a.field.isEqual(d.field)&&ch(a.value,d.value)}(r,e):r instanceof pc?function(a,d){return d instanceof pc&&a.op===d.op&&a.filters.length===d.filters.length?a.filters.reduce((m,y,c)=>m&&hI(y,d.filters[c]),!0):!1}(r,e):void Pn(19439)}function dI(r){return r instanceof Da?function(t){return`${t.field.canonicalString()} ${t.op} ${sg(t.value)}`}(r):r instanceof pc?function(t){return t.op.toString()+" {"+t.getFilters().map(dI).join(" ,")+"}"}(r):"Filter"}class TL extends Da{constructor(e,t,a){super(e,t,a),this.key=_n.fromName(a.referenceValue)}matches(e){const t=_n.comparator(e.key,this.key);return this.matchesComparison(t)}}class SL extends Da{constructor(e,t){super(e,"in",t),this.keys=fI("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class EL extends Da{constructor(e,t){super(e,"not-in",t),this.keys=fI("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function fI(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(a=>_n.fromName(a.referenceValue))}class AL extends Da{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return tw(t)&&u_(t.arrayValue,this.value)}}class IL extends Da{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&u_(this.value.arrayValue,t)}}class CL extends Da{constructor(e,t){super(e,"not-in",t)}matches(e){if(u_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!u_(this.value.arrayValue,t)}}class PL extends Da{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!tw(t)||!t.arrayValue.values)&&t.arrayValue.values.some(a=>u_(this.value.arrayValue,a))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e,t=null,a=[],d=[],m=null,y=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=d,this.limit=m,this.startAt=y,this.endAt=c,this.Ie=null}}function PT(r,e=null,t=[],a=[],d=null,m=null,y=null){return new ML(r,e,t,a,d,m,y)}function nw(r){const e=Vn(r);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(a=>Vx(a)).join(","),t+="|ob:",t+=e.orderBy.map(a=>function(m){return m.field.canonicalString()+m.dir}(a)).join(","),G0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(a=>sg(a)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(a=>sg(a)).join(",")),e.Ie=t}return e.Ie}function rw(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!xL(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!hI(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!CT(r.startAt,e.startAt)&&CT(r.endAt,e.endAt)}function Fx(r){return _n.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,t=null,a=[],d=[],m=null,y="F",c=null,P=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=d,this.limit=m,this.limitType=y,this.startAt=c,this.endAt=P,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function RL(r,e,t,a,d,m,y,c){return new vg(r,e,t,a,d,m,y,c)}function iw(r){return new vg(r)}function MT(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function pI(r){return r.collectionGroup!==null}function Zy(r){const e=Vn(r);if(e.Ee===null){e.Ee=[];const t=new Set;for(const m of e.explicitOrderBy)e.Ee.push(m),t.add(m.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(y){let c=new Ka(Ps.comparator);return y.filters.forEach(P=>{P.getFlattenedFilters().forEach(k=>{k.isInequality()&&(c=c.add(k.field))})}),c})(e).forEach(m=>{t.has(m.canonicalString())||m.isKeyField()||e.Ee.push(new c_(m,a))}),t.has(Ps.keyField().canonicalString())||e.Ee.push(new c_(Ps.keyField(),a))}return e.Ee}function ih(r){const e=Vn(r);return e.de||(e.de=kL(e,Zy(r))),e.de}function kL(r,e){if(r.limitType==="F")return PT(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(d=>{const m=d.dir==="desc"?"asc":"desc";return new c_(d.field,m)});const t=r.endAt?new y0(r.endAt.position,r.endAt.inclusive):null,a=r.startAt?new y0(r.startAt.position,r.startAt.inclusive):null;return PT(r.path,r.collectionGroup,e,r.filters,r.limit,t,a)}}function Ux(r,e){const t=r.filters.concat([e]);return new vg(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function jx(r,e,t){return new vg(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Z0(r,e){return rw(ih(r),ih(e))&&r.limitType===e.limitType}function mI(r){return`${nw(ih(r))}|lt:${r.limitType}`}function Om(r){return`Query(target=${function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map(d=>dI(d)).join(", ")}]`),G0(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map(d=>function(y){return`${y.field.canonicalString()} (${y.dir})`}(d)).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map(d=>sg(d)).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map(d=>sg(d)).join(",")),`Target(${a})`}(ih(r))}; limitType=${r.limitType})`}function K0(r,e){return e.isFoundDocument()&&function(a,d){const m=d.key.path;return a.collectionGroup!==null?d.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(m):_n.isDocumentKey(a.path)?a.path.isEqual(m):a.path.isImmediateParentOf(m)}(r,e)&&function(a,d){for(const m of Zy(a))if(!m.field.isKeyField()&&d.data.field(m.field)===null)return!1;return!0}(r,e)&&function(a,d){for(const m of a.filters)if(!m.matches(d))return!1;return!0}(r,e)&&function(a,d){return!(a.startAt&&!function(y,c,P){const k=IT(y,c,P);return y.inclusive?k<=0:k<0}(a.startAt,Zy(a),d)||a.endAt&&!function(y,c,P){const k=IT(y,c,P);return y.inclusive?k>=0:k>0}(a.endAt,Zy(a),d))}(r,e)}function DL(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function gI(r){return(e,t)=>{let a=!1;for(const d of Zy(r)){const m=LL(d,e,t);if(m!==0)return m;a=a||d.field.isKeyField()}return 0}}function LL(r,e,t){const a=r.field.isKeyField()?_n.comparator(e.key,t.key):function(m,y,c){const P=y.data.field(m),k=c.data.field(m);return P!==null&&k!==null?ag(P,k):Pn(42886)}(r.field,e,t);switch(r.dir){case"asc":return a;case"desc":return-1*a;default:return Pn(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[d,m]of a)if(this.equalsFn(d,e))return m}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),d=this.inner[a];if(d===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let m=0;m<d.length;m++)if(this.equalsFn(d[m][0],e))return void(d[m]=[e,t]);d.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let d=0;d<a.length;d++)if(this.equalsFn(a[d][0],e))return a.length===1?delete this.inner[t]:a.splice(d,1),this.innerSize--,!0;return!1}forEach(e){xf(this.inner,(t,a)=>{for(const[d,m]of a)e(d,m)})}isEmpty(){return JA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zL=new ta(_n.comparator);function td(){return zL}const yI=new ta(_n.comparator);function Vy(...r){let e=yI;for(const t of r)e=e.insert(t.key,t);return e}function _I(r){let e=yI;return r.forEach((t,a)=>e=e.insert(t,a.overlayedDocument)),e}function Ep(){return Ky()}function vI(){return Ky()}function Ky(){return new Hp(r=>r.toString(),(r,e)=>r.isEqual(e))}const OL=new ta(_n.comparator),NL=new Ka(_n.comparator);function ur(...r){let e=NL;for(const t of r)e=e.add(t);return e}const BL=new Ka(tr);function VL(){return BL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:p0(e)?"-0":e}}function bI(r){return{integerValue:""+r}}function FL(r,e){return fL(e)?bI(e):aw(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(){this._=void 0}}function UL(r,e,t){return r instanceof _0?function(d,m){const y={fields:{[nI]:{stringValue:tI},[iI]:{timestampValue:{seconds:d.seconds,nanos:d.nanoseconds}}}};return m&&ew(m)&&(m=H0(m)),m&&(y.fields[rI]=m),{mapValue:y}}(t,e):r instanceof h_?wI(r,e):r instanceof d_?TI(r,e):function(d,m){const y=xI(d,m),c=RT(y)+RT(d.Re);return Bx(y)&&Bx(d.Re)?bI(c):aw(d.serializer,c)}(r,e)}function jL(r,e,t){return r instanceof h_?wI(r,e):r instanceof d_?TI(r,e):t}function xI(r,e){return r instanceof v0?function(a){return Bx(a)||function(m){return!!m&&"doubleValue"in m}(a)}(e)?e:{integerValue:0}:null}class _0 extends W0{}class h_ extends W0{constructor(e){super(),this.elements=e}}function wI(r,e){const t=SI(e);for(const a of r.elements)t.some(d=>ch(d,a))||t.push(a);return{arrayValue:{values:t}}}class d_ extends W0{constructor(e){super(),this.elements=e}}function TI(r,e){let t=SI(e);for(const a of r.elements)t=t.filter(d=>!ch(d,a));return{arrayValue:{values:t}}}class v0 extends W0{constructor(e,t){super(),this.serializer=e,this.Re=t}}function RT(r){return ga(r.integerValue||r.doubleValue)}function SI(r){return tw(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function $L(r,e){return r.field.isEqual(e.field)&&function(a,d){return a instanceof h_&&d instanceof h_||a instanceof d_&&d instanceof d_?ig(a.elements,d.elements,ch):a instanceof v0&&d instanceof v0?ch(a.Re,d.Re):a instanceof _0&&d instanceof _0}(r.transform,e.transform)}class qL{constructor(e,t){this.version=e,this.transformResults=t}}class yu{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new yu}static exists(e){return new yu(void 0,e)}static updateTime(e){return new yu(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xv(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class X0{}function EI(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new sw(r.key,yu.none()):new z_(r.key,r.data,yu.none());{const t=r.data,a=tl.empty();let d=new Ka(Ps.comparator);for(let m of e.fields)if(!d.has(m)){let y=t.field(m);y===null&&m.length>1&&(m=m.popLast(),y=t.field(m)),y===null?a.delete(m):a.set(m,y),d=d.add(m)}return new wf(r.key,a,new Pl(d.toArray()),yu.none())}}function GL(r,e,t){r instanceof z_?function(d,m,y){const c=d.value.clone(),P=DT(d.fieldTransforms,m,y.transformResults);c.setAll(P),m.convertToFoundDocument(y.version,c).setHasCommittedMutations()}(r,e,t):r instanceof wf?function(d,m,y){if(!Xv(d.precondition,m))return void m.convertToUnknownDocument(y.version);const c=DT(d.fieldTransforms,m,y.transformResults),P=m.data;P.setAll(AI(d)),P.setAll(c),m.convertToFoundDocument(y.version,P).setHasCommittedMutations()}(r,e,t):function(d,m,y){m.convertToNoDocument(y.version).setHasCommittedMutations()}(0,e,t)}function Wy(r,e,t,a){return r instanceof z_?function(m,y,c,P){if(!Xv(m.precondition,y))return c;const k=m.value.clone(),B=LT(m.fieldTransforms,P,y);return k.setAll(B),y.convertToFoundDocument(y.version,k).setHasLocalMutations(),null}(r,e,t,a):r instanceof wf?function(m,y,c,P){if(!Xv(m.precondition,y))return c;const k=LT(m.fieldTransforms,P,y),B=y.data;return B.setAll(AI(m)),B.setAll(k),y.convertToFoundDocument(y.version,B).setHasLocalMutations(),c===null?null:c.unionWith(m.fieldMask.fields).unionWith(m.fieldTransforms.map(X=>X.field))}(r,e,t,a):function(m,y,c){return Xv(m.precondition,y)?(y.convertToNoDocument(y.version).setHasLocalMutations(),null):c}(r,e,t)}function HL(r,e){let t=null;for(const a of r.fieldTransforms){const d=e.data.field(a.field),m=xI(a.transform,d||null);m!=null&&(t===null&&(t=tl.empty()),t.set(a.field,m))}return t||null}function kT(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(a,d){return a===void 0&&d===void 0||!(!a||!d)&&ig(a,d,(m,y)=>$L(m,y))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class z_ extends X0{constructor(e,t,a,d=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=d,this.type=0}getFieldMask(){return null}}class wf extends X0{constructor(e,t,a,d,m=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=d,this.fieldTransforms=m,this.type=1}getFieldMask(){return this.fieldMask}}function AI(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const a=r.data.field(t);e.set(t,a)}}),e}function DT(r,e,t){const a=new Map;Kr(r.length===t.length,32656,{Ve:t.length,me:r.length});for(let d=0;d<t.length;d++){const m=r[d],y=m.transform,c=e.data.field(m.field);a.set(m.field,jL(y,c,t[d]))}return a}function LT(r,e,t){const a=new Map;for(const d of r){const m=d.transform,y=t.data.field(d.field);a.set(d.field,UL(m,y,e))}return a}class sw extends X0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZL extends X0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL{constructor(e,t,a,d){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=d}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let d=0;d<this.mutations.length;d++){const m=this.mutations[d];m.key.isEqual(e.key)&&GL(m,e,a[d])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Wy(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Wy(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=vI();return this.mutations.forEach(d=>{const m=e.get(d.key),y=m.overlayedDocument;let c=this.applyToLocalView(y,m.mutatedFields);c=t.has(d.key)?null:c;const P=EI(y,c);P!==null&&a.set(d.key,P),y.isValidDocument()||y.convertToNoDocument(Nn.min())}),a}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ur())}isEqual(e){return this.batchId===e.batchId&&ig(this.mutations,e.mutations,(t,a)=>kT(t,a))&&ig(this.baseMutations,e.baseMutations,(t,a)=>kT(t,a))}}class ow{constructor(e,t,a,d){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=d}static from(e,t,a){Kr(e.mutations.length===a.length,58842,{fe:e.mutations.length,ge:a.length});let d=function(){return OL}();const m=e.mutations;for(let y=0;y<m.length;y++)d=d.insert(m[y].key,a[y].version);return new ow(e,t,a,d)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ka,br;function YL(r){switch(r){case Et.OK:return Pn(64938);case Et.CANCELLED:case Et.UNKNOWN:case Et.DEADLINE_EXCEEDED:case Et.RESOURCE_EXHAUSTED:case Et.INTERNAL:case Et.UNAVAILABLE:case Et.UNAUTHENTICATED:return!1;case Et.INVALID_ARGUMENT:case Et.NOT_FOUND:case Et.ALREADY_EXISTS:case Et.PERMISSION_DENIED:case Et.FAILED_PRECONDITION:case Et.ABORTED:case Et.OUT_OF_RANGE:case Et.UNIMPLEMENTED:case Et.DATA_LOSS:return!0;default:return Pn(15467,{code:r})}}function II(r){if(r===void 0)return ed("GRPC error has no .code"),Et.UNKNOWN;switch(r){case ka.OK:return Et.OK;case ka.CANCELLED:return Et.CANCELLED;case ka.UNKNOWN:return Et.UNKNOWN;case ka.DEADLINE_EXCEEDED:return Et.DEADLINE_EXCEEDED;case ka.RESOURCE_EXHAUSTED:return Et.RESOURCE_EXHAUSTED;case ka.INTERNAL:return Et.INTERNAL;case ka.UNAVAILABLE:return Et.UNAVAILABLE;case ka.UNAUTHENTICATED:return Et.UNAUTHENTICATED;case ka.INVALID_ARGUMENT:return Et.INVALID_ARGUMENT;case ka.NOT_FOUND:return Et.NOT_FOUND;case ka.ALREADY_EXISTS:return Et.ALREADY_EXISTS;case ka.PERMISSION_DENIED:return Et.PERMISSION_DENIED;case ka.FAILED_PRECONDITION:return Et.FAILED_PRECONDITION;case ka.ABORTED:return Et.ABORTED;case ka.OUT_OF_RANGE:return Et.OUT_OF_RANGE;case ka.UNIMPLEMENTED:return Et.UNIMPLEMENTED;case ka.DATA_LOSS:return Et.DATA_LOSS;default:return Pn(39323,{code:r})}}(br=ka||(ka={}))[br.OK=0]="OK",br[br.CANCELLED=1]="CANCELLED",br[br.UNKNOWN=2]="UNKNOWN",br[br.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",br[br.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",br[br.NOT_FOUND=5]="NOT_FOUND",br[br.ALREADY_EXISTS=6]="ALREADY_EXISTS",br[br.PERMISSION_DENIED=7]="PERMISSION_DENIED",br[br.UNAUTHENTICATED=16]="UNAUTHENTICATED",br[br.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",br[br.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",br[br.ABORTED=10]="ABORTED",br[br.OUT_OF_RANGE=11]="OUT_OF_RANGE",br[br.UNIMPLEMENTED=12]="UNIMPLEMENTED",br[br.INTERNAL=13]="INTERNAL",br[br.UNAVAILABLE=14]="UNAVAILABLE",br[br.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QL=new lf([4294967295,4294967295],0);function zT(r){const e=XA().encode(r),t=new jA;return t.update(e),new Uint8Array(t.digest())}function OT(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),d=e.getUint32(8,!0),m=e.getUint32(12,!0);return[new lf([t,a],0),new lf([d,m],0)]}class lw{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new Fy(`Invalid padding: ${t}`);if(a<0)throw new Fy(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new Fy(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new Fy(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=lf.fromNumber(this.pe)}we(e,t,a){let d=e.add(t.multiply(lf.fromNumber(a)));return d.compare(QL)===1&&(d=new lf([d.getBits(0),d.getBits(1)],0)),d.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=zT(e),[a,d]=OT(t);for(let m=0;m<this.hashCount;m++){const y=this.we(a,d,m);if(!this.be(y))return!1}return!0}static create(e,t,a){const d=e%8==0?0:8-e%8,m=new Uint8Array(Math.ceil(e/8)),y=new lw(m,d,t);return a.forEach(c=>y.insert(c)),y}insert(e){if(this.pe===0)return;const t=zT(e),[a,d]=OT(t);for(let m=0;m<this.hashCount;m++){const y=this.we(a,d,m);this.Se(y)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class Fy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,t,a,d,m){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=d,this.resolvedLimboDocuments=m}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const d=new Map;return d.set(e,O_.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new Y0(Nn.min(),d,new ta(tr),td(),ur())}}class O_{constructor(e,t,a,d,m){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=d,this.removedDocuments=m}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new O_(a,t,ur(),ur(),ur())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(e,t,a,d){this.De=e,this.removedTargetIds=t,this.key=a,this.ve=d}}class CI{constructor(e,t){this.targetId=e,this.Ce=t}}class PI{constructor(e,t,a=Rs.EMPTY_BYTE_STRING,d=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=d}}class NT{constructor(){this.Fe=0,this.Me=BT(),this.xe=Rs.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=ur(),t=ur(),a=ur();return this.Me.forEach((d,m)=>{switch(m){case 0:e=e.add(d);break;case 2:t=t.add(d);break;case 1:a=a.add(d);break;default:Pn(38017,{changeType:m})}}),new O_(this.xe,this.Oe,e,t,a)}Qe(){this.Ne=!1,this.Me=BT()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Kr(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class JL{constructor(e){this.ze=e,this.je=new Map,this.He=td(),this.Je=Rv(),this.Ye=Rv(),this.Ze=new ta(tr)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const a=this.rt(t);switch(e.state){case 0:this.it(t)&&a.ke(e.resumeToken);break;case 1:a.We(),a.Be||a.Qe(),a.ke(e.resumeToken);break;case 2:a.We(),a.Be||this.removeTarget(t);break;case 3:this.it(t)&&(a.Ge(),a.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),a.ke(e.resumeToken));break;default:Pn(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((a,d)=>{this.it(d)&&t(d)})}ot(e){const t=e.targetId,a=e.Ce.count,d=this._t(t);if(d){const m=d.target;if(Fx(m))if(a===0){const y=new _n(m.path);this.tt(t,y,to.newNoDocument(y,Nn.min()))}else Kr(a===1,20013,{expectedCount:a});else{const y=this.ut(t);if(y!==a){const c=this.ct(e),P=c?this.lt(c,e,y):1;if(P!==0){this.st(t);const k=P===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,k)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:d=0},hashCount:m=0}=t;let y,c;try{y=df(a).toUint8Array()}catch(P){if(P instanceof eI)return rg("Decoding the base64 bloom filter in existence filter failed ("+P.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw P}try{c=new lw(y,d,m)}catch(P){return rg(P instanceof Fy?"BloomFilter error: ":"Applying bloom filter failed: ",P),null}return c.pe===0?null:c}lt(e,t,a){return t.Ce.count===a-this.Tt(e,t.targetId)?0:2}Tt(e,t){const a=this.ze.getRemoteKeysForTarget(t);let d=0;return a.forEach(m=>{const y=this.ze.Pt(),c=`projects/${y.projectId}/databases/${y.database}/documents/${m.path.canonicalString()}`;e.mightContain(c)||(this.tt(t,m,null),d++)}),d}It(e){const t=new Map;this.je.forEach((m,y)=>{const c=this._t(y);if(c){if(m.current&&Fx(c.target)){const P=new _n(c.target.path);this.Et(P).has(y)||this.dt(y,P)||this.tt(y,P,to.newNoDocument(P,e))}m.Le&&(t.set(y,m.qe()),m.Qe())}});let a=ur();this.Ye.forEach((m,y)=>{let c=!0;y.forEachWhile(P=>{const k=this._t(P);return!k||k.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(a=a.add(m))}),this.He.forEach((m,y)=>y.setReadTime(e));const d=new Y0(e,t,this.Ze,this.He,a);return this.He=td(),this.Je=Rv(),this.Ye=Rv(),this.Ze=new ta(tr),d}et(e,t){if(!this.it(e))return;const a=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,a),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,a){if(!this.it(e))return;const d=this.rt(e);this.dt(e,t)?d.$e(t,1):d.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),a&&(this.He=this.He.insert(t,a))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new NT,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Ka(tr),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Ka(tr),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||Wt("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new NT),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Rv(){return new ta(_n.comparator)}function BT(){return new ta(_n.comparator)}const ez={asc:"ASCENDING",desc:"DESCENDING"},tz={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nz={and:"AND",or:"OR"};class rz{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $x(r,e){return r.useProto3Json||G0(e)?e:{value:e}}function b0(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function MI(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function iz(r,e){return b0(r,e.toTimestamp())}function ah(r){return Kr(!!r,49232),Nn.fromTimestamp(function(t){const a=hf(t);return new Za(a.seconds,a.nanos)}(r))}function uw(r,e){return qx(r,e).canonicalString()}function qx(r,e){const t=function(d){return new Pi(["projects",d.projectId,"databases",d.database])}(r).child("documents");return e===void 0?t:t.child(e)}function RI(r){const e=Pi.fromString(r);return Kr(OI(e),10190,{key:e.toString()}),e}function Gx(r,e){return uw(r.databaseId,e.path)}function ex(r,e){const t=RI(e);if(t.get(1)!==r.databaseId.projectId)throw new Xt(Et.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Xt(Et.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new _n(DI(t))}function kI(r,e){return uw(r.databaseId,e)}function az(r){const e=RI(r);return e.length===4?Pi.emptyPath():DI(e)}function Hx(r){return new Pi(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function DI(r){return Kr(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function VT(r,e,t){return{name:Gx(r,e),fields:t.value.mapValue.fields}}function sz(r,e){let t;if("targetChange"in e){e.targetChange;const a=function(k){return k==="NO_CHANGE"?0:k==="ADD"?1:k==="REMOVE"?2:k==="CURRENT"?3:k==="RESET"?4:Pn(39313,{state:k})}(e.targetChange.targetChangeType||"NO_CHANGE"),d=e.targetChange.targetIds||[],m=function(k,B){return k.useProto3Json?(Kr(B===void 0||typeof B=="string",58123),Rs.fromBase64String(B||"")):(Kr(B===void 0||B instanceof Buffer||B instanceof Uint8Array,16193),Rs.fromUint8Array(B||new Uint8Array))}(r,e.targetChange.resumeToken),y=e.targetChange.cause,c=y&&function(k){const B=k.code===void 0?Et.UNKNOWN:II(k.code);return new Xt(B,k.message||"")}(y);t=new PI(a,d,m,c||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const d=ex(r,a.document.name),m=ah(a.document.updateTime),y=a.document.createTime?ah(a.document.createTime):Nn.min(),c=new tl({mapValue:{fields:a.document.fields}}),P=to.newFoundDocument(d,m,y,c),k=a.targetIds||[],B=a.removedTargetIds||[];t=new Yv(k,B,P.key,P)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const d=ex(r,a.document),m=a.readTime?ah(a.readTime):Nn.min(),y=to.newNoDocument(d,m),c=a.removedTargetIds||[];t=new Yv([],c,y.key,y)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const d=ex(r,a.document),m=a.removedTargetIds||[];t=new Yv([],m,d,null)}else{if(!("filter"in e))return Pn(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:d=0,unchangedNames:m}=a,y=new XL(d,m),c=a.targetId;t=new CI(c,y)}}return t}function oz(r,e){let t;if(e instanceof z_)t={update:VT(r,e.key,e.value)};else if(e instanceof sw)t={delete:Gx(r,e.key)};else if(e instanceof wf)t={update:VT(r,e.key,e.data),updateMask:gz(e.fieldMask)};else{if(!(e instanceof ZL))return Pn(16599,{ft:e.type});t={verify:Gx(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(a=>function(m,y){const c=y.transform;if(c instanceof _0)return{fieldPath:y.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof h_)return{fieldPath:y.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof d_)return{fieldPath:y.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof v0)return{fieldPath:y.field.canonicalString(),increment:c.Re};throw Pn(20930,{transform:y.transform})}(0,a))),e.precondition.isNone||(t.currentDocument=function(d,m){return m.updateTime!==void 0?{updateTime:iz(d,m.updateTime)}:m.exists!==void 0?{exists:m.exists}:Pn(27497)}(r,e.precondition)),t}function lz(r,e){return r&&r.length>0?(Kr(e!==void 0,14353),r.map(t=>function(d,m){let y=d.updateTime?ah(d.updateTime):ah(m);return y.isEqual(Nn.min())&&(y=ah(m)),new qL(y,d.transformResults||[])}(t,e))):[]}function uz(r,e){return{documents:[kI(r,e.path)]}}function cz(r,e){const t={structuredQuery:{}},a=e.path;let d;e.collectionGroup!==null?(d=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(d=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=kI(r,d);const m=function(k){if(k.length!==0)return zI(pc.create(k,"and"))}(e.filters);m&&(t.structuredQuery.where=m);const y=function(k){if(k.length!==0)return k.map(B=>function(G){return{field:Nm(G.field),direction:fz(G.dir)}}(B))}(e.orderBy);y&&(t.structuredQuery.orderBy=y);const c=$x(r,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(k){return{before:k.inclusive,values:k.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(k){return{before:!k.inclusive,values:k.position}}(e.endAt)),{gt:t,parent:d}}function hz(r){let e=az(r.parent);const t=r.structuredQuery,a=t.from?t.from.length:0;let d=null;if(a>0){Kr(a===1,65062);const B=t.from[0];B.allDescendants?d=B.collectionId:e=e.child(B.collectionId)}let m=[];t.where&&(m=function(X){const G=LI(X);return G instanceof pc&&cI(G)?G.getFilters():[G]}(t.where));let y=[];t.orderBy&&(y=function(X){return X.map(G=>function(ie){return new c_(Bm(ie.field),function(Re){switch(Re){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(ie.direction))}(G))}(t.orderBy));let c=null;t.limit&&(c=function(X){let G;return G=typeof X=="object"?X.value:X,G0(G)?null:G}(t.limit));let P=null;t.startAt&&(P=function(X){const G=!!X.before,W=X.values||[];return new y0(W,G)}(t.startAt));let k=null;return t.endAt&&(k=function(X){const G=!X.before,W=X.values||[];return new y0(W,G)}(t.endAt)),RL(e,d,y,m,c,"F",P,k)}function dz(r,e){const t=function(d){switch(d){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pn(28987,{purpose:d})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function LI(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=Bm(t.unaryFilter.field);return Da.create(a,"==",{doubleValue:NaN});case"IS_NULL":const d=Bm(t.unaryFilter.field);return Da.create(d,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const m=Bm(t.unaryFilter.field);return Da.create(m,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const y=Bm(t.unaryFilter.field);return Da.create(y,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pn(61313);default:return Pn(60726)}}(r):r.fieldFilter!==void 0?function(t){return Da.create(Bm(t.fieldFilter.field),function(d){switch(d){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pn(58110);default:return Pn(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return pc.create(t.compositeFilter.filters.map(a=>LI(a)),function(d){switch(d){case"AND":return"and";case"OR":return"or";default:return Pn(1026)}}(t.compositeFilter.op))}(r):Pn(30097,{filter:r})}function fz(r){return ez[r]}function pz(r){return tz[r]}function mz(r){return nz[r]}function Nm(r){return{fieldPath:r.canonicalString()}}function Bm(r){return Ps.fromServerFormat(r.fieldPath)}function zI(r){return r instanceof Da?function(t){if(t.op==="=="){if(AT(t.value))return{unaryFilter:{field:Nm(t.field),op:"IS_NAN"}};if(ET(t.value))return{unaryFilter:{field:Nm(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(AT(t.value))return{unaryFilter:{field:Nm(t.field),op:"IS_NOT_NAN"}};if(ET(t.value))return{unaryFilter:{field:Nm(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nm(t.field),op:pz(t.op),value:t.value}}}(r):r instanceof pc?function(t){const a=t.getFilters().map(d=>zI(d));return a.length===1?a[0]:{compositeFilter:{op:mz(t.op),filters:a}}}(r):Pn(54877,{filter:r})}function gz(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function OI(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t,a,d,m=Nn.min(),y=Nn.min(),c=Rs.EMPTY_BYTE_STRING,P=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=d,this.snapshotVersion=m,this.lastLimboFreeSnapshotVersion=y,this.resumeToken=c,this.expectedCount=P}withSequenceNumber(e){return new nf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new nf(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new nf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new nf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yz{constructor(e){this.wt=e}}function _z(r){const e=hz({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?jx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vz{constructor(){this.Cn=new bz}addToCollectionParentIndex(e,t){return this.Cn.add(t),At.resolve()}getCollectionParents(e,t){return At.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return At.resolve()}deleteFieldIndex(e,t){return At.resolve()}deleteAllFieldIndexes(e){return At.resolve()}createTargetIndexes(e,t){return At.resolve()}getDocumentsMatchingTarget(e,t){return At.resolve(null)}getIndexType(e,t){return At.resolve(0)}getFieldIndexes(e,t){return At.resolve([])}getNextCollectionGroupToUpdate(e){return At.resolve(null)}getMinOffset(e,t){return At.resolve(cf.min())}getMinOffsetFromCollectionGroup(e,t){return At.resolve(cf.min())}updateCollectionGroup(e,t,a){return At.resolve()}updateIndexEntries(e,t){return At.resolve()}}class bz{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),d=this.index[t]||new Ka(Pi.comparator),m=!d.has(a);return this.index[t]=d.add(a),m}has(e){const t=e.lastSegment(),a=e.popLast(),d=this.index[t];return d&&d.has(a)}getEntries(e){return(this.index[e]||new Ka(Pi.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},NI=41943040;class el{static withCacheSize(e){return new el(e,el.DEFAULT_COLLECTION_PERCENTILE,el.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */el.DEFAULT_COLLECTION_PERCENTILE=10,el.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,el.DEFAULT=new el(NI,el.DEFAULT_COLLECTION_PERCENTILE,el.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),el.DISABLED=new el(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new og(0)}static lr(){return new og(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UT="LruGarbageCollector",xz=1048576;function jT([r,e],[t,a]){const d=tr(r,t);return d===0?tr(e,a):d}class wz{constructor(e){this.Er=e,this.buffer=new Ka(jT),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();jT(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Tz{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Wt(UT,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){_g(t)?Wt(UT,"Ignoring IndexedDB error during garbage collection: ",t):await yg(t)}await this.mr(3e5)})}}class Sz{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(a=>Math.floor(t/100*a))}nthSequenceNumber(e,t){if(t===0)return At.resolve(q0.le);const a=new wz(t);return this.gr.forEachTarget(e,d=>a.Rr(d.sequenceNumber)).next(()=>this.gr.yr(e,d=>a.Rr(d))).next(()=>a.maxValue)}removeTargets(e,t,a){return this.gr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Wt("LruGarbageCollector","Garbage collection skipped; disabled"),At.resolve(FT)):this.getCacheSize(e).next(a=>a<this.params.cacheSizeCollectionThreshold?(Wt("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),FT):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let a,d,m,y,c,P,k;const B=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(X=>(X>this.params.maximumSequenceNumbersToCollect?(Wt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${X}`),d=this.params.maximumSequenceNumbersToCollect):d=X,y=Date.now(),this.nthSequenceNumber(e,d))).next(X=>(a=X,c=Date.now(),this.removeTargets(e,a,t))).next(X=>(m=X,P=Date.now(),this.removeOrphanedDocuments(e,a))).next(X=>(k=Date.now(),zm()<=lr.DEBUG&&Wt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${y-B}ms
	Determined least recently used ${d} in `+(c-y)+`ms
	Removed ${m} targets in `+(P-c)+`ms
	Removed ${X} documents in `+(k-P)+`ms
Total Duration: ${k-B}ms`),At.resolve({didRun:!0,sequenceNumbersCollected:d,targetsRemoved:m,documentsRemoved:X})))}}function Ez(r,e){return new Sz(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Az{constructor(){this.changes=new Hp(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,to.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?At.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iz{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cz{constructor(e,t,a,d){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=d}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next(d=>(a=d,this.remoteDocumentCache.getEntry(e,t))).next(d=>(a!==null&&Wy(a.mutation,d,Pl.empty(),Za.now()),d))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.getLocalViewOfDocuments(e,a,ur()).next(()=>a))}getLocalViewOfDocuments(e,t,a=ur()){const d=Ep();return this.populateOverlays(e,d,t).next(()=>this.computeViews(e,t,d,a).next(m=>{let y=Vy();return m.forEach((c,P)=>{y=y.insert(c,P.overlayedDocument)}),y}))}getOverlayedDocuments(e,t){const a=Ep();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,ur()))}populateOverlays(e,t,a){const d=[];return a.forEach(m=>{t.has(m)||d.push(m)}),this.documentOverlayCache.getOverlays(e,d).next(m=>{m.forEach((y,c)=>{t.set(y,c)})})}computeViews(e,t,a,d){let m=td();const y=Ky(),c=function(){return Ky()}();return t.forEach((P,k)=>{const B=a.get(k.key);d.has(k.key)&&(B===void 0||B.mutation instanceof wf)?m=m.insert(k.key,k):B!==void 0?(y.set(k.key,B.mutation.getFieldMask()),Wy(B.mutation,k,B.mutation.getFieldMask(),Za.now())):y.set(k.key,Pl.empty())}),this.recalculateAndSaveOverlays(e,m).next(P=>(P.forEach((k,B)=>y.set(k,B)),t.forEach((k,B)=>{var X;return c.set(k,new Iz(B,(X=y.get(k))!==null&&X!==void 0?X:null))}),c))}recalculateAndSaveOverlays(e,t){const a=Ky();let d=new ta((y,c)=>y-c),m=ur();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(y=>{for(const c of y)c.keys().forEach(P=>{const k=t.get(P);if(k===null)return;let B=a.get(P)||Pl.empty();B=c.applyToLocalView(k,B),a.set(P,B);const X=(d.get(c.batchId)||ur()).add(P);d=d.insert(c.batchId,X)})}).next(()=>{const y=[],c=d.getReverseIterator();for(;c.hasNext();){const P=c.getNext(),k=P.key,B=P.value,X=vI();B.forEach(G=>{if(!m.has(G)){const W=EI(t.get(G),a.get(G));W!==null&&X.set(G,W),m=m.add(G)}}),y.push(this.documentOverlayCache.saveOverlays(e,k,X))}return At.waitFor(y)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.recalculateAndSaveOverlays(e,a))}getDocumentsMatchingQuery(e,t,a,d){return function(y){return _n.isDocumentKey(y.path)&&y.collectionGroup===null&&y.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):pI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,d):this.getDocumentsMatchingCollectionQuery(e,t,a,d)}getNextDocuments(e,t,a,d){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,d).next(m=>{const y=d-m.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,d-m.size):At.resolve(Ep());let c=s_,P=m;return y.next(k=>At.forEach(k,(B,X)=>(c<X.largestBatchId&&(c=X.largestBatchId),m.get(B)?At.resolve():this.remoteDocumentCache.getEntry(e,B).next(G=>{P=P.insert(B,G)}))).next(()=>this.populateOverlays(e,k,m)).next(()=>this.computeViews(e,P,k,ur())).next(B=>({batchId:c,changes:_I(B)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _n(t)).next(a=>{let d=Vy();return a.isFoundDocument()&&(d=d.insert(a.key,a)),d})}getDocumentsMatchingCollectionGroupQuery(e,t,a,d){const m=t.collectionGroup;let y=Vy();return this.indexManager.getCollectionParents(e,m).next(c=>At.forEach(c,P=>{const k=function(X,G){return new vg(G,null,X.explicitOrderBy.slice(),X.filters.slice(),X.limit,X.limitType,X.startAt,X.endAt)}(t,P.child(m));return this.getDocumentsMatchingCollectionQuery(e,k,a,d).next(B=>{B.forEach((X,G)=>{y=y.insert(X,G)})})}).next(()=>y))}getDocumentsMatchingCollectionQuery(e,t,a,d){let m;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next(y=>(m=y,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,m,d))).next(y=>{m.forEach((P,k)=>{const B=k.getKey();y.get(B)===null&&(y=y.insert(B,to.newInvalidDocument(B)))});let c=Vy();return y.forEach((P,k)=>{const B=m.get(P);B!==void 0&&Wy(B.mutation,k,Pl.empty(),Za.now()),K0(t,k)&&(c=c.insert(P,k))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pz{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return At.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(d){return{id:d.id,version:d.version,createTime:ah(d.createTime)}}(t)),At.resolve()}getNamedQuery(e,t){return At.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(d){return{name:d.name,query:_z(d.bundledQuery),readTime:ah(d.readTime)}}(t)),At.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mz{constructor(){this.overlays=new ta(_n.comparator),this.Qr=new Map}getOverlay(e,t){return At.resolve(this.overlays.get(t))}getOverlays(e,t){const a=Ep();return At.forEach(t,d=>this.getOverlay(e,d).next(m=>{m!==null&&a.set(d,m)})).next(()=>a)}saveOverlays(e,t,a){return a.forEach((d,m)=>{this.St(e,t,m)}),At.resolve()}removeOverlaysForBatchId(e,t,a){const d=this.Qr.get(a);return d!==void 0&&(d.forEach(m=>this.overlays=this.overlays.remove(m)),this.Qr.delete(a)),At.resolve()}getOverlaysForCollection(e,t,a){const d=Ep(),m=t.length+1,y=new _n(t.child("")),c=this.overlays.getIteratorFrom(y);for(;c.hasNext();){const P=c.getNext().value,k=P.getKey();if(!t.isPrefixOf(k.path))break;k.path.length===m&&P.largestBatchId>a&&d.set(P.getKey(),P)}return At.resolve(d)}getOverlaysForCollectionGroup(e,t,a,d){let m=new ta((k,B)=>k-B);const y=this.overlays.getIterator();for(;y.hasNext();){const k=y.getNext().value;if(k.getKey().getCollectionGroup()===t&&k.largestBatchId>a){let B=m.get(k.largestBatchId);B===null&&(B=Ep(),m=m.insert(k.largestBatchId,B)),B.set(k.getKey(),k)}}const c=Ep(),P=m.getIterator();for(;P.hasNext()&&(P.getNext().value.forEach((k,B)=>c.set(k,B)),!(c.size()>=d)););return At.resolve(c)}St(e,t,a){const d=this.overlays.get(a.key);if(d!==null){const y=this.Qr.get(d.largestBatchId).delete(a.key);this.Qr.set(d.largestBatchId,y)}this.overlays=this.overlays.insert(a.key,new WL(t,a));let m=this.Qr.get(t);m===void 0&&(m=ur(),this.Qr.set(t,m)),this.Qr.set(t,m.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rz{constructor(){this.sessionToken=Rs.EMPTY_BYTE_STRING}getSessionToken(e){return At.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,At.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(){this.$r=new Ka(ss.Ur),this.Kr=new Ka(ss.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const a=new ss(e,t);this.$r=this.$r.add(a),this.Kr=this.Kr.add(a)}Gr(e,t){e.forEach(a=>this.addReference(a,t))}removeReference(e,t){this.zr(new ss(e,t))}jr(e,t){e.forEach(a=>this.removeReference(a,t))}Hr(e){const t=new _n(new Pi([])),a=new ss(t,e),d=new ss(t,e+1),m=[];return this.Kr.forEachInRange([a,d],y=>{this.zr(y),m.push(y.key)}),m}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new _n(new Pi([])),a=new ss(t,e),d=new ss(t,e+1);let m=ur();return this.Kr.forEachInRange([a,d],y=>{m=m.add(y.key)}),m}containsKey(e){const t=new ss(e,0),a=this.$r.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class ss{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return _n.comparator(e.key,t.key)||tr(e.Zr,t.Zr)}static Wr(e,t){return tr(e.Zr,t.Zr)||_n.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kz{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Ka(ss.Ur)}checkEmpty(e){return At.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,d){const m=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const y=new KL(m,t,a,d);this.mutationQueue.push(y);for(const c of d)this.Xr=this.Xr.add(new ss(c.key,m)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return At.resolve(y)}lookupMutationBatch(e,t){return At.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,d=this.ti(a),m=d<0?0:d;return At.resolve(this.mutationQueue.length>m?this.mutationQueue[m]:null)}getHighestUnacknowledgedBatchId(){return At.resolve(this.mutationQueue.length===0?J1:this.nr-1)}getAllMutationBatches(e){return At.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new ss(t,0),d=new ss(t,Number.POSITIVE_INFINITY),m=[];return this.Xr.forEachInRange([a,d],y=>{const c=this.ei(y.Zr);m.push(c)}),At.resolve(m)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Ka(tr);return t.forEach(d=>{const m=new ss(d,0),y=new ss(d,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([m,y],c=>{a=a.add(c.Zr)})}),At.resolve(this.ni(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,d=a.length+1;let m=a;_n.isDocumentKey(m)||(m=m.child(""));const y=new ss(new _n(m),0);let c=new Ka(tr);return this.Xr.forEachWhile(P=>{const k=P.key.path;return!!a.isPrefixOf(k)&&(k.length===d&&(c=c.add(P.Zr)),!0)},y),At.resolve(this.ni(c))}ni(e){const t=[];return e.forEach(a=>{const d=this.ei(a);d!==null&&t.push(d)}),t}removeMutationBatch(e,t){Kr(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Xr;return At.forEach(t.mutations,d=>{const m=new ss(d.key,t.batchId);return a=a.delete(m),this.referenceDelegate.markPotentiallyOrphaned(e,d.key)}).next(()=>{this.Xr=a})}sr(e){}containsKey(e,t){const a=new ss(t,0),d=this.Xr.firstAfterOrEqual(a);return At.resolve(t.isEqual(d&&d.key))}performConsistencyCheck(e){return this.mutationQueue.length,At.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dz{constructor(e){this.ii=e,this.docs=function(){return new ta(_n.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,d=this.docs.get(a),m=d?d.size:0,y=this.ii(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:y}),this.size+=y-m,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return At.resolve(a?a.document.mutableCopy():to.newInvalidDocument(t))}getEntries(e,t){let a=td();return t.forEach(d=>{const m=this.docs.get(d);a=a.insert(d,m?m.document.mutableCopy():to.newInvalidDocument(d))}),At.resolve(a)}getDocumentsMatchingQuery(e,t,a,d){let m=td();const y=t.path,c=new _n(y.child("__id-9223372036854775808__")),P=this.docs.getIteratorFrom(c);for(;P.hasNext();){const{key:k,value:{document:B}}=P.getNext();if(!y.isPrefixOf(k.path))break;k.path.length>y.length+1||uL(lL(B),a)<=0||(d.has(B.key)||K0(t,B))&&(m=m.insert(B.key,B.mutableCopy()))}return At.resolve(m)}getAllFromCollectionGroup(e,t,a,d){Pn(9500)}si(e,t){return At.forEach(this.docs,a=>t(a))}newChangeBuffer(e){return new Lz(this)}getSize(e){return At.resolve(this.size)}}class Lz extends Az{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((a,d)=>{d.isValidDocument()?t.push(this.Br.addEntry(e,d)):this.Br.removeEntry(a)}),At.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zz{constructor(e){this.persistence=e,this.oi=new Hp(t=>nw(t),rw),this.lastRemoteSnapshotVersion=Nn.min(),this.highestTargetId=0,this._i=0,this.ai=new cw,this.targetCount=0,this.ui=og.cr()}forEachTarget(e,t){return this.oi.forEach((a,d)=>t(d)),At.resolve()}getLastRemoteSnapshotVersion(e){return At.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return At.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),At.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this._i&&(this._i=t),At.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new og(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,At.resolve()}updateTargetData(e,t){return this.Tr(t),At.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,At.resolve()}removeTargets(e,t,a){let d=0;const m=[];return this.oi.forEach((y,c)=>{c.sequenceNumber<=t&&a.get(c.targetId)===null&&(this.oi.delete(y),m.push(this.removeMatchingKeysForTargetId(e,c.targetId)),d++)}),At.waitFor(m).next(()=>d)}getTargetCount(e){return At.resolve(this.targetCount)}getTargetData(e,t){const a=this.oi.get(t)||null;return At.resolve(a)}addMatchingKeys(e,t,a){return this.ai.Gr(t,a),At.resolve()}removeMatchingKeys(e,t,a){this.ai.jr(t,a);const d=this.persistence.referenceDelegate,m=[];return d&&t.forEach(y=>{m.push(d.markPotentiallyOrphaned(e,y))}),At.waitFor(m)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),At.resolve()}getMatchingKeysForTargetId(e,t){const a=this.ai.Yr(t);return At.resolve(a)}containsKey(e,t){return At.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e,t){this.ci={},this.overlays={},this.li=new q0(0),this.hi=!1,this.hi=!0,this.Pi=new Rz,this.referenceDelegate=e(this),this.Ti=new zz(this),this.indexManager=new vz,this.remoteDocumentCache=function(d){return new Dz(d)}(a=>this.referenceDelegate.Ii(a)),this.serializer=new yz(t),this.Ei=new Pz(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Mz,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ci[e.toKey()];return a||(a=new kz(t,this.referenceDelegate),this.ci[e.toKey()]=a),a}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,a){Wt("MemoryPersistence","Starting transaction:",e);const d=new Oz(this.li.next());return this.referenceDelegate.di(),a(d).next(m=>this.referenceDelegate.Ai(d).next(()=>m)).toPromise().then(m=>(d.raiseOnCommittedEvent(),m))}Ri(e,t){return At.or(Object.values(this.ci).map(a=>()=>a.containsKey(e,t)))}}class Oz extends hL{constructor(e){super(),this.currentSequenceNumber=e}}class hw{constructor(e){this.persistence=e,this.Vi=new cw,this.mi=null}static fi(e){return new hw(e)}get gi(){if(this.mi)return this.mi;throw Pn(60996)}addReference(e,t,a){return this.Vi.addReference(a,t),this.gi.delete(a.toString()),At.resolve()}removeReference(e,t,a){return this.Vi.removeReference(a,t),this.gi.add(a.toString()),At.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),At.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(d=>this.gi.add(d.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next(d=>{d.forEach(m=>this.gi.add(m.toString()))}).next(()=>a.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return At.forEach(this.gi,a=>{const d=_n.fromPath(a);return this.pi(e,d).next(m=>{m||t.removeEntry(d,Nn.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(a=>{a?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return At.or([()=>At.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class x0{constructor(e,t){this.persistence=e,this.yi=new Hp(a=>pL(a.path),(a,d)=>a.isEqual(d)),this.garbageCollector=Ez(this,t)}static fi(e,t){return new x0(e,t)}di(){}Ai(e){return At.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(a=>t.next(d=>a+d))}br(e){let t=0;return this.yr(e,a=>{t++}).next(()=>t)}yr(e,t){return At.forEach(this.yi,(a,d)=>this.Dr(e,a,d).next(m=>m?At.resolve():t(d)))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const d=this.persistence.getRemoteDocumentCache(),m=d.newChangeBuffer();return d.si(e,y=>this.Dr(e,y,t).next(c=>{c||(a++,m.removeEntry(y,Nn.min()))})).next(()=>m.apply(e)).next(()=>a)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),At.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),At.resolve()}removeReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),At.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),At.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Kv(e.data.value)),t}Dr(e,t,a){return At.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const d=this.yi.get(t);return At.resolve(d!==void 0&&d>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e,t,a,d){this.targetId=e,this.fromCache=t,this.ds=a,this.As=d}static Rs(e,t){let a=ur(),d=ur();for(const m of t.docChanges)switch(m.type){case 0:a=a.add(m.doc.key);break;case 1:d=d.add(m.doc.key)}return new dw(e,t.fromCache,a,d)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nz{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return vk()?8:dL(no())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,a,d){const m={result:null};return this.ws(e,t).next(y=>{m.result=y}).next(()=>{if(!m.result)return this.bs(e,t,d,a).next(y=>{m.result=y})}).next(()=>{if(m.result)return;const y=new Nz;return this.Ss(e,t,y).next(c=>{if(m.result=c,this.fs)return this.Ds(e,t,y,c.size)})}).next(()=>m.result)}Ds(e,t,a,d){return a.documentReadCount<this.gs?(zm()<=lr.DEBUG&&Wt("QueryEngine","SDK will not create cache indexes for query:",Om(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),At.resolve()):(zm()<=lr.DEBUG&&Wt("QueryEngine","Query:",Om(t),"scans",a.documentReadCount,"local documents and returns",d,"documents as results."),a.documentReadCount>this.ps*d?(zm()<=lr.DEBUG&&Wt("QueryEngine","The SDK decides to create cache indexes for query:",Om(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ih(t))):At.resolve())}ws(e,t){if(MT(t))return At.resolve(null);let a=ih(t);return this.indexManager.getIndexType(e,a).next(d=>d===0?null:(t.limit!==null&&d===1&&(t=jx(t,null,"F"),a=ih(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next(m=>{const y=ur(...m);return this.ys.getDocuments(e,y).next(c=>this.indexManager.getMinOffset(e,a).next(P=>{const k=this.vs(t,c);return this.Cs(t,k,y,P.readTime)?this.ws(e,jx(t,null,"F")):this.Fs(e,k,t,P)}))})))}bs(e,t,a,d){return MT(t)||d.isEqual(Nn.min())?At.resolve(null):this.ys.getDocuments(e,a).next(m=>{const y=this.vs(t,m);return this.Cs(t,y,a,d)?At.resolve(null):(zm()<=lr.DEBUG&&Wt("QueryEngine","Re-using previous result from %s to execute query: %s",d.toString(),Om(t)),this.Fs(e,y,t,oL(d,s_)).next(c=>c))})}vs(e,t){let a=new Ka(gI(e));return t.forEach((d,m)=>{K0(e,m)&&(a=a.add(m))}),a}Cs(e,t,a,d){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const m=e.limitType==="F"?t.last():t.first();return!!m&&(m.hasPendingWrites||m.version.compareTo(d)>0)}Ss(e,t,a){return zm()<=lr.DEBUG&&Wt("QueryEngine","Using full collection scan to execute query:",Om(t)),this.ys.getDocumentsMatchingQuery(e,t,cf.min(),a)}Fs(e,t,a,d){return this.ys.getDocumentsMatchingQuery(e,a,d).next(m=>(t.forEach(y=>{m=m.insert(y.key,y)}),m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw="LocalStore",Vz=3e8;class Fz{constructor(e,t,a,d){this.persistence=e,this.Ms=t,this.serializer=d,this.xs=new ta(tr),this.Os=new Hp(m=>nw(m),rw),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(a)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Cz(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function Uz(r,e,t,a){return new Fz(r,e,t,a)}async function VI(r,e){const t=Vn(r);return await t.persistence.runTransaction("Handle user change","readonly",a=>{let d;return t.mutationQueue.getAllMutationBatches(a).next(m=>(d=m,t.Ls(e),t.mutationQueue.getAllMutationBatches(a))).next(m=>{const y=[],c=[];let P=ur();for(const k of d){y.push(k.batchId);for(const B of k.mutations)P=P.add(B.key)}for(const k of m){c.push(k.batchId);for(const B of k.mutations)P=P.add(B.key)}return t.localDocuments.getDocuments(a,P).next(k=>({ks:k,removedBatchIds:y,addedBatchIds:c}))})})}function jz(r,e){const t=Vn(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const d=e.batch.keys(),m=t.Bs.newChangeBuffer({trackRemovals:!0});return function(c,P,k,B){const X=k.batch,G=X.keys();let W=At.resolve();return G.forEach(ie=>{W=W.next(()=>B.getEntry(P,ie)).next(Ie=>{const Re=k.docVersions.get(ie);Kr(Re!==null,48541),Ie.version.compareTo(Re)<0&&(X.applyToRemoteDocument(Ie,k),Ie.isValidDocument()&&(Ie.setReadTime(k.commitVersion),B.addEntry(Ie)))})}),W.next(()=>c.mutationQueue.removeMutationBatch(P,X))}(t,a,e,m).next(()=>m.apply(a)).next(()=>t.mutationQueue.performConsistencyCheck(a)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(a,d,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(c){let P=ur();for(let k=0;k<c.mutationResults.length;++k)c.mutationResults[k].transformResults.length>0&&(P=P.add(c.batch.mutations[k].key));return P}(e))).next(()=>t.localDocuments.getDocuments(a,d))})}function FI(r){const e=Vn(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function $z(r,e){const t=Vn(r),a=e.snapshotVersion;let d=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",m=>{const y=t.Bs.newChangeBuffer({trackRemovals:!0});d=t.xs;const c=[];e.targetChanges.forEach((B,X)=>{const G=d.get(X);if(!G)return;c.push(t.Ti.removeMatchingKeys(m,B.removedDocuments,X).next(()=>t.Ti.addMatchingKeys(m,B.addedDocuments,X)));let W=G.withSequenceNumber(m.currentSequenceNumber);e.targetMismatches.get(X)!==null?W=W.withResumeToken(Rs.EMPTY_BYTE_STRING,Nn.min()).withLastLimboFreeSnapshotVersion(Nn.min()):B.resumeToken.approximateByteSize()>0&&(W=W.withResumeToken(B.resumeToken,a)),d=d.insert(X,W),function(Ie,Re,Oe){return Ie.resumeToken.approximateByteSize()===0||Re.snapshotVersion.toMicroseconds()-Ie.snapshotVersion.toMicroseconds()>=Vz?!0:Oe.addedDocuments.size+Oe.modifiedDocuments.size+Oe.removedDocuments.size>0}(G,W,B)&&c.push(t.Ti.updateTargetData(m,W))});let P=td(),k=ur();if(e.documentUpdates.forEach(B=>{e.resolvedLimboDocuments.has(B)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(m,B))}),c.push(qz(m,y,e.documentUpdates).next(B=>{P=B.qs,k=B.Qs})),!a.isEqual(Nn.min())){const B=t.Ti.getLastRemoteSnapshotVersion(m).next(X=>t.Ti.setTargetsMetadata(m,m.currentSequenceNumber,a));c.push(B)}return At.waitFor(c).next(()=>y.apply(m)).next(()=>t.localDocuments.getLocalViewOfDocuments(m,P,k)).next(()=>P)}).then(m=>(t.xs=d,m))}function qz(r,e,t){let a=ur(),d=ur();return t.forEach(m=>a=a.add(m)),e.getEntries(r,a).next(m=>{let y=td();return t.forEach((c,P)=>{const k=m.get(c);P.isFoundDocument()!==k.isFoundDocument()&&(d=d.add(c)),P.isNoDocument()&&P.version.isEqual(Nn.min())?(e.removeEntry(c,P.readTime),y=y.insert(c,P)):!k.isValidDocument()||P.version.compareTo(k.version)>0||P.version.compareTo(k.version)===0&&k.hasPendingWrites?(e.addEntry(P),y=y.insert(c,P)):Wt(fw,"Ignoring outdated watch update for ",c,". Current version:",k.version," Watch version:",P.version)}),{qs:y,Qs:d}})}function Gz(r,e){const t=Vn(r);return t.persistence.runTransaction("Get next mutation batch","readonly",a=>(e===void 0&&(e=J1),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e)))}function Hz(r,e){const t=Vn(r);return t.persistence.runTransaction("Allocate target","readwrite",a=>{let d;return t.Ti.getTargetData(a,e).next(m=>m?(d=m,At.resolve(d)):t.Ti.allocateTargetId(a).next(y=>(d=new nf(e,y,"TargetPurposeListen",a.currentSequenceNumber),t.Ti.addTargetData(a,d).next(()=>d))))}).then(a=>{const d=t.xs.get(a.targetId);return(d===null||a.snapshotVersion.compareTo(d.snapshotVersion)>0)&&(t.xs=t.xs.insert(a.targetId,a),t.Os.set(e,a.targetId)),a})}async function Zx(r,e,t){const a=Vn(r),d=a.xs.get(e),m=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",m,y=>a.persistence.referenceDelegate.removeTarget(y,d))}catch(y){if(!_g(y))throw y;Wt(fw,`Failed to update sequence numbers for target ${e}: ${y}`)}a.xs=a.xs.remove(e),a.Os.delete(d.target)}function $T(r,e,t){const a=Vn(r);let d=Nn.min(),m=ur();return a.persistence.runTransaction("Execute query","readwrite",y=>function(P,k,B){const X=Vn(P),G=X.Os.get(B);return G!==void 0?At.resolve(X.xs.get(G)):X.Ti.getTargetData(k,B)}(a,y,ih(e)).next(c=>{if(c)return d=c.lastLimboFreeSnapshotVersion,a.Ti.getMatchingKeysForTargetId(y,c.targetId).next(P=>{m=P})}).next(()=>a.Ms.getDocumentsMatchingQuery(y,e,t?d:Nn.min(),t?m:ur())).next(c=>(Zz(a,DL(e),c),{documents:c,$s:m})))}function Zz(r,e,t){let a=r.Ns.get(e)||Nn.min();t.forEach((d,m)=>{m.readTime.compareTo(a)>0&&(a=m.readTime)}),r.Ns.set(e,a)}class qT{constructor(){this.activeTargetIds=VL()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Kz{constructor(){this.xo=new qT,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,a){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new qT,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wz{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT="ConnectivityMonitor";class HT{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Wt(GT,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Wt(GT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kv=null;function Kx(){return kv===null?kv=function(){return 268435456+Math.round(2147483648*Math.random())}():kv++,"0x"+kv.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx="RestConnection",Xz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Yz{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),d=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${a}/databases/${d}`,this.Go=this.databaseId.database===m0?`project_id=${a}`:`project_id=${a}&database_id=${d}`}zo(e,t,a,d,m){const y=Kx(),c=this.jo(e,t.toUriEncodedString());Wt(tx,`Sending RPC '${e}' ${y}:`,c,a);const P={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(P,d,m);const{host:k}=new URL(c),B=C_(k);return this.Jo(e,c,P,a,B).then(X=>(Wt(tx,`Received RPC '${e}' ${y}: `,X),X),X=>{throw rg(tx,`RPC '${e}' ${y} failed with error: `,X,"url: ",c,"request:",a),X})}Yo(e,t,a,d,m,y){return this.zo(e,t,a,d,m)}Ho(e,t,a){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+gg}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((d,m)=>e[m]=d),a&&a.headers.forEach((d,m)=>e[m]=d)}jo(e,t){const a=Xz[e];return`${this.Ko}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qz{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs="WebChannelConnection";class Jz extends Yz{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,d,m){const y=Kx();return new Promise((c,P)=>{const k=new $A;k.setWithCredentials(!0),k.listenOnce(qA.COMPLETE,()=>{try{switch(k.getLastErrorCode()){case Zv.NO_ERROR:const X=k.getResponseJson();Wt(Qs,`XHR for RPC '${e}' ${y} received:`,JSON.stringify(X)),c(X);break;case Zv.TIMEOUT:Wt(Qs,`RPC '${e}' ${y} timed out`),P(new Xt(Et.DEADLINE_EXCEEDED,"Request time out"));break;case Zv.HTTP_ERROR:const G=k.getStatus();if(Wt(Qs,`RPC '${e}' ${y} failed with status:`,G,"response text:",k.getResponseText()),G>0){let W=k.getResponseJson();Array.isArray(W)&&(W=W[0]);const ie=W==null?void 0:W.error;if(ie&&ie.status&&ie.message){const Ie=function(Oe){const Ke=Oe.toLowerCase().replace(/_/g,"-");return Object.values(Et).indexOf(Ke)>=0?Ke:Et.UNKNOWN}(ie.status);P(new Xt(Ie,ie.message))}else P(new Xt(Et.UNKNOWN,"Server responded with status "+k.getStatus()))}else P(new Xt(Et.UNAVAILABLE,"Connection failed."));break;default:Pn(9055,{h_:e,streamId:y,P_:k.getLastErrorCode(),T_:k.getLastError()})}}finally{Wt(Qs,`RPC '${e}' ${y} completed.`)}});const B=JSON.stringify(d);Wt(Qs,`RPC '${e}' ${y} sending request:`,d),k.send(t,"POST",B,a,15)})}I_(e,t,a){const d=Kx(),m=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],y=ZA(),c=HA(),P={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},k=this.longPollingOptions.timeoutSeconds;k!==void 0&&(P.longPollingTimeout=Math.round(1e3*k)),this.useFetchStreams&&(P.useFetchStreams=!0),this.Ho(P.initMessageHeaders,t,a),P.encodeInitMessageHeaders=!0;const B=m.join("");Wt(Qs,`Creating RPC '${e}' stream ${d}: ${B}`,P);const X=y.createWebChannel(B,P);this.E_(X);let G=!1,W=!1;const ie=new Qz({Zo:Re=>{W?Wt(Qs,`Not sending because RPC '${e}' stream ${d} is closed:`,Re):(G||(Wt(Qs,`Opening RPC '${e}' stream ${d} transport.`),X.open(),G=!0),Wt(Qs,`RPC '${e}' stream ${d} sending:`,Re),X.send(Re))},Xo:()=>X.close()}),Ie=(Re,Oe,Ke)=>{Re.listen(Oe,mt=>{try{Ke(mt)}catch(qe){setTimeout(()=>{throw qe},0)}})};return Ie(X,By.EventType.OPEN,()=>{W||(Wt(Qs,`RPC '${e}' stream ${d} transport opened.`),ie.__())}),Ie(X,By.EventType.CLOSE,()=>{W||(W=!0,Wt(Qs,`RPC '${e}' stream ${d} transport closed`),ie.u_(),this.d_(X))}),Ie(X,By.EventType.ERROR,Re=>{W||(W=!0,rg(Qs,`RPC '${e}' stream ${d} transport errored. Name:`,Re.name,"Message:",Re.message),ie.u_(new Xt(Et.UNAVAILABLE,"The operation could not be completed")))}),Ie(X,By.EventType.MESSAGE,Re=>{var Oe;if(!W){const Ke=Re.data[0];Kr(!!Ke,16349);const mt=Ke,qe=(mt==null?void 0:mt.error)||((Oe=mt[0])===null||Oe===void 0?void 0:Oe.error);if(qe){Wt(Qs,`RPC '${e}' stream ${d} received error:`,qe);const Fe=qe.status;let We=function(me){const be=ka[me];if(be!==void 0)return II(be)}(Fe),pe=qe.message;We===void 0&&(We=Et.INTERNAL,pe="Unknown error status: "+Fe+" with message "+qe.message),W=!0,ie.u_(new Xt(We,pe)),X.close()}else Wt(Qs,`RPC '${e}' stream ${d} received:`,Ke),ie.c_(Ke)}}),Ie(c,GA.STAT_EVENT,Re=>{Re.stat===zx.PROXY?Wt(Qs,`RPC '${e}' stream ${d} detected buffering proxy`):Re.stat===zx.NOPROXY&&Wt(Qs,`RPC '${e}' stream ${d} detected no buffering proxy`)}),setTimeout(()=>{ie.a_()},0),ie}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function nx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(r){return new rz(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e,t,a=1e3,d=1.5,m=6e4){this.xi=e,this.timerId=t,this.A_=a,this.R_=d,this.V_=m,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),a=Math.max(0,Date.now()-this.g_),d=Math.max(0,t-a);d>0&&Wt("ExponentialBackoff",`Backing off for ${d} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,d,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT="PersistentStream";class jI{constructor(e,t,a,d,m,y,c,P){this.xi=e,this.S_=a,this.D_=d,this.connection=m,this.authCredentialsProvider=y,this.appCheckCredentialsProvider=c,this.listener=P,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new UI(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===Et.RESOURCE_EXHAUSTED?(ed(t.toString()),ed("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===Et.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,d])=>{this.v_===t&&this.z_(a,d)},a=>{e(()=>{const d=new Xt(Et.UNKNOWN,"Fetching auth token failed: "+a.message);return this.j_(d)})})}z_(e,t){const a=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{a(()=>this.listener.e_())}),this.stream.n_(()=>{a(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(d=>{a(()=>this.j_(d))}),this.stream.onMessage(d=>{a(()=>++this.M_==1?this.J_(d):this.onNext(d))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Wt(ZT,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(Wt(ZT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eO extends jI{constructor(e,t,a,d,m,y){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,d,y),this.serializer=m}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=sz(this.serializer,e),a=function(m){if(!("targetChange"in m))return Nn.min();const y=m.targetChange;return y.targetIds&&y.targetIds.length?Nn.min():y.readTime?ah(y.readTime):Nn.min()}(e);return this.listener.Y_(t,a)}Z_(e){const t={};t.database=Hx(this.serializer),t.addTarget=function(m,y){let c;const P=y.target;if(c=Fx(P)?{documents:uz(m,P)}:{query:cz(m,P).gt},c.targetId=y.targetId,y.resumeToken.approximateByteSize()>0){c.resumeToken=MI(m,y.resumeToken);const k=$x(m,y.expectedCount);k!==null&&(c.expectedCount=k)}else if(y.snapshotVersion.compareTo(Nn.min())>0){c.readTime=b0(m,y.snapshotVersion.toTimestamp());const k=$x(m,y.expectedCount);k!==null&&(c.expectedCount=k)}return c}(this.serializer,e);const a=dz(this.serializer,e);a&&(t.labels=a),this.Q_(t)}X_(e){const t={};t.database=Hx(this.serializer),t.removeTarget=e,this.Q_(t)}}class tO extends jI{constructor(e,t,a,d,m,y){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,d,y),this.serializer=m}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Kr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Kr(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Kr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=lz(e.writeResults,e.commitTime),a=ah(e.commitTime);return this.listener.ra(a,t)}ia(){const e={};e.database=Hx(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(a=>oz(this.serializer,a))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{}class rO extends nO{constructor(e,t,a,d){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=d,this.sa=!1}oa(){if(this.sa)throw new Xt(Et.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,a,d){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([m,y])=>this.connection.zo(e,qx(t,a),d,m,y)).catch(m=>{throw m.name==="FirebaseError"?(m.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),m):new Xt(Et.UNKNOWN,m.toString())})}Yo(e,t,a,d,m){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([y,c])=>this.connection.Yo(e,qx(t,a),d,y,c,m)).catch(y=>{throw y.name==="FirebaseError"?(y.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),y):new Xt(Et.UNKNOWN,y.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class iO{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(ed(t),this.ua=!1):Wt("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bp="RemoteStore";class aO{constructor(e,t,a,d,m){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=m,this.Ra.No(y=>{a.enqueueAndForget(async()=>{Zp(this)&&(Wt(Bp,"Restarting streams for network reachability change."),await async function(P){const k=Vn(P);k.da.add(4),await N_(k),k.Va.set("Unknown"),k.da.delete(4),await J0(k)}(this))})}),this.Va=new iO(a,d)}}async function J0(r){if(Zp(r))for(const e of r.Aa)await e(!0)}async function N_(r){for(const e of r.Aa)await e(!1)}function $I(r,e){const t=Vn(r);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),yw(t)?gw(t):bg(t).N_()&&mw(t,e))}function pw(r,e){const t=Vn(r),a=bg(t);t.Ea.delete(e),a.N_()&&qI(t,e),t.Ea.size===0&&(a.N_()?a.k_():Zp(t)&&t.Va.set("Unknown"))}function mw(r,e){if(r.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Nn.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}bg(r).Z_(e)}function qI(r,e){r.ma.Ke(e),bg(r).X_(e)}function gw(r){r.ma=new JL({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>r.Ea.get(e)||null,Pt:()=>r.datastore.serializer.databaseId}),bg(r).start(),r.Va.ca()}function yw(r){return Zp(r)&&!bg(r).O_()&&r.Ea.size>0}function Zp(r){return Vn(r).da.size===0}function GI(r){r.ma=void 0}async function sO(r){r.Va.set("Online")}async function oO(r){r.Ea.forEach((e,t)=>{mw(r,e)})}async function lO(r,e){GI(r),yw(r)?(r.Va.Pa(e),gw(r)):r.Va.set("Unknown")}async function uO(r,e,t){if(r.Va.set("Online"),e instanceof PI&&e.state===2&&e.cause)try{await async function(d,m){const y=m.cause;for(const c of m.targetIds)d.Ea.has(c)&&(await d.remoteSyncer.rejectListen(c,y),d.Ea.delete(c),d.ma.removeTarget(c))}(r,e)}catch(a){Wt(Bp,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await w0(r,a)}else if(e instanceof Yv?r.ma.Xe(e):e instanceof CI?r.ma.ot(e):r.ma.nt(e),!t.isEqual(Nn.min()))try{const a=await FI(r.localStore);t.compareTo(a)>=0&&await function(m,y){const c=m.ma.It(y);return c.targetChanges.forEach((P,k)=>{if(P.resumeToken.approximateByteSize()>0){const B=m.Ea.get(k);B&&m.Ea.set(k,B.withResumeToken(P.resumeToken,y))}}),c.targetMismatches.forEach((P,k)=>{const B=m.Ea.get(P);if(!B)return;m.Ea.set(P,B.withResumeToken(Rs.EMPTY_BYTE_STRING,B.snapshotVersion)),qI(m,P);const X=new nf(B.target,P,k,B.sequenceNumber);mw(m,X)}),m.remoteSyncer.applyRemoteEvent(c)}(r,t)}catch(a){Wt(Bp,"Failed to raise snapshot:",a),await w0(r,a)}}async function w0(r,e,t){if(!_g(e))throw e;r.da.add(1),await N_(r),r.Va.set("Offline"),t||(t=()=>FI(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{Wt(Bp,"Retrying IndexedDB access"),await t(),r.da.delete(1),await J0(r)})}function HI(r,e){return e().catch(t=>w0(r,t,e))}async function eb(r){const e=Vn(r),t=pf(e);let a=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:J1;for(;cO(e);)try{const d=await Gz(e.localStore,a);if(d===null){e.Ia.length===0&&t.k_();break}a=d.batchId,hO(e,d)}catch(d){await w0(e,d)}ZI(e)&&KI(e)}function cO(r){return Zp(r)&&r.Ia.length<10}function hO(r,e){r.Ia.push(e);const t=pf(r);t.N_()&&t.ea&&t.ta(e.mutations)}function ZI(r){return Zp(r)&&!pf(r).O_()&&r.Ia.length>0}function KI(r){pf(r).start()}async function dO(r){pf(r).ia()}async function fO(r){const e=pf(r);for(const t of r.Ia)e.ta(t.mutations)}async function pO(r,e,t){const a=r.Ia.shift(),d=ow.from(a,e,t);await HI(r,()=>r.remoteSyncer.applySuccessfulWrite(d)),await eb(r)}async function mO(r,e){e&&pf(r).ea&&await async function(a,d){if(function(y){return YL(y)&&y!==Et.ABORTED}(d.code)){const m=a.Ia.shift();pf(a).L_(),await HI(a,()=>a.remoteSyncer.rejectFailedWrite(m.batchId,d)),await eb(a)}}(r,e),ZI(r)&&KI(r)}async function KT(r,e){const t=Vn(r);t.asyncQueue.verifyOperationInProgress(),Wt(Bp,"RemoteStore received new credentials");const a=Zp(t);t.da.add(3),await N_(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await J0(t)}async function gO(r,e){const t=Vn(r);e?(t.da.delete(2),await J0(t)):e||(t.da.add(2),await N_(t),t.Va.set("Unknown"))}function bg(r){return r.fa||(r.fa=function(t,a,d){const m=Vn(t);return m.oa(),new eO(a,m.connection,m.authCredentials,m.appCheckCredentials,m.serializer,d)}(r.datastore,r.asyncQueue,{e_:sO.bind(null,r),n_:oO.bind(null,r),i_:lO.bind(null,r),Y_:uO.bind(null,r)}),r.Aa.push(async e=>{e?(r.fa.L_(),yw(r)?gw(r):r.Va.set("Unknown")):(await r.fa.stop(),GI(r))})),r.fa}function pf(r){return r.ga||(r.ga=function(t,a,d){const m=Vn(t);return m.oa(),new tO(a,m.connection,m.authCredentials,m.appCheckCredentials,m.serializer,d)}(r.datastore,r.asyncQueue,{e_:()=>Promise.resolve(),n_:dO.bind(null,r),i_:mO.bind(null,r),na:fO.bind(null,r),ra:pO.bind(null,r)}),r.Aa.push(async e=>{e?(r.ga.L_(),await eb(r)):(await r.ga.stop(),r.Ia.length>0&&(Wt(Bp,`Stopping write stream with ${r.Ia.length} pending writes`),r.Ia=[]))})),r.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e,t,a,d,m){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=d,this.removalCallback=m,this.deferred=new Kh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(y=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,d,m){const y=Date.now()+a,c=new _w(e,t,y,d,m);return c.start(a),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Xt(Et.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vw(r,e){if(ed("AsyncQueue",`${e}: ${r}`),_g(r))return new Xt(Et.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{static emptySet(e){return new Xm(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||_n.comparator(t.key,a.key):(t,a)=>_n.comparator(t.key,a.key),this.keyedMap=Vy(),this.sortedSet=new ta(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,a)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xm)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const d=t.getNext().key,m=a.getNext().key;if(!d.isEqual(m))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new Xm;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(){this.pa=new ta(_n.comparator)}track(e){const t=e.doc.key,a=this.pa.get(t);a?e.type!==0&&a.type===3?this.pa=this.pa.insert(t,e):e.type===3&&a.type!==1?this.pa=this.pa.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.pa=this.pa.remove(t):e.type===1&&a.type===2?this.pa=this.pa.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Pn(63341,{Vt:e,ya:a}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,a)=>{e.push(a)}),e}}class lg{constructor(e,t,a,d,m,y,c,P,k){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=d,this.mutatedKeys=m,this.fromCache=y,this.syncStateChanged=c,this.excludesMetadataChanges=P,this.hasCachedResults=k}static fromInitialDocuments(e,t,a,d,m){const y=[];return t.forEach(c=>{y.push({type:0,doc:c})}),new lg(e,t,Xm.emptySet(t),y,a,d,!0,!1,m)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Z0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let d=0;d<t.length;d++)if(t[d].type!==a[d].type||!t[d].doc.isEqual(a[d].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class _O{constructor(){this.queries=XT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const d=Vn(t),m=d.queries;d.queries=XT(),m.forEach((y,c)=>{for(const P of c.Sa)P.onError(a)})})(this,new Xt(Et.ABORTED,"Firestore shutting down"))}}function XT(){return new Hp(r=>mI(r),Z0)}async function WI(r,e){const t=Vn(r);let a=3;const d=e.query;let m=t.queries.get(d);m?!m.Da()&&e.va()&&(a=2):(m=new yO,a=e.va()?0:1);try{switch(a){case 0:m.ba=await t.onListen(d,!0);break;case 1:m.ba=await t.onListen(d,!1);break;case 2:await t.onFirstRemoteStoreListen(d)}}catch(y){const c=vw(y,`Initialization of query '${Om(e.query)}' failed`);return void e.onError(c)}t.queries.set(d,m),m.Sa.push(e),e.Fa(t.onlineState),m.ba&&e.Ma(m.ba)&&bw(t)}async function XI(r,e){const t=Vn(r),a=e.query;let d=3;const m=t.queries.get(a);if(m){const y=m.Sa.indexOf(e);y>=0&&(m.Sa.splice(y,1),m.Sa.length===0?d=e.va()?0:1:!m.Da()&&e.va()&&(d=2))}switch(d){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function vO(r,e){const t=Vn(r);let a=!1;for(const d of e){const m=d.query,y=t.queries.get(m);if(y){for(const c of y.Sa)c.Ma(d)&&(a=!0);y.ba=d}}a&&bw(t)}function bO(r,e,t){const a=Vn(r),d=a.queries.get(e);if(d)for(const m of d.Sa)m.onError(t);a.queries.delete(e)}function bw(r){r.Ca.forEach(e=>{e.next()})}var Wx,YT;(YT=Wx||(Wx={})).xa="default",YT.Cache="cache";class YI{constructor(e,t,a){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=a||{}}Ma(e){if(!this.options.includeMetadataChanges){const a=[];for(const d of e.docChanges)d.type!==3&&a.push(d);e=new lg(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const a=t!=="Offline";return(!this.options.Qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=lg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Wx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e){this.key=e}}class JI{constructor(e){this.key=e}}class xO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ur(),this.mutatedKeys=ur(),this.Za=gI(e),this.Xa=new Xm(this.Za)}get eu(){return this.Ha}tu(e,t){const a=t?t.nu:new WT,d=t?t.Xa:this.Xa;let m=t?t.mutatedKeys:this.mutatedKeys,y=d,c=!1;const P=this.query.limitType==="F"&&d.size===this.query.limit?d.last():null,k=this.query.limitType==="L"&&d.size===this.query.limit?d.first():null;if(e.inorderTraversal((B,X)=>{const G=d.get(B),W=K0(this.query,X)?X:null,ie=!!G&&this.mutatedKeys.has(G.key),Ie=!!W&&(W.hasLocalMutations||this.mutatedKeys.has(W.key)&&W.hasCommittedMutations);let Re=!1;G&&W?G.data.isEqual(W.data)?ie!==Ie&&(a.track({type:3,doc:W}),Re=!0):this.ru(G,W)||(a.track({type:2,doc:W}),Re=!0,(P&&this.Za(W,P)>0||k&&this.Za(W,k)<0)&&(c=!0)):!G&&W?(a.track({type:0,doc:W}),Re=!0):G&&!W&&(a.track({type:1,doc:G}),Re=!0,(P||k)&&(c=!0)),Re&&(W?(y=y.add(W),m=Ie?m.add(B):m.delete(B)):(y=y.delete(B),m=m.delete(B)))}),this.query.limit!==null)for(;y.size>this.query.limit;){const B=this.query.limitType==="F"?y.last():y.first();y=y.delete(B.key),m=m.delete(B.key),a.track({type:1,doc:B})}return{Xa:y,nu:a,Cs:c,mutatedKeys:m}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,d){const m=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const y=e.nu.wa();y.sort((B,X)=>function(W,ie){const Ie=Re=>{switch(Re){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pn(20277,{Vt:Re})}};return Ie(W)-Ie(ie)}(B.type,X.type)||this.Za(B.doc,X.doc)),this.iu(a),d=d!=null&&d;const c=t&&!d?this.su():[],P=this.Ya.size===0&&this.current&&!d?1:0,k=P!==this.Ja;return this.Ja=P,y.length!==0||k?{snapshot:new lg(this.query,e.Xa,m,y,e.mutatedKeys,P===0,k,!1,!!a&&a.resumeToken.approximateByteSize()>0),ou:c}:{ou:c}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new WT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=ur(),this.Xa.forEach(a=>{this._u(a.key)&&(this.Ya=this.Ya.add(a.key))});const t=[];return e.forEach(a=>{this.Ya.has(a)||t.push(new JI(a))}),this.Ya.forEach(a=>{e.has(a)||t.push(new QI(a))}),t}au(e){this.Ha=e.$s,this.Ya=ur();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return lg.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const xw="SyncEngine";class wO{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class TO{constructor(e){this.key=e,this.cu=!1}}class SO{constructor(e,t,a,d,m,y){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=d,this.currentUser=m,this.maxConcurrentLimboResolutions=y,this.lu={},this.hu=new Hp(c=>mI(c),Z0),this.Pu=new Map,this.Tu=new Set,this.Iu=new ta(_n.comparator),this.Eu=new Map,this.du=new cw,this.Au={},this.Ru=new Map,this.Vu=og.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function EO(r,e,t=!0){const a=aC(r);let d;const m=a.hu.get(e);return m?(a.sharedClientState.addLocalQueryTarget(m.targetId),d=m.view.uu()):d=await eC(a,e,t,!0),d}async function AO(r,e){const t=aC(r);await eC(t,e,!0,!1)}async function eC(r,e,t,a){const d=await Hz(r.localStore,ih(e)),m=d.targetId,y=r.sharedClientState.addLocalQueryTarget(m,t);let c;return a&&(c=await IO(r,e,m,y==="current",d.resumeToken)),r.isPrimaryClient&&t&&$I(r.remoteStore,d),c}async function IO(r,e,t,a,d){r.fu=(X,G,W)=>async function(Ie,Re,Oe,Ke){let mt=Re.view.tu(Oe);mt.Cs&&(mt=await $T(Ie.localStore,Re.query,!1).then(({documents:pe})=>Re.view.tu(pe,mt)));const qe=Ke&&Ke.targetChanges.get(Re.targetId),Fe=Ke&&Ke.targetMismatches.get(Re.targetId)!=null,We=Re.view.applyChanges(mt,Ie.isPrimaryClient,qe,Fe);return JT(Ie,Re.targetId,We.ou),We.snapshot}(r,X,G,W);const m=await $T(r.localStore,e,!0),y=new xO(e,m.$s),c=y.tu(m.documents),P=O_.createSynthesizedTargetChangeForCurrentChange(t,a&&r.onlineState!=="Offline",d),k=y.applyChanges(c,r.isPrimaryClient,P);JT(r,t,k.ou);const B=new wO(e,t,y);return r.hu.set(e,B),r.Pu.has(t)?r.Pu.get(t).push(e):r.Pu.set(t,[e]),k.snapshot}async function CO(r,e,t){const a=Vn(r),d=a.hu.get(e),m=a.Pu.get(d.targetId);if(m.length>1)return a.Pu.set(d.targetId,m.filter(y=>!Z0(y,e))),void a.hu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(d.targetId),a.sharedClientState.isActiveQueryTarget(d.targetId)||await Zx(a.localStore,d.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(d.targetId),t&&pw(a.remoteStore,d.targetId),Xx(a,d.targetId)}).catch(yg)):(Xx(a,d.targetId),await Zx(a.localStore,d.targetId,!0))}async function PO(r,e){const t=Vn(r),a=t.hu.get(e),d=t.Pu.get(a.targetId);t.isPrimaryClient&&d.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),pw(t.remoteStore,a.targetId))}async function MO(r,e,t){const a=NO(r);try{const d=await function(y,c){const P=Vn(y),k=Za.now(),B=c.reduce((W,ie)=>W.add(ie.key),ur());let X,G;return P.persistence.runTransaction("Locally write mutations","readwrite",W=>{let ie=td(),Ie=ur();return P.Bs.getEntries(W,B).next(Re=>{ie=Re,ie.forEach((Oe,Ke)=>{Ke.isValidDocument()||(Ie=Ie.add(Oe))})}).next(()=>P.localDocuments.getOverlayedDocuments(W,ie)).next(Re=>{X=Re;const Oe=[];for(const Ke of c){const mt=HL(Ke,X.get(Ke.key).overlayedDocument);mt!=null&&Oe.push(new wf(Ke.key,mt,oI(mt.value.mapValue),yu.exists(!0)))}return P.mutationQueue.addMutationBatch(W,k,Oe,c)}).next(Re=>{G=Re;const Oe=Re.applyToLocalDocumentSet(X,Ie);return P.documentOverlayCache.saveOverlays(W,Re.batchId,Oe)})}).then(()=>({batchId:G.batchId,changes:_I(X)}))}(a.localStore,e);a.sharedClientState.addPendingMutation(d.batchId),function(y,c,P){let k=y.Au[y.currentUser.toKey()];k||(k=new ta(tr)),k=k.insert(c,P),y.Au[y.currentUser.toKey()]=k}(a,d.batchId,t),await B_(a,d.changes),await eb(a.remoteStore)}catch(d){const m=vw(d,"Failed to persist write");t.reject(m)}}async function tC(r,e){const t=Vn(r);try{const a=await $z(t.localStore,e);e.targetChanges.forEach((d,m)=>{const y=t.Eu.get(m);y&&(Kr(d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size<=1,22616),d.addedDocuments.size>0?y.cu=!0:d.modifiedDocuments.size>0?Kr(y.cu,14607):d.removedDocuments.size>0&&(Kr(y.cu,42227),y.cu=!1))}),await B_(t,a,e)}catch(a){await yg(a)}}function QT(r,e,t){const a=Vn(r);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const d=[];a.hu.forEach((m,y)=>{const c=y.view.Fa(e);c.snapshot&&d.push(c.snapshot)}),function(y,c){const P=Vn(y);P.onlineState=c;let k=!1;P.queries.forEach((B,X)=>{for(const G of X.Sa)G.Fa(c)&&(k=!0)}),k&&bw(P)}(a.eventManager,e),d.length&&a.lu.Y_(d),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function RO(r,e,t){const a=Vn(r);a.sharedClientState.updateQueryState(e,"rejected",t);const d=a.Eu.get(e),m=d&&d.key;if(m){let y=new ta(_n.comparator);y=y.insert(m,to.newNoDocument(m,Nn.min()));const c=ur().add(m),P=new Y0(Nn.min(),new Map,new ta(tr),y,c);await tC(a,P),a.Iu=a.Iu.remove(m),a.Eu.delete(e),ww(a)}else await Zx(a.localStore,e,!1).then(()=>Xx(a,e,t)).catch(yg)}async function kO(r,e){const t=Vn(r),a=e.batch.batchId;try{const d=await jz(t.localStore,e);rC(t,a,null),nC(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await B_(t,d)}catch(d){await yg(d)}}async function DO(r,e,t){const a=Vn(r);try{const d=await function(y,c){const P=Vn(y);return P.persistence.runTransaction("Reject batch","readwrite-primary",k=>{let B;return P.mutationQueue.lookupMutationBatch(k,c).next(X=>(Kr(X!==null,37113),B=X.keys(),P.mutationQueue.removeMutationBatch(k,X))).next(()=>P.mutationQueue.performConsistencyCheck(k)).next(()=>P.documentOverlayCache.removeOverlaysForBatchId(k,B,c)).next(()=>P.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(k,B)).next(()=>P.localDocuments.getDocuments(k,B))})}(a.localStore,e);rC(a,e,t),nC(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await B_(a,d)}catch(d){await yg(d)}}function nC(r,e){(r.Ru.get(e)||[]).forEach(t=>{t.resolve()}),r.Ru.delete(e)}function rC(r,e,t){const a=Vn(r);let d=a.Au[a.currentUser.toKey()];if(d){const m=d.get(e);m&&(t?m.reject(t):m.resolve(),d=d.remove(e)),a.Au[a.currentUser.toKey()]=d}}function Xx(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const a of r.Pu.get(e))r.hu.delete(a),t&&r.lu.gu(a,t);r.Pu.delete(e),r.isPrimaryClient&&r.du.Hr(e).forEach(a=>{r.du.containsKey(a)||iC(r,a)})}function iC(r,e){r.Tu.delete(e.path.canonicalString());const t=r.Iu.get(e);t!==null&&(pw(r.remoteStore,t),r.Iu=r.Iu.remove(e),r.Eu.delete(t),ww(r))}function JT(r,e,t){for(const a of t)a instanceof QI?(r.du.addReference(a.key,e),LO(r,a)):a instanceof JI?(Wt(xw,"Document no longer in limbo: "+a.key),r.du.removeReference(a.key,e),r.du.containsKey(a.key)||iC(r,a.key)):Pn(19791,{pu:a})}function LO(r,e){const t=e.key,a=t.path.canonicalString();r.Iu.get(t)||r.Tu.has(a)||(Wt(xw,"New document in limbo: "+t),r.Tu.add(a),ww(r))}function ww(r){for(;r.Tu.size>0&&r.Iu.size<r.maxConcurrentLimboResolutions;){const e=r.Tu.values().next().value;r.Tu.delete(e);const t=new _n(Pi.fromString(e)),a=r.Vu.next();r.Eu.set(a,new TO(t)),r.Iu=r.Iu.insert(t,a),$I(r.remoteStore,new nf(ih(iw(t.path)),a,"TargetPurposeLimboResolution",q0.le))}}async function B_(r,e,t){const a=Vn(r),d=[],m=[],y=[];a.hu.isEmpty()||(a.hu.forEach((c,P)=>{y.push(a.fu(P,e,t).then(k=>{var B;if((k||t)&&a.isPrimaryClient){const X=k?!k.fromCache:(B=t==null?void 0:t.targetChanges.get(P.targetId))===null||B===void 0?void 0:B.current;a.sharedClientState.updateQueryState(P.targetId,X?"current":"not-current")}if(k){d.push(k);const X=dw.Rs(P.targetId,k);m.push(X)}}))}),await Promise.all(y),a.lu.Y_(d),await async function(P,k){const B=Vn(P);try{await B.persistence.runTransaction("notifyLocalViewChanges","readwrite",X=>At.forEach(k,G=>At.forEach(G.ds,W=>B.persistence.referenceDelegate.addReference(X,G.targetId,W)).next(()=>At.forEach(G.As,W=>B.persistence.referenceDelegate.removeReference(X,G.targetId,W)))))}catch(X){if(!_g(X))throw X;Wt(fw,"Failed to update sequence numbers: "+X)}for(const X of k){const G=X.targetId;if(!X.fromCache){const W=B.xs.get(G),ie=W.snapshotVersion,Ie=W.withLastLimboFreeSnapshotVersion(ie);B.xs=B.xs.insert(G,Ie)}}}(a.localStore,m))}async function zO(r,e){const t=Vn(r);if(!t.currentUser.isEqual(e)){Wt(xw,"User change. New user:",e.toKey());const a=await VI(t.localStore,e);t.currentUser=e,function(m,y){m.Ru.forEach(c=>{c.forEach(P=>{P.reject(new Xt(Et.CANCELLED,y))})}),m.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await B_(t,a.ks)}}function OO(r,e){const t=Vn(r),a=t.Eu.get(e);if(a&&a.cu)return ur().add(a.key);{let d=ur();const m=t.Pu.get(e);if(!m)return d;for(const y of m){const c=t.hu.get(y);d=d.unionWith(c.view.eu)}return d}}function aC(r){const e=Vn(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=tC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RO.bind(null,e),e.lu.Y_=vO.bind(null,e.eventManager),e.lu.gu=bO.bind(null,e.eventManager),e}function NO(r){const e=Vn(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DO.bind(null,e),e}class T0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Q0(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return Uz(this.persistence,new Bz,e.initialUser,this.serializer)}Su(e){return new BI(hw.fi,this.serializer)}bu(e){return new Kz}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}T0.provider={build:()=>new T0};class BO extends T0{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Kr(this.persistence.referenceDelegate instanceof x0,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new Tz(a,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?el.withCacheSize(this.cacheSizeBytes):el.DEFAULT;return new BI(a=>x0.fi(a,t),this.serializer)}}class Yx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>QT(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=zO.bind(null,this.syncEngine),await gO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _O}()}createDatastore(e){const t=Q0(e.databaseInfo.databaseId),a=function(m){return new Jz(m)}(e.databaseInfo);return function(m,y,c,P){return new rO(m,y,c,P)}(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return function(a,d,m,y,c){return new aO(a,d,m,y,c)}(this.localStore,this.datastore,e.asyncQueue,t=>QT(this.syncEngine,t,0),function(){return HT.C()?new HT:new Wz}())}createSyncEngine(e,t){return function(d,m,y,c,P,k,B){const X=new SO(d,m,y,c,P,k);return B&&(X.mu=!0),X}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(d){const m=Vn(d);Wt(Bp,"RemoteStore shutting down."),m.da.add(5),await N_(m),m.Ra.shutdown(),m.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Yx.provider={build:()=>new Yx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):ed("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf="FirestoreClient";class VO{constructor(e,t,a,d,m){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=d,this.user=eo.UNAUTHENTICATED,this.clientId=YA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=m,this.authCredentials.start(a,async y=>{Wt(mf,"Received user=",y.uid),await this.authCredentialListener(y),this.user=y}),this.appCheckCredentials.start(a,y=>(Wt(mf,"Received new app check token=",y),this.appCheckCredentialListener(y,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Kh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=vw(t,"Failed to shutdown persistence");e.reject(a)}}),e.promise}}async function rx(r,e){r.asyncQueue.verifyOperationInProgress(),Wt(mf,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let a=t.initialUser;r.setCredentialChangeListener(async d=>{a.isEqual(d)||(await VI(e.localStore,d),a=d)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function eS(r,e){r.asyncQueue.verifyOperationInProgress();const t=await FO(r);Wt(mf,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(a=>KT(e.remoteStore,a)),r.setAppCheckTokenChangeListener((a,d)=>KT(e.remoteStore,d)),r._onlineComponents=e}async function FO(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Wt(mf,"Using user provided OfflineComponentProvider");try{await rx(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(d){return d.name==="FirebaseError"?d.code===Et.FAILED_PRECONDITION||d.code===Et.UNIMPLEMENTED:!(typeof DOMException<"u"&&d instanceof DOMException)||d.code===22||d.code===20||d.code===11}(t))throw t;rg("Error using user provided cache. Falling back to memory cache: "+t),await rx(r,new T0)}}else Wt(mf,"Using default OfflineComponentProvider"),await rx(r,new BO(void 0));return r._offlineComponents}async function oC(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Wt(mf,"Using user provided OnlineComponentProvider"),await eS(r,r._uninitializedComponentsProvider._online)):(Wt(mf,"Using default OnlineComponentProvider"),await eS(r,new Yx))),r._onlineComponents}function UO(r){return oC(r).then(e=>e.syncEngine)}async function lC(r){const e=await oC(r),t=e.eventManager;return t.onListen=EO.bind(null,e.syncEngine),t.onUnlisten=CO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=AO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=PO.bind(null,e.syncEngine),t}function jO(r,e,t={}){const a=new Kh;return r.asyncQueue.enqueueAndForget(async()=>function(m,y,c,P,k){const B=new sC({next:G=>{B.xu(),y.enqueueAndForget(()=>XI(m,X));const W=G.docs.has(c);!W&&G.fromCache?k.reject(new Xt(Et.UNAVAILABLE,"Failed to get document because the client is offline.")):W&&G.fromCache&&P&&P.source==="server"?k.reject(new Xt(Et.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):k.resolve(G)},error:G=>k.reject(G)}),X=new YI(iw(c.path),B,{includeMetadataChanges:!0,Qa:!0});return WI(m,X)}(await lC(r),r.asyncQueue,e,t,a)),a.promise}function $O(r,e,t={}){const a=new Kh;return r.asyncQueue.enqueueAndForget(async()=>function(m,y,c,P,k){const B=new sC({next:G=>{B.xu(),y.enqueueAndForget(()=>XI(m,X)),G.fromCache&&P.source==="server"?k.reject(new Xt(Et.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):k.resolve(G)},error:G=>k.reject(G)}),X=new YI(c,B,{includeMetadataChanges:!0,Qa:!0});return WI(m,X)}(await lC(r),r.asyncQueue,e,t,a)),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uC(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(r,e,t){if(!t)throw new Xt(Et.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function qO(r,e,t,a){if(e===!0&&a===!0)throw new Xt(Et.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function nS(r){if(!_n.isDocumentKey(r))throw new Xt(Et.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function rS(r){if(_n.isDocumentKey(r))throw new Xt(Et.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function tb(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(a){return a.constructor?a.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Pn(12329,{type:typeof r})}function mc(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Xt(Et.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tb(r);throw new Xt(Et.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC="firestore.googleapis.com",iS=!0;class aS{constructor(e){var t,a;if(e.host===void 0){if(e.ssl!==void 0)throw new Xt(Et.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hC,this.ssl=iS}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:iS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=NI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<xz)throw new Xt(Et.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}qO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uC((a=e.experimentalLongPollingOptions)!==null&&a!==void 0?a:{}),function(m){if(m.timeoutSeconds!==void 0){if(isNaN(m.timeoutSeconds))throw new Xt(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${m.timeoutSeconds} (must not be NaN)`);if(m.timeoutSeconds<5)throw new Xt(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${m.timeoutSeconds} (minimum allowed value is 5)`);if(m.timeoutSeconds>30)throw new Xt(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${m.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(a,d){return a.timeoutSeconds===d.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class nb{constructor(e,t,a,d){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new aS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Xt(Et.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Xt(Et.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new aS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(a){if(!a)return new Q3;switch(a.type){case"firstParty":return new nL(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new Xt(Et.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const a=tS.get(t);a&&(Wt("ComponentProvider","Removing Datastore"),tS.delete(t),a.terminate())}(this),Promise.resolve()}}function GO(r,e,t,a={}){var d;r=mc(r,nb);const m=C_(e),y=r._getSettings(),c=Object.assign(Object.assign({},y),{emulatorOptions:r._getEmulatorOptions()}),P=`${e}:${t}`;m&&(JE(`https://${P}`),eA("Firestore",!0)),y.host!==hC&&y.host!==P&&rg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const k=Object.assign(Object.assign({},y),{host:P,ssl:m,emulatorOptions:a});if(!Dp(k,c)&&(r._setSettings(k),a.mockUserToken)){let B,X;if(typeof a.mockUserToken=="string")B=a.mockUserToken,X=eo.MOCK_USER;else{B=ck(a.mockUserToken,(d=r._app)===null||d===void 0?void 0:d.options.projectId);const G=a.mockUserToken.sub||a.mockUserToken.user_id;if(!G)throw new Xt(Et.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");X=new eo(G)}r._authCredentials=new J3(new WA(B,X))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Kp(this.firestore,e,this._query)}}class Mo{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mo(this.firestore,e,this._key)}}class uf extends Kp{constructor(e,t,a){super(e,t,iw(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mo(this.firestore,null,new _n(e))}withConverter(e){return new uf(this.firestore,e,this._path)}}function S0(r,e,...t){if(r=Ms(r),cC("collection","path",e),r instanceof nb){const a=Pi.fromString(e,...t);return rS(a),new uf(r,null,a)}{if(!(r instanceof Mo||r instanceof uf))throw new Xt(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=r._path.child(Pi.fromString(e,...t));return rS(a),new uf(r.firestore,null,a)}}function Ym(r,e,...t){if(r=Ms(r),arguments.length===1&&(e=YA.newId()),cC("doc","path",e),r instanceof nb){const a=Pi.fromString(e,...t);return nS(a),new Mo(r,null,new _n(a))}{if(!(r instanceof Mo||r instanceof uf))throw new Xt(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=r._path.child(Pi.fromString(e,...t));return nS(a),new Mo(r.firestore,r instanceof uf?r.converter:null,new _n(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS="AsyncQueue";class oS{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new UI(this,"async_queue_retry"),this.rc=()=>{const a=nx();a&&Wt(sS,"Visibility state changed to "+a.visibilityState),this.x_.b_()},this.sc=e;const t=nx();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=nx();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Kh;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!_g(e))throw e;Wt(sS,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(a=>{throw this.Xu=a,this.ec=!1,ed("INTERNAL UNHANDLED ERROR: ",lS(a)),a}).then(a=>(this.ec=!1,a))));return this.sc=t,t}enqueueAfterDelay(e,t,a){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const d=_w.createAndSchedule(this,e,t,a,m=>this.uc(m));return this.Zu.push(d),d}oc(){this.Xu&&Pn(47125,{cc:lS(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,a)=>t.targetTimeMs-a.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function lS(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}class Wp extends nb{constructor(e,t,a,d){super(e,t,a,d),this.type="firestore",this._queue=new oS,this._persistenceKey=(d==null?void 0:d.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new oS(e),this._firestoreClient=void 0,await e}}}function HO(r,e){const t=typeof r=="object"?r:iA(),a=typeof r=="string"?r:m0,d=j1(t,"firestore").getImmediate({identifier:a});if(!d._initialized){const m=lk("firestore");m&&GO(d,...m)}return d}function Tw(r){if(r._terminated)throw new Xt(Et.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||ZO(r),r._firestoreClient}function ZO(r){var e,t,a;const d=r._freezeSettings(),m=function(c,P,k,B){return new yL(c,P,k,B.host,B.ssl,B.experimentalForceLongPolling,B.experimentalAutoDetectLongPolling,uC(B.experimentalLongPollingOptions),B.useFetchStreams,B.isUsingEmulator)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,d);r._componentsProvider||!((t=d.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((a=d.localCache)===null||a===void 0)&&a._onlineComponentProvider)&&(r._componentsProvider={_offline:d.localCache._offlineComponentProvider,_online:d.localCache._onlineComponentProvider}),r._firestoreClient=new VO(r._authCredentials,r._appCheckCredentials,r._queue,m,r._componentsProvider&&function(c){const P=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(P),_online:P}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ug(Rs.fromBase64String(e))}catch(t){throw new Xt(Et.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ug(Rs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Xt(Et.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ps(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Xt(Et.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Xt(Et.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return tr(this._lat,e._lat)||tr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(a,d){if(a.length!==d.length)return!1;for(let m=0;m<a.length;++m)if(a[m]!==d[m])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KO=/^__.*__$/;class WO{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new wf(e,this.data,this.fieldMask,t,this.fieldTransforms):new z_(e,this.data,t,this.fieldTransforms)}}class dC{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new wf(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fC(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pn(40011,{Ic:r})}}class Iw{constructor(e,t,a,d,m,y){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=d,m===void 0&&this.Ec(),this.fieldTransforms=m||[],this.fieldMask=y||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Iw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),d=this.dc({path:a,Rc:!1});return d.Vc(e),d}mc(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),d=this.dc({path:a,Rc:!1});return d.Ec(),d}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return E0(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(fC(this.Ic)&&KO.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class XO{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||Q0(e)}bc(e,t,a,d=!1){return new Iw({Ic:e,methodName:t,wc:a,path:Ps.emptyPath(),Rc:!1,yc:d},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ib(r){const e=r._freezeSettings(),t=Q0(r._databaseId);return new XO(r._databaseId,!!e.ignoreUndefinedProperties,t)}function pC(r,e,t,a,d,m={}){const y=r.bc(m.merge||m.mergeFields?2:0,e,t,d);Cw("Data must be an object, but it was:",y,a);const c=mC(a,y);let P,k;if(m.merge)P=new Pl(y.fieldMask),k=y.fieldTransforms;else if(m.mergeFields){const B=[];for(const X of m.mergeFields){const G=Qx(e,X,t);if(!y.contains(G))throw new Xt(Et.INVALID_ARGUMENT,`Field '${G}' is specified in your field mask but missing from your input data.`);yC(B,G)||B.push(G)}P=new Pl(B),k=y.fieldTransforms.filter(X=>P.covers(X.field))}else P=null,k=y.fieldTransforms;return new WO(new tl(c),P,k)}class ab extends Sw{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ab}}function YO(r,e,t,a){const d=r.bc(1,e,t);Cw("Data must be an object, but it was:",d,a);const m=[],y=tl.empty();xf(a,(P,k)=>{const B=Pw(e,P,t);k=Ms(k);const X=d.mc(B);if(k instanceof ab)m.push(B);else{const G=V_(k,X);G!=null&&(m.push(B),y.set(B,G))}});const c=new Pl(m);return new dC(y,c,d.fieldTransforms)}function QO(r,e,t,a,d,m){const y=r.bc(1,e,t),c=[Qx(e,a,t)],P=[d];if(m.length%2!=0)throw new Xt(Et.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let G=0;G<m.length;G+=2)c.push(Qx(e,m[G])),P.push(m[G+1]);const k=[],B=tl.empty();for(let G=c.length-1;G>=0;--G)if(!yC(k,c[G])){const W=c[G];let ie=P[G];ie=Ms(ie);const Ie=y.mc(W);if(ie instanceof ab)k.push(W);else{const Re=V_(ie,Ie);Re!=null&&(k.push(W),B.set(W,Re))}}const X=new Pl(k);return new dC(B,X,y.fieldTransforms)}function JO(r,e,t,a=!1){return V_(t,r.bc(a?4:3,e))}function V_(r,e){if(gC(r=Ms(r)))return Cw("Unsupported field value:",e,r),mC(r,e);if(r instanceof Sw)return function(a,d){if(!fC(d.Ic))throw d.gc(`${a._methodName}() can only be used with update() and set()`);if(!d.path)throw d.gc(`${a._methodName}() is not currently supported inside arrays`);const m=a._toFieldTransform(d);m&&d.fieldTransforms.push(m)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(a,d){const m=[];let y=0;for(const c of a){let P=V_(c,d.fc(y));P==null&&(P={nullValue:"NULL_VALUE"}),m.push(P),y++}return{arrayValue:{values:m}}}(r,e)}return function(a,d){if((a=Ms(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return FL(d.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const m=Za.fromDate(a);return{timestampValue:b0(d.serializer,m)}}if(a instanceof Za){const m=new Za(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:b0(d.serializer,m)}}if(a instanceof Ew)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof ug)return{bytesValue:MI(d.serializer,a._byteString)};if(a instanceof Mo){const m=d.databaseId,y=a.firestore._databaseId;if(!y.isEqual(m))throw d.gc(`Document reference is for database ${y.projectId}/${y.database} but should be for database ${m.projectId}/${m.database}`);return{referenceValue:uw(a.firestore._databaseId||d.databaseId,a._key.path)}}if(a instanceof Aw)return function(y,c){return{mapValue:{fields:{[aI]:{stringValue:sI},[g0]:{arrayValue:{values:y.toArray().map(k=>{if(typeof k!="number")throw c.gc("VectorValues must only contain numeric values.");return aw(c.serializer,k)})}}}}}}(a,d);throw d.gc(`Unsupported field value: ${tb(a)}`)}(r,e)}function mC(r,e){const t={};return JA(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xf(r,(a,d)=>{const m=V_(d,e.Ac(a));m!=null&&(t[a]=m)}),{mapValue:{fields:t}}}function gC(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Za||r instanceof Ew||r instanceof ug||r instanceof Mo||r instanceof Sw||r instanceof Aw)}function Cw(r,e,t){if(!gC(t)||!function(d){return typeof d=="object"&&d!==null&&(Object.getPrototypeOf(d)===Object.prototype||Object.getPrototypeOf(d)===null)}(t)){const a=tb(t);throw a==="an object"?e.gc(r+" a custom object"):e.gc(r+" "+a)}}function Qx(r,e,t){if((e=Ms(e))instanceof rb)return e._internalPath;if(typeof e=="string")return Pw(r,e);throw E0("Field path arguments must be of type string or ",r,!1,void 0,t)}const e4=new RegExp("[~\\*/\\[\\]]");function Pw(r,e,t){if(e.search(e4)>=0)throw E0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new rb(...e.split("."))._internalPath}catch{throw E0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function E0(r,e,t,a,d){const m=a&&!a.isEmpty(),y=d!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let P="";return(m||y)&&(P+=" (found",m&&(P+=` in field ${a}`),y&&(P+=` in document ${d}`),P+=")"),new Xt(Et.INVALID_ARGUMENT,c+r+P)}function yC(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,t,a,d,m){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=d,this._converter=m}get id(){return this._key.path.lastSegment()}get ref(){return new Mo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new t4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Mw("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class t4 extends _C{data(){return super.data()}}function Mw(r,e){return typeof e=="string"?Pw(r,e):e instanceof rb?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new Xt(Et.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Rw{}class vC extends Rw{}function r4(r,e,...t){let a=[];e instanceof Rw&&a.push(e),a=a.concat(t),function(m){const y=m.filter(P=>P instanceof Dw).length,c=m.filter(P=>P instanceof kw).length;if(y>1||y>0&&c>0)throw new Xt(Et.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const d of a)r=d._apply(r);return r}class kw extends vC{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new kw(e,t,a)}_apply(e){const t=this._parse(e);return bC(e._query,t),new Kp(e.firestore,e.converter,Ux(e._query,t))}_parse(e){const t=ib(e.firestore);return function(m,y,c,P,k,B,X){let G;if(k.isKeyField()){if(B==="array-contains"||B==="array-contains-any")throw new Xt(Et.INVALID_ARGUMENT,`Invalid Query. You can't perform '${B}' queries on documentId().`);if(B==="in"||B==="not-in"){cS(X,B);const ie=[];for(const Ie of X)ie.push(uS(P,m,Ie));G={arrayValue:{values:ie}}}else G=uS(P,m,X)}else B!=="in"&&B!=="not-in"&&B!=="array-contains-any"||cS(X,B),G=JO(c,y,X,B==="in"||B==="not-in");return Da.create(k,B,G)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Dw extends Rw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Dw(e,t)}_parse(e){const t=this._queryConstraints.map(a=>a._parse(e)).filter(a=>a.getFilters().length>0);return t.length===1?t[0]:pc.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(d,m){let y=d;const c=m.getFlattenedFilters();for(const P of c)bC(y,P),y=Ux(y,P)}(e._query,t),new Kp(e.firestore,e.converter,Ux(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Lw extends vC{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Lw(e,t)}_apply(e){const t=function(d,m,y){if(d.startAt!==null)throw new Xt(Et.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(d.endAt!==null)throw new Xt(Et.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new c_(m,y)}(e._query,this._field,this._direction);return new Kp(e.firestore,e.converter,function(d,m){const y=d.explicitOrderBy.concat([m]);return new vg(d.path,d.collectionGroup,y,d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(e._query,t))}}function i4(r,e="asc"){const t=e,a=Mw("orderBy",r);return Lw._create(a,t)}function uS(r,e,t){if(typeof(t=Ms(t))=="string"){if(t==="")throw new Xt(Et.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pI(e)&&t.indexOf("/")!==-1)throw new Xt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(Pi.fromString(t));if(!_n.isDocumentKey(a))throw new Xt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return ST(r,new _n(a))}if(t instanceof Mo)return ST(r,t._key);throw new Xt(Et.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tb(t)}.`)}function cS(r,e){if(!Array.isArray(r)||r.length===0)throw new Xt(Et.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bC(r,e){const t=function(d,m){for(const y of d)for(const c of y.getFlattenedFilters())if(m.indexOf(c.op)>=0)return c.op;return null}(r.filters,function(d){switch(d){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Xt(Et.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Xt(Et.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class a4{convertValue(e,t="none"){switch(ff(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ga(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(df(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Pn(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return xf(e,(d,m)=>{a[d]=this.convertValue(m,t)}),a}convertVectorValue(e){var t,a,d;const m=(d=(a=(t=e.fields)===null||t===void 0?void 0:t[g0].arrayValue)===null||a===void 0?void 0:a.values)===null||d===void 0?void 0:d.map(y=>ga(y.doubleValue));return new Aw(m)}convertGeoPoint(e){return new Ew(ga(e.latitude),ga(e.longitude))}convertArray(e,t){return(e.values||[]).map(a=>this.convertValue(a,t))}convertServerTimestamp(e,t){switch(t){case"previous":const a=H0(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(o_(e));default:return null}}convertTimestamp(e){const t=hf(e);return new Za(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=Pi.fromString(e);Kr(OI(a),9688,{name:e});const d=new l_(a.get(1),a.get(3)),m=new _n(a.popFirst(5));return d.isEqual(t)||ed(`Document ${m} contains a document reference within a different database (${d.projectId}/${d.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xC(r,e,t){let a;return a=r?r.toFirestore(e):e,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wC extends _C{constructor(e,t,a,d,m,y){super(e,t,a,d,y),this._firestore=e,this._firestoreImpl=e,this.metadata=m}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Qv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(Mw("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}}class Qv extends wC{data(e={}){return super.data(e)}}class s4{constructor(e,t,a,d){this._firestore=e,this._userDataWriter=t,this._snapshot=d,this.metadata=new Uy(d.hasPendingWrites,d.fromCache),this.query=a}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(a=>{e.call(t,new Qv(this._firestore,this._userDataWriter,a.key,a,new Uy(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Xt(Et.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(d,m){if(d._snapshot.oldDocs.isEmpty()){let y=0;return d._snapshot.docChanges.map(c=>{const P=new Qv(d._firestore,d._userDataWriter,c.doc.key,c.doc,new Uy(d._snapshot.mutatedKeys.has(c.doc.key),d._snapshot.fromCache),d.query.converter);return c.doc,{type:"added",doc:P,oldIndex:-1,newIndex:y++}})}{let y=d._snapshot.oldDocs;return d._snapshot.docChanges.filter(c=>m||c.type!==3).map(c=>{const P=new Qv(d._firestore,d._userDataWriter,c.doc.key,c.doc,new Uy(d._snapshot.mutatedKeys.has(c.doc.key),d._snapshot.fromCache),d.query.converter);let k=-1,B=-1;return c.type!==0&&(k=y.indexOf(c.doc.key),y=y.delete(c.doc.key)),c.type!==1&&(y=y.add(c.doc),B=y.indexOf(c.doc.key)),{type:o4(c.type),doc:P,oldIndex:k,newIndex:B}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function o4(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pn(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(r){r=mc(r,Mo);const e=mc(r.firestore,Wp);return jO(Tw(e),r._key).then(t=>d4(e,r,t))}class SC extends a4{constructor(e){super(),this.firestore=e}convertBytes(e){return new ug(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mo(this.firestore,null,t)}}function zw(r){r=mc(r,Kp);const e=mc(r.firestore,Wp),t=Tw(e),a=new SC(e);return n4(r._query),$O(t,r._query).then(d=>new s4(e,a,r,d))}function l4(r,e,t){r=mc(r,Mo);const a=mc(r.firestore,Wp),d=xC(r.converter,e);return sb(a,[pC(ib(a),"setDoc",r._key,d,r.converter!==null,t).toMutation(r._key,yu.none())])}function u4(r,e,t,...a){r=mc(r,Mo);const d=mc(r.firestore,Wp),m=ib(d);let y;return y=typeof(e=Ms(e))=="string"||e instanceof rb?QO(m,"updateDoc",r._key,e,t,a):YO(m,"updateDoc",r._key,e),sb(d,[y.toMutation(r._key,yu.exists(!0))])}function c4(r){return sb(mc(r.firestore,Wp),[new sw(r._key,yu.none())])}function h4(r,e){const t=mc(r.firestore,Wp),a=Ym(r),d=xC(r.converter,e);return sb(t,[pC(ib(r.firestore),"addDoc",a._key,d,r.converter!==null,{}).toMutation(a._key,yu.exists(!1))]).then(()=>a)}function sb(r,e){return function(a,d){const m=new Kh;return a.asyncQueue.enqueueAndForget(async()=>MO(await UO(a),d,m)),m.promise}(Tw(r),e)}function d4(r,e,t){const a=t.docs.get(e._key),d=new SC(r);return new wC(r,d,e._key,a,new Uy(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(d){gg=d})(pg),ng(new Lp("firestore",(a,{instanceIdentifier:d,options:m})=>{const y=a.getProvider("app").getImmediate(),c=new Wp(new eL(a.getProvider("auth-internal")),new rL(y,a.getProvider("app-check-internal")),function(k,B){if(!Object.prototype.hasOwnProperty.apply(k.options,["projectId"]))throw new Xt(Et.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new l_(k.options.projectId,B)}(y,d),y);return m=Object.assign({useFetchStreams:t},m),c._setSettings(m),c},"PUBLIC").setMultipleInstances(!0)),of(dT,fT,e),of(dT,fT,"esm2017")})();const f4={apiKey:"AIzaSyBvXlBW9BHh89QvY-LdJp9cy5CSPa6-3GU",authDomain:"atco-training-d1552.firebaseapp.com",projectId:"atco-training-d1552",storageBucket:"atco-training-d1552.firebasestorage.app",messagingSenderId:"233580419344",appId:"1:233580419344:web:f8c7d77607c7cf26642d95"},EC=rA(f4),Sp=X3(EC),$h=HO(EC);var Jv={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.0/LICENSE.txt
 */var p4=Jv.exports,hS;function m4(){return hS||(hS=1,function(r,e){(function(t,a){r.exports=a()})(p4,function(){var t={},a={};function d(y,c,P){if(a[y]=P,y==="index"){var k="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",B={};return a.shared(B),a.index(t,B),typeof window<"u"&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([k],{type:"text/javascript"}))),t}}d("shared",["exports"],function(y){function c(u,i,o,f){return new(o||(o=Promise))(function(v,T){function S(z){try{R(f.next(z))}catch(N){T(N)}}function I(z){try{R(f.throw(z))}catch(N){T(N)}}function R(z){var N;z.done?v(z.value):(N=z.value,N instanceof o?N:new o(function(U){U(N)})).then(S,I)}R((f=f.apply(u,i||[])).next())})}function P(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var k,B;function X(){if(B)return k;function u(i,o){this.x=i,this.y=o}return B=1,k=u,u.prototype={clone:function(){return new u(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,o){return this.clone()._rotateAround(i,o)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var o=i.x-this.x,f=i.y-this.y;return o*o+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,o){return Math.atan2(this.x*o-this.y*i,this.x*i+this.y*o)},_matMult:function(i){var o=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=o,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var o=Math.cos(i),f=Math.sin(i),v=f*this.x+o*this.y;return this.x=o*this.x-f*this.y,this.y=v,this},_rotateAround:function(i,o){var f=Math.cos(i),v=Math.sin(i),T=o.y+v*(this.x-o.x)+f*(this.y-o.y);return this.x=o.x+f*(this.x-o.x)-v*(this.y-o.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(i){return i instanceof u?i:Array.isArray(i)?new u(i[0],i[1]):i},k}typeof SuppressedError=="function"&&SuppressedError;var G,W,ie=P(X()),Ie=function(){if(W)return G;function u(i,o,f,v){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(v-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=f,this.p2y=v}return W=1,G=u,u.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,v=0;v<8;v++){var T=this.sampleCurveX(f)-i;if(Math.abs(T)<o)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=T/S}var I=0,R=1;for(f=i,v=0;v<20&&(T=this.sampleCurveX(f),!(Math.abs(T-i)<o));v++)i>T?I=f:R=f,f=.5*(R-I)+I;return f},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},G}(),Re=P(Ie);let Oe,Ke;function mt(){return Oe==null&&(Oe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Oe}function qe(){if(Ke==null&&(Ke=!1,mt())){const i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let f=0;f<5*5;f++){const v=4*f;i.fillStyle=`rgb(${v},${v+1},${v+2})`,i.fillRect(f%5,Math.floor(f/5),1,1)}const o=i.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&o[f]!==f){Ke=!0;break}}}return Ke||!1}var Fe=1e-6,We=typeof Float32Array<"u"?Float32Array:Array;function pe(){var u=new We(9);return We!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function oe(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function me(){var u=new We(3);return We!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function be(u){return Math.hypot(u[0],u[1],u[2])}function Ce(u,i,o){var f=new We(3);return f[0]=u,f[1]=i,f[2]=o,f}function Ve(u,i,o){return u[0]=i[0]+o[0],u[1]=i[1]+o[1],u[2]=i[2]+o[2],u}function Ee(u,i,o){return u[0]=i[0]*o,u[1]=i[1]*o,u[2]=i[2]*o,u}function Yn(u,i,o){var f=i[0],v=i[1],T=i[2],S=o[0],I=o[1],R=o[2];return u[0]=v*R-T*I,u[1]=T*S-f*R,u[2]=f*I-v*S,u}Math.hypot||(Math.hypot=function(){for(var u=0,i=arguments.length;i--;)u+=arguments[i]*arguments[i];return Math.sqrt(u)});var jn,gt=be;function Bt(u,i,o){var f=i[0],v=i[1],T=i[2],S=i[3];return u[0]=o[0]*f+o[4]*v+o[8]*T+o[12]*S,u[1]=o[1]*f+o[5]*v+o[9]*T+o[13]*S,u[2]=o[2]*f+o[6]*v+o[10]*T+o[14]*S,u[3]=o[3]*f+o[7]*v+o[11]*T+o[15]*S,u}function nn(){var u=new We(4);return We!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function Kn(u,i,o,f){var v=.5*Math.PI/180;i*=v,o*=v,f*=v;var T=Math.sin(i),S=Math.cos(i),I=Math.sin(o),R=Math.cos(o),z=Math.sin(f),N=Math.cos(f);return u[0]=T*R*N-S*I*z,u[1]=S*I*N+T*R*z,u[2]=S*R*z-T*I*N,u[3]=S*R*N+T*I*z,u}function ze(){var u=new We(2);return We!=Float32Array&&(u[0]=0,u[1]=0),u}function xt(u,i){var o=new We(2);return o[0]=u,o[1]=i,o}me(),jn=new We(4),We!=Float32Array&&(jn[0]=0,jn[1]=0,jn[2]=0,jn[3]=0),me(),Ce(1,0,0),Ce(0,1,0),nn(),nn(),pe(),ze();const It=8192;function Rt(u,i,o){return i*(It/(u.tileSize*Math.pow(2,o-u.tileID.overscaledZ)))}function Yt(u,i){return(u%i+i)%i}function wn(u,i,o){return u*(1-o)+i*o}function fn(u){if(u<=0)return 0;if(u>=1)return 1;const i=u*u,o=i*u;return 4*(u<.5?o:3*(u-i)+o-.75)}function ii(u,i,o,f){const v=new Re(u,i,o,f);return T=>v.solve(T)}const wr=ii(.25,.1,.25,1);function Ir(u,i,o){return Math.min(o,Math.max(i,u))}function ks(u,i,o){const f=o-i,v=((u-i)%f+f)%f+i;return v===i?o:v}function gi(u,...i){for(const o of i)for(const f in o)u[f]=o[f];return u}let io=1;function Tr(u,i,o){const f={};for(const v in u)f[v]=i.call(this,u[v],v,u);return f}function ya(u,i,o){const f={};for(const v in u)i.call(this,u[v],v,u)&&(f[v]=u[v]);return f}function _a(u){return Array.isArray(u)?u.map(_a):typeof u=="object"&&u?Tr(u,_a):u}const nl={};function Cr(u){nl[u]||(typeof console<"u"&&console.warn(u),nl[u]=!0)}function za(u,i,o){return(o.y-u.y)*(i.x-u.x)>(i.y-u.y)*(o.x-u.x)}function na(u){return typeof WorkerGlobalScope<"u"&&u!==void 0&&u instanceof WorkerGlobalScope}let Ds=null;function Wa(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const _u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ls(u,i,o,f,v){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const T=new VideoFrame(u,{timestamp:0});try{const S=T==null?void 0:T.format;if(!S||!S.startsWith("BGR")&&!S.startsWith("RGB"))throw new Error(`Unrecognized format ${S}`);const I=S.startsWith("BGR"),R=new Uint8ClampedArray(f*v*4);if(yield T.copyTo(R,function(z,N,U,q,Y){const J=4*Math.max(1,0),te=(Math.max(0,U)-U)*q*4+J,le=4*q,ge=Math.max(0,N),Le=Math.max(0,U);return{rect:{x:ge,y:Le,width:Math.min(z.width,N+q)-ge,height:Math.min(z.height,U+Y)-Le},layout:[{offset:te,stride:le}]}}(u,i,o,f,v)),I)for(let z=0;z<R.length;z+=4){const N=R[z];R[z]=R[z+2],R[z+2]=N}return R}finally{T.close()}})}let os,Ro;function fr(u,i,o,f){return u.addEventListener(i,o,f),{unsubscribe:()=>{u.removeEventListener(i,o,f)}}}function zn(u){return u*Math.PI/180}function di(u){return u/Math.PI*180}const Ri={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},vu={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ao="AbortError";function $e(){return new Error(ao)}const ne={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function re(u){return ne.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))]}const ue="global-dispatcher";class xe extends Error{constructor(i,o,f,v){super(`AJAXError: ${o} (${i}): ${f}`),this.status=i,this.statusText=o,this.url=f,this.body=v}}const De=()=>na(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,je=function(u,i){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){const f=re(u.url);if(f)return f(u,i);if(na(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,targetMapId:ue},i)}if(!(/^file:/.test(o=u.url)||/^file:/.test(De())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,v){return c(this,void 0,void 0,function*(){const T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:De(),signal:v.signal});let S,I;f.type!=="json"||T.headers.has("Accept")||T.headers.set("Accept","application/json");try{S=yield fetch(T)}catch(z){throw new xe(0,z.message,f.url,new Blob)}if(!S.ok){const z=yield S.blob();throw new xe(S.status,S.statusText,f.url,z)}I=f.type==="arrayBuffer"||f.type==="image"?S.arrayBuffer():f.type==="json"?S.json():S.text();const R=yield I;if(v.signal.aborted)throw $e();return{data:R,cacheControl:S.headers.get("Cache-Control"),expires:S.headers.get("Expires")}})}(u,i);if(na(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,mustQueue:!0,targetMapId:ue},i)}var o;return function(f,v){return new Promise((T,S)=>{var I;const R=new XMLHttpRequest;R.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(R.responseType="arraybuffer");for(const z in f.headers)R.setRequestHeader(z,f.headers[z]);f.type==="json"&&(R.responseType="text",!((I=f.headers)===null||I===void 0)&&I.Accept||R.setRequestHeader("Accept","application/json")),R.withCredentials=f.credentials==="include",R.onerror=()=>{S(new Error(R.statusText))},R.onload=()=>{if(!v.signal.aborted)if((R.status>=200&&R.status<300||R.status===0)&&R.response!==null){let z=R.response;if(f.type==="json")try{z=JSON.parse(R.response)}catch(N){return void S(N)}T({data:z,cacheControl:R.getResponseHeader("Cache-Control"),expires:R.getResponseHeader("Expires")})}else{const z=new Blob([R.response],{type:R.getResponseHeader("Content-Type")});S(new xe(R.status,R.statusText,f.url,z))}},v.signal.addEventListener("abort",()=>{R.abort(),S($e())}),R.send(f.body)})}(u,i)};function Je(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;const i=new URL(u),o=window.location;return i.protocol===o.protocol&&i.host===o.host}function Be(u,i,o){o[u]&&o[u].indexOf(i)!==-1||(o[u]=o[u]||[],o[u].push(i))}function lt(u,i,o){if(o&&o[u]){const f=o[u].indexOf(i);f!==-1&&o[u].splice(f,1)}}class it{constructor(i,o={}){gi(this,o),this.type=i}}class Ge extends it{constructor(i,o={}){super("error",gi({error:i},o))}}class ft{on(i,o){return this._listeners=this._listeners||{},Be(i,o,this._listeners),{unsubscribe:()=>{this.off(i,o)}}}off(i,o){return lt(i,o,this._listeners),lt(i,o,this._oneTimeListeners),this}once(i,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Be(i,o,this._oneTimeListeners),this):new Promise(f=>this.once(i,f))}fire(i,o){typeof i=="string"&&(i=new it(i,o||{}));const f=i.type;if(this.listens(f)){i.target=this;const v=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const I of v)I.call(this,i);const T=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const I of T)lt(f,I,this._oneTimeListeners),I.call(this,i);const S=this._eventedParent;S&&(gi(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(i))}else i instanceof Ge&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,o){return this._eventedParent=i,this._eventedParentData=o,this}}var ke={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Lt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function rn(u,i){const o={};for(const f in u)f!=="ref"&&(o[f]=u[f]);return Lt.forEach(f=>{f in i&&(o[f]=i[f])}),o}function Vt(u,i){if(Array.isArray(u)){if(!Array.isArray(i)||u.length!==i.length)return!1;for(let o=0;o<u.length;o++)if(!Vt(u[o],i[o]))return!1;return!0}if(typeof u=="object"&&u!==null&&i!==null){if(typeof i!="object"||Object.keys(u).length!==Object.keys(i).length)return!1;for(const o in u)if(!Vt(u[o],i[o]))return!1;return!0}return u===i}function Kt(u,i){u.push(i)}function Ht(u,i,o){Kt(o,{command:"addSource",args:[u,i[u]]})}function Tn(u,i,o){Kt(i,{command:"removeSource",args:[u]}),o[u]=!0}function gn(u,i,o,f){Tn(u,o,f),Ht(u,i,o)}function Sn(u,i,o){let f;for(f in u[o])if(Object.prototype.hasOwnProperty.call(u[o],f)&&f!=="data"&&!Vt(u[o][f],i[o][f]))return!1;for(f in i[o])if(Object.prototype.hasOwnProperty.call(i[o],f)&&f!=="data"&&!Vt(u[o][f],i[o][f]))return!1;return!0}function on(u,i,o,f,v,T){u=u||{},i=i||{};for(const S in u)Object.prototype.hasOwnProperty.call(u,S)&&(Vt(u[S],i[S])||o.push({command:T,args:[f,S,i[S],v]}));for(const S in i)Object.prototype.hasOwnProperty.call(i,S)&&!Object.prototype.hasOwnProperty.call(u,S)&&(Vt(u[S],i[S])||o.push({command:T,args:[f,S,i[S],v]}))}function Bn(u){return u.id}function Wr(u,i){return u[i.id]=i,u}class Pt{constructor(i,o,f,v){this.message=(i?`${i}: `:"")+f,v&&(this.identifier=v),o!=null&&o.__line__&&(this.line=o.__line__)}}function ai(u,...i){for(const o of i)for(const f in o)u[f]=o[f];return u}class cr extends Error{constructor(i,o){super(o),this.message=o,this.key=i}}class va{constructor(i,o=[]){this.parent=i,this.bindings={};for(const[f,v]of o)this.bindings[f]=v}concat(i){return new va(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const ba={kind:"null"},Mt={kind:"number"},ln={kind:"string"},Qt={kind:"boolean"},ha={kind:"color"},rl={kind:"projectionDefinition"},ki={kind:"object"},pn={kind:"value"},zs={kind:"collator"},ko={kind:"formatted"},kr={kind:"padding"},Dl={kind:"colorArray"},Os={kind:"numberArray"},ra={kind:"resolvedImage"},yi={kind:"variableAnchorOffsetCollection"};function Gi(u,i){return{kind:"array",itemType:u,N:i}}function Dr(u){if(u.kind==="array"){const i=Dr(u.itemType);return typeof u.N=="number"?`array<${i}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${i}>`}return u.kind}const Do=[ba,Mt,ln,Qt,ha,rl,ko,ki,Gi(pn),kr,Os,Dl,ra,yi];function Lo(u,i){if(i.kind==="error")return null;if(u.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Lo(u.itemType,i.itemType))&&(typeof u.N!="number"||u.N===i.N))return null}else{if(u.kind===i.kind)return null;if(u.kind==="value"){for(const o of Do)if(!Lo(o,i))return null}}return`Expected ${Dr(u)} but found ${Dr(i)} instead.`}function il(u,i){return i.some(o=>o.kind===u.kind)}function so(u,i){return i.some(o=>o==="null"?u===null:o==="array"?Array.isArray(u):o==="object"?u&&!Array.isArray(u)&&typeof u=="object":o===typeof u)}function ls(u,i){return u.kind==="array"&&i.kind==="array"?u.itemType.kind===i.itemType.kind&&typeof u.N=="number":u.kind===i.kind}const xa=.96422,_c=.82521,ld=4/29,oo=6/29,vc=3*oo*oo,Ll=oo*oo*oo,bu=Math.PI/180,Di=180/Math.PI;function Xa(u){return(u%=360)<0&&(u+=360),u}function Ns([u,i,o,f]){let v,T;const S=lo((.2225045*(u=zo(u))+.7168786*(i=zo(i))+.0606169*(o=zo(o)))/1);u===i&&i===o?v=T=S:(v=lo((.4360747*u+.3850649*i+.1430804*o)/xa),T=lo((.0139322*u+.0971045*i+.7141733*o)/_c));const I=116*S-16;return[I<0?0:I,500*(v-S),200*(S-T),f]}function zo(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function lo(u){return u>Ll?Math.pow(u,1/3):u/vc+ld}function Sr([u,i,o,f]){let v=(u+16)/116,T=isNaN(i)?v:v+i/500,S=isNaN(o)?v:v-o/200;return v=1*Oa(v),T=xa*Oa(T),S=_c*Oa(S),[Oo(3.1338561*T-1.6168667*v-.4906146*S),Oo(-.9787684*T+1.9161415*v+.033454*S),Oo(.0719453*T-.2289914*v+1.4052427*S),f]}function Oo(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function Oa(u){return u>oo?u*u*u:vc*(u-ld)}const wa=Object.hasOwn||function(u,i){return Object.prototype.hasOwnProperty.call(u,i)};function Rn(u,i){return wa(u,i)?u[i]:void 0}function us(u){return parseInt(u.padEnd(2,u),16)/255}function cs(u,i){return al(i?u/100:u,0,1)}function al(u,i,o){return Math.min(Math.max(i,u),o)}function dh(u){return!u.some(Number.isNaN)}const zl={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Li(u,i,o){return u+o*(i-u)}function zi(u,i,o){return u.map((f,v)=>Li(f,i[v],o))}class vn{constructor(i,o,f,v=1,T=!0){this.r=i,this.g=o,this.b=f,this.a=v,T||(this.r*=v,this.g*=v,this.b*=v,v||this.overwriteGetter("rgb",[i,o,f,v]))}static parse(i){if(i instanceof vn)return i;if(typeof i!="string")return;const o=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const v=Rn(zl,f);if(v){const[S,I,R]=v;return[S/255,I/255,R/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const S=f.length<6?1:2;let I=1;return[us(f.slice(I,I+=S)),us(f.slice(I,I+=S)),us(f.slice(I,I+=S)),us(f.slice(I,I+S)||"ff")]}if(f.startsWith("rgb")){const S=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[I,R,z,N,U,q,Y,J,te,le,ge,Le]=S,we=[N||" ",Y||" ",le].join("");if(we==="  "||we==="  /"||we===",,"||we===",,,"){const K=[z,q,te].join(""),se=K==="%%%"?100:K===""?255:0;if(se){const Se=[al(+R/se,0,1),al(+U/se,0,1),al(+J/se,0,1),ge?cs(+ge,Le):1];if(dh(Se))return Se}}return}}const T=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[S,I,R,z,N,U,q,Y,J]=T,te=[R||" ",N||" ",q].join("");if(te==="  "||te==="  /"||te===",,"||te===",,,"){const le=[+I,al(+z,0,100),al(+U,0,100),Y?cs(+Y,J):1];if(dh(le))return function([ge,Le,we,K]){function se(Se){const et=(Se+ge/30)%12,yt=Le*Math.min(we,1-we);return we-yt*Math.max(-1,Math.min(et-3,9-et,1))}return ge=Xa(ge),Le/=100,we/=100,[se(0),se(8),se(4),K]}(le)}}}(i);return o?new vn(...o,!1):void 0}get rgb(){const{r:i,g:o,b:f,a:v}=this,T=v||1/0;return this.overwriteGetter("rgb",[i/T,o/T,f/T,v])}get hcl(){return this.overwriteGetter("hcl",function(i){const[o,f,v,T]=Ns(i),S=Math.sqrt(f*f+v*v);return[Math.round(1e4*S)?Xa(Math.atan2(v,f)*Di):NaN,S,o,T]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ns(this.rgb))}overwriteGetter(i,o){return Object.defineProperty(this,i,{value:o}),o}toString(){const[i,o,f,v]=this.rgb;return`rgba(${[i,o,f].map(T=>Math.round(255*T)).join(",")},${v})`}static interpolate(i,o,f,v="rgb"){switch(v){case"rgb":{const[T,S,I,R]=zi(i.rgb,o.rgb,f);return new vn(T,S,I,R,!1)}case"hcl":{const[T,S,I,R]=i.hcl,[z,N,U,q]=o.hcl;let Y,J;if(isNaN(T)||isNaN(z))isNaN(T)?isNaN(z)?Y=NaN:(Y=z,I!==1&&I!==0||(J=N)):(Y=T,U!==1&&U!==0||(J=S));else{let we=z-T;z>T&&we>180?we-=360:z<T&&T-z>180&&(we+=360),Y=T+f*we}const[te,le,ge,Le]=function([we,K,se,Se]){return we=isNaN(we)?0:we*bu,Sr([se,Math.cos(we)*K,Math.sin(we)*K,Se])}([Y,J??Li(S,N,f),Li(I,U,f),Li(R,q,f)]);return new vn(te,le,ge,Le,!1)}case"lab":{const[T,S,I,R]=Sr(zi(i.lab,o.lab,f));return new vn(T,S,I,R,!1)}}}}vn.black=new vn(0,0,0,1),vn.white=new vn(1,1,1,1),vn.transparent=new vn(0,0,0,0),vn.red=new vn(1,0,0,1);class hs{constructor(i,o,f){this.sensitivity=i?o?"variant":"case":o?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,o){return this.collator.compare(i,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ol=["bottom","center","top"];class Bs{constructor(i,o,f,v,T,S){this.text=i,this.image=o,this.scale=f,this.fontStack=v,this.textColor=T,this.verticalAlign=S}}class Hi{constructor(i){this.sections=i}static fromString(i){return new Hi([new Bs(i,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof Hi?i:Hi.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class jr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof jr)return i;if(typeof i=="number")return new jr([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const o of i)if(typeof o!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new jr(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){return new jr(zi(i.values,o.values,f))}}class $r{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof $r)return i;if(typeof i=="number")return new $r([i]);if(Array.isArray(i)){for(const o of i)if(typeof o!="number")return;return new $r(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){return new $r(zi(i.values,o.values,f))}}class Er{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Er)return i;if(typeof i=="string"){const f=vn.parse(i);return f?new Er([f]):void 0}if(!Array.isArray(i))return;const o=[];for(const f of i){if(typeof f!="string")return;const v=vn.parse(f);if(!v)return;o.push(v)}return new Er(o)}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f,v="rgb"){const T=[];if(i.values.length!=o.values.length)throw new Error(`colorArray: Arrays have mismatched length (${i.values.length} vs. ${o.values.length}), cannot interpolate.`);for(let S=0;S<i.values.length;S++)T.push(vn.interpolate(i.values[S],o.values[S],f,v));return new Er(T)}}class pr extends Error{constructor(i){super(i),this.name="RuntimeError"}toJSON(){return this.message}}const ds=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class En{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof En)return i;if(Array.isArray(i)&&!(i.length<1)&&i.length%2==0){for(let o=0;o<i.length;o+=2){const f=i[o],v=i[o+1];if(typeof f!="string"||!ds.has(f)||!Array.isArray(v)||v.length!==2||typeof v[0]!="number"||typeof v[1]!="number")return}return new En(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){const v=i.values,T=o.values;if(v.length!==T.length)throw new pr(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${o.toString()}`);const S=[];for(let I=0;I<v.length;I+=2){if(v[I]!==T[I])throw new pr(`Cannot interpolate values containing mismatched anchors. from[${I}]: ${v[I]}, to[${I}]: ${T[I]}`);S.push(v[I]);const[R,z]=v[I+1],[N,U]=T[I+1];S.push([Li(R,N,f),Li(z,U,f)])}return new En(S)}}class fi{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new fi({name:i,available:!1}):null}}class mn{constructor(i,o,f){this.from=i,this.to=o,this.transition=f}static interpolate(i,o,f){return new mn(i,o,f)}static parse(i){return i instanceof mn?i:Array.isArray(i)&&i.length===3&&typeof i[0]=="string"&&typeof i[1]=="string"&&typeof i[2]=="number"?new mn(i[0],i[1],i[2]):typeof i=="object"&&typeof i.from=="string"&&typeof i.to=="string"&&typeof i.transition=="number"?new mn(i.from,i.to,i.transition):typeof i=="string"?new mn(i,i,1):void 0}}function dn(u,i,o,f){return typeof u=="number"&&u>=0&&u<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof o=="number"&&o>=0&&o<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[u,i,o,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[u,i,o,f]:[u,i,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ta(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof mn||u instanceof vn||u instanceof hs||u instanceof Hi||u instanceof jr||u instanceof $r||u instanceof Er||u instanceof En||u instanceof fi)return!0;if(Array.isArray(u)){for(const i of u)if(!Ta(i))return!1;return!0}if(typeof u=="object"){for(const i in u)if(!Ta(u[i]))return!1;return!0}return!1}function an(u){if(u===null)return ba;if(typeof u=="string")return ln;if(typeof u=="boolean")return Qt;if(typeof u=="number")return Mt;if(u instanceof vn)return ha;if(u instanceof mn)return rl;if(u instanceof hs)return zs;if(u instanceof Hi)return ko;if(u instanceof jr)return kr;if(u instanceof $r)return Os;if(u instanceof Er)return Dl;if(u instanceof En)return yi;if(u instanceof fi)return ra;if(Array.isArray(u)){const i=u.length;let o;for(const f of u){const v=an(f);if(o){if(o===v)continue;o=pn;break}o=v}return Gi(o||pn,i)}return ki}function Jr(u){const i=typeof u;return u===null?"":i==="string"||i==="number"||i==="boolean"?String(u):u instanceof vn||u instanceof mn||u instanceof Hi||u instanceof jr||u instanceof $r||u instanceof Er||u instanceof En||u instanceof fi?u.toString():JSON.stringify(u)}class Mn{constructor(i,o){this.type=i,this.value=o}static parse(i,o){if(i.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Ta(i[1]))return o.error("invalid value");const f=i[1];let v=an(f);const T=o.expectedType;return v.kind!=="array"||v.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(v=T),new Mn(v,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const uo={string:ln,number:Mt,boolean:Qt,object:ki};class ia{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let f,v=1;const T=i[0];if(T==="array"){let I,R;if(i.length>2){const z=i[1];if(typeof z!="string"||!(z in uo)||z==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);I=uo[z],v++}else I=pn;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return o.error('The length argument to "array" must be a positive integer literal',2);R=i[2],v++}f=Gi(I,R)}else{if(!uo[T])throw new Error(`Types doesn't contain name = ${T}`);f=uo[T]}const S=[];for(;v<i.length;v++){const I=o.parse(i[v],v,pn);if(!I)return null;S.push(I)}return new ia(f,S)}evaluate(i){for(let o=0;o<this.args.length;o++){const f=this.args[o].evaluate(i);if(!Lo(this.type,an(f)))return f;if(o===this.args.length-1)throw new pr(`Expected value to be of type ${Dr(this.type)}, but found ${Dr(an(f))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const bc={"to-boolean":Qt,"to-color":ha,"to-number":Mt,"to-string":ln};class Na{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const f=i[0];if(!bc[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&i.length!==2)return o.error("Expected one argument.");const v=bc[f],T=[];for(let S=1;S<i.length;S++){const I=o.parse(i[S],S,pn);if(!I)return null;T.push(I)}return new Na(v,T)}evaluate(i){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(i);case"color":{let o,f;for(const v of this.args){if(o=v.evaluate(i),f=null,o instanceof vn)return o;if(typeof o=="string"){const T=i.parseColor(o);if(T)return T}else if(Array.isArray(o)&&(f=o.length<3||o.length>4?`Invalid rgba value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:dn(o[0],o[1],o[2],o[3]),!f))return new vn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new pr(f||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const f of this.args){o=f.evaluate(i);const v=jr.parse(o);if(v)return v}throw new pr(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"numberArray":{let o;for(const f of this.args){o=f.evaluate(i);const v=$r.parse(o);if(v)return v}throw new pr(`Could not parse numberArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"colorArray":{let o;for(const f of this.args){o=f.evaluate(i);const v=Er.parse(o);if(v)return v}throw new pr(`Could not parse colorArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const f of this.args){o=f.evaluate(i);const v=En.parse(o);if(v)return v}throw new pr(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const f of this.args){if(o=f.evaluate(i),o===null)return 0;const v=Number(o);if(!isNaN(v))return v}throw new pr(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return Hi.fromString(Jr(this.args[0].evaluate(i)));case"resolvedImage":return fi.fromString(Jr(this.args[0].evaluate(i)));case"projectionDefinition":return this.args[0].evaluate(i);default:return Jr(this.args[0].evaluate(i))}}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const xu=["Unknown","Point","LineString","Polygon"];class co{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?xu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let o=this._parseColorCache.get(i);return o||(o=vn.parse(i),this._parseColorCache.set(i,o)),o}}class ho{constructor(i,o,f=[],v,T=new va,S=[]){this.registry=i,this.path=f,this.key=f.map(I=>`[${I}]`).join(""),this.scope=T,this.errors=S,this.expectedType=v,this._isConstant=o}parse(i,o,f,v,T={}){return o?this.concat(o,f,v)._parse(i,T):this._parse(i,T)}_parse(i,o){function f(v,T,S){return S==="assert"?new ia(T,[v]):S==="coerce"?new Na(T,[v]):v}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=i[0];if(typeof v!="string")return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[v];if(T){let S=T.parse(i,this);if(!S)return null;if(this.expectedType){const I=this.expectedType,R=S.type;if(I.kind!=="string"&&I.kind!=="number"&&I.kind!=="boolean"&&I.kind!=="object"&&I.kind!=="array"||R.kind!=="value"){if(I.kind==="projectionDefinition"&&["string","array"].includes(R.kind)||["color","formatted","resolvedImage"].includes(I.kind)&&["value","string"].includes(R.kind)||["padding","numberArray"].includes(I.kind)&&["value","number","array"].includes(R.kind)||I.kind==="colorArray"&&["value","string","array"].includes(R.kind)||I.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(R.kind))S=f(S,I,o.typeAnnotation||"coerce");else if(this.checkSubtype(I,R))return null}else S=f(S,I,o.typeAnnotation||"assert")}if(!(S instanceof Mn)&&S.type.kind!=="resolvedImage"&&this._isConstant(S)){const I=new co;try{S=new Mn(S.type,S.evaluate(I))}catch(R){return this.error(R.message),null}}return S}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,o,f){const v=typeof i=="number"?this.path.concat(i):this.path,T=f?this.scope.concat(f):this.scope;return new ho(this.registry,this._isConstant,v,o||null,T,this.errors)}error(i,...o){const f=`${this.key}${o.map(v=>`[${v}]`).join("")}`;this.errors.push(new cr(f,i))}checkSubtype(i,o){const f=Lo(i,o);return f&&this.error(f),f}}class Sa{constructor(i,o){this.type=o.type,this.bindings=[].concat(i),this.result=o}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const o of this.bindings)i(o[1]);i(this.result)}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const f=[];for(let T=1;T<i.length-1;T+=2){const S=i[T];if(typeof S!="string")return o.error(`Expected string, but found ${typeof S} instead.`,T);if(/[^a-zA-Z0-9_]/.test(S))return o.error("Variable names must contain only alphanumeric characters or '_'.",T);const I=o.parse(i[T+1],T+1);if(!I)return null;f.push([S,I])}const v=o.parse(i[i.length-1],i.length-1,o.expectedType,f);return v?new Sa(f,v):null}outputDefined(){return this.result.outputDefined()}}class Ya{constructor(i,o){this.type=o.type,this.name=i,this.boundExpression=o}static parse(i,o){if(i.length!==2||typeof i[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const f=i[1];return o.scope.has(f)?new Ya(f,o.scope.get(f)):o.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class Oi{constructor(i,o,f){this.type=i,this.index=o,this.input=f}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,Mt),v=o.parse(i[2],2,Gi(o.expectedType||pn));return f&&v?new Oi(v.type.itemType,f,v):null}evaluate(i){const o=this.index.evaluate(i),f=this.input.evaluate(i);if(o<0)throw new pr(`Array index out of bounds: ${o} < 0.`);if(o>=f.length)throw new pr(`Array index out of bounds: ${o} > ${f.length-1}.`);if(o!==Math.floor(o))throw new pr(`Array index must be an integer, but found ${o} instead.`);return f[o]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class Vs{constructor(i,o){this.type=Qt,this.needle=i,this.haystack=o}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,pn),v=o.parse(i[2],2,pn);return f&&v?il(f.type,[Qt,ln,Mt,ba,pn])?new Vs(f,v):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(f.type)} instead`):null}evaluate(i){const o=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!f)return!1;if(!so(o,["boolean","string","number","null"]))throw new pr(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(an(o))} instead.`);if(!so(f,["string","array"]))throw new pr(`Expected second argument to be of type array or string, but found ${Dr(an(f))} instead.`);return f.indexOf(o)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class No{constructor(i,o,f){this.type=Mt,this.needle=i,this.haystack=o,this.fromIndex=f}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,pn),v=o.parse(i[2],2,pn);if(!f||!v)return null;if(!il(f.type,[Qt,ln,Mt,ba,pn]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(f.type)} instead`);if(i.length===4){const T=o.parse(i[3],3,Mt);return T?new No(f,v,T):null}return new No(f,v)}evaluate(i){const o=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!so(o,["boolean","string","number","null"]))throw new pr(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(an(o))} instead.`);let v;if(this.fromIndex&&(v=this.fromIndex.evaluate(i)),so(f,["string"])){const T=f.indexOf(o,v);return T===-1?-1:[...f.slice(0,T)].length}if(so(f,["array"]))return f.indexOf(o,v);throw new pr(`Expected second argument to be of type array or string, but found ${Dr(an(f))} instead.`)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class Bo{constructor(i,o,f,v,T,S){this.inputType=i,this.type=o,this.input=f,this.cases=v,this.outputs=T,this.otherwise=S}static parse(i,o){if(i.length<5)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return o.error("Expected an even number of arguments.");let f,v;o.expectedType&&o.expectedType.kind!=="value"&&(v=o.expectedType);const T={},S=[];for(let z=2;z<i.length-1;z+=2){let N=i[z];const U=i[z+1];Array.isArray(N)||(N=[N]);const q=o.concat(z);if(N.length===0)return q.error("Expected at least one branch label.");for(const J of N){if(typeof J!="number"&&typeof J!="string")return q.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return q.error("Numeric branch labels must be integer values.");if(f){if(q.checkSubtype(f,an(J)))return null}else f=an(J);if(T[String(J)]!==void 0)return q.error("Branch labels must be unique.");T[String(J)]=S.length}const Y=o.parse(U,z,v);if(!Y)return null;v=v||Y.type,S.push(Y)}const I=o.parse(i[1],1,pn);if(!I)return null;const R=o.parse(i[i.length-1],i.length-1,v);return R?I.type.kind!=="value"&&o.concat(1).checkSubtype(f,I.type)?null:new Bo(f,v,I,T,S,R):null}evaluate(i){const o=this.input.evaluate(i);return(an(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class Xr{constructor(i,o,f){this.type=i,this.branches=o,this.otherwise=f}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return o.error("Expected an odd number of arguments.");let f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const v=[];for(let S=1;S<i.length-1;S+=2){const I=o.parse(i[S],S,Qt);if(!I)return null;const R=o.parse(i[S+1],S+1,f);if(!R)return null;v.push([I,R]),f=f||R.type}const T=o.parse(i[i.length-1],i.length-1,f);if(!T)return null;if(!f)throw new Error("Can't infer output type");return new Xr(f,v,T)}evaluate(i){for(const[o,f]of this.branches)if(o.evaluate(i))return f.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[o,f]of this.branches)i(o),i(f);i(this.otherwise)}outputDefined(){return this.branches.every(([i,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Nl{constructor(i,o,f,v){this.type=i,this.input=o,this.beginIndex=f,this.endIndex=v}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,pn),v=o.parse(i[2],2,Mt);if(!f||!v)return null;if(!il(f.type,[Gi(pn),ln,pn]))return o.error(`Expected first argument to be of type array or string, but found ${Dr(f.type)} instead`);if(i.length===4){const T=o.parse(i[3],3,Mt);return T?new Nl(f.type,f,v,T):null}return new Nl(f.type,f,v)}evaluate(i){const o=this.input.evaluate(i),f=this.beginIndex.evaluate(i);let v;if(this.endIndex&&(v=this.endIndex.evaluate(i)),so(o,["string"]))return[...o].slice(f,v).join("");if(so(o,["array"]))return o.slice(f,v);throw new pr(`Expected first argument to be of type array or string, but found ${Dr(an(o))} instead.`)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function fo(u,i){const o=u.length-1;let f,v,T=0,S=o,I=0;for(;T<=S;)if(I=Math.floor((T+S)/2),f=u[I],v=u[I+1],f<=i){if(I===o||i<v)return I;T=I+1}else{if(!(f>i))throw new pr("Input is not a number.");S=I-1}return 0}class Bl{constructor(i,o,f){this.type=i,this.input=o,this.labels=[],this.outputs=[];for(const[v,T]of f)this.labels.push(v),this.outputs.push(T)}static parse(i,o){if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");const f=o.parse(i[1],1,Mt);if(!f)return null;const v=[];let T=null;o.expectedType&&o.expectedType.kind!=="value"&&(T=o.expectedType);for(let S=1;S<i.length;S+=2){const I=S===1?-1/0:i[S],R=i[S+1],z=S,N=S+1;if(typeof I!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(v.length&&v[v.length-1][0]>=I)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const U=o.parse(R,N,T);if(!U)return null;T=T||U.type,v.push([I,U])}return new Bl(T,f,v)}evaluate(i){const o=this.labels,f=this.outputs;if(o.length===1)return f[0].evaluate(i);const v=this.input.evaluate(i);if(v<=o[0])return f[0].evaluate(i);const T=o.length;return v>=o[T-1]?f[T-1].evaluate(i):f[fo(o,v)].evaluate(i)}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function fh(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Qa,Vl,xc=function(){if(Vl)return Qa;function u(i,o,f,v){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(v-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=f,this.p2y=v}return Vl=1,Qa=u,u.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,v=0;v<8;v++){var T=this.sampleCurveX(f)-i;if(Math.abs(T)<o)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=T/S}var I=0,R=1;for(f=i,v=0;v<20&&(T=this.sampleCurveX(f),!(Math.abs(T-i)<o));v++)i>T?I=f:R=f,f=.5*(R-I)+I;return f},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},Qa}(),ph=fh(xc);class _i{constructor(i,o,f,v,T){this.type=i,this.operator=o,this.interpolation=f,this.input=v,this.labels=[],this.outputs=[];for(const[S,I]of T)this.labels.push(S),this.outputs.push(I)}static interpolationFactor(i,o,f,v){let T=0;if(i.name==="exponential")T=sl(o,i.base,f,v);else if(i.name==="linear")T=sl(o,1,f,v);else if(i.name==="cubic-bezier"){const S=i.controlPoints;T=new ph(S[0],S[1],S[2],S[3]).solve(sl(o,1,f,v))}return T}static parse(i,o){let[f,v,T,...S]=i;if(!Array.isArray(v)||v.length===0)return o.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const z=v[1];if(typeof z!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:z}}else{if(v[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const z=v.slice(1);if(z.length!==4||z.some(N=>typeof N!="number"||N<0||N>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:z}}}if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(T=o.parse(T,2,Mt),!T)return null;const I=[];let R=null;f!=="interpolate-hcl"&&f!=="interpolate-lab"||o.expectedType==Dl?o.expectedType&&o.expectedType.kind!=="value"&&(R=o.expectedType):R=ha;for(let z=0;z<S.length;z+=2){const N=S[z],U=S[z+1],q=z+3,Y=z+4;if(typeof N!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(I.length&&I[I.length-1][0]>=N)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const J=o.parse(U,Y,R);if(!J)return null;R=R||J.type,I.push([N,J])}return ls(R,Mt)||ls(R,rl)||ls(R,ha)||ls(R,kr)||ls(R,Os)||ls(R,Dl)||ls(R,yi)||ls(R,Gi(Mt))?new _i(R,f,v,T,I):o.error(`Type ${Dr(R)} is not interpolatable.`)}evaluate(i){const o=this.labels,f=this.outputs;if(o.length===1)return f[0].evaluate(i);const v=this.input.evaluate(i);if(v<=o[0])return f[0].evaluate(i);const T=o.length;if(v>=o[T-1])return f[T-1].evaluate(i);const S=fo(o,v),I=_i.interpolationFactor(this.interpolation,v,o[S],o[S+1]),R=f[S].evaluate(i),z=f[S+1].evaluate(i);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Li(R,z,I);case"color":return vn.interpolate(R,z,I);case"padding":return jr.interpolate(R,z,I);case"colorArray":return Er.interpolate(R,z,I);case"numberArray":return $r.interpolate(R,z,I);case"variableAnchorOffsetCollection":return En.interpolate(R,z,I);case"array":return zi(R,z,I);case"projectionDefinition":return mn.interpolate(R,z,I)}case"interpolate-hcl":switch(this.type.kind){case"color":return vn.interpolate(R,z,I,"hcl");case"colorArray":return Er.interpolate(R,z,I,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return vn.interpolate(R,z,I,"lab");case"colorArray":return Er.interpolate(R,z,I,"lab")}}}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function sl(u,i,o,f){const v=f-o,T=u-o;return v===0?0:i===1?T/v:(Math.pow(i,T)-1)/(Math.pow(i,v)-1)}const aa={color:vn.interpolate,number:Li,padding:jr.interpolate,numberArray:$r.interpolate,colorArray:Er.interpolate,variableAnchorOffsetCollection:En.interpolate,array:zi};class da{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let f=null;const v=o.expectedType;v&&v.kind!=="value"&&(f=v);const T=[];for(const I of i.slice(1)){const R=o.parse(I,1+T.length,f,void 0,{typeAnnotation:"omit"});if(!R)return null;f=f||R.type,T.push(R)}if(!f)throw new Error("No output type");const S=v&&T.some(I=>Lo(v,I.type));return new da(S?pn:f,T)}evaluate(i){let o,f=null,v=0;for(const T of this.args)if(v++,f=T.evaluate(i),f&&f instanceof fi&&!f.available&&(o||(o=f.name),f=null,v===this.args.length&&(f=o)),f!==null)break;return f}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}function wu(u,i){return u==="=="||u==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function fs(u,i,o,f){return f.compare(i,o)===0}function ol(u,i,o){const f=u!=="=="&&u!=="!=";return class AC{constructor(T,S,I){this.type=Qt,this.lhs=T,this.rhs=S,this.collator=I,this.hasUntypedArgument=T.type.kind==="value"||S.type.kind==="value"}static parse(T,S){if(T.length!==3&&T.length!==4)return S.error("Expected two or three arguments.");const I=T[0];let R=S.parse(T[1],1,pn);if(!R)return null;if(!wu(I,R.type))return S.concat(1).error(`"${I}" comparisons are not supported for type '${Dr(R.type)}'.`);let z=S.parse(T[2],2,pn);if(!z)return null;if(!wu(I,z.type))return S.concat(2).error(`"${I}" comparisons are not supported for type '${Dr(z.type)}'.`);if(R.type.kind!==z.type.kind&&R.type.kind!=="value"&&z.type.kind!=="value")return S.error(`Cannot compare types '${Dr(R.type)}' and '${Dr(z.type)}'.`);f&&(R.type.kind==="value"&&z.type.kind!=="value"?R=new ia(z.type,[R]):R.type.kind!=="value"&&z.type.kind==="value"&&(z=new ia(R.type,[z])));let N=null;if(T.length===4){if(R.type.kind!=="string"&&z.type.kind!=="string"&&R.type.kind!=="value"&&z.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(N=S.parse(T[3],3,zs),!N)return null}return new AC(R,z,N)}evaluate(T){const S=this.lhs.evaluate(T),I=this.rhs.evaluate(T);if(f&&this.hasUntypedArgument){const R=an(S),z=an(I);if(R.kind!==z.kind||R.kind!=="string"&&R.kind!=="number")throw new pr(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${R.kind}, ${z.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const R=an(S),z=an(I);if(R.kind!=="string"||z.kind!=="string")return i(T,S,I)}return this.collator?o(T,S,I,this.collator.evaluate(T)):i(T,S,I)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const wc=ol("==",function(u,i,o){return i===o},fs),ud=ol("!=",function(u,i,o){return i!==o},function(u,i,o,f){return!fs(0,i,o,f)}),cd=ol("<",function(u,i,o){return i<o},function(u,i,o,f){return f.compare(i,o)<0}),Tc=ol(">",function(u,i,o){return i>o},function(u,i,o,f){return f.compare(i,o)>0}),Ba=ol("<=",function(u,i,o){return i<=o},function(u,i,o,f){return f.compare(i,o)<=0}),Tu=ol(">=",function(u,i,o){return i>=o},function(u,i,o,f){return f.compare(i,o)>=0});class Su{constructor(i,o,f){this.type=zs,this.locale=f,this.caseSensitive=i,this.diacriticSensitive=o}static parse(i,o){if(i.length!==2)return o.error("Expected one argument.");const f=i[1];if(typeof f!="object"||Array.isArray(f))return o.error("Collator options argument must be an object.");const v=o.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Qt);if(!v)return null;const T=o.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Qt);if(!T)return null;let S=null;return f.locale&&(S=o.parse(f.locale,1,ln),!S)?null:new Su(v,T,S)}evaluate(i){return new hs(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}class ps{constructor(i,o,f,v,T){this.type=ln,this.number=i,this.locale=o,this.currency=f,this.minFractionDigits=v,this.maxFractionDigits=T}static parse(i,o){if(i.length!==3)return o.error("Expected two arguments.");const f=o.parse(i[1],1,Mt);if(!f)return null;const v=i[2];if(typeof v!="object"||Array.isArray(v))return o.error("NumberFormat options argument must be an object.");let T=null;if(v.locale&&(T=o.parse(v.locale,1,ln),!T))return null;let S=null;if(v.currency&&(S=o.parse(v.currency,1,ln),!S))return null;let I=null;if(v["min-fraction-digits"]&&(I=o.parse(v["min-fraction-digits"],1,Mt),!I))return null;let R=null;return v["max-fraction-digits"]&&(R=o.parse(v["max-fraction-digits"],1,Mt),!R)?null:new ps(f,T,S,I,R)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class A{constructor(i){this.type=ko,this.sections=i}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const f=i[1];if(!Array.isArray(f)&&typeof f=="object")return o.error("First argument must be an image or text section.");const v=[];let T=!1;for(let S=1;S<=i.length-1;++S){const I=i[S];if(T&&typeof I=="object"&&!Array.isArray(I)){T=!1;let R=null;if(I["font-scale"]&&(R=o.parse(I["font-scale"],1,Mt),!R))return null;let z=null;if(I["text-font"]&&(z=o.parse(I["text-font"],1,Gi(ln)),!z))return null;let N=null;if(I["text-color"]&&(N=o.parse(I["text-color"],1,ha),!N))return null;let U=null;if(I["vertical-align"]){if(typeof I["vertical-align"]=="string"&&!Ol.includes(I["vertical-align"]))return o.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${I["vertical-align"]}' instead.`);if(U=o.parse(I["vertical-align"],1,ln),!U)return null}const q=v[v.length-1];q.scale=R,q.font=z,q.textColor=N,q.verticalAlign=U}else{const R=o.parse(i[S],1,pn);if(!R)return null;const z=R.type.kind;if(z!=="string"&&z!=="value"&&z!=="null"&&z!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,v.push({content:R,scale:null,font:null,textColor:null,verticalAlign:null})}}return new A(v)}evaluate(i){return new Hi(this.sections.map(o=>{const f=o.content.evaluate(i);return an(f)===ra?new Bs("",f,null,null,null,o.verticalAlign?o.verticalAlign.evaluate(i):null):new Bs(Jr(f),null,o.scale?o.scale.evaluate(i):null,o.font?o.font.evaluate(i).join(","):null,o.textColor?o.textColor.evaluate(i):null,o.verticalAlign?o.verticalAlign.evaluate(i):null)}))}eachChild(i){for(const o of this.sections)i(o.content),o.scale&&i(o.scale),o.font&&i(o.font),o.textColor&&i(o.textColor),o.verticalAlign&&i(o.verticalAlign)}outputDefined(){return!1}}class F{constructor(i){this.type=ra,this.input=i}static parse(i,o){if(i.length!==2)return o.error("Expected two arguments.");const f=o.parse(i[1],1,ln);return f?new F(f):o.error("No image name provided.")}evaluate(i){const o=this.input.evaluate(i),f=fi.fromString(o);return f&&i.availableImages&&(f.available=i.availableImages.indexOf(o)>-1),f}eachChild(i){i(this.input)}outputDefined(){return!1}}class Z{constructor(i){this.type=Mt,this.input=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=o.parse(i[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${Dr(f.type)} instead.`):new Z(f):null}evaluate(i){const o=this.input.evaluate(i);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new pr(`Expected value to be of type string or array, but found ${Dr(an(o))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const ce=8192;function Qe(u,i){const o=(180+u[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,v=Math.pow(2,i.z);return[Math.round(o*v*ce),Math.round(f*v*ce)]}function dt(u,i){const o=Math.pow(2,i.z);return[(v=(u[0]/ce+i.x)/o,360*v-180),(f=(u[1]/ce+i.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90)];var f,v}function Nt(u,i){u[0]=Math.min(u[0],i[0]),u[1]=Math.min(u[1],i[1]),u[2]=Math.max(u[2],i[0]),u[3]=Math.max(u[3],i[1])}function $n(u,i){return!(u[0]<=i[0]||u[2]>=i[2]||u[1]<=i[1]||u[3]>=i[3])}function Ni(u,i,o){const f=u[0]-i[0],v=u[1]-i[1],T=u[0]-o[0],S=u[1]-o[1];return f*S-T*v==0&&f*T<=0&&v*S<=0}function qn(u,i,o,f){return(v=[f[0]-o[0],f[1]-o[1]])[0]*(T=[i[0]-u[0],i[1]-u[1]])[1]-v[1]*T[0]!=0&&!(!Fl(u,i,o,f)||!Fl(o,f,u,i));var v,T}function Zi(u,i,o){for(const f of o)for(let v=0;v<f.length-1;++v)if(qn(u,i,f[v],f[v+1]))return!0;return!1}function ei(u,i,o=!1){let f=!1;for(const I of i)for(let R=0;R<I.length-1;R++){if(Ni(u,I[R],I[R+1]))return o;(T=I[R])[1]>(v=u)[1]!=(S=I[R+1])[1]>v[1]&&v[0]<(S[0]-T[0])*(v[1]-T[1])/(S[1]-T[1])+T[0]&&(f=!f)}var v,T,S;return f}function ll(u,i){for(const o of i)if(ei(u,o))return!0;return!1}function sa(u,i){for(const o of u)if(!ei(o,i))return!1;for(let o=0;o<u.length-1;++o)if(Zi(u[o],u[o+1],i))return!1;return!0}function Vo(u,i){for(const o of i)if(sa(u,o))return!0;return!1}function Fl(u,i,o,f){const v=f[0]-o[0],T=f[1]-o[1],S=(u[0]-o[0])*T-v*(u[1]-o[1]),I=(i[0]-o[0])*T-v*(i[1]-o[1]);return S>0&&I<0||S<0&&I>0}function Sc(u,i,o){const f=[];for(let v=0;v<u.length;v++){const T=[];for(let S=0;S<u[v].length;S++){const I=Qe(u[v][S],o);Nt(i,I),T.push(I)}f.push(T)}return f}function Sf(u,i,o){const f=[];for(let v=0;v<u.length;v++){const T=Sc(u[v],i,o);f.push(T)}return f}function Ef(u,i,o,f){if(u[0]<o[0]||u[0]>o[2]){const v=.5*f;let T=u[0]-o[0]>v?-f:o[0]-u[0]>v?f:0;T===0&&(T=u[0]-o[2]>v?-f:o[2]-u[0]>v?f:0),u[0]+=T}Nt(i,u)}function mh(u,i,o,f){const v=Math.pow(2,f.z)*ce,T=[f.x*ce,f.y*ce],S=[];for(const I of u)for(const R of I){const z=[R.x+T[0],R.y+T[1]];Ef(z,i,o,v),S.push(z)}return S}function gh(u,i,o,f){const v=Math.pow(2,f.z)*ce,T=[f.x*ce,f.y*ce],S=[];for(const R of u){const z=[];for(const N of R){const U=[N.x+T[0],N.y+T[1]];Nt(i,U),z.push(U)}S.push(z)}if(i[2]-i[0]<=v/2){(I=i)[0]=I[1]=1/0,I[2]=I[3]=-1/0;for(const R of S)for(const z of R)Ef(z,i,o,v)}var I;return S}class Ul{constructor(i,o){this.type=Qt,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Ta(i[1])){const f=i[1];if(f.type==="FeatureCollection"){const v=[];for(const T of f.features){const{type:S,coordinates:I}=T.geometry;S==="Polygon"&&v.push(I),S==="MultiPolygon"&&v.push(...I)}if(v.length)return new Ul(f,{type:"MultiPolygon",coordinates:v})}else if(f.type==="Feature"){const v=f.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Ul(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Ul(f,f)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,f){const v=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(f.type==="Polygon"){const I=Sc(f.coordinates,T,S),R=mh(o.geometry(),v,T,S);if(!$n(v,T))return!1;for(const z of R)if(!ei(z,I))return!1}if(f.type==="MultiPolygon"){const I=Sf(f.coordinates,T,S),R=mh(o.geometry(),v,T,S);if(!$n(v,T))return!1;for(const z of R)if(!ll(z,I))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,f){const v=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(f.type==="Polygon"){const I=Sc(f.coordinates,T,S),R=gh(o.geometry(),v,T,S);if(!$n(v,T))return!1;for(const z of R)if(!sa(z,I))return!1}if(f.type==="MultiPolygon"){const I=Sf(f.coordinates,T,S),R=gh(o.geometry(),v,T,S);if(!$n(v,T))return!1;for(const z of R)if(!Vo(z,I))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Af=class{constructor(u=[],i=(o,f)=>o<f?-1:o>f?1:0){if(this.data=u,this.length=this.data.length,this.compare=i,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(u){this.data.push(u),this._up(this.length++)}pop(){if(this.length===0)return;const u=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:i,compare:o}=this,f=i[u];for(;u>0;){const v=u-1>>1,T=i[v];if(o(f,T)>=0)break;i[u]=T,u=v}i[u]=f}_down(u){const{data:i,compare:o}=this,f=this.length>>1,v=i[u];for(;u<f;){let T=1+(u<<1);const S=T+1;if(S<this.length&&o(i[S],i[T])<0&&(T=S),o(i[T],v)>=0)break;i[u]=i[T],u=T}i[u]=v}};function hd(u,i,o=0,f=u.length-1,v=Eg){for(;f>o;){if(f-o>600){const R=f-o+1,z=i-o+1,N=Math.log(R),U=.5*Math.exp(2*N/3),q=.5*Math.sqrt(N*U*(R-U)/R)*(z-R/2<0?-1:1);hd(u,i,Math.max(o,Math.floor(i-z*U/R+q)),Math.min(f,Math.floor(i+(R-z)*U/R+q)),v)}const T=u[i];let S=o,I=f;for(Ec(u,o,i),v(u[f],T)>0&&Ec(u,o,f);S<I;){for(Ec(u,S,I),S++,I--;v(u[S],T)<0;)S++;for(;v(u[I],T)>0;)I--}v(u[o],T)===0?Ec(u,o,I):(I++,Ec(u,I,f)),I<=i&&(o=I+1),i<=I&&(f=I-1)}}function Ec(u,i,o){const f=u[i];u[i]=u[o],u[o]=f}function Eg(u,i){return u<i?-1:u>i?1:0}function dd(u,i){if(u.length<=1)return[u];const o=[];let f,v;for(const T of u){const S=Xp(T);S!==0&&(T.area=Math.abs(S),v===void 0&&(v=S<0),v===S<0?(f&&o.push(f),f=[T]):f.push(T))}if(f&&o.push(f),i>1)for(let T=0;T<o.length;T++)o[T].length<=i||(hd(o[T],i,1,o[T].length-1,Ag),o[T]=o[T].slice(0,i));return o}function Ag(u,i){return i.area-u.area}function Xp(u){let i=0;for(let o,f,v=0,T=u.length,S=T-1;v<T;S=v++)o=u[v],f=u[S],i+=(f.x-o.x)*(o.y+f.y);return i}const Ja=1/298.257223563,Ac=Ja*(2-Ja),If=Math.PI/180;class fd{constructor(i){const o=6378.137*If*1e3,f=Math.cos(i*If),v=1/(1-Ac*(1-f*f)),T=Math.sqrt(v);this.kx=o*T*f,this.ky=o*T*v*(1-Ac)}distance(i,o){const f=this.wrap(i[0]-o[0])*this.kx,v=(i[1]-o[1])*this.ky;return Math.sqrt(f*f+v*v)}pointOnLine(i,o){let f,v,T,S,I=1/0;for(let R=0;R<i.length-1;R++){let z=i[R][0],N=i[R][1],U=this.wrap(i[R+1][0]-z)*this.kx,q=(i[R+1][1]-N)*this.ky,Y=0;U===0&&q===0||(Y=(this.wrap(o[0]-z)*this.kx*U+(o[1]-N)*this.ky*q)/(U*U+q*q),Y>1?(z=i[R+1][0],N=i[R+1][1]):Y>0&&(z+=U/this.kx*Y,N+=q/this.ky*Y)),U=this.wrap(o[0]-z)*this.kx,q=(o[1]-N)*this.ky;const J=U*U+q*q;J<I&&(I=J,f=z,v=N,T=R,S=Y)}return{point:[f,v],index:T,t:Math.max(0,Math.min(1,S))}}wrap(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}}function nr(u,i){return i[0]-u[0]}function yh(u){return u[1]-u[0]+1}function po(u,i){return u[1]>=u[0]&&u[1]<i}function Cf(u,i){if(u[0]>u[1])return[null,null];const o=yh(u);if(i){if(o===2)return[u,null];const v=Math.floor(o/2);return[[u[0],u[0]+v],[u[0]+v,u[1]]]}if(o===1)return[u,null];const f=Math.floor(o/2)-1;return[[u[0],u[0]+f],[u[0]+f+1,u[1]]]}function jl(u,i){if(!po(i,u.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let f=i[0];f<=i[1];++f)Nt(o,u[f]);return o}function _h(u){const i=[1/0,1/0,-1/0,-1/0];for(const o of u)for(const f of o)Nt(i,f);return i}function Ic(u){return u[0]!==-1/0&&u[1]!==-1/0&&u[2]!==1/0&&u[3]!==1/0}function vh(u,i,o){if(!Ic(u)||!Ic(i))return NaN;let f=0,v=0;return u[2]<i[0]&&(f=i[0]-u[2]),u[0]>i[2]&&(f=u[0]-i[2]),u[1]>i[3]&&(v=u[1]-i[3]),u[3]<i[1]&&(v=i[1]-u[3]),o.distance([0,0],[f,v])}function $l(u,i,o){const f=o.pointOnLine(i,u);return o.distance(u,f.point)}function ul(u,i,o,f,v){const T=Math.min($l(u,[o,f],v),$l(i,[o,f],v)),S=Math.min($l(o,[u,i],v),$l(f,[u,i],v));return Math.min(T,S)}function Cc(u,i,o,f,v){if(!po(i,u.length)||!po(f,o.length))return 1/0;let T=1/0;for(let S=i[0];S<i[1];++S){const I=u[S],R=u[S+1];for(let z=f[0];z<f[1];++z){const N=o[z],U=o[z+1];if(qn(I,R,N,U))return 0;T=Math.min(T,ul(I,R,N,U,v))}}return T}function Pf(u,i,o,f,v){if(!po(i,u.length)||!po(f,o.length))return NaN;let T=1/0;for(let S=i[0];S<=i[1];++S)for(let I=f[0];I<=f[1];++I)if(T=Math.min(T,v.distance(u[S],o[I])),T===0)return T;return T}function Yp(u,i,o){if(ei(u,i,!0))return 0;let f=1/0;for(const v of i){const T=v[0],S=v[v.length-1];if(T!==S&&(f=Math.min(f,$l(u,[S,T],o)),f===0))return f;const I=o.pointOnLine(v,u);if(f=Math.min(f,o.distance(u,I.point)),f===0)return f}return f}function Eu(u,i,o,f){if(!po(i,u.length))return NaN;for(let T=i[0];T<=i[1];++T)if(ei(u[T],o,!0))return 0;let v=1/0;for(let T=i[0];T<i[1];++T){const S=u[T],I=u[T+1];for(const R of o)for(let z=0,N=R.length,U=N-1;z<N;U=z++){const q=R[U],Y=R[z];if(qn(S,I,q,Y))return 0;v=Math.min(v,ul(S,I,q,Y,f))}}return v}function Mf(u,i){for(const o of u)for(const f of o)if(ei(f,i,!0))return!0;return!1}function Qp(u,i,o,f=1/0){const v=_h(u),T=_h(i);if(f!==1/0&&vh(v,T,o)>=f)return f;if($n(v,T)){if(Mf(u,i))return 0}else if(Mf(i,u))return 0;let S=1/0;for(const I of u)for(let R=0,z=I.length,N=z-1;R<z;N=R++){const U=I[N],q=I[R];for(const Y of i)for(let J=0,te=Y.length,le=te-1;J<te;le=J++){const ge=Y[le],Le=Y[J];if(qn(U,q,ge,Le))return 0;S=Math.min(S,ul(U,q,ge,Le,o))}}return S}function Rf(u,i,o,f,v,T){if(!T)return;const S=vh(jl(f,T),v,o);S<i&&u.push([S,T,[0,0]])}function pd(u,i,o,f,v,T,S){if(!T||!S)return;const I=vh(jl(f,T),jl(v,S),o);I<i&&u.push([I,T,S])}function md(u,i,o,f,v=1/0){let T=Math.min(f.distance(u[0],o[0][0]),v);if(T===0)return T;const S=new Af([[0,[0,u.length-1],[0,0]]],nr),I=_h(o);for(;S.length>0;){const R=S.pop();if(R[0]>=T)continue;const z=R[1],N=i?50:100;if(yh(z)<=N){if(!po(z,u.length))return NaN;if(i){const U=Eu(u,z,o,f);if(isNaN(U)||U===0)return U;T=Math.min(T,U)}else for(let U=z[0];U<=z[1];++U){const q=Yp(u[U],o,f);if(T=Math.min(T,q),T===0)return 0}}else{const U=Cf(z,i);Rf(S,T,f,u,I,U[0]),Rf(S,T,f,u,I,U[1])}}return T}function gd(u,i,o,f,v,T=1/0){let S=Math.min(T,v.distance(u[0],o[0]));if(S===0)return S;const I=new Af([[0,[0,u.length-1],[0,o.length-1]]],nr);for(;I.length>0;){const R=I.pop();if(R[0]>=S)continue;const z=R[1],N=R[2],U=i?50:100,q=f?50:100;if(yh(z)<=U&&yh(N)<=q){if(!po(z,u.length)&&po(N,o.length))return NaN;let Y;if(i&&f)Y=Cc(u,z,o,N,v),S=Math.min(S,Y);else if(i&&!f){const J=u.slice(z[0],z[1]+1);for(let te=N[0];te<=N[1];++te)if(Y=$l(o[te],J,v),S=Math.min(S,Y),S===0)return S}else if(!i&&f){const J=o.slice(N[0],N[1]+1);for(let te=z[0];te<=z[1];++te)if(Y=$l(u[te],J,v),S=Math.min(S,Y),S===0)return S}else Y=Pf(u,z,o,N,v),S=Math.min(S,Y)}else{const Y=Cf(z,i),J=Cf(N,f);pd(I,S,v,u,o,Y[0],J[0]),pd(I,S,v,u,o,Y[0],J[1]),pd(I,S,v,u,o,Y[1],J[0]),pd(I,S,v,u,o,Y[1],J[1])}}return S}function yd(u){return u.type==="MultiPolygon"?u.coordinates.map(i=>({type:"Polygon",coordinates:i})):u.type==="MultiLineString"?u.coordinates.map(i=>({type:"LineString",coordinates:i})):u.type==="MultiPoint"?u.coordinates.map(i=>({type:"Point",coordinates:i})):[u]}class ql{constructor(i,o){this.type=Mt,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Ta(i[1])){const f=i[1];if(f.type==="FeatureCollection")return new ql(f,f.features.map(v=>yd(v.geometry)).flat());if(f.type==="Feature")return new ql(f,yd(f.geometry));if("type"in f&&"coordinates"in f)return new ql(f,yd(f))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,f){const v=o.geometry(),T=v.flat().map(R=>dt([R.x,R.y],o.canonical));if(v.length===0)return NaN;const S=new fd(T[0][1]);let I=1/0;for(const R of f){switch(R.type){case"Point":I=Math.min(I,gd(T,!1,[R.coordinates],!1,S,I));break;case"LineString":I=Math.min(I,gd(T,!1,R.coordinates,!0,S,I));break;case"Polygon":I=Math.min(I,md(T,!1,R.coordinates,S,I))}if(I===0)return I}return I}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,f){const v=o.geometry(),T=v.flat().map(R=>dt([R.x,R.y],o.canonical));if(v.length===0)return NaN;const S=new fd(T[0][1]);let I=1/0;for(const R of f){switch(R.type){case"Point":I=Math.min(I,gd(T,!0,[R.coordinates],!1,S,I));break;case"LineString":I=Math.min(I,gd(T,!0,R.coordinates,!0,S,I));break;case"Polygon":I=Math.min(I,md(T,!0,R.coordinates,S,I))}if(I===0)return I}return I}(i,this.geometries);if(i.geometryType()==="Polygon")return function(o,f){const v=o.geometry();if(v.length===0||v[0].length===0)return NaN;const T=dd(v,0).map(R=>R.map(z=>z.map(N=>dt([N.x,N.y],o.canonical)))),S=new fd(T[0][0][0][1]);let I=1/0;for(const R of f)for(const z of T){switch(R.type){case"Point":I=Math.min(I,md([R.coordinates],!1,z,S,I));break;case"LineString":I=Math.min(I,md(R.coordinates,!0,z,S,I));break;case"Polygon":I=Math.min(I,Qp(z,R.coordinates,S,I))}if(I===0)return I}return I}(i,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Au{constructor(i){this.type=pn,this.key=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=i[1];return f==null?o.error("Global state property must be defined."):typeof f!="string"?o.error(`Global state property must be string, but found ${typeof i[1]} instead.`):new Au(f)}evaluate(i){var o;const f=(o=i.globals)===null||o===void 0?void 0:o.globalState;return f&&Object.keys(f).length!==0?Rn(f,this.key):null}eachChild(){}outputDefined(){return!1}}const Ea={"==":wc,"!=":ud,">":Tc,"<":cd,">=":Tu,"<=":Ba,array:ia,at:Oi,boolean:ia,case:Xr,coalesce:da,collator:Su,format:A,image:F,in:Vs,"index-of":No,interpolate:_i,"interpolate-hcl":_i,"interpolate-lab":_i,length:Z,let:Sa,literal:Mn,match:Bo,number:ia,"number-format":ps,object:ia,slice:Nl,step:Bl,string:ia,"to-boolean":Na,"to-color":Na,"to-number":Na,"to-string":Na,var:Ya,within:Ul,distance:ql,"global-state":Au};class ms{constructor(i,o,f,v){this.name=i,this.type=o,this._evaluate=f,this.args=v}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,o){const f=i[0],v=ms.definitions[f];if(!v)return o.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(v)?v[0]:v.type,S=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,I=S.filter(([z])=>!Array.isArray(z)||z.length===i.length-1);let R=null;for(const[z,N]of I){R=new ho(o.registry,Iu,o.path,null,o.scope);const U=[];let q=!1;for(let Y=1;Y<i.length;Y++){const J=i[Y],te=Array.isArray(z)?z[Y-1]:z.type,le=R.parse(J,1+U.length,te);if(!le){q=!0;break}U.push(le)}if(!q)if(Array.isArray(z)&&z.length!==U.length)R.error(`Expected ${z.length} arguments, but found ${U.length} instead.`);else{for(let Y=0;Y<U.length;Y++){const J=Array.isArray(z)?z[Y]:z.type,te=U[Y];R.concat(Y+1).checkSubtype(J,te.type)}if(R.errors.length===0)return new ms(f,T,N,U)}}if(I.length===1)o.errors.push(...R.errors);else{const z=(I.length?I:S).map(([U])=>{return q=U,Array.isArray(q)?`(${q.map(Dr).join(", ")})`:`(${Dr(q.type)}...)`;var q}).join(" | "),N=[];for(let U=1;U<i.length;U++){const q=o.parse(i[U],1+N.length);if(!q)return null;N.push(Dr(q.type))}o.error(`Expected arguments of type ${z}, but found (${N.join(", ")}) instead.`)}return null}static register(i,o){ms.definitions=o;for(const f in o)i[f]=ms}}function gs(u,[i,o,f,v]){i=i.evaluate(u),o=o.evaluate(u),f=f.evaluate(u);const T=v?v.evaluate(u):1,S=dn(i,o,f,T);if(S)throw new pr(S);return new vn(i/255,o/255,f/255,T,!1)}function ys(u,i){return u in i}function Gl(u,i){const o=i[u];return o===void 0?null:o}function cl(u){return{type:u}}function Iu(u){if(u instanceof Ya)return Iu(u.boundExpression);if(u instanceof ms&&u.name==="error"||u instanceof Su||u instanceof Ul||u instanceof ql||u instanceof Au)return!1;const i=u instanceof Na||u instanceof ia;let o=!0;return u.eachChild(f=>{o=i?o&&Iu(f):o&&f instanceof Mn}),!!o&&Cu(u)&&mo(u,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Cu(u){if(u instanceof ms&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Ul||u instanceof ql)return!1;let i=!0;return u.eachChild(o=>{i&&!Cu(o)&&(i=!1)}),i}function Pu(u){if(u instanceof ms&&u.name==="feature-state")return!1;let i=!0;return u.eachChild(o=>{i&&!Pu(o)&&(i=!1)}),i}function mo(u,i){if(u instanceof ms&&i.indexOf(u.name)>=0)return!1;let o=!0;return u.eachChild(f=>{o&&!mo(f,i)&&(o=!1)}),o}function kf(u){return{result:"success",value:u}}function hl(u){return{result:"error",value:u}}function go(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function Df(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function Va(u){return!!u.expression&&u.expression.interpolated}function kn(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function Fa(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)&&an(u)===ki}function Lf(u){return u}function bh(u,i){const o=u.stops&&typeof u.stops[0][0]=="object",f=o||!(o||u.property!==void 0),v=u.type||(Va(i)?"exponential":"interval"),T=function(N){switch(N.type){case"color":return vn.parse;case"padding":return jr.parse;case"numberArray":return $r.parse;case"colorArray":return Er.parse;default:return null}}(i);if(T&&((u=ai({},u)).stops&&(u.stops=u.stops.map(N=>[N[0],T(N[1])])),u.default=T(u.default?u.default:i.default)),u.colorSpace&&(S=u.colorSpace)!=="rgb"&&S!=="hcl"&&S!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var S;const I=function(N){switch(N){case"exponential":return Mu;case"interval":return Of;case"categorical":return zf;case"identity":return Ru;default:throw new Error(`Unknown function type "${N}"`)}}(v);let R,z;if(v==="categorical"){R=Object.create(null);for(const N of u.stops)R[N[0]]=N[1];z=typeof u.stops[0][0]}if(o){const N={},U=[];for(let J=0;J<u.stops.length;J++){const te=u.stops[J],le=te[0].zoom;N[le]===void 0&&(N[le]={zoom:le,type:u.type,property:u.property,default:u.default,stops:[]},U.push(le)),N[le].stops.push([te[0].value,te[1]])}const q=[];for(const J of U)q.push([N[J].zoom,bh(N[J],i)]);const Y={name:"linear"};return{kind:"composite",interpolationType:Y,interpolationFactor:_i.interpolationFactor.bind(void 0,Y),zoomStops:q.map(J=>J[0]),evaluate:({zoom:J},te)=>Mu({stops:q,base:u.base},i,J).evaluate(J,te)}}if(f){const N=v==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:_i.interpolationFactor.bind(void 0,N),zoomStops:u.stops.map(U=>U[0]),evaluate:({zoom:U})=>I(u,i,U,R,z)}}return{kind:"source",evaluate(N,U){const q=U&&U.properties?U.properties[u.property]:void 0;return q===void 0?yo(u.default,i.default):I(u,i,q,R,z)}}}function yo(u,i,o){return u!==void 0?u:i!==void 0?i:o!==void 0?o:void 0}function zf(u,i,o,f,v){return yo(typeof o===v?f[o]:void 0,u.default,i.default)}function Of(u,i,o){if(kn(o)!=="number")return yo(u.default,i.default);const f=u.stops.length;if(f===1||o<=u.stops[0][0])return u.stops[0][1];if(o>=u.stops[f-1][0])return u.stops[f-1][1];const v=fo(u.stops.map(T=>T[0]),o);return u.stops[v][1]}function Mu(u,i,o){const f=u.base!==void 0?u.base:1;if(kn(o)!=="number")return yo(u.default,i.default);const v=u.stops.length;if(v===1||o<=u.stops[0][0])return u.stops[0][1];if(o>=u.stops[v-1][0])return u.stops[v-1][1];const T=fo(u.stops.map(N=>N[0]),o),S=function(N,U,q,Y){const J=Y-q,te=N-q;return J===0?0:U===1?te/J:(Math.pow(U,te)-1)/(Math.pow(U,J)-1)}(o,f,u.stops[T][0],u.stops[T+1][0]),I=u.stops[T][1],R=u.stops[T+1][1],z=aa[i.type]||Lf;return typeof I.evaluate=="function"?{evaluate(...N){const U=I.evaluate.apply(void 0,N),q=R.evaluate.apply(void 0,N);if(U!==void 0&&q!==void 0)return z(U,q,S,u.colorSpace)}}:z(I,R,S,u.colorSpace)}function Ru(u,i,o){switch(i.type){case"color":o=vn.parse(o);break;case"formatted":o=Hi.fromString(o.toString());break;case"resolvedImage":o=fi.fromString(o.toString());break;case"padding":o=jr.parse(o);break;case"colorArray":o=Er.parse(o);break;case"numberArray":o=$r.parse(o);break;default:kn(o)===i.type||i.type==="enum"&&i.values[o]||(o=void 0)}return yo(o,u.default,i.default)}ms.register(Ea,{error:[{kind:"error"},[ln],(u,[i])=>{throw new pr(i.evaluate(u))}],typeof:[ln,[pn],(u,[i])=>Dr(an(i.evaluate(u)))],"to-rgba":[Gi(Mt,4),[ha],(u,[i])=>{const[o,f,v,T]=i.evaluate(u).rgb;return[255*o,255*f,255*v,T]}],rgb:[ha,[Mt,Mt,Mt],gs],rgba:[ha,[Mt,Mt,Mt,Mt],gs],has:{type:Qt,overloads:[[[ln],(u,[i])=>ys(i.evaluate(u),u.properties())],[[ln,ki],(u,[i,o])=>ys(i.evaluate(u),o.evaluate(u))]]},get:{type:pn,overloads:[[[ln],(u,[i])=>Gl(i.evaluate(u),u.properties())],[[ln,ki],(u,[i,o])=>Gl(i.evaluate(u),o.evaluate(u))]]},"feature-state":[pn,[ln],(u,[i])=>Gl(i.evaluate(u),u.featureState||{})],properties:[ki,[],u=>u.properties()],"geometry-type":[ln,[],u=>u.geometryType()],id:[pn,[],u=>u.id()],zoom:[Mt,[],u=>u.globals.zoom],"heatmap-density":[Mt,[],u=>u.globals.heatmapDensity||0],elevation:[Mt,[],u=>u.globals.elevation||0],"line-progress":[Mt,[],u=>u.globals.lineProgress||0],accumulated:[pn,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Mt,cl(Mt),(u,i)=>{let o=0;for(const f of i)o+=f.evaluate(u);return o}],"*":[Mt,cl(Mt),(u,i)=>{let o=1;for(const f of i)o*=f.evaluate(u);return o}],"-":{type:Mt,overloads:[[[Mt,Mt],(u,[i,o])=>i.evaluate(u)-o.evaluate(u)],[[Mt],(u,[i])=>-i.evaluate(u)]]},"/":[Mt,[Mt,Mt],(u,[i,o])=>i.evaluate(u)/o.evaluate(u)],"%":[Mt,[Mt,Mt],(u,[i,o])=>i.evaluate(u)%o.evaluate(u)],ln2:[Mt,[],()=>Math.LN2],pi:[Mt,[],()=>Math.PI],e:[Mt,[],()=>Math.E],"^":[Mt,[Mt,Mt],(u,[i,o])=>Math.pow(i.evaluate(u),o.evaluate(u))],sqrt:[Mt,[Mt],(u,[i])=>Math.sqrt(i.evaluate(u))],log10:[Mt,[Mt],(u,[i])=>Math.log(i.evaluate(u))/Math.LN10],ln:[Mt,[Mt],(u,[i])=>Math.log(i.evaluate(u))],log2:[Mt,[Mt],(u,[i])=>Math.log(i.evaluate(u))/Math.LN2],sin:[Mt,[Mt],(u,[i])=>Math.sin(i.evaluate(u))],cos:[Mt,[Mt],(u,[i])=>Math.cos(i.evaluate(u))],tan:[Mt,[Mt],(u,[i])=>Math.tan(i.evaluate(u))],asin:[Mt,[Mt],(u,[i])=>Math.asin(i.evaluate(u))],acos:[Mt,[Mt],(u,[i])=>Math.acos(i.evaluate(u))],atan:[Mt,[Mt],(u,[i])=>Math.atan(i.evaluate(u))],min:[Mt,cl(Mt),(u,i)=>Math.min(...i.map(o=>o.evaluate(u)))],max:[Mt,cl(Mt),(u,i)=>Math.max(...i.map(o=>o.evaluate(u)))],abs:[Mt,[Mt],(u,[i])=>Math.abs(i.evaluate(u))],round:[Mt,[Mt],(u,[i])=>{const o=i.evaluate(u);return o<0?-Math.round(-o):Math.round(o)}],floor:[Mt,[Mt],(u,[i])=>Math.floor(i.evaluate(u))],ceil:[Mt,[Mt],(u,[i])=>Math.ceil(i.evaluate(u))],"filter-==":[Qt,[ln,pn],(u,[i,o])=>u.properties()[i.value]===o.value],"filter-id-==":[Qt,[pn],(u,[i])=>u.id()===i.value],"filter-type-==":[Qt,[ln],(u,[i])=>u.geometryType()===i.value],"filter-<":[Qt,[ln,pn],(u,[i,o])=>{const f=u.properties()[i.value],v=o.value;return typeof f==typeof v&&f<v}],"filter-id-<":[Qt,[pn],(u,[i])=>{const o=u.id(),f=i.value;return typeof o==typeof f&&o<f}],"filter->":[Qt,[ln,pn],(u,[i,o])=>{const f=u.properties()[i.value],v=o.value;return typeof f==typeof v&&f>v}],"filter-id->":[Qt,[pn],(u,[i])=>{const o=u.id(),f=i.value;return typeof o==typeof f&&o>f}],"filter-<=":[Qt,[ln,pn],(u,[i,o])=>{const f=u.properties()[i.value],v=o.value;return typeof f==typeof v&&f<=v}],"filter-id-<=":[Qt,[pn],(u,[i])=>{const o=u.id(),f=i.value;return typeof o==typeof f&&o<=f}],"filter->=":[Qt,[ln,pn],(u,[i,o])=>{const f=u.properties()[i.value],v=o.value;return typeof f==typeof v&&f>=v}],"filter-id->=":[Qt,[pn],(u,[i])=>{const o=u.id(),f=i.value;return typeof o==typeof f&&o>=f}],"filter-has":[Qt,[pn],(u,[i])=>i.value in u.properties()],"filter-has-id":[Qt,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Qt,[Gi(ln)],(u,[i])=>i.value.indexOf(u.geometryType())>=0],"filter-id-in":[Qt,[Gi(pn)],(u,[i])=>i.value.indexOf(u.id())>=0],"filter-in-small":[Qt,[ln,Gi(pn)],(u,[i,o])=>o.value.indexOf(u.properties()[i.value])>=0],"filter-in-large":[Qt,[ln,Gi(pn)],(u,[i,o])=>function(f,v,T,S){for(;T<=S;){const I=T+S>>1;if(v[I]===f)return!0;v[I]>f?S=I-1:T=I+1}return!1}(u.properties()[i.value],o.value,0,o.value.length-1)],all:{type:Qt,overloads:[[[Qt,Qt],(u,[i,o])=>i.evaluate(u)&&o.evaluate(u)],[cl(Qt),(u,i)=>{for(const o of i)if(!o.evaluate(u))return!1;return!0}]]},any:{type:Qt,overloads:[[[Qt,Qt],(u,[i,o])=>i.evaluate(u)||o.evaluate(u)],[cl(Qt),(u,i)=>{for(const o of i)if(o.evaluate(u))return!0;return!1}]]},"!":[Qt,[Qt],(u,[i])=>!i.evaluate(u)],"is-supported-script":[Qt,[ln],(u,[i])=>{const o=u.globals&&u.globals.isSupportedScript;return!o||o(i.evaluate(u))}],upcase:[ln,[ln],(u,[i])=>i.evaluate(u).toUpperCase()],downcase:[ln,[ln],(u,[i])=>i.evaluate(u).toLowerCase()],concat:[ln,cl(pn),(u,i)=>i.map(o=>Jr(o.evaluate(u))).join("")],"resolved-locale":[ln,[zs],(u,[i])=>i.evaluate(u).resolvedLocale()]});class ku{constructor(i,o){this.expression=i,this._warningHistory={},this._evaluator=new co,this._defaultValue=o?function(f){if(f.type==="color"&&Fa(f.default))return new vn(0,0,0,0);switch(f.type){case"color":return vn.parse(f.default)||null;case"padding":return jr.parse(f.default)||null;case"numberArray":return $r.parse(f.default)||null;case"colorArray":return Er.parse(f.default)||null;case"variableAnchorOffsetCollection":return En.parse(f.default)||null;case"projectionDefinition":return mn.parse(f.default)||null;default:return f.default===void 0?null:f.default}}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(i,o,f,v,T,S){return this._evaluator.globals=i,this._evaluator.feature=o,this._evaluator.featureState=f,this._evaluator.canonical=v,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(i,o,f,v,T,S){this._evaluator.globals=i,this._evaluator.feature=o||null,this._evaluator.featureState=f||null,this._evaluator.canonical=v,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new pr(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function Du(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in Ea}function Ua(u,i){const o=new ho(Ea,Iu,[],i?function(v){const T={color:ha,string:ln,number:Mt,enum:ln,boolean:Qt,formatted:ko,padding:kr,numberArray:Os,colorArray:Dl,projectionDefinition:rl,resolvedImage:ra,variableAnchorOffsetCollection:yi};return v.type==="array"?Gi(T[v.value]||pn,v.length):T[v.type]}(i):void 0),f=o.parse(u,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?kf(new ku(f,i)):hl(o.errors)}class Aa{constructor(i,o){this.kind=i,this._styleExpression=o,this.isStateDependent=i!=="constant"&&!Pu(o.expression),this.globalStateRefs=Lu(o.expression)}evaluateWithoutErrorHandling(i,o,f,v,T,S){return this._styleExpression.evaluateWithoutErrorHandling(i,o,f,v,T,S)}evaluate(i,o,f,v,T,S){return this._styleExpression.evaluate(i,o,f,v,T,S)}}class Fo{constructor(i,o,f,v){this.kind=i,this.zoomStops=f,this._styleExpression=o,this.isStateDependent=i!=="camera"&&!Pu(o.expression),this.globalStateRefs=Lu(o.expression),this.interpolationType=v}evaluateWithoutErrorHandling(i,o,f,v,T,S){return this._styleExpression.evaluateWithoutErrorHandling(i,o,f,v,T,S)}evaluate(i,o,f,v,T,S){return this._styleExpression.evaluate(i,o,f,v,T,S)}interpolationFactor(i,o,f){return this.interpolationType?_i.interpolationFactor(this.interpolationType,i,o,f):0}}function _o(u,i){const o=Ua(u,i);if(o.result==="error")return o;const f=o.value.expression,v=Cu(f);if(!v&&!go(i))return hl([new cr("","data expressions not supported")]);const T=mo(f,["zoom"]);if(!T&&!Df(i))return hl([new cr("","zoom expressions not supported")]);const S=Fs(f);return S||T?S instanceof cr?hl([S]):S instanceof _i&&!Va(i)?hl([new cr("",'"interpolate" expressions cannot be used with this property')]):kf(S?new Fo(v?"camera":"composite",o.value,S.labels,S instanceof _i?S.interpolation:void 0):new Aa(v?"constant":"source",o.value)):hl([new cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class _s{constructor(i,o){this._parameters=i,this._specification=o,ai(this,bh(this._parameters,this._specification))}static deserialize(i){return new _s(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Fs(u){let i=null;if(u instanceof Sa)i=Fs(u.result);else if(u instanceof da){for(const o of u.args)if(i=Fs(o),i)break}else(u instanceof Bl||u instanceof _i)&&u.input instanceof ms&&u.input.name==="zoom"&&(i=u);return i instanceof cr||u.eachChild(o=>{const f=Fs(o);f instanceof cr?i=f:!i&&f?i=new cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&f&&i!==f&&(i=new cr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function Lu(u,i=new Set){return u instanceof Au&&i.add(u.key),u.eachChild(o=>{Lu(o,i)}),i}function zu(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const i of u.slice(1))if(!zu(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const xh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function pi(u){if(u==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};zu(u)||(u=Uo(u));const i=Ua(u,xh);if(i.result==="error")throw new Error(i.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,f,v)=>i.value.evaluate(o,f,{},v),needGeometry:or(u),getGlobalStateRefs:()=>Lu(i.value.expression)}}function mi(u,i){return u<i?-1:u>i?1:0}function or(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let i=1;i<u.length;i++)if(or(u[i]))return!0;return!1}function Uo(u){if(!u)return!0;const i=u[0];return u.length<=1?i!=="any":i==="=="?Us(u[1],u[2],"=="):i==="!="?Pc(Us(u[1],u[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Us(u[1],u[2],i):i==="any"?(o=u.slice(1),["any"].concat(o.map(Uo))):i==="all"?["all"].concat(u.slice(1).map(Uo)):i==="none"?["all"].concat(u.slice(1).map(Uo).map(Pc)):i==="in"?_d(u[1],u.slice(2)):i==="!in"?Pc(_d(u[1],u.slice(2))):i==="has"?Hl(u[1]):i!=="!has"||Pc(Hl(u[1]));var o}function Us(u,i,o){switch(u){case"$type":return[`filter-type-${o}`,i];case"$id":return[`filter-id-${o}`,i];default:return[`filter-${o}`,u,i]}}function _d(u,i){if(i.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(o=>typeof o!=typeof i[0])?["filter-in-large",u,["literal",i.sort(mi)]]:["filter-in-small",u,["literal",i]]}}function Hl(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Pc(u){return["!",u]}function wh(u){const i=typeof u;if(i==="number"||i==="boolean"||i==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let v="[";for(const T of u)v+=`${wh(T)},`;return`${v}]`}const o=Object.keys(u).sort();let f="{";for(let v=0;v<o.length;v++)f+=`${JSON.stringify(o[v])}:${wh(u[o[v]])},`;return`${f}}`}function Zl(u){let i="";for(const o of Lt)i+=`/${wh(u[o])}`;return i}function Mc(u){const i=u.value;return i?[new Pt(u.key,i,"constants have been deprecated as of v8")]:[]}function ti(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function js(u){if(Array.isArray(u))return u.map(js);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const i={};for(const o in u)i[o]=js(u[o]);return i}return ti(u)}function es(u){const i=u.key,o=u.value,f=u.valueSpec||{},v=u.objectElementValidators||{},T=u.style,S=u.styleSpec,I=u.validateSpec;let R=[];const z=kn(o);if(z!=="object")return[new Pt(i,o,`object expected, ${z} found`)];for(const N in o){const U=N.split(".")[0],q=Rn(f,U)||f["*"];let Y;if(Rn(v,U))Y=v[U];else if(Rn(f,U))Y=I;else if(v["*"])Y=v["*"];else{if(!f["*"]){R.push(new Pt(i,o[N],`unknown property "${N}"`));continue}Y=I}R=R.concat(Y({key:(i&&`${i}.`)+N,value:o[N],valueSpec:q,style:T,styleSpec:S,object:o,objectKey:N,validateSpec:I},o))}for(const N in f)v[N]||f[N].required&&f[N].default===void 0&&o[N]===void 0&&R.push(new Pt(i,o,`missing required property "${N}"`));return R}function jo(u){const i=u.value,o=u.valueSpec,f=u.style,v=u.styleSpec,T=u.key,S=u.arrayElementValidator||u.validateSpec;if(kn(i)!=="array")return[new Pt(T,i,`array expected, ${kn(i)} found`)];if(o.length&&i.length!==o.length)return[new Pt(T,i,`array length ${o.length} expected, length ${i.length} found`)];if(o["min-length"]&&i.length<o["min-length"])return[new Pt(T,i,`array length at least ${o["min-length"]} expected, length ${i.length} found`)];let I={type:o.value,values:o.values};v.$version<7&&(I.function=o.function),kn(o.value)==="object"&&(I=o.value);let R=[];for(let z=0;z<i.length;z++)R=R.concat(S({array:i,arrayIndex:z,value:i[z],valueSpec:I,validateSpec:u.validateSpec,style:f,styleSpec:v,key:`${T}[${z}]`}));return R}function vs(u){const i=u.key,o=u.value,f=u.valueSpec;let v=kn(o);return v==="number"&&o!=o&&(v="NaN"),v!=="number"?[new Pt(i,o,`number expected, ${v} found`)]:"minimum"in f&&o<f.minimum?[new Pt(i,o,`${o} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&o>f.maximum?[new Pt(i,o,`${o} is greater than the maximum value ${f.maximum}`)]:[]}function bs(u){const i=u.valueSpec,o=ti(u.value.type);let f,v,T,S={};const I=o!=="categorical"&&u.value.property===void 0,R=!I,z=kn(u.value.stops)==="array"&&kn(u.value.stops[0])==="array"&&kn(u.value.stops[0][0])==="object",N=es({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(Y){if(o==="identity")return[new Pt(Y.key,Y.value,'identity function may not have a "stops" property')];let J=[];const te=Y.value;return J=J.concat(jo({key:Y.key,value:te,valueSpec:Y.valueSpec,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:U})),kn(te)==="array"&&te.length===0&&J.push(new Pt(Y.key,te,"array must have at least one stop")),J},default:function(Y){return Y.validateSpec({key:Y.key,value:Y.value,valueSpec:i,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec})}}});return o==="identity"&&I&&N.push(new Pt(u.key,u.value,'missing required property "property"')),o==="identity"||u.value.stops||N.push(new Pt(u.key,u.value,'missing required property "stops"')),o==="exponential"&&u.valueSpec.expression&&!Va(u.valueSpec)&&N.push(new Pt(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(R&&!go(u.valueSpec)?N.push(new Pt(u.key,u.value,"property functions not supported")):I&&!Df(u.valueSpec)&&N.push(new Pt(u.key,u.value,"zoom functions not supported"))),o!=="categorical"&&!z||u.value.property!==void 0||N.push(new Pt(u.key,u.value,'"property" property is required')),N;function U(Y){let J=[];const te=Y.value,le=Y.key;if(kn(te)!=="array")return[new Pt(le,te,`array expected, ${kn(te)} found`)];if(te.length!==2)return[new Pt(le,te,`array length 2 expected, length ${te.length} found`)];if(z){if(kn(te[0])!=="object")return[new Pt(le,te,`object expected, ${kn(te[0])} found`)];if(te[0].zoom===void 0)return[new Pt(le,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new Pt(le,te,"object stop key must have value")];if(T&&T>ti(te[0].zoom))return[new Pt(le,te[0].zoom,"stop zoom values must appear in ascending order")];ti(te[0].zoom)!==T&&(T=ti(te[0].zoom),v=void 0,S={}),J=J.concat(es({key:`${le}[0]`,value:te[0],valueSpec:{zoom:{}},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:vs,value:q}}))}else J=J.concat(q({key:`${le}[0]`,value:te[0],validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec},te));return Du(js(te[1]))?J.concat([new Pt(`${le}[1]`,te[1],"expressions are not allowed in function stops.")]):J.concat(Y.validateSpec({key:`${le}[1]`,value:te[1],valueSpec:i,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec}))}function q(Y,J){const te=kn(Y.value),le=ti(Y.value),ge=Y.value!==null?Y.value:J;if(f){if(te!==f)return[new Pt(Y.key,ge,`${te} stop domain type must match previous stop domain type ${f}`)]}else f=te;if(te!=="number"&&te!=="string"&&te!=="boolean")return[new Pt(Y.key,ge,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&o!=="categorical"){let Le=`number expected, ${te} found`;return go(i)&&o===void 0&&(Le+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pt(Y.key,ge,Le)]}return o!=="categorical"||te!=="number"||isFinite(le)&&Math.floor(le)===le?o!=="categorical"&&te==="number"&&v!==void 0&&le<v?[new Pt(Y.key,ge,"stop domain values must appear in ascending order")]:(v=le,o==="categorical"&&le in S?[new Pt(Y.key,ge,"stop domain values must be unique")]:(S[le]=!0,[])):[new Pt(Y.key,ge,`integer expected, found ${le}`)]}}function ts(u){const i=(u.expressionContext==="property"?_o:Ua)(js(u.value),u.valueSpec);if(i.result==="error")return i.value.map(f=>new Pt(`${u.key}${f.key}`,u.value,f.message));const o=i.value.expression||i.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!o.outputDefined())return[new Pt(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!Pu(o))return[new Pt(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!Pu(o))return[new Pt(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!mo(o,["zoom","feature-state"]))return[new Pt(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!Cu(o))return[new Pt(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Th(u){const i=u.key,o=u.value,f=kn(o);return f!=="string"?[new Pt(i,o,`color expected, ${f} found`)]:vn.parse(String(o))?[]:[new Pt(i,o,`color expected, "${o}" found`)]}function Ou(u){const i=u.key,o=u.value,f=u.valueSpec,v=[];return Array.isArray(f.values)?f.values.indexOf(ti(o))===-1&&v.push(new Pt(i,o,`expected one of [${f.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(f.values).indexOf(ti(o))===-1&&v.push(new Pt(i,o,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(o)} found`)),v}function Nu(u){return zu(js(u.value))?ts(ai({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Sh(u)}function Sh(u){const i=u.value,o=u.key;if(kn(i)!=="array")return[new Pt(o,i,`array expected, ${kn(i)} found`)];const f=u.styleSpec;let v,T=[];if(i.length<1)return[new Pt(o,i,"filter array must have at least 1 element")];switch(T=T.concat(Ou({key:`${o}[0]`,value:i[0],valueSpec:f.filter_operator,style:u.style,styleSpec:u.styleSpec})),ti(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&ti(i[1])==="$type"&&T.push(new Pt(o,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&T.push(new Pt(o,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(v=kn(i[1]),v!=="string"&&T.push(new Pt(`${o}[1]`,i[1],`string expected, ${v} found`)));for(let S=2;S<i.length;S++)v=kn(i[S]),ti(i[1])==="$type"?T=T.concat(Ou({key:`${o}[${S}]`,value:i[S],valueSpec:f.geometry_type,style:u.style,styleSpec:u.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&T.push(new Pt(`${o}[${S}]`,i[S],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let S=1;S<i.length;S++)T=T.concat(Sh({key:`${o}[${S}]`,value:i[S],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":v=kn(i[1]),i.length!==2?T.push(new Pt(o,i,`filter array for "${i[0]}" operator must have 2 elements`)):v!=="string"&&T.push(new Pt(`${o}[1]`,i[1],`string expected, ${v} found`))}return T}function Kl(u,i){const o=u.key,f=u.validateSpec,v=u.style,T=u.styleSpec,S=u.value,I=u.objectKey,R=T[`${i}_${u.layerType}`];if(!R)return[];const z=I.match(/^(.*)-transition$/);if(i==="paint"&&z&&R[z[1]]&&R[z[1]].transition)return f({key:o,value:S,valueSpec:T.transition,style:v,styleSpec:T});const N=u.valueSpec||R[I];if(!N)return[new Pt(o,S,`unknown property "${I}"`)];let U;if(kn(S)==="string"&&go(N)&&!N.tokens&&(U=/^{([^}]+)}$/.exec(S)))return[new Pt(o,S,`"${I}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(U[1])} }\`.`)];const q=[];return u.layerType==="symbol"&&(I==="text-field"&&v&&!v.glyphs&&q.push(new Pt(o,S,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&Fa(js(S))&&ti(S.type)==="identity"&&q.push(new Pt(o,S,'"text-font" does not support identity functions'))),q.concat(f({key:u.key,value:S,valueSpec:N,style:v,styleSpec:T,expressionContext:"property",propertyType:i,propertyKey:I}))}function vi(u){return Kl(u,"paint")}function dl(u){return Kl(u,"layout")}function ja(u){let i=[];const o=u.value,f=u.key,v=u.style,T=u.styleSpec;if(kn(o)!=="object")return[new Pt(f,o,`object expected, ${kn(o)} found`)];o.type||o.ref||i.push(new Pt(f,o,'either "type" or "ref" is required'));let S=ti(o.type);const I=ti(o.ref);if(o.id){const R=ti(o.id);for(let z=0;z<u.arrayIndex;z++){const N=v.layers[z];ti(N.id)===R&&i.push(new Pt(f,o.id,`duplicate layer id "${o.id}", previously used at line ${N.id.__line__}`))}}if("ref"in o){let R;["type","source","source-layer","filter","layout"].forEach(z=>{z in o&&i.push(new Pt(f,o[z],`"${z}" is prohibited for ref layers`))}),v.layers.forEach(z=>{ti(z.id)===I&&(R=z)}),R?R.ref?i.push(new Pt(f,o.ref,"ref cannot reference another ref layer")):S=ti(R.type):i.push(new Pt(f,o.ref,`ref layer "${I}" not found`))}else if(S!=="background")if(o.source){const R=v.sources&&v.sources[o.source],z=R&&ti(R.type);R?z==="vector"&&S==="raster"?i.push(new Pt(f,o.source,`layer "${o.id}" requires a raster source`)):z!=="raster-dem"&&S==="hillshade"||z!=="raster-dem"&&S==="color-relief"?i.push(new Pt(f,o.source,`layer "${o.id}" requires a raster-dem source`)):z==="raster"&&S!=="raster"?i.push(new Pt(f,o.source,`layer "${o.id}" requires a vector source`)):z!=="vector"||o["source-layer"]?z==="raster-dem"&&S!=="hillshade"&&S!=="color-relief"?i.push(new Pt(f,o.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):S!=="line"||!o.paint||!o.paint["line-gradient"]||z==="geojson"&&R.lineMetrics||i.push(new Pt(f,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new Pt(f,o,`layer "${o.id}" must specify a "source-layer"`)):i.push(new Pt(f,o.source,`source "${o.source}" not found`))}else i.push(new Pt(f,o,'missing required property "source"'));return i=i.concat(es({key:f,value:o,valueSpec:T.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${f}.type`,value:o.type,valueSpec:T.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:o,objectKey:"type"}),filter:Nu,layout:R=>es({layer:o,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,validateSpec:R.validateSpec,objectElementValidators:{"*":z=>dl(ai({layerType:S},z))}}),paint:R=>es({layer:o,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,validateSpec:R.validateSpec,objectElementValidators:{"*":z=>vi(ai({layerType:S},z))}})}})),i}function vo(u){const i=u.value,o=u.key,f=kn(i);return f!=="string"?[new Pt(o,i,`string expected, ${f} found`)]:[]}const Nf={promoteId:function({key:u,value:i}){if(kn(i)==="string")return vo({key:u,value:i});{const o=[];for(const f in i)o.push(...vo({key:`${u}.${f}`,value:i[f]}));return o}}};function Jp(u){const i=u.value,o=u.key,f=u.styleSpec,v=u.style,T=u.validateSpec;if(!i.type)return[new Pt(o,i,'"type" is required')];const S=ti(i.type);let I;switch(S){case"vector":case"raster":return I=es({key:o,value:i,valueSpec:f[`source_${S.replace("-","_")}`],style:u.style,styleSpec:f,objectElementValidators:Nf,validateSpec:T}),I;case"raster-dem":return I=function(R){var z;const N=(z=R.sourceName)!==null&&z!==void 0?z:"",U=R.value,q=R.styleSpec,Y=q.source_raster_dem,J=R.style;let te=[];const le=kn(U);if(U===void 0)return te;if(le!=="object")return te.push(new Pt("source_raster_dem",U,`object expected, ${le} found`)),te;const ge=ti(U.encoding)==="custom",Le=["redFactor","greenFactor","blueFactor","baseShift"],we=R.value.encoding?`"${R.value.encoding}"`:"Default";for(const K in U)!ge&&Le.includes(K)?te.push(new Pt(K,U[K],`In "${N}": "${K}" is only valid when "encoding" is set to "custom". ${we} encoding found`)):Y[K]?te=te.concat(R.validateSpec({key:K,value:U[K],valueSpec:Y[K],validateSpec:R.validateSpec,style:J,styleSpec:q})):te.push(new Pt(K,U[K],`unknown property "${K}"`));return te}({sourceName:o,value:i,style:u.style,styleSpec:f,validateSpec:T}),I;case"geojson":if(I=es({key:o,value:i,valueSpec:f.source_geojson,style:v,styleSpec:f,validateSpec:T,objectElementValidators:Nf}),i.cluster)for(const R in i.clusterProperties){const[z,N]=i.clusterProperties[R],U=typeof z=="string"?[z,["accumulated"],["get",R]]:z;I.push(...ts({key:`${o}.${R}.map`,value:N,expressionContext:"cluster-map"})),I.push(...ts({key:`${o}.${R}.reduce`,value:U,expressionContext:"cluster-reduce"}))}return I;case"video":return es({key:o,value:i,valueSpec:f.source_video,style:v,validateSpec:T,styleSpec:f});case"image":return es({key:o,value:i,valueSpec:f.source_image,style:v,validateSpec:T,styleSpec:f});case"canvas":return[new Pt(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ou({key:`${o}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Bi(u){const i=u.value,o=u.styleSpec,f=o.light,v=u.style;let T=[];const S=kn(i);if(i===void 0)return T;if(S!=="object")return T=T.concat([new Pt("light",i,`object expected, ${S} found`)]),T;for(const I in i){const R=I.match(/^(.*)-transition$/);T=T.concat(R&&f[R[1]]&&f[R[1]].transition?u.validateSpec({key:I,value:i[I],valueSpec:o.transition,validateSpec:u.validateSpec,style:v,styleSpec:o}):f[I]?u.validateSpec({key:I,value:i[I],valueSpec:f[I],validateSpec:u.validateSpec,style:v,styleSpec:o}):[new Pt(I,i[I],`unknown property "${I}"`)])}return T}function Wl(u){const i=u.value,o=u.styleSpec,f=o.sky,v=u.style,T=kn(i);if(i===void 0)return[];if(T!=="object")return[new Pt("sky",i,`object expected, ${T} found`)];let S=[];for(const I in i)S=S.concat(f[I]?u.validateSpec({key:I,value:i[I],valueSpec:f[I],style:v,styleSpec:o}):[new Pt(I,i[I],`unknown property "${I}"`)]);return S}function Bu(u){const i=u.value,o=u.styleSpec,f=o.terrain,v=u.style;let T=[];const S=kn(i);if(i===void 0)return T;if(S!=="object")return T=T.concat([new Pt("terrain",i,`object expected, ${S} found`)]),T;for(const I in i)T=T.concat(f[I]?u.validateSpec({key:I,value:i[I],valueSpec:f[I],validateSpec:u.validateSpec,style:v,styleSpec:o}):[new Pt(I,i[I],`unknown property "${I}"`)]);return T}function Xl(u){let i=[];const o=u.value,f=u.key;if(Array.isArray(o)){const v=[],T=[];for(const S in o)o[S].id&&v.includes(o[S].id)&&i.push(new Pt(f,o,`all the sprites' ids must be unique, but ${o[S].id} is duplicated`)),v.push(o[S].id),o[S].url&&T.includes(o[S].url)&&i.push(new Pt(f,o,`all the sprites' URLs must be unique, but ${o[S].url} is duplicated`)),T.push(o[S].url),i=i.concat(es({key:`${f}[${S}]`,value:o[S],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return i}return vo({key:f,value:o})}function vd(u){return i=u.value,i&&i.constructor===Object?[]:[new Pt(u.key,u.value,`object expected, ${kn(u.value)} found`)];var i}const fl={"*":()=>[],array:jo,boolean:function(u){const i=u.value,o=u.key,f=kn(i);return f!=="boolean"?[new Pt(o,i,`boolean expected, ${f} found`)]:[]},number:vs,color:Th,constants:Mc,enum:Ou,filter:Nu,function:bs,layer:ja,object:es,source:Jp,light:Bi,sky:Wl,terrain:Bu,projection:function(u){const i=u.value,o=u.styleSpec,f=o.projection,v=u.style,T=kn(i);if(i===void 0)return[];if(T!=="object")return[new Pt("projection",i,`object expected, ${T} found`)];let S=[];for(const I in i)S=S.concat(f[I]?u.validateSpec({key:I,value:i[I],valueSpec:f[I],style:v,styleSpec:o}):[new Pt(I,i[I],`unknown property "${I}"`)]);return S},projectionDefinition:function(u){const i=u.key;let o=u.value;o=o instanceof String?o.valueOf():o;const f=kn(o);return f!=="array"||function(v){return Array.isArray(v)&&v.length===3&&typeof v[0]=="string"&&typeof v[1]=="string"&&typeof v[2]=="number"}(o)||function(v){return!!["interpolate","step","literal"].includes(v[0])}(o)?["array","string"].includes(f)?[]:[new Pt(i,o,`projection expected, invalid type "${f}" found`)]:[new Pt(i,o,`projection expected, invalid array ${JSON.stringify(o)} found`)]},string:vo,formatted:function(u){return vo(u).length===0?[]:ts(u)},resolvedImage:function(u){return vo(u).length===0?[]:ts(u)},padding:function(u){const i=u.key,o=u.value;if(kn(o)==="array"){if(o.length<1||o.length>4)return[new Pt(i,o,`padding requires 1 to 4 values; ${o.length} values found`)];const f={type:"number"};let v=[];for(let T=0;T<o.length;T++)v=v.concat(u.validateSpec({key:`${i}[${T}]`,value:o[T],validateSpec:u.validateSpec,valueSpec:f}));return v}return vs({key:i,value:o,valueSpec:{}})},numberArray:function(u){const i=u.key,o=u.value;if(kn(o)==="array"){const f={type:"number"};if(o.length<1)return[new Pt(i,o,"array length at least 1 expected, length 0 found")];let v=[];for(let T=0;T<o.length;T++)v=v.concat(u.validateSpec({key:`${i}[${T}]`,value:o[T],validateSpec:u.validateSpec,valueSpec:f}));return v}return vs({key:i,value:o,valueSpec:{}})},colorArray:function(u){const i=u.key,o=u.value;if(kn(o)==="array"){if(o.length<1)return[new Pt(i,o,"array length at least 1 expected, length 0 found")];let f=[];for(let v=0;v<o.length;v++)f=f.concat(Th({key:`${i}[${v}]`,value:o[v]}));return f}return Th({key:i,value:o})},variableAnchorOffsetCollection:function(u){const i=u.key,o=u.value,f=kn(o),v=u.styleSpec;if(f!=="array"||o.length<1||o.length%2!=0)return[new Pt(i,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let T=[];for(let S=0;S<o.length;S+=2)T=T.concat(Ou({key:`${i}[${S}]`,value:o[S],valueSpec:v.layout_symbol["text-anchor"]})),T=T.concat(jo({key:`${i}[${S+1}]`,value:o[S+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:v}));return T},sprite:Xl,state:vd};function pl(u){const i=u.value,o=u.valueSpec,f=u.styleSpec;return u.validateSpec=pl,o.expression&&Fa(ti(i))?bs(u):o.expression&&Du(js(i))?ts(u):o.type&&fl[o.type]?fl[o.type](u):es(ai({},u,{valueSpec:o.type?f[o.type]:o}))}function Rc(u){const i=u.value,o=u.key,f=vo(u);return f.length||(i.indexOf("{fontstack}")===-1&&f.push(new Pt(o,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&f.push(new Pt(o,i,'"glyphs" url must include a "{range}" token'))),f}function xs(u,i=ke){let o=[];return o=o.concat(pl({key:"",value:u,valueSpec:i.$root,styleSpec:i,style:u,validateSpec:pl,objectElementValidators:{glyphs:Rc,"*":()=>[]}})),u.constants&&(o=o.concat(Mc({key:"constants",value:u.constants}))),Bf(o)}function bo(u){return function(i){return u({...i,validateSpec:pl})}}function Bf(u){return[].concat(u).sort((i,o)=>i.line-o.line)}function bi(u){return function(...i){return Bf(u.apply(this,i))}}xs.source=bi(bo(Jp)),xs.sprite=bi(bo(Xl)),xs.glyphs=bi(bo(Rc)),xs.light=bi(bo(Bi)),xs.sky=bi(bo(Wl)),xs.terrain=bi(bo(Bu)),xs.state=bi(bo(vd)),xs.layer=bi(bo(ja)),xs.filter=bi(bo(Nu)),xs.paintProperty=bi(bo(vi)),xs.layoutProperty=bi(bo(dl));const Yl=xs,bd=Yl.light,Eh=Yl.sky,Ah=Yl.paintProperty,xd=Yl.layoutProperty;function Ql(u,i){let o=!1;if(i&&i.length)for(const f of i)u.fire(new Ge(new Error(f.message))),o=!0;return o}class Jl{constructor(i,o,f){const v=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const S=new Int32Array(this.arrayBuffer);i=S[0],this.d=(o=S[1])+2*(f=S[2]);for(let R=0;R<this.d*this.d;R++){const z=S[3+R],N=S[3+R+1];v.push(z===N?null:S.subarray(z,N))}const I=S[3+v.length+1];this.keys=S.subarray(S[3+v.length],I),this.bboxes=S.subarray(I),this.insert=this._insertReadonly}else{this.d=o+2*f;for(let S=0;S<this.d*this.d;S++)v.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=i,this.padding=f,this.scale=o/i,this.uid=0;const T=f/o*i;this.min=-T,this.max=i+T}insert(i,o,f,v,T){this._forEachCell(o,f,v,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(o),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,o,f,v,T,S){this.cells[T].push(S)}query(i,o,f,v,T){const S=this.min,I=this.max;if(i<=S&&o<=S&&I<=f&&I<=v&&!T)return Array.prototype.slice.call(this.keys);{const R=[];return this._forEachCell(i,o,f,v,this._queryCell,R,{},T),R}}_queryCell(i,o,f,v,T,S,I,R){const z=this.cells[T];if(z!==null){const N=this.keys,U=this.bboxes;for(let q=0;q<z.length;q++){const Y=z[q];if(I[Y]===void 0){const J=4*Y;(R?R(U[J+0],U[J+1],U[J+2],U[J+3]):i<=U[J+2]&&o<=U[J+3]&&f>=U[J+0]&&v>=U[J+1])?(I[Y]=!0,S.push(N[Y])):I[Y]=!1}}}}_forEachCell(i,o,f,v,T,S,I,R){const z=this._convertToCellCoord(i),N=this._convertToCellCoord(o),U=this._convertToCellCoord(f),q=this._convertToCellCoord(v);for(let Y=z;Y<=U;Y++)for(let J=N;J<=q;J++){const te=this.d*J+Y;if((!R||R(this._convertFromCellCoord(Y),this._convertFromCellCoord(J),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(J+1)))&&T.call(this,i,o,f,v,te,S,I,R))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,o=3+this.cells.length+1+1;let f=0;for(let S=0;S<this.cells.length;S++)f+=this.cells[S].length;const v=new Int32Array(o+f+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let T=o;for(let S=0;S<i.length;S++){const I=i[S];v[3+S]=T,v.set(I,T),T+=I.length}return v[3+i.length]=T,v.set(this.keys,T),T+=this.keys.length,v[3+i.length+1]=T,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer}static serialize(i,o){const f=i.toArrayBuffer();return o&&o.push(f),{buffer:f}}static deserialize(i){return new Jl(i.buffer)}}const xo={};function Ft(u,i,o={}){if(xo[u])throw new Error(`${u} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:u,writeable:!1}),xo[u]={klass:i,omit:o.omit||[],shallow:o.shallow||[]}}Ft("Object",Object),Ft("Set",Set),Ft("TransferableGridIndex",Jl),Ft("Color",vn),Ft("Error",Error),Ft("AJAXError",xe),Ft("ResolvedImage",fi),Ft("StylePropertyFunction",_s),Ft("StyleExpression",ku,{omit:["_evaluator"]}),Ft("ZoomDependentExpression",Fo),Ft("ZoomConstantExpression",Aa),Ft("CompoundExpression",ms,{omit:["_evaluate"]});for(const u in Ea)Ea[u]._classRegistryKey||Ft(`Expression_${u}`,Ea[u]);function wd(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function ml(u){return u.$name||u.constructor._classRegistryKey}function Td(u){return!function(i){if(i===null||typeof i!="object")return!1;const o=ml(i);return!(!o||o==="Object")}(u)&&(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error||wd(u)||Wa(u)||ArrayBuffer.isView(u)||u instanceof ImageData)}function kc(u,i){if(Td(u))return(wd(u)||Wa(u))&&i&&i.push(u),ArrayBuffer.isView(u)&&i&&i.push(u.buffer),u instanceof ImageData&&i&&i.push(u.data.buffer),u;if(Array.isArray(u)){const T=[];for(const S of u)T.push(kc(S,i));return T}if(typeof u!="object")throw new Error("can't serialize object of type "+typeof u);const o=ml(u);if(!o)throw new Error(`can't serialize object of unregistered class ${u.constructor.name}`);if(!xo[o])throw new Error(`${o} is not registered.`);const{klass:f}=xo[o],v=f.serialize?f.serialize(u,i):{};if(f.serialize){if(i&&v===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in u){if(!u.hasOwnProperty(T)||xo[o].omit.indexOf(T)>=0)continue;const S=u[T];v[T]=xo[o].shallow.indexOf(T)>=0?S:kc(S,i)}u instanceof Error&&(v.message=u.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(v.$name=o),v}function ws(u){if(Td(u))return u;if(Array.isArray(u))return u.map(ws);if(typeof u!="object")throw new Error("can't deserialize object of type "+typeof u);const i=ml(u)||"Object";if(!xo[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:o}=xo[i];if(!o)throw new Error(`can't deserialize unregistered class ${i}`);if(o.deserialize)return o.deserialize(u);const f=Object.create(o.prototype);for(const v of Object.keys(u)){if(v==="$name")continue;const T=u[v];f[v]=xo[i].shallow.indexOf(v)>=0?T:ws(T)}return f}class Ih{constructor(){this.first=!0}update(i,o){const f=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=o),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=f,!0))}}const Dn={"Latin-1 Supplement":u=>u>=128&&u<=255,"Hangul Jamo":u=>u>=4352&&u<=4607,Khmer:u=>u>=6016&&u<=6143,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Kanbun:u=>u>=12688&&u<=12703,"CJK Strokes":u=>u>=12736&&u<=12783,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Hangul Syllables":u=>u>=44032&&u<=55215,"Private Use Area":u=>u>=57344&&u<=63743,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function $o(u){for(const i of u)if(tu(i.charCodeAt(0)))return!0;return!1}function gl(u){for(const i of u)if(!Ff(i.charCodeAt(0)))return!1;return!0}function eu(u){const i=u.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(i.join("|"),"u")}const Vf=eu(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ff(u){return!Vf.test(String.fromCodePoint(u))}const Vu=eu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function tu(u){return!(u!==746&&u!==747&&(u<4352||!(Dn["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||Dn["CJK Compatibility"](u)||Dn["CJK Strokes"](u)||!(!Dn["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||Dn["Enclosed CJK Letters and Months"](u)||Dn["Ideographic Description Characters"](u)||Dn.Kanbun(u)||Dn.Katakana(u)&&u!==12540||!(!Dn["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!Dn["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||Dn["Vertical Forms"](u)||Dn["Yijing Hexagram Symbols"](u)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(u))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(u))||Vu.test(String.fromCodePoint(u)))))}function Sd(u){return!(tu(u)||function(i){return!!(Dn["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Dn["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Dn["Letterlike Symbols"](i)||Dn["Number Forms"](i)||Dn["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Dn["Control Pictures"](i)&&i!==9251||Dn["Optical Character Recognition"](i)||Dn["Enclosed Alphanumerics"](i)||Dn["Geometric Shapes"](i)||Dn["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Dn["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Dn["CJK Symbols and Punctuation"](i)||Dn.Katakana(i)||Dn["Private Use Area"](i)||Dn["CJK Compatibility Forms"](i)||Dn["Small Form Variants"](i)||Dn["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(u))}const Uf=eu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function qo(u){return Uf.test(String.fromCodePoint(u))}function Ed(u,i){return!(!i&&qo(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||Dn.Khmer(u))}function Ad(u){for(const i of u)if(qo(i.charCodeAt(0)))return!0;return!1}const Go=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(u){this.pluginStatus=u.pluginStatus,this.pluginURL=u.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(u){if(Go.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=u.applyArabicShaping,this.processBidirectionalText=u.processBidirectionalText,this.processStyledBidirectionalText=u.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(u,i){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(u.pluginStatus!=="loading")return this.setState(u),u;const o=u.pluginURL,f=new Promise(T=>{this.loadScriptResolve=T});i(o);const v=new Promise(T=>setTimeout(()=>T(),this.TIMEOUT));if(yield Promise.race([f,v]),this.isParsed()){const T={pluginStatus:"loaded",pluginURL:o};return this.setState(T),T}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${o}`)})}};class Lr{constructor(i,o){this.zoom=i,o?(this.now=o.now||0,this.fadeDuration=o.fadeDuration||0,this.zoomHistory=o.zoomHistory||new Ih,this.transition=o.transition||{},this.globalState=o.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ih,this.transition={},this.globalState={})}isSupportedScript(i){return function(o,f){for(const v of o)if(!Ed(v.charCodeAt(0),f))return!1;return!0}(i,Go.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,o=i-Math.floor(i),f=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*o}}}class $s{constructor(i,o){this.property=i,this.value=o,this.expression=function(f,v){if(Fa(f))return new _s(f,v);if(Du(f)){const T=_o(f,v);if(T.result==="error")throw new Error(T.value.map(S=>`${S.key}: ${S.message}`).join(", "));return T.value}{let T=f;return v.type==="color"&&typeof f=="string"?T=vn.parse(f):v.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?v.type!=="numberArray"||typeof f!="number"&&!Array.isArray(f)?v.type!=="colorArray"||typeof f!="string"&&!Array.isArray(f)?v.type==="variableAnchorOffsetCollection"&&Array.isArray(f)?T=En.parse(f):v.type==="projectionDefinition"&&typeof f=="string"&&(T=mn.parse(f)):T=Er.parse(f):T=$r.parse(f):T=jr.parse(f),{globalStateRefs:new Set,kind:"constant",evaluate:()=>T}}}(o===void 0?i.specification.default:o,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(i,o,f){return this.property.possiblyEvaluate(this,i,o,f)}}class Ln{constructor(i){this.property=i,this.value=new $s(i,void 0)}transitioned(i,o){return new xi(this.property,this.value,o,gi({},i.transition,this.transition),i.now)}untransitioned(){return new xi(this.property,this.value,null,{},0)}}class mr{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return _a(this._values[i].value.value)}setValue(i,o){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Ln(this._values[i].property)),this._values[i].value=new $s(this._values[i].property,o===null?void 0:_a(o))}getTransition(i){return _a(this._values[i].transition)}setTransition(i,o){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Ln(this._values[i].property)),this._values[i].transition=_a(o)||void 0}serialize(){const i={};for(const o of Object.keys(this._values)){const f=this.getValue(o);f!==void 0&&(i[o]=f);const v=this.getTransition(o);v!==void 0&&(i[`${o}-transition`]=v)}return i}transitioned(i,o){const f=new Ch(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].transitioned(i,o._values[v]);return f}untransitioned(){const i=new Ch(this._properties);for(const o of Object.keys(this._values))i._values[o]=this._values[o].untransitioned();return i}}class xi{constructor(i,o,f,v,T){this.property=i,this.value=o,this.begin=T+v.delay||0,this.end=this.begin+v.duration||0,i.specification.transition&&(v.delay||v.duration)&&(this.prior=f)}possiblyEvaluate(i,o,f){const v=i.now||0,T=this.value.possiblyEvaluate(i,o,f),S=this.prior;if(S){if(v>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(v<this.begin)return S.possiblyEvaluate(i,o,f);{const I=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(i,o,f),T,fn(I))}}return T}}class Ch{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,o,f){const v=new Fu(this._properties);for(const T of Object.keys(this._values))v._values[T]=this._values[T].possiblyEvaluate(i,o,f);return v}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Dc{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}hasValue(i){return this._values[i].value!==void 0}getValue(i){return _a(this._values[i].value)}setValue(i,o){this._values[i]=new $s(this._values[i].property,o===null?void 0:_a(o))}serialize(){const i={};for(const o of Object.keys(this._values)){const f=this.getValue(o);f!==void 0&&(i[o]=f)}return i}possiblyEvaluate(i,o,f){const v=new Fu(this._properties);for(const T of Object.keys(this._values))v._values[T]=this._values[T].possiblyEvaluate(i,o,f);return v}}class Ia{constructor(i,o,f){this.property=i,this.value=o,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,o,f,v){return this.property.evaluate(this.value,this.parameters,i,o,f,v)}}class Fu{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class jt{constructor(i){this.specification=i}possiblyEvaluate(i,o){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(o)}interpolate(i,o,f){const v=aa[this.specification.type];return v?v(i,o,f):i}}class Jt{constructor(i,o){this.specification=i,this.overrides=o}possiblyEvaluate(i,o,f,v){return new Ia(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(o,null,{},f,v)}:i.expression,o)}interpolate(i,o,f){if(i.value.kind!=="constant"||o.value.kind!=="constant")return i;if(i.value.value===void 0||o.value.value===void 0)return new Ia(this,{kind:"constant",value:void 0},i.parameters);const v=aa[this.specification.type];if(v){const T=v(i.value.value,o.value.value,f);return new Ia(this,{kind:"constant",value:T},i.parameters)}return i}evaluate(i,o,f,v,T,S){return i.kind==="constant"?i.value:i.evaluate(o,f,v,T,S)}}class Id extends Jt{possiblyEvaluate(i,o,f,v){if(i.value===void 0)return new Ia(this,{kind:"constant",value:void 0},o);if(i.expression.kind==="constant"){const T=i.expression.evaluate(o,null,{},f,v),S=i.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,I=this._calculate(S,S,S,o);return new Ia(this,{kind:"constant",value:I},o)}if(i.expression.kind==="camera"){const T=this._calculate(i.expression.evaluate({zoom:o.zoom-1}),i.expression.evaluate({zoom:o.zoom}),i.expression.evaluate({zoom:o.zoom+1}),o);return new Ia(this,{kind:"constant",value:T},o)}return new Ia(this,i.expression,o)}evaluate(i,o,f,v,T,S){if(i.kind==="source"){const I=i.evaluate(o,f,v,T,S);return this._calculate(I,I,I,o)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(o.zoom)-1},f,v),i.evaluate({zoom:Math.floor(o.zoom)},f,v),i.evaluate({zoom:Math.floor(o.zoom)+1},f,v),o):i.value}_calculate(i,o,f,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:i,to:o}:{from:f,to:o}}interpolate(i){return i}}class si{constructor(i){this.specification=i}possiblyEvaluate(i,o,f,v){if(i.value!==void 0){if(i.expression.kind==="constant"){const T=i.expression.evaluate(o,null,{},f,v);return this._calculate(T,T,T,o)}return this._calculate(i.expression.evaluate(new Lr(Math.floor(o.zoom-1),o)),i.expression.evaluate(new Lr(Math.floor(o.zoom),o)),i.expression.evaluate(new Lr(Math.floor(o.zoom+1),o)),o)}}_calculate(i,o,f,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:i,to:o}:{from:f,to:o}}interpolate(i){return i}}class Uu{constructor(i){this.specification=i}possiblyEvaluate(i,o,f,v){return!!i.expression.evaluate(o,null,{},f,v)}interpolate(){return!1}}class fa{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in i){const f=i[o];f.specification.overridable&&this.overridableProperties.push(o);const v=this.defaultPropertyValues[o]=new $s(f,void 0),T=this.defaultTransitionablePropertyValues[o]=new Ln(f);this.defaultTransitioningPropertyValues[o]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=v.possiblyEvaluate({})}}}Ft("DataDrivenProperty",Jt),Ft("DataConstantProperty",jt),Ft("CrossFadedDataDrivenProperty",Id),Ft("CrossFadedProperty",si),Ft("ColorRampProperty",Uu);const jf="-transition";class oa extends ft{constructor(i,o){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter,this._featureFilter=pi(i.filter)),o.layout&&(this._unevaluatedLayout=new Dc(o.layout)),o.paint)){this._transitionablePaint=new mr(o.paint);for(const f in i.paint)this.setPaintProperty(f,i.paint[f],{validate:!1});for(const f in i.layout)this.setLayoutProperty(f,i.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fu(o.paint)}}setFilter(i){this.filter=i,this._featureFilter=pi(i)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}getLayoutAffectingGlobalStateRefs(){const i=new Set;if(this._unevaluatedLayout)for(const o in this._unevaluatedLayout._values){const f=this._unevaluatedLayout._values[o];for(const v of f.getGlobalStateRefs())i.add(v)}for(const o of this._featureFilter.getGlobalStateRefs())i.add(o);return i}setLayoutProperty(i,o,f={}){o!=null&&this._validate(xd,`layers.${this.id}.layout.${i}`,i,o,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,o):this.visibility=o)}getPaintProperty(i){return i.endsWith(jf)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,o,f={}){if(o!=null&&this._validate(Ah,`layers.${this.id}.paint.${i}`,i,o,f))return!1;if(i.endsWith(jf))return this._transitionablePaint.setTransition(i.slice(0,-11),o||void 0),!1;{const v=this._transitionablePaint._values[i],T=v.property.specification["property-type"]==="cross-faded-data-driven",S=v.value.isDataDriven(),I=v.value;this._transitionablePaint.setValue(i,o),this._handleSpecialPaintPropertyUpdate(i);const R=this._transitionablePaint._values[i].value;return R.isDataDriven()||S||T||this._handleOverridablePaintPropertyUpdate(i,I,R)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,o,f){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,o){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,o)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),ya(i,(o,f)=>!(o===void 0||f==="layout"&&!Object.keys(o).length||f==="paint"&&!Object.keys(o).length))}_validate(i,o,f,v,T={}){return(!T||T.validate!==!1)&&Ql(this,i.call(Yl,{key:o,layerType:this.type,objectKey:f,value:v,styleSpec:ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const o=this.paint.get(i);if(o instanceof Ia&&go(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const em={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class yl{constructor(i,o){this._structArray=i,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class qr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,o){return i._trim(),o&&(i.isTransferred=!0,o.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const o=Object.create(this.prototype);return o.arrayBuffer=i.arrayBuffer,o.length=i.length,o.capacity=i.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Yr(u,i=1){let o=0,f=0;return{members:u.map(v=>{const T=em[v.type].BYTES_PER_ELEMENT,S=o=$a(o,Math.max(i,T)),I=v.components||1;return f=Math.max(f,T),o+=T*I,{name:v.name,type:v.type,components:I,offset:S}}),size:$a(o,Math.max(f,i)),alignment:i}}function $a(u,i){return Math.ceil(u/i)*i}class zr extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const v=2*i;return this.int16[v+0]=o,this.int16[v+1]=f,i}}zr.prototype.bytesPerElement=4,Ft("StructArrayLayout2i4",zr);class Ho extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=3*i;return this.int16[T+0]=o,this.int16[T+1]=f,this.int16[T+2]=v,i}}Ho.prototype.bytesPerElement=6,Ft("StructArrayLayout3i6",Ho);class ju extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,f,v)}emplace(i,o,f,v,T){const S=4*i;return this.int16[S+0]=o,this.int16[S+1]=f,this.int16[S+2]=v,this.int16[S+3]=T,i}}ju.prototype.bytesPerElement=8,Ft("StructArrayLayout4i8",ju);class $u extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S){const I=this.length;return this.resize(I+1),this.emplace(I,i,o,f,v,T,S)}emplace(i,o,f,v,T,S,I){const R=6*i;return this.int16[R+0]=o,this.int16[R+1]=f,this.int16[R+2]=v,this.int16[R+3]=T,this.int16[R+4]=S,this.int16[R+5]=I,i}}$u.prototype.bytesPerElement=12,Ft("StructArrayLayout2i4i12",$u);class _l extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S){const I=this.length;return this.resize(I+1),this.emplace(I,i,o,f,v,T,S)}emplace(i,o,f,v,T,S,I){const R=4*i,z=8*i;return this.int16[R+0]=o,this.int16[R+1]=f,this.uint8[z+4]=v,this.uint8[z+5]=T,this.uint8[z+6]=S,this.uint8[z+7]=I,i}}_l.prototype.bytesPerElement=8,Ft("StructArrayLayout2i4ub8",_l);class Ts extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const v=2*i;return this.float32[v+0]=o,this.float32[v+1]=f,i}}Ts.prototype.bytesPerElement=8,Ft("StructArrayLayout2f8",Ts);class Lc extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,I,R,z,N){const U=this.length;return this.resize(U+1),this.emplace(U,i,o,f,v,T,S,I,R,z,N)}emplace(i,o,f,v,T,S,I,R,z,N,U){const q=10*i;return this.uint16[q+0]=o,this.uint16[q+1]=f,this.uint16[q+2]=v,this.uint16[q+3]=T,this.uint16[q+4]=S,this.uint16[q+5]=I,this.uint16[q+6]=R,this.uint16[q+7]=z,this.uint16[q+8]=N,this.uint16[q+9]=U,i}}Lc.prototype.bytesPerElement=20,Ft("StructArrayLayout10ui20",Lc);class zc extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,I,R,z,N,U,q){const Y=this.length;return this.resize(Y+1),this.emplace(Y,i,o,f,v,T,S,I,R,z,N,U,q)}emplace(i,o,f,v,T,S,I,R,z,N,U,q,Y){const J=12*i;return this.int16[J+0]=o,this.int16[J+1]=f,this.int16[J+2]=v,this.int16[J+3]=T,this.uint16[J+4]=S,this.uint16[J+5]=I,this.uint16[J+6]=R,this.uint16[J+7]=z,this.int16[J+8]=N,this.int16[J+9]=U,this.int16[J+10]=q,this.int16[J+11]=Y,i}}zc.prototype.bytesPerElement=24,Ft("StructArrayLayout4i4ui4i24",zc);class Ph extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=3*i;return this.float32[T+0]=o,this.float32[T+1]=f,this.float32[T+2]=v,i}}Ph.prototype.bytesPerElement=12,Ft("StructArrayLayout3f12",Ph);class b extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint32[1*i+0]=o,i}}b.prototype.bytesPerElement=4,Ft("StructArrayLayout1ul4",b);class n extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,I,R,z){const N=this.length;return this.resize(N+1),this.emplace(N,i,o,f,v,T,S,I,R,z)}emplace(i,o,f,v,T,S,I,R,z,N){const U=10*i,q=5*i;return this.int16[U+0]=o,this.int16[U+1]=f,this.int16[U+2]=v,this.int16[U+3]=T,this.int16[U+4]=S,this.int16[U+5]=I,this.uint32[q+3]=R,this.uint16[U+8]=z,this.uint16[U+9]=N,i}}n.prototype.bytesPerElement=20,Ft("StructArrayLayout6i1ul2ui20",n);class l extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S){const I=this.length;return this.resize(I+1),this.emplace(I,i,o,f,v,T,S)}emplace(i,o,f,v,T,S,I){const R=6*i;return this.int16[R+0]=o,this.int16[R+1]=f,this.int16[R+2]=v,this.int16[R+3]=T,this.int16[R+4]=S,this.int16[R+5]=I,i}}l.prototype.bytesPerElement=12,Ft("StructArrayLayout2i2i2i12",l);class p extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T){const S=this.length;return this.resize(S+1),this.emplace(S,i,o,f,v,T)}emplace(i,o,f,v,T,S){const I=4*i,R=8*i;return this.float32[I+0]=o,this.float32[I+1]=f,this.float32[I+2]=v,this.int16[R+6]=T,this.int16[R+7]=S,i}}p.prototype.bytesPerElement=16,Ft("StructArrayLayout2f1f2i16",p);class _ extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S){const I=this.length;return this.resize(I+1),this.emplace(I,i,o,f,v,T,S)}emplace(i,o,f,v,T,S,I){const R=16*i,z=4*i,N=8*i;return this.uint8[R+0]=o,this.uint8[R+1]=f,this.float32[z+1]=v,this.float32[z+2]=T,this.int16[N+6]=S,this.int16[N+7]=I,i}}_.prototype.bytesPerElement=16,Ft("StructArrayLayout2ub2f2i16",_);class w extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=3*i;return this.uint16[T+0]=o,this.uint16[T+1]=f,this.uint16[T+2]=v,i}}w.prototype.bytesPerElement=6,Ft("StructArrayLayout3ui6",w);class E extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,I,R,z,N,U,q,Y,J,te,le,ge){const Le=this.length;return this.resize(Le+1),this.emplace(Le,i,o,f,v,T,S,I,R,z,N,U,q,Y,J,te,le,ge)}emplace(i,o,f,v,T,S,I,R,z,N,U,q,Y,J,te,le,ge,Le){const we=24*i,K=12*i,se=48*i;return this.int16[we+0]=o,this.int16[we+1]=f,this.uint16[we+2]=v,this.uint16[we+3]=T,this.uint32[K+2]=S,this.uint32[K+3]=I,this.uint32[K+4]=R,this.uint16[we+10]=z,this.uint16[we+11]=N,this.uint16[we+12]=U,this.float32[K+7]=q,this.float32[K+8]=Y,this.uint8[se+36]=J,this.uint8[se+37]=te,this.uint8[se+38]=le,this.uint32[K+10]=ge,this.int16[we+22]=Le,i}}E.prototype.bytesPerElement=48,Ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",E);class M extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,I,R,z,N,U,q,Y,J,te,le,ge,Le,we,K,se,Se,et,yt,st,ht,St,bt){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,i,o,f,v,T,S,I,R,z,N,U,q,Y,J,te,le,ge,Le,we,K,se,Se,et,yt,st,ht,St,bt)}emplace(i,o,f,v,T,S,I,R,z,N,U,q,Y,J,te,le,ge,Le,we,K,se,Se,et,yt,st,ht,St,bt,Ct){const pt=32*i,Gt=16*i;return this.int16[pt+0]=o,this.int16[pt+1]=f,this.int16[pt+2]=v,this.int16[pt+3]=T,this.int16[pt+4]=S,this.int16[pt+5]=I,this.int16[pt+6]=R,this.int16[pt+7]=z,this.uint16[pt+8]=N,this.uint16[pt+9]=U,this.uint16[pt+10]=q,this.uint16[pt+11]=Y,this.uint16[pt+12]=J,this.uint16[pt+13]=te,this.uint16[pt+14]=le,this.uint16[pt+15]=ge,this.uint16[pt+16]=Le,this.uint16[pt+17]=we,this.uint16[pt+18]=K,this.uint16[pt+19]=se,this.uint16[pt+20]=Se,this.uint16[pt+21]=et,this.uint16[pt+22]=yt,this.uint32[Gt+12]=st,this.float32[Gt+13]=ht,this.float32[Gt+14]=St,this.uint16[pt+30]=bt,this.uint16[pt+31]=Ct,i}}M.prototype.bytesPerElement=64,Ft("StructArrayLayout8i15ui1ul2f2ui64",M);class D extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.float32[1*i+0]=o,i}}D.prototype.bytesPerElement=4,Ft("StructArrayLayout1f4",D);class O extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=3*i;return this.uint16[6*i+0]=o,this.float32[T+1]=f,this.float32[T+2]=v,i}}O.prototype.bytesPerElement=12,Ft("StructArrayLayout1ui2f12",O);class V extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=4*i;return this.uint32[2*i+0]=o,this.uint16[T+2]=f,this.uint16[T+3]=v,i}}V.prototype.bytesPerElement=8,Ft("StructArrayLayout1ul2ui8",V);class $ extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const v=2*i;return this.uint16[v+0]=o,this.uint16[v+1]=f,i}}$.prototype.bytesPerElement=4,Ft("StructArrayLayout2ui4",$);class j extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint16[1*i+0]=o,i}}j.prototype.bytesPerElement=2,Ft("StructArrayLayout1ui2",j);class H extends qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,v){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,f,v)}emplace(i,o,f,v,T){const S=4*i;return this.float32[S+0]=o,this.float32[S+1]=f,this.float32[S+2]=v,this.float32[S+3]=T,i}}H.prototype.bytesPerElement=16,Ft("StructArrayLayout4f16",H);class ee extends yl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ie(this.anchorPointX,this.anchorPointY)}}ee.prototype.size=20;class de extends n{get(i){return new ee(this,i)}}Ft("CollisionBoxArray",de);class he extends yl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}he.prototype.size=48;class fe extends E{get(i){return new he(this,i)}}Ft("PlacedSymbolArray",fe);class ye extends yl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ye.prototype.size=64;class Te extends M{get(i){return new ye(this,i)}}Ft("SymbolInstanceArray",Te);class _e extends D{getoffsetX(i){return this.float32[1*i+0]}}Ft("GlyphOffsetArray",_e);class Ae extends Ho{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Ft("SymbolLineVertexArray",Ae);class Me extends yl{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Me.prototype.size=12;class ve extends O{get(i){return new Me(this,i)}}Ft("TextAnchorOffsetArray",ve);class Ne extends yl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ne.prototype.size=8;class tt extends V{get(i){return new Ne(this,i)}}Ft("FeatureIndexArray",tt);class Xe extends zr{}class Ye extends zr{}class at extends zr{}class Dt extends $u{}class kt extends _l{}class vt extends Ts{}class qt extends Lc{}class An extends zc{}class Qn extends Ph{}class Qr extends b{}class gr extends l{}class ni extends _{}class yr extends w{}class _r extends ${}const Ar=Yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ki}=Ar;class Gn{constructor(i=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=i}prepareSegment(i,o,f,v){const T=this.segments[this.segments.length-1];return i>Gn.MAX_VERTEX_ARRAY_LENGTH&&Cr(`Max vertices per segment is ${Gn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Gn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!T||T.vertexLength+i>Gn.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==v?this.createNewSegment(o,f,v):T}createNewSegment(i,o,f){const v={vertexOffset:i.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0,vaos:{}};return f!==void 0&&(v.sortKey=f),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(v),v}getOrCreateLatestSegment(i,o,f){return this.prepareSegment(0,i,o,f)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const i of this.segments)for(const o in i.vaos)i.vaos[o].destroy()}static simpleSegment(i,o,f,v){return new Gn([{vertexOffset:i,primitiveOffset:o,vertexLength:f,primitiveLength:v,vaos:{},sortKey:0}])}}function Wi(u,i){return 256*(u=Ir(Math.floor(u),0,255))+Ir(Math.floor(i),0,255)}Gn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft("SegmentVector",Gn);const pa=Yr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var nu,vl,qs,Gs={exports:{}},ru={exports:{}},Oc={exports:{}},qu=function(){if(qs)return Gs.exports;qs=1;var u=(nu||(nu=1,ru.exports=function(o,f){var v,T,S,I,R,z,N,U;for(T=o.length-(v=3&o.length),S=f,R=3432918353,z=461845907,U=0;U<T;)N=255&o.charCodeAt(U)|(255&o.charCodeAt(++U))<<8|(255&o.charCodeAt(++U))<<16|(255&o.charCodeAt(++U))<<24,++U,S=27492+(65535&(I=5*(65535&(S=(S^=N=(65535&(N=(N=(65535&N)*R+(((N>>>16)*R&65535)<<16)&4294967295)<<15|N>>>17))*z+(((N>>>16)*z&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(I>>>16)&65535)<<16);switch(N=0,v){case 3:N^=(255&o.charCodeAt(U+2))<<16;case 2:N^=(255&o.charCodeAt(U+1))<<8;case 1:S^=N=(65535&(N=(N=(65535&(N^=255&o.charCodeAt(U)))*R+(((N>>>16)*R&65535)<<16)&4294967295)<<15|N>>>17))*z+(((N>>>16)*z&65535)<<16)&4294967295}return S^=o.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),ru.exports),i=(vl||(vl=1,Oc.exports=function(o,f){for(var v,T=o.length,S=f^T,I=0;T>=4;)v=1540483477*(65535&(v=255&o.charCodeAt(I)|(255&o.charCodeAt(++I))<<8|(255&o.charCodeAt(++I))<<16|(255&o.charCodeAt(++I))<<24))+((1540483477*(v>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),T-=4,++I;switch(T){case 3:S^=(255&o.charCodeAt(I+2))<<16;case 2:S^=(255&o.charCodeAt(I+1))<<8;case 1:S=1540483477*(65535&(S^=255&o.charCodeAt(I)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),Oc.exports);return Gs.exports=u,Gs.exports.murmur3=u,Gs.exports.murmur2=i,Gs.exports}(),ma=P(qu);class Hs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,o,f,v){this.ids.push(bl(i)),this.positions.push(o,f,v)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=bl(i);let f=0,v=this.ids.length-1;for(;f<v;){const S=f+v>>1;this.ids[S]>=o?v=S:f=S+1}const T=[];for(;this.ids[f]===o;)T.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return T}static serialize(i,o){const f=new Float64Array(i.ids),v=new Uint32Array(i.positions);return Gu(f,v,0,f.length-1),o&&o.push(f.buffer,v.buffer),{ids:f,positions:v}}static deserialize(i){const o=new Hs;return o.ids=i.ids,o.positions=i.positions,o.indexed=!0,o}}function bl(u){const i=+u;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:ma(String(u))}function Gu(u,i,o,f){for(;o<f;){const v=u[o+f>>1];let T=o-1,S=f+1;for(;;){do T++;while(u[T]<v);do S--;while(u[S]>v);if(T>=S)break;Or(u,T,S),Or(i,3*T,3*S),Or(i,3*T+1,3*S+1),Or(i,3*T+2,3*S+2)}S-o<f-S?(Gu(u,i,o,S),o=S+1):(Gu(u,i,S+1,f),f=S)}}function Or(u,i,o){const f=u[i];u[i]=u[o],u[o]=f}Ft("FeaturePositionMap",Hs);class vr{constructor(i,o){this.gl=i.gl,this.location=o}}class la extends vr{constructor(i,o){super(i,o),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class oi extends vr{constructor(i,o){super(i,o),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Mh extends vr{constructor(i,o){super(i,o),this.current=vn.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const tm=new Float32Array(16);function Cd(u){return[Wi(255*u.r,255*u.g),Wi(255*u.b,255*u.a)]}class Zo{constructor(i,o,f){this.value=i,this.uniformNames=o.map(v=>`u_${v}`),this.type=f}setUniform(i,o,f){i.set(f.constantOr(this.value))}getBinding(i,o,f){return this.type==="color"?new Mh(i,o):new la(i,o)}}class Hu{constructor(i,o){this.uniformNames=o.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=i.tlbr}setUniform(i,o,f,v){const T=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&i.set(T)}getBinding(i,o,f){return f.substr(0,9)==="u_pattern"?new oi(i,o):new la(i,o)}}class Vi{constructor(i,o,f,v){this.expression=i,this.type=f,this.maxValue=0,this.paintVertexAttributes=o.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(i,o,f,v,T){const S=this.paintVertexArray.length,I=this.expression.evaluate(new Lr(0),o,{},v,[],T);this.paintVertexArray.resize(i),this._setPaintValue(S,i,I)}updatePaintArray(i,o,f,v){const T=this.expression.evaluate({zoom:0},f,v);this._setPaintValue(i,o,T)}_setPaintValue(i,o,f){if(this.type==="color"){const v=Cd(f);for(let T=i;T<o;T++)this.paintVertexArray.emplace(T,v[0],v[1])}else{for(let v=i;v<o;v++)this.paintVertexArray.emplace(v,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gr{constructor(i,o,f,v,T,S){this.expression=i,this.uniformNames=o.map(I=>`u_${I}_t`),this.type=f,this.useIntegerZoom=v,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=o.map(I=>({name:`a_${I}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(i,o,f,v,T){const S=this.expression.evaluate(new Lr(this.zoom),o,{},v,[],T),I=this.expression.evaluate(new Lr(this.zoom+1),o,{},v,[],T),R=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(R,i,S,I)}updatePaintArray(i,o,f,v){const T=this.expression.evaluate({zoom:this.zoom},f,v),S=this.expression.evaluate({zoom:this.zoom+1},f,v);this._setPaintValue(i,o,T,S)}_setPaintValue(i,o,f,v){if(this.type==="color"){const T=Cd(f),S=Cd(v);for(let I=i;I<o;I++)this.paintVertexArray.emplace(I,T[0],T[1],S[0],S[1])}else{for(let T=i;T<o;T++)this.paintVertexArray.emplace(T,f,v);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(v))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,o){const f=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,v=Ir(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);i.set(v)}getBinding(i,o,f){return new la(i,o)}}class Ca{constructor(i,o,f,v,T,S){this.expression=i,this.type=o,this.useIntegerZoom=f,this.zoom=v,this.layerId=S,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(i,o,f){const v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(v,i,o.patterns&&o.patterns[this.layerId],f)}updatePaintArray(i,o,f,v,T){this._setPaintValues(i,o,f.patterns&&f.patterns[this.layerId],T)}_setPaintValues(i,o,f,v){if(!v||!f)return;const{min:T,mid:S,max:I}=f,R=v[T],z=v[S],N=v[I];if(R&&z&&N)for(let U=i;U<o;U++)this.zoomInPaintVertexArray.emplace(U,z.tl[0],z.tl[1],z.br[0],z.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],z.pixelRatio,R.pixelRatio),this.zoomOutPaintVertexArray.emplace(U,z.tl[0],z.tl[1],z.br[0],z.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],z.pixelRatio,N.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,pa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,pa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Pd{constructor(i,o,f){this.binders={},this._buffers=[];const v=[];for(const T in i.paint._values){if(!f(T))continue;const S=i.paint.get(T);if(!(S instanceof Ia&&go(S.property.specification)))continue;const I=wo(T,i.type),R=S.value,z=S.property.specification.type,N=S.property.useIntegerZoom,U=S.property.specification["property-type"],q=U==="cross-faded"||U==="cross-faded-data-driven";if(R.kind==="constant")this.binders[T]=q?new Hu(R.value,I):new Zo(R.value,I,z),v.push(`/u_${T}`);else if(R.kind==="source"||q){const Y=wi(T,z,"source");this.binders[T]=q?new Ca(R,z,N,o,Y,i.id):new Vi(R,I,z,Y),v.push(`/a_${T}`)}else{const Y=wi(T,z,"composite");this.binders[T]=new Gr(R,I,z,N,o,Y),v.push(`/z_${T}`)}}this.cacheKey=v.sort().join("")}getMaxValue(i){const o=this.binders[i];return o instanceof Vi||o instanceof Gr?o.maxValue:0}populatePaintArrays(i,o,f,v,T){for(const S in this.binders){const I=this.binders[S];(I instanceof Vi||I instanceof Gr||I instanceof Ca)&&I.populatePaintArray(i,o,f,v,T)}}setConstantPatternPositions(i,o){for(const f in this.binders){const v=this.binders[f];v instanceof Hu&&v.setConstantPatternPositions(i,o)}}updatePaintArrays(i,o,f,v,T){let S=!1;for(const I in i){const R=o.getPositions(I);for(const z of R){const N=f.feature(z.index);for(const U in this.binders){const q=this.binders[U];if((q instanceof Vi||q instanceof Gr||q instanceof Ca)&&q.expression.isStateDependent===!0){const Y=v.paint.get(U);q.expression=Y.value,q.updatePaintArray(z.start,z.end,N,i[I],T),S=!0}}}}return S}defines(){const i=[];for(const o in this.binders){const f=this.binders[o];(f instanceof Zo||f instanceof Hu)&&i.push(...f.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return i}getBinderAttributes(){const i=[];for(const o in this.binders){const f=this.binders[o];if(f instanceof Vi||f instanceof Gr)for(let v=0;v<f.paintVertexAttributes.length;v++)i.push(f.paintVertexAttributes[v].name);else if(f instanceof Ca)for(let v=0;v<pa.members.length;v++)i.push(pa.members[v].name)}return i}getBinderUniforms(){const i=[];for(const o in this.binders){const f=this.binders[o];if(f instanceof Zo||f instanceof Hu||f instanceof Gr)for(const v of f.uniformNames)i.push(v)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,o){const f=[];for(const v in this.binders){const T=this.binders[v];if(T instanceof Zo||T instanceof Hu||T instanceof Gr){for(const S of T.uniformNames)if(o[S]){const I=T.getBinding(i,o[S],S);f.push({name:S,property:v,binding:I})}}}return f}setUniforms(i,o,f,v){for(const{name:T,property:S,binding:I}of o)this.binders[S].setUniform(I,v,f.get(S),T)}updatePaintBuffers(i){this._buffers=[];for(const o in this.binders){const f=this.binders[o];if(i&&f instanceof Ca){const v=i.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(f instanceof Vi||f instanceof Gr)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(i){for(const o in this.binders){const f=this.binders[o];(f instanceof Vi||f instanceof Gr||f instanceof Ca)&&f.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const o=this.binders[i];(o instanceof Vi||o instanceof Gr||o instanceof Ca)&&o.destroy()}}}class qa{constructor(i,o,f=()=>!0){this.programConfigurations={};for(const v of i)this.programConfigurations[v.id]=new Pd(v,o,f);this.needsUpload=!1,this._featureMap=new Hs,this._bufferOffset=0}populatePaintArrays(i,o,f,v,T,S){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(i,o,v,T,S);o.id!==void 0&&this._featureMap.add(o.id,f,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,o,f,v){for(const T of f)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(i,this._featureMap,o,T,v)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function wo(u,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${i}-`,"").replace(/-/g,"_")]}function wi(u,i,o){const f={color:{source:Ts,composite:H},number:{source:D,composite:Ts}},v=function(T){return{"line-pattern":{source:qt,composite:qt},"fill-pattern":{source:qt,composite:qt},"fill-extrusion-pattern":{source:qt,composite:qt}}[T]}(u);return v&&v[o]||f[i][o]}Ft("ConstantBinder",Zo),Ft("CrossFadedConstantBinder",Hu),Ft("SourceExpressionBinder",Vi),Ft("CrossFadedCompositeBinder",Ca),Ft("CompositeExpressionBinder",Gr),Ft("ProgramConfiguration",Pd,{omit:["_buffers"]}),Ft("ProgramConfigurationSet",qa);const iu=Math.pow(2,14)-1,nm=-iu-1;function Zu(u){const i=It/u.extent,o=u.loadGeometry();for(let f=0;f<o.length;f++){const v=o[f];for(let T=0;T<v.length;T++){const S=v[T],I=Math.round(S.x*i),R=Math.round(S.y*i);S.x=Ir(I,nm,iu),S.y=Ir(R,nm,iu),(I<S.x||I>S.x+1||R<S.y||R>S.y+1)&&Cr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Nc(u,i){return{type:u.type,id:u.id,properties:u.properties,geometry:i?Zu(u):[]}}const Ig=-32768;function Rh(u,i,o,f,v){u.emplaceBack(Ig+8*i+f,Ig+8*o+v)}class Md{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Ye,this.indexArray=new yr,this.segments=new Gn,this.programConfigurations=new qa(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){const v=this.layers[0],T=[];let S=null,I=!1,R=v.type==="heatmap";if(v.type==="circle"){const N=v;S=N.layout.get("circle-sort-key"),I=!S.isConstant(),R=R||N.paint.get("circle-pitch-alignment")==="map"}const z=R?o.subdivisionGranularity.circle:1;for(const{feature:N,id:U,index:q,sourceLayerIndex:Y}of i){const J=this.layers[0]._featureFilter.needGeometry,te=Nc(N,J);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom,{globalState:this.globalState}),te,f))continue;const le=I?S.evaluate(te,{},f):void 0,ge={id:U,properties:N.properties,type:N.type,sourceLayerIndex:Y,index:q,geometry:J?te.geometry:Zu(N),patterns:{},sortKey:le};T.push(ge)}I&&T.sort((N,U)=>N.sortKey-U.sortKey);for(const N of T){const{geometry:U,index:q,sourceLayerIndex:Y}=N,J=i[q].feature;this.addFeature(N,U,q,f,z),o.featureIndex.insert(J,U,q,Y,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Ki),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,o,f,v,T=1){let S;switch(T){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${T}; valid values are 1, 3, 5, 7.`)}const I=S.length;for(const R of o)for(const z of R){const N=z.x,U=z.y;if(N<0||N>=It||U<0||U>=It)continue;const q=this.segments.prepareSegment(I*I,this.layoutVertexArray,this.indexArray,i.sortKey),Y=q.vertexLength;for(let J=0;J<I;J++)for(let te=0;te<I;te++)Rh(this.layoutVertexArray,N,U,S[te],S[J]);for(let J=0;J<I-1;J++)for(let te=0;te<I-1;te++){const le=Y+J*I+te,ge=Y+(J+1)*I+te;this.indexArray.emplaceBack(le,ge+1,le+1),this.indexArray.emplaceBack(le,ge,ge+1)}q.vertexLength+=I*I,q.primitiveLength+=(I-1)*(I-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{},v)}}function Cg(u,i){for(let o=0;o<u.length;o++)if(kh(i,u[o]))return!0;for(let o=0;o<i.length;o++)if(kh(u,i[o]))return!0;return!!im(u,i)}function H_(u,i,o){return!!kh(u,i)||!!am(i,u,o)}function Pg(u,i){if(u.length===1)return Z_(i,u[0]);for(let o=0;o<i.length;o++){const f=i[o];for(let v=0;v<f.length;v++)if(kh(u,f[v]))return!0}for(let o=0;o<u.length;o++)if(Z_(i,u[o]))return!0;for(let o=0;o<i.length;o++)if(im(u,i[o]))return!0;return!1}function rm(u,i,o){if(u.length>1){if(im(u,i))return!0;for(let f=0;f<i.length;f++)if(am(i[f],u,o))return!0}for(let f=0;f<u.length;f++)if(am(u[f],i,o))return!0;return!1}function im(u,i){if(u.length===0||i.length===0)return!1;for(let o=0;o<u.length-1;o++){const f=u[o],v=u[o+1];for(let T=0;T<i.length-1;T++)if(Mg(f,v,i[T],i[T+1]))return!0}return!1}function Mg(u,i,o,f){return za(u,o,f)!==za(i,o,f)&&za(u,i,o)!==za(u,i,f)}function am(u,i,o){const f=o*o;if(i.length===1)return u.distSqr(i[0])<f;for(let v=1;v<i.length;v++)if(Rg(u,i[v-1],i[v])<f)return!0;return!1}function Rg(u,i,o){const f=i.distSqr(o);if(f===0)return u.distSqr(i);const v=((u.x-i.x)*(o.x-i.x)+(u.y-i.y)*(o.y-i.y))/f;return u.distSqr(v<0?i:v>1?o:o.sub(i)._mult(v)._add(i))}function Z_(u,i){let o,f,v,T=!1;for(let S=0;S<u.length;S++){o=u[S];for(let I=0,R=o.length-1;I<o.length;R=I++)f=o[I],v=o[R],f.y>i.y!=v.y>i.y&&i.x<(v.x-f.x)*(i.y-f.y)/(v.y-f.y)+f.x&&(T=!T)}return T}function kh(u,i){let o=!1;for(let f=0,v=u.length-1;f<u.length;v=f++){const T=u[f],S=u[v];T.y>i.y!=S.y>i.y&&i.x<(S.x-T.x)*(i.y-T.y)/(S.y-T.y)+T.x&&(o=!o)}return o}function Pa(u,i,o){const f=o[0],v=o[2];if(u.x<f.x&&i.x<f.x||u.x>v.x&&i.x>v.x||u.y<f.y&&i.y<f.y||u.y>v.y&&i.y>v.y)return!1;const T=za(u,i,o[0]);return T!==za(u,i,o[1])||T!==za(u,i,o[2])||T!==za(u,i,o[3])}function Xi(u,i,o){const f=i.paint.get(u).value;return f.kind==="constant"?f.value:o.programConfigurations.get(i.id).getMaxValue(u)}function $f(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function qf(u,i,o,f,v){if(!i[0]&&!i[1])return u;const T=ie.convert(i)._mult(v);o==="viewport"&&T._rotate(-f);const S=[];for(let I=0;I<u.length;I++)S.push(u[I].sub(T));return S}let kg,Dg;Ft("CircleBucket",Md,{omit:["layers"]});var K_={get paint(){return Dg=Dg||new fa({"circle-radius":new Jt(ke.paint_circle["circle-radius"]),"circle-color":new Jt(ke.paint_circle["circle-color"]),"circle-blur":new Jt(ke.paint_circle["circle-blur"]),"circle-opacity":new Jt(ke.paint_circle["circle-opacity"]),"circle-translate":new jt(ke.paint_circle["circle-translate"]),"circle-translate-anchor":new jt(ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new jt(ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new jt(ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Jt(ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Jt(ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Jt(ke.paint_circle["circle-stroke-opacity"])})},get layout(){return kg=kg||new fa({"circle-sort-key":new Jt(ke.layout_circle["circle-sort-key"])})}};class sm extends oa{constructor(i){super(i,K_)}createBucket(i){return new Md(i)}queryRadius(i){const o=i;return Xi("circle-radius",this,o)+Xi("circle-stroke-width",this,o)+$f(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:v,transform:T,pixelsToTileUnits:S,unwrappedTileID:I,getElevation:R}){const z=qf(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-T.bearingInRadians,S),N=this.paint.get("circle-radius").evaluate(o,f)+this.paint.get("circle-stroke-width").evaluate(o,f),U=this.paint.get("circle-pitch-alignment")==="map",q=U?z:function(J,te,le,ge){return J.map(Le=>om(Le,te,le,ge))}(z,T,I,R),Y=U?N*S:N;for(const J of v)for(const te of J){const le=U?te:om(te,T,I,R);let ge=Y;const Le=T.projectTileCoordinates(te.x,te.y,I,R).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ge*=Le/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ge*=T.cameraToCenterDistance/Le),H_(q,le,ge))return!0}return!1}}function om(u,i,o,f){const v=i.projectTileCoordinates(u.x,u.y,o,f).point;return new ie((.5*v.x+.5)*i.width,(.5*-v.y+.5)*i.height)}class Lg extends Md{}let zg;Ft("HeatmapBucket",Lg,{omit:["layers"]});var W_={get paint(){return zg=zg||new fa({"heatmap-radius":new Jt(ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Jt(ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new jt(ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Uu(ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new jt(ke.paint_heatmap["heatmap-opacity"])})}};function Gf(u,{width:i,height:o},f,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==i*o*f)throw new RangeError(`mismatched image size. expected: ${v.length} but got: ${i*o*f}`)}else v=new Uint8Array(i*o*f);return u.width=i,u.height=o,u.data=v,u}function lm(u,{width:i,height:o},f){if(i===u.width&&o===u.height)return;const v=Gf({},{width:i,height:o},f);Hf(u,v,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,i),height:Math.min(u.height,o)},f),u.width=i,u.height=o,u.data=v.data}function Hf(u,i,o,f,v,T){if(v.width===0||v.height===0)return i;if(v.width>u.width||v.height>u.height||o.x>u.width-v.width||o.y>u.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>i.width||v.height>i.height||f.x>i.width-v.width||f.y>i.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const S=u.data,I=i.data;if(S===I)throw new Error("srcData equals dstData, so image is already copied");for(let R=0;R<v.height;R++){const z=((o.y+R)*u.width+o.x)*T,N=((f.y+R)*i.width+f.x)*T;for(let U=0;U<v.width*T;U++)I[N+U]=S[z+U]}return i}class Rd{constructor(i,o){Gf(this,i,1,o)}resize(i){lm(this,i,1)}clone(){return new Rd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,f,v,T){Hf(i,o,f,v,T,1)}}class Ga{constructor(i,o){Gf(this,i,4,o)}resize(i){lm(this,i,4)}replace(i,o){o?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ga({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,f,v,T){Hf(i,o,f,v,T,4)}setPixel(i,o,f){const v=4*(i*this.width+o);this.data[v+0]=Math.round(255*f.r/f.a),this.data[v+1]=Math.round(255*f.g/f.a),this.data[v+2]=Math.round(255*f.b/f.a),this.data[v+3]=Math.round(255*f.a)}}function Zf(u){const i={},o=u.resolution||256,f=u.clips?u.clips.length:1,v=u.image||new Ga({width:o,height:f});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const T=(S,I,R)=>{i[u.evaluationKey]=R;const z=u.expression.evaluate(i);v.setPixel(S/4/o,I/4,z)};if(u.clips)for(let S=0,I=0;S<f;++S,I+=4*o)for(let R=0,z=0;R<o;R++,z+=4){const N=R/(o-1),{start:U,end:q}=u.clips[S];T(I,z,U*(1-N)+q*N)}else for(let S=0,I=0;S<o;S++,I+=4)T(0,I,S/(o-1));return v}Ft("AlphaImage",Rd),Ft("RGBAImage",Ga);const Kf="big-fb";class X_ extends oa{createBucket(i){return new Lg(i)}constructor(i){super(i,W_),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Zf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Kf)&&this.heatmapFbos.delete(Kf)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let um;var Y_={get paint(){return um=um||new fa({"hillshade-illumination-direction":new jt(ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new jt(ke.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new jt(ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new jt(ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new jt(ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new jt(ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new jt(ke.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new jt(ke.paint_hillshade["hillshade-method"])})}};class Ku extends oa{constructor(i){super(i,Y_),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let i=this.paint.get("hillshade-illumination-direction").values,o=this.paint.get("hillshade-illumination-altitude").values,f=this.paint.get("hillshade-highlight-color").values,v=this.paint.get("hillshade-shadow-color").values;const T=Math.max(i.length,o.length,f.length,v.length);i=i.concat(Array(T-i.length).fill(i.at(-1))),o=o.concat(Array(T-o.length).fill(o.at(-1))),f=f.concat(Array(T-f.length).fill(f.at(-1))),v=v.concat(Array(T-v.length).fill(v.at(-1)));const S=o.map(zn);return{directionRadians:i.map(zn),altitudeRadians:S,shadowColor:v,highlightColor:f}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let cm;var Cb={get paint(){return cm=cm||new fa({"color-relief-opacity":new jt(ke["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Uu(ke["paint_color-relief"]["color-relief-color"])})}};class hm{constructor(i,o,f,v){this.context=i,this.format=f,this.texture=i.gl.createTexture(),this.update(o,v)}update(i,o,f){const{width:v,height:T}=i,S=!(this.size&&this.size[0]===v&&this.size[1]===T||f),{context:I}=this,{gl:R}=I;if(this.useMipmap=!!(o&&o.useMipmap),R.bindTexture(R.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===R.RGBA&&(!o||o.premultiply!==!1)),S)this.size=[v,T],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Wa(i)?R.texImage2D(R.TEXTURE_2D,0,this.format,this.format,R.UNSIGNED_BYTE,i):R.texImage2D(R.TEXTURE_2D,0,this.format,v,T,0,this.format,R.UNSIGNED_BYTE,i.data);else{const{x:z,y:N}=f||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Wa(i)?R.texSubImage2D(R.TEXTURE_2D,0,z,N,R.RGBA,R.UNSIGNED_BYTE,i):R.texSubImage2D(R.TEXTURE_2D,0,z,N,v,T,R.RGBA,R.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&R.generateMipmap(R.TEXTURE_2D),I.pixelStoreUnpackFlipY.setDefault(),I.pixelStoreUnpack.setDefault(),I.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(i,o,f){const{context:v}=this,{gl:T}=v;T.bindTexture(T.TEXTURE_2D,this.texture),f!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=T.LINEAR),i!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,i),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,f||i),this.filter=i),o!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,o),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class au{constructor(i,o,f,v=1,T=1,S=1,I=0){if(this.uid=i,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Cr(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const R=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=v,this.greenFactor=T,this.blueFactor=S,this.baseShift=I;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let z=0;z<R;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(R,z)]=this.data[this._idx(R-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,R)]=this.data[this._idx(z,R-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(R,-1)]=this.data[this._idx(R-1,0)],this.data[this._idx(-1,R)]=this.data[this._idx(0,R-1)],this.data[this._idx(R,R)]=this.data[this._idx(R-1,R-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<R;z++)for(let N=0;N<R;N++){const U=this.get(z,N);U>this.max&&(this.max=U),U<this.min&&(this.min=U)}}get(i,o){const f=new Uint8Array(this.data.buffer),v=4*this._idx(i,o);return this.unpack(f[v],f[v+1],f[v+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(i,o){if(i<-1||i>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(i+1)}unpack(i,o,f){return i*this.redFactor+o*this.greenFactor+f*this.blueFactor-this.baseShift}pack(i){return Og(i,this.getUnpackVector())}getPixels(){return new Ga({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,o,f){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let v=o*this.dim,T=o*this.dim+this.dim,S=f*this.dim,I=f*this.dim+this.dim;switch(o){case-1:v=T-1;break;case 1:T=v+1}switch(f){case-1:S=I-1;break;case 1:I=S+1}const R=-o*this.dim,z=-f*this.dim;for(let N=S;N<I;N++)for(let U=v;U<T;U++)this.data[this._idx(U,N)]=i.data[this._idx(U+R,N+z)]}}function Og(u,i){const o=i[0],f=i[1],v=i[2],T=i[3],S=Math.min(o,f,v),I=Math.round((u+T)/S);return{r:Math.floor(I*S/o)%256,g:Math.floor(I*S/f)%256,b:Math.floor(I*S/v)%256}}Ft("DEMData",au);class dm extends oa{constructor(i){super(i,Cb)}_createColorRamp(i){const o={elevationStops:[],colorStops:[]},f=this._transitionablePaint._values["color-relief-color"].value.expression;if(f instanceof Aa&&f._styleExpression.expression instanceof _i){this.colorRampExpression=f;const S=f._styleExpression.expression;o.elevationStops=S.labels,o.colorStops=[];for(const I of o.elevationStops)o.colorStops.push(S.evaluate({globals:{elevation:I}}))}if(o.elevationStops.length<1&&(o.elevationStops=[0],o.colorStops=[vn.transparent]),o.elevationStops.length<2&&(o.elevationStops.push(o.elevationStops[0]+1),o.colorStops.push(o.colorStops[0])),o.elevationStops.length<=i)return o;const v={elevationStops:[],colorStops:[]},T=(o.elevationStops.length-1)/(i-1);for(let S=0;S<o.elevationStops.length-.5;S+=T)v.elevationStops.push(o.elevationStops[Math.round(S)]),v.colorStops.push(o.colorStops[Math.round(S)]);return Cr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),v}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(i,o,f){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const v=this._createColorRamp(o),T=new Ga({width:v.colorStops.length,height:1}),S=new Ga({width:v.colorStops.length,height:1});for(let I=0;I<v.elevationStops.length;I++){const R=Og(v.elevationStops[I],f);S.setPixel(0,I,new vn(R.r/255,R.g/255,R.b/255,1)),T.setPixel(0,I,v.colorStops[I])}return this.colorRampTextures={elevationTexture:new hm(i,S,i.gl.RGBA),colorTexture:new hm(i,T,i.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Wf=Yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ti}=Wf;function Ng(u,i,o){const f=o.patternDependencies;let v=!1;for(const T of i){const S=T.paint.get(`${u}-pattern`);S.isConstant()||(v=!0);const I=S.constantOr(null);I&&(v=!0,f[I.to]=!0,f[I.from]=!0)}return v}function Bg(u,i,o,f,v){const T=v.patternDependencies;for(const S of i){const I=S.paint.get(`${u}-pattern`).value;if(I.kind!=="constant"){let R=I.evaluate({zoom:f-1},o,{},v.availableImages),z=I.evaluate({zoom:f},o,{},v.availableImages),N=I.evaluate({zoom:f+1},o,{},v.availableImages);R=R&&R.name?R.name:R,z=z&&z.name?z.name:z,N=N&&N.name?N.name:N,T[R]=!0,T[z]=!0,T[N]=!0,o.patterns[S.id]={min:R,mid:z,max:N}}}return o}function Vg(u,i,o,f,v){let T;if(v===function(S,I,R,z){let N=0;for(let U=I,q=R-z;U<R;U+=z)N+=(S[q]-S[U])*(S[U+1]+S[q+1]),q=U;return N}(u,i,o,f)>0)for(let S=i;S<o;S+=f)T=li(S/f|0,u[S],u[S+1],T);else for(let S=o-f;S>=i;S-=f)T=li(S/f|0,u[S],u[S+1],T);return T&&Bc(T,T.next)&&(Ma(T),T=T.next),T}function xl(u,i){if(!u)return u;i||(i=u);let o,f=u;do if(o=!1,f.steiner||!Bc(f,f.next)&&On(f.prev,f,f.next)!==0)f=f.next;else{if(Ma(f),f=i=f.prev,f===f.next)break;o=!0}while(o||f!==i);return i}function Ko(u,i,o,f,v,T,S){if(!u)return;!S&&T&&function(R,z,N,U){let q=R;do q.z===0&&(q.z=Yf(q.x,q.y,z,N,U)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==R);q.prevZ.nextZ=null,q.prevZ=null,function(Y){let J,te=1;do{let le,ge=Y;Y=null;let Le=null;for(J=0;ge;){J++;let we=ge,K=0;for(let Se=0;Se<te&&(K++,we=we.nextZ,we);Se++);let se=te;for(;K>0||se>0&&we;)K!==0&&(se===0||!we||ge.z<=we.z)?(le=ge,ge=ge.nextZ,K--):(le=we,we=we.nextZ,se--),Le?Le.nextZ=le:Y=le,le.prevZ=Le,Le=le;ge=we}Le.nextZ=null,te*=2}while(J>1)}(q)}(u,f,v,T);let I=u;for(;u.prev!==u.next;){const R=u.prev,z=u.next;if(T?J_(u,f,v,T):Q_(u))i.push(R.i,u.i,z.i),Ma(u),u=z.next,I=z.next;else if((u=z)===I){S?S===1?Ko(u=Xf(xl(u),i),i,o,f,v,T,2):S===2&&su(u,i,o,f,v,T):Ko(xl(u),i,o,f,v,T,1);break}}}function Q_(u){const i=u.prev,o=u,f=u.next;if(On(i,o,f)>=0)return!1;const v=i.x,T=o.x,S=f.x,I=i.y,R=o.y,z=f.y,N=Math.min(v,T,S),U=Math.min(I,R,z),q=Math.max(v,T,S),Y=Math.max(I,R,z);let J=f.next;for(;J!==i;){if(J.x>=N&&J.x<=q&&J.y>=U&&J.y<=Y&&kd(v,I,T,R,S,z,J.x,J.y)&&On(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function J_(u,i,o,f){const v=u.prev,T=u,S=u.next;if(On(v,T,S)>=0)return!1;const I=v.x,R=T.x,z=S.x,N=v.y,U=T.y,q=S.y,Y=Math.min(I,R,z),J=Math.min(N,U,q),te=Math.max(I,R,z),le=Math.max(N,U,q),ge=Yf(Y,J,i,o,f),Le=Yf(te,le,i,o,f);let we=u.prevZ,K=u.nextZ;for(;we&&we.z>=ge&&K&&K.z<=Le;){if(we.x>=Y&&we.x<=te&&we.y>=J&&we.y<=le&&we!==v&&we!==S&&kd(I,N,R,U,z,q,we.x,we.y)&&On(we.prev,we,we.next)>=0||(we=we.prevZ,K.x>=Y&&K.x<=te&&K.y>=J&&K.y<=le&&K!==v&&K!==S&&kd(I,N,R,U,z,q,K.x,K.y)&&On(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;we&&we.z>=ge;){if(we.x>=Y&&we.x<=te&&we.y>=J&&we.y<=le&&we!==v&&we!==S&&kd(I,N,R,U,z,q,we.x,we.y)&&On(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;K&&K.z<=Le;){if(K.x>=Y&&K.x<=te&&K.y>=J&&K.y<=le&&K!==v&&K!==S&&kd(I,N,R,U,z,q,K.x,K.y)&&On(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function Xf(u,i){let o=u;do{const f=o.prev,v=o.next.next;!Bc(f,v)&&jg(f,o,o.next,v)&&Dd(f,v)&&Dd(v,f)&&(i.push(f.i,o.i,v.i),Ma(o),Ma(o.next),o=u=v),o=o.next}while(o!==u);return xl(o)}function su(u,i,o,f,v,T){let S=u;do{let I=S.next.next;for(;I!==S.prev;){if(S.i!==I.i&&Wu(S,I)){let R=$g(S,I);return S=xl(S,S.next),R=xl(R,R.next),Ko(S,i,o,f,v,T,0),void Ko(R,i,o,f,v,T,0)}I=I.next}S=S.next}while(S!==u)}function ev(u,i){let o=u.x-i.x;return o===0&&(o=u.y-i.y,o===0)&&(o=(u.next.y-u.y)/(u.next.x-u.x)-(i.next.y-i.y)/(i.next.x-i.x)),o}function Fg(u,i){const o=function(v,T){let S=T;const I=v.x,R=v.y;let z,N=-1/0;if(Bc(v,S))return S;do{if(Bc(v,S.next))return S.next;if(R<=S.y&&R>=S.next.y&&S.next.y!==S.y){const te=S.x+(R-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(te<=I&&te>N&&(N=te,z=S.x<S.next.x?S:S.next,te===I))return z}S=S.next}while(S!==T);if(!z)return null;const U=z,q=z.x,Y=z.y;let J=1/0;S=z;do{if(I>=S.x&&S.x>=q&&I!==S.x&&Qf(R<Y?I:N,R,q,Y,R<Y?N:I,R,S.x,S.y)){const te=Math.abs(R-S.y)/(I-S.x);Dd(S,v)&&(te<J||te===J&&(S.x>z.x||S.x===z.x&&tv(z,S)))&&(z=S,J=te)}S=S.next}while(S!==U);return z}(u,i);if(!o)return i;const f=$g(o,u);return xl(f,f.next),xl(o,o.next)}function tv(u,i){return On(u.prev,u,i.prev)<0&&On(i.next,u,u.next)<0}function Yf(u,i,o,f,v){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-o)*v|0)|u<<8))|u<<4))|u<<2))|u<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-f)*v|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function Ug(u){let i=u,o=u;do(i.x<o.x||i.x===o.x&&i.y<o.y)&&(o=i),i=i.next;while(i!==u);return o}function Qf(u,i,o,f,v,T,S,I){return(v-S)*(i-I)>=(u-S)*(T-I)&&(u-S)*(f-I)>=(o-S)*(i-I)&&(o-S)*(T-I)>=(v-S)*(f-I)}function kd(u,i,o,f,v,T,S,I){return!(u===S&&i===I)&&Qf(u,i,o,f,v,T,S,I)}function Wu(u,i){return u.next.i!==i.i&&u.prev.i!==i.i&&!function(o,f){let v=o;do{if(v.i!==o.i&&v.next.i!==o.i&&v.i!==f.i&&v.next.i!==f.i&&jg(v,v.next,o,f))return!0;v=v.next}while(v!==o);return!1}(u,i)&&(Dd(u,i)&&Dd(i,u)&&function(o,f){let v=o,T=!1;const S=(o.x+f.x)/2,I=(o.y+f.y)/2;do v.y>I!=v.next.y>I&&v.next.y!==v.y&&S<(v.next.x-v.x)*(I-v.y)/(v.next.y-v.y)+v.x&&(T=!T),v=v.next;while(v!==o);return T}(u,i)&&(On(u.prev,u,i.prev)||On(u,i.prev,i))||Bc(u,i)&&On(u.prev,u,u.next)>0&&On(i.prev,i,i.next)>0)}function On(u,i,o){return(i.y-u.y)*(o.x-i.x)-(i.x-u.x)*(o.y-i.y)}function Bc(u,i){return u.x===i.x&&u.y===i.y}function jg(u,i,o,f){const v=fm(On(u,i,o)),T=fm(On(u,i,f)),S=fm(On(o,f,u)),I=fm(On(o,f,i));return v!==T&&S!==I||!(v!==0||!Yi(u,o,i))||!(T!==0||!Yi(u,f,i))||!(S!==0||!Yi(o,u,f))||!(I!==0||!Yi(o,i,f))}function Yi(u,i,o){return i.x<=Math.max(u.x,o.x)&&i.x>=Math.min(u.x,o.x)&&i.y<=Math.max(u.y,o.y)&&i.y>=Math.min(u.y,o.y)}function fm(u){return u>0?1:u<0?-1:0}function Dd(u,i){return On(u.prev,u,u.next)<0?On(u,i,u.next)>=0&&On(u,u.prev,i)>=0:On(u,i,u.prev)<0||On(u,u.next,i)<0}function $g(u,i){const o=wl(u.i,u.x,u.y),f=wl(i.i,i.x,i.y),v=u.next,T=i.prev;return u.next=i,i.prev=u,o.next=v,v.prev=o,f.next=o,o.prev=f,T.next=f,f.prev=T,f}function li(u,i,o,f){const v=wl(u,i,o);return f?(v.next=f.next,v.prev=f,f.next.prev=v,f.next=v):(v.prev=v,v.next=v),v}function Ma(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function wl(u,i,o){return{i:u,x:i,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Dh{constructor(i,o){if(o>i)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=i,this._minGranularity=o}getGranularityForZoomLevel(i){return Math.max(Math.floor(this._baseZoomGranularity/(1<<i)),this._minGranularity,1)}}class Jf{constructor(i){this.fill=i.fill,this.line=i.line,this.tile=i.tile,this.stencil=i.stencil,this.circle=i.circle}}Jf.noSubdivision=new Jf({fill:new Dh(0,0),line:new Dh(0,0),tile:new Dh(0,0),stencil:new Dh(0,0),circle:1}),Ft("SubdivisionGranularityExpression",Dh),Ft("SubdivisionGranularitySetting",Jf);const Ld=-32768,Lh=32767;class To{constructor(i,o){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=i,this._granularityCellSize=It/i,this._canonical=o}_getKey(i,o){return(i+=32768)<<16|o+32768}_vertexToIndex(i,o){if(i<-32768||o<-32768||i>32767||o>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const f=0|Math.round(i),v=0|Math.round(o),T=this._getKey(f,v);if(this._vertexDictionary.has(T))return this._vertexDictionary.get(T);const S=this._vertexBuffer.length/2;return this._vertexDictionary.set(T,S),this._vertexBuffer.push(f,v),S}_subdivideTrianglesScanline(i){if(this._granularity<2)return function(v,T){const S=[];for(let I=0;I<T.length;I+=3){const R=T[I],z=T[I+1],N=T[I+2],U=v[2*R],q=v[2*R+1];(v[2*z]-U)*(v[2*N+1]-q)-(v[2*z+1]-q)*(v[2*N]-U)>0?(S.push(R),S.push(N),S.push(z)):(S.push(R),S.push(z),S.push(N))}return S}(this._vertexBuffer,i);const o=[],f=i.length;for(let v=0;v<f;v+=3){const T=[i[v+0],i[v+1],i[v+2]],S=[this._vertexBuffer[2*i[v+0]+0],this._vertexBuffer[2*i[v+0]+1],this._vertexBuffer[2*i[v+1]+0],this._vertexBuffer[2*i[v+1]+1],this._vertexBuffer[2*i[v+2]+0],this._vertexBuffer[2*i[v+2]+1]];let I=1/0,R=1/0,z=-1/0,N=-1/0;for(let te=0;te<3;te++){const le=S[2*te],ge=S[2*te+1];I=Math.min(I,le),z=Math.max(z,le),R=Math.min(R,ge),N=Math.max(N,ge)}if(I===z||R===N)continue;const U=Math.floor(I/this._granularityCellSize),q=Math.ceil(z/this._granularityCellSize),Y=Math.floor(R/this._granularityCellSize),J=Math.ceil(N/this._granularityCellSize);if(U!==q||Y!==J)for(let te=Y;te<J;te++){const le=this._scanlineGenerateVertexRingForCellRow(te,S,T);So(this._vertexBuffer,le,o)}else o.push(...T)}return o}_scanlineGenerateVertexRingForCellRow(i,o,f){const v=i*this._granularityCellSize,T=v+this._granularityCellSize,S=[];for(let I=0;I<3;I++){const R=o[2*I],z=o[2*I+1],N=o[2*(I+1)%6],U=o[(2*(I+1)+1)%6],q=o[2*(I+2)%6],Y=o[(2*(I+2)+1)%6],J=N-R,te=U-z,le=J===0,ge=te===0,Le=(v-z)/te,we=(T-z)/te,K=Math.min(Le,we),se=Math.max(Le,we);if(!ge&&(K>=1||se<=0)||ge&&(z<v||z>T)){U>=v&&U<=T&&S.push(f[(I+1)%3]);continue}!ge&&K>0&&S.push(this._vertexToIndex(R+J*K,z+te*K));const Se=R+J*Math.max(K,0),et=R+J*Math.min(se,1);le||this._generateIntraEdgeVertices(S,R,z,N,U,Se,et),!ge&&se<1&&S.push(this._vertexToIndex(R+J*se,z+te*se)),(ge||U>=v&&U<=T)&&S.push(f[(I+1)%3]),!ge&&(U<=v||U>=T)&&this._generateInterEdgeVertices(S,R,z,N,U,q,Y,et,v,T)}return S}_generateIntraEdgeVertices(i,o,f,v,T,S,I){const R=v-o,z=T-f,N=z===0,U=N?Math.min(o,v):Math.min(S,I),q=N?Math.max(o,v):Math.max(S,I),Y=Math.floor(U/this._granularityCellSize)+1,J=Math.ceil(q/this._granularityCellSize)-1;if(N?o<v:S<I)for(let te=Y;te<=J;te++){const le=te*this._granularityCellSize;i.push(this._vertexToIndex(le,f+z*(le-o)/R))}else for(let te=J;te>=Y;te--){const le=te*this._granularityCellSize;i.push(this._vertexToIndex(le,f+z*(le-o)/R))}}_generateInterEdgeVertices(i,o,f,v,T,S,I,R,z,N){const U=T-f,q=S-v,Y=I-T,J=(z-T)/Y,te=(N-T)/Y,le=Math.min(J,te),ge=Math.max(J,te),Le=v+q*le;let we=Math.floor(Math.min(Le,R)/this._granularityCellSize)+1,K=Math.ceil(Math.max(Le,R)/this._granularityCellSize)-1,se=R<Le;const Se=Y===0;if(Se&&(I===z||I===N))return;if(Se||le>=1||ge<=0){const yt=f-I,st=S+(o-S)*Math.min((z-I)/yt,(N-I)/yt);we=Math.floor(Math.min(st,R)/this._granularityCellSize)+1,K=Math.ceil(Math.max(st,R)/this._granularityCellSize)-1,se=R<st}const et=U>0?N:z;if(se)for(let yt=we;yt<=K;yt++)i.push(this._vertexToIndex(yt*this._granularityCellSize,et));else for(let yt=K;yt>=we;yt--)i.push(this._vertexToIndex(yt*this._granularityCellSize,et))}_generateOutline(i){const o=[];for(const f of i){const v=Vc(f,this._granularity,!0),T=this._pointArrayToIndices(v),S=[];for(let I=1;I<T.length;I++)S.push(T[I-1]),S.push(T[I]);o.push(S)}return o}_handlePoles(i){let o=!1,f=!1;this._canonical&&(this._canonical.y===0&&(o=!0),this._canonical.y===(1<<this._canonical.z)-1&&(f=!0)),(o||f)&&this._fillPoles(i,o,f)}_ensureNoPoleVertices(){const i=this._vertexBuffer;for(let o=0;o<i.length;o+=2){const f=i[o+1];f===Ld&&(i[o+1]=-32767),f===Lh&&(i[o+1]=32766)}}_generatePoleQuad(i,o,f,v,T,S){v>T!=(S===Ld)?(i.push(o),i.push(f),i.push(this._vertexToIndex(v,S)),i.push(f),i.push(this._vertexToIndex(T,S)),i.push(this._vertexToIndex(v,S))):(i.push(f),i.push(o),i.push(this._vertexToIndex(v,S)),i.push(this._vertexToIndex(T,S)),i.push(f),i.push(this._vertexToIndex(v,S)))}_fillPoles(i,o,f){const v=this._vertexBuffer,T=It,S=i.length;for(let I=2;I<S;I+=3){const R=i[I-2],z=i[I-1],N=i[I],U=v[2*R],q=v[2*R+1],Y=v[2*z],J=v[2*z+1],te=v[2*N],le=v[2*N+1];o&&(q===0&&J===0&&this._generatePoleQuad(i,R,z,U,Y,Ld),J===0&&le===0&&this._generatePoleQuad(i,z,N,Y,te,Ld),le===0&&q===0&&this._generatePoleQuad(i,N,R,te,U,Ld)),f&&(q===T&&J===T&&this._generatePoleQuad(i,R,z,U,Y,Lh),J===T&&le===T&&this._generatePoleQuad(i,z,N,Y,te,Lh),le===T&&q===T&&this._generatePoleQuad(i,N,R,te,U,Lh))}}_initializeVertices(i){for(let o=0;o<i.length;o+=2)this._vertexToIndex(i[o],i[o+1])}subdividePolygonInternal(i,o){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:f,holeIndices:v}=function(I){const R=[],z=[];for(const N of I)if(N.length!==0){N!==I[0]&&R.push(z.length/2);for(let U=0;U<N.length;U++)z.push(N[U].x),z.push(N[U].y)}return{flattened:z,holeIndices:R}}(i);let T;this._initializeVertices(f);try{const I=function(z,N,U=2){const q=N&&N.length,Y=q?N[0]*U:z.length;let J=Vg(z,0,Y,U,!0);const te=[];if(!J||J.next===J.prev)return te;let le,ge,Le;if(q&&(J=function(we,K,se,Se){const et=[];for(let yt=0,st=K.length;yt<st;yt++){const ht=Vg(we,K[yt]*Se,yt<st-1?K[yt+1]*Se:we.length,Se,!1);ht===ht.next&&(ht.steiner=!0),et.push(Ug(ht))}et.sort(ev);for(let yt=0;yt<et.length;yt++)se=Fg(et[yt],se);return se}(z,N,J,U)),z.length>80*U){le=1/0,ge=1/0;let we=-1/0,K=-1/0;for(let se=U;se<Y;se+=U){const Se=z[se],et=z[se+1];Se<le&&(le=Se),et<ge&&(ge=et),Se>we&&(we=Se),et>K&&(K=et)}Le=Math.max(we-le,K-ge),Le=Le!==0?32767/Le:0}return Ko(J,te,U,le,ge,Le,0),te}(f,v),R=this._convertIndices(f,I);T=this._subdivideTrianglesScanline(R)}catch(I){console.error(I)}let S=[];return o&&(S=this._generateOutline(i)),this._ensureNoPoleVertices(),this._handlePoles(T),{verticesFlattened:this._vertexBuffer,indicesTriangles:T,indicesLineList:S}}_convertIndices(i,o){const f=[];for(let v=0;v<o.length;v++)f.push(this._vertexToIndex(i[2*o[v]],i[2*o[v]+1]));return f}_pointArrayToIndices(i){const o=[];for(let f=0;f<i.length;f++){const v=i[f];o.push(this._vertexToIndex(v.x,v.y))}return o}}function Wo(u,i,o,f=!0){return new To(o,i).subdividePolygonInternal(u,f)}function Vc(u,i,o=!1){if(!u||u.length<1)return[];if(u.length<2)return[];const f=u[0],v=u[u.length-1],T=o&&(f.x!==v.x||f.y!==v.y);if(i<2)return T?[...u,u[0]]:[...u];const S=Math.floor(It/i),I=[];I.push(new ie(u[0].x,u[0].y));const R=u.length,z=T?R:R-1;for(let N=0;N<z;N++){const U=u[N],q=N<R-1?u[N+1]:u[0],Y=U.x,J=U.y,te=q.x,le=q.y,ge=Y!==te,Le=J!==le;if(!ge&&!Le)continue;const we=te-Y,K=le-J,se=Math.abs(we),Se=Math.abs(K);let et=Y,yt=J;for(;;){const ht=we>0?(Math.floor(et/S)+1)*S:(Math.ceil(et/S)-1)*S,St=K>0?(Math.floor(yt/S)+1)*S:(Math.ceil(yt/S)-1)*S,bt=Math.abs(et-ht),Ct=Math.abs(yt-St),pt=Math.abs(et-te),Gt=Math.abs(yt-le),tn=ge?bt/se:Number.POSITIVE_INFINITY,Zt=Le?Ct/Se:Number.POSITIVE_INFINITY;if((pt<=bt||!ge)&&(Gt<=Ct||!Le))break;if(tn<Zt&&ge||!Le){et=ht,yt+=K*tn;const $t=new ie(et,Math.round(yt));I[I.length-1].x===$t.x&&I[I.length-1].y===$t.y||I.push($t)}else{et+=we*Zt,yt=St;const $t=new ie(Math.round(et),yt);I[I.length-1].x===$t.x&&I[I.length-1].y===$t.y||I.push($t)}}const st=new ie(te,le);I[I.length-1].x===st.x&&I[I.length-1].y===st.y||I.push(st)}return I}function So(u,i,o){if(i.length===0)throw new Error("Subdivision vertex ring is empty.");let f=0,v=u[2*i[0]];for(let R=1;R<i.length;R++){const z=u[2*i[R]];z<v&&(v=z,f=R)}const T=i.length;let S=f,I=(S+1)%T;for(;;){const R=S-1>=0?S-1:T-1,z=(I+1)%T,N=u[2*i[R]],U=u[2*i[z]],q=u[2*i[S]],Y=u[2*i[S]+1],J=u[2*i[I]+1];let te=!1;if(N<U)te=!0;else if(N>U)te=!1;else{const le=J-Y,ge=-(u[2*i[I]]-q),Le=Y<J?1:-1;((N-q)*le+(u[2*i[R]+1]-Y)*ge)*Le>((U-q)*le+(u[2*i[z]+1]-Y)*ge)*Le&&(te=!0)}if(te){const le=i[R],ge=i[S],Le=i[I];le!==ge&&le!==Le&&ge!==Le&&o.push(Le,ge,le),S--,S<0&&(S=T-1)}else{const le=i[z],ge=i[S],Le=i[I];le!==ge&&le!==Le&&ge!==Le&&o.push(Le,ge,le),I++,I>=T&&(I=0)}if(R===z)break}}function qg(u,i,o,f,v,T,S,I,R){const z=v.length/2,N=S&&I&&R;if(z<Gn.MAX_VERTEX_ARRAY_LENGTH){const U=i.prepareSegment(z,o,f),q=U.vertexLength;for(let te=0;te<T.length;te+=3)f.emplaceBack(q+T[te],q+T[te+1],q+T[te+2]);let Y,J;U.vertexLength+=z,U.primitiveLength+=T.length/3,N&&(J=S.prepareSegment(z,o,I),Y=J.vertexLength,J.vertexLength+=z);for(let te=0;te<v.length;te+=2)u(v[te],v[te+1]);if(N)for(let te=0;te<R.length;te++){const le=R[te];for(let ge=1;ge<le.length;ge+=2)I.emplaceBack(Y+le[ge-1],Y+le[ge]);J.primitiveLength+=le.length/2}}else(function(U,q,Y,J,te,le){const ge=[];for(let Se=0;Se<J.length/2;Se++)ge.push(-1);const Le={count:0};let we=0,K=U.getOrCreateLatestSegment(q,Y),se=K.vertexLength;for(let Se=2;Se<te.length;Se+=3){const et=te[Se-2],yt=te[Se-1],st=te[Se];let ht=ge[et]<we,St=ge[yt]<we,bt=ge[st]<we;K.vertexLength+((ht?1:0)+(St?1:0)+(bt?1:0))>Gn.MAX_VERTEX_ARRAY_LENGTH&&(K=U.createNewSegment(q,Y),we=Le.count,ht=!0,St=!0,bt=!0,se=0);const Ct=Xo(ge,J,le,Le,et,ht,K),pt=Xo(ge,J,le,Le,yt,St,K),Gt=Xo(ge,J,le,Le,st,bt,K);Y.emplaceBack(se+Ct-we,se+pt-we,se+Gt-we),K.primitiveLength++}})(i,o,f,v,T,u),N&&function(U,q,Y,J,te,le){const ge=[];for(let Se=0;Se<J.length/2;Se++)ge.push(-1);const Le={count:0};let we=0,K=U.getOrCreateLatestSegment(q,Y),se=K.vertexLength;for(let Se=0;Se<te.length;Se++){const et=te[Se];for(let yt=1;yt<te[Se].length;yt+=2){const st=et[yt-1],ht=et[yt];let St=ge[st]<we,bt=ge[ht]<we;K.vertexLength+((St?1:0)+(bt?1:0))>Gn.MAX_VERTEX_ARRAY_LENGTH&&(K=U.createNewSegment(q,Y),we=Le.count,St=!0,bt=!0,se=0);const Ct=Xo(ge,J,le,Le,st,St,K),pt=Xo(ge,J,le,Le,ht,bt,K);Y.emplaceBack(se+Ct-we,se+pt-we),K.primitiveLength++}}}(S,o,I,v,R,u),i.forceNewSegmentOnNextPrepare(),S==null||S.forceNewSegmentOnNextPrepare()}function Xo(u,i,o,f,v,T,S){if(T){const I=f.count;return o(i[2*v],i[2*v+1]),u[v]=f.count,f.count++,S.vertexLength++,I}return u[v]}class Xu{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new at,this.indexArray=new yr,this.indexArray2=new _r,this.programConfigurations=new qa(i.layers,i.zoom),this.segments=new Gn,this.segments2=new Gn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.hasPattern=Ng("fill",this.layers,o);const v=this.layers[0].layout.get("fill-sort-key"),T=!v.isConstant(),S=[];for(const{feature:I,id:R,index:z,sourceLayerIndex:N}of i){const U=this.layers[0]._featureFilter.needGeometry,q=Nc(I,U);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom,{globalState:this.globalState}),q,f))continue;const Y=T?v.evaluate(q,{},f,o.availableImages):void 0,J={id:R,properties:I.properties,type:I.type,sourceLayerIndex:N,index:z,geometry:U?q.geometry:Zu(I),patterns:{},sortKey:Y};S.push(J)}T&&S.sort((I,R)=>I.sortKey-R.sortKey);for(const I of S){const{geometry:R,index:z,sourceLayerIndex:N}=I;if(this.hasPattern){const U=Bg("fill",this.layers,I,this.zoom,o);this.patternFeatures.push(U)}else this.addFeature(I,R,z,f,{},o.subdivisionGranularity);o.featureIndex.insert(i[z].feature,R,z,N,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,f)}addFeatures(i,o,f){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,f,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Ti),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,o,f,v,T,S){for(const I of dd(o,500)){const R=Wo(I,v,S.fill.getGranularityForZoomLevel(v.z)),z=this.layoutVertexArray;qg((N,U)=>{z.emplaceBack(N,U)},this.segments,this.layoutVertexArray,this.indexArray,R.verticesFlattened,R.indicesTriangles,this.segments2,this.indexArray2,R.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,T,v)}}let Yu,pm;Ft("FillBucket",Xu,{omit:["layers","patternFeatures"]});var Gg={get paint(){return pm=pm||new fa({"fill-antialias":new jt(ke.paint_fill["fill-antialias"]),"fill-opacity":new Jt(ke.paint_fill["fill-opacity"]),"fill-color":new Jt(ke.paint_fill["fill-color"]),"fill-outline-color":new Jt(ke.paint_fill["fill-outline-color"]),"fill-translate":new jt(ke.paint_fill["fill-translate"]),"fill-translate-anchor":new jt(ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new Id(ke.paint_fill["fill-pattern"])})},get layout(){return Yu=Yu||new fa({"fill-sort-key":new Jt(ke.layout_fill["fill-sort-key"])})}};class ou extends oa{constructor(i){super(i,Gg)}recalculate(i,o){super.recalculate(i,o);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Xu(i)}queryRadius(){return $f(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:i,geometry:o,transform:f,pixelsToTileUnits:v}){return Pg(qf(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-f.bearingInRadians,v),o)}isTileClipped(){return!0}}const nv=Yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),zd=Yr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ep}=nv;var zh,Oh,mm,Hg,Nh,Zg,tp,np={};function rv(){if(Oh)return zh;Oh=1;var u=X();function i(v,T,S,I,R){this.properties={},this.extent=S,this.type=0,this._pbf=v,this._geometry=-1,this._keys=I,this._values=R,v.readFields(o,this,T)}function o(v,T,S){v==1?T.id=S.readVarint():v==2?function(I,R){for(var z=I.readVarint()+I.pos;I.pos<z;){var N=R._keys[I.readVarint()],U=R._values[I.readVarint()];R.properties[N]=U}}(S,T):v==3?T.type=S.readVarint():v==4&&(T._geometry=S.pos)}function f(v){for(var T,S,I=0,R=0,z=v.length,N=z-1;R<z;N=R++)I+=((S=v[N]).x-(T=v[R]).x)*(T.y+S.y);return I}return zh=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var v=this._pbf;v.pos=this._geometry;for(var T,S=v.readVarint()+v.pos,I=1,R=0,z=0,N=0,U=[];v.pos<S;){if(R<=0){var q=v.readVarint();I=7&q,R=q>>3}if(R--,I===1||I===2)z+=v.readSVarint(),N+=v.readSVarint(),I===1&&(T&&U.push(T),T=[]),T.push(new u(z,N));else{if(I!==7)throw new Error("unknown command "+I);T&&T.push(T[0].clone())}}return T&&U.push(T),U},i.prototype.bbox=function(){var v=this._pbf;v.pos=this._geometry;for(var T=v.readVarint()+v.pos,S=1,I=0,R=0,z=0,N=1/0,U=-1/0,q=1/0,Y=-1/0;v.pos<T;){if(I<=0){var J=v.readVarint();S=7&J,I=J>>3}if(I--,S===1||S===2)(R+=v.readSVarint())<N&&(N=R),R>U&&(U=R),(z+=v.readSVarint())<q&&(q=z),z>Y&&(Y=z);else if(S!==7)throw new Error("unknown command "+S)}return[N,q,U,Y]},i.prototype.toGeoJSON=function(v,T,S){var I,R,z=this.extent*Math.pow(2,S),N=this.extent*v,U=this.extent*T,q=this.loadGeometry(),Y=i.types[this.type];function J(ge){for(var Le=0;Le<ge.length;Le++){var we=ge[Le];ge[Le]=[360*(we.x+N)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(we.y+U)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var te=[];for(I=0;I<q.length;I++)te[I]=q[I][0];J(q=te);break;case 2:for(I=0;I<q.length;I++)J(q[I]);break;case 3:for(q=function(ge){var Le=ge.length;if(Le<=1)return[ge];for(var we,K,se=[],Se=0;Se<Le;Se++){var et=f(ge[Se]);et!==0&&(K===void 0&&(K=et<0),K===et<0?(we&&se.push(we),we=[ge[Se]]):we.push(ge[Se]))}return we&&se.push(we),se}(q),I=0;I<q.length;I++)for(R=0;R<q[I].length;R++)J(q[I][R])}q.length===1?q=q[0]:Y="Multi"+Y;var le={type:"Feature",geometry:{type:Y,coordinates:q},properties:this.properties};return"id"in this&&(le.id=this.id),le},zh}function iv(){if(Hg)return mm;Hg=1;var u=rv();function i(f,v){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(o,this,v),this.length=this._features.length}function o(f,v,T){f===15?v.version=T.readVarint():f===1?v.name=T.readString():f===5?v.extent=T.readVarint():f===2?v._features.push(T.pos):f===3?v._keys.push(T.readString()):f===4&&v._values.push(function(S){for(var I=null,R=S.readVarint()+S.pos;S.pos<R;){var z=S.readVarint()>>3;I=z===1?S.readString():z===2?S.readFloat():z===3?S.readDouble():z===4?S.readVarint64():z===5?S.readVarint():z===6?S.readSVarint():z===7?S.readBoolean():null}return I}(T))}return mm=i,i.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var v=this._pbf.readVarint()+this._pbf.pos;return new u(this._pbf,v,this.extent,this._keys,this._values)},mm}function Pr(){return tp||(tp=1,np.VectorTile=function(){if(Zg)return Nh;Zg=1;var u=iv();function i(o,f,v){if(o===3){var T=new u(v,v.readVarint()+v.pos);T.length&&(f[T.name]=T)}}return Nh=function(o,f){this.layers=o.readFields(i,{},f)},Nh}(),np.VectorTileFeature=rv(),np.VectorTileLayer=iv()),np}var Mr=P(Pr());const Jn=Mr.VectorTileFeature.types,rr=Math.pow(2,13);function hr(u,i,o,f,v,T,S,I){u.emplaceBack(i,o,2*Math.floor(f*rr)+S,v*rr*2,T*rr*2,Math.round(I))}class Ss{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Dt,this.centroidVertexArray=new Xe,this.indexArray=new yr,this.programConfigurations=new qa(i.layers,i.zoom),this.segments=new Gn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.features=[],this.hasPattern=Ng("fill-extrusion",this.layers,o);for(const{feature:v,id:T,index:S,sourceLayerIndex:I}of i){const R=this.layers[0]._featureFilter.needGeometry,z=Nc(v,R);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom,{globalState:this.globalState}),z,f))continue;const N={id:T,sourceLayerIndex:I,index:S,geometry:R?z.geometry:Zu(v),properties:v.properties,type:v.type,patterns:{}};this.hasPattern?this.features.push(Bg("fill-extrusion",this.layers,N,this.zoom,o)):this.addFeature(N,N.geometry,S,f,{},o.subdivisionGranularity),o.featureIndex.insert(v,N.geometry,S,I,this.index,!0)}}addFeatures(i,o,f){for(const v of this.features){const{geometry:T}=v;this.addFeature(v,T,v.index,o,f,i.subdivisionGranularity)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ep),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,zd.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,o,f,v,T,S){for(const I of dd(o,500)){const R={x:0,y:0,sampleCount:0},z=this.layoutVertexArray.length;this.processPolygon(R,v,i,I,S);const N=this.layoutVertexArray.length-z,U=Math.floor(R.x/R.sampleCount),q=Math.floor(R.y/R.sampleCount);for(let Y=0;Y<N;Y++)this.centroidVertexArray.emplaceBack(U,q)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,T,v)}processPolygon(i,o,f,v,T){if(v.length<1||gm(v[0]))return;for(const U of v)U.length!==0&&Fc(i,U);const S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},I=T.fill.getGranularityForZoomLevel(o.z),R=Jn[f.type]==="Polygon";for(const U of v){if(U.length===0||gm(U))continue;const q=Vc(U,I,R);this._generateSideFaces(q,S)}if(!R)return;const z=Wo(v,o,I,!1),N=this.layoutVertexArray;qg((U,q)=>{hr(N,U,q,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,z.verticesFlattened,z.indicesTriangles)}_generateSideFaces(i,o){let f=0;for(let v=1;v<i.length;v++){const T=i[v],S=i[v-1];if(Od(T,S))continue;o.segment.vertexLength+4>Gn.MAX_VERTEX_ARRAY_LENGTH&&(o.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const I=T.sub(S)._perp()._unit(),R=S.dist(T);f+R>32768&&(f=0),hr(this.layoutVertexArray,T.x,T.y,I.x,I.y,0,0,f),hr(this.layoutVertexArray,T.x,T.y,I.x,I.y,0,1,f),f+=R,hr(this.layoutVertexArray,S.x,S.y,I.x,I.y,0,0,f),hr(this.layoutVertexArray,S.x,S.y,I.x,I.y,0,1,f);const z=o.segment.vertexLength;this.indexArray.emplaceBack(z,z+2,z+1),this.indexArray.emplaceBack(z+1,z+2,z+3),o.segment.vertexLength+=4,o.segment.primitiveLength+=2}}}function Fc(u,i){for(let o=0;o<i.length;o++){const f=i[o];o===i.length-1&&i[0].x===f.x&&i[0].y===f.y||(u.x+=f.x,u.y+=f.y,u.sampleCount++)}}function Od(u,i){return u.x===i.x&&(u.x<0||u.x>It)||u.y===i.y&&(u.y<0||u.y>It)}function gm(u){return u.every(i=>i.x<0)||u.every(i=>i.x>It)||u.every(i=>i.y<0)||u.every(i=>i.y>It)}let lu;Ft("FillExtrusionBucket",Ss,{omit:["layers","features"]});var Fi={get paint(){return lu=lu||new fa({"fill-extrusion-opacity":new jt(ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Jt(ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new jt(ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new jt(ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Id(ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Jt(ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Jt(ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new jt(ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Uc extends oa{constructor(i){super(i,Fi)}createBucket(i){return new Ss(i)}queryRadius(){return $f(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:v,transform:T,pixelsToTileUnits:S,pixelPosMatrix:I}){const R=qf(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-T.bearingInRadians,S),z=this.paint.get("fill-extrusion-height").evaluate(o,f),N=this.paint.get("fill-extrusion-base").evaluate(o,f),U=function(Y,J){const te=[];for(const le of Y){const ge=[le.x,le.y,0,1];Bt(ge,ge,J),te.push(new ie(ge[0]/ge[3],ge[1]/ge[3]))}return te}(R,I),q=function(Y,J,te,le){const ge=[],Le=[],we=le[8]*J,K=le[9]*J,se=le[10]*J,Se=le[11]*J,et=le[8]*te,yt=le[9]*te,st=le[10]*te,ht=le[11]*te;for(const St of Y){const bt=[],Ct=[];for(const pt of St){const Gt=pt.x,tn=pt.y,Zt=le[0]*Gt+le[4]*tn+le[12],$t=le[1]*Gt+le[5]*tn+le[13],xn=le[2]*Gt+le[6]*tn+le[14],Fr=le[3]*Gt+le[7]*tn+le[15],ui=xn+se,ci=Fr+Se,Ao=Zt+et,ns=$t+yt,Ei=xn+st,ri=Fr+ht,Qi=new ie((Zt+we)/ci,($t+K)/ci);Qi.z=ui/ci,bt.push(Qi);const Ui=new ie(Ao/ri,ns/ri);Ui.z=Ei/ri,Ct.push(Ui)}ge.push(bt),Le.push(Ct)}return[ge,Le]}(v,N,z,I);return function(Y,J,te){let le=1/0;Pg(te,J)&&(le=ym(te,J[0]));for(let ge=0;ge<J.length;ge++){const Le=J[ge],we=Y[ge];for(let K=0;K<Le.length-1;K++){const se=Le[K],Se=[se,Le[K+1],we[K+1],we[K],se];Cg(te,Se)&&(le=Math.min(le,ym(te,Se)))}}return le!==1/0&&le}(q[0],q[1],U)}}function Tl(u,i){return u.x*i.x+u.y*i.y}function ym(u,i){if(u.length===1){let o=0;const f=i[o++];let v;for(;!v||f.equals(v);)if(v=i[o++],!v)return 1/0;for(;o<i.length;o++){const T=i[o],S=u[0],I=v.sub(f),R=T.sub(f),z=S.sub(f),N=Tl(I,I),U=Tl(I,R),q=Tl(R,R),Y=Tl(z,I),J=Tl(z,R),te=N*q-U*U,le=(q*Y-U*J)/te,ge=(N*J-U*Y)/te,Le=f.z*(1-le-ge)+v.z*le+T.z*ge;if(isFinite(Le))return Le}return 1/0}{let o=1/0;for(const f of i)o=Math.min(o,f.z);return o}}const Yo=Yr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Nd}=Yo,rp=Yr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Zs}=rp,Kg=Mr.VectorTileFeature.types,Wg=Math.cos(Math.PI/180*37.5),ip=Math.pow(2,14)/.5;class Bd{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new kt,this.layoutVertexArray2=new vt,this.indexArray=new yr,this.programConfigurations=new qa(i.layers,i.zoom),this.segments=new Gn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.hasPattern=Ng("line",this.layers,o);const v=this.layers[0].layout.get("line-sort-key"),T=!v.isConstant(),S=[];for(const{feature:I,id:R,index:z,sourceLayerIndex:N}of i){const U=this.layers[0]._featureFilter.needGeometry,q=Nc(I,U);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom,{globalState:this.globalState}),q,f))continue;const Y=T?v.evaluate(q,{},f):void 0,J={id:R,properties:I.properties,type:I.type,sourceLayerIndex:N,index:z,geometry:U?q.geometry:Zu(I),patterns:{},sortKey:Y};S.push(J)}T&&S.sort((I,R)=>I.sortKey-R.sortKey);for(const I of S){const{geometry:R,index:z,sourceLayerIndex:N}=I;if(this.hasPattern){const U=Bg("line",this.layers,I,this.zoom,o);this.patternFeatures.push(U)}else this.addFeature(I,R,z,f,{},o.subdivisionGranularity);o.featureIndex.insert(i[z].feature,R,z,N,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,f)}addFeatures(i,o,f){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,f,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Zs)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Nd),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,o,f,v,T,S){const I=this.layers[0].layout,R=I.get("line-join").evaluate(i,{}),z=I.get("line-cap"),N=I.get("line-miter-limit"),U=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const q of o)this.addLine(q,i,R,z,N,U,v,S);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,T,v)}addLine(i,o,f,v,T,S,I,R){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,i=Vc(i,I?R.line.getGranularityForZoomLevel(I.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let we=0;we<i.length-1;we++)this.totalDistance+=i[we].dist(i[we+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const z=Kg[o.type]==="Polygon";let N=i.length;for(;N>=2&&i[N-1].equals(i[N-2]);)N--;let U=0;for(;U<N-1&&i[U].equals(i[U+1]);)U++;if(N<(z?3:2))return;f==="bevel"&&(T=1.05);const q=this.overscaling<=16?122880/(512*this.overscaling):0,Y=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let J,te,le,ge,Le;this.e1=this.e2=-1,z&&(J=i[N-2],Le=i[U].sub(J)._unit()._perp());for(let we=U;we<N;we++){if(le=we===N-1?z?i[U+1]:void 0:i[we+1],le&&i[we].equals(le))continue;Le&&(ge=Le),J&&(te=J),J=i[we],Le=le?le.sub(J)._unit()._perp():ge,ge=ge||Le;let K=ge.add(Le);K.x===0&&K.y===0||K._unit();const se=ge.x*Le.x+ge.y*Le.y,Se=K.x*Le.x+K.y*Le.y,et=Se!==0?1/Se:1/0,yt=2*Math.sqrt(2-2*Se),st=Se<Wg&&te&&le,ht=ge.x*Le.y-ge.y*Le.x>0;if(st&&we>U){const Ct=J.dist(te);if(Ct>2*q){const pt=J.sub(J.sub(te)._mult(q/Ct)._round());this.updateDistance(te,pt),this.addCurrentVertex(pt,ge,0,0,Y),te=pt}}const St=te&&le;let bt=St?f:z?"butt":v;if(St&&bt==="round"&&(et<S?bt="miter":et<=2&&(bt="fakeround")),bt==="miter"&&et>T&&(bt="bevel"),bt==="bevel"&&(et>2&&(bt="flipbevel"),et<T&&(bt="miter")),te&&this.updateDistance(te,J),bt==="miter")K._mult(et),this.addCurrentVertex(J,K,0,0,Y);else if(bt==="flipbevel"){if(et>100)K=Le.mult(-1);else{const Ct=et*ge.add(Le).mag()/ge.sub(Le).mag();K._perp()._mult(Ct*(ht?-1:1))}this.addCurrentVertex(J,K,0,0,Y),this.addCurrentVertex(J,K.mult(-1),0,0,Y)}else if(bt==="bevel"||bt==="fakeround"){const Ct=-Math.sqrt(et*et-1),pt=ht?Ct:0,Gt=ht?0:Ct;if(te&&this.addCurrentVertex(J,ge,pt,Gt,Y),bt==="fakeround"){const tn=Math.round(180*yt/Math.PI/20);for(let Zt=1;Zt<tn;Zt++){let $t=Zt/tn;if($t!==.5){const Fr=$t-.5;$t+=$t*Fr*($t-1)*((1.0904+se*(se*(3.55645-1.43519*se)-3.2452))*Fr*Fr+(.848013+se*(.215638*se-1.06021)))}const xn=Le.sub(ge)._mult($t)._add(ge)._unit()._mult(ht?-1:1);this.addHalfVertex(J,xn.x,xn.y,!1,ht,0,Y)}}le&&this.addCurrentVertex(J,Le,-pt,-Gt,Y)}else if(bt==="butt")this.addCurrentVertex(J,K,0,0,Y);else if(bt==="square"){const Ct=te?1:-1;this.addCurrentVertex(J,K,Ct,Ct,Y)}else bt==="round"&&(te&&(this.addCurrentVertex(J,ge,0,0,Y),this.addCurrentVertex(J,ge,1,1,Y,!0)),le&&(this.addCurrentVertex(J,Le,-1,-1,Y,!0),this.addCurrentVertex(J,Le,0,0,Y)));if(st&&we<N-1){const Ct=J.dist(le);if(Ct>2*q){const pt=J.add(le.sub(J)._mult(q/Ct)._round());this.updateDistance(J,pt),this.addCurrentVertex(pt,Le,0,0,Y),J=pt}}}}addCurrentVertex(i,o,f,v,T,S=!1){const I=o.y*v-o.x,R=-o.y-o.x*v;this.addHalfVertex(i,o.x+o.y*f,o.y-o.x*f,S,!1,f,T),this.addHalfVertex(i,I,R,S,!0,-v,T),this.distance>ip/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,o,f,v,T,S))}addHalfVertex({x:i,y:o},f,v,T,S,I,R){const z=.5*(this.lineClips?this.scaledDistance*(ip-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(T?1:0),(o<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*v)+128,1+(I===0?0:I<0?-1:1)|(63&z)<<2,z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=R.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,N,this.e2),R.primitiveLength++),S?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,o){this.distance+=i.dist(o),this.updateScaledDistance()}}let Qu,Ra;Ft("LineBucket",Bd,{omit:["layers","patternFeatures"]});var Ju={get paint(){return Ra=Ra||new fa({"line-opacity":new Jt(ke.paint_line["line-opacity"]),"line-color":new Jt(ke.paint_line["line-color"]),"line-translate":new jt(ke.paint_line["line-translate"]),"line-translate-anchor":new jt(ke.paint_line["line-translate-anchor"]),"line-width":new Jt(ke.paint_line["line-width"]),"line-gap-width":new Jt(ke.paint_line["line-gap-width"]),"line-offset":new Jt(ke.paint_line["line-offset"]),"line-blur":new Jt(ke.paint_line["line-blur"]),"line-dasharray":new si(ke.paint_line["line-dasharray"]),"line-pattern":new Id(ke.paint_line["line-pattern"]),"line-gradient":new Uu(ke.paint_line["line-gradient"])})},get layout(){return Qu=Qu||new fa({"line-cap":new jt(ke.layout_line["line-cap"]),"line-join":new Jt(ke.layout_line["line-join"]),"line-miter-limit":new jt(ke.layout_line["line-miter-limit"]),"line-round-limit":new jt(ke.layout_line["line-round-limit"]),"line-sort-key":new Jt(ke.layout_line["line-sort-key"])})}};class Vd extends Jt{possiblyEvaluate(i,o){return o=new Lr(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(i,o)}evaluate(i,o,f,v){return o=gi({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(i,o,f,v)}}let ec;class Xg extends oa{constructor(i){super(i,Ju),this.gradientVersion=0,ec||(ec=new Vd(Ju.paint.properties["line-width"].specification),ec.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof Bl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,o){super.recalculate(i,o),this.paint._values["line-floorwidth"]=ec.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Bd(i)}queryRadius(i){const o=i,f=_m(Xi("line-width",this,o),Xi("line-gap-width",this,o)),v=Xi("line-offset",this,o);return f/2+Math.abs(v)+$f(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:v,transform:T,pixelsToTileUnits:S}){const I=qf(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-T.bearingInRadians,S),R=S/2*_m(this.paint.get("line-width").evaluate(o,f),this.paint.get("line-gap-width").evaluate(o,f)),z=this.paint.get("line-offset").evaluate(o,f);return z&&(v=function(N,U){const q=[];for(let Y=0;Y<N.length;Y++){const J=N[Y],te=[];for(let le=0;le<J.length;le++){const ge=J[le-1],Le=J[le],we=J[le+1],K=le===0?new ie(0,0):Le.sub(ge)._unit()._perp(),se=le===J.length-1?new ie(0,0):we.sub(Le)._unit()._perp(),Se=K._add(se)._unit(),et=Se.x*se.x+Se.y*se.y;et!==0&&Se._mult(1/et),te.push(Se._mult(U)._add(Le))}q.push(te)}return q}(v,z*S)),function(N,U,q){for(let Y=0;Y<U.length;Y++){const J=U[Y];if(N.length>=3){for(let te=0;te<J.length;te++)if(kh(N,J[te]))return!0}if(rm(N,J,q))return!0}return!1}(I,v,R)}isTileClipped(){return!0}}function _m(u,i){return i>0?i+2*u:u}const av=Yr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ap=Yr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Yr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Yg=Yr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Yr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ks=Yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),sv=Yr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Eo(u,i,o){return u.sections.forEach(f=>{f.text=function(v,T,S){const I=T.layout.get("text-transform").evaluate(S,{});return I==="uppercase"?v=v.toLocaleUpperCase():I==="lowercase"&&(v=v.toLocaleLowerCase()),Go.applyArabicShaping&&(v=Go.applyArabicShaping(v)),v}(f.text,i,o)}),u}Yr([{name:"triangle",components:3,type:"Uint16"}]),Yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Yr([{type:"Float32",name:"offsetX"}]),Yr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Yr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Fd={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Qg,Jg,tc,Si=24,sp={};function Ud(){return Qg||(Qg=1,sp.read=function(u,i,o,f,v){var T,S,I=8*v-f-1,R=(1<<I)-1,z=R>>1,N=-7,U=o?v-1:0,q=o?-1:1,Y=u[i+U];for(U+=q,T=Y&(1<<-N)-1,Y>>=-N,N+=I;N>0;T=256*T+u[i+U],U+=q,N-=8);for(S=T&(1<<-N)-1,T>>=-N,N+=f;N>0;S=256*S+u[i+U],U+=q,N-=8);if(T===0)T=1-z;else{if(T===R)return S?NaN:1/0*(Y?-1:1);S+=Math.pow(2,f),T-=z}return(Y?-1:1)*S*Math.pow(2,T-f)},sp.write=function(u,i,o,f,v,T){var S,I,R,z=8*T-v-1,N=(1<<z)-1,U=N>>1,q=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:T-1,J=f?1:-1,te=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(I=isNaN(i)?1:0,S=N):(S=Math.floor(Math.log(i)/Math.LN2),i*(R=Math.pow(2,-S))<1&&(S--,R*=2),(i+=S+U>=1?q/R:q*Math.pow(2,1-U))*R>=2&&(S++,R/=2),S+U>=N?(I=0,S=N):S+U>=1?(I=(i*R-1)*Math.pow(2,v),S+=U):(I=i*Math.pow(2,U-1)*Math.pow(2,v),S=0));v>=8;u[o+Y]=255&I,Y+=J,I/=256,v-=8);for(S=S<<v|I,z+=v;z>0;u[o+Y]=255&S,Y+=J,S/=256,z-=8);u[o+Y-J]|=128*te}),sp}function ey(){if(tc)return Jg;tc=1,Jg=i;var u=Ud();function i(K){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(K)?K:new Uint8Array(K||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,f=1/o,v=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function T(K){return K.type===i.Bytes?K.readVarint()+K.pos:K.pos+1}function S(K,se,Se){return Se?4294967296*se+(K>>>0):4294967296*(se>>>0)+(K>>>0)}function I(K,se,Se){var et=se<=16383?1:se<=2097151?2:se<=268435455?3:Math.floor(Math.log(se)/(7*Math.LN2));Se.realloc(et);for(var yt=Se.pos-1;yt>=K;yt--)Se.buf[yt+et]=Se.buf[yt]}function R(K,se){for(var Se=0;Se<K.length;Se++)se.writeVarint(K[Se])}function z(K,se){for(var Se=0;Se<K.length;Se++)se.writeSVarint(K[Se])}function N(K,se){for(var Se=0;Se<K.length;Se++)se.writeFloat(K[Se])}function U(K,se){for(var Se=0;Se<K.length;Se++)se.writeDouble(K[Se])}function q(K,se){for(var Se=0;Se<K.length;Se++)se.writeBoolean(K[Se])}function Y(K,se){for(var Se=0;Se<K.length;Se++)se.writeFixed32(K[Se])}function J(K,se){for(var Se=0;Se<K.length;Se++)se.writeSFixed32(K[Se])}function te(K,se){for(var Se=0;Se<K.length;Se++)se.writeFixed64(K[Se])}function le(K,se){for(var Se=0;Se<K.length;Se++)se.writeSFixed64(K[Se])}function ge(K,se){return(K[se]|K[se+1]<<8|K[se+2]<<16)+16777216*K[se+3]}function Le(K,se,Se){K[Se]=se,K[Se+1]=se>>>8,K[Se+2]=se>>>16,K[Se+3]=se>>>24}function we(K,se){return(K[se]|K[se+1]<<8|K[se+2]<<16)+(K[se+3]<<24)}return i.prototype={destroy:function(){this.buf=null},readFields:function(K,se,Se){for(Se=Se||this.length;this.pos<Se;){var et=this.readVarint(),yt=et>>3,st=this.pos;this.type=7&et,K(yt,se,this),this.pos===st&&this.skip(et)}return se},readMessage:function(K,se){return this.readFields(K,se,this.readVarint()+this.pos)},readFixed32:function(){var K=ge(this.buf,this.pos);return this.pos+=4,K},readSFixed32:function(){var K=we(this.buf,this.pos);return this.pos+=4,K},readFixed64:function(){var K=ge(this.buf,this.pos)+ge(this.buf,this.pos+4)*o;return this.pos+=8,K},readSFixed64:function(){var K=ge(this.buf,this.pos)+we(this.buf,this.pos+4)*o;return this.pos+=8,K},readFloat:function(){var K=u.read(this.buf,this.pos,!0,23,4);return this.pos+=4,K},readDouble:function(){var K=u.read(this.buf,this.pos,!0,52,8);return this.pos+=8,K},readVarint:function(K){var se,Se,et=this.buf;return se=127&(Se=et[this.pos++]),Se<128?se:(se|=(127&(Se=et[this.pos++]))<<7,Se<128?se:(se|=(127&(Se=et[this.pos++]))<<14,Se<128?se:(se|=(127&(Se=et[this.pos++]))<<21,Se<128?se:function(yt,st,ht){var St,bt,Ct=ht.buf;if(St=(112&(bt=Ct[ht.pos++]))>>4,bt<128||(St|=(127&(bt=Ct[ht.pos++]))<<3,bt<128)||(St|=(127&(bt=Ct[ht.pos++]))<<10,bt<128)||(St|=(127&(bt=Ct[ht.pos++]))<<17,bt<128)||(St|=(127&(bt=Ct[ht.pos++]))<<24,bt<128)||(St|=(1&(bt=Ct[ht.pos++]))<<31,bt<128))return S(yt,St,st);throw new Error("Expected varint not more than 10 bytes")}(se|=(15&(Se=et[this.pos]))<<28,K,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var K=this.readVarint();return K%2==1?(K+1)/-2:K/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var K=this.readVarint()+this.pos,se=this.pos;return this.pos=K,K-se>=12&&v?function(Se,et,yt){return v.decode(Se.subarray(et,yt))}(this.buf,se,K):function(Se,et,yt){for(var st="",ht=et;ht<yt;){var St,bt,Ct,pt=Se[ht],Gt=null,tn=pt>239?4:pt>223?3:pt>191?2:1;if(ht+tn>yt)break;tn===1?pt<128&&(Gt=pt):tn===2?(192&(St=Se[ht+1]))==128&&(Gt=(31&pt)<<6|63&St)<=127&&(Gt=null):tn===3?(bt=Se[ht+2],(192&(St=Se[ht+1]))==128&&(192&bt)==128&&((Gt=(15&pt)<<12|(63&St)<<6|63&bt)<=2047||Gt>=55296&&Gt<=57343)&&(Gt=null)):tn===4&&(bt=Se[ht+2],Ct=Se[ht+3],(192&(St=Se[ht+1]))==128&&(192&bt)==128&&(192&Ct)==128&&((Gt=(15&pt)<<18|(63&St)<<12|(63&bt)<<6|63&Ct)<=65535||Gt>=1114112)&&(Gt=null)),Gt===null?(Gt=65533,tn=1):Gt>65535&&(Gt-=65536,st+=String.fromCharCode(Gt>>>10&1023|55296),Gt=56320|1023&Gt),st+=String.fromCharCode(Gt),ht+=tn}return st}(this.buf,se,K)},readBytes:function(){var K=this.readVarint()+this.pos,se=this.buf.subarray(this.pos,K);return this.pos=K,se},readPackedVarint:function(K,se){if(this.type!==i.Bytes)return K.push(this.readVarint(se));var Se=T(this);for(K=K||[];this.pos<Se;)K.push(this.readVarint(se));return K},readPackedSVarint:function(K){if(this.type!==i.Bytes)return K.push(this.readSVarint());var se=T(this);for(K=K||[];this.pos<se;)K.push(this.readSVarint());return K},readPackedBoolean:function(K){if(this.type!==i.Bytes)return K.push(this.readBoolean());var se=T(this);for(K=K||[];this.pos<se;)K.push(this.readBoolean());return K},readPackedFloat:function(K){if(this.type!==i.Bytes)return K.push(this.readFloat());var se=T(this);for(K=K||[];this.pos<se;)K.push(this.readFloat());return K},readPackedDouble:function(K){if(this.type!==i.Bytes)return K.push(this.readDouble());var se=T(this);for(K=K||[];this.pos<se;)K.push(this.readDouble());return K},readPackedFixed32:function(K){if(this.type!==i.Bytes)return K.push(this.readFixed32());var se=T(this);for(K=K||[];this.pos<se;)K.push(this.readFixed32());return K},readPackedSFixed32:function(K){if(this.type!==i.Bytes)return K.push(this.readSFixed32());var se=T(this);for(K=K||[];this.pos<se;)K.push(this.readSFixed32());return K},readPackedFixed64:function(K){if(this.type!==i.Bytes)return K.push(this.readFixed64());var se=T(this);for(K=K||[];this.pos<se;)K.push(this.readFixed64());return K},readPackedSFixed64:function(K){if(this.type!==i.Bytes)return K.push(this.readSFixed64());var se=T(this);for(K=K||[];this.pos<se;)K.push(this.readSFixed64());return K},skip:function(K){var se=7&K;if(se===i.Varint)for(;this.buf[this.pos++]>127;);else if(se===i.Bytes)this.pos=this.readVarint()+this.pos;else if(se===i.Fixed32)this.pos+=4;else{if(se!==i.Fixed64)throw new Error("Unimplemented type: "+se);this.pos+=8}},writeTag:function(K,se){this.writeVarint(K<<3|se)},realloc:function(K){for(var se=this.length||16;se<this.pos+K;)se*=2;if(se!==this.length){var Se=new Uint8Array(se);Se.set(this.buf),this.buf=Se,this.length=se}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(K){this.realloc(4),Le(this.buf,K,this.pos),this.pos+=4},writeSFixed32:function(K){this.realloc(4),Le(this.buf,K,this.pos),this.pos+=4},writeFixed64:function(K){this.realloc(8),Le(this.buf,-1&K,this.pos),Le(this.buf,Math.floor(K*f),this.pos+4),this.pos+=8},writeSFixed64:function(K){this.realloc(8),Le(this.buf,-1&K,this.pos),Le(this.buf,Math.floor(K*f),this.pos+4),this.pos+=8},writeVarint:function(K){(K=+K||0)>268435455||K<0?function(se,Se){var et,yt;if(se>=0?(et=se%4294967296|0,yt=se/4294967296|0):(yt=~(-se/4294967296),4294967295^(et=~(-se%4294967296))?et=et+1|0:(et=0,yt=yt+1|0)),se>=18446744073709552e3||se<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Se.realloc(10),function(st,ht,St){St.buf[St.pos++]=127&st|128,st>>>=7,St.buf[St.pos++]=127&st|128,st>>>=7,St.buf[St.pos++]=127&st|128,st>>>=7,St.buf[St.pos++]=127&st|128,St.buf[St.pos]=127&(st>>>=7)}(et,0,Se),function(st,ht){var St=(7&st)<<4;ht.buf[ht.pos++]|=St|((st>>>=3)?128:0),st&&(ht.buf[ht.pos++]=127&st|((st>>>=7)?128:0),st&&(ht.buf[ht.pos++]=127&st|((st>>>=7)?128:0),st&&(ht.buf[ht.pos++]=127&st|((st>>>=7)?128:0),st&&(ht.buf[ht.pos++]=127&st|((st>>>=7)?128:0),st&&(ht.buf[ht.pos++]=127&st)))))}(yt,Se)}(K,this):(this.realloc(4),this.buf[this.pos++]=127&K|(K>127?128:0),K<=127||(this.buf[this.pos++]=127&(K>>>=7)|(K>127?128:0),K<=127||(this.buf[this.pos++]=127&(K>>>=7)|(K>127?128:0),K<=127||(this.buf[this.pos++]=K>>>7&127))))},writeSVarint:function(K){this.writeVarint(K<0?2*-K-1:2*K)},writeBoolean:function(K){this.writeVarint(!!K)},writeString:function(K){K=String(K),this.realloc(4*K.length),this.pos++;var se=this.pos;this.pos=function(et,yt,st){for(var ht,St,bt=0;bt<yt.length;bt++){if((ht=yt.charCodeAt(bt))>55295&&ht<57344){if(!St){ht>56319||bt+1===yt.length?(et[st++]=239,et[st++]=191,et[st++]=189):St=ht;continue}if(ht<56320){et[st++]=239,et[st++]=191,et[st++]=189,St=ht;continue}ht=St-55296<<10|ht-56320|65536,St=null}else St&&(et[st++]=239,et[st++]=191,et[st++]=189,St=null);ht<128?et[st++]=ht:(ht<2048?et[st++]=ht>>6|192:(ht<65536?et[st++]=ht>>12|224:(et[st++]=ht>>18|240,et[st++]=ht>>12&63|128),et[st++]=ht>>6&63|128),et[st++]=63&ht|128)}return st}(this.buf,K,this.pos);var Se=this.pos-se;Se>=128&&I(se,Se,this),this.pos=se-1,this.writeVarint(Se),this.pos+=Se},writeFloat:function(K){this.realloc(4),u.write(this.buf,K,this.pos,!0,23,4),this.pos+=4},writeDouble:function(K){this.realloc(8),u.write(this.buf,K,this.pos,!0,52,8),this.pos+=8},writeBytes:function(K){var se=K.length;this.writeVarint(se),this.realloc(se);for(var Se=0;Se<se;Se++)this.buf[this.pos++]=K[Se]},writeRawMessage:function(K,se){this.pos++;var Se=this.pos;K(se,this);var et=this.pos-Se;et>=128&&I(Se,et,this),this.pos=Se-1,this.writeVarint(et),this.pos+=et},writeMessage:function(K,se,Se){this.writeTag(K,i.Bytes),this.writeRawMessage(se,Se)},writePackedVarint:function(K,se){se.length&&this.writeMessage(K,R,se)},writePackedSVarint:function(K,se){se.length&&this.writeMessage(K,z,se)},writePackedBoolean:function(K,se){se.length&&this.writeMessage(K,q,se)},writePackedFloat:function(K,se){se.length&&this.writeMessage(K,N,se)},writePackedDouble:function(K,se){se.length&&this.writeMessage(K,U,se)},writePackedFixed32:function(K,se){se.length&&this.writeMessage(K,Y,se)},writePackedSFixed32:function(K,se){se.length&&this.writeMessage(K,J,se)},writePackedFixed64:function(K,se){se.length&&this.writeMessage(K,te,se)},writePackedSFixed64:function(K,se){se.length&&this.writeMessage(K,le,se)},writeBytesField:function(K,se){this.writeTag(K,i.Bytes),this.writeBytes(se)},writeFixed32Field:function(K,se){this.writeTag(K,i.Fixed32),this.writeFixed32(se)},writeSFixed32Field:function(K,se){this.writeTag(K,i.Fixed32),this.writeSFixed32(se)},writeFixed64Field:function(K,se){this.writeTag(K,i.Fixed64),this.writeFixed64(se)},writeSFixed64Field:function(K,se){this.writeTag(K,i.Fixed64),this.writeSFixed64(se)},writeVarintField:function(K,se){this.writeTag(K,i.Varint),this.writeVarint(se)},writeSVarintField:function(K,se){this.writeTag(K,i.Varint),this.writeSVarint(se)},writeStringField:function(K,se){this.writeTag(K,i.Bytes),this.writeString(se)},writeFloatField:function(K,se){this.writeTag(K,i.Fixed32),this.writeFloat(se)},writeDoubleField:function(K,se){this.writeTag(K,i.Fixed64),this.writeDouble(se)},writeBooleanField:function(K,se){this.writeVarintField(K,!!se)}},Jg}var nc,vm=P(ey());function ty(u,i,o){u===1&&o.readMessage(ny,i)}function ny(u,i,o){if(u===3){const{id:f,bitmap:v,width:T,height:S,left:I,top:R,advance:z}=o.readMessage(Pb,{});i.push({id:f,bitmap:new Rd({width:T+6,height:S+6},v),metrics:{width:T,height:S,left:I,top:R,advance:z}})}}function Pb(u,i,o){u===1?i.id=o.readVarint():u===2?i.bitmap=o.readBytes():u===3?i.width=o.readVarint():u===4?i.height=o.readVarint():u===5?i.left=o.readSVarint():u===6?i.top=o.readSVarint():u===7&&(i.advance=o.readVarint())}function ov(u){let i=0,o=0;for(const S of u)i+=S.w*S.h,o=Math.max(o,S.w);u.sort((S,I)=>I.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),o),h:1/0}];let v=0,T=0;for(const S of u)for(let I=f.length-1;I>=0;I--){const R=f[I];if(!(S.w>R.w||S.h>R.h)){if(S.x=R.x,S.y=R.y,T=Math.max(T,S.y+S.h),v=Math.max(v,S.x+S.w),S.w===R.w&&S.h===R.h){const z=f.pop();I<f.length&&(f[I]=z)}else S.h===R.h?(R.x+=S.w,R.w-=S.w):S.w===R.w?(R.y+=S.h,R.h-=S.h):(f.push({x:R.x+S.w,y:R.y,w:R.w-S.w,h:S.h}),R.y+=S.h,R.h-=S.h);break}}return{w:v,h:T,fill:i/(v*T)||0}}class ry{constructor(i,{pixelRatio:o,version:f,stretchX:v,stretchY:T,content:S,textFitWidth:I,textFitHeight:R}){this.paddedRect=i,this.pixelRatio=o,this.stretchX=v,this.stretchY=T,this.content=S,this.version=f,this.textFitWidth=I,this.textFitHeight=R}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class iy{constructor(i,o){const f={},v={};this.haveRenderCallbacks=[];const T=[];this.addImages(i,f,T),this.addImages(o,v,T);const{w:S,h:I}=ov(T),R=new Ga({width:S||1,height:I||1});for(const z in i){const N=i[z],U=f[z].paddedRect;Ga.copy(N.data,R,{x:0,y:0},{x:U.x+1,y:U.y+1},N.data)}for(const z in o){const N=o[z],U=v[z].paddedRect,q=U.x+1,Y=U.y+1,J=N.data.width,te=N.data.height;Ga.copy(N.data,R,{x:0,y:0},{x:q,y:Y},N.data),Ga.copy(N.data,R,{x:0,y:te-1},{x:q,y:Y-1},{width:J,height:1}),Ga.copy(N.data,R,{x:0,y:0},{x:q,y:Y+te},{width:J,height:1}),Ga.copy(N.data,R,{x:J-1,y:0},{x:q-1,y:Y},{width:1,height:te}),Ga.copy(N.data,R,{x:0,y:0},{x:q+J,y:Y},{width:1,height:te})}this.image=R,this.iconPositions=f,this.patternPositions=v}addImages(i,o,f){for(const v in i){const T=i[v],S={x:0,y:0,w:T.data.width+2,h:T.data.height+2};f.push(S),o[v]=new ry(S,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(i,o){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in i.updatedImages)this.patchUpdatedImage(this.iconPositions[f],i.getImage(f),o),this.patchUpdatedImage(this.patternPositions[f],i.getImage(f),o)}patchUpdatedImage(i,o,f){if(!i||!o||i.version===o.version)return;i.version=o.version;const[v,T]=i.tl;f.update(o.data,void 0,{x:v,y:T})}}Ft("ImagePosition",ry),Ft("ImageAtlas",iy),y.an=void 0,(nc=y.an||(y.an={}))[nc.none=0]="none",nc[nc.horizontal=1]="horizontal",nc[nc.vertical=2]="vertical",nc[nc.horizontalOnly=3]="horizontalOnly";class jd{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(i,o,f){const v=new jd;return v.scale=i||1,v.fontStack=o,v.verticalAlign=f||"bottom",v}static forImage(i,o){const f=new jd;return f.imageName=i,f.verticalAlign=o||"bottom",f}}class Sl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,o){const f=new Sl;for(let v=0;v<i.sections.length;v++){const T=i.sections[v];T.image?f.addImageSection(T):f.addTextSection(T,o)}return f}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let o="";for(let f=0;f<i.length;f++){const v=i.charCodeAt(f+1)||null,T=i.charCodeAt(f-1)||null;o+=v&&Sd(v)&&!Fd[i[f+1]]||T&&Sd(T)&&!Fd[i[f-1]]||!Fd[i[f]]?i[f]:Fd[i[f]]}return o}(this.text)}trim(){let i=0;for(let f=0;f<this.text.length&&op[this.text.charCodeAt(f)];f++)i++;let o=this.text.length;for(let f=this.text.length-1;f>=0&&f>=i&&op[this.text.charCodeAt(f)];f--)o--;this.text=this.text.substring(i,o),this.sectionIndex=this.sectionIndex.slice(i,o)}substring(i,o){const f=new Sl;return f.text=this.text.substring(i,o),f.sectionIndex=this.sectionIndex.slice(i,o),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,o)=>Math.max(i,this.sections[o].scale),0)}getMaxImageSize(i){let o=0,f=0;for(let v=0;v<this.length();v++){const T=this.getSection(v);if(T.imageName){const S=i[T.imageName];if(!S)continue;const I=S.displaySize;o=Math.max(o,I[0]),f=Math.max(f,I[1])}}return{maxImageWidth:o,maxImageHeight:f}}addTextSection(i,o){this.text+=i.text,this.sections.push(jd.forText(i.scale,i.fontStack||o,i.verticalAlign));const f=this.sections.length-1;for(let v=0;v<i.text.length;++v)this.sectionIndex.push(f)}addImageSection(i){const o=i.image?i.image.name:"";if(o.length===0)return void Cr("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(jd.forImage(o,i.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Cr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Bh(u,i,o,f,v,T,S,I,R,z,N,U,q,Y,J){const te=Sl.fromFeature(u,v);let le;U===y.an.vertical&&te.verticalizePunctuation();const{processBidirectionalText:ge,processStyledBidirectionalText:Le}=Go;if(ge&&te.sections.length===1){le=[];const se=ge(te.toString(),bm(te,z,T,i,f,Y));for(const Se of se){const et=new Sl;et.text=Se,et.sections=te.sections;for(let yt=0;yt<Se.length;yt++)et.sectionIndex.push(0);le.push(et)}}else if(Le){le=[];const se=Le(te.text,te.sectionIndex,bm(te,z,T,i,f,Y));for(const Se of se){const et=new Sl;et.text=Se[0],et.sectionIndex=Se[1],et.sections=te.sections,le.push(et)}}else le=function(se,Se){const et=[],yt=se.text;let st=0;for(const ht of Se)et.push(se.substring(st,ht)),st=ht;return st<yt.length&&et.push(se.substring(st,yt.length)),et}(te,bm(te,z,T,i,f,Y));const we=[],K={positionedLines:we,text:te.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:U,iconsInText:!1,verticalizable:!1};return function(se,Se,et,yt,st,ht,St,bt,Ct,pt,Gt,tn){let Zt=0,$t=0,xn=0,Fr=0;const ui=bt==="right"?1:bt==="left"?0:.5,ci=Si/tn;let Ao=0;for(const ri of st){ri.trim();const Qi=ri.getMaxScale(),Ui={positionedGlyphs:[],lineOffset:0};se.positionedLines[Ao]=Ui;const ua=Ui.positionedGlyphs;let rs=0;if(!ri.length()){$t+=ht,++Ao;continue}const is=ly(yt,ri,ci);for(let as=0;as<ri.length();as++){const hi=ri.getSection(as),ji=ri.getSectionIndex(as),Ii=ri.getCharCode(as),Ci=dv(Ct,Gt,Ii);let Hr;if(hi.imageName){if(se.iconsInText=!0,hi.scale=hi.scale*ci,Hr=Rb(hi,Ci,Qi,is,yt),!Hr)continue;rs=Math.max(rs,Hr.imageOffset)}else if(Hr=Mb(hi,Ii,Ci,is,Se,et),!Hr)continue;const{rect:Xs,metrics:s,baselineOffset:h}=Hr;ua.push({glyph:Ii,imageName:hi.imageName,x:Zt,y:$t+h+-17,vertical:Ci,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:ji,metrics:s,rect:Xs}),Ci?(se.verticalizable=!0,Zt+=(hi.imageName?s.advance:Si)*hi.scale+pt):Zt+=s.advance*hi.scale+pt}ua.length!==0&&(xn=Math.max(Zt-pt,xn),kb(ua,0,ua.length-1,ui)),Zt=0,Ui.lineOffset=Math.max(rs,(Qi-1)*Si);const Ai=ht*Qi+rs;$t+=Ai,Fr=Math.max(Ai,Fr),++Ao}const{horizontalAlign:ns,verticalAlign:Ei}=Nr(St);(function(ri,Qi,Ui,ua,rs,is,Ai,as,hi){const ji=(Qi-Ui)*rs;let Ii=0;Ii=is!==Ai?-as*ua- -17:-ua*hi*Ai+.5*Ai;for(const Ci of ri)for(const Hr of Ci.positionedGlyphs)Hr.x+=ji,Hr.y+=Ii})(se.positionedLines,ui,ns,Ei,xn,Fr,ht,$t,st.length),se.top+=-Ei*$t,se.bottom=se.top+$t,se.left+=-ns*xn,se.right=se.left+xn}(K,i,o,f,le,S,I,R,U,z,q,J),!function(se){for(const Se of se)if(Se.positionedGlyphs.length!==0)return!1;return!0}(we)&&K}const op={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},lv={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},uv={40:!0};function ay(u,i,o,f,v,T){if(i.imageName){const S=f[i.imageName];return S?S.displaySize[0]*i.scale*Si/T+v:0}{const S=o[i.fontStack],I=S&&S[u];return I?I.metrics.advance*i.scale+v:0}}function sy(u,i,o,f){const v=Math.pow(u-i,2);return f?u<i?v/2:2*v:v+Math.abs(o)*o}function cv(u,i,o){let f=0;return u===10&&(f-=1e4),o&&(f+=150),u!==40&&u!==65288||(f+=50),i!==41&&i!==65289||(f+=50),f}function lp(u,i,o,f,v,T){let S=null,I=sy(i,o,v,T);for(const R of f){const z=sy(i-R.x,o,v,T)+R.badness;z<=I&&(S=R,I=z)}return{index:u,x:i,priorBreak:S,badness:I}}function oy(u){return u?oy(u.priorBreak).concat(u.index):[]}function bm(u,i,o,f,v,T){if(!u)return[];const S=[],I=function(U,q,Y,J,te,le){let ge=0;for(let Le=0;Le<U.length();Le++){const we=U.getSection(Le);ge+=ay(U.getCharCode(Le),we,J,te,q,le)}return ge/Math.max(1,Math.ceil(ge/Y))}(u,i,o,f,v,T),R=u.text.indexOf("​")>=0;let z=0;for(let U=0;U<u.length();U++){const q=u.getSection(U),Y=u.getCharCode(U);if(op[Y]||(z+=ay(Y,q,f,v,i,T)),U<u.length()-1){const J=!((N=Y)<11904)&&(!!Dn["CJK Compatibility Forms"](N)||!!Dn["CJK Compatibility"](N)||!!Dn["CJK Strokes"](N)||!!Dn["CJK Symbols and Punctuation"](N)||!!Dn["Enclosed CJK Letters and Months"](N)||!!Dn["Halfwidth and Fullwidth Forms"](N)||!!Dn["Ideographic Description Characters"](N)||!!Dn["Vertical Forms"](N)||Vu.test(String.fromCodePoint(N)));(lv[Y]||J||q.imageName||U!==u.length()-2&&uv[u.getCharCode(U+1)])&&S.push(lp(U+1,z,I,S,cv(Y,u.getCharCode(U+1),J&&R),!1))}}var N;return oy(lp(u.length(),z,I,S,0,!0))}function Nr(u){let i=.5,o=.5;switch(u){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:i,verticalAlign:o}}function ly(u,i,o){const f=i.getMaxScale()*Si,{maxImageWidth:v,maxImageHeight:T}=i.getMaxImageSize(u),S=Math.max(f,T*o);return{verticalLineContentWidth:Math.max(f,v*o),horizontalLineContentHeight:S}}function hv(u){switch(u){case"top":return 0;case"center":return .5;default:return 1}}function dv(u,i,o){return!(u===y.an.horizontal||!i&&!tu(o)||i&&(op[o]||(f=o,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(f)))));var f}function Mb(u,i,o,f,v,T){const S=T[u.fontStack],I=function(z,N,U,q){if(z&&z.rect)return z;const Y=N[U.fontStack],J=Y&&Y[q];return J?{rect:null,metrics:J.metrics}:null}(S&&S[i],v,u,i);if(I===null)return null;let R;if(o)R=f.verticalLineContentWidth-u.scale*Si;else{const z=hv(u.verticalAlign);R=(f.horizontalLineContentHeight-u.scale*Si)*z}return{rect:I.rect,metrics:I.metrics,baselineOffset:R}}function Rb(u,i,o,f,v){const T=v[u.imageName];if(!T)return null;const S=T.paddedRect,I=T.displaySize,R={width:I[0],height:I[1],left:1,top:-3,advance:i?I[1]:I[0]};let z;if(i)z=f.verticalLineContentWidth-I[1]*u.scale;else{const N=hv(u.verticalAlign);z=(f.horizontalLineContentHeight-I[1]*u.scale)*N}return{rect:S,metrics:R,baselineOffset:z,imageOffset:(i?I[0]:I[1])*u.scale-Si*o}}function kb(u,i,o,f){if(f===0)return;const v=u[o],T=(u[o].x+v.metrics.advance*v.scale)*f;for(let S=i;S<=o;S++)u[S].x-=T}function xm(u,i,o){const{horizontalAlign:f,verticalAlign:v}=Nr(o),T=i[0]-u.displaySize[0]*f,S=i[1]-u.displaySize[1]*v;return{image:u,top:S,bottom:S+u.displaySize[1],left:T,right:T+u.displaySize[0]}}function Vh(u){var i,o;let f=u.left,v=u.top,T=u.right-f,S=u.bottom-v;const I=(i=u.image.textFitWidth)!==null&&i!==void 0?i:"stretchOrShrink",R=(o=u.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",z=(u.image.content[2]-u.image.content[0])/(u.image.content[3]-u.image.content[1]);if(R==="proportional"){if(I==="stretchOnly"&&T/S<z||I==="proportional"){const N=Math.ceil(S*z);f*=N/T,T=N}}else if(I==="proportional"&&R==="stretchOnly"&&z!==0&&T/S>z){const N=Math.ceil(T/z);v*=N/S,S=N}return{x1:f,y1:v,x2:f+T,y2:v+S}}function wm(u,i,o,f,v,T){const S=u.image;let I;if(S.content){const le=S.content,ge=S.pixelRatio||1;I=[le[0]/ge,le[1]/ge,S.displaySize[0]-le[2]/ge,S.displaySize[1]-le[3]/ge]}const R=i.left*T,z=i.right*T;let N,U,q,Y;o==="width"||o==="both"?(Y=v[0]+R-f[3],U=v[0]+z+f[1]):(Y=v[0]+(R+z-S.displaySize[0])/2,U=Y+S.displaySize[0]);const J=i.top*T,te=i.bottom*T;return o==="height"||o==="both"?(N=v[1]+J-f[0],q=v[1]+te+f[2]):(N=v[1]+(J+te-S.displaySize[1])/2,q=N+S.displaySize[1]),{image:S,top:N,right:U,bottom:q,left:Y,collisionPadding:I}}const Qo=128,uu=32640;function jc(u,i){const{expression:o}=i;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Lr(u+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:v}=o;let T=0;for(;T<f.length&&f[T]<=u;)T++;T=Math.max(0,T-1);let S=T;for(;S<f.length&&f[S]<u+1;)S++;S=Math.min(f.length-1,S);const I=f[T],R=f[S];return o.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:R,interpolationType:v}:{kind:"camera",minZoom:I,maxZoom:R,minSize:o.evaluate(new Lr(I)),maxSize:o.evaluate(new Lr(R)),interpolationType:v}}}function Jo(u,i,o){let f="never";const v=u.get(i);return v?f=v:u.get(o)&&(f="always"),f}const up=Mr.VectorTileFeature.types,Db=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function cp(u,i,o,f,v,T,S,I,R,z,N,U,q){const Y=I?Math.min(uu,Math.round(I[0])):0,J=I?Math.min(uu,Math.round(I[1])):0;u.emplaceBack(i,o,Math.round(32*f),Math.round(32*v),T,S,(Y<<1)+(R?1:0),J,16*z,16*N,256*U,256*q)}function Tm(u,i,o){u.emplaceBack(i.x,i.y,o),u.emplaceBack(i.x,i.y,o),u.emplaceBack(i.x,i.y,o),u.emplaceBack(i.x,i.y,o)}function fv(u){for(const i of u.sections)if(Ad(i.text))return!0;return!1}class Sm{constructor(i){this.layoutVertexArray=new An,this.indexArray=new yr,this.programConfigurations=i,this.segments=new Gn,this.dynamicLayoutVertexArray=new Qn,this.opacityVertexArray=new Qr,this.hasVisibleVertices=!1,this.placedSymbolArray=new fe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,o,f,v){this.isEmpty()||(f&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,av.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,ap.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,Db,!0),this.opacityVertexBuffer.itemSize=1),(f||v)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ft("SymbolBuffers",Sm);class uy{constructor(i,o,f){this.layoutVertexArray=new i,this.layoutAttributes=o,this.indexArray=new f,this.segments=new Gn,this.collisionVertexArray=new ni}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Yg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ft("CollisionBuffers",uy);class $c{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(S=>S.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=jc(this.zoom,o["text-size"]),this.iconSizeData=jc(this.zoom,o["icon-size"]);const f=this.layers[0].layout,v=f.get("symbol-sort-key"),T=f.get("symbol-z-order");this.canOverlap=Jo(f,"text-overlap","text-allow-overlap")!=="never"||Jo(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!v.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(S=>y.an[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=i.sourceID}createArrays(){this.text=new Sm(new qa(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new Sm(new qa(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new _e,this.lineVertexArray=new Ae,this.symbolInstances=new Te,this.textAnchorOffsets=new ve}calculateGlyphDependencies(i,o,f,v,T){for(let S=0;S<i.length;S++)if(o[i.charCodeAt(S)]=!0,(f||v)&&T){const I=Fd[i.charAt(S)];I&&(o[I.charCodeAt(0)]=!0)}}populate(i,o,f){const v=this.layers[0],T=v.layout,S=T.get("text-font"),I=T.get("text-field"),R=T.get("icon-image"),z=(I.value.kind!=="constant"||I.value.value instanceof Hi&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),N=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,U=T.get("symbol-sort-key");if(this.features=[],!z&&!N)return;const q=o.iconDependencies,Y=o.glyphDependencies,J=o.availableImages,te=new Lr(this.zoom,{globalState:this.globalState});for(const{feature:le,id:ge,index:Le,sourceLayerIndex:we}of i){const K=v._featureFilter.needGeometry,se=Nc(le,K);if(!v._featureFilter.filter(te,se,f))continue;let Se,et;if(K||(se.geometry=Zu(le)),z){const st=v.getValueAndResolveTokens("text-field",se,f,J),ht=Hi.factory(st),St=this.hasRTLText=this.hasRTLText||fv(ht);(!St||Go.getRTLTextPluginStatus()==="unavailable"||St&&Go.isParsed())&&(Se=Eo(ht,v,se))}if(N){const st=v.getValueAndResolveTokens("icon-image",se,f,J);et=st instanceof fi?st:fi.fromString(st)}if(!Se&&!et)continue;const yt=this.sortFeaturesByKey?U.evaluate(se,{},f):void 0;if(this.features.push({id:ge,text:Se,icon:et,index:Le,sourceLayerIndex:we,geometry:se.geometry,properties:le.properties,type:up[le.type],sortKey:yt}),et&&(q[et.name]=!0),Se){const st=S.evaluate(se,{},f).join(","),ht=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.an.vertical)>=0;for(const St of Se.sections)if(St.image)q[St.image.name]=!0;else{const bt=$o(Se.toString()),Ct=St.fontStack||st,pt=Y[Ct]=Y[Ct]||{};this.calculateGlyphDependencies(St.text,pt,ht,this.allowVerticalPlacement,bt)}}}T.get("symbol-placement")==="line"&&(this.features=function(le){const ge={},Le={},we=[];let K=0;function se(st){we.push(le[st]),K++}function Se(st,ht,St){const bt=Le[st];return delete Le[st],Le[ht]=bt,we[bt].geometry[0].pop(),we[bt].geometry[0]=we[bt].geometry[0].concat(St[0]),bt}function et(st,ht,St){const bt=ge[ht];return delete ge[ht],ge[st]=bt,we[bt].geometry[0].shift(),we[bt].geometry[0]=St[0].concat(we[bt].geometry[0]),bt}function yt(st,ht,St){const bt=St?ht[0][ht[0].length-1]:ht[0][0];return`${st}:${bt.x}:${bt.y}`}for(let st=0;st<le.length;st++){const ht=le[st],St=ht.geometry,bt=ht.text?ht.text.toString():null;if(!bt){se(st);continue}const Ct=yt(bt,St),pt=yt(bt,St,!0);if(Ct in Le&&pt in ge&&Le[Ct]!==ge[pt]){const Gt=et(Ct,pt,St),tn=Se(Ct,pt,we[Gt].geometry);delete ge[Ct],delete Le[pt],Le[yt(bt,we[tn].geometry,!0)]=tn,we[Gt].geometry=null}else Ct in Le?Se(Ct,pt,St):pt in ge?et(Ct,pt,St):(se(st),ge[Ct]=K-1,Le[pt]=K-1)}return we.filter(st=>st.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((le,ge)=>le.sortKey-ge.sortKey)}update(i,o,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,o,this.layers,f),this.icon.programConfigurations.updatePaintArrays(i,o,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,o){const f=this.lineVertexArray.length;if(i.segment!==void 0){let v=i.dist(o[i.segment+1]),T=i.dist(o[i.segment]);const S={};for(let I=i.segment+1;I<o.length;I++)S[I]={x:o[I].x,y:o[I].y,tileUnitDistanceFromAnchor:v},I<o.length-1&&(v+=o[I+1].dist(o[I]));for(let I=i.segment||0;I>=0;I--)S[I]={x:o[I].x,y:o[I].y,tileUnitDistanceFromAnchor:T},I>0&&(T+=o[I-1].dist(o[I]));for(let I=0;I<o.length;I++){const R=S[I];this.lineVertexArray.emplaceBack(R.x,R.y,R.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(i,o,f,v,T,S,I,R,z,N,U,q){const Y=i.indexArray,J=i.layoutVertexArray,te=i.segments.prepareSegment(4*o.length,J,Y,this.canOverlap?S.sortKey:void 0),le=this.glyphOffsetArray.length,ge=te.vertexLength,Le=this.allowVerticalPlacement&&I===y.an.vertical?Math.PI/2:0,we=S.text&&S.text.sections;for(let K=0;K<o.length;K++){const{tl:se,tr:Se,bl:et,br:yt,tex:st,pixelOffsetTL:ht,pixelOffsetBR:St,minFontScaleX:bt,minFontScaleY:Ct,glyphOffset:pt,isSDF:Gt,sectionIndex:tn}=o[K],Zt=te.vertexLength,$t=pt[1];cp(J,R.x,R.y,se.x,$t+se.y,st.x,st.y,f,Gt,ht.x,ht.y,bt,Ct),cp(J,R.x,R.y,Se.x,$t+Se.y,st.x+st.w,st.y,f,Gt,St.x,ht.y,bt,Ct),cp(J,R.x,R.y,et.x,$t+et.y,st.x,st.y+st.h,f,Gt,ht.x,St.y,bt,Ct),cp(J,R.x,R.y,yt.x,$t+yt.y,st.x+st.w,st.y+st.h,f,Gt,St.x,St.y,bt,Ct),Tm(i.dynamicLayoutVertexArray,R,Le),Y.emplaceBack(Zt,Zt+2,Zt+1),Y.emplaceBack(Zt+1,Zt+2,Zt+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(pt[0]),K!==o.length-1&&tn===o[K+1].sectionIndex||i.programConfigurations.populatePaintArrays(J.length,S,S.index,{},q,we&&we[tn])}i.placedSymbolArray.emplaceBack(R.x,R.y,le,this.glyphOffsetArray.length-le,ge,z,N,R.segment,f?f[0]:0,f?f[1]:0,v[0],v[1],I,0,!1,0,U)}_addCollisionDebugVertex(i,o,f,v,T,S){return o.emplaceBack(0,0),i.emplaceBack(f.x,f.y,v,T,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(i,o,f,v,T,S,I){const R=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),z=R.vertexLength,N=T.layoutVertexArray,U=T.collisionVertexArray,q=I.anchorX,Y=I.anchorY;this._addCollisionDebugVertex(N,U,S,q,Y,new ie(i,o)),this._addCollisionDebugVertex(N,U,S,q,Y,new ie(f,o)),this._addCollisionDebugVertex(N,U,S,q,Y,new ie(f,v)),this._addCollisionDebugVertex(N,U,S,q,Y,new ie(i,v)),R.vertexLength+=4;const J=T.indexArray;J.emplaceBack(z,z+1),J.emplaceBack(z+1,z+2),J.emplaceBack(z+2,z+3),J.emplaceBack(z+3,z),R.primitiveLength+=4}addDebugCollisionBoxes(i,o,f,v){for(let T=i;T<o;T++){const S=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,v?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new uy(gr,Ks.members,_r),this.iconCollisionBox=new uy(gr,Ks.members,_r);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(i,o,f,v,T,S,I,R,z){const N={};for(let U=o;U<f;U++){const q=i.get(U);N.textBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},N.textFeatureIndex=q.featureIndex;break}for(let U=v;U<T;U++){const q=i.get(U);N.verticalTextBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},N.verticalTextFeatureIndex=q.featureIndex;break}for(let U=S;U<I;U++){const q=i.get(U);N.iconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},N.iconFeatureIndex=q.featureIndex;break}for(let U=R;U<z;U++){const q=i.get(U);N.verticalIconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},N.verticalIconFeatureIndex=q.featureIndex;break}return N}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const f=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,o){const f=i.placedSymbolArray.get(o),v=f.vertexStartIndex+4*f.numGlyphs;for(let T=f.vertexStartIndex;T<v;T+=4)i.indexArray.emplaceBack(T,T+2,T+1),i.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(i),f=Math.cos(i),v=[],T=[],S=[];for(let I=0;I<this.symbolInstances.length;++I){S.push(I);const R=this.symbolInstances.get(I);v.push(0|Math.round(o*R.anchorX+f*R.anchorY)),T.push(R.featureIndex)}return S.sort((I,R)=>v[I]-v[R]||T[R]-T[I]),S}addToSortKeyRanges(i,o){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===o?f.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const f=this.symbolInstances.get(o);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((v,T,S)=>{v>=0&&S.indexOf(v)===T&&this.addIndicesForPlacedSymbol(this.text,v)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let cy,hy;Ft("SymbolBucket",$c,{omit:["layers","collisionBoxArray","features","compareText"]}),$c.MAX_GLYPHS=65535,$c.addDynamicAttributes=Tm;var dy={get paint(){return hy=hy||new fa({"icon-opacity":new Jt(ke.paint_symbol["icon-opacity"]),"icon-color":new Jt(ke.paint_symbol["icon-color"]),"icon-halo-color":new Jt(ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new Jt(ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Jt(ke.paint_symbol["icon-halo-blur"]),"icon-translate":new jt(ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new jt(ke.paint_symbol["icon-translate-anchor"]),"text-opacity":new Jt(ke.paint_symbol["text-opacity"]),"text-color":new Jt(ke.paint_symbol["text-color"],{runtimeType:ha,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Jt(ke.paint_symbol["text-halo-color"]),"text-halo-width":new Jt(ke.paint_symbol["text-halo-width"]),"text-halo-blur":new Jt(ke.paint_symbol["text-halo-blur"]),"text-translate":new jt(ke.paint_symbol["text-translate"]),"text-translate-anchor":new jt(ke.paint_symbol["text-translate-anchor"])})},get layout(){return cy=cy||new fa({"symbol-placement":new jt(ke.layout_symbol["symbol-placement"]),"symbol-spacing":new jt(ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new jt(ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Jt(ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new jt(ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new jt(ke.layout_symbol["icon-allow-overlap"]),"icon-overlap":new jt(ke.layout_symbol["icon-overlap"]),"icon-ignore-placement":new jt(ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new jt(ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new jt(ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new Jt(ke.layout_symbol["icon-size"]),"icon-text-fit":new jt(ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new jt(ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new Jt(ke.layout_symbol["icon-image"]),"icon-rotate":new Jt(ke.layout_symbol["icon-rotate"]),"icon-padding":new Jt(ke.layout_symbol["icon-padding"]),"icon-keep-upright":new jt(ke.layout_symbol["icon-keep-upright"]),"icon-offset":new Jt(ke.layout_symbol["icon-offset"]),"icon-anchor":new Jt(ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new jt(ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new jt(ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new jt(ke.layout_symbol["text-rotation-alignment"]),"text-field":new Jt(ke.layout_symbol["text-field"]),"text-font":new Jt(ke.layout_symbol["text-font"]),"text-size":new Jt(ke.layout_symbol["text-size"]),"text-max-width":new Jt(ke.layout_symbol["text-max-width"]),"text-line-height":new jt(ke.layout_symbol["text-line-height"]),"text-letter-spacing":new Jt(ke.layout_symbol["text-letter-spacing"]),"text-justify":new Jt(ke.layout_symbol["text-justify"]),"text-radial-offset":new Jt(ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new jt(ke.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Jt(ke.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Jt(ke.layout_symbol["text-anchor"]),"text-max-angle":new jt(ke.layout_symbol["text-max-angle"]),"text-writing-mode":new jt(ke.layout_symbol["text-writing-mode"]),"text-rotate":new Jt(ke.layout_symbol["text-rotate"]),"text-padding":new jt(ke.layout_symbol["text-padding"]),"text-keep-upright":new jt(ke.layout_symbol["text-keep-upright"]),"text-transform":new Jt(ke.layout_symbol["text-transform"]),"text-offset":new Jt(ke.layout_symbol["text-offset"]),"text-allow-overlap":new jt(ke.layout_symbol["text-allow-overlap"]),"text-overlap":new jt(ke.layout_symbol["text-overlap"]),"text-ignore-placement":new jt(ke.layout_symbol["text-ignore-placement"]),"text-optional":new jt(ke.layout_symbol["text-optional"])})}};class Em{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:ba,this.defaultValue=i}evaluate(i){if(i.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(i.formattedSection))return o.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft("FormatSectionOverride",Em,{omit:["defaultValue"]});class $d extends oa{constructor(i){super(i,dy)}recalculate(i,o){if(super.recalculate(i,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const v=[];for(const T of f)v.indexOf(T)<0&&v.push(T);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,o,f,v){const T=this.layout.get(i).evaluate(o,{},f,v),S=this._unevaluatedLayout._values[i];return S.isDataDriven()||Du(S.value)||!T?T:function(I,R){return R.replace(/{([^{}]+)}/g,(z,N)=>I&&N in I?String(I[N]):"")}(o.properties,T)}createBucket(i){return new $c(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of dy.paint.overridableProperties){if(!$d.hasPaintOverride(this.layout,i))continue;const o=this.paint.get(i),f=new Em(o),v=new ku(f,o.property.specification);let T=null;T=o.value.kind==="constant"||o.value.kind==="source"?new Aa("source",v):new Fo("composite",v,o.value.zoomStops),this.paint._values[i]=new Ia(o.property,T,o.parameters)}}_handleOverridablePaintPropertyUpdate(i,o,f){return!(!this.layout||o.isDataDriven()||f.isDataDriven())&&$d.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,o){const f=i.get("text-field"),v=dy.paint.properties[o];let T=!1;const S=I=>{for(const R of I)if(v.overrides&&v.overrides.hasOverride(R))return void(T=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Hi)S(f.value.value.sections);else if(f.value.kind==="source"){const I=z=>{T||(z instanceof Mn&&an(z.value)===ko?S(z.value.sections):z instanceof A?S(z.sections):z.eachChild(I))},R=f.value;R._styleExpression&&I(R._styleExpression.expression)}return T}}let pv;var Lb={get paint(){return pv=pv||new fa({"background-color":new jt(ke.paint_background["background-color"]),"background-pattern":new si(ke.paint_background["background-pattern"]),"background-opacity":new jt(ke.paint_background["background-opacity"])})}};class hp extends oa{constructor(i){super(i,Lb)}}let mv;var gv={get paint(){return mv=mv||new fa({"raster-opacity":new jt(ke.paint_raster["raster-opacity"]),"raster-hue-rotate":new jt(ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new jt(ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new jt(ke.paint_raster["raster-brightness-max"]),"raster-saturation":new jt(ke.paint_raster["raster-saturation"]),"raster-contrast":new jt(ke.paint_raster["raster-contrast"]),"raster-resampling":new jt(ke.paint_raster["raster-resampling"]),"raster-fade-duration":new jt(ke.paint_raster["raster-fade-duration"])})}};class er extends oa{constructor(i){super(i,gv)}}class fy extends oa{constructor(i){super(i,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Am{constructor(i){this._methodToThrottle=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const py={once:!0},Im=63710088e-1;class cu{constructor(i,o){if(isNaN(i)||isNaN(o))throw new Error(`Invalid LngLat object: (${i}, ${o})`);if(this.lng=+i,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new cu(ks(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const o=Math.PI/180,f=this.lat*o,v=i.lat*o,T=Math.sin(f)*Math.sin(v)+Math.cos(f)*Math.cos(v)*Math.cos((i.lng-this.lng)*o);return Im*Math.acos(Math.min(T,1))}static convert(i){if(i instanceof cu)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new cu(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new cu(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const qd=2*Math.PI*Im;function dp(u){return qd*Math.cos(u*Math.PI/180)}function Fh(u){return(180+u)/360}function my(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function yv(u,i){return u/dp(i)}function gy(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function yy(u,i){return u*dp(gy(i))}class Gd{constructor(i,o,f=0){this.x=+i,this.y=+o,this.z=+f}static fromLngLat(i,o=0){const f=cu.convert(i);return new Gd(Fh(f.lng),my(f.lat),yv(o,f.lat))}toLngLat(){return new cu(360*this.x-180,gy(this.y))}toAltitude(){return yy(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/qd*(i=gy(this.y),1/Math.cos(i*Math.PI/180));var i}}function fp(u,i,o){var f=2*Math.PI*6378137/256/Math.pow(2,o);return[u*f-2*Math.PI*6378137/2,i*f-2*Math.PI*6378137/2]}class Rr{constructor(i,o,f){if(!function(v,T,S){return!(v<0||v>25||S<0||S>=Math.pow(2,v)||T<0||T>=Math.pow(2,v))}(i,o,f))throw new Error(`x=${o}, y=${f}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=o,this.y=f,this.key=Hd(0,i,i,o,f)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,o,f){const v=(S=this.y,I=this.z,R=fp(256*(T=this.x),256*(S=Math.pow(2,I)-S-1),I),z=fp(256*(T+1),256*(S+1),I),R[0]+","+R[1]+","+z[0]+","+z[1]);var T,S,I,R,z;const N=function(U,q,Y){let J,te="";for(let le=U;le>0;le--)J=1<<le-1,te+=(q&J?1:0)+(Y&J?2:0);return te}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,N).replace(/{bbox-epsg-3857}/g,v)}isChildOf(i){const o=this.z-i.z;return o>0&&i.x===this.x>>o&&i.y===this.y>>o}getTilePoint(i){const o=Math.pow(2,this.z);return new ie((i.x*o-this.x)*It,(i.y*o-this.y)*It)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Cm{constructor(i,o){this.wrap=i,this.canonical=o,this.key=Hd(i,o.z,o.z,o.x,o.y)}}class Br{constructor(i,o,f,v,T){if(this.terrainRttPosMatrix32f=null,i<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${f}`);this.overscaledZ=i,this.wrap=o,this.canonical=new Rr(f,+v,+T),this.key=Hd(o,i,f,v,T)}clone(){return new Br(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-i;return i>this.canonical.z?new Br(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Br(i,this.wrap,i,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(i,o){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-i;return i>this.canonical.z?Hd(this.wrap*+o,i,this.canonical.z,this.canonical.x,this.canonical.y):Hd(this.wrap*+o,i,i,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const o=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>o&&i.canonical.y===this.canonical.y>>o}children(i){if(this.overscaledZ>=i)return[new Br(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,f=2*this.canonical.x,v=2*this.canonical.y;return[new Br(o,this.wrap,o,f,v),new Br(o,this.wrap,o,f+1,v),new Br(o,this.wrap,o,f,v+1),new Br(o,this.wrap,o,f+1,v+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Br(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Br(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Cm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new Gd(i.x-this.wrap,i.y))}}function Hd(u,i,o,f,v){(u*=2)<0&&(u=-1*u-1);const T=1<<o;return(T*T*u+T*v+f).toString(36)+o.toString(36)+i.toString(36)}Ft("CanonicalTileID",Rr),Ft("OverscaledTileID",Br,{omit:["terrainRttPosMatrix32f"]});class rc{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(i){return this.minX=Math.min(this.minX,i.x),this.minY=Math.min(this.minY,i.y),this.maxX=Math.max(this.maxX,i.x),this.maxY=Math.max(this.maxY,i.y),this}expandBy(i){return this.minX-=i,this.minY-=i,this.maxX+=i,this.maxY+=i,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(i){return this.expandBy(-i)}map(i){const o=new rc;return o.extend(i(new ie(this.minX,this.minY))),o.extend(i(new ie(this.maxX,this.minY))),o.extend(i(new ie(this.minX,this.maxY))),o.extend(i(new ie(this.maxX,this.maxY))),o}static fromPoints(i){const o=new rc;for(const f of i)o.extend(f);return o}contains(i){return i.x>=this.minX&&i.x<=this.maxX&&i.y>=this.minY&&i.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(i){return!this.empty()&&!i.empty()&&i.minX>=this.minX&&i.maxX<=this.maxX&&i.minY>=this.minY&&i.maxY<=this.maxY}intersects(i){return!this.empty()&&!i.empty()&&i.minX<=this.maxX&&i.maxX>=this.minX&&i.minY<=this.maxY&&i.maxY>=this.minY}}class Pm{constructor(i){this._stringToNumber={},this._numberToString=[];for(let o=0;o<i.length;o++){const f=i[o];this._stringToNumber[f]=o,this._numberToString[o]=f}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class pp{constructor(i,o,f,v,T){this.type="Feature",this._vectorTileFeature=i,i._z=o,i._x=f,i._y=v,this.properties=i.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(i[o]=this[o]);return i}}class _y{constructor(i,o){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Jl(It,16,0),this.grid3D=new Jl(It,16,0),this.featureIndexArray=new tt,this.promoteId=o}insert(i,o,f,v,T,S){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,v,T);const R=S?this.grid3D:this.grid;for(let z=0;z<o.length;z++){const N=o[z],U=[1/0,1/0,-1/0,-1/0];for(let q=0;q<N.length;q++){const Y=N[q];U[0]=Math.min(U[0],Y.x),U[1]=Math.min(U[1],Y.y),U[2]=Math.max(U[2],Y.x),U[3]=Math.max(U[3],Y.y)}U[0]<It&&U[1]<It&&U[2]>=0&&U[3]>=0&&R.insert(I,U[0],U[1],U[2],U[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Mr.VectorTile(new vm(this.rawTileData)).layers,this.sourceLayerCoder=new Pm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,o,f,v){this.loadVTLayers();const T=i.params,S=It/i.tileSize/i.scale,I=pi(T.filter),R=i.queryGeometry,z=i.queryPadding*S,N=rc.fromPoints(R),U=this.grid.query(N.minX-z,N.minY-z,N.maxX+z,N.maxY+z),q=rc.fromPoints(i.cameraQueryGeometry).expandBy(z),Y=this.grid3D.query(q.minX,q.minY,q.maxX,q.maxY,(le,ge,Le,we)=>function(K,se,Se,et,yt){for(const ht of K)if(se<=ht.x&&Se<=ht.y&&et>=ht.x&&yt>=ht.y)return!0;const st=[new ie(se,Se),new ie(se,yt),new ie(et,yt),new ie(et,Se)];if(K.length>2){for(const ht of st)if(kh(K,ht))return!0}for(let ht=0;ht<K.length-1;ht++)if(Pa(K[ht],K[ht+1],st))return!0;return!1}(i.cameraQueryGeometry,le-z,ge-z,Le+z,we+z));for(const le of Y)U.push(le);U.sort(by);const J={};let te;for(let le=0;le<U.length;le++){const ge=U[le];if(ge===te)continue;te=ge;const Le=this.featureIndexArray.get(ge);let we=null;this.loadMatchingFeature(J,Le.bucketIndex,Le.sourceLayerIndex,Le.featureIndex,I,T.layers,T.availableImages,o,f,v,(K,se,Se)=>(we||(we=Zu(K)),se.queryIntersectsFeature({queryGeometry:R,feature:K,featureState:Se,geometry:we,zoom:this.z,transform:i.transform,pixelsToTileUnits:S,pixelPosMatrix:i.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:i.getElevation})))}return J}loadMatchingFeature(i,o,f,v,T,S,I,R,z,N,U){const q=this.bucketLayerIDs[o];if(S&&!q.some(le=>S.has(le)))return;const Y=this.sourceLayerCoder.decode(f),J=this.vtLayers[Y].feature(v);if(T.needGeometry){const le=Nc(J,!0);if(!T.filter(new Lr(this.tileID.overscaledZ),le,this.tileID.canonical))return}else if(!T.filter(new Lr(this.tileID.overscaledZ),J))return;const te=this.getId(J,Y);for(let le=0;le<q.length;le++){const ge=q[le];if(S&&!S.has(ge))continue;const Le=R[ge];if(!Le)continue;let we={};te&&N&&(we=N.getState(Le.sourceLayer||"_geojsonTileLayer",te));const K=gi({},z[ge]);K.paint=vy(K.paint,Le.paint,J,we,I),K.layout=vy(K.layout,Le.layout,J,we,I);const se=!U||U(J,Le,we);if(!se)continue;const Se=new pp(J,this.z,this.x,this.y,te);Se.layer=K;let et=i[ge];et===void 0&&(et=i[ge]=[]),et.push({featureIndex:v,feature:Se,intersectionZ:se})}}lookupSymbolFeatures(i,o,f,v,T,S,I,R){const z={};this.loadVTLayers();const N=pi(T);for(const U of i)this.loadMatchingFeature(z,f,v,U,N,S,I,R,o);return z}hasLayer(i){for(const o of this.bucketLayerIDs)for(const f of o)if(i===f)return!0;return!1}getId(i,o){var f;let v=i.id;return this.promoteId&&(v=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof v=="boolean"&&(v=Number(v)),v===void 0&&(!((f=i.properties)===null||f===void 0)&&f.cluster)&&this.promoteId&&(v=Number(i.properties.cluster_id))),v}}function vy(u,i,o,f,v){return Tr(u,(T,S)=>{const I=i instanceof Fu?i.get(S):null;return I&&I.evaluate?I.evaluate(o,f,v):I})}function by(u,i){return i-u}function Mm(u,i,o,f,v){const T=[];for(let S=0;S<u.length;S++){const I=u[S];let R;for(let z=0;z<I.length-1;z++){let N=I[z],U=I[z+1];N.x<i&&U.x<i||(N.x<i?N=new ie(i,N.y+(i-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x<i&&(U=new ie(i,N.y+(i-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y<o&&U.y<o||(N.y<o?N=new ie(N.x+(o-N.y)/(U.y-N.y)*(U.x-N.x),o)._round():U.y<o&&(U=new ie(N.x+(o-N.y)/(U.y-N.y)*(U.x-N.x),o)._round()),N.x>=f&&U.x>=f||(N.x>=f?N=new ie(f,N.y+(f-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x>=f&&(U=new ie(f,N.y+(f-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y>=v&&U.y>=v||(N.y>=v?N=new ie(N.x+(v-N.y)/(U.y-N.y)*(U.x-N.x),v)._round():U.y>=v&&(U=new ie(N.x+(v-N.y)/(U.y-N.y)*(U.x-N.x),v)._round()),R&&N.equals(R[R.length-1])||(R=[N],T.push(R)),R.push(U)))))}}return T}Ft("FeatureIndex",_y,{omit:["rawTileData","sourceLayerCoder"]});class qc extends ie{constructor(i,o,f,v){super(i,o),this.angle=f,v!==void 0&&(this.segment=v)}clone(){return new qc(this.x,this.y,this.angle,this.segment)}}function xy(u,i,o,f,v){if(i.segment===void 0||o===0)return!0;let T=i,S=i.segment+1,I=0;for(;I>-o/2;){if(S--,S<0)return!1;I-=u[S].dist(T),T=u[S]}I+=u[S].dist(u[S+1]),S++;const R=[];let z=0;for(;I<o/2;){const N=u[S],U=u[S+1];if(!U)return!1;let q=u[S-1].angleTo(N)-N.angleTo(U);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:I,angleDelta:q}),z+=q;I-R[0].distance>f;)z-=R.shift().angleDelta;if(z>v)return!1;S++,I+=N.dist(U)}return!0}function _v(u){let i=0;for(let o=0;o<u.length-1;o++)i+=u[o].dist(u[o+1]);return i}function wy(u,i,o){return u?.6*i*o:0}function vv(u,i){return Math.max(u?u.right-u.left:0,i?i.right-i.left:0)}function zb(u,i,o,f,v,T){const S=wy(o,v,T),I=vv(o,f)*T;let R=0;const z=_v(u)/2;for(let N=0;N<u.length-1;N++){const U=u[N],q=u[N+1],Y=U.dist(q);if(R+Y>z){const J=(z-R)/Y,te=aa.number(U.x,q.x,J),le=aa.number(U.y,q.y,J),ge=new qc(te,le,q.angleTo(U),N);return ge._round(),!S||xy(u,ge,I,S,i)?ge:void 0}R+=Y}}function Gc(u,i,o,f,v,T,S,I,R){const z=wy(f,T,S),N=vv(f,v),U=N*S,q=u[0].x===0||u[0].x===R||u[0].y===0||u[0].y===R;return i-U<i/4&&(i=U+i/4),Ty(u,q?i/2*I%i:(N/2+2*T)*S*I%i,i,z,o,U,q,!1,R)}function Ty(u,i,o,f,v,T,S,I,R){const z=T/2,N=_v(u);let U=0,q=i-o,Y=[];for(let J=0;J<u.length-1;J++){const te=u[J],le=u[J+1],ge=te.dist(le),Le=le.angleTo(te);for(;q+o<U+ge;){q+=o;const we=(q-U)/ge,K=aa.number(te.x,le.x,we),se=aa.number(te.y,le.y,we);if(K>=0&&K<R&&se>=0&&se<R&&q-z>=0&&q+z<=N){const Se=new qc(K,se,Le,J);Se._round(),f&&!xy(u,Se,T,f,v)||Y.push(Se)}}U+=ge}return I||Y.length||S||(Y=Ty(u,U/2,o,f,v,T,S,!0,R)),Y}function Rm(u,i,o,f){const v=[],T=u.image,S=T.pixelRatio,I=T.paddedRect.w-2,R=T.paddedRect.h-2;let z={x1:u.left,y1:u.top,x2:u.right,y2:u.bottom};const N=T.stretchX||[[0,I]],U=T.stretchY||[[0,R]],q=(pt,Gt)=>pt+Gt[1]-Gt[0],Y=N.reduce(q,0),J=U.reduce(q,0),te=I-Y,le=R-J;let ge=0,Le=Y,we=0,K=J,se=0,Se=te,et=0,yt=le;if(T.content&&f){const pt=T.content,Gt=pt[2]-pt[0],tn=pt[3]-pt[1];(T.textFitWidth||T.textFitHeight)&&(z=Vh(u)),ge=km(N,0,pt[0]),we=km(U,0,pt[1]),Le=km(N,pt[0],pt[2]),K=km(U,pt[1],pt[3]),se=pt[0]-ge,et=pt[1]-we,Se=Gt-Le,yt=tn-K}const st=z.x1,ht=z.y1,St=z.x2-st,bt=z.y2-ht,Ct=(pt,Gt,tn,Zt)=>{const $t=Zd(pt.stretch-ge,Le,St,st),xn=Dm(pt.fixed-se,Se,pt.stretch,Y),Fr=Zd(Gt.stretch-we,K,bt,ht),ui=Dm(Gt.fixed-et,yt,Gt.stretch,J),ci=Zd(tn.stretch-ge,Le,St,st),Ao=Dm(tn.fixed-se,Se,tn.stretch,Y),ns=Zd(Zt.stretch-we,K,bt,ht),Ei=Dm(Zt.fixed-et,yt,Zt.stretch,J),ri=new ie($t,Fr),Qi=new ie(ci,Fr),Ui=new ie(ci,ns),ua=new ie($t,ns),rs=new ie(xn/S,ui/S),is=new ie(Ao/S,Ei/S),Ai=i*Math.PI/180;if(Ai){const ji=Math.sin(Ai),Ii=Math.cos(Ai),Ci=[Ii,-ji,ji,Ii];ri._matMult(Ci),Qi._matMult(Ci),ua._matMult(Ci),Ui._matMult(Ci)}const as=pt.stretch+pt.fixed,hi=Gt.stretch+Gt.fixed;return{tl:ri,tr:Qi,bl:ua,br:Ui,tex:{x:T.paddedRect.x+1+as,y:T.paddedRect.y+1+hi,w:tn.stretch+tn.fixed-as,h:Zt.stretch+Zt.fixed-hi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:rs,pixelOffsetBR:is,minFontScaleX:Se/S/St,minFontScaleY:yt/S/bt,isSDF:o}};if(f&&(T.stretchX||T.stretchY)){const pt=bv(N,te,Y),Gt=bv(U,le,J);for(let tn=0;tn<pt.length-1;tn++){const Zt=pt[tn],$t=pt[tn+1];for(let xn=0;xn<Gt.length-1;xn++)v.push(Ct(Zt,Gt[xn],$t,Gt[xn+1]))}}else v.push(Ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:R+1}));return v}function km(u,i,o){let f=0;for(const v of u)f+=Math.max(i,Math.min(o,v[1]))-Math.max(i,Math.min(o,v[0]));return f}function bv(u,i,o){const f=[{fixed:-1,stretch:0}];for(const[v,T]of u){const S=f[f.length-1];f.push({fixed:v-S.stretch,stretch:S.stretch}),f.push({fixed:v-S.stretch,stretch:S.stretch+(T-v)})}return f.push({fixed:i+1,stretch:o}),f}function Zd(u,i,o,f){return u/i*o+f}function Dm(u,i,o,f){return u-i*o/f}Ft("Anchor",qc);class Ws{constructor(i,o,f,v,T,S,I,R,z,N){var U;if(this.boxStartIndex=i.length,z){let q=S.top,Y=S.bottom;const J=S.collisionPadding;J&&(q-=J[1],Y+=J[3]);let te=Y-q;te>0&&(te=Math.max(10,te),this.circleDiameter=te)}else{const q=!((U=S.image)===null||U===void 0)&&U.content&&(S.image.textFitWidth||S.image.textFitHeight)?Vh(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};q.y1=q.y1*I-R[0],q.y2=q.y2*I+R[2],q.x1=q.x1*I-R[3],q.x2=q.x2*I+R[1];const Y=S.collisionPadding;if(Y&&(q.x1-=Y[0]*I,q.y1-=Y[1]*I,q.x2+=Y[2]*I,q.y2+=Y[3]*I),N){const J=new ie(q.x1,q.y1),te=new ie(q.x2,q.y1),le=new ie(q.x1,q.y2),ge=new ie(q.x2,q.y2),Le=N*Math.PI/180;J._rotate(Le),te._rotate(Le),le._rotate(Le),ge._rotate(Le),q.x1=Math.min(J.x,te.x,le.x,ge.x),q.x2=Math.max(J.x,te.x,le.x,ge.x),q.y1=Math.min(J.y,te.y,le.y,ge.y),q.y2=Math.max(J.y,te.y,le.y,ge.y)}i.emplaceBack(o.x,o.y,q.x1,q.y1,q.x2,q.y2,f,v,T)}this.boxEndIndex=i.length}}class Sy{constructor(i=[],o=(f,v)=>f<v?-1:f>v?1:0){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:f}=this,v=o[i];for(;i>0;){const T=i-1>>1,S=o[T];if(f(v,S)>=0)break;o[i]=S,i=T}o[i]=v}_down(i){const{data:o,compare:f}=this,v=this.length>>1,T=o[i];for(;i<v;){let S=1+(i<<1);const I=S+1;if(I<this.length&&f(o[I],o[S])<0&&(S=I),f(o[S],T)>=0)break;o[i]=o[S],i=S}o[i]=T}}function xv(u,i=1,o=!1){const f=rc.fromPoints(u[0]),v=Math.min(f.width(),f.height());let T=v/2;const S=new Sy([],wv),{minX:I,minY:R,maxX:z,maxY:N}=f;if(v===0)return new ie(I,R);for(let Y=I;Y<z;Y+=v)for(let J=R;J<N;J+=v)S.push(new hu(Y+T,J+T,T,u));let U=function(Y){let J=0,te=0,le=0;const ge=Y[0];for(let Le=0,we=ge.length,K=we-1;Le<we;K=Le++){const se=ge[Le],Se=ge[K],et=se.x*Se.y-Se.x*se.y;te+=(se.x+Se.x)*et,le+=(se.y+Se.y)*et,J+=3*et}return new hu(te/J,le/J,0,Y)}(u),q=S.length;for(;S.length;){const Y=S.pop();(Y.d>U.d||!U.d)&&(U=Y,o&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,q)),Y.max-U.d<=i||(T=Y.h/2,S.push(new hu(Y.p.x-T,Y.p.y-T,T,u)),S.push(new hu(Y.p.x+T,Y.p.y-T,T,u)),S.push(new hu(Y.p.x-T,Y.p.y+T,T,u)),S.push(new hu(Y.p.x+T,Y.p.y+T,T,u)),q+=4)}return o&&(console.log(`num probes: ${q}`),console.log(`best distance: ${U.d}`)),U.p}function wv(u,i){return i.max-u.max}function hu(u,i,o,f){this.p=new ie(u,i),this.h=o,this.d=function(v,T){let S=!1,I=1/0;for(let R=0;R<T.length;R++){const z=T[R];for(let N=0,U=z.length,q=U-1;N<U;q=N++){const Y=z[N],J=z[q];Y.y>v.y!=J.y>v.y&&v.x<(J.x-Y.x)*(v.y-Y.y)/(J.y-Y.y)+Y.x&&(S=!S),I=Math.min(I,Rg(v,Y,J))}}return(S?1:-1)*Math.sqrt(I)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Vr;y.aD=void 0,(Vr=y.aD||(y.aD={}))[Vr.center=1]="center",Vr[Vr.left=2]="left",Vr[Vr.right=3]="right",Vr[Vr.top=4]="top",Vr[Vr.bottom=5]="bottom",Vr[Vr["top-left"]=6]="top-left",Vr[Vr["top-right"]=7]="top-right",Vr[Vr["bottom-left"]=8]="bottom-left",Vr[Vr["bottom-right"]=9]="bottom-right";const Lm=Number.POSITIVE_INFINITY;function mp(u,i){return i[1]!==Lm?function(o,f,v){let T=0,S=0;switch(f=Math.abs(f),v=Math.abs(v),o){case"top-right":case"top-left":case"top":S=v-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-v}switch(o){case"top-right":case"bottom-right":case"right":T=-f;break;case"top-left":case"bottom-left":case"left":T=f}return[T,S]}(u,i[0],i[1]):function(o,f){let v=0,T=0;f<0&&(f=0);const S=f/Math.SQRT2;switch(o){case"top-right":case"top-left":T=S-7;break;case"bottom-right":case"bottom-left":T=7-S;break;case"bottom":T=7-f;break;case"top":T=f-7}switch(o){case"top-right":case"bottom-right":v=-S;break;case"top-left":case"bottom-left":v=S;break;case"left":v=f;break;case"right":v=-f}return[v,T]}(u,i[0])}function du(u,i,o){var f;const v=u.layout,T=(f=v.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(i,{},o);if(T){const I=T.values,R=[];for(let z=0;z<I.length;z+=2){const N=R[z]=I[z],U=I[z+1].map(q=>q*Si);N.startsWith("top")?U[1]-=7:N.startsWith("bottom")&&(U[1]+=7),R[z+1]=U}return new En(R)}const S=v.get("text-variable-anchor");if(S){let I;I=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[v.get("text-radial-offset").evaluate(i,{},o)*Si,Lm]:v.get("text-offset").evaluate(i,{},o).map(z=>z*Si);const R=[];for(const z of S)R.push(z,mp(z,I));return new En(R)}return null}function Ey(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Ob(u,i,o,f,v,T,S,I,R,z,N,U){let q=T.textMaxSize.evaluate(i,{});q===void 0&&(q=S);const Y=u.layers[0].layout,J=Y.get("icon-offset").evaluate(i,{},N),te=Ay(o.horizontal),le=S/24,ge=u.tilePixelRatio*le,Le=u.tilePixelRatio*q/24,we=u.tilePixelRatio*I,K=u.tilePixelRatio*Y.get("symbol-spacing"),se=Y.get("text-padding")*u.tilePixelRatio,Se=function(tn,Zt,$t,xn=1){const Fr=tn.get("icon-padding").evaluate(Zt,{},$t),ui=Fr&&Fr.values;return[ui[0]*xn,ui[1]*xn,ui[2]*xn,ui[3]*xn]}(Y,i,N,u.tilePixelRatio),et=Y.get("text-max-angle")/180*Math.PI,yt=Y.get("text-rotation-alignment")!=="viewport"&&Y.get("symbol-placement")!=="point",st=Y.get("icon-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",ht=Y.get("symbol-placement"),St=K/2,bt=Y.get("icon-text-fit");let Ct;f&&bt!=="none"&&(u.allowVerticalPlacement&&o.vertical&&(Ct=wm(f,o.vertical,bt,Y.get("icon-text-fit-padding"),J,le)),te&&(f=wm(f,te,bt,Y.get("icon-text-fit-padding"),J,le)));const pt=N?U.line.getGranularityForZoomLevel(N.z):1,Gt=(tn,Zt)=>{Zt.x<0||Zt.x>=It||Zt.y<0||Zt.y>=It||function($t,xn,Fr,ui,ci,Ao,ns,Ei,ri,Qi,Ui,ua,rs,is,Ai,as,hi,ji,Ii,Ci,Hr,Xs,s,h,g){const x=$t.addToLineVertexArray(xn,Fr);let C,L,Q,ae,Pe=0,rt=0,_t=0,Tt=0,ot=-1,ut=-1;const cn={};let yn=ma("");if($t.allowVerticalPlacement&&ui.vertical){const Es=Ei.layout.get("text-rotate").evaluate(Hr,{},h)+90;Q=new Ws(ri,xn,Qi,Ui,ua,ui.vertical,rs,is,Ai,Es),ns&&(ae=new Ws(ri,xn,Qi,Ui,ua,ns,hi,ji,Ai,Es))}if(ci){const Es=Ei.layout.get("icon-rotate").evaluate(Hr,{}),El=Ei.layout.get("icon-text-fit")!=="none",yp=Rm(ci,Es,s,El),ac=ns?Rm(ns,Es,s,El):void 0;L=new Ws(ri,xn,Qi,Ui,ua,ci,hi,ji,!1,Es),Pe=4*yp.length;const _p=$t.iconSizeData;let Wc=null;_p.kind==="source"?(Wc=[Qo*Ei.layout.get("icon-size").evaluate(Hr,{})],Wc[0]>uu&&Cr(`${$t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):_p.kind==="composite"&&(Wc=[Qo*Xs.compositeIconSizes[0].evaluate(Hr,{},h),Qo*Xs.compositeIconSizes[1].evaluate(Hr,{},h)],(Wc[0]>uu||Wc[1]>uu)&&Cr(`${$t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),$t.addSymbols($t.icon,yp,Wc,Ci,Ii,Hr,y.an.none,xn,x.lineStartIndex,x.lineLength,-1,h),ot=$t.icon.placedSymbolArray.length-1,ac&&(rt=4*ac.length,$t.addSymbols($t.icon,ac,Wc,Ci,Ii,Hr,y.an.vertical,xn,x.lineStartIndex,x.lineLength,-1,h),ut=$t.icon.placedSymbolArray.length-1)}const Ur=Object.keys(ui.horizontal);for(const Es of Ur){const El=ui.horizontal[Es];if(!C){yn=ma(El.text);const ac=Ei.layout.get("text-rotate").evaluate(Hr,{},h);C=new Ws(ri,xn,Qi,Ui,ua,El,rs,is,Ai,ac)}const yp=El.positionedLines.length===1;if(_t+=Uh($t,xn,El,Ao,Ei,Ai,Hr,as,x,ui.vertical?y.an.horizontal:y.an.horizontalOnly,yp?Ur:[Es],cn,ot,Xs,h),yp)break}ui.vertical&&(Tt+=Uh($t,xn,ui.vertical,Ao,Ei,Ai,Hr,as,x,y.an.vertical,["vertical"],cn,ut,Xs,h));const Ze=C?C.boxStartIndex:$t.collisionBoxArray.length,Ue=C?C.boxEndIndex:$t.collisionBoxArray.length,nt=Q?Q.boxStartIndex:$t.collisionBoxArray.length,wt=Q?Q.boxEndIndex:$t.collisionBoxArray.length,en=L?L.boxStartIndex:$t.collisionBoxArray.length,Wn=L?L.boxEndIndex:$t.collisionBoxArray.length,un=ae?ae.boxStartIndex:$t.collisionBoxArray.length,bn=ae?ae.boxEndIndex:$t.collisionBoxArray.length;let Zr=-1;const ir=(Es,El)=>Es&&Es.circleDiameter?Math.max(Es.circleDiameter,El):El;Zr=ir(C,Zr),Zr=ir(Q,Zr),Zr=ir(L,Zr),Zr=ir(ae,Zr);const ic=Zr>-1?1:0;ic&&(Zr*=g/Si),$t.glyphOffsetArray.length>=$c.MAX_GLYPHS&&Cr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Hr.sortKey!==void 0&&$t.addToSortKeyRanges($t.symbolInstances.length,Hr.sortKey);const Bb=du(Ei,Hr,h),[gM,yM]=function(Es,El){const yp=Es.length,ac=El==null?void 0:El.values;if((ac==null?void 0:ac.length)>0)for(let _p=0;_p<ac.length;_p+=2){const Wc=ac[_p+1];Es.emplaceBack(y.aD[ac[_p]],Wc[0],Wc[1])}return[yp,Es.length]}($t.textAnchorOffsets,Bb);$t.symbolInstances.emplaceBack(xn.x,xn.y,cn.right>=0?cn.right:-1,cn.center>=0?cn.center:-1,cn.left>=0?cn.left:-1,cn.vertical||-1,ot,ut,yn,Ze,Ue,nt,wt,en,Wn,un,bn,Qi,_t,Tt,Pe,rt,ic,0,rs,Zr,gM,yM)}(u,Zt,tn,o,f,v,Ct,u.layers[0],u.collisionBoxArray,i.index,i.sourceLayerIndex,u.index,ge,[se,se,se,se],yt,R,we,Se,st,J,i,T,z,N,S)};if(ht==="line")for(const tn of Mm(i.geometry,0,0,It,It)){const Zt=Vc(tn,pt),$t=Gc(Zt,K,et,o.vertical||te,f,24,Le,u.overscaling,It);for(const xn of $t)te&&Nb(u,te.text,St,xn)||Gt(Zt,xn)}else if(ht==="line-center"){for(const tn of i.geometry)if(tn.length>1){const Zt=Vc(tn,pt),$t=zb(Zt,et,o.vertical||te,f,24,Le);$t&&Gt(Zt,$t)}}else if(i.type==="Polygon")for(const tn of dd(i.geometry,0)){const Zt=xv(tn,16);Gt(Vc(tn[0],pt,!0),new qc(Zt.x,Zt.y,0))}else if(i.type==="LineString")for(const tn of i.geometry){const Zt=Vc(tn,pt);Gt(Zt,new qc(Zt[0].x,Zt[0].y,0))}else if(i.type==="Point")for(const tn of i.geometry)for(const Zt of tn)Gt([Zt],new qc(Zt.x,Zt.y,0))}function Uh(u,i,o,f,v,T,S,I,R,z,N,U,q,Y,J){const te=function(Le,we,K,se,Se,et,yt,st){const ht=se.layout.get("text-rotate").evaluate(et,{})*Math.PI/180,St=[];for(const bt of we.positionedLines)for(const Ct of bt.positionedGlyphs){if(!Ct.rect)continue;const pt=Ct.rect||{};let Gt=4,tn=!0,Zt=1,$t=0;const xn=(Se||st)&&Ct.vertical,Fr=Ct.metrics.advance*Ct.scale/2;if(st&&we.verticalizable&&($t=bt.lineOffset/2-(Ct.imageName?-(Si-Ct.metrics.width*Ct.scale)/2:(Ct.scale-1)*Si)),Ct.imageName){const ji=yt[Ct.imageName];tn=ji.sdf,Zt=ji.pixelRatio,Gt=1/Zt}const ui=Se?[Ct.x+Fr,Ct.y]:[0,0];let ci=Se?[0,0]:[Ct.x+Fr+K[0],Ct.y+K[1]-$t],Ao=[0,0];xn&&(Ao=ci,ci=[0,0]);const ns=Ct.metrics.isDoubleResolution?2:1,Ei=(Ct.metrics.left-Gt)*Ct.scale-Fr+ci[0],ri=(-Ct.metrics.top-Gt)*Ct.scale+ci[1],Qi=Ei+pt.w/ns*Ct.scale/Zt,Ui=ri+pt.h/ns*Ct.scale/Zt,ua=new ie(Ei,ri),rs=new ie(Qi,ri),is=new ie(Ei,Ui),Ai=new ie(Qi,Ui);if(xn){const ji=new ie(-Fr,Fr- -17),Ii=-Math.PI/2,Ci=12-Fr,Hr=new ie(22-Ci,-(Ct.imageName?Ci:0)),Xs=new ie(...Ao);ua._rotateAround(Ii,ji)._add(Hr)._add(Xs),rs._rotateAround(Ii,ji)._add(Hr)._add(Xs),is._rotateAround(Ii,ji)._add(Hr)._add(Xs),Ai._rotateAround(Ii,ji)._add(Hr)._add(Xs)}if(ht){const ji=Math.sin(ht),Ii=Math.cos(ht),Ci=[Ii,-ji,ji,Ii];ua._matMult(Ci),rs._matMult(Ci),is._matMult(Ci),Ai._matMult(Ci)}const as=new ie(0,0),hi=new ie(0,0);St.push({tl:ua,tr:rs,bl:is,br:Ai,tex:pt,writingMode:we.writingMode,glyphOffset:ui,sectionIndex:Ct.sectionIndex,isSDF:tn,pixelOffsetTL:as,pixelOffsetBR:hi,minFontScaleX:0,minFontScaleY:0})}return St}(0,o,I,v,T,S,f,u.allowVerticalPlacement),le=u.textSizeData;let ge=null;le.kind==="source"?(ge=[Qo*v.layout.get("text-size").evaluate(S,{})],ge[0]>uu&&Cr(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):le.kind==="composite"&&(ge=[Qo*Y.compositeTextSizes[0].evaluate(S,{},J),Qo*Y.compositeTextSizes[1].evaluate(S,{},J)],(ge[0]>uu||ge[1]>uu)&&Cr(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),u.addSymbols(u.text,te,ge,I,T,S,z,i,R.lineStartIndex,R.lineLength,q,J);for(const Le of N)U[Le]=u.text.placedSymbolArray.length-1;return 4*te.length}function Ay(u){for(const i in u)return u[i];return null}function Nb(u,i,o,f){const v=u.compareText;if(i in v){const T=v[i];for(let S=T.length-1;S>=0;S--)if(f.dist(T[S])<o)return!0}else v[i]=[];return v[i].push(f),!1}const Tv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Iy{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,f]=new Uint8Array(i,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=f>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const T=Tv[15&f];if(!T)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(i,2,1),[I]=new Uint32Array(i,4,1);return new Iy(I,S,T,i)}constructor(i,o=64,f=Float64Array,v){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=f,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const T=Tv.indexOf(this.ArrayType),S=2*i*this.ArrayType.BYTES_PER_ELEMENT,I=i*this.IndexArrayType.BYTES_PER_ELEMENT,R=(8-I%8)%8;if(T<0)throw new Error(`Unexpected typed array class: ${f}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+I+R,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+S+I+R),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+I+R,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+T]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=i)}add(i,o){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=i,this.coords[this._pos++]=o,f}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return Cy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,o,f,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:S,nodeSize:I}=this,R=[0,T.length-1,0],z=[];for(;R.length;){const N=R.pop()||0,U=R.pop()||0,q=R.pop()||0;if(U-q<=I){for(let le=q;le<=U;le++){const ge=S[2*le],Le=S[2*le+1];ge>=i&&ge<=f&&Le>=o&&Le<=v&&z.push(T[le])}continue}const Y=q+U>>1,J=S[2*Y],te=S[2*Y+1];J>=i&&J<=f&&te>=o&&te<=v&&z.push(T[Y]),(N===0?i<=J:o<=te)&&(R.push(q),R.push(Y-1),R.push(1-N)),(N===0?f>=J:v>=te)&&(R.push(Y+1),R.push(U),R.push(1-N))}return z}within(i,o,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:T,nodeSize:S}=this,I=[0,v.length-1,0],R=[],z=f*f;for(;I.length;){const N=I.pop()||0,U=I.pop()||0,q=I.pop()||0;if(U-q<=S){for(let le=q;le<=U;le++)My(T[2*le],T[2*le+1],i,o)<=z&&R.push(v[le]);continue}const Y=q+U>>1,J=T[2*Y],te=T[2*Y+1];My(J,te,i,o)<=z&&R.push(v[Y]),(N===0?i-f<=J:o-f<=te)&&(I.push(q),I.push(Y-1),I.push(1-N)),(N===0?i+f>=J:o+f>=te)&&(I.push(Y+1),I.push(U),I.push(1-N))}return R}}function Cy(u,i,o,f,v,T){if(v-f<=o)return;const S=f+v>>1;Sv(u,i,S,f,v,T),Cy(u,i,o,f,S-1,1-T),Cy(u,i,o,S+1,v,1-T)}function Sv(u,i,o,f,v,T){for(;v>f;){if(v-f>600){const z=v-f+1,N=o-f+1,U=Math.log(z),q=.5*Math.exp(2*U/3),Y=.5*Math.sqrt(U*q*(z-q)/z)*(N-z/2<0?-1:1);Sv(u,i,o,Math.max(f,Math.floor(o-N*q/z+Y)),Math.min(v,Math.floor(o+(z-N)*q/z+Y)),T)}const S=i[2*o+T];let I=f,R=v;for(gp(u,i,f,o),i[2*v+T]>S&&gp(u,i,f,v);I<R;){for(gp(u,i,I,R),I++,R--;i[2*I+T]<S;)I++;for(;i[2*R+T]>S;)R--}i[2*f+T]===S?gp(u,i,f,R):(R++,gp(u,i,R,v)),R<=o&&(f=R+1),o<=R&&(v=R-1)}}function gp(u,i,o,f){Py(u,o,f),Py(i,2*o,2*f),Py(i,2*o+1,2*f+1)}function Py(u,i,o){const f=u[i];u[i]=u[o],u[o]=f}function My(u,i,o,f){const v=u-o,T=i-f;return v*v+T*T}var Hc;y.cw=void 0,(Hc=y.cw||(y.cw={})).create="create",Hc.load="load",Hc.fullLoad="fullLoad";let Zc=null,Kd=[];const Ry=1e3/60,Kc="loadTime",jh="fullLoadTime",Ev={mark(u){performance.mark(u)},frame(u){const i=u;Zc!=null&&Kd.push(i-Zc),Zc=i},clearMetrics(){Zc=null,Kd=[],performance.clearMeasures(Kc),performance.clearMeasures(jh);for(const u in y.cw)performance.clearMarks(y.cw[u])},getPerformanceMetrics(){performance.measure(Kc,y.cw.create,y.cw.load),performance.measure(jh,y.cw.create,y.cw.fullLoad);const u=performance.getEntriesByName(Kc)[0].duration,i=performance.getEntriesByName(jh)[0].duration,o=Kd.length,f=1/(Kd.reduce((T,S)=>T+S,0)/o/1e3),v=Kd.filter(T=>T>Ry).reduce((T,S)=>T+(S-Ry)/Ry,0);return{loadTime:u,fullLoadTime:i,fps:f,percentDroppedFrames:v/(o+v)*100,totalFrames:o}}};y.$=It,y.A=We,y.B=function([u,i,o]){return i+=90,i*=Math.PI/180,o*=Math.PI/180,{x:u*Math.cos(i)*Math.sin(o),y:u*Math.sin(i)*Math.sin(o),z:u*Math.cos(o)}},y.C=aa,y.D=jt,y.E=ft,y.F=Lr,y.G=Eh,y.H=function(u){if(Ds==null){const i=u.navigator?u.navigator.userAgent:null;Ds=!!u.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return Ds},y.I=ry,y.J=class{constructor(u,i){this.target=u,this.mapId=i,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Am(()=>this.process()),this.subscription=fr(this.target,"message",o=>this.receive(o),!1),this.globalScope=na(self)?u:window}registerMessageHandler(u,i){this.messageHandlers[u]=i}sendAsync(u,i){return new Promise((o,f)=>{const v=Math.round(1e18*Math.random()).toString(36).substring(0,10),T=i?fr(i.signal,"abort",()=>{T==null||T.unsubscribe(),delete this.resolveRejects[v];const R={id:v,type:"<cancel>",origin:location.origin,targetMapId:u.targetMapId,sourceMapId:this.mapId};this.target.postMessage(R)},py):null;this.resolveRejects[v]={resolve:R=>{T==null||T.unsubscribe(),o(R)},reject:R=>{T==null||T.unsubscribe(),f(R)}};const S=[],I=Object.assign(Object.assign({},u),{id:v,sourceMapId:this.mapId,origin:location.origin,data:kc(u.data,S)});this.target.postMessage(I,{transfer:S})})}receive(u){const i=u.data,o=i.id;if(!(i.origin!=="file://"&&location.origin!=="file://"&&i.origin!=="resource://android"&&location.origin!=="resource://android"&&i.origin!==location.origin||i.targetMapId&&this.mapId!==i.targetMapId)){if(i.type==="<cancel>"){delete this.tasks[o];const f=this.abortControllers[o];return delete this.abortControllers[o],void(f&&f.abort())}if(na(self)||i.mustQueue)return this.tasks[o]=i,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,i)}}process(){if(this.taskQueue.length===0)return;const u=this.taskQueue.shift(),i=this.tasks[u];delete this.tasks[u],this.taskQueue.length>0&&this.invoker.trigger(),i&&this.processTask(u,i)}processTask(u,i){return c(this,void 0,void 0,function*(){if(i.type==="<response>"){const v=this.resolveRejects[u];return delete this.resolveRejects[u],v?void(i.error?v.reject(ws(i.error)):v.resolve(ws(i.data))):void 0}if(!this.messageHandlers[i.type])return void this.completeTask(u,new Error(`Could not find a registered handler for ${i.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=ws(i.data),f=new AbortController;this.abortControllers[u]=f;try{const v=yield this.messageHandlers[i.type](i.sourceMapId,o,f);this.completeTask(u,null,v)}catch(v){this.completeTask(u,v)}})}completeTask(u,i,o){const f=[];delete this.abortControllers[u];const v={id:u,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:i?kc(i):null,data:kc(o,f)};this.target.postMessage(v,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},y.K=ue,y.L=function(){var u=new We(16);return We!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},y.M=function(u,i,o){var f,v,T,S,I,R,z,N,U,q,Y,J,te=o[0],le=o[1],ge=o[2];return i===u?(u[12]=i[0]*te+i[4]*le+i[8]*ge+i[12],u[13]=i[1]*te+i[5]*le+i[9]*ge+i[13],u[14]=i[2]*te+i[6]*le+i[10]*ge+i[14],u[15]=i[3]*te+i[7]*le+i[11]*ge+i[15]):(v=i[1],T=i[2],S=i[3],I=i[4],R=i[5],z=i[6],N=i[7],U=i[8],q=i[9],Y=i[10],J=i[11],u[0]=f=i[0],u[1]=v,u[2]=T,u[3]=S,u[4]=I,u[5]=R,u[6]=z,u[7]=N,u[8]=U,u[9]=q,u[10]=Y,u[11]=J,u[12]=f*te+I*le+U*ge+i[12],u[13]=v*te+R*le+q*ge+i[13],u[14]=T*te+z*le+Y*ge+i[14],u[15]=S*te+N*le+J*ge+i[15]),u},y.N=function(u,i,o){var f=o[0],v=o[1],T=o[2];return u[0]=i[0]*f,u[1]=i[1]*f,u[2]=i[2]*f,u[3]=i[3]*f,u[4]=i[4]*v,u[5]=i[5]*v,u[6]=i[6]*v,u[7]=i[7]*v,u[8]=i[8]*T,u[9]=i[9]*T,u[10]=i[10]*T,u[11]=i[11]*T,u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15],u},y.O=function(u,i,o){var f=i[0],v=i[1],T=i[2],S=i[3],I=i[4],R=i[5],z=i[6],N=i[7],U=i[8],q=i[9],Y=i[10],J=i[11],te=i[12],le=i[13],ge=i[14],Le=i[15],we=o[0],K=o[1],se=o[2],Se=o[3];return u[0]=we*f+K*I+se*U+Se*te,u[1]=we*v+K*R+se*q+Se*le,u[2]=we*T+K*z+se*Y+Se*ge,u[3]=we*S+K*N+se*J+Se*Le,u[4]=(we=o[4])*f+(K=o[5])*I+(se=o[6])*U+(Se=o[7])*te,u[5]=we*v+K*R+se*q+Se*le,u[6]=we*T+K*z+se*Y+Se*ge,u[7]=we*S+K*N+se*J+Se*Le,u[8]=(we=o[8])*f+(K=o[9])*I+(se=o[10])*U+(Se=o[11])*te,u[9]=we*v+K*R+se*q+Se*le,u[10]=we*T+K*z+se*Y+Se*ge,u[11]=we*S+K*N+se*J+Se*Le,u[12]=(we=o[12])*f+(K=o[13])*I+(se=o[14])*U+(Se=o[15])*te,u[13]=we*v+K*R+se*q+Se*le,u[14]=we*T+K*z+se*Y+Se*ge,u[15]=we*S+K*N+se*J+Se*Le,u},y.P=ie,y.Q=function(u,i){const o={};for(let f=0;f<i.length;f++){const v=i[f];v in u&&(o[v]=u[v])}return o},y.R=Ga,y.S=cu,y.T=hm,y.U=my,y.V=Fh,y.W=mt,y.X=qe,y.Y=Ls,y.Z=Br,y._=c,y.a=ne,y.a$=function(u,i,o){return u[0]=i[0]*o,u[1]=i[1]*o,u[2]=i[2]*o,u[3]=i[3]*o,u},y.a0=Gd,y.a1=rc,y.a2=25,y.a3=Rr,y.a4=u=>{const i=window.document.createElement("video");return i.muted=!0,new Promise(o=>{i.onloadstart=()=>{o(i)};for(const f of u){const v=window.document.createElement("source");Je(f)||(i.crossOrigin="Anonymous"),v.src=f,i.appendChild(v)}})},y.a5=Pt,y.a6=function(){return io++},y.a7=de,y.a8=$c,y.a9=pi,y.aA=Si,y.aB=Rt,y.aC=function(u,i,o,f,v=!1){if(!o[0]&&!o[1])return[0,0];const T=v?f==="map"?-u.bearingInRadians:0:f==="viewport"?u.bearingInRadians:0;if(T){const S=Math.sin(T),I=Math.cos(T);o=[o[0]*I-o[1]*S,o[0]*S+o[1]*I]}return[v?o[0]:Rt(i,o[0],u.zoom),v?o[1]:Rt(i,o[1],u.zoom)]},y.aE=Jo,y.aF=Ey,y.aG=Nr,y.aH=Iy,y.aI=Yr,y.aJ=Jf,y.aK=Xe,y.aL=Gn,y.aM=yr,y.aN=ks,y.aO=di,y.aP=yy,y.aQ=Ee,y.aR=Ve,y.aS=function(u){var i=new We(3);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i},y.aT=function(u,i,o){return u[0]=i[0]-o[0],u[1]=i[1]-o[1],u[2]=i[2]-o[2],u},y.aU=function(u,i){var o=i[0],f=i[1],v=i[2],T=o*o+f*f+v*v;return T>0&&(T=1/Math.sqrt(T)),u[0]=i[0]*T,u[1]=i[1]*T,u[2]=i[2]*T,u},y.aV=Yn,y.aW=function(u,i){return u[0]*i[0]+u[1]*i[1]+u[2]*i[2]},y.aX=function(u,i,o){return u[0]=i[0]*o[0],u[1]=i[1]*o[1],u[2]=i[2]*o[2],u[3]=i[3]*o[3],u},y.aY=be,y.aZ=function(u,i,o){const f=i[0]*o[0]+i[1]*o[1]+i[2]*o[2];return f===0?null:(-(u[0]*o[0]+u[1]*o[1]+u[2]*o[2])-o[3])/f},y.a_=gt,y.aa=Nc,y.ab=pp,y.ac=function(u){const i={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,f,v,T)=>{const S=v||T;return i[f]=!S||S.toLowerCase(),""}),i["max-age"]){const o=parseInt(i["max-age"],10);isNaN(o)?delete i["max-age"]:i["max-age"]=o}return i},y.ad=zn,y.ae=function(u){return Math.pow(2,u)},y.af=oe,y.ag=Ir,y.ah=85.051129,y.ai=yv,y.aj=function(u){return Math.log(u)/Math.LN2},y.ak=function(u){var i=u[0],o=u[1];return i*i+o*o},y.al=function(u,i){const o=[];for(const f in u)f in i||o.push(f);return o},y.am=function(u,i){let o=0,f=0;if(u.kind==="constant")f=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:v,minZoom:T,maxZoom:S}=u,I=v?Ir(_i.interpolationFactor(v,i,T,S),0,1):0;u.kind==="camera"?f=aa.number(u.minSize,u.maxSize,I):o=I}return{uSizeT:o,uSize:f}},y.ao=function(u,{uSize:i,uSizeT:o},{lowerSize:f,upperSize:v}){return u.kind==="source"?f/Qo:u.kind==="composite"?aa.number(f/Qo,v/Qo,o):i},y.ap=function(u,i){var o=i[0],f=i[1],v=i[2],T=i[3],S=i[4],I=i[5],R=i[6],z=i[7],N=i[8],U=i[9],q=i[10],Y=i[11],J=i[12],te=i[13],le=i[14],ge=i[15],Le=o*I-f*S,we=o*R-v*S,K=o*z-T*S,se=f*R-v*I,Se=f*z-T*I,et=v*z-T*R,yt=N*te-U*J,st=N*le-q*J,ht=N*ge-Y*J,St=U*le-q*te,bt=U*ge-Y*te,Ct=q*ge-Y*le,pt=Le*Ct-we*bt+K*St+se*ht-Se*st+et*yt;return pt?(u[0]=(I*Ct-R*bt+z*St)*(pt=1/pt),u[1]=(v*bt-f*Ct-T*St)*pt,u[2]=(te*et-le*Se+ge*se)*pt,u[3]=(q*Se-U*et-Y*se)*pt,u[4]=(R*ht-S*Ct-z*st)*pt,u[5]=(o*Ct-v*ht+T*st)*pt,u[6]=(le*K-J*et-ge*we)*pt,u[7]=(N*et-q*K+Y*we)*pt,u[8]=(S*bt-I*ht+z*yt)*pt,u[9]=(f*ht-o*bt-T*yt)*pt,u[10]=(J*Se-te*K+ge*Le)*pt,u[11]=(U*K-N*Se-Y*Le)*pt,u[12]=(I*st-S*St-R*yt)*pt,u[13]=(o*St-f*st+v*yt)*pt,u[14]=(te*we-J*se-le*Le)*pt,u[15]=(N*se-U*we+q*Le)*pt,u):null},y.aq=ze,y.ar=function(u){return Math.hypot(u[0],u[1])},y.as=function(u){return u[0]=0,u[1]=0,u},y.at=function(u,i,o){return u[0]=i[0]*o,u[1]=i[1]*o,u},y.au=Tm,y.av=Bt,y.aw=function(u,i,o,f){const v=i.y-u.y,T=i.x-u.x,S=f.y-o.y,I=f.x-o.x,R=S*T-I*v;if(R===0)return null;const z=(I*(u.y-o.y)-S*(u.x-o.x))/R;return new ie(u.x+z*T,u.y+z*v)},y.ax=Mm,y.ay=Cg,y.az=function(u){let i=1/0,o=1/0,f=-1/0,v=-1/0;for(const T of u)i=Math.min(i,T.x),o=Math.min(o,T.y),f=Math.max(f,T.x),v=Math.max(v,T.y);return[i,o,f,v]},y.b=Wa,y.b$=sv,y.b0=function(u,i){return u[0]*i[0]+u[1]*i[1]+u[2]*i[2]+u[3]},y.b1=Cm,y.b2=Hd,y.b3=function(u,i,o,f,v){var T,S=1/Math.tan(i/2);return u[0]=S/o,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=S,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,v!=null&&v!==1/0?(u[10]=(v+f)*(T=1/(f-v)),u[14]=2*v*f*T):(u[10]=-1,u[14]=-2*f),u},y.b4=function(u){var i=new We(16);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i[3]=u[3],i[4]=u[4],i[5]=u[5],i[6]=u[6],i[7]=u[7],i[8]=u[8],i[9]=u[9],i[10]=u[10],i[11]=u[11],i[12]=u[12],i[13]=u[13],i[14]=u[14],i[15]=u[15],i},y.b5=function(u,i,o){var f=Math.sin(o),v=Math.cos(o),T=i[0],S=i[1],I=i[2],R=i[3],z=i[4],N=i[5],U=i[6],q=i[7];return i!==u&&(u[8]=i[8],u[9]=i[9],u[10]=i[10],u[11]=i[11],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[0]=T*v+z*f,u[1]=S*v+N*f,u[2]=I*v+U*f,u[3]=R*v+q*f,u[4]=z*v-T*f,u[5]=N*v-S*f,u[6]=U*v-I*f,u[7]=q*v-R*f,u},y.b6=function(u,i,o){var f=Math.sin(o),v=Math.cos(o),T=i[4],S=i[5],I=i[6],R=i[7],z=i[8],N=i[9],U=i[10],q=i[11];return i!==u&&(u[0]=i[0],u[1]=i[1],u[2]=i[2],u[3]=i[3],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[4]=T*v+z*f,u[5]=S*v+N*f,u[6]=I*v+U*f,u[7]=R*v+q*f,u[8]=z*v-T*f,u[9]=N*v-S*f,u[10]=U*v-I*f,u[11]=q*v-R*f,u},y.b7=function(){const u=new Float32Array(16);return oe(u),u},y.b8=function(){const u=new Float64Array(16);return oe(u),u},y.b9=function(){return new Float64Array(16)},y.bA=function(u){return u[0]=0,u[1]=0,u[2]=0,u},y.bB=function(u,i,o,f){const v=Math.sqrt(u*u+i*i),T=Math.sqrt(o*o+f*f);u/=v,i/=v,o/=T,f/=T;const S=Math.acos(u*o+i*f);return-i*o+u*f>0?S:-S},y.bC=function(u,i){const o=Yt(u,2*Math.PI),f=Yt(i,2*Math.PI);return Math.min(Math.abs(o-f),Math.abs(o-f+2*Math.PI),Math.abs(o-f-2*Math.PI))},y.bD=function(){const u={},i=ke.$version;for(const o in ke.$root){const f=ke.$root[o];if(f.required){let v=null;v=o==="version"?i:f.type==="array"?[]:{},v!=null&&(u[o]=v)}}return u},y.bE=Ih,y.bF=De,y.bG=function u(i,o){if(Array.isArray(i)){if(!Array.isArray(o)||i.length!==o.length)return!1;for(let f=0;f<i.length;f++)if(!u(i[f],o[f]))return!1;return!0}if(typeof i=="object"&&i!==null&&o!==null){if(typeof o!="object"||Object.keys(i).length!==Object.keys(o).length)return!1;for(const f in i)if(!u(i[f],o[f]))return!1;return!0}return i===o},y.bH=function(u){u=u.slice();const i=Object.create(null);for(let o=0;o<u.length;o++)i[u[o].id]=u[o];for(let o=0;o<u.length;o++)"ref"in u[o]&&(u[o]=rn(u[o],i[u[o].ref]));return u},y.bI=function(u){if(u.type==="custom")return new fy(u);switch(u.type){case"background":return new hp(u);case"circle":return new sm(u);case"color-relief":return new dm(u);case"fill":return new ou(u);case"fill-extrusion":return new Uc(u);case"heatmap":return new X_(u);case"hillshade":return new Ku(u);case"line":return new Xg(u);case"raster":return new er(u);case"symbol":return new $d(u)}},y.bJ=_a,y.bK=function(u,i){if(!u)return[{command:"setStyle",args:[i]}];let o=[];try{if(!Vt(u.version,i.version))return[{command:"setStyle",args:[i]}];Vt(u.center,i.center)||o.push({command:"setCenter",args:[i.center]}),Vt(u.state,i.state)||o.push({command:"setGlobalState",args:[i.state]}),Vt(u.centerAltitude,i.centerAltitude)||o.push({command:"setCenterAltitude",args:[i.centerAltitude]}),Vt(u.zoom,i.zoom)||o.push({command:"setZoom",args:[i.zoom]}),Vt(u.bearing,i.bearing)||o.push({command:"setBearing",args:[i.bearing]}),Vt(u.pitch,i.pitch)||o.push({command:"setPitch",args:[i.pitch]}),Vt(u.roll,i.roll)||o.push({command:"setRoll",args:[i.roll]}),Vt(u.sprite,i.sprite)||o.push({command:"setSprite",args:[i.sprite]}),Vt(u.glyphs,i.glyphs)||o.push({command:"setGlyphs",args:[i.glyphs]}),Vt(u.transition,i.transition)||o.push({command:"setTransition",args:[i.transition]}),Vt(u.light,i.light)||o.push({command:"setLight",args:[i.light]}),Vt(u.terrain,i.terrain)||o.push({command:"setTerrain",args:[i.terrain]}),Vt(u.sky,i.sky)||o.push({command:"setSky",args:[i.sky]}),Vt(u.projection,i.projection)||o.push({command:"setProjection",args:[i.projection]});const f={},v=[];(function(S,I,R,z){let N;for(N in I=I||{},S=S||{})Object.prototype.hasOwnProperty.call(S,N)&&(Object.prototype.hasOwnProperty.call(I,N)||Tn(N,R,z));for(N in I)Object.prototype.hasOwnProperty.call(I,N)&&(Object.prototype.hasOwnProperty.call(S,N)?Vt(S[N],I[N])||(S[N].type==="geojson"&&I[N].type==="geojson"&&Sn(S,I,N)?Kt(R,{command:"setGeoJSONSourceData",args:[N,I[N].data]}):gn(N,I,R,z)):Ht(N,I,R))})(u.sources,i.sources,v,f);const T=[];u.layers&&u.layers.forEach(S=>{"source"in S&&f[S.source]?o.push({command:"removeLayer",args:[S.id]}):T.push(S)}),o=o.concat(v),function(S,I,R){I=I||[];const z=(S=S||[]).map(Bn),N=I.map(Bn),U=S.reduce(Wr,{}),q=I.reduce(Wr,{}),Y=z.slice(),J=Object.create(null);let te,le,ge,Le,we;for(let K=0,se=0;K<z.length;K++)te=z[K],Object.prototype.hasOwnProperty.call(q,te)?se++:(Kt(R,{command:"removeLayer",args:[te]}),Y.splice(Y.indexOf(te,se),1));for(let K=0,se=0;K<N.length;K++)te=N[N.length-1-K],Y[Y.length-1-K]!==te&&(Object.prototype.hasOwnProperty.call(U,te)?(Kt(R,{command:"removeLayer",args:[te]}),Y.splice(Y.lastIndexOf(te,Y.length-se),1)):se++,Le=Y[Y.length-K],Kt(R,{command:"addLayer",args:[q[te],Le]}),Y.splice(Y.length-K,0,te),J[te]=!0);for(let K=0;K<N.length;K++)if(te=N[K],le=U[te],ge=q[te],!J[te]&&!Vt(le,ge))if(Vt(le.source,ge.source)&&Vt(le["source-layer"],ge["source-layer"])&&Vt(le.type,ge.type)){for(we in on(le.layout,ge.layout,R,te,null,"setLayoutProperty"),on(le.paint,ge.paint,R,te,null,"setPaintProperty"),Vt(le.filter,ge.filter)||Kt(R,{command:"setFilter",args:[te,ge.filter]}),Vt(le.minzoom,ge.minzoom)&&Vt(le.maxzoom,ge.maxzoom)||Kt(R,{command:"setLayerZoomRange",args:[te,ge.minzoom,ge.maxzoom]}),le)Object.prototype.hasOwnProperty.call(le,we)&&we!=="layout"&&we!=="paint"&&we!=="filter"&&we!=="metadata"&&we!=="minzoom"&&we!=="maxzoom"&&(we.indexOf("paint.")===0?on(le[we],ge[we],R,te,we.slice(6),"setPaintProperty"):Vt(le[we],ge[we])||Kt(R,{command:"setLayerProperty",args:[te,we,ge[we]]}));for(we in ge)Object.prototype.hasOwnProperty.call(ge,we)&&!Object.prototype.hasOwnProperty.call(le,we)&&we!=="layout"&&we!=="paint"&&we!=="filter"&&we!=="metadata"&&we!=="minzoom"&&we!=="maxzoom"&&(we.indexOf("paint.")===0?on(le[we],ge[we],R,te,we.slice(6),"setPaintProperty"):Vt(le[we],ge[we])||Kt(R,{command:"setLayerProperty",args:[te,we,ge[we]]}))}else Kt(R,{command:"removeLayer",args:[te]}),Le=Y[Y.lastIndexOf(te)+1],Kt(R,{command:"addLayer",args:[ge,Le]})}(T,i.layers,o)}catch(f){console.warn("Unable to compute style diff:",f),o=[{command:"setStyle",args:[i]}]}return o},y.bL=function(u){const i=[],o=u.id;return o===void 0&&i.push({message:`layers.${o}: missing required property "id"`}),u.render===void 0&&i.push({message:`layers.${o}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&i.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),i},y.bM=Tr,y.bN=ya,y.bO=class extends vr{constructor(u,i){super(u,i),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},y.bP=Mh,y.bQ=class extends vr{constructor(u,i){super(u,i),this.current=tm}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let i=1;i<16;i++)if(u[i]!==this.current[i]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},y.bR=oi,y.bS=class extends vr{constructor(u,i){super(u,i),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},y.bT=class extends vr{constructor(u,i){super(u,i),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},y.bU=pe,y.bV=function(u,i){var o=Math.sin(i),f=Math.cos(i);return u[0]=f,u[1]=o,u[2]=0,u[3]=-o,u[4]=f,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},y.bW=function(u,i,o){var f=i[0],v=i[1],T=i[2];return u[0]=f*o[0]+v*o[3]+T*o[6],u[1]=f*o[1]+v*o[4]+T*o[7],u[2]=f*o[2]+v*o[5]+T*o[8],u},y.bX=function(u,i,o,f,v,T,S){var I=1/(i-o),R=1/(f-v),z=1/(T-S);return u[0]=-2*I,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*R,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*z,u[11]=0,u[12]=(i+o)*I,u[13]=(v+f)*R,u[14]=(S+T)*z,u[15]=1,u},y.bY=class extends vr{constructor(u,i){super(u,i),this.current=new Array}set(u){if(u!=this.current){this.current=u;const i=new Float32Array(4*u.length);for(let o=0;o<u.length;o++)i[4*o]=u[o].r,i[4*o+1]=u[o].g,i[4*o+2]=u[o].b,i[4*o+3]=u[o].a;this.gl.uniform4fv(this.location,i)}}},y.bZ=class extends vr{constructor(u,i){super(u,i),this.current=new Array}set(u){if(u!=this.current){this.current=u;const i=new Float32Array(u);this.gl.uniform1fv(this.location,i)}}},y.b_=class extends p{},y.ba=function(u,i,o){const f=new Float64Array(4);return Kn(f,u,i-90,o),f},y.bb=function(u,i,o,f){var v,T,S,I,R,z=i[0],N=i[1],U=i[2],q=i[3],Y=o[0],J=o[1],te=o[2],le=o[3];return(T=z*Y+N*J+U*te+q*le)<0&&(T=-T,Y=-Y,J=-J,te=-te,le=-le),1-T>Fe?(v=Math.acos(T),S=Math.sin(v),I=Math.sin((1-f)*v)/S,R=Math.sin(f*v)/S):(I=1-f,R=f),u[0]=I*z+R*Y,u[1]=I*N+R*J,u[2]=I*U+R*te,u[3]=I*q+R*le,u},y.bc=function(u){const i=new Float64Array(9);var o,f,v,T,S,I,R,z,N,U,q,Y,J,te,le,ge,Le,we;U=(v=(f=u)[0])*(R=v+v),q=(T=f[1])*R,J=(S=f[2])*R,te=S*(z=T+T),ge=(I=f[3])*R,Le=I*z,we=I*(N=S+S),(o=i)[0]=1-(Y=T*z)-(le=S*N),o[3]=q-we,o[6]=J+Le,o[1]=q+we,o[4]=1-U-le,o[7]=te-ge,o[2]=J-Le,o[5]=te+ge,o[8]=1-U-Y;const K=di(-Math.asin(Ir(i[2],-1,1)));let se,Se;return Math.hypot(i[5],i[8])<.001?(se=0,Se=-di(Math.atan2(i[3],i[4]))):(se=di(i[5]===0&&i[8]===0?0:Math.atan2(i[5],i[8])),Se=di(i[1]===0&&i[0]===0?0:Math.atan2(i[1],i[0]))),{roll:se,pitch:K+90,bearing:Se}},y.bd=function(u,i){return u.roll==i.roll&&u.pitch==i.pitch&&u.bearing==i.bearing},y.be=vn,y.bf=la,y.bg=Ld,y.bh=Lh,y.bi=Dh,y.bj=wn,y.bk=fn,y.bl=mn,y.bm=function(u,i,o,f,v){return wn(f,v,Ir((u-i)/(o-i),0,1))},y.bn=Yt,y.bo=function(){return new Float64Array(3)},y.bp=function(u,i,o,f){return u[0]=i[0]+o[0]*f,u[1]=i[1]+o[1]*f,u[2]=i[2]+o[2]*f,u},y.bq=Kn,y.br=function(u,i,o){var f=o[0],v=o[1],T=o[2],S=i[0],I=i[1],R=i[2],z=v*R-T*I,N=T*S-f*R,U=f*I-v*S,q=v*U-T*N,Y=T*z-f*U,J=f*N-v*z,te=2*o[3];return N*=te,U*=te,Y*=2,J*=2,u[0]=S+(z*=te)+(q*=2),u[1]=I+N+Y,u[2]=R+U+J,u},y.bs=function(u,i,o){const f=(v=[u[0],u[1],u[2],i[0],i[1],i[2],o[0],o[1],o[2]])[0]*((N=v[8])*(S=v[4])-(I=v[5])*(z=v[7]))+v[1]*(-N*(T=v[3])+I*(R=v[6]))+v[2]*(z*T-S*R);var v,T,S,I,R,z,N;if(f===0)return null;const U=Yn([],[i[0],i[1],i[2]],[o[0],o[1],o[2]]),q=Yn([],[o[0],o[1],o[2]],[u[0],u[1],u[2]]),Y=Yn([],[u[0],u[1],u[2]],[i[0],i[1],i[2]]),J=Ee([],U,-u[3]);return Ve(J,J,Ee([],q,-i[3])),Ve(J,J,Ee([],Y,-o[3])),Ee(J,J,1/f),J},y.bt=Im,y.bu=function(){return new Float64Array(4)},y.bv=function(u,i,o,f){var v=[],T=[];return v[0]=i[0]-o[0],v[1]=i[1]-o[1],v[2]=i[2]-o[2],T[0]=v[0]*Math.cos(f)-v[1]*Math.sin(f),T[1]=v[0]*Math.sin(f)+v[1]*Math.cos(f),T[2]=v[2],u[0]=T[0]+o[0],u[1]=T[1]+o[1],u[2]=T[2]+o[2],u},y.bw=function(u,i,o,f){var v=[],T=[];return v[0]=i[0]-o[0],v[1]=i[1]-o[1],v[2]=i[2]-o[2],T[0]=v[0],T[1]=v[1]*Math.cos(f)-v[2]*Math.sin(f),T[2]=v[1]*Math.sin(f)+v[2]*Math.cos(f),u[0]=T[0]+o[0],u[1]=T[1]+o[1],u[2]=T[2]+o[2],u},y.bx=function(u,i,o,f){var v=[],T=[];return v[0]=i[0]-o[0],v[1]=i[1]-o[1],v[2]=i[2]-o[2],T[0]=v[2]*Math.sin(f)+v[0]*Math.cos(f),T[1]=v[1],T[2]=v[2]*Math.cos(f)-v[0]*Math.sin(f),u[0]=T[0]+o[0],u[1]=T[1]+o[1],u[2]=T[2]+o[2],u},y.by=function(u,i,o){var f=Math.sin(o),v=Math.cos(o),T=i[0],S=i[1],I=i[2],R=i[3],z=i[8],N=i[9],U=i[10],q=i[11];return i!==u&&(u[4]=i[4],u[5]=i[5],u[6]=i[6],u[7]=i[7],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[0]=T*v-z*f,u[1]=S*v-N*f,u[2]=I*v-U*f,u[3]=R*v-q*f,u[8]=T*f+z*v,u[9]=S*f+N*v,u[10]=I*f+U*v,u[11]=R*f+q*v,u},y.bz=function(u,i){const o=Yt(u,360),f=Yt(i,360),v=f-o,T=f>o?v-360:v+360;return Math.abs(v)<Math.abs(T)?v:T},y.c=$e,y.c0=class extends w{},y.c1=Kf,y.c2=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},y.c3=Zf,y.c4=function(u,i,o){var f=i[0],v=i[1],T=i[2],S=o[3]*f+o[7]*v+o[11]*T+o[15];return u[0]=(o[0]*f+o[4]*v+o[8]*T+o[12])/(S=S||1),u[1]=(o[1]*f+o[5]*v+o[9]*T+o[13])/S,u[2]=(o[2]*f+o[6]*v+o[10]*T+o[14])/S,u},y.c5=class extends ju{},y.c6=class extends j{},y.c7=function(u,i){return u[0]===i[0]&&u[1]===i[1]&&u[2]===i[2]&&u[3]===i[3]&&u[4]===i[4]&&u[5]===i[5]&&u[6]===i[6]&&u[7]===i[7]&&u[8]===i[8]&&u[9]===i[9]&&u[10]===i[10]&&u[11]===i[11]&&u[12]===i[12]&&u[13]===i[13]&&u[14]===i[14]&&u[15]===i[15]},y.c8=function(u,i){var o=u[0],f=u[1],v=u[2],T=u[3],S=u[4],I=u[5],R=u[6],z=u[7],N=u[8],U=u[9],q=u[10],Y=u[11],J=u[12],te=u[13],le=u[14],ge=u[15],Le=i[0],we=i[1],K=i[2],se=i[3],Se=i[4],et=i[5],yt=i[6],st=i[7],ht=i[8],St=i[9],bt=i[10],Ct=i[11],pt=i[12],Gt=i[13],tn=i[14],Zt=i[15];return Math.abs(o-Le)<=Fe*Math.max(1,Math.abs(o),Math.abs(Le))&&Math.abs(f-we)<=Fe*Math.max(1,Math.abs(f),Math.abs(we))&&Math.abs(v-K)<=Fe*Math.max(1,Math.abs(v),Math.abs(K))&&Math.abs(T-se)<=Fe*Math.max(1,Math.abs(T),Math.abs(se))&&Math.abs(S-Se)<=Fe*Math.max(1,Math.abs(S),Math.abs(Se))&&Math.abs(I-et)<=Fe*Math.max(1,Math.abs(I),Math.abs(et))&&Math.abs(R-yt)<=Fe*Math.max(1,Math.abs(R),Math.abs(yt))&&Math.abs(z-st)<=Fe*Math.max(1,Math.abs(z),Math.abs(st))&&Math.abs(N-ht)<=Fe*Math.max(1,Math.abs(N),Math.abs(ht))&&Math.abs(U-St)<=Fe*Math.max(1,Math.abs(U),Math.abs(St))&&Math.abs(q-bt)<=Fe*Math.max(1,Math.abs(q),Math.abs(bt))&&Math.abs(Y-Ct)<=Fe*Math.max(1,Math.abs(Y),Math.abs(Ct))&&Math.abs(J-pt)<=Fe*Math.max(1,Math.abs(J),Math.abs(pt))&&Math.abs(te-Gt)<=Fe*Math.max(1,Math.abs(te),Math.abs(Gt))&&Math.abs(le-tn)<=Fe*Math.max(1,Math.abs(le),Math.abs(tn))&&Math.abs(ge-Zt)<=Fe*Math.max(1,Math.abs(ge),Math.abs(Zt))},y.c9=function(u,i){return u[0]=i[0],u[1]=i[1],u[2]=i[2],u[3]=i[3],u[4]=i[4],u[5]=i[5],u[6]=i[6],u[7]=i[7],u[8]=i[8],u[9]=i[9],u[10]=i[10],u[11]=i[11],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15],u},y.cA=function(u){delete ne.REGISTERED_PROTOCOLS[u]},y.cB=function(u,i){const o={};for(let v=0;v<u.length;v++){const T=i&&i[u[v].id]||Zl(u[v]);i&&(i[u[v].id]=T);let S=o[T];S||(S=o[T]=[]),S.push(u[v])}const f=[];for(const v in o)f.push(o[v]);return f},y.cC=Ft,y.cD=Pm,y.cE=_y,y.cF=iy,y.cG=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=It/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const i=u.bucket.layers[0],o=i.layout,f=i._unevaluatedLayout._values,v={layoutIconSize:f["icon-size"].possiblyEvaluate(new Lr(u.bucket.zoom+1),u.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new Lr(u.bucket.zoom+1),u.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new Lr(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:z,maxZoom:N}=u.bucket.textSizeData;v.compositeTextSizes=[f["text-size"].possiblyEvaluate(new Lr(z),u.canonical),f["text-size"].possiblyEvaluate(new Lr(N),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:z,maxZoom:N}=u.bucket.iconSizeData;v.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new Lr(z),u.canonical),f["icon-size"].possiblyEvaluate(new Lr(N),u.canonical)]}const T=o.get("text-line-height")*Si,S=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",I=o.get("text-keep-upright"),R=o.get("text-size");for(const z of u.bucket.features){const N=o.get("text-font").evaluate(z,{},u.canonical).join(","),U=R.evaluate(z,{},u.canonical),q=v.layoutTextSize.evaluate(z,{},u.canonical),Y=v.layoutIconSize.evaluate(z,{},u.canonical),J={horizontal:{},vertical:void 0},te=z.text;let le,ge=[0,0];if(te){const K=te.toString(),se=o.get("text-letter-spacing").evaluate(z,{},u.canonical)*Si,Se=gl(K)?se:0,et=o.get("text-anchor").evaluate(z,{},u.canonical),yt=du(i,z,u.canonical);if(!yt){const bt=o.get("text-radial-offset").evaluate(z,{},u.canonical);ge=bt?mp(et,[bt*Si,Lm]):o.get("text-offset").evaluate(z,{},u.canonical).map(Ct=>Ct*Si)}let st=S?"center":o.get("text-justify").evaluate(z,{},u.canonical);const ht=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(z,{},u.canonical)*Si:1/0,St=()=>{u.bucket.allowVerticalPlacement&&$o(K)&&(J.vertical=Bh(te,u.glyphMap,u.glyphPositions,u.imagePositions,N,ht,T,et,"left",Se,ge,y.an.vertical,!0,q,U))};if(!S&&yt){const bt=new Set;if(st==="auto")for(let pt=0;pt<yt.values.length;pt+=2)bt.add(Ey(yt.values[pt]));else bt.add(st);let Ct=!1;for(const pt of bt)if(!J.horizontal[pt])if(Ct)J.horizontal[pt]=J.horizontal[0];else{const Gt=Bh(te,u.glyphMap,u.glyphPositions,u.imagePositions,N,ht,T,"center",pt,Se,ge,y.an.horizontal,!1,q,U);Gt&&(J.horizontal[pt]=Gt,Ct=Gt.positionedLines.length===1)}St()}else{st==="auto"&&(st=Ey(et));const bt=Bh(te,u.glyphMap,u.glyphPositions,u.imagePositions,N,ht,T,et,st,Se,ge,y.an.horizontal,!1,q,U);bt&&(J.horizontal[st]=bt),St(),$o(K)&&S&&I&&(J.vertical=Bh(te,u.glyphMap,u.glyphPositions,u.imagePositions,N,ht,T,et,st,Se,ge,y.an.vertical,!1,q,U))}}let Le=!1;if(z.icon&&z.icon.name){const K=u.imageMap[z.icon.name];K&&(le=xm(u.imagePositions[z.icon.name],o.get("icon-offset").evaluate(z,{},u.canonical),o.get("icon-anchor").evaluate(z,{},u.canonical)),Le=!!K.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=Le:u.bucket.sdfIcons!==Le&&Cr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(K.pixelRatio!==u.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const we=Ay(J.horizontal)||J.vertical;u.bucket.iconsInText=!!we&&we.iconsInText,(we||le)&&Ob(u.bucket,z,J,le,u.imageMap,v,q,Y,ge,Le,u.canonical,u.subdivisionGranularity)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},y.cH=Bd,y.cI=Xu,y.cJ=Ss,y.cK=Mr,y.cL=vm,y.cM=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},y.cN=function(u,i,o,f,v){return c(this,void 0,void 0,function*(){if(qe())try{return yield Ls(u,i,o,f,v)}catch{}return function(T,S,I,R,z){const N=T.width,U=T.height;os&&Ro||(os=new OffscreenCanvas(N,U),Ro=os.getContext("2d",{willReadFrequently:!0})),os.width=N,os.height=U,Ro.drawImage(T,0,0,N,U);const q=Ro.getImageData(S,I,R,z);return Ro.clearRect(0,0,N,U),q.data}(u,i,o,f,v)})},y.cO=au,y.cP=P,y.cQ=X,y.cR=Pr,y.cS=ey,y.cT=Ua,y.cU=Go,y.ca=u=>u.type==="symbol",y.cb=u=>u.type==="circle",y.cc=u=>u.type==="heatmap",y.cd=u=>u.type==="line",y.ce=u=>u.type==="fill",y.cf=u=>u.type==="fill-extrusion",y.cg=u=>u.type==="hillshade",y.ch=u=>u.type==="color-relief",y.ci=u=>u.type==="raster",y.cj=u=>u.type==="background",y.ck=u=>u.type==="custom",y.cl=ii,y.cm=function(u,i,o){const f=xt(i.x-o.x,i.y-o.y),v=xt(u.x-o.x,u.y-o.y);var T,S;return di(Math.atan2(f[0]*v[1]-f[1]*v[0],(T=f)[0]*(S=v)[0]+T[1]*S[1]))},y.cn=wr,y.co=function(u,i){return vu[i]&&(u instanceof MouseEvent||u instanceof WheelEvent)},y.cp=function(u,i){return Ri[i]&&"touches"in u},y.cq=function(u){return Ri[u]||vu[u]},y.cr=function(u,i,o){var f=i[0],v=i[1];return u[0]=o[0]*f+o[4]*v+o[12],u[1]=o[1]*f+o[5]*v+o[13],u},y.cs=function(u,i){const{x:o,y:f}=Gd.fromLngLat(i);return!(u<0||u>25||f<0||f>=1||o<0||o>=1)},y.ct=function(u,i){return u[0]=i[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=i[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=i[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},y.cu=class extends Ho{},y.cv=Ev,y.cx=function(u){return u.message===ao},y.cy=xe,y.cz=function(u,i){ne.REGISTERED_PROTOCOLS[u]=i},y.d=Je,y.e=gi,y.f=u=>c(void 0,void 0,void 0,function*(){if(u.byteLength===0)return createImageBitmap(new ImageData(1,1));const i=new Blob([new Uint8Array(u)],{type:"image/png"});try{return createImageBitmap(i)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),y.g=re,y.h=u=>new Promise((i,o)=>{const f=new Image;f.onload=()=>{i(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=_u})},f.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const v=new Blob([new Uint8Array(u)],{type:"image/png"});f.src=u.byteLength?URL.createObjectURL(v):_u}),y.i=na,y.j=(u,i)=>je(gi(u,{type:"json"}),i),y.k=Ge,y.l=it,y.m=je,y.n=(u,i)=>je(gi(u,{type:"arrayBuffer"}),i),y.o=function(u){return new vm(u).readFields(ty,[])},y.p=ov,y.q=Rd,y.r=fa,y.s=fr,y.t=mr,y.u=Dn,y.v=ke,y.w=Cr,y.x=bd,y.y=Ql,y.z=Yl}),d("worker",["./shared"],function(y){class c{constructor(ne){this.keyCache={},ne&&this.replace(ne)}replace(ne){this._layerConfigs={},this._layers={},this.update(ne,[])}update(ne,re){for(const xe of ne){this._layerConfigs[xe.id]=xe;const De=this._layers[xe.id]=y.bI(xe);De._featureFilter=y.a9(De.filter),this.keyCache[xe.id]&&delete this.keyCache[xe.id]}for(const xe of re)delete this.keyCache[xe],delete this._layerConfigs[xe],delete this._layers[xe];this.familiesBySource={};const ue=y.cB(Object.values(this._layerConfigs),this.keyCache);for(const xe of ue){const De=xe.map(Ge=>this._layers[Ge.id]),je=De[0];if(je.visibility==="none")continue;const Je=je.source||"";let Be=this.familiesBySource[Je];Be||(Be=this.familiesBySource[Je]={});const lt=je.sourceLayer||"_geojsonTileLayer";let it=Be[lt];it||(it=Be[lt]=[]),it.push(De)}}}class P{constructor(ne){const re={},ue=[];for(const Je in ne){const Be=ne[Je],lt=re[Je]={};for(const it in Be){const Ge=Be[+it];if(!Ge||Ge.bitmap.width===0||Ge.bitmap.height===0)continue;const ft={x:0,y:0,w:Ge.bitmap.width+2,h:Ge.bitmap.height+2};ue.push(ft),lt[it]={rect:ft,metrics:Ge.metrics}}}const{w:xe,h:De}=y.p(ue),je=new y.q({width:xe||1,height:De||1});for(const Je in ne){const Be=ne[Je];for(const lt in Be){const it=Be[+lt];if(!it||it.bitmap.width===0||it.bitmap.height===0)continue;const Ge=re[Je][lt].rect;y.q.copy(it.bitmap,je,{x:0,y:0},{x:Ge.x+1,y:Ge.y+1},it.bitmap)}}this.image=je,this.positions=re}}y.cC("GlyphAtlas",P);class k{constructor(ne){this.tileID=new y.Z(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.uid=ne.uid,this.zoom=ne.zoom,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ne.showCollisionBoxes,this.collectResourceTiming=!!ne.collectResourceTiming,this.returnDependencies=!!ne.returnDependencies,this.promoteId=ne.promoteId,this.inFlightDependencies=[],this.globalState=ne.globalState}parse(ne,re,ue,xe,De){return y._(this,void 0,void 0,function*(){this.status="parsing",this.data=ne,this.collisionBoxArray=new y.a7;const je=new y.cD(Object.keys(ne.layers).sort()),Je=new y.cE(this.tileID,this.promoteId);Je.bucketLayerIDs=[];const Be={},lt={featureIndex:Je,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ue,subdivisionGranularity:De},it=re.familiesBySource[this.source];for(const on in it){const Bn=ne.layers[on];if(!Bn)continue;Bn.version===1&&y.w(`Vector tile source "${this.source}" layer "${on}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Wr=je.encode(on),Pt=[];for(let ai=0;ai<Bn.length;ai++){const cr=Bn.feature(ai),va=Je.getId(cr,on);Pt.push({feature:cr,id:va,index:ai,sourceLayerIndex:Wr})}for(const ai of it[on]){const cr=ai[0];cr.source!==this.source&&y.w(`layer.source = ${cr.source} does not equal this.source = ${this.source}`),cr.minzoom&&this.zoom<Math.floor(cr.minzoom)||cr.maxzoom&&this.zoom>=cr.maxzoom||cr.visibility!=="none"&&(B(ai,this.zoom,ue),(Be[cr.id]=cr.createBucket({index:Je.bucketLayerIDs.length,layers:ai,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Wr,sourceID:this.source,globalState:this.globalState})).populate(Pt,lt,this.tileID.canonical),Je.bucketLayerIDs.push(ai.map(va=>va.id)))}}const Ge=y.bM(lt.glyphDependencies,on=>Object.keys(on).map(Number));this.inFlightDependencies.forEach(on=>on==null?void 0:on.abort()),this.inFlightDependencies=[];let ft=Promise.resolve({});if(Object.keys(Ge).length){const on=new AbortController;this.inFlightDependencies.push(on),ft=xe.sendAsync({type:"GG",data:{stacks:Ge,source:this.source,tileID:this.tileID,type:"glyphs"}},on)}const ke=Object.keys(lt.iconDependencies);let Lt=Promise.resolve({});if(ke.length){const on=new AbortController;this.inFlightDependencies.push(on),Lt=xe.sendAsync({type:"GI",data:{icons:ke,source:this.source,tileID:this.tileID,type:"icons"}},on)}const rn=Object.keys(lt.patternDependencies);let Vt=Promise.resolve({});if(rn.length){const on=new AbortController;this.inFlightDependencies.push(on),Vt=xe.sendAsync({type:"GI",data:{icons:rn,source:this.source,tileID:this.tileID,type:"patterns"}},on)}const[Kt,Ht,Tn]=yield Promise.all([ft,Lt,Vt]),gn=new P(Kt),Sn=new y.cF(Ht,Tn);for(const on in Be){const Bn=Be[on];Bn instanceof y.a8?(B(Bn.layers,this.zoom,ue),y.cG({bucket:Bn,glyphMap:Kt,glyphPositions:gn.positions,imageMap:Ht,imagePositions:Sn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:lt.subdivisionGranularity})):Bn.hasPattern&&(Bn instanceof y.cH||Bn instanceof y.cI||Bn instanceof y.cJ)&&(B(Bn.layers,this.zoom,ue),Bn.addFeatures(lt,this.tileID.canonical,Sn.patternPositions))}return this.status="done",{buckets:Object.values(Be).filter(on=>!on.isEmpty()),featureIndex:Je,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:gn.image,imageAtlas:Sn,glyphMap:this.returnDependencies?Kt:null,iconMap:this.returnDependencies?Ht:null,glyphPositions:this.returnDependencies?gn.positions:null}})}}function B($e,ne,re){const ue=new y.F(ne);for(const xe of $e)xe.recalculate(ue,re)}class X{constructor(ne,re,ue){this.actor=ne,this.layerIndex=re,this.availableImages=ue,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ne,re){return y._(this,void 0,void 0,function*(){const ue=yield y.n(ne.request,re);try{return{vectorTile:new y.cK.VectorTile(new y.cL(ue.data)),rawData:ue.data,cacheControl:ue.cacheControl,expires:ue.expires}}catch(xe){const De=new Uint8Array(ue.data);let je=`Unable to parse the tile at ${ne.request.url}, `;throw je+=De[0]===31&&De[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${xe.message}`,new Error(je)}})}loadTile(ne){return y._(this,void 0,void 0,function*(){const re=ne.uid,ue=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new y.cM(ne.request),xe=new k(ne);this.loading[re]=xe;const De=new AbortController;xe.abort=De;try{const je=yield this.loadVectorTile(ne,De);if(delete this.loading[re],!je)return null;const Je=je.rawData,Be={};je.expires&&(Be.expires=je.expires),je.cacheControl&&(Be.cacheControl=je.cacheControl);const lt={};if(ue){const Ge=ue.finish();Ge&&(lt.resourceTiming=JSON.parse(JSON.stringify(Ge)))}xe.vectorTile=je.vectorTile;const it=xe.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);this.loaded[re]=xe,this.fetching[re]={rawTileData:Je,cacheControl:Be,resourceTiming:lt};try{const Ge=yield it;return y.e({rawTileData:Je.slice(0)},Ge,Be,lt)}finally{delete this.fetching[re]}}catch(je){throw delete this.loading[re],xe.status="done",this.loaded[re]=xe,je}})}reloadTile(ne){return y._(this,void 0,void 0,function*(){const re=ne.uid;if(!this.loaded||!this.loaded[re])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ue=this.loaded[re];if(ue.showCollisionBoxes=ne.showCollisionBoxes,ue.globalState=ne.globalState,ue.status==="parsing"){const xe=yield ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);let De;if(this.fetching[re]){const{rawTileData:je,cacheControl:Je,resourceTiming:Be}=this.fetching[re];delete this.fetching[re],De=y.e({rawTileData:je.slice(0)},xe,Je,Be)}else De=xe;return De}if(ue.status==="done"&&ue.vectorTile)return ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity)})}abortTile(ne){return y._(this,void 0,void 0,function*(){const re=this.loading,ue=ne.uid;re&&re[ue]&&re[ue].abort&&(re[ue].abort.abort(),delete re[ue])})}removeTile(ne){return y._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ne.uid]&&delete this.loaded[ne.uid]})}}class G{constructor(){this.loaded={}}loadTile(ne){return y._(this,void 0,void 0,function*(){const{uid:re,encoding:ue,rawImageData:xe,redFactor:De,greenFactor:je,blueFactor:Je,baseShift:Be}=ne,lt=xe.width+2,it=xe.height+2,Ge=y.b(xe)?new y.R({width:lt,height:it},yield y.cN(xe,-1,-1,lt,it)):xe,ft=new y.cO(re,Ge,ue,De,je,Je,Be);return this.loaded=this.loaded||{},this.loaded[re]=ft,ft})}removeTile(ne){const re=this.loaded,ue=ne.uid;re&&re[ue]&&delete re[ue]}}var W,ie,Ie=function(){if(ie)return W;function $e(re,ue){if(re.length!==0){ne(re[0],ue);for(var xe=1;xe<re.length;xe++)ne(re[xe],!ue)}}function ne(re,ue){for(var xe=0,De=0,je=0,Je=re.length,Be=Je-1;je<Je;Be=je++){var lt=(re[je][0]-re[Be][0])*(re[Be][1]+re[je][1]),it=xe+lt;De+=Math.abs(xe)>=Math.abs(lt)?xe-it+lt:lt-it+xe,xe=it}xe+De>=0!=!!ue&&re.reverse()}return ie=1,W=function re(ue,xe){var De,je=ue&&ue.type;if(je==="FeatureCollection")for(De=0;De<ue.features.length;De++)re(ue.features[De],xe);else if(je==="GeometryCollection")for(De=0;De<ue.geometries.length;De++)re(ue.geometries[De],xe);else if(je==="Feature")re(ue.geometry,xe);else if(je==="Polygon")$e(ue.coordinates,xe);else if(je==="MultiPolygon")for(De=0;De<ue.coordinates.length;De++)$e(ue.coordinates[De],xe);return ue}}(),Re=y.cP(Ie);const Oe=y.cK.VectorTileFeature.prototype.toGeoJSON;class Ke{constructor(ne){this._feature=ne,this.extent=y.$,this.type=ne.type,this.properties=ne.tags,"id"in ne&&!isNaN(ne.id)&&(this.id=parseInt(ne.id,10))}loadGeometry(){if(this._feature.type===1){const ne=[];for(const re of this._feature.geometry)ne.push([new y.P(re[0],re[1])]);return ne}{const ne=[];for(const re of this._feature.geometry){const ue=[];for(const xe of re)ue.push(new y.P(xe[0],xe[1]));ne.push(ue)}return ne}}toGeoJSON(ne,re,ue){return Oe.call(this,ne,re,ue)}}class mt{constructor(ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.$,this.length=ne.length,this._features=ne}feature(ne){return new Ke(this._features[ne])}}var qe,Fe,We,pe={exports:{}},oe=function(){if(We)return pe.exports;We=1;var $e=y.cS(),ne=function(){if(Fe)return qe;Fe=1;var it=y.cQ(),Ge=y.cR().VectorTileFeature;function ft(Lt,rn){this.options=rn||{},this.features=Lt,this.length=Lt.length}function ke(Lt,rn){this.id=typeof Lt.id=="number"?Lt.id:void 0,this.type=Lt.type,this.rawGeometry=Lt.type===1?[Lt.geometry]:Lt.geometry,this.properties=Lt.tags,this.extent=rn||4096}return qe=ft,ft.prototype.feature=function(Lt){return new ke(this.features[Lt],this.options.extent)},ke.prototype.loadGeometry=function(){var Lt=this.rawGeometry;this.geometry=[];for(var rn=0;rn<Lt.length;rn++){for(var Vt=Lt[rn],Kt=[],Ht=0;Ht<Vt.length;Ht++)Kt.push(new it(Vt[Ht][0],Vt[Ht][1]));this.geometry.push(Kt)}return this.geometry},ke.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Lt=this.geometry,rn=1/0,Vt=-1/0,Kt=1/0,Ht=-1/0,Tn=0;Tn<Lt.length;Tn++)for(var gn=Lt[Tn],Sn=0;Sn<gn.length;Sn++){var on=gn[Sn];rn=Math.min(rn,on.x),Vt=Math.max(Vt,on.x),Kt=Math.min(Kt,on.y),Ht=Math.max(Ht,on.y)}return[rn,Kt,Vt,Ht]},ke.prototype.toGeoJSON=Ge.prototype.toGeoJSON,qe}();function re(it){var Ge=new $e;return function(ft,ke){for(var Lt in ft.layers)ke.writeMessage(3,ue,ft.layers[Lt])}(it,Ge),Ge.finish()}function ue(it,Ge){var ft;Ge.writeVarintField(15,it.version||1),Ge.writeStringField(1,it.name||""),Ge.writeVarintField(5,it.extent||4096);var ke={keys:[],values:[],keycache:{},valuecache:{}};for(ft=0;ft<it.length;ft++)ke.feature=it.feature(ft),Ge.writeMessage(2,xe,ke);var Lt=ke.keys;for(ft=0;ft<Lt.length;ft++)Ge.writeStringField(3,Lt[ft]);var rn=ke.values;for(ft=0;ft<rn.length;ft++)Ge.writeMessage(4,lt,rn[ft])}function xe(it,Ge){var ft=it.feature;ft.id!==void 0&&Ge.writeVarintField(1,ft.id),Ge.writeMessage(2,De,it),Ge.writeVarintField(3,ft.type),Ge.writeMessage(4,Be,ft)}function De(it,Ge){var ft=it.feature,ke=it.keys,Lt=it.values,rn=it.keycache,Vt=it.valuecache;for(var Kt in ft.properties){var Ht=ft.properties[Kt],Tn=rn[Kt];if(Ht!==null){Tn===void 0&&(ke.push(Kt),rn[Kt]=Tn=ke.length-1),Ge.writeVarint(Tn);var gn=typeof Ht;gn!=="string"&&gn!=="boolean"&&gn!=="number"&&(Ht=JSON.stringify(Ht));var Sn=gn+":"+Ht,on=Vt[Sn];on===void 0&&(Lt.push(Ht),Vt[Sn]=on=Lt.length-1),Ge.writeVarint(on)}}}function je(it,Ge){return(Ge<<3)+(7&it)}function Je(it){return it<<1^it>>31}function Be(it,Ge){for(var ft=it.loadGeometry(),ke=it.type,Lt=0,rn=0,Vt=ft.length,Kt=0;Kt<Vt;Kt++){var Ht=ft[Kt],Tn=1;ke===1&&(Tn=Ht.length),Ge.writeVarint(je(1,Tn));for(var gn=ke===3?Ht.length-1:Ht.length,Sn=0;Sn<gn;Sn++){Sn===1&&ke!==1&&Ge.writeVarint(je(2,gn-1));var on=Ht[Sn].x-Lt,Bn=Ht[Sn].y-rn;Ge.writeVarint(Je(on)),Ge.writeVarint(Je(Bn)),Lt+=on,rn+=Bn}ke===3&&Ge.writeVarint(je(7,1))}}function lt(it,Ge){var ft=typeof it;ft==="string"?Ge.writeStringField(1,it):ft==="boolean"?Ge.writeBooleanField(7,it):ft==="number"&&(it%1!=0?Ge.writeDoubleField(3,it):it<0?Ge.writeSVarintField(6,it):Ge.writeVarintField(5,it))}return pe.exports=re,pe.exports.fromVectorTileJs=re,pe.exports.fromGeojsonVt=function(it,Ge){Ge=Ge||{};var ft={};for(var ke in it)ft[ke]=new ne(it[ke].features,Ge),ft[ke].name=ke,ft[ke].version=Ge.version,ft[ke].extent=Ge.extent;return re({layers:ft})},pe.exports.GeoJSONWrapper=ne,pe.exports}(),me=y.cP(oe);const be={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:$e=>$e},Ce=Math.fround||(Ve=new Float32Array(1),$e=>(Ve[0]=+$e,Ve[0]));var Ve;class Ee{constructor(ne){this.options=Object.assign(Object.create(be),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:re,minZoom:ue,maxZoom:xe}=this.options;re&&console.time("total time");const De=`prepare ${ne.length} points`;re&&console.time(De),this.points=ne;const je=[];for(let Be=0;Be<ne.length;Be++){const lt=ne[Be];if(!lt.geometry)continue;const[it,Ge]=lt.geometry.coordinates,ft=Ce(gt(it)),ke=Ce(Bt(Ge));je.push(ft,ke,1/0,Be,-1,1),this.options.reduce&&je.push(0)}let Je=this.trees[xe+1]=this._createTree(je);re&&console.timeEnd(De);for(let Be=xe;Be>=ue;Be--){const lt=+Date.now();Je=this.trees[Be]=this._createTree(this._cluster(Je,Be)),re&&console.log("z%d: %d clusters in %dms",Be,Je.numItems,+Date.now()-lt)}return re&&console.timeEnd("total time"),this}getClusters(ne,re){let ue=((ne[0]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,ne[1]));let De=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)ue=-180,De=180;else if(ue>De){const Ge=this.getClusters([ue,xe,180,je],re),ft=this.getClusters([-180,xe,De,je],re);return Ge.concat(ft)}const Je=this.trees[this._limitZoom(re)],Be=Je.range(gt(ue),Bt(je),gt(De),Bt(xe)),lt=Je.data,it=[];for(const Ge of Be){const ft=this.stride*Ge;it.push(lt[ft+5]>1?Yn(lt,ft,this.clusterProps):this.points[lt[ft+3]])}return it}getChildren(ne){const re=this._getOriginId(ne),ue=this._getOriginZoom(ne),xe="No cluster with the specified id.",De=this.trees[ue];if(!De)throw new Error(xe);const je=De.data;if(re*this.stride>=je.length)throw new Error(xe);const Je=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),Be=De.within(je[re*this.stride],je[re*this.stride+1],Je),lt=[];for(const it of Be){const Ge=it*this.stride;je[Ge+4]===ne&&lt.push(je[Ge+5]>1?Yn(je,Ge,this.clusterProps):this.points[je[Ge+3]])}if(lt.length===0)throw new Error(xe);return lt}getLeaves(ne,re,ue){const xe=[];return this._appendLeaves(xe,ne,re=re||10,ue=ue||0,0),xe}getTile(ne,re,ue){const xe=this.trees[this._limitZoom(ne)],De=Math.pow(2,ne),{extent:je,radius:Je}=this.options,Be=Je/je,lt=(ue-Be)/De,it=(ue+1+Be)/De,Ge={features:[]};return this._addTileFeatures(xe.range((re-Be)/De,lt,(re+1+Be)/De,it),xe.data,re,ue,De,Ge),re===0&&this._addTileFeatures(xe.range(1-Be/De,lt,1,it),xe.data,De,ue,De,Ge),re===De-1&&this._addTileFeatures(xe.range(0,lt,Be/De,it),xe.data,-1,ue,De,Ge),Ge.features.length?Ge:null}getClusterExpansionZoom(ne){let re=this._getOriginZoom(ne)-1;for(;re<=this.options.maxZoom;){const ue=this.getChildren(ne);if(re++,ue.length!==1)break;ne=ue[0].properties.cluster_id}return re}_appendLeaves(ne,re,ue,xe,De){const je=this.getChildren(re);for(const Je of je){const Be=Je.properties;if(Be&&Be.cluster?De+Be.point_count<=xe?De+=Be.point_count:De=this._appendLeaves(ne,Be.cluster_id,ue,xe,De):De<xe?De++:ne.push(Je),ne.length===ue)break}return De}_createTree(ne){const re=new y.aH(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ue=0;ue<ne.length;ue+=this.stride)re.add(ne[ue],ne[ue+1]);return re.finish(),re.data=ne,re}_addTileFeatures(ne,re,ue,xe,De,je){for(const Je of ne){const Be=Je*this.stride,lt=re[Be+5]>1;let it,Ge,ft;if(lt)it=jn(re,Be,this.clusterProps),Ge=re[Be],ft=re[Be+1];else{const rn=this.points[re[Be+3]];it=rn.properties;const[Vt,Kt]=rn.geometry.coordinates;Ge=gt(Vt),ft=Bt(Kt)}const ke={type:1,geometry:[[Math.round(this.options.extent*(Ge*De-ue)),Math.round(this.options.extent*(ft*De-xe))]],tags:it};let Lt;Lt=lt||this.options.generateId?re[Be+3]:this.points[re[Be+3]].id,Lt!==void 0&&(ke.id=Lt),je.features.push(ke)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,re){const{radius:ue,extent:xe,reduce:De,minPoints:je}=this.options,Je=ue/(xe*Math.pow(2,re)),Be=ne.data,lt=[],it=this.stride;for(let Ge=0;Ge<Be.length;Ge+=it){if(Be[Ge+2]<=re)continue;Be[Ge+2]=re;const ft=Be[Ge],ke=Be[Ge+1],Lt=ne.within(Be[Ge],Be[Ge+1],Je),rn=Be[Ge+5];let Vt=rn;for(const Kt of Lt){const Ht=Kt*it;Be[Ht+2]>re&&(Vt+=Be[Ht+5])}if(Vt>rn&&Vt>=je){let Kt,Ht=ft*rn,Tn=ke*rn,gn=-1;const Sn=(Ge/it<<5)+(re+1)+this.points.length;for(const on of Lt){const Bn=on*it;if(Be[Bn+2]<=re)continue;Be[Bn+2]=re;const Wr=Be[Bn+5];Ht+=Be[Bn]*Wr,Tn+=Be[Bn+1]*Wr,Be[Bn+4]=Sn,De&&(Kt||(Kt=this._map(Be,Ge,!0),gn=this.clusterProps.length,this.clusterProps.push(Kt)),De(Kt,this._map(Be,Bn)))}Be[Ge+4]=Sn,lt.push(Ht/Vt,Tn/Vt,1/0,Sn,-1,Vt),De&&lt.push(gn)}else{for(let Kt=0;Kt<it;Kt++)lt.push(Be[Ge+Kt]);if(Vt>1)for(const Kt of Lt){const Ht=Kt*it;if(!(Be[Ht+2]<=re)){Be[Ht+2]=re;for(let Tn=0;Tn<it;Tn++)lt.push(Be[Ht+Tn])}}}}return lt}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,re,ue){if(ne[re+5]>1){const je=this.clusterProps[ne[re+6]];return ue?Object.assign({},je):je}const xe=this.points[ne[re+3]].properties,De=this.options.map(xe);return ue&&De===xe?Object.assign({},De):De}}function Yn($e,ne,re){return{type:"Feature",id:$e[ne+3],properties:jn($e,ne,re),geometry:{type:"Point",coordinates:[(ue=$e[ne],360*(ue-.5)),nn($e[ne+1])]}};var ue}function jn($e,ne,re){const ue=$e[ne+5],xe=ue>=1e4?`${Math.round(ue/1e3)}k`:ue>=1e3?Math.round(ue/100)/10+"k":ue,De=$e[ne+6],je=De===-1?{}:Object.assign({},re[De]);return Object.assign(je,{cluster:!0,cluster_id:$e[ne+3],point_count:ue,point_count_abbreviated:xe})}function gt($e){return $e/360+.5}function Bt($e){const ne=Math.sin($e*Math.PI/180),re=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return re<0?0:re>1?1:re}function nn($e){const ne=(180-360*$e)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function Kn($e,ne,re,ue){let xe=ue;const De=ne+(re-ne>>1);let je,Je=re-ne;const Be=$e[ne],lt=$e[ne+1],it=$e[re],Ge=$e[re+1];for(let ft=ne+3;ft<re;ft+=3){const ke=ze($e[ft],$e[ft+1],Be,lt,it,Ge);if(ke>xe)je=ft,xe=ke;else if(ke===xe){const Lt=Math.abs(ft-De);Lt<Je&&(je=ft,Je=Lt)}}xe>ue&&(je-ne>3&&Kn($e,ne,je,ue),$e[je+2]=xe,re-je>3&&Kn($e,je,re,ue))}function ze($e,ne,re,ue,xe,De){let je=xe-re,Je=De-ue;if(je!==0||Je!==0){const Be=(($e-re)*je+(ne-ue)*Je)/(je*je+Je*Je);Be>1?(re=xe,ue=De):Be>0&&(re+=je*Be,ue+=Je*Be)}return je=$e-re,Je=ne-ue,je*je+Je*Je}function xt($e,ne,re,ue){const xe={id:$e??null,type:ne,geometry:re,tags:ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")It(xe,re);else if(ne==="Polygon")It(xe,re[0]);else if(ne==="MultiLineString")for(const De of re)It(xe,De);else if(ne==="MultiPolygon")for(const De of re)It(xe,De[0]);return xe}function It($e,ne){for(let re=0;re<ne.length;re+=3)$e.minX=Math.min($e.minX,ne[re]),$e.minY=Math.min($e.minY,ne[re+1]),$e.maxX=Math.max($e.maxX,ne[re]),$e.maxY=Math.max($e.maxY,ne[re+1])}function Rt($e,ne,re,ue){if(!ne.geometry)return;const xe=ne.geometry.coordinates;if(xe&&xe.length===0)return;const De=ne.geometry.type,je=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2);let Je=[],Be=ne.id;if(re.promoteId?Be=ne.properties[re.promoteId]:re.generateId&&(Be=ue||0),De==="Point")Yt(xe,Je);else if(De==="MultiPoint")for(const lt of xe)Yt(lt,Je);else if(De==="LineString")wn(xe,Je,je,!1);else if(De==="MultiLineString"){if(re.lineMetrics){for(const lt of xe)Je=[],wn(lt,Je,je,!1),$e.push(xt(Be,"LineString",Je,ne.properties));return}fn(xe,Je,je,!1)}else if(De==="Polygon")fn(xe,Je,je,!0);else{if(De!=="MultiPolygon"){if(De==="GeometryCollection"){for(const lt of ne.geometry.geometries)Rt($e,{id:Be,geometry:lt,properties:ne.properties},re,ue);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const lt of xe){const it=[];fn(lt,it,je,!0),Je.push(it)}}$e.push(xt(Be,De,Je,ne.properties))}function Yt($e,ne){ne.push(ii($e[0]),wr($e[1]),0)}function wn($e,ne,re,ue){let xe,De,je=0;for(let Be=0;Be<$e.length;Be++){const lt=ii($e[Be][0]),it=wr($e[Be][1]);ne.push(lt,it,0),Be>0&&(je+=ue?(xe*it-lt*De)/2:Math.sqrt(Math.pow(lt-xe,2)+Math.pow(it-De,2))),xe=lt,De=it}const Je=ne.length-3;ne[2]=1,Kn(ne,0,Je,re),ne[Je+2]=1,ne.size=Math.abs(je),ne.start=0,ne.end=ne.size}function fn($e,ne,re,ue){for(let xe=0;xe<$e.length;xe++){const De=[];wn($e[xe],De,re,ue),ne.push(De)}}function ii($e){return $e/360+.5}function wr($e){const ne=Math.sin($e*Math.PI/180),re=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return re<0?0:re>1?1:re}function Ir($e,ne,re,ue,xe,De,je,Je){if(ue/=ne,De>=(re/=ne)&&je<ue)return $e;if(je<re||De>=ue)return null;const Be=[];for(const lt of $e){const it=lt.geometry;let Ge=lt.type;const ft=xe===0?lt.minX:lt.minY,ke=xe===0?lt.maxX:lt.maxY;if(ft>=re&&ke<ue){Be.push(lt);continue}if(ke<re||ft>=ue)continue;let Lt=[];if(Ge==="Point"||Ge==="MultiPoint")ks(it,Lt,re,ue,xe);else if(Ge==="LineString")gi(it,Lt,re,ue,xe,!1,Je.lineMetrics);else if(Ge==="MultiLineString")Tr(it,Lt,re,ue,xe,!1);else if(Ge==="Polygon")Tr(it,Lt,re,ue,xe,!0);else if(Ge==="MultiPolygon")for(const rn of it){const Vt=[];Tr(rn,Vt,re,ue,xe,!0),Vt.length&&Lt.push(Vt)}if(Lt.length){if(Je.lineMetrics&&Ge==="LineString"){for(const rn of Lt)Be.push(xt(lt.id,Ge,rn,lt.tags));continue}Ge!=="LineString"&&Ge!=="MultiLineString"||(Lt.length===1?(Ge="LineString",Lt=Lt[0]):Ge="MultiLineString"),Ge!=="Point"&&Ge!=="MultiPoint"||(Ge=Lt.length===3?"Point":"MultiPoint"),Be.push(xt(lt.id,Ge,Lt,lt.tags))}}return Be.length?Be:null}function ks($e,ne,re,ue,xe){for(let De=0;De<$e.length;De+=3){const je=$e[De+xe];je>=re&&je<=ue&&ya(ne,$e[De],$e[De+1],$e[De+2])}}function gi($e,ne,re,ue,xe,De,je){let Je=io($e);const Be=xe===0?_a:nl;let lt,it,Ge=$e.start;for(let Vt=0;Vt<$e.length-3;Vt+=3){const Kt=$e[Vt],Ht=$e[Vt+1],Tn=$e[Vt+2],gn=$e[Vt+3],Sn=$e[Vt+4],on=xe===0?Kt:Ht,Bn=xe===0?gn:Sn;let Wr=!1;je&&(lt=Math.sqrt(Math.pow(Kt-gn,2)+Math.pow(Ht-Sn,2))),on<re?Bn>re&&(it=Be(Je,Kt,Ht,gn,Sn,re),je&&(Je.start=Ge+lt*it)):on>ue?Bn<ue&&(it=Be(Je,Kt,Ht,gn,Sn,ue),je&&(Je.start=Ge+lt*it)):ya(Je,Kt,Ht,Tn),Bn<re&&on>=re&&(it=Be(Je,Kt,Ht,gn,Sn,re),Wr=!0),Bn>ue&&on<=ue&&(it=Be(Je,Kt,Ht,gn,Sn,ue),Wr=!0),!De&&Wr&&(je&&(Je.end=Ge+lt*it),ne.push(Je),Je=io($e)),je&&(Ge+=lt)}let ft=$e.length-3;const ke=$e[ft],Lt=$e[ft+1],rn=xe===0?ke:Lt;rn>=re&&rn<=ue&&ya(Je,ke,Lt,$e[ft+2]),ft=Je.length-3,De&&ft>=3&&(Je[ft]!==Je[0]||Je[ft+1]!==Je[1])&&ya(Je,Je[0],Je[1],Je[2]),Je.length&&ne.push(Je)}function io($e){const ne=[];return ne.size=$e.size,ne.start=$e.start,ne.end=$e.end,ne}function Tr($e,ne,re,ue,xe,De){for(const je of $e)gi(je,ne,re,ue,xe,De,!1)}function ya($e,ne,re,ue){$e.push(ne,re,ue)}function _a($e,ne,re,ue,xe,De){const je=(De-ne)/(ue-ne);return ya($e,De,re+(xe-re)*je,1),je}function nl($e,ne,re,ue,xe,De){const je=(De-re)/(xe-re);return ya($e,ne+(ue-ne)*je,De,1),je}function Cr($e,ne){const re=[];for(let ue=0;ue<$e.length;ue++){const xe=$e[ue],De=xe.type;let je;if(De==="Point"||De==="MultiPoint"||De==="LineString")je=za(xe.geometry,ne);else if(De==="MultiLineString"||De==="Polygon"){je=[];for(const Je of xe.geometry)je.push(za(Je,ne))}else if(De==="MultiPolygon"){je=[];for(const Je of xe.geometry){const Be=[];for(const lt of Je)Be.push(za(lt,ne));je.push(Be)}}re.push(xt(xe.id,De,je,xe.tags))}return re}function za($e,ne){const re=[];re.size=$e.size,$e.start!==void 0&&(re.start=$e.start,re.end=$e.end);for(let ue=0;ue<$e.length;ue+=3)re.push($e[ue]+ne,$e[ue+1],$e[ue+2]);return re}function na($e,ne){if($e.transformed)return $e;const re=1<<$e.z,ue=$e.x,xe=$e.y;for(const De of $e.features){const je=De.geometry,Je=De.type;if(De.geometry=[],Je===1)for(let Be=0;Be<je.length;Be+=2)De.geometry.push(Ds(je[Be],je[Be+1],ne,re,ue,xe));else for(let Be=0;Be<je.length;Be++){const lt=[];for(let it=0;it<je[Be].length;it+=2)lt.push(Ds(je[Be][it],je[Be][it+1],ne,re,ue,xe));De.geometry.push(lt)}}return $e.transformed=!0,$e}function Ds($e,ne,re,ue,xe,De){return[Math.round(re*($e*ue-xe)),Math.round(re*(ne*ue-De))]}function Wa($e,ne,re,ue,xe){const De=ne===xe.maxZoom?0:xe.tolerance/((1<<ne)*xe.extent),je={features:[],numPoints:0,numSimplified:0,numFeatures:$e.length,source:null,x:re,y:ue,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Je of $e)_u(je,Je,De,xe);return je}function _u($e,ne,re,ue){const xe=ne.geometry,De=ne.type,je=[];if($e.minX=Math.min($e.minX,ne.minX),$e.minY=Math.min($e.minY,ne.minY),$e.maxX=Math.max($e.maxX,ne.maxX),$e.maxY=Math.max($e.maxY,ne.maxY),De==="Point"||De==="MultiPoint")for(let Je=0;Je<xe.length;Je+=3)je.push(xe[Je],xe[Je+1]),$e.numPoints++,$e.numSimplified++;else if(De==="LineString")Ls(je,xe,$e,re,!1,!1);else if(De==="MultiLineString"||De==="Polygon")for(let Je=0;Je<xe.length;Je++)Ls(je,xe[Je],$e,re,De==="Polygon",Je===0);else if(De==="MultiPolygon")for(let Je=0;Je<xe.length;Je++){const Be=xe[Je];for(let lt=0;lt<Be.length;lt++)Ls(je,Be[lt],$e,re,!0,lt===0)}if(je.length){let Je=ne.tags||null;if(De==="LineString"&&ue.lineMetrics){Je={};for(const lt in ne.tags)Je[lt]=ne.tags[lt];Je.mapbox_clip_start=xe.start/xe.size,Je.mapbox_clip_end=xe.end/xe.size}const Be={geometry:je,type:De==="Polygon"||De==="MultiPolygon"?3:De==="LineString"||De==="MultiLineString"?2:1,tags:Je};ne.id!==null&&(Be.id=ne.id),$e.features.push(Be)}}function Ls($e,ne,re,ue,xe,De){const je=ue*ue;if(ue>0&&ne.size<(xe?je:ue))return void(re.numPoints+=ne.length/3);const Je=[];for(let Be=0;Be<ne.length;Be+=3)(ue===0||ne[Be+2]>je)&&(re.numSimplified++,Je.push(ne[Be],ne[Be+1])),re.numPoints++;xe&&function(Be,lt){let it=0;for(let Ge=0,ft=Be.length,ke=ft-2;Ge<ft;ke=Ge,Ge+=2)it+=(Be[Ge]-Be[ke])*(Be[Ge+1]+Be[ke+1]);if(it>0===lt)for(let Ge=0,ft=Be.length;Ge<ft/2;Ge+=2){const ke=Be[Ge],Lt=Be[Ge+1];Be[Ge]=Be[ft-2-Ge],Be[Ge+1]=Be[ft-1-Ge],Be[ft-2-Ge]=ke,Be[ft-1-Ge]=Lt}}(Je,De),$e.push(Je)}const os={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ro{constructor(ne,re){const ue=(re=this.options=function(De,je){for(const Je in je)De[Je]=je[Je];return De}(Object.create(os),re)).debug;if(ue&&console.time("preprocess data"),re.maxZoom<0||re.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(re.promoteId&&re.generateId)throw new Error("promoteId and generateId cannot be used together.");let xe=function(De,je){const Je=[];if(De.type==="FeatureCollection")for(let Be=0;Be<De.features.length;Be++)Rt(Je,De.features[Be],je,Be);else Rt(Je,De.type==="Feature"?De:{geometry:De},je);return Je}(ne,re);this.tiles={},this.tileCoords=[],ue&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",re.indexMaxZoom,re.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),xe=function(De,je){const Je=je.buffer/je.extent;let Be=De;const lt=Ir(De,1,-1-Je,Je,0,-1,2,je),it=Ir(De,1,1-Je,2+Je,0,-1,2,je);return(lt||it)&&(Be=Ir(De,1,-Je,1+Je,0,-1,2,je)||[],lt&&(Be=Cr(lt,1).concat(Be)),it&&(Be=Be.concat(Cr(it,-1)))),Be}(xe,re),xe.length&&this.splitTile(xe,0,0,0),ue&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ne,re,ue,xe,De,je,Je){const Be=[ne,re,ue,xe],lt=this.options,it=lt.debug;for(;Be.length;){xe=Be.pop(),ue=Be.pop(),re=Be.pop(),ne=Be.pop();const Ge=1<<re,ft=fr(re,ue,xe);let ke=this.tiles[ft];if(!ke&&(it>1&&console.time("creation"),ke=this.tiles[ft]=Wa(ne,re,ue,xe,lt),this.tileCoords.push({z:re,x:ue,y:xe}),it)){it>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",re,ue,xe,ke.numFeatures,ke.numPoints,ke.numSimplified),console.timeEnd("creation"));const Wr=`z${re}`;this.stats[Wr]=(this.stats[Wr]||0)+1,this.total++}if(ke.source=ne,De==null){if(re===lt.indexMaxZoom||ke.numPoints<=lt.indexMaxPoints)continue}else{if(re===lt.maxZoom||re===De)continue;if(De!=null){const Wr=De-re;if(ue!==je>>Wr||xe!==Je>>Wr)continue}}if(ke.source=null,ne.length===0)continue;it>1&&console.time("clipping");const Lt=.5*lt.buffer/lt.extent,rn=.5-Lt,Vt=.5+Lt,Kt=1+Lt;let Ht=null,Tn=null,gn=null,Sn=null,on=Ir(ne,Ge,ue-Lt,ue+Vt,0,ke.minX,ke.maxX,lt),Bn=Ir(ne,Ge,ue+rn,ue+Kt,0,ke.minX,ke.maxX,lt);ne=null,on&&(Ht=Ir(on,Ge,xe-Lt,xe+Vt,1,ke.minY,ke.maxY,lt),Tn=Ir(on,Ge,xe+rn,xe+Kt,1,ke.minY,ke.maxY,lt),on=null),Bn&&(gn=Ir(Bn,Ge,xe-Lt,xe+Vt,1,ke.minY,ke.maxY,lt),Sn=Ir(Bn,Ge,xe+rn,xe+Kt,1,ke.minY,ke.maxY,lt),Bn=null),it>1&&console.timeEnd("clipping"),Be.push(Ht||[],re+1,2*ue,2*xe),Be.push(Tn||[],re+1,2*ue,2*xe+1),Be.push(gn||[],re+1,2*ue+1,2*xe),Be.push(Sn||[],re+1,2*ue+1,2*xe+1)}}getTile(ne,re,ue){ne=+ne,re=+re,ue=+ue;const xe=this.options,{extent:De,debug:je}=xe;if(ne<0||ne>24)return null;const Je=1<<ne,Be=fr(ne,re=re+Je&Je-1,ue);if(this.tiles[Be])return na(this.tiles[Be],De);je>1&&console.log("drilling down to z%d-%d-%d",ne,re,ue);let lt,it=ne,Ge=re,ft=ue;for(;!lt&&it>0;)it--,Ge>>=1,ft>>=1,lt=this.tiles[fr(it,Ge,ft)];return lt&&lt.source?(je>1&&(console.log("found parent tile z%d-%d-%d",it,Ge,ft),console.time("drilling down")),this.splitTile(lt.source,it,Ge,ft,ne,re,ue),je>1&&console.timeEnd("drilling down"),this.tiles[Be]?na(this.tiles[Be],De):null):null}}function fr($e,ne,re){return 32*((1<<$e)*re+ne)+$e}function zn($e,ne){return ne?$e.properties[ne]:$e.id}function di($e,ne){if($e==null)return!0;if($e.type==="Feature")return zn($e,ne)!=null;if($e.type==="FeatureCollection"){const re=new Set;for(const ue of $e.features){const xe=zn(ue,ne);if(xe==null||re.has(xe))return!1;re.add(xe)}return!0}return!1}function Ri($e,ne){const re=new Map;if($e!=null)if($e.type==="Feature")re.set(zn($e,ne),$e);else for(const ue of $e.features)re.set(zn(ue,ne),ue);return re}class vu extends X{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ne,re){return y._(this,void 0,void 0,function*(){const ue=ne.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const xe=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!xe)return null;const De=new mt(xe.features);let je=me(De);return je.byteOffset===0&&je.byteLength===je.buffer.byteLength||(je=new Uint8Array(je)),{vectorTile:De,rawData:je.buffer}})}loadData(ne){return y._(this,void 0,void 0,function*(){var re;(re=this._pendingRequest)===null||re===void 0||re.abort();const ue=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new y.cM(ne.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ne,this._pendingRequest),this._geoJSONIndex=ne.cluster?new Ee(function({superclusterOptions:je,clusterProperties:Je}){if(!Je||!je)return je;const Be={},lt={},it={accumulated:null,zoom:0},Ge={properties:null},ft=Object.keys(Je);for(const ke of ft){const[Lt,rn]=Je[ke],Vt=y.cT(rn),Kt=y.cT(typeof Lt=="string"?[Lt,["accumulated"],["get",ke]]:Lt);Be[ke]=Vt.value,lt[ke]=Kt.value}return je.map=ke=>{Ge.properties=ke;const Lt={};for(const rn of ft)Lt[rn]=Be[rn].evaluate(it,Ge);return Lt},je.reduce=(ke,Lt)=>{Ge.properties=Lt;for(const rn of ft)it.accumulated=ke[rn],ke[rn]=lt[rn].evaluate(it,Ge)},je}(ne)).load((yield this._pendingData).features):(xe=yield this._pendingData,new Ro(xe,ne.geojsonVtOptions)),this.loaded={};const De={};if(ue){const je=ue.finish();je&&(De.resourceTiming={},De.resourceTiming[ne.source]=JSON.parse(JSON.stringify(je)))}return De}catch(De){if(delete this._pendingRequest,y.cx(De))return{abandoned:!0};throw De}var xe})}getData(){return y._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ne){const re=this.loaded;return re&&re[ne.uid]?super.reloadTile(ne):this.loadTile(ne)}loadAndProcessGeoJSON(ne,re){return y._(this,void 0,void 0,function*(){let ue=yield this.loadGeoJSON(ne,re);if(delete this._pendingRequest,typeof ue!="object")throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`);if(Re(ue,!0),ne.filter){const xe=y.cT(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(xe.result==="error")throw new Error(xe.value.map(je=>`${je.key}: ${je.message}`).join(", "));ue={type:"FeatureCollection",features:ue.features.filter(je=>xe.value.evaluate({zoom:0},je))}}return ue})}loadGeoJSON(ne,re){return y._(this,void 0,void 0,function*(){const{promoteId:ue}=ne;if(ne.request){const xe=yield y.j(ne.request,re);return this._dataUpdateable=di(xe.data,ue)?Ri(xe.data,ue):void 0,xe.data}if(typeof ne.data=="string")try{const xe=JSON.parse(ne.data);return this._dataUpdateable=di(xe,ue)?Ri(xe,ue):void 0,xe}catch{throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`)}if(!ne.dataDiff)throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ne.source}`);return function(xe,De,je){var Je,Be,lt,it;if(De.removeAll&&xe.clear(),De.remove)for(const Ge of De.remove)xe.delete(Ge);if(De.add)for(const Ge of De.add){const ft=zn(Ge,je);ft!=null&&xe.set(ft,Ge)}if(De.update)for(const Ge of De.update){let ft=xe.get(Ge.id);if(ft==null)continue;const ke=!Ge.removeAllProperties&&(((Je=Ge.removeProperties)===null||Je===void 0?void 0:Je.length)>0||((Be=Ge.addOrUpdateProperties)===null||Be===void 0?void 0:Be.length)>0);if((Ge.newGeometry||Ge.removeAllProperties||ke)&&(ft=Object.assign({},ft),xe.set(Ge.id,ft),ke&&(ft.properties=Object.assign({},ft.properties))),Ge.newGeometry&&(ft.geometry=Ge.newGeometry),Ge.removeAllProperties)ft.properties={};else if(((lt=Ge.removeProperties)===null||lt===void 0?void 0:lt.length)>0)for(const Lt of Ge.removeProperties)Object.prototype.hasOwnProperty.call(ft.properties,Lt)&&delete ft.properties[Lt];if(((it=Ge.addOrUpdateProperties)===null||it===void 0?void 0:it.length)>0)for(const{key:Lt,value:rn}of Ge.addOrUpdateProperties)ft.properties[Lt]=rn}}(this._dataUpdateable,ne.dataDiff,ue),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ne){return y._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ne){return this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId)}getClusterChildren(ne){return this._geoJSONIndex.getChildren(ne.clusterId)}getClusterLeaves(ne){return this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset)}}class ao{constructor(ne){this.self=ne,this.actor=new y.J(ne),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(re,ue)=>{if(this.externalWorkerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.externalWorkerSourceTypes[re]=ue},this.self.addProtocol=y.cz,this.self.removeProtocol=y.cA,this.self.registerRTLTextPlugin=re=>{y.cU.setMethods(re)},this.actor.registerMessageHandler("LDT",(re,ue)=>this._getDEMWorkerSource(re,ue.source).loadTile(ue)),this.actor.registerMessageHandler("RDT",(re,ue)=>y._(this,void 0,void 0,function*(){this._getDEMWorkerSource(re,ue.source).removeTile(ue)})),this.actor.registerMessageHandler("GCEZ",(re,ue)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(re,ue.type,ue.source).getClusterExpansionZoom(ue)})),this.actor.registerMessageHandler("GCC",(re,ue)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(re,ue.type,ue.source).getClusterChildren(ue)})),this.actor.registerMessageHandler("GCL",(re,ue)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(re,ue.type,ue.source).getClusterLeaves(ue)})),this.actor.registerMessageHandler("LD",(re,ue)=>this._getWorkerSource(re,ue.type,ue.source).loadData(ue)),this.actor.registerMessageHandler("GD",(re,ue)=>this._getWorkerSource(re,ue.type,ue.source).getData()),this.actor.registerMessageHandler("LT",(re,ue)=>this._getWorkerSource(re,ue.type,ue.source).loadTile(ue)),this.actor.registerMessageHandler("RT",(re,ue)=>this._getWorkerSource(re,ue.type,ue.source).reloadTile(ue)),this.actor.registerMessageHandler("AT",(re,ue)=>this._getWorkerSource(re,ue.type,ue.source).abortTile(ue)),this.actor.registerMessageHandler("RMT",(re,ue)=>this._getWorkerSource(re,ue.type,ue.source).removeTile(ue)),this.actor.registerMessageHandler("RS",(re,ue)=>y._(this,void 0,void 0,function*(){if(!this.workerSources[re]||!this.workerSources[re][ue.type]||!this.workerSources[re][ue.type][ue.source])return;const xe=this.workerSources[re][ue.type][ue.source];delete this.workerSources[re][ue.type][ue.source],xe.removeSource!==void 0&&xe.removeSource(ue)})),this.actor.registerMessageHandler("RM",re=>y._(this,void 0,void 0,function*(){delete this.layerIndexes[re],delete this.availableImages[re],delete this.workerSources[re],delete this.demWorkerSources[re]})),this.actor.registerMessageHandler("SR",(re,ue)=>y._(this,void 0,void 0,function*(){this.referrer=ue})),this.actor.registerMessageHandler("SRPS",(re,ue)=>this._syncRTLPluginState(re,ue)),this.actor.registerMessageHandler("IS",(re,ue)=>y._(this,void 0,void 0,function*(){this.self.importScripts(ue)})),this.actor.registerMessageHandler("SI",(re,ue)=>this._setImages(re,ue)),this.actor.registerMessageHandler("UL",(re,ue)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(re).update(ue.layers,ue.removedIds)})),this.actor.registerMessageHandler("SL",(re,ue)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(re).replace(ue)}))}_setImages(ne,re){return y._(this,void 0,void 0,function*(){this.availableImages[ne]=re;for(const ue in this.workerSources[ne]){const xe=this.workerSources[ne][ue];for(const De in xe)xe[De].availableImages=re}})}_syncRTLPluginState(ne,re){return y._(this,void 0,void 0,function*(){return yield y.cU.syncState(re,this.self.importScripts)})}_getAvailableImages(ne){let re=this.availableImages[ne];return re||(re=[]),re}_getLayerIndex(ne){let re=this.layerIndexes[ne];return re||(re=this.layerIndexes[ne]=new c),re}_getWorkerSource(ne,re,ue){if(this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][re]||(this.workerSources[ne][re]={}),!this.workerSources[ne][re][ue]){const xe={sendAsync:(De,je)=>(De.targetMapId=ne,this.actor.sendAsync(De,je))};switch(re){case"vector":this.workerSources[ne][re][ue]=new X(xe,this._getLayerIndex(ne),this._getAvailableImages(ne));break;case"geojson":this.workerSources[ne][re][ue]=new vu(xe,this._getLayerIndex(ne),this._getAvailableImages(ne));break;default:this.workerSources[ne][re][ue]=new this.externalWorkerSourceTypes[re](xe,this._getLayerIndex(ne),this._getAvailableImages(ne))}}return this.workerSources[ne][re][ue]}_getDEMWorkerSource(ne,re){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][re]||(this.demWorkerSources[ne][re]=new G),this.demWorkerSources[ne][re]}}return y.i(self)&&(self.worker=new ao(self)),ao}),d("index",["exports","./shared"],function(y,c){var P="5.6.0";function k(){var b=new c.A(4);return c.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let B,X;const G={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,n,l){const p=requestAnimationFrame(w=>{_(),n(w)}),{unsubscribe:_}=c.s(b.signal,"abort",()=>{_(),cancelAnimationFrame(p),l(c.c())},!1)},frameAsync(b){return new Promise((n,l)=>{this.frame(b,n,l)})},getImageData(b,n=0){return this.getImageCanvasContext(b).getImageData(-n,-n,b.width+2*n,b.height+2*n)},getImageCanvasContext(b){const n=window.document.createElement("canvas"),l=n.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return n.width=b.width,n.height=b.height,l.drawImage(b,0,0,b.width,b.height),l},resolveURL:b=>(B||(B=document.createElement("a")),B.href=b,B.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(X==null&&(X=matchMedia("(prefers-reduced-motion: reduce)")),X.matches)}};class W{static testProp(n){if(!W.docStyle)return n[0];for(let l=0;l<n.length;l++)if(n[l]in W.docStyle)return n[l];return n[0]}static create(n,l,p){const _=window.document.createElement(n);return l!==void 0&&(_.className=l),p&&p.appendChild(_),_}static createNS(n,l){return window.document.createElementNS(n,l)}static disableDrag(){W.docStyle&&W.selectProp&&(W.userSelect=W.docStyle[W.selectProp],W.docStyle[W.selectProp]="none")}static enableDrag(){W.docStyle&&W.selectProp&&(W.docStyle[W.selectProp]=W.userSelect)}static setTransform(n,l){n.style[W.transformProp]=l}static addEventListener(n,l,p,_={}){n.addEventListener(l,p,"passive"in _?_:_.capture)}static removeEventListener(n,l,p,_={}){n.removeEventListener(l,p,"passive"in _?_:_.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",W.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",W.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",W.suppressClickInternal,!0)},0)}static getScale(n){const l=n.getBoundingClientRect();return{x:l.width/n.offsetWidth||1,y:l.height/n.offsetHeight||1,boundingClientRect:l}}static getPoint(n,l,p){const _=l.boundingClientRect;return new c.P((p.clientX-_.left)/l.x-n.clientLeft,(p.clientY-_.top)/l.y-n.clientTop)}static mousePos(n,l){const p=W.getScale(n);return W.getPoint(n,p,l)}static touchPos(n,l){const p=[],_=W.getScale(n);for(let w=0;w<l.length;w++)p.push(W.getPoint(n,_,l[w]));return p}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}static sanitize(n){const l=new DOMParser().parseFromString(n,"text/html").body||document.createElement("body"),p=l.querySelectorAll("script");for(const _ of p)_.remove();return W.clean(l),l.innerHTML}static isPossiblyDangerous(n,l){const p=l.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(n)||!p.includes("javascript:")&&!p.includes("data:"))||!!n.startsWith("on")||void 0}static clean(n){const l=n.children;for(const p of l)W.removeAttributes(p),W.clean(p)}static removeAttributes(n){for(const{name:l,value:p}of n.attributes)W.isPossiblyDangerous(l,p)&&n.removeAttribute(l)}}W.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,W.selectProp=W.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),W.transformProp=W.testProp(["transform","WebkitTransform"]);const ie={supported:!1,testSupport:function(b){!Oe&&Re&&(Ke?mt(b):Ie=b)}};let Ie,Re,Oe=!1,Ke=!1;function mt(b){const n=b.createTexture();b.bindTexture(b.TEXTURE_2D,n);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,Re),b.isContextLost())return;ie.supported=!0}catch{}b.deleteTexture(n),Oe=!0}var qe;typeof document<"u"&&(Re=document.createElement("img"),Re.onload=()=>{Ie&&mt(Ie),Ie=null,Ke=!0},Re.onerror=()=>{Oe=!0,Ie=null},Re.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let n,l,p,_;b.resetRequestQueue=()=>{n=[],l=0,p=0,_={}},b.addThrottleControl=D=>{const O=p++;return _[O]=D,O},b.removeThrottleControl=D=>{delete _[D],E()},b.getImage=(D,O,V=!0)=>new Promise(($,j)=>{ie.supported&&(D.headers||(D.headers={}),D.headers.accept="image/webp,*/*"),c.e(D,{type:"image"}),n.push({abortController:O,requestParameters:D,supportImageRefresh:V,state:"queued",onError:H=>{j(H)},onSuccess:H=>{$(H)}}),E()});const w=D=>c._(this,void 0,void 0,function*(){D.state="running";const{requestParameters:O,supportImageRefresh:V,onError:$,onSuccess:j,abortController:H}=D,ee=V===!1&&!c.i(self)&&!c.g(O.url)&&(!O.headers||Object.keys(O.headers).reduce((fe,ye)=>fe&&ye==="accept",!0));l++;const de=ee?M(O,H):c.m(O,H);try{const fe=yield de;delete D.abortController,D.state="completed",fe.data instanceof HTMLImageElement||c.b(fe.data)?j(fe):fe.data&&j({data:yield(he=fe.data,typeof createImageBitmap=="function"?c.f(he):c.h(he)),cacheControl:fe.cacheControl,expires:fe.expires})}catch(fe){delete D.abortController,$(fe)}finally{l--,E()}var he}),E=()=>{const D=(()=>{for(const O of Object.keys(_))if(_[O]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let O=l;O<D&&n.length>0;O++){const V=n.shift();V.abortController.signal.aborted?O--:w(V)}},M=(D,O)=>new Promise((V,$)=>{const j=new Image,H=D.url,ee=D.credentials;ee&&ee==="include"?j.crossOrigin="use-credentials":(ee&&ee==="same-origin"||!c.d(H))&&(j.crossOrigin="anonymous"),O.signal.addEventListener("abort",()=>{j.src="",$(c.c())}),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,V({data:j})},j.onerror=()=>{j.onerror=j.onload=null,O.signal.aborted||$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=H})}(qe||(qe={})),qe.resetRequestQueue();class Fe{constructor(n){this._transformRequestFn=n}transformRequest(n,l){return this._transformRequestFn&&this._transformRequestFn(n,l)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function We(b){const n=[];if(typeof b=="string")n.push({id:"default",url:b});else if(b&&b.length>0){const l=[];for(const{id:p,url:_}of b){const w=`${p}${_}`;l.indexOf(w)===-1&&(l.push(w),n.push({id:p,url:_}))}}return n}function pe(b,n,l){try{const p=new URL(b);return p.pathname+=`${n}${l}`,p.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function oe(b){const{userImage:n}=b;return!!(n&&n.render&&n.render())&&(b.data.replace(new Uint8Array(n.data.buffer)),!0)}class me extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:l,promiseResolve:p}of this.requestors)p(this._getImagesForIds(l));this.requestors=[]}}getImage(n){const l=this.images[n];if(l&&!l.data&&l.spriteData){const p=l.spriteData;l.data=new c.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),l.spriteData=null}return l}addImage(n,l){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,l)&&(this.images[n]=l)}_validate(n,l){let p=!0;const _=l.data||l.spriteData;return this._validateStretch(l.stretchX,_&&_.width)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,_&&_.height)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "content" value`))),p=!1),p}_validateStretch(n,l){if(!n)return!0;let p=0;for(const _ of n){if(_[0]<p||_[1]<_[0]||l<_[1])return!1;p=_[1]}return!0}_validateContent(n,l){if(!n)return!0;if(n.length!==4)return!1;const p=l.spriteData,_=p&&p.width||l.data.width,w=p&&p.height||l.data.height;return!(n[0]<0||_<n[0]||n[1]<0||w<n[1]||n[2]<0||_<n[2]||n[3]<0||w<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,l,p=!0){const _=this.getImage(n);if(p&&(_.data.width!==l.data.width||_.data.height!==l.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${l.data.width}x${l.data.height}).`);l.version=_.version+1,this.images[n]=l,this.updatedImages[n]=!0}removeImage(n){const l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((l,p)=>{let _=!0;if(!this.isLoaded())for(const w of n)this.images[w]||(_=!1);this.isLoaded()||_?l(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:l})})}_getImagesForIds(n){const l={};for(const p of n){let _=this.getImage(p);_||(this.fire(new c.l("styleimagemissing",{id:p})),_=this.getImage(p)),_?l[p]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,textFitWidth:_.textFitWidth,textFitHeight:_.textFitHeight,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:c.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return l}getPixelSize(){const{width:n,height:l}=this.atlasImage;return{width:n,height:l}}getPattern(n){const l=this.patterns[n],p=this.getImage(n);if(!p)return null;if(l&&l.position.version===p.version)return l.position;if(l)l.position.version=p.version;else{const _={w:p.data.width+2,h:p.data.height+2,x:0,y:0},w=new c.I(_,p);this.patterns[n]={bin:_,position:w}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const w in this.patterns)n.push(this.patterns[w].bin);const{w:l,h:p}=c.p(n),_=this.atlasImage;_.resize({width:l||1,height:p||1});for(const w in this.patterns){const{bin:E}=this.patterns[w],M=E.x+1,D=E.y+1,O=this.getImage(w).data,V=O.width,$=O.height;c.R.copy(O,_,{x:0,y:0},{x:M,y:D},{width:V,height:$}),c.R.copy(O,_,{x:0,y:$-1},{x:M,y:D-1},{width:V,height:1}),c.R.copy(O,_,{x:0,y:0},{x:M,y:D+$},{width:V,height:1}),c.R.copy(O,_,{x:V-1,y:0},{x:M-1,y:D},{width:1,height:$}),c.R.copy(O,_,{x:0,y:0},{x:M+V,y:D},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const l of n){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const p=this.getImage(l);p||c.w(`Image with ID: "${l}" was not found`),oe(p)&&this.updateImage(l,p)}}}const be=1e20;function Ce(b,n,l,p,_,w,E,M,D){for(let O=n;O<n+p;O++)Ve(b,l*w+O,w,_,E,M,D);for(let O=l;O<l+_;O++)Ve(b,O*w+n,1,p,E,M,D)}function Ve(b,n,l,p,_,w,E){w[0]=0,E[0]=-1e20,E[1]=be,_[0]=b[n];for(let M=1,D=0,O=0;M<p;M++){_[M]=b[n+M*l];const V=M*M;do{const $=w[D];O=(_[M]-_[$]+V-$*$)/(M-$)/2}while(O<=E[D]&&--D>-1);D++,w[D]=M,E[D]=O,E[D+1]=be}for(let M=0,D=0;M<p;M++){for(;E[D+1]<M;)D++;const O=w[D],V=M-O;b[n+M*l]=_[O]+V*V}}class Ee{constructor(n,l){this.requestManager=n,this.localIdeographFontFamily=l,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return c._(this,void 0,void 0,function*(){const l=[];for(const w in n)for(const E of n[w])l.push(this._getAndCacheGlyphsPromise(w,E));const p=yield Promise.all(l),_={};for(const{stack:w,id:E,glyph:M}of p)_[w]||(_[w]={}),_[w][E]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};return _})}_getAndCacheGlyphsPromise(n,l){return c._(this,void 0,void 0,function*(){let p=this.entries[n];p||(p=this.entries[n]={glyphs:{},requests:{},ranges:{}});let _=p.glyphs[l];if(_!==void 0)return{stack:n,id:l,glyph:_};if(_=this._tinySDF(p,n,l),_)return p.glyphs[l]=_,{stack:n,id:l,glyph:_};const w=Math.floor(l/256);if(256*w>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[w])return{stack:n,id:l,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[w]){const M=Ee.loadGlyphRange(n,w,this.url,this.requestManager);p.requests[w]=M}const E=yield p.requests[w];for(const M in E)this._doesCharSupportLocalGlyph(+M)||(p.glyphs[+M]=E[+M]);return p.ranges[w]=!0,{stack:n,id:l,glyph:E[l]||null}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))||c.u["CJK Unified Ideographs"](n)||c.u["Hangul Syllables"](n)||c.u.Hiragana(n)||c.u.Katakana(n)||c.u["CJK Symbols and Punctuation"](n)||c.u["Halfwidth and Fullwidth Forms"](n))}_tinySDF(n,l,p){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(p))return;let w=n.tinySDF;if(!w){let M="400";/bold/i.test(l)?M="900":/medium/i.test(l)?M="500":/light/i.test(l)&&(M="200"),w=n.tinySDF=new Ee.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:_,fontWeight:M})}const E=w.draw(String.fromCharCode(p));return{id:p,bitmap:new c.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ee.loadGlyphRange=function(b,n,l,p){return c._(this,void 0,void 0,function*(){const _=256*n,w=_+255,E=p.transformRequest(l.replace("{fontstack}",b).replace("{range}",`${_}-${w}`),"Glyphs"),M=yield c.n(E,new AbortController);if(!M||!M.data)throw new Error(`Could not load glyph range. range: ${n}, ${_}-${w}`);const D={};for(const O of c.o(M.data))D[O.id]=O;return D})},Ee.TinySDF=class{constructor({fontSize:b=24,buffer:n=3,radius:l=8,cutoff:p=.25,fontFamily:_="sans-serif",fontWeight:w="normal",fontStyle:E="normal"}={}){this.buffer=n,this.cutoff=p,this.radius=l;const M=this.size=b+4*n,D=this._createCanvas(M),O=this.ctx=D.getContext("2d",{willReadFrequently:!0});O.font=`${E} ${w} ${b}px ${_}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(b){const n=document.createElement("canvas");return n.width=n.height=b,n}draw(b){const{width:n,actualBoundingBoxAscent:l,actualBoundingBoxDescent:p,actualBoundingBoxLeft:_,actualBoundingBoxRight:w}=this.ctx.measureText(b),E=Math.ceil(l),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-_))),D=Math.min(this.size-this.buffer,E+Math.ceil(p)),O=M+2*this.buffer,V=D+2*this.buffer,$=Math.max(O*V,0),j=new Uint8ClampedArray($),H={data:j,width:O,height:V,glyphWidth:M,glyphHeight:D,glyphTop:E,glyphLeft:0,glyphAdvance:n};if(M===0||D===0)return H;const{ctx:ee,buffer:de,gridInner:he,gridOuter:fe}=this;ee.clearRect(de,de,M,D),ee.fillText(b,de,de+E);const ye=ee.getImageData(de,de,M,D);fe.fill(be,0,$),he.fill(0,0,$);for(let Te=0;Te<D;Te++)for(let _e=0;_e<M;_e++){const Ae=ye.data[4*(Te*M+_e)+3]/255;if(Ae===0)continue;const Me=(Te+de)*O+_e+de;if(Ae===1)fe[Me]=0,he[Me]=be;else{const ve=.5-Ae;fe[Me]=ve>0?ve*ve:0,he[Me]=ve<0?ve*ve:0}}Ce(fe,0,0,O,V,O,this.f,this.v,this.z),Ce(he,de,de,M,D,O,this.f,this.v,this.z);for(let Te=0;Te<$;Te++){const _e=Math.sqrt(fe[Te])-Math.sqrt(he[Te]);j[Te]=Math.round(255-255*(_e/this.radius+this.cutoff))}return H}};class Yn{constructor(){this.specification=c.v.light.position}possiblyEvaluate(n,l){return c.B(n.expression.evaluate(l))}interpolate(n,l,p){return{x:c.C.number(n.x,l.x,p),y:c.C.number(n.y,l.y,p),z:c.C.number(n.z,l.z,p)}}}let jn;class gt extends c.E{constructor(n){super(),jn=jn||new c.r({anchor:new c.D(c.v.light.anchor),position:new Yn,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(jn),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,l={}){if(!this._validate(c.x,n,l))for(const p in n){const _=n[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,p){return(!p||p.validate!==!1)&&c.y(this,n.call(c.z,{value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const Bt=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class nn extends c.E{constructor(n){super(),this._transitionable=new c.t(Bt),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(n,l={}){if(!this._validate(c.G,n,l)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const p in n){const _=n[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,p={}){return(p==null?void 0:p.validate)!==!1&&c.y(this,n.call(c.z,c.e({value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class Kn{constructor(n,l){this.width=n,this.height=l,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,l){const p=n.join(",")+String(l);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(n,l)),this.dashEntry[p]}getDashRanges(n,l,p){const _=[];let w=n.length%2==1?-n[n.length-1]*p:0,E=n[0]*p,M=!0;_.push({left:w,right:E,isDash:M,zeroLength:n[0]===0});let D=n[0];for(let O=1;O<n.length;O++){M=!M;const V=n[O];w=D*p,D+=V,E=D*p,_.push({left:w,right:E,isDash:M,zeroLength:V===0})}return _}addRoundDash(n,l,p){const _=l/2;for(let w=-p;w<=p;w++){const E=this.width*(this.nextRow+p+w);let M=0,D=n[M];for(let O=0;O<this.width;O++){O/D.right>1&&(D=n[++M]);const V=Math.abs(O-D.left),$=Math.abs(O-D.right),j=Math.min(V,$);let H;const ee=w/p*(_+1);if(D.isDash){const de=_-Math.abs(ee);H=Math.sqrt(j*j+de*de)}else H=_-Math.sqrt(j*j+ee*ee);this.data[E+O]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(n){for(let M=n.length-1;M>=0;--M){const D=n[M],O=n[M+1];D.zeroLength?n.splice(M,1):O&&O.isDash===D.isDash&&(O.left=D.left,n.splice(M,1))}const l=n[0],p=n[n.length-1];l.isDash===p.isDash&&(l.left=p.left-this.width,p.right=l.right+this.width);const _=this.width*this.nextRow;let w=0,E=n[w];for(let M=0;M<this.width;M++){M/E.right>1&&(E=n[++w]);const D=Math.abs(M-E.left),O=Math.abs(M-E.right),V=Math.min(D,O);this.data[_+M]=Math.max(0,Math.min(255,(E.isDash?V:-V)+128))}}addDash(n,l){const p=l?7:0,_=2*p+1;if(this.nextRow+_>this.height)return c.w("LineAtlas out of space"),null;let w=0;for(let M=0;M<n.length;M++)w+=n[M];if(w!==0){const M=this.width/w,D=this.getDashRanges(n,this.width,M);l?this.addRoundDash(D,M,p):this.addRegularDash(D)}const E={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:w};return this.nextRow+=_,this.dirty=!0,E}bind(n){const l=n.gl;this.texture?(l.bindTexture(l.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,l.texSubImage2D(l.TEXTURE_2D,0,0,0,this.width,this.height,l.ALPHA,l.UNSIGNED_BYTE,this.data))):(this.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_2D,0,l.ALPHA,this.width,this.height,0,l.ALPHA,l.UNSIGNED_BYTE,this.data))}}const ze="maplibre_preloaded_worker_pool";class xt{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<xt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ze]}numActive(){return Object.keys(this.active).length}}const It=Math.floor(G.hardwareConcurrency/2);let Rt,Yt;function wn(){return Rt||(Rt=new xt),Rt}xt.workerCount=c.H(globalThis)?Math.max(Math.min(It,3),1):1;class fn{constructor(n,l){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=l;const p=this.workerPool.acquire(l);for(let _=0;_<p.length;_++){const w=new c.J(p[_],l);w.name=`Worker ${_}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,l){const p=[];for(const _ of this.actors)p.push(_.sendAsync({type:n,data:l}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(l=>{l.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,l){for(const p of this.actors)p.registerMessageHandler(n,l)}}function ii(){return Yt||(Yt=new fn(wn(),c.K),Yt.registerMessageHandler("GR",(b,n,l)=>c.m(n,l))),Yt}function wr(b,n){const l=c.L();return c.M(l,l,[1,1,0]),c.N(l,l,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?c.O(l,l,b.calculatePosMatrix(n.toUnwrapped())):l}function Ir(b,n,l,p,_,w,E){var M;const D=function(j,H,ee){if(j)for(const de of j){const he=H[de];if(he&&he.source===ee&&he.type==="fill-extrusion")return!0}else for(const de in H){const he=H[de];if(he.source===ee&&he.type==="fill-extrusion")return!0}return!1}((M=_==null?void 0:_.layers)!==null&&M!==void 0?M:null,n,b.id),O=w.maxPitchScaleFactor(),V=b.tilesIn(p,O,D);V.sort(ks);const $=[];for(const j of V)$.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(n,l,b._state,j.queryGeometry,j.cameraQueryGeometry,j.scale,_,w,O,wr(b.transform,j.tileID),E?(H,ee)=>E(j.tileID,H,ee):void 0)});return function(j,H){for(const ee in j)for(const de of j[ee])gi(de,H);return j}(function(j){const H={},ee={};for(const de of j){const he=de.queryResults,fe=de.wrappedTileID,ye=ee[fe]=ee[fe]||{};for(const Te in he){const _e=he[Te],Ae=ye[Te]=ye[Te]||{},Me=H[Te]=H[Te]||[];for(const ve of _e)Ae[ve.featureIndex]||(Ae[ve.featureIndex]=!0,Me.push(ve))}}return H}($),b)}function ks(b,n){const l=b.tileID,p=n.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function gi(b,n){const l=b.feature,p=n.getFeatureState(l.layer["source-layer"],l.id);l.source=l.layer.source,l.layer["source-layer"]&&(l.sourceLayer=l.layer["source-layer"]),l.state=p}function io(b,n,l){return c._(this,void 0,void 0,function*(){let p=b;if(b.url?p=(yield c.j(n.transformRequest(b.url,"Source"),l)).data:yield G.frameAsync(l),!p)return null;const _=c.Q(c.e(p,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(_.vectorLayerIds=p.vector_layers.map(w=>w.id)),_})}class Tr{constructor(n,l){n&&(l?this.setSouthWest(n).setNorthEast(l):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof c.S?new c.S(n.lng,n.lat):c.S.convert(n),this}setSouthWest(n){return this._sw=n instanceof c.S?new c.S(n.lng,n.lat):c.S.convert(n),this}extend(n){const l=this._sw,p=this._ne;let _,w;if(n instanceof c.S)_=n,w=n;else{if(!(n instanceof Tr))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Tr.convert(n)):this.extend(c.S.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(c.S.convert(n)):this;if(_=n._sw,w=n._ne,!_||!w)return this}return l||p?(l.lng=Math.min(_.lng,l.lng),l.lat=Math.min(_.lat,l.lat),p.lng=Math.max(w.lng,p.lng),p.lat=Math.max(w.lat,p.lat)):(this._sw=new c.S(_.lng,_.lat),this._ne=new c.S(w.lng,w.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:l,lat:p}=c.S.convert(n);let _=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(n){return n instanceof Tr?n:n&&new Tr(n)}static fromLngLat(n,l=0){const p=360*l/40075017,_=p/Math.cos(Math.PI/180*n.lat);return new Tr(new c.S(n.lng-_,n.lat-p),new c.S(n.lng+_,n.lat+p))}adjustAntiMeridian(){const n=new c.S(this._sw.lng,this._sw.lat),l=new c.S(this._ne.lng,this._ne.lat);return new Tr(n,n.lng>l.lng?new c.S(l.lng+360,l.lat):l)}}class ya{constructor(n,l,p){this.bounds=Tr.convert(this.validateBounds(n)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const l=Math.pow(2,n.z),p=Math.floor(c.V(this.bounds.getWest())*l),_=Math.floor(c.U(this.bounds.getNorth())*l),w=Math.ceil(c.V(this.bounds.getEast())*l),E=Math.ceil(c.U(this.bounds.getSouth())*l);return n.x>=p&&n.x<w&&n.y>=_&&n.y<E}}class _a extends c.E{constructor(n,l,p,_){if(super(),this.id=n,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(l,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield io(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(c.e(this,n),n.bounds&&(this.tileBounds=new ya(n.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new c.k(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(l,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};p.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((w,E)=>{n.reloadPromise={resolve:w,reject:E}})}else n.actor=this.dispatcher.getActor(),_="LT";n.abortController=new AbortController;try{const w=yield n.actor.sendAsync({type:_,data:p},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,w)}catch(w){if(delete n.abortController,n.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(n,null)}})}_afterTileLoadWorkerResponse(n,l){if(l&&l.resourceTiming&&(n.resourceTiming=l.resourceTiming),l&&this.map._refreshExpiredTiles&&n.setExpiryData(l),n.loadVectorData(l,this.map.painter),n.reloadPromise){const p=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(p.resolve).catch(p.reject)}}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class nl extends c.E{constructor(n,l,p,_){super(),this.id=n,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},l),c.e(this,c.Q(l,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(n=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield io(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,l&&(c.e(this,l),l.bounds&&(this.tileBounds=new ya(l.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:n})))}catch(l){this._tileJSONRequest=null,this.fire(new c.k(l))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load(!0)}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return c.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const p=yield qe.getImage(this.map._requestManager.transformRequest(l,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&n.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const _=this.map.painter.context,w=_.gl,E=p.data;n.texture=this.map.painter.getTileTexture(E.width),n.texture?n.texture.update(E,{useMipmap:!0}):(n.texture=new c.T(_,E,w.RGBA,{useMipmap:!0}),n.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(p){if(delete n.abortController,n.aborted)n.state="unloaded";else if(p)throw n.state="errored",p}})}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class Cr extends nl{constructor(n,l,p,_){super(n,l,p,_),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox",this.redFactor=l.redFactor,this.greenFactor=l.greenFactor,this.blueFactor=l.blueFactor,this.baseShift=l.baseShift}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(l,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const _=yield qe.getImage(p,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(_&&_.data){const w=_.data;this.map._refreshExpiredTiles&&(_.cacheControl||_.expires)&&n.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const E=c.b(w)&&c.W()?w:yield this.readImageNow(w),M={type:this.type,uid:n.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const D=yield n.actor.sendAsync({type:"LDT",data:M});n.dem=D,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(_){if(delete n.abortController,n.aborted)n.state="unloaded";else if(_)throw n.state="errored",_}})}readImageNow(n){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.X()){const l=n.width+2,p=n.height+2;try{return new c.R({width:l,height:p},yield c.Y(n,-1,-1,l,p))}catch{}}return G.getImageData(n,1)})}_getNeighboringTiles(n){const l=n.canonical,p=Math.pow(2,l.z),_=(l.x-1+p)%p,w=l.x===0?n.wrap-1:n.wrap,E=(l.x+1+p)%p,M=l.x+1===p?n.wrap+1:n.wrap,D={};return D[new c.Z(n.overscaledZ,w,l.z,_,l.y).key]={backfilled:!1},D[new c.Z(n.overscaledZ,M,l.z,E,l.y).key]={backfilled:!1},l.y>0&&(D[new c.Z(n.overscaledZ,w,l.z,_,l.y-1).key]={backfilled:!1},D[new c.Z(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},D[new c.Z(n.overscaledZ,M,l.z,E,l.y-1).key]={backfilled:!1}),l.y+1<p&&(D[new c.Z(n.overscaledZ,w,l.z,_,l.y+1).key]={backfilled:!1},D[new c.Z(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},D[new c.Z(n.overscaledZ,M,l.z,E,l.y+1).key]={backfilled:!1}),D}unloadTile(n){return c._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))})}}class za extends c.E{constructor(n,l,p,_){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(_),this._data=l.data,this._options=c.e({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId,l.clusterMaxZoom!==void 0&&this.maxzoom<=l.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${l.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(l.buffer!==void 0?l.buffer:128),tolerance:this._pixelsToTileUnits(l.tolerance!==void 0?l.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(l.clusterMaxZoom),minPoints:Math.max(2,l.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(l.clusterRadius||50),log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(n){return n*(c.$/this.tileSize)}_getClusterMaxZoom(n){const l=n?Math.round(n):this.maxzoom-1;return Number.isInteger(n)||n===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${n}" rounded to "${l}"`),l}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}getData(){return c._(this,void 0,void 0,function*(){const n=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})})}getCoordinatesFromGeometry(n){return n.type==="GeometryCollection"?n.geometries.map(l=>l.coordinates).flat(1/0):n.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,function*(){const n=new Tr,l=yield this.getData();let p;switch(l.type){case"FeatureCollection":p=l.features.map(_=>this.getCoordinatesFromGeometry(_.geometry)).flat(1/0);break;case"Feature":p=this.getCoordinatesFromGeometry(l.geometry);break;default:p=this.getCoordinatesFromGeometry(l)}if(p.length==0)return n;for(let _=0;_<p.length-1;_+=2)n.extend([p[_],p[_+1]]);return n})}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(n.clusterRadius)),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(n.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,l,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:l,offset:p}})}_updateWorkerData(n){return c._(this,void 0,void 0,function*(){const l=c.e({type:this.type},this.workerOptions);n?l.dataDiff=n:typeof this._data=="string"?(l.request=this.map._requestManager.transformRequest(G.resolveURL(this._data),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.l("dataloading",{dataType:"source"}));try{const p=yield this.actor.sendAsync({type:"LD",data:l});if(this._pendingLoads--,this._removed||p.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));let _=null;p.resourceTiming&&p.resourceTiming[this.id]&&(_=p.resourceTiming[this.id].slice(0));const w={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&c.e(w,{resourceTiming:_}),this.fire(new c.l("data",Object.assign(Object.assign({},w),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},w),{sourceDataType:"content"})))}catch(p){if(this._pendingLoads--,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(p))}})}loaded(){return this._pendingLoads===0}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.actor?"RT":"LT";n.actor=this.actor;const p={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};n.abortController=new AbortController;const _=yield this.actor.sendAsync({type:l,data:p},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(_,this.map.painter,l==="RT")})}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class na extends c.E{constructor(n,l,p,_){super(),this.flippedWindingOrder=!1,this.id=n,this.dispatcher=p,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=l}load(n){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const l=yield qe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,l&&l.data&&(this.image=l.data,n&&(this.coordinates=n),this._finishLoading())}catch(l){this._request=null,this._loaded=!0,this.fire(new c.k(l))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const l=n.map(c.a0.fromLngLat);var p;return this.tileID=function(_){const w=c.a1.fromPoints(_),E=w.width(),M=w.height(),D=Math.max(E,M),O=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),V=Math.pow(2,O);return new c.a3(O,Math.floor((w.minX+w.maxX)/2*V),Math.floor((w.minY+w.maxY)/2*V))}(l),this.terrainTileRanges=this._getOverlappingTileRanges(l),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=l.map(_=>this.tileID.getTilePoint(_)._round()),this.flippedWindingOrder=((p=this.tileCoords)[1].x-p[0].x)*(p[2].y-p[0].y)-(p[1].y-p[0].y)*(p[2].x-p[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,l=n.gl;this.texture||(this.texture=new c.T(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(n){const{minX:l,minY:p,maxX:_,maxY:w}=c.a1.fromPoints(n),E={};for(let M=0;M<=c.a2;M++){const D=Math.pow(2,M),O=Math.floor(l*D),V=Math.floor(p*D),$=Math.floor(_*D),j=Math.floor(w*D);E[M]={minTileX:O,minTileY:V,maxTileX:$,maxTileY:j}}return E}}class Ds extends na{constructor(n,l,p,_){super(n,l,p,_),this.roundZoom=!0,this.type="video",this.options=l}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const l of n.urls)this.urls.push(this.map._requestManager.transformRequest(l,"Source").url);try{const l=yield c.a4(this.urls);if(this._loaded=!0,!l)return;this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(l){this.fire(new c.k(l))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new c.k(new c.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,l=n.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Wa extends na{constructor(n,l,p,_){super(n,l,p,_),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(E=>typeof E!="number"))||this.fire(new c.k(new c.a5(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a5(`sources.${n}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new c.k(new c.a5(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a5(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a5(`sources.${n}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context,p=l.gl;this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(l,this.canvas,p.RGBA,{premultiply:!0});let _=!1;for(const w in this.tiles){const E=this.tiles[w];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,_=!0)}_&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const _u={},Ls=b=>{switch(b){case"geojson":return za;case"image":return na;case"raster":return nl;case"raster-dem":return Cr;case"vector":return _a;case"video":return Ds;case"canvas":return Wa}return _u[b]},os="RTLPluginLoaded";class Ro extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ii()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch(l=>{throw this.status="error",l})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return c._(this,arguments,void 0,function*(l,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=G.resolveURL(l),!this.url)throw new Error(`requested url ${l} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(os))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let fr=null;function zn(){return fr||(fr=new Ro),fr}class di{constructor(n,l){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=c.a6(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const l=n+this.timeAdded;l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,l,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(_,w){const E={};if(!w)return E;for(const M of _){const D=M.layerIds.map(O=>w.getLayer(O)).filter(Boolean);if(D.length!==0){M.layers=D,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(O=>D.filter(V=>V.id===O)[0]));for(const O of D)E[O.id]=M}}return E}(n.buckets,l==null?void 0:l.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof c.a8){if(this.hasSymbolBuckets=!0,!p)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof c.a8&&w.hasRTLText){this.hasRTLText=!0,zn().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const w=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(_).queryRadius(w))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new c.a7}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const p in this.buckets){const _=this.buckets[p];_.uploadPending()&&_.upload(n)}const l=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(n,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(n,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,l,p,_,w,E,M,D,O,V,$){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:w,scale:E,tileSize:this.tileSize,pixelPosMatrix:V,transform:D,params:M,queryPadding:this.queryPadding*O,getElevation:$},n,l,p):{}}querySourceFeatures(n,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const _=p.loadVTLayers(),w=l&&l.sourceLayer?l.sourceLayer:"",E=_._geojsonTileLayer||_[w];if(!E)return;const M=c.a9(l&&l.filter),{z:D,x:O,y:V}=this.tileID.canonical,$={z:D,x:O,y:V};for(let j=0;j<E.length;j++){const H=E.feature(j);if(M.needGeometry){const he=c.aa(H,!0);if(!M.filter(new c.F(this.tileID.overscaledZ),he,this.tileID.canonical))continue}else if(!M.filter(new c.F(this.tileID.overscaledZ),H))continue;const ee=p.getId(H,w),de=new c.ab(H,D,O,V,ee);de.tile=$,n.push(de)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const l=this.expirationTime;if(n.cacheControl){const p=c.ac(n.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const p=Date.now();let _=!1;if(this.expirationTime>p)_=!1;else if(l)if(this.expirationTime<l)_=!0;else{const w=this.expirationTime-l;w?this.expirationTime=p+Math.max(w,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!l.style.hasLayer(_))continue;const w=this.buckets[_],E=w.layers[0].sourceLayer||"_geojsonTileLayer",M=p[E],D=n[E];if(!M||!D||Object.keys(D).length===0)continue;w.update(D,M,this.imageAtlas&&this.imageAtlas.patternPositions||{});const O=l&&l.style&&l.style.getLayer(_);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<G.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=G.now()+n}setDependencies(n,l){const p={};for(const _ of l)p[_]=!0;this.dependencies[n]=p}hasDependency(n,l){for(const p of n){const _=this.dependencies[p];if(_){for(const w of l)if(_[w])return!0}}return!1}}class Ri{constructor(n,l){this.max=n,this.onRemove=l,this.reset()}reset(){for(const n in this.data)for(const l of this.data[n])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(n,l,p){const _=n.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const w={value:l,timeout:void 0};if(p!==void 0&&(w.timeout=setTimeout(()=>{this.remove(n,w)},p)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const l=this.data[n].shift();return l.timeout&&clearTimeout(l.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),l.value}getByKey(n){const l=this.data[n];return l?l[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,l){if(!this.has(n))return this;const p=n.wrapped().key,_=l===void 0?0:this.data[p].indexOf(l),w=this.data[p][_];return this.data[p].splice(_,1),w.timeout&&clearTimeout(w.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(w.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(n){const l=[];for(const p in this.data)for(const _ of this.data[p])n(_.value)||l.push(_);for(const p of l)this.remove(p.value.tileID,p)}}class vu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,l,p){const _=String(l);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][_]=this.stateChanges[n][_]||{},c.e(this.stateChanges[n][_],p),this.deletedStates[n]===null){this.deletedStates[n]={};for(const w in this.state[n])w!==_&&(this.deletedStates[n][w]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][_]===null){this.deletedStates[n][_]={};for(const w in this.state[n][_])p[w]||(this.deletedStates[n][_][w]=null)}else for(const w in p)this.deletedStates[n]&&this.deletedStates[n][_]&&this.deletedStates[n][_][w]===null&&delete this.deletedStates[n][_][w]}removeFeatureState(n,l,p){if(this.deletedStates[n]===null)return;const _=String(l);if(this.deletedStates[n]=this.deletedStates[n]||{},p&&l!==void 0)this.deletedStates[n][_]!==null&&(this.deletedStates[n][_]=this.deletedStates[n][_]||{},this.deletedStates[n][_][p]=null);else if(l!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][_])for(p in this.deletedStates[n][_]={},this.stateChanges[n][_])this.deletedStates[n][_][p]=null;else this.deletedStates[n][_]=null;else this.deletedStates[n]=null}getState(n,l){const p=String(l),_=c.e({},(this.state[n]||{})[p],(this.stateChanges[n]||{})[p]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const w=this.deletedStates[n][l];if(w===null)return{};for(const E in w)delete _[E]}return _}initializeTileState(n,l){n.setFeatureState(this.state,l)}coalesceChanges(n,l){const p={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const w={};for(const E in this.stateChanges[_])this.state[_][E]||(this.state[_][E]={}),c.e(this.state[_][E],this.stateChanges[_][E]),w[E]=this.state[_][E];p[_]=w}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const w={};if(this.deletedStates[_]===null)for(const E in this.state[_])w[E]={},this.state[_][E]={};else for(const E in this.deletedStates[_]){if(this.deletedStates[_][E]===null)this.state[_][E]={};else for(const M of Object.keys(this.deletedStates[_][E]))delete this.state[_][E][M];w[E]=this.state[_][E]}p[_]=p[_]||{},c.e(p[_],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const _ in n)n[_].setFeatureState(p,l)}}const ao=89.25;function $e(b,n){const l=c.ag(n.lat,-85.051129,c.ah);return new c.P(c.V(n.lng)*b,c.U(l)*b)}function ne(b,n){return new c.a0(n.x/b,n.y/b).toLngLat()}function re(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(c.ad(90-b.pitch)),Math.tan(c.ad(ao-b.pitch)))}function ue(b,n){const l=b.canonical,p=n/c.ae(l.z),_=l.x+Math.pow(2,l.z)*b.wrap,w=c.af(new Float64Array(16));return c.M(w,w,[_*p,l.y*p,0]),c.N(w,w,[p/c.$,p/c.$,1]),w}function xe(b,n,l,p,_){const w=c.a0.fromLngLat(b,n),E=_*c.ai(1,b.lat),M=E*Math.cos(c.ad(l)),D=Math.sqrt(E*E-M*M),O=D*Math.sin(c.ad(-p)),V=D*Math.cos(c.ad(-p));return new c.a0(w.x+O,w.y+V,w.z+M)}function De(b,n,l){const p=n.intersectsFrustum(b);if(!l||p===0)return p;const _=n.intersectsPlane(l);return _===0?0:p===2&&_===2?2:1}function je(b,n,l){let p=0;const _=(l-n)/10;for(let w=0;w<10;w++)p+=_*Math.pow(Math.cos(n+(w+.5)/10*(l-n)),b);return p}function Je(b,n){return function(l,p,_,w,E){const M=2*((b-1)/c.aj(Math.cos(c.ad(ao-E))/Math.cos(c.ad(ao)))-1),D=Math.acos(_/w),O=2*je(M-1,0,c.ad(E/2)),V=Math.min(c.ad(ao),D+c.ad(E/2)),$=je(M-1,Math.min(V,D-c.ad(E/2)),V),j=Math.atan(p/_),H=Math.hypot(p,_);let ee=l;return ee+=c.aj(w/H/Math.max(.5,Math.cos(c.ad(E/2)))),ee+=M*c.aj(Math.cos(j))/2,ee-=c.aj(Math.max(1,$/O/n))/2,ee}}const Be=Je(9.314,3);function lt(b,n){const l=(n.roundZoom?Math.round:Math.floor)(b.zoom+c.aj(b.tileSize/n.tileSize));return Math.max(0,l)}function it(b,n){const l=b.getCameraFrustum(),p=b.getClippingPlane(),_=b.screenPointToMercatorCoordinate(b.getCameraPoint()),w=c.a0.fromLngLat(b.center,b.elevation);_.z=w.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const E=b.getCoveringTilesDetailsProvider(),M=E.allowVariableZoom(b,n),D=lt(b,n),O=n.minzoom||0,V=n.maxzoom!==void 0?n.maxzoom:b.maxZoom,$=Math.min(Math.max(0,D),V),j=Math.pow(2,$),H=[j*_.x,j*_.y,0],ee=[j*w.x,j*w.y,0],de=Math.hypot(w.x-_.x,w.y-_.y),he=Math.abs(w.z-_.z),fe=Math.hypot(de,he),ye=Ae=>({zoom:0,x:0,y:0,wrap:Ae,fullyVisible:!1}),Te=[],_e=[];if(b.renderWorldCopies&&E.allowWorldCopies())for(let Ae=1;Ae<=3;Ae++)Te.push(ye(-Ae)),Te.push(ye(Ae));for(Te.push(ye(0));Te.length>0;){const Ae=Te.pop(),Me=Ae.x,ve=Ae.y;let Ne=Ae.fullyVisible;const tt={x:Me,y:ve,z:Ae.zoom},Xe=E.getTileBoundingVolume(tt,Ae.wrap,b.elevation,n);if(!Ne){const kt=De(l,Xe,p);if(kt===0)continue;Ne=kt===2}const Ye=E.distanceToTile2d(_.x,_.y,tt,Xe);let at=D;M&&(at=(n.calculateTileZoom||Be)(b.zoom+c.aj(b.tileSize/n.tileSize),Ye,he,fe,b.fov)),at=(n.roundZoom?Math.round:Math.floor)(at),at=Math.max(0,at);const Dt=Math.min(at,V);if(Ae.wrap=E.getWrap(w,tt,Ae.wrap),Ae.zoom>=Dt){if(Ae.zoom<O)continue;const kt=$-Ae.zoom,vt=H[0]-.5-(Me<<kt),qt=H[1]-.5-(ve<<kt),An=n.reparseOverscaled?Math.max(Ae.zoom,at):Ae.zoom;_e.push({tileID:new c.Z(Ae.zoom===V?An:Ae.zoom,Ae.wrap,Ae.zoom,Me,ve),distanceSq:c.ak([ee[0]-.5-Me,ee[1]-.5-ve]),tileDistanceToCamera:Math.sqrt(vt*vt+qt*qt)})}else for(let kt=0;kt<4;kt++)Te.push({zoom:Ae.zoom+1,x:(Me<<1)+kt%2,y:(ve<<1)+(kt>>1),wrap:Ae.wrap,fullyVisible:Ne})}return _e.sort((Ae,Me)=>Ae.distanceSq-Me.distanceSq).map(Ae=>Ae.tileID)}const Ge=c.a1.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class ft extends c.E{constructor(n,l,p){super(),this.id=n,this.dispatcher=p,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,w,E,M)=>{const D=new(Ls(w.type))(_,w,E,M);if(D.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${D.id}`);return D})(n,l,p,this),this._tiles={},this._cache=new Ri(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new vu,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,l,p){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,l,p)}catch(_){n.state="errored",_.status!==404?this._source.fire(new c.k(_,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new c.l("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(n),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(ke).map(n=>n.key)}getRenderableIds(n){const l=[];for(const p in this._tiles)this._isIdRenderable(p,n)&&l.push(this._tiles[p]);return n?l.sort((p,_)=>{const w=p.tileID,E=_.tileID,M=new c.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians),D=new c.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return w.overscaledZ-E.overscaledZ||D.y-M.y||D.x-M.x}).map(p=>p.tileID.key):l.map(p=>p.tileID).sort(ke).map(p=>p.key)}hasRenderableParent(n){const l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())}reload(n){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)n?this._reloadTile(l,"expired"):this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(n,l){return c._(this,void 0,void 0,function*(){const p=this._tiles[n];p&&(p.state!=="loading"&&(p.state=l),yield this._loadTile(p,n,l))})}_tileLoaded(n,l,p){n.timeAdded=G.now(),p==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const l=this.getRenderableIds();for(let _=0;_<l.length;_++){const w=l[_];if(n.neighboringTiles&&n.neighboringTiles[w]){const E=this.getTileByID(w);p(n,E),p(E,n)}}function p(_,w){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let E=w.tileID.canonical.x-_.tileID.canonical.x;const M=w.tileID.canonical.y-_.tileID.canonical.y,D=Math.pow(2,_.tileID.canonical.z),O=w.tileID.key;E===0&&M===0||Math.abs(M)>1||(Math.abs(E)>1&&(Math.abs(E+D)===1?E+=D:Math.abs(E-D)===1&&(E-=D)),w.dem&&_.dem&&(_.dem.backfillBorder(w.dem,E,M),_.neighboringTiles&&_.neighboringTiles[O]&&(_.neighboringTiles[O].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,l,p,_){for(const w in this._tiles){let E=this._tiles[w];if(_[w]||!E.hasData()||E.tileID.overscaledZ<=l||E.tileID.overscaledZ>p)continue;let M=E.tileID;for(;E&&E.tileID.overscaledZ>l+1;){const O=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[O.key],E&&E.hasData()&&(M=O)}let D=M;for(;D.overscaledZ>l;)if(D=D.scaledTo(D.overscaledZ-1),n[D.key]||n[D.canonical.key]){_[M.key]=M;break}}}findLoadedParent(n,l){if(n.key in this._loadedParentTiles){const p=this._loadedParentTiles[n.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=n.overscaledZ-1;p>=l;p--){const _=n.scaledTo(p),w=this._getLoadedTile(_);if(w)return w}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const l=Math.ceil(n.width/this._source.tileSize)+1,p=Math.ceil(n.height/this._source.tileSize)+1,_=Math.floor(l*p*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(w)}handleWrapJump(n){const l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){const p={};for(const _ in this._tiles){const w=this._tiles[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),p[w.tileID.key]=w}this._tiles=p;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}_updateCoveredAndRetainedTiles(n,l,p,_,w,E){const M={},D={},O=Object.keys(n),V=G.now();for(const $ of O){const j=n[$],H=this._tiles[$];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=V)continue;const ee=this.findLoadedParent(j,l),de=this.findLoadedSibling(j),he=ee||de||null;he&&(this._addTile(he.tileID),M[he.tileID.key]=he.tileID),D[$]=j}this._retainLoadedChildren(D,_,p,n);for(const $ in M)n[$]||(this._coveredTiles[$]=!0,n[$]=M[$]);if(E){const $={},j={};for(const H of w)this._tiles[H.key].hasData()?$[H.key]=H:j[H.key]=H;for(const H in j){const ee=j[H].children(this._source.maxzoom);this._tiles[ee[0].key]&&this._tiles[ee[1].key]&&this._tiles[ee[2].key]&&this._tiles[ee[3].key]&&($[ee[0].key]=n[ee[0].key]=ee[0],$[ee[1].key]=n[ee[1].key]=ee[1],$[ee[2].key]=n[ee[2].key]=ee[2],$[ee[3].key]=n[ee[3].key]=ee[3],delete j[H])}for(const H in j){const ee=j[H],de=this.findLoadedParent(ee,this._source.minzoom),he=this.findLoadedSibling(ee),fe=de||he||null;if(fe){$[fe.tileID.key]=n[fe.tileID.key]=fe.tileID;for(const ye in $)$[ye].isChildOf(fe.tileID)&&delete $[ye]}}for(const H in this._tiles)$[H]||(this._coveredTiles[H]=!0)}}update(n,l){if(!this._sourceLoaded||this._paused)return;let p;this.transform=n,this.terrain=l,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(V=>new c.Z(V.canonical.z,V.wrap,V.canonical.z,V.canonical.x,V.canonical.y)):(p=it(n,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:l,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(p=p.filter(V=>this._source.hasTile(V)))):p=[];const _=lt(n,this._source),w=Math.max(_-ft.maxOverzooming,this._source.minzoom),E=Math.max(_+ft.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const V={};for(const $ of p)if($.canonical.z>this._source.minzoom){const j=$.scaledTo($.canonical.z-1);V[j.key]=j;const H=$.scaledTo(Math.max(this._source.minzoom,Math.min($.canonical.z,5)));V[H.key]=H}p=p.concat(Object.values(V))}const M=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,M&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const D=this._updateRetainedTiles(p,_);Lt(this._source.type)&&this._updateCoveredAndRetainedTiles(D,w,E,_,p,l);for(const V in D)this._tiles[V].clearFadeHold();const O=c.al(this._tiles,D);for(const V of O){const $=this._tiles[V];$.hasSymbolBuckets&&!$.holdingForFade()?$.setHoldDuration(this.map._fadeDuration):$.hasSymbolBuckets&&!$.symbolFadeFinished()||this._removeTile(V)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,l){var p;const _={},w={},E=Math.max(l-ft.maxOverzooming,this._source.minzoom),M=Math.max(l+ft.maxUnderzooming,this._source.minzoom),D={};for(const O of n){const V=this._addTile(O);_[O.key]=O,V.hasData()||l<this._source.maxzoom&&(D[O.key]=O)}this._retainLoadedChildren(D,l,M,_);for(const O of n){let V=this._tiles[O.key];if(V.hasData())continue;if(l+1>this._source.maxzoom){const j=O.children(this._source.maxzoom)[0],H=this.getTile(j);if(H&&H.hasData()){_[j.key]=j;continue}}else{const j=O.children(this._source.maxzoom);if(_[j[0].key]&&_[j[1].key]&&_[j[2].key]&&_[j[3].key])continue}let $=V.wasRequested();for(let j=O.overscaledZ-1;j>=E;--j){const H=O.scaledTo(j);if(w[H.key])break;if(w[H.key]=!0,V=this.getTile(H),!V&&$&&(V=this._addTile(H)),V){const ee=V.hasData();if((ee||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||$)&&(_[H.key]=H),$=V.wasRequested(),ee)break}}}return _}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const l=[];let p,_=this._tiles[n].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){p=this._loadedParentTiles[_.key];break}l.push(_.key);const w=_.scaledTo(_.overscaledZ-1);if(p=this._getLoadedTile(w),p)break;_=w}for(const w of l)this._loadedParentTiles[w]=p}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const l=this._tiles[n].tileID,p=this._getLoadedTile(l);this._loadedSiblingTiles[l.key]=p}}_addTile(n){let l=this._tiles[n.key];if(l)return l;l=this._cache.getAndRemove(n),l&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));const p=l;return l||(l=new di(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,n.key,l.state)),l.uses++,this._tiles[n.key]=l,p||this._source.fire(new c.l("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l}_setTileReloadTimer(n,l){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const p=l.getExpiryTimeout();p&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},p))}refreshTiles(n){for(const l in this._tiles)(this._isIdRenderable(l)||this._tiles[l].state=="errored")&&n.some(p=>p.equals(this._tiles[l].tileID.canonical))&&this._reloadTile(l,"expired")}_removeTile(n){const l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}_dataHandler(n){const l=n.sourceDataType;n.dataType==="source"&&l==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&l==="content"&&(this.reload(n.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,l,p){const _=[],w=this.transform;if(!w)return _;const E=w.getCoveringTilesDetailsProvider().allowWorldCopies(),M=p?w.getCameraQueryGeometry(n):n,D=H=>w.screenPointToMercatorCoordinate(H,this.terrain),O=this.transformBbox(n,D,!E),V=this.transformBbox(M,D,!E),$=this.getIds(),j=c.a1.fromPoints(V);for(let H=0;H<$.length;H++){const ee=this._tiles[$[H]];if(ee.holdingForFade())continue;const de=E?[ee.tileID]:[ee.tileID.unwrapTo(-1),ee.tileID.unwrapTo(0)],he=Math.pow(2,w.zoom-ee.tileID.overscaledZ),fe=l*ee.queryPadding*c.$/ee.tileSize/he;for(const ye of de){const Te=j.map(_e=>ye.getTilePoint(new c.a0(_e.x,_e.y)));if(Te.expandBy(fe),Te.intersects(Ge)){const _e=O.map(Me=>ye.getTilePoint(Me)),Ae=V.map(Me=>ye.getTilePoint(Me));_.push({tile:ee,tileID:E?ye:ye.unwrapTo(0),queryGeometry:_e,cameraQueryGeometry:Ae,scale:he})}}}return _}transformBbox(n,l,p){let _=n.map(l);if(p){const w=c.a1.fromPoints(n);w.shrinkBy(.001*Math.min(w.width(),w.height()));const E=w.map(l);c.a1.fromPoints(_).covers(E)||(_=_.map(M=>M.x>.5?new c.a0(M.x-1,M.y,M.z):M))}return _}getVisibleCoordinates(n){const l=this.getRenderableIds(n).map(p=>this._tiles[p].tileID);return this.transform&&this.transform.populateCache(l),l}hasTransition(){if(this._source.hasTransition())return!0;if(Lt(this._source.type)){const n=G.now();for(const l in this._tiles)if(this._tiles[l].fadeEndTime>=n)return!0}return!1}setFeatureState(n,l,p){this._state.updateState(n=n||"_geojsonTileLayer",l,p)}removeFeatureState(n,l,p){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,p)}getFeatureState(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)}setDependencies(n,l,p){const _=this._tiles[n];_&&_.setDependencies(l,p)}reloadTilesForDependencies(n,l){for(const p in this._tiles)this._tiles[p].hasDependency(n,l)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(n,l))}}function ke(b,n){const l=Math.abs(2*b.wrap)-+(b.wrap<0),p=Math.abs(2*n.wrap)-+(n.wrap<0);return b.overscaledZ-n.overscaledZ||p-l||n.canonical.y-b.canonical.y||n.canonical.x-b.canonical.x}function Lt(b){return b==="raster"||b==="image"||b==="video"}ft.maxOverzooming=10,ft.maxUnderzooming=3;class rn{constructor(n,l){this.reset(n,l)}reset(n,l){this.points=n||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=c.ag(n,0,1);let l=1,p=this._distances[l];const _=n*this.paddedLength+this.padding;for(;p<_&&l<this._distances.length;)p=this._distances[++l];const w=l-1,E=this._distances[w],M=p-E,D=M>0?(_-E)/M:0;return this.points[w].mult(1-D).add(this.points[l].mult(D))}}function Vt(b,n){let l=!0;return b==="always"||b!=="never"&&n!=="never"||(l=!1),l}class Kt{constructor(n,l,p){const _=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(n/p),this.yCellCount=Math.ceil(l/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)_.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=l,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,l,p,_,w){this._forEachCell(l,p,_,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(w)}insertCircle(n,l,p,_){this._forEachCell(l-_,p-_,l+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(l),this.circles.push(p),this.circles.push(_)}_insertBoxCell(n,l,p,_,w,E){this.boxCells[w].push(E)}_insertCircleCell(n,l,p,_,w,E){this.circleCells[w].push(E)}_query(n,l,p,_,w,E,M){if(p<0||n>this.width||_<0||l>this.height)return[];const D=[];if(n<=0&&l<=0&&this.width<=p&&this.height<=_){if(w)return[{key:null,x1:n,y1:l,x2:p,y2:_}];for(let O=0;O<this.boxKeys.length;O++)D.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const V=this.circles[3*O],$=this.circles[3*O+1],j=this.circles[3*O+2];D.push({key:this.circleKeys[O],x1:V-j,y1:$-j,x2:V+j,y2:$+j})}}else this._forEachCell(n,l,p,_,this._queryCell,D,{hitTest:w,overlapMode:E,seenUids:{box:{},circle:{}}},M);return D}query(n,l,p,_){return this._query(n,l,p,_,!1,null)}hitTest(n,l,p,_,w,E){return this._query(n,l,p,_,!0,w,E).length>0}hitTestCircle(n,l,p,_,w){const E=n-p,M=n+p,D=l-p,O=l+p;if(M<0||E>this.width||O<0||D>this.height)return!1;const V=[];return this._forEachCell(E,D,M,O,this._queryCellCircle,V,{hitTest:!0,overlapMode:_,circle:{x:n,y:l,radius:p},seenUids:{box:{},circle:{}}},w),V.length>0}_queryCell(n,l,p,_,w,E,M,D){const{seenUids:O,hitTest:V,overlapMode:$}=M,j=this.boxCells[w];if(j!==null){const ee=this.bboxes;for(const de of j)if(!O.box[de]){O.box[de]=!0;const he=4*de,fe=this.boxKeys[de];if(n<=ee[he+2]&&l<=ee[he+3]&&p>=ee[he+0]&&_>=ee[he+1]&&(!D||D(fe))&&(!V||!Vt($,fe.overlapMode))&&(E.push({key:fe,x1:ee[he],y1:ee[he+1],x2:ee[he+2],y2:ee[he+3]}),V))return!0}}const H=this.circleCells[w];if(H!==null){const ee=this.circles;for(const de of H)if(!O.circle[de]){O.circle[de]=!0;const he=3*de,fe=this.circleKeys[de];if(this._circleAndRectCollide(ee[he],ee[he+1],ee[he+2],n,l,p,_)&&(!D||D(fe))&&(!V||!Vt($,fe.overlapMode))){const ye=ee[he],Te=ee[he+1],_e=ee[he+2];if(E.push({key:fe,x1:ye-_e,y1:Te-_e,x2:ye+_e,y2:Te+_e}),V)return!0}}}return!1}_queryCellCircle(n,l,p,_,w,E,M,D){const{circle:O,seenUids:V,overlapMode:$}=M,j=this.boxCells[w];if(j!==null){const ee=this.bboxes;for(const de of j)if(!V.box[de]){V.box[de]=!0;const he=4*de,fe=this.boxKeys[de];if(this._circleAndRectCollide(O.x,O.y,O.radius,ee[he+0],ee[he+1],ee[he+2],ee[he+3])&&(!D||D(fe))&&!Vt($,fe.overlapMode))return E.push(!0),!0}}const H=this.circleCells[w];if(H!==null){const ee=this.circles;for(const de of H)if(!V.circle[de]){V.circle[de]=!0;const he=3*de,fe=this.circleKeys[de];if(this._circlesCollide(ee[he],ee[he+1],ee[he+2],O.x,O.y,O.radius)&&(!D||D(fe))&&!Vt($,fe.overlapMode))return E.push(!0),!0}}}_forEachCell(n,l,p,_,w,E,M,D){const O=this._convertToXCellCoord(n),V=this._convertToYCellCoord(l),$=this._convertToXCellCoord(p),j=this._convertToYCellCoord(_);for(let H=O;H<=$;H++)for(let ee=V;ee<=j;ee++)if(w.call(this,n,l,p,_,this.xCellCount*ee+H,E,M,D))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,l,p,_,w,E){const M=_-n,D=w-l,O=p+E;return O*O>M*M+D*D}_circleAndRectCollide(n,l,p,_,w,E,M){const D=(E-_)/2,O=Math.abs(n-(_+D));if(O>D+p)return!1;const V=(M-w)/2,$=Math.abs(l-(w+V));if($>V+p)return!1;if(O<=D||$<=V)return!0;const j=O-D,H=$-V;return j*j+H*H<=p*p}}function Ht(b,n,l){const p=c.L();if(!b){const{vecSouth:$,vecEast:j}=gn(n),H=k();H[0]=j[0],H[1]=j[1],H[2]=$[0],H[3]=$[1],_=H,(V=(E=(w=H)[0])*(O=w[3])-(D=w[2])*(M=w[1]))&&(_[0]=O*(V=1/V),_[1]=-M*V,_[2]=-D*V,_[3]=E*V),p[0]=H[0],p[1]=H[1],p[4]=H[2],p[5]=H[3]}var _,w,E,M,D,O,V;return c.N(p,p,[1/l,1/l,1]),p}function Tn(b,n,l,p){if(b){const _=c.L();if(!n){const{vecSouth:w,vecEast:E}=gn(l);_[0]=E[0],_[1]=E[1],_[4]=w[0],_[5]=w[1]}return c.N(_,_,[p,p,1]),_}return l.pixelsToClipSpaceMatrix}function gn(b){const n=Math.cos(b.rollInRadians),l=Math.sin(b.rollInRadians),p=Math.cos(b.pitchInRadians),_=Math.cos(b.bearingInRadians),w=Math.sin(b.bearingInRadians),E=c.aq();E[0]=-_*p*l-w*n,E[1]=-w*p*l+_*n;const M=c.ar(E);M<1e-9?c.as(E):c.at(E,E,1/M);const D=c.aq();D[0]=_*p*n-w*l,D[1]=w*p*n+_*l;const O=c.ar(D);return O<1e-9?c.as(D):c.at(D,D,1/O),{vecEast:D,vecSouth:E}}function Sn(b,n,l,p){let _;p?(_=[b,n,p(b,n),1],c.av(_,_,l)):(_=[b,n,0,1],ko(_,_,l));const w=_[3];return{point:new c.P(_[0]/w,_[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function on(b,n){return .5+b/n*.5}function Bn(b,n){return b.x>=-n[0]&&b.x<=n[0]&&b.y>=-n[1]&&b.y<=n[1]}function Wr(b,n,l,p,_,w,E,M,D,O,V,$,j){const H=l?b.textSizeData:b.iconSizeData,ee=c.am(H,n.transform.zoom),de=[256/n.width*2+1,256/n.height*2+1],he=l?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;he.clear();const fe=b.lineVertexArray,ye=l?b.text.placedSymbolArray:b.icon.placedSymbolArray,Te=n.transform.width/n.transform.height;let _e=!1;for(let Ae=0;Ae<ye.length;Ae++){const Me=ye.get(Ae);if(Me.hidden||Me.writingMode===c.an.vertical&&!_e){zs(Me.numGlyphs,he);continue}_e=!1;const ve=new c.P(Me.anchorX,Me.anchorY),Ne={getElevation:j,pitchedLabelPlaneMatrix:p,lineVertexArray:fe,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:n.transform,tileAnchorPoint:ve,unwrappedTileID:D,width:O,height:V,translation:$},tt=Qt(Me.anchorX,Me.anchorY,Ne);if(!Bn(tt.point,de)){zs(Me.numGlyphs,he);continue}const Xe=on(n.transform.cameraToCenterDistance,tt.signedDistanceFromCamera),Ye=c.ao(H,ee,Me),at=w?Ye*n.transform.getPitchedTextCorrection(Me.anchorX,Me.anchorY,D)/Xe:Ye*Xe,Dt=cr({projectionContext:Ne,pitchedLabelPlaneMatrixInverse:_,symbol:Me,fontSize:at,flip:!1,keepUpright:E,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:he,aspectRatio:Te,rotateToLine:M});_e=Dt.useVertical,(Dt.notEnoughRoom||_e||Dt.needsFlipping&&cr({projectionContext:Ne,pitchedLabelPlaneMatrixInverse:_,symbol:Me,fontSize:at,flip:!0,keepUpright:E,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:he,aspectRatio:Te,rotateToLine:M}).notEnoughRoom)&&zs(Me.numGlyphs,he)}l?b.text.dynamicLayoutVertexBuffer.updateData(he):b.icon.dynamicLayoutVertexBuffer.updateData(he)}function Pt(b,n,l,p,_,w,E,M){const D=w.glyphStartIndex+w.numGlyphs,O=w.lineStartIndex,V=w.lineStartIndex+w.lineLength,$=n.getoffsetX(w.glyphStartIndex),j=n.getoffsetX(D-1),H=ki(b*$,l,p,_,w.segment,O,V,M,E);if(!H)return null;const ee=ki(b*j,l,p,_,w.segment,O,V,M,E);return ee?M.projectionCache.anyProjectionOccluded?null:{first:H,last:ee}:null}function ai(b,n,l,p){return b===c.an.horizontal&&Math.abs(l.y-n.y)>Math.abs(l.x-n.x)*p?{useVertical:!0}:(b===c.an.vertical?n.y<l.y:n.x>l.x)?{needsFlipping:!0}:null}function cr(b){const{projectionContext:n,pitchedLabelPlaneMatrixInverse:l,symbol:p,fontSize:_,flip:w,keepUpright:E,glyphOffsetArray:M,dynamicLayoutVertexArray:D,aspectRatio:O,rotateToLine:V}=b,$=_/24,j=p.lineOffsetX*$,H=p.lineOffsetY*$;let ee;if(p.numGlyphs>1){const de=p.glyphStartIndex+p.numGlyphs,he=p.lineStartIndex,fe=p.lineStartIndex+p.lineLength,ye=Pt($,M,j,H,w,p,V,n);if(!ye)return{notEnoughRoom:!0};const Te=ln(ye.first.point.x,ye.first.point.y,n,l),_e=ln(ye.last.point.x,ye.last.point.y,n,l);if(E&&!w){const Ae=ai(p.writingMode,Te,_e,O);if(Ae)return Ae}ee=[ye.first];for(let Ae=p.glyphStartIndex+1;Ae<de-1;Ae++){const Me=ki($*M.getoffsetX(Ae),j,H,w,p.segment,he,fe,n,V);if(!Me)return{notEnoughRoom:!0};ee.push(Me)}ee.push(ye.last)}else{if(E&&!w){const he=Mt(n.tileAnchorPoint.x,n.tileAnchorPoint.y,n).point,fe=p.lineStartIndex+p.segment+1,ye=new c.P(n.lineVertexArray.getx(fe),n.lineVertexArray.gety(fe)),Te=Mt(ye.x,ye.y,n),_e=Te.signedDistanceFromCamera>0?Te.point:va(n.tileAnchorPoint,ye,he,1,n),Ae=ln(he.x,he.y,n,l),Me=ln(_e.x,_e.y,n,l),ve=ai(p.writingMode,Ae,Me,O);if(ve)return ve}const de=ki($*M.getoffsetX(p.glyphStartIndex),j,H,w,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,n,V);if(!de||n.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ee=[de]}for(const de of ee)c.au(D,de.point,de.angle);return{}}function va(b,n,l,p,_){const w=b.add(b.sub(n)._unit()),E=Mt(w.x,w.y,_).point,M=l.sub(E);return l.add(M._mult(p/M.mag()))}function ba(b,n,l){const p=n.projectionCache;if(p.projections[b])return p.projections[b];const _=new c.P(n.lineVertexArray.getx(b),n.lineVertexArray.gety(b)),w=Mt(_.x,_.y,n);if(w.signedDistanceFromCamera>0)return p.projections[b]=w.point,p.anyProjectionOccluded=p.anyProjectionOccluded||w.isOccluded,w.point;const E=b-l.direction;return va(l.distanceFromAnchor===0?n.tileAnchorPoint:new c.P(n.lineVertexArray.getx(E),n.lineVertexArray.gety(E)),_,l.previousVertex,l.absOffsetX-l.distanceFromAnchor+1,n)}function Mt(b,n,l){const p=b+l.translation[0],_=n+l.translation[1];let w;return l.pitchWithMap?(w=Sn(p,_,l.pitchedLabelPlaneMatrix,l.getElevation),w.isOccluded=!1):(w=l.transform.projectTileCoordinates(p,_,l.unwrappedTileID,l.getElevation),w.point.x=(.5*w.point.x+.5)*l.width,w.point.y=(.5*-w.point.y+.5)*l.height),w}function ln(b,n,l,p){if(l.pitchWithMap){const _=[b,n,0,1];return c.av(_,_,p),l.transform.projectTileCoordinates(_[0]/_[3],_[1]/_[3],l.unwrappedTileID,l.getElevation).point}return{x:b/l.width*2-1,y:n/l.height*2-1}}function Qt(b,n,l){return l.transform.projectTileCoordinates(b,n,l.unwrappedTileID,l.getElevation)}function ha(b,n,l){return b._unit()._perp()._mult(n*l)}function rl(b,n,l,p,_,w,E,M,D){if(M.projectionCache.offsets[b])return M.projectionCache.offsets[b];const O=l.add(n);if(b+D.direction<p||b+D.direction>=_)return M.projectionCache.offsets[b]=O,O;const V=ba(b+D.direction,M,D),$=ha(V.sub(l),E,D.direction),j=l.add($),H=V.add($);return M.projectionCache.offsets[b]=c.aw(w,O,j,H)||O,M.projectionCache.offsets[b]}function ki(b,n,l,p,_,w,E,M,D){const O=p?b-n:b+n;let V=O>0?1:-1,$=0;p&&(V*=-1,$=Math.PI),V<0&&($+=Math.PI);let j,H=V>0?w+_:w+_+1;M.projectionCache.cachedAnchorPoint?j=M.projectionCache.cachedAnchorPoint:(j=Mt(M.tileAnchorPoint.x,M.tileAnchorPoint.y,M).point,M.projectionCache.cachedAnchorPoint=j);let ee,de,he=j,fe=j,ye=0,Te=0;const _e=Math.abs(O),Ae=[];let Me;for(;ye+Te<=_e;){if(H+=V,H<w||H>=E)return null;ye+=Te,fe=he,de=ee;const tt={absOffsetX:_e,direction:V,distanceFromAnchor:ye,previousVertex:fe};if(he=ba(H,M,tt),l===0)Ae.push(fe),Me=he.sub(fe);else{let Xe;const Ye=he.sub(fe);Xe=Ye.mag()===0?ha(ba(H+V,M,tt).sub(he),l,V):ha(Ye,l,V),de||(de=fe.add(Xe)),ee=rl(H,Xe,he,w,E,de,l,M,tt),Ae.push(de),Me=ee.sub(de)}Te=Me.mag()}const ve=Me._mult((_e-ye)/Te)._add(de||fe),Ne=$+Math.atan2(he.y-fe.y,he.x-fe.x);return Ae.push(ve),{point:ve,angle:D?Ne:0,path:Ae}}const pn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function zs(b,n){for(let l=0;l<b;l++){const p=n.length;n.resize(p+4),n.float32.set(pn,3*p)}}function ko(b,n,l){const p=n[0],_=n[1];return b[0]=l[0]*p+l[4]*_+l[12],b[1]=l[1]*p+l[5]*_+l[13],b[3]=l[3]*p+l[7]*_+l[15],b}const kr=100;class Dl{constructor(n,l=new Kt(n.width+200,n.height+200,25),p=new Kt(n.width+200,n.height+200,25)){this.transform=n,this.grid=l,this.ignoredGrid=p,this.pitchFactor=Math.cos(n.pitch*Math.PI/180)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+kr,this.screenBottomBoundary=n.height+kr,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,l,p,_,w,E,M,D,O,V,$,j){const H=this.projectAndGetPerspectiveRatio(n.anchorPointX+D[0],n.anchorPointY+D[1],w,V,j),ee=p*H.perspectiveRatio;let de;if(E||M)de=this._projectCollisionBox(n,ee,_,w,E,M,D,H,V,$,j);else{const Me=H.x+($?$.x*ee:0),ve=H.y+($?$.y*ee:0);de={allPointsOccluded:!1,box:[Me+n.x1*ee,ve+n.y1*ee,Me+n.x2*ee,ve+n.y2*ee]}}const[he,fe,ye,Te]=de.box,_e=E?de.allPointsOccluded:H.isOccluded;let Ae=_e;return Ae||(Ae=H.perspectiveRatio<this.perspectiveRatioCutoff),Ae||(Ae=!this.isInsideGrid(he,fe,ye,Te)),Ae||l!=="always"&&this.grid.hitTest(he,fe,ye,Te,l,O)?{box:[he,fe,ye,Te],placeable:!1,offscreen:!1,occluded:_e}:{box:[he,fe,ye,Te],placeable:!0,offscreen:this.isOffscreen(he,fe,ye,Te),occluded:_e}}placeCollisionCircles(n,l,p,_,w,E,M,D,O,V,$,j,H,ee){const de=[],he=new c.P(l.anchorX,l.anchorY),fe=this.getPerspectiveRatio(he.x,he.y,E,ee),ye=(O?w*this.transform.getPitchedTextCorrection(l.anchorX,l.anchorY,E)/fe:w*fe)/c.aA,Te={getElevation:ee,pitchedLabelPlaneMatrix:M,lineVertexArray:p,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:he,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:H},_e=Pt(ye,_,l.lineOffsetX*ye,l.lineOffsetY*ye,!1,l,!1,Te);let Ae=!1,Me=!1,ve=!0;if(_e){const Ne=.5*$*fe+j,tt=new c.P(-100,-100),Xe=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Ye=new rn,at=_e.first,Dt=_e.last;let kt=[];for(let An=at.path.length-1;An>=1;An--)kt.push(at.path[An]);for(let An=1;An<Dt.path.length;An++)kt.push(Dt.path[An]);const vt=2.5*Ne;if(O){const An=this.projectPathToScreenSpace(kt,Te);kt=An.some(Qn=>Qn.signedDistanceFromCamera<=0)?[]:An.map(Qn=>Qn.point)}let qt=[];if(kt.length>0){const An=kt[0].clone(),Qn=kt[0].clone();for(let Qr=1;Qr<kt.length;Qr++)An.x=Math.min(An.x,kt[Qr].x),An.y=Math.min(An.y,kt[Qr].y),Qn.x=Math.max(Qn.x,kt[Qr].x),Qn.y=Math.max(Qn.y,kt[Qr].y);qt=An.x>=tt.x&&Qn.x<=Xe.x&&An.y>=tt.y&&Qn.y<=Xe.y?[kt]:Qn.x<tt.x||An.x>Xe.x||Qn.y<tt.y||An.y>Xe.y?[]:c.ax([kt],tt.x,tt.y,Xe.x,Xe.y)}for(const An of qt){Ye.reset(An,.25*Ne);let Qn=0;Qn=Ye.length<=.5*Ne?1:Math.ceil(Ye.paddedLength/vt)+1;for(let Qr=0;Qr<Qn;Qr++){const gr=Qr/Math.max(Qn-1,1),ni=Ye.lerp(gr),yr=ni.x+kr,_r=ni.y+kr;de.push(yr,_r,Ne,0);const Ar=yr-Ne,Ki=_r-Ne,Gn=yr+Ne,Wi=_r+Ne;if(ve=ve&&this.isOffscreen(Ar,Ki,Gn,Wi),Me=Me||this.isInsideGrid(Ar,Ki,Gn,Wi),n!=="always"&&this.grid.hitTestCircle(yr,_r,Ne,n,V)&&(Ae=!0,!D))return{circles:[],offscreen:!1,collisionDetected:Ae}}}}return{circles:!D&&Ae||!Me||fe<this.perspectiveRatioCutoff?[]:de,offscreen:ve,collisionDetected:Ae}}projectPathToScreenSpace(n,l){const p=function(_,w){const E=c.L();return c.ap(E,w.pitchedLabelPlaneMatrix),_.map(M=>{const D=Sn(M.x,M.y,E,w.getElevation),O=w.transform.projectTileCoordinates(D.point.x,D.point.y,w.unwrappedTileID,w.getElevation);return O.point.x=(.5*O.point.x+.5)*w.width,O.point.y=(.5*-O.point.y+.5)*w.height,O})}(n,l);return function(_){let w=0,E=0,M=0,D=0;for(let O=0;O<_.length;O++)_[O].isOccluded?(M=O+1,D=0):(D++,D>E&&(E=D,w=M));return _.slice(w,w+E)}(p)}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[],p=new c.a1;for(const $ of n){const j=new c.P($.x+kr,$.y+kr);p.extend(j),l.push(j)}const{minX:_,minY:w,maxX:E,maxY:M}=p,D=this.grid.query(_,w,E,M).concat(this.ignoredGrid.query(_,w,E,M)),O={},V={};for(const $ of D){const j=$.key;if(O[j.bucketInstanceId]===void 0&&(O[j.bucketInstanceId]={}),O[j.bucketInstanceId][j.featureIndex])continue;const H=[new c.P($.x1,$.y1),new c.P($.x2,$.y1),new c.P($.x2,$.y2),new c.P($.x1,$.y2)];c.ay(l,H)&&(O[j.bucketInstanceId][j.featureIndex]=!0,V[j.bucketInstanceId]===void 0&&(V[j.bucketInstanceId]=[]),V[j.bucketInstanceId].push(j.featureIndex))}return V}insertCollisionBox(n,l,p,_,w,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:w,collisionGroupID:E,overlapMode:l},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,l,p,_,w,E){const M=p?this.ignoredGrid:this.grid,D={bucketInstanceId:_,featureIndex:w,collisionGroupID:E,overlapMode:l};for(let O=0;O<n.length;O+=4)M.insertCircle(D,n[O],n[O+1],n[O+2])}projectAndGetPerspectiveRatio(n,l,p,_,w){if(w){let E;_?(E=[n,l,_(n,l),1],c.av(E,E,w)):(E=[n,l,0,1],ko(E,E,w));const M=E[3];return{x:(E[0]/M+1)/2*this.transform.width+kr,y:(-E[1]/M+1)/2*this.transform.height+kr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/M*.5,isOccluded:!1,signedDistanceFromCamera:M}}{const E=this.transform.projectTileCoordinates(n,l,p,_);return{x:(E.point.x+1)/2*this.transform.width+kr,y:(1-E.point.y)/2*this.transform.height+kr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(n,l,p,_){const w=this.transform.projectTileCoordinates(n,l,p,_);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(n,l,p,_){return p<kr||n>=this.screenRightBoundary||_<kr||l>this.screenBottomBoundary}isInsideGrid(n,l,p,_){return p>=0&&n<this.gridRightBoundary&&_>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const n=c.af([]);return c.M(n,n,[-100,-100,0]),n}_projectCollisionBox(n,l,p,_,w,E,M,D,O,V,$){let j=1,H=0,ee=0,de=1;const he=n.anchorPointX+M[0],fe=n.anchorPointY+M[1];if(E&&!w){const kt=this.projectAndGetPerspectiveRatio(he+1,fe,_,O,$),vt=kt.x-D.x,qt=Math.atan((kt.y-D.y)/vt)+(vt<0?Math.PI:0),An=Math.sin(qt),Qn=Math.cos(qt);j=Qn,H=An,ee=-An,de=Qn}else if(!E&&w){const kt=gn(this.transform);j=kt.vecEast[0],H=kt.vecEast[1],ee=kt.vecSouth[0],de=kt.vecSouth[1]}let ye=D.x,Te=D.y,_e=l;w&&(ye=he,Te=fe,_e=Math.pow(2,-(this.transform.zoom-p.overscaledZ)),_e*=this.transform.getPitchedTextCorrection(he,fe,_),V||(_e*=c.ag(.5+D.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),V&&(ye+=j*V.x*_e+ee*V.y*_e,Te+=H*V.x*_e+de*V.y*_e);const Ae=n.x1*_e,Me=n.x2*_e,ve=(Ae+Me)/2,Ne=n.y1*_e,tt=n.y2*_e,Xe=(Ne+tt)/2,Ye=[{offsetX:Ae,offsetY:Ne},{offsetX:ve,offsetY:Ne},{offsetX:Me,offsetY:Ne},{offsetX:Me,offsetY:Xe},{offsetX:Me,offsetY:tt},{offsetX:ve,offsetY:tt},{offsetX:Ae,offsetY:tt},{offsetX:Ae,offsetY:Xe}];let at=[];for(const{offsetX:kt,offsetY:vt}of Ye)at.push(new c.P(ye+j*kt+ee*vt,Te+H*kt+de*vt));let Dt=!1;if(w){const kt=at.map(vt=>this.projectAndGetPerspectiveRatio(vt.x,vt.y,_,O,$));Dt=kt.some(vt=>!vt.isOccluded),at=kt.map(vt=>new c.P(vt.x,vt.y))}else Dt=!0;return{box:c.az(at),allPointsOccluded:!Dt}}}class Os{constructor(n,l,p,_){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?l:-l))):_&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ra{constructor(n,l,p,_,w){this.text=new Os(n?n.text:null,l,p,w),this.icon=new Os(n?n.icon:null,l,_,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class yi{constructor(n,l,p){this.text=n,this.icon=l,this.skipFade=p}}class Gi{constructor(n,l,p,_,w){this.bucketInstanceId=n,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=w}}class Dr{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const l=++this.maxGroupID;this.collisionGroups[n]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[n]}}function Do(b,n,l,p,_){const{horizontalAlign:w,verticalAlign:E}=c.aG(b);return new c.P(-(w-.5)*n+p[0]*_,-(E-.5)*l+p[1]*_)}class Lo{constructor(n,l,p,_,w){this.transform=n.clone(),this.terrain=l,this.collisionIndex=new Dl(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Dr(_),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const l=this.terrain;return l?(p,_)=>l.getElevation(n,p,_):null}getBucketParts(n,l,p,_){const w=p.getBucket(l),E=p.latestFeatureIndex;if(!w||!E||l.id!==w.layerIds[0])return;const M=p.collisionBoxArray,D=w.layers[0].layout,O=w.layers[0].paint,V=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),$=p.tileSize/c.$,j=p.tileID.toUnwrapped(),H=D.get("text-rotation-alignment")==="map",ee=c.aB(p,1,this.transform.zoom),de=c.aC(this.collisionIndex.transform,p,O.get("text-translate"),O.get("text-translate-anchor")),he=c.aC(this.collisionIndex.transform,p,O.get("icon-translate"),O.get("icon-translate-anchor")),fe=Ht(H,this.transform,ee);this.retainedQueryData[w.bucketInstanceId]=new Gi(w.bucketInstanceId,E,w.sourceLayerIndex,w.index,p.tileID);const ye={bucket:w,layout:D,translationText:de,translationIcon:he,unwrappedTileID:j,pitchedLabelPlaneMatrix:fe,scale:V,textPixelRatio:$,holdingForFade:p.holdingForFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:c.am(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(_)for(const Te of w.sortKeyRanges){const{sortKey:_e,symbolInstanceStart:Ae,symbolInstanceEnd:Me}=Te;n.push({sortKey:_e,symbolInstanceStart:Ae,symbolInstanceEnd:Me,parameters:ye})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:ye})}attemptAnchorPlacement(n,l,p,_,w,E,M,D,O,V,$,j,H,ee,de,he,fe,ye,Te,_e){const Ae=c.aD[n.textAnchor],Me=[n.textOffset0,n.textOffset1],ve=Do(Ae,p,_,Me,w),Ne=this.collisionIndex.placeCollisionBox(l,j,D,O,V,M,E,he,$.predicate,Te,ve,_e);if((!ye||this.collisionIndex.placeCollisionBox(ye,j,D,O,V,M,E,fe,$.predicate,Te,ve,_e).placeable)&&Ne.placeable){let tt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(tt=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:Me,width:p,height:_,anchor:Ae,textBoxScale:w,prevAnchor:tt},this.markUsedJustification(ee,Ae,H,de),ee.allowVerticalPlacement&&(this.markUsedOrientation(ee,de,H),this.placedOrientations[H.crossTileID]=de),{shift:ve,placedGlyphBoxes:Ne}}}placeLayerBucketPart(n,l,p){const{bucket:_,layout:w,translationText:E,translationIcon:M,unwrappedTileID:D,pitchedLabelPlaneMatrix:O,textPixelRatio:V,holdingForFade:$,collisionBoxArray:j,partiallyEvaluatedTextSize:H,collisionGroup:ee}=n.parameters,de=w.get("text-optional"),he=w.get("icon-optional"),fe=c.aE(w,"text-overlap","text-allow-overlap"),ye=fe==="always",Te=c.aE(w,"icon-overlap","icon-allow-overlap"),_e=Te==="always",Ae=w.get("text-rotation-alignment")==="map",Me=w.get("text-pitch-alignment")==="map",ve=w.get("icon-text-fit")!=="none",Ne=w.get("symbol-z-order")==="viewport-y",tt=ye&&(_e||!_.hasIconData()||he),Xe=_e&&(ye||!_.hasTextData()||de);!_.collisionArrays&&j&&_.deserializeCollisionBoxes(j);const Ye=this.retainedQueryData[_.bucketInstanceId].tileID,at=this._getTerrainElevationFunc(Ye),Dt=this.transform.getFastPathSimpleProjectionMatrix(Ye),kt=(vt,qt,An)=>{var Qn,Qr;if(l[vt.crossTileID])return;if($)return void(this.placements[vt.crossTileID]=new yi(!1,!1,!1));let gr=!1,ni=!1,yr=!0,_r=null,Ar={box:null,placeable:!1,offscreen:null,occluded:!1},Ki={placeable:!1},Gn=null,Wi=null,pa=null,nu=0,vl=0,qs=0;qt.textFeatureIndex?nu=qt.textFeatureIndex:vt.useRuntimeCollisionCircles&&(nu=vt.featureIndex),qt.verticalTextFeatureIndex&&(vl=qt.verticalTextFeatureIndex);const Gs=qt.textBox;if(Gs){const ma=Or=>{let vr=c.an.horizontal;if(_.allowVerticalPlacement&&!Or&&this.prevPlacement){const la=this.prevPlacement.placedOrientations[vt.crossTileID];la&&(this.placedOrientations[vt.crossTileID]=la,vr=la,this.markUsedOrientation(_,vr,vt))}return vr},Hs=(Or,vr)=>{if(_.allowVerticalPlacement&&vt.numVerticalGlyphVertices>0&&qt.verticalTextBox){for(const la of _.writingModes)if(la===c.an.vertical?(Ar=vr(),Ki=Ar):Ar=Or(),Ar&&Ar.placeable)break}else Ar=Or()},bl=vt.textAnchorOffsetStartIndex,Gu=vt.textAnchorOffsetEndIndex;if(Gu===bl){const Or=(vr,la)=>{const oi=this.collisionIndex.placeCollisionBox(vr,fe,V,Ye,D,Me,Ae,E,ee.predicate,at,void 0,Dt);return oi&&oi.placeable&&(this.markUsedOrientation(_,la,vt),this.placedOrientations[vt.crossTileID]=la),oi};Hs(()=>Or(Gs,c.an.horizontal),()=>{const vr=qt.verticalTextBox;return _.allowVerticalPlacement&&vt.numVerticalGlyphVertices>0&&vr?Or(vr,c.an.vertical):{box:null,offscreen:null}}),ma(Ar&&Ar.placeable)}else{let Or=c.aD[(Qr=(Qn=this.prevPlacement)===null||Qn===void 0?void 0:Qn.variableOffsets[vt.crossTileID])===null||Qr===void 0?void 0:Qr.anchor];const vr=(oi,Mh,tm)=>{const Cd=oi.x2-oi.x1,Zo=oi.y2-oi.y1,Hu=vt.textBoxScale,Vi=ve&&Te==="never"?Mh:null;let Gr=null,Ca=fe==="never"?1:2,Pd="never";Or&&Ca++;for(let qa=0;qa<Ca;qa++){for(let wo=bl;wo<Gu;wo++){const wi=_.textAnchorOffsets.get(wo);if(Or&&wi.textAnchor!==Or)continue;const iu=this.attemptAnchorPlacement(wi,oi,Cd,Zo,Hu,Ae,Me,V,Ye,D,ee,Pd,vt,_,tm,E,M,Vi,at);if(iu&&(Gr=iu.placedGlyphBoxes,Gr&&Gr.placeable))return gr=!0,_r=iu.shift,Gr}Or?Or=null:Pd=fe}return p&&!Gr&&(Gr={box:this.collisionIndex.placeCollisionBox(Gs,"always",V,Ye,D,Me,Ae,E,ee.predicate,at,void 0,Dt).box,offscreen:!1,placeable:!1,occluded:!1}),Gr};Hs(()=>vr(Gs,qt.iconBox,c.an.horizontal),()=>{const oi=qt.verticalTextBox;return _.allowVerticalPlacement&&(!Ar||!Ar.placeable)&&vt.numVerticalGlyphVertices>0&&oi?vr(oi,qt.verticalIconBox,c.an.vertical):{box:null,occluded:!0,offscreen:null}}),Ar&&(gr=Ar.placeable,yr=Ar.offscreen);const la=ma(Ar&&Ar.placeable);if(!gr&&this.prevPlacement){const oi=this.prevPlacement.variableOffsets[vt.crossTileID];oi&&(this.variableOffsets[vt.crossTileID]=oi,this.markUsedJustification(_,oi.anchor,vt,la))}}}if(Gn=Ar,gr=Gn&&Gn.placeable,yr=Gn&&Gn.offscreen,vt.useRuntimeCollisionCircles){const ma=_.text.placedSymbolArray.get(vt.centerJustifiedTextSymbolIndex),Hs=c.ao(_.textSizeData,H,ma),bl=w.get("text-padding");Wi=this.collisionIndex.placeCollisionCircles(fe,ma,_.lineVertexArray,_.glyphOffsetArray,Hs,D,O,p,Me,ee.predicate,vt.collisionCircleDiameter,bl,E,at),Wi.circles.length&&Wi.collisionDetected&&!p&&c.w("Collisions detected, but collision boxes are not shown"),gr=ye||Wi.circles.length>0&&!Wi.collisionDetected,yr=yr&&Wi.offscreen}if(qt.iconFeatureIndex&&(qs=qt.iconFeatureIndex),qt.iconBox){const ma=Hs=>this.collisionIndex.placeCollisionBox(Hs,Te,V,Ye,D,Me,Ae,M,ee.predicate,at,ve&&_r?_r:void 0,Dt);Ki&&Ki.placeable&&qt.verticalIconBox?(pa=ma(qt.verticalIconBox),ni=pa.placeable):(pa=ma(qt.iconBox),ni=pa.placeable),yr=yr&&pa.offscreen}const ru=de||vt.numHorizontalGlyphVertices===0&&vt.numVerticalGlyphVertices===0,Oc=he||vt.numIconVertices===0;ru||Oc?Oc?ru||(ni=ni&&gr):gr=ni&&gr:ni=gr=ni&&gr;const qu=ni&&pa.placeable;if(gr&&Gn.placeable&&this.collisionIndex.insertCollisionBox(Gn.box,fe,w.get("text-ignore-placement"),_.bucketInstanceId,Ki&&Ki.placeable&&vl?vl:nu,ee.ID),qu&&this.collisionIndex.insertCollisionBox(pa.box,Te,w.get("icon-ignore-placement"),_.bucketInstanceId,qs,ee.ID),Wi&&gr&&this.collisionIndex.insertCollisionCircles(Wi.circles,fe,w.get("text-ignore-placement"),_.bucketInstanceId,nu,ee.ID),p&&this.storeCollisionData(_.bucketInstanceId,An,qt,Gn,pa,Wi),vt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[vt.crossTileID]=new yi((gr||tt)&&!(Gn!=null&&Gn.occluded),(ni||Xe)&&!(pa!=null&&pa.occluded),yr||_.justReloaded),l[vt.crossTileID]=!0};if(Ne){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const vt=_.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let qt=vt.length-1;qt>=0;--qt){const An=vt[qt];kt(_.symbolInstances.get(An),_.collisionArrays[An],An)}}else for(let vt=n.symbolInstanceStart;vt<n.symbolInstanceEnd;vt++)kt(_.symbolInstances.get(vt),_.collisionArrays[vt],vt);_.justReloaded=!1}storeCollisionData(n,l,p,_,w,E){if(p.textBox||p.iconBox){let M,D;this.collisionBoxArrays.has(n)?M=this.collisionBoxArrays.get(n):(M=new Map,this.collisionBoxArrays.set(n,M)),M.has(l)?D=M.get(l):(D={text:null,icon:null},M.set(l,D)),p.textBox&&(D.text=_.box),p.iconBox&&(D.icon=w.box)}if(E){let M=this.collisionCircleArrays[n];M===void 0&&(M=this.collisionCircleArrays[n]=[]);for(let D=0;D<E.circles.length;D+=4)M.push(E.circles[D+0]-kr),M.push(E.circles[D+1]-kr),M.push(E.circles[D+2]),M.push(E.collisionDetected?1:0)}}markUsedJustification(n,l,p,_){let w;w=_===c.an.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[c.aF(l)];const E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const M of E)M>=0&&(n.text.placedSymbolArray.get(M).crossTileID=w>=0&&M!==w?0:p.crossTileID)}markUsedOrientation(n,l,p){const _=l===c.an.horizontal||l===c.an.horizontalOnly?l:0,w=l===c.an.vertical?l:0,E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const M of E)n.text.placedSymbolArray.get(M).placedOrientation=_;p.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const _=l?l.symbolFadeChange(n):1,w=l?l.opacities:{},E=l?l.variableOffsets:{},M=l?l.placedOrientations:{};for(const D in this.placements){const O=this.placements[D],V=w[D];V?(this.opacities[D]=new ra(V,_,O.text,O.icon),p=p||O.text!==V.text.placed||O.icon!==V.icon.placed):(this.opacities[D]=new ra(null,_,O.text,O.icon,O.skipFade),p=p||O.text||O.icon)}for(const D in w){const O=w[D];if(!this.opacities[D]){const V=new ra(O,_,!1,!1);V.isHidden()||(this.opacities[D]=V,p=p||O.text.placed||O.icon.placed)}}for(const D in E)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=E[D]);for(const D in M)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=M[D]);if(l&&l.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:n)}updateLayerOpacities(n,l){const p={};for(const _ of l){const w=_.getBucket(n);w&&_.latestFeatureIndex&&n.id===w.layerIds[0]&&this.updateBucketOpacities(w,_.tileID,p,_.collisionBoxArray)}}updateBucketOpacities(n,l,p,_){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const w=n.layers[0],E=w.layout,M=new ra(null,0,!1,!1,!0),D=E.get("text-allow-overlap"),O=E.get("icon-allow-overlap"),V=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$=E.get("text-rotation-alignment")==="map",j=E.get("text-pitch-alignment")==="map",H=E.get("icon-text-fit")!=="none",ee=new ra(null,0,D&&(O||!n.hasIconData()||E.get("icon-optional")),O&&(D||!n.hasTextData()||E.get("text-optional")),!0);!n.collisionArrays&&_&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(_);const de=(fe,ye,Te)=>{for(let _e=0;_e<ye/4;_e++)fe.opacityVertexArray.emplaceBack(Te);fe.hasVisibleVertices=fe.hasVisibleVertices||Te!==bu},he=this.collisionBoxArrays.get(n.bucketInstanceId);for(let fe=0;fe<n.symbolInstances.length;fe++){const ye=n.symbolInstances.get(fe),{numHorizontalGlyphVertices:Te,numVerticalGlyphVertices:_e,crossTileID:Ae}=ye;let Me=this.opacities[Ae];p[Ae]?Me=M:Me||(Me=ee,this.opacities[Ae]=Me),p[Ae]=!0;const ve=ye.numIconVertices>0,Ne=this.placedOrientations[ye.crossTileID],tt=Ne===c.an.vertical,Xe=Ne===c.an.horizontal||Ne===c.an.horizontalOnly;if(Te>0||_e>0){const at=Ll(Me.text);de(n.text,Te,tt?bu:at),de(n.text,_e,Xe?bu:at);const Dt=Me.text.isHidden();[ye.rightJustifiedTextSymbolIndex,ye.centerJustifiedTextSymbolIndex,ye.leftJustifiedTextSymbolIndex].forEach(qt=>{qt>=0&&(n.text.placedSymbolArray.get(qt).hidden=Dt||tt?1:0)}),ye.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(ye.verticalPlacedTextSymbolIndex).hidden=Dt||Xe?1:0);const kt=this.variableOffsets[ye.crossTileID];kt&&this.markUsedJustification(n,kt.anchor,ye,Ne);const vt=this.placedOrientations[ye.crossTileID];vt&&(this.markUsedJustification(n,"left",ye,vt),this.markUsedOrientation(n,vt,ye))}if(ve){const at=Ll(Me.icon),Dt=!(H&&ye.verticalPlacedIconSymbolIndex&&tt);ye.placedIconSymbolIndex>=0&&(de(n.icon,ye.numIconVertices,Dt?at:bu),n.icon.placedSymbolArray.get(ye.placedIconSymbolIndex).hidden=Me.icon.isHidden()),ye.verticalPlacedIconSymbolIndex>=0&&(de(n.icon,ye.numVerticalIconVertices,Dt?bu:at),n.icon.placedSymbolArray.get(ye.verticalPlacedIconSymbolIndex).hidden=Me.icon.isHidden())}const Ye=he&&he.has(fe)?he.get(fe):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const at=n.collisionArrays[fe];if(at){let Dt=new c.P(0,0);if(at.textBox||at.verticalTextBox){let kt=!0;if(V){const vt=this.variableOffsets[Ae];vt?(Dt=Do(vt.anchor,vt.width,vt.height,vt.textOffset,vt.textBoxScale),$&&Dt._rotate(j?-this.transform.bearingInRadians:this.transform.bearingInRadians)):kt=!1}if(at.textBox||at.verticalTextBox){let vt;at.textBox&&(vt=tt),at.verticalTextBox&&(vt=Xe),il(n.textCollisionBox.collisionVertexArray,Me.text.placed,!kt||vt,Ye.text,Dt.x,Dt.y)}}if(at.iconBox||at.verticalIconBox){const kt=!!(!Xe&&at.verticalIconBox);let vt;at.iconBox&&(vt=kt),at.verticalIconBox&&(vt=!kt),il(n.iconCollisionBox.collisionVertexArray,Me.icon.placed,vt,Ye.icon,H?Dt.x:0,H?Dt.y:0)}}}}if(n.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);n.bucketInstanceId in this.collisionCircleArrays&&(n.collisionCircleArray=this.collisionCircleArrays[n.bucketInstanceId],delete this.collisionCircleArrays[n.bucketInstanceId])}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>n}setStale(){this.stale=!0}}function il(b,n,l,p,_,w){p&&p.length!==0||(p=[0,0,0,0]);const E=p[0]-kr,M=p[1]-kr,D=p[2]-kr,O=p[3]-kr;b.emplaceBack(n?1:0,l?1:0,_||0,w||0,E,M),b.emplaceBack(n?1:0,l?1:0,_||0,w||0,D,M),b.emplaceBack(n?1:0,l?1:0,_||0,w||0,D,O),b.emplaceBack(n?1:0,l?1:0,_||0,w||0,E,O)}const so=Math.pow(2,25),ls=Math.pow(2,24),xa=Math.pow(2,17),_c=Math.pow(2,16),ld=Math.pow(2,9),oo=Math.pow(2,8),vc=Math.pow(2,1);function Ll(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const n=b.placed?1:0,l=Math.floor(127*b.opacity);return l*so+n*ls+l*xa+n*_c+l*ld+n*oo+l*vc+n}const bu=0;class Di{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,l,p,_,w){const E=this._bucketParts;for(;this._currentTileIndex<n.length;)if(l.getBucketParts(E,_,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((M,D)=>M.sortKey-D.sortKey));this._currentPartIndex<E.length;)if(l.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,w())return!0;return!1}}class Xa{constructor(n,l,p,_,w,E,M,D){this.placement=new Lo(n,l,E,M,D),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(n,l,p){const _=G.now(),w=()=>!this._forceFullPlacement&&G.now()-_>2;for(;this._currentPlacementIndex>=0;){const E=l[n[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=M)&&(!E.maxzoom||E.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new Di(E)),this._inProgressLayer.continuePlacement(p[E.source],this.placement,this._showCollisionBoxes,E,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Ns=512/c.$/2;class zo{constructor(n,l,p){this.tileID=n,this.bucketInstanceId=p,this._symbolsByKey={};const _=new Map;for(let w=0;w<l.length;w++){const E=l.get(w),M=E.key,D=_.get(M);D?D.push(E):_.set(M,[E])}for(const[w,E]of _){const M={positions:E.map(D=>({x:Math.floor(D.anchorX*Ns),y:Math.floor(D.anchorY*Ns)})),crossTileIDs:E.map(D=>D.crossTileID)};if(M.positions.length>128){const D=new c.aH(M.positions.length,16,Uint16Array);for(const{x:O,y:V}of M.positions)D.add(O,V);D.finish(),delete M.positions,M.index=D}this._symbolsByKey[w]=M}}getScaledCoordinates(n,l){const{x:p,y:_,z:w}=this.tileID.canonical,{x:E,y:M,z:D}=l.canonical,O=Ns/Math.pow(2,D-w),V=(M*c.$+n.anchorY)*O,$=_*c.$*Ns;return{x:Math.floor((E*c.$+n.anchorX)*O-p*c.$*Ns),y:Math.floor(V-$)}}findMatches(n,l,p){const _=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let w=0;w<n.length;w++){const E=n.get(w);if(E.crossTileID)continue;const M=this._symbolsByKey[E.key];if(!M)continue;const D=this.getScaledCoordinates(E,l);if(M.index){const O=M.index.range(D.x-_,D.y-_,D.x+_,D.y+_).sort();for(const V of O){const $=M.crossTileIDs[V];if(!p[$]){p[$]=!0,E.crossTileID=$;break}}}else if(M.positions)for(let O=0;O<M.positions.length;O++){const V=M.positions[O],$=M.crossTileIDs[O];if(Math.abs(V.x-D.x)<=_&&Math.abs(V.y-D.y)<=_&&!p[$]){p[$]=!0,E.crossTileID=$;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class lo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Sr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const l=Math.round((n-this.lng)/360);if(l!==0)for(const p in this.indexes){const _=this.indexes[p],w={};for(const E in _){const M=_[E];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+l),w[M.tileID.key]=M}this.indexes[p]=w}this.lng=n}addBucket(n,l,p){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let w=0;w<l.symbolInstances.length;w++)l.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const _=this.usedCrossTileIDs[n.overscaledZ];for(const w in this.indexes){const E=this.indexes[w];if(Number(w)>n.overscaledZ)for(const M in E){const D=E[M];D.tileID.isChildOf(n)&&D.findMatches(l.symbolInstances,n,_)}else{const M=E[n.scaledTo(Number(w)).key];M&&M.findMatches(l.symbolInstances,n,_)}}for(let w=0;w<l.symbolInstances.length;w++){const E=l.symbolInstances.get(w);E.crossTileID||(E.crossTileID=p.generate(),_[E.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new zo(n,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(n,l){for(const p of l.getCrossTileIDsLists())for(const _ of p)delete this.usedCrossTileIDs[n][_]}removeStaleBuckets(n){let l=!1;for(const p in this.indexes){const _=this.indexes[p];for(const w in _)n[_[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[w]),delete _[w],l=!0)}return l}}class Oo{constructor(){this.layerIndexes={},this.crossTileIDs=new lo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,l,p){let _=this.layerIndexes[n.id];_===void 0&&(_=this.layerIndexes[n.id]=new Sr);let w=!1;const E={};_.handleWrapJump(p);for(const M of l){const D=M.getBucket(n);D&&n.id===D.layerIds[0]&&(D.bucketInstanceId||(D.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(M.tileID,D,this.crossTileIDs)&&(w=!0),E[D.bucketInstanceId]=!0)}return _.removeStaleBuckets(E)&&(w=!0),w}pruneUnusedLayers(n){const l={};n.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}var Oa="void main() {fragColor=vec4(1.0);}";const wa={prelude:Rn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Rn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Rn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Rn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Rn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Rn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Rn(Oa,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Rn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Rn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Rn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Rn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(textureSize(u_elevation_stops,0)[0]);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int num_elevation_stops=textureSize(u_elevation_stops,0)[0];int r=(num_elevation_stops-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(textureSize(u_color_stops,0)[0]);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Rn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Rn(Oa,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Rn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Rn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Rn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Rn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Rn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Rn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Rn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Rn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Rn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Rn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Rn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Rn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Rn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Rn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Rn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Rn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Rn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Rn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Rn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Rn(b,n){const l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=n.match(/in ([\w]+) ([\w]+)/g),_=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=w?w.concat(_):_,M={};return{fragmentSource:b=b.replace(l,(D,O,V,$,j)=>(M[j]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${j}
in ${V} ${$} ${j};
#else
uniform ${V} ${$} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${V} ${$} ${j} = u_${j};
#endif
`)),vertexSource:n=n.replace(l,(D,O,V,$,j)=>{const H=$==="float"?"vec2":"vec4",ee=j.match(/color/)?"color":H;return M[j]?O==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${V} ${H} a_${j};
out ${V} ${$} ${j};
#else
uniform ${V} ${$} u_${j};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${V} ${$} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${ee}(a_${j}, u_${j}_t);
#else
    ${V} ${$} ${j} = u_${j};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${V} ${H} a_${j};
#else
uniform ${V} ${$} u_${j};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${V} ${$} ${j} = a_${j};
#else
    ${V} ${$} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${V} ${$} ${j} = unpack_mix_${ee}(a_${j}, u_${j}_t);
#else
    ${V} ${$} ${j} = u_${j};
#endif
`}),staticAttributes:p,staticUniforms:E}}class us{constructor(n,l,p){this.vertexBuffer=n,this.indexBuffer=l,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var cs=c.aI([{name:"a_pos",type:"Int16",components:2}]);const al="#define PROJECTION_MERCATOR",dh="mercator";class zl{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return dh}get shaderDefine(){return al}get shaderPreludeCode(){return wa.projectionMercator}get vertexShaderPreludeCode(){return wa.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(n){}getMeshFromTileID(n,l,p,_,w){if(this._cachedMesh)return this._cachedMesh;const E=new c.aK;E.emplaceBack(0,0),E.emplaceBack(c.$,0),E.emplaceBack(0,c.$),E.emplaceBack(c.$,c.$);const M=n.createVertexBuffer(E,cs.members),D=c.aL.simpleSegment(0,0,4,2),O=new c.aM;O.emplaceBack(1,0,2),O.emplaceBack(1,2,3);const V=n.createIndexBuffer(O);return this._cachedMesh=new us(M,V,D),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(n){}}class Li{constructor(n=0,l=0,p=0,_=0){if(isNaN(n)||n<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=l,this.left=p,this.right=_}interpolate(n,l,p){return l.top!=null&&n.top!=null&&(this.top=c.C.number(n.top,l.top,p)),l.bottom!=null&&n.bottom!=null&&(this.bottom=c.C.number(n.bottom,l.bottom,p)),l.left!=null&&n.left!=null&&(this.left=c.C.number(n.left,l.left,p)),l.right!=null&&n.right!=null&&(this.right=c.C.number(n.right,l.right,p)),this}getCenter(n,l){const p=c.ag((this.left+n-this.right)/2,0,n),_=c.ag((this.top+l-this.bottom)/2,0,l);return new c.P(p,_)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Li(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function zi(b,n){if(!b.renderWorldCopies||b.lngRange)return;const l=n.lng-b.center.lng;n.lng+=l>180?-360:l<-180?360:0}function vn(b){return Math.max(0,Math.floor(b))}class hs{constructor(n,l,p,_,w,E){this._callbacks=n,this._tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=l||0,this._maxZoom=p||22,this._minPitch=_??0,this._maxPitch=w??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=vn(this._zoom),this._scale=c.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Li,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(n,l,p){this._latRange=n.latRange,this._lngRange=n.lngRange,this._width=n.width,this._height=n.height,this._center=n.center,this._elevation=n.elevation,this._minElevationForCurrentTile=n.minElevationForCurrentTile,this._zoom=n.zoom,this._tileZoom=vn(this._zoom),this._scale=c.ae(this._zoom),this._bearingInRadians=n.bearingInRadians,this._fovInRadians=n.fovInRadians,this._pitchInRadians=n.pitchInRadians,this._rollInRadians=n.rollInRadians,this._unmodified=n.unmodified,this._edgeInsets=new Li(n.padding.top,n.padding.bottom,n.padding.left,n.padding.right),this._minZoom=n.minZoom,this._maxZoom=n.maxZoom,this._minPitch=n.minPitch,this._maxPitch=n.maxPitch,this._renderWorldCopies=n.renderWorldCopies,this._cameraToCenterDistance=n.cameraToCenterDistance,this._nearZ=n.nearZ,this._farZ=n.farZ,this._autoCalculateNearFarZ=!p&&n.autoCalculateNearFarZ,l&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(n){this._minElevationForCurrentTile=n}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(n){this._minZoom!==n&&(this._minZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(n){this._minPitch!==n&&(this._minPitch=n,this.setPitch(Math.max(this.pitch,n)))}get maxPitch(){return this._maxPitch}setMaxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.setPitch(Math.min(this.pitch,n)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(n){const l=c.aN(n,-180,180)*Math.PI/180;var p,_,w,E,M,D,O,V,$;this._bearingInRadians!==l&&(this._unmodified=!1,this._bearingInRadians=l,this._calcMatrices(),this._rotationMatrix=k(),p=this._rotationMatrix,w=-this._bearingInRadians,E=(_=this._rotationMatrix)[0],M=_[1],D=_[2],O=_[3],V=Math.sin(w),$=Math.cos(w),p[0]=E*$+D*V,p[1]=M*$+O*V,p[2]=E*-V+D*$,p[3]=M*-V+O*$)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(n){const l=c.ag(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==l&&(this._unmodified=!1,this._pitchInRadians=l,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(n){const l=n/180*Math.PI;this._rollInRadians!==l&&(this._unmodified=!1,this._rollInRadians=l,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aO(this._fovInRadians)}setFov(n){n=c.ag(n,.1,150),this.fov!==n&&(this._unmodified=!1,this._fovInRadians=c.ad(n),this._calcMatrices())}get zoom(){return this._zoom}setZoom(n){const l=this.getConstrained(this._center,n).zoom;this._zoom!==l&&(this._unmodified=!1,this._zoom=l,this._tileZoom=Math.max(0,Math.floor(l)),this._scale=c.ae(l),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(n,l){this._autoCalculateNearFarZ=!1,this._nearZ=n,this._farZ=l,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,l,p){this._unmodified=!1,this._edgeInsets.interpolate(n,l,p),this._constrain(),this._calcMatrices()}resize(n,l,p=!0){this._width=n,this._height=l,p&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Tr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(n){n?(this._lngRange=[n.getWest(),n.getEast()],this._latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,c.ah])}getConstrained(n,l){return this._callbacks.getConstrained(n,l)}getCameraQueryGeometry(n,l){if(l.length===1)return[l[0],n];{const{minX:p,minY:_,maxX:w,maxY:E}=c.a1.fromPoints(l).extend(n);return[new c.P(p,_),new c.P(w,_),new c.P(w,E),new c.P(p,E),new c.P(p,_)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:l,zoom:p}=this.getConstrained(this.center,this.zoom);this.setCenter(l),this.setZoom(p),this._unmodified=n,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let n=c.af(new Float64Array(16));c.N(n,n,[this._width/2,-this._height/2,1]),c.M(n,n,[1,-1,0]),this._clipSpaceToPixelsMatrix=n,n=c.af(new Float64Array(16)),c.N(n,n,[1,-1,1]),c.M(n,n,[-1,-1,0]),c.N(n,n,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=n,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(n,l,p,_){const w=p!==void 0?p:this.bearing,E=_=_!==void 0?_:this.pitch,M=c.a0.fromLngLat(n,l),D=-Math.cos(c.ad(E)),O=Math.sin(c.ad(E)),V=O*Math.sin(c.ad(w)),$=-O*Math.cos(c.ad(w));let j=this.elevation;const H=l-j;let ee;D*H>=0||Math.abs(D)<.1?(ee=1e4,j=l+ee*D):ee=-H/D;let de,he,fe=c.aP(1,M.y),ye=0;do{if(ye+=1,ye>10)break;he=ee/fe,de=new c.a0(M.x+V*he,M.y+$*he),fe=1/de.meterInMercatorCoordinateUnits()}while(Math.abs(ee-he*fe)>1e-12);return{center:de.toLngLat(),elevation:j,zoom:c.aj(this.height/2/Math.tan(this.fovInRadians/2)/he/this.tileSize)}}recalculateZoomAndCenter(n){if(this.elevation-n==0)return;const l=c.ai(1,this.center.lat)*this.worldSize,p=this.cameraToCenterDistance/l,_=c.a0.fromLngLat(this.center,this.elevation),w=xe(this.center,this.elevation,this.pitch,this.bearing,p);this._elevation=n;const E=this.calculateCenterFromCameraLngLatAlt(w.toLngLat(),c.aP(w.z,_.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const n=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(n*Math.sin(this.rollInRadians),n*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const n=c.ai(1,this.center.lat)*this.worldSize;return xe(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/n).toLngLat()}getMercatorTileCoordinates(n){if(!n)return[0,0,1,1];const l=n.canonical.z>=0?1<<n.canonical.z:Math.pow(2,n.canonical.z);return[n.canonical.x/l,n.canonical.y/l,1/l/c.$,1/l/c.$]}}class Ol{constructor(n,l){this.min=n,this.max=l,this.center=c.aQ([],c.aR([],this.min,this.max),.5)}quadrant(n){const l=[n%2==0,n<2],p=c.aS(this.min),_=c.aS(this.max);for(let w=0;w<l.length;w++)p[w]=l[w]?this.min[w]:this.center[w],_[w]=l[w]?this.center[w]:this.max[w];return _[2]=this.max[2],new Ol(p,_)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersectsFrustum(n){let l=!0;for(let p=0;p<n.planes.length;p++){const _=this.intersectsPlane(n.planes[p]);if(_===0)return 0;_===1&&(l=!1)}return l?2:n.aabb.min[0]>this.max[0]||n.aabb.min[1]>this.max[1]||n.aabb.min[2]>this.max[2]||n.aabb.max[0]<this.min[0]||n.aabb.max[1]<this.min[1]||n.aabb.max[2]<this.min[2]?0:1}intersectsPlane(n){let l=n[3],p=n[3];for(let _=0;_<3;_++)n[_]>0?(l+=n[_]*this.min[_],p+=n[_]*this.max[_]):(p+=n[_]*this.min[_],l+=n[_]*this.max[_]);return l>=0?2:p<0?0:1}}class Bs{distanceToTile2d(n,l,p,_){const w=_.distanceX([n,l]),E=_.distanceY([n,l]);return Math.hypot(w,E)}getWrap(n,l,p){return p}getTileBoundingVolume(n,l,p,_){var w,E;let M=p,D=p;if(_!=null&&_.terrain){const V=new c.Z(n.z,l,n.z,n.x,n.y),$=_.terrain.getMinMaxElevation(V);M=(w=$.minElevation)!==null&&w!==void 0?w:p,D=(E=$.maxElevation)!==null&&E!==void 0?E:p}const O=1<<n.z;return new Ol([l+n.x/O,n.y/O,M],[l+(n.x+1)/O,(n.y+1)/O,D])}allowVariableZoom(n,l){const p=n.fov*(Math.abs(Math.cos(n.rollInRadians))*n.height+Math.abs(Math.sin(n.rollInRadians))*n.width)/n.height,_=c.ag(78.5-p/2,0,60);return!!l.terrain||n.pitch>_}allowWorldCopies(){return!0}prepareNextFrame(){}}class Hi{constructor(n,l,p){this.points=n,this.planes=l,this.aabb=p}static fromInvProjectionMatrix(n,l=1,p=0,_,w){const E=w?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],M=Math.pow(2,p),D=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(j=>function(H,ee,de,he){const fe=c.av([],H,ee),ye=1/fe[3]/de*he;return c.aX(fe,fe,[ye,ye,1/fe[3],ye])}(j,n,l,M));_&&function(j,H,ee,de){const he=de?4:0,fe=de?0:4;let ye=0;const Te=[],_e=[];for(let ve=0;ve<4;ve++){const Ne=c.aT([],j[ve+fe],j[ve+he]),tt=c.aY(Ne);c.aQ(Ne,Ne,1/tt),Te.push(tt),_e.push(Ne)}for(let ve=0;ve<4;ve++){const Ne=c.aZ(j[ve+he],_e[ve],ee);ye=Ne!==null&&Ne>=0?Math.max(ye,Ne):Math.max(ye,Te[ve])}const Ae=function(ve,Ne){const tt=c.aT([],ve[Ne[0]],ve[Ne[1]]),Xe=c.aT([],ve[Ne[2]],ve[Ne[1]]),Ye=[0,0,0,0];return c.aU(Ye,c.aV([],tt,Xe)),Ye[3]=-c.aW(Ye,ve[Ne[0]]),Ye}(j,H),Me=function(ve,Ne){const tt=c.a_(ve),Xe=c.a$([],ve,1/tt),Ye=c.aT([],Ne,c.aQ([],Xe,c.aW(Ne,Xe))),at=c.a_(Ye);if(at>0){const Dt=Math.sqrt(1-Xe[3]*Xe[3]),kt=c.aQ([],Xe,-Xe[3]),vt=c.aR([],kt,c.aQ([],Ye,Dt/at));return c.b0(Ne,vt)}return null}(ee,Ae);if(Me!==null){const ve=Me/c.aW(_e[0],Ae);ye=Math.min(ye,ve)}for(let ve=0;ve<4;ve++){const Ne=Math.min(ye,Te[ve]);j[ve+fe]=[j[ve+he][0]+_e[ve][0]*Ne,j[ve+he][1]+_e[ve][1]*Ne,j[ve+he][2]+_e[ve][2]*Ne,1]}}(D,E[0],_,w);const O=E.map(j=>{const H=c.aT([],D[j[0]],D[j[1]]),ee=c.aT([],D[j[2]],D[j[1]]),de=c.aU([],c.aV([],H,ee)),he=-c.aW(de,D[j[1]]);return de.concat(he)}),V=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],$=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const j of D)for(let H=0;H<3;H++)V[H]=Math.min(V[H],j[H]),$[H]=Math.max($[H],j[H]);return new Hi(D,O,new Ol(V,$))}}class jr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,l,p){return this._helper.interpolatePadding(n,l,p)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,l,p=!0){this._helper.resize(n,l,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,l){this._helper.overrideNearFarZ(n,l)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n,l){}constructor(n,l,p,_,w){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new hs({calcMatrices:()=>{this._calcMatrices()},getConstrained:(E,M)=>this.getConstrained(E,M)},n,l,p,_,w),this._coveringTilesDetailsProvider=new Bs}clone(){const n=new jr;return n.apply(this),n}apply(n,l,p){this._helper.apply(n,l,p)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(n){const l=[new c.b1(0,n)];if(this._helper._renderWorldCopies){const p=this.screenPointToMercatorCoordinate(new c.P(0,0)),_=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),M=Math.floor(Math.min(p.x,_.x,w.x,E.x)),D=Math.floor(Math.max(p.x,_.x,w.x,E.x)),O=1;for(let V=M-O;V<=D+O;V++)V!==0&&l.push(new c.b1(V,n))}return l}getCameraFrustum(){return Hi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){const l=this.screenPointToLocation(this.centerPoint,n),p=n?n.getElevationForLngLatZoom(l,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(p)}setLocationAtPoint(n,l){const p=c.ai(this.elevation,this.center.lat),_=this.screenPointToMercatorCoordinateAtZ(l,p),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,p),E=c.a0.fromLngLat(n),M=new c.a0(E.x-(_.x-w.x),E.y-(_.y-w.y));this.setCenter(M==null?void 0:M.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(n,l){return l?this.coordinatePoint(c.a0.fromLngLat(n),l.getElevationForLngLatZoom(n,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a0.fromLngLat(n))}screenPointToLocation(n,l){var p;return(p=this.screenPointToMercatorCoordinate(n,l))===null||p===void 0?void 0:p.toLngLat()}screenPointToMercatorCoordinate(n,l){if(l){const p=l.pointCoordinate(n);if(p!=null)return p}return this.screenPointToMercatorCoordinateAtZ(n)}screenPointToMercatorCoordinateAtZ(n,l){const p=l||0,_=[n.x,n.y,0,1],w=[n.x,n.y,1,1];c.av(_,_,this._pixelMatrixInverse),c.av(w,w,this._pixelMatrixInverse);const E=_[3],M=w[3],D=_[1]/E,O=w[1]/M,V=_[2]/E,$=w[2]/M,j=V===$?0:(p-V)/($-V);return new c.a0(c.C.number(_[0]/E,w[0]/M,j)/this.worldSize,c.C.number(D,O,j)/this.worldSize,p)}coordinatePoint(n,l=0,p=this._pixelMatrix){const _=[n.x*this.worldSize,n.y*this.worldSize,l,1];return c.av(_,_,p),new c.P(_[0]/_[3],_[1]/_[3])}getBounds(){const n=Math.max(0,this._helper._height/2-re(this));return new Tr().extend(this.screenPointToLocation(new c.P(0,n))).extend(this.screenPointToLocation(new c.P(this._helper._width,n))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(n,l){return l?l.pointCoordinate(n)!=null:n.y>this.height/2-re(this)}calculatePosMatrix(n,l=!1,p){var _;const w=(_=n.key)!==null&&_!==void 0?_:c.b2(n.wrap,n.canonical.z,n.canonical.z,n.canonical.x,n.canonical.y),E=l?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(w)){const O=E.get(w);return p?O.f32:O.f64}const M=ue(n,this.worldSize);c.O(M,l?this._alignedProjMatrix:this._viewProjMatrix,M);const D={f64:M,f32:new Float32Array(M)};return E.set(w,D),p?D.f32:D.f64}calculateFogMatrix(n){const l=n.key,p=this._fogMatrixCacheF32;if(p.has(l))return p.get(l);const _=ue(n,this.worldSize);return c.O(_,this._fogMatrix,_),p.set(l,new Float32Array(_)),p.get(l)}getConstrained(n,l){l=c.ag(+l,this.minZoom,this.maxZoom);const p={center:new c.S(n.lng,n.lat),zoom:l};let _=this._helper._lngRange;this._helper._renderWorldCopies||_!==null||(_=[-179.9999999999,180-1e-10]);const w=this.tileSize*c.ae(p.zoom);let E=0,M=w,D=0,O=w,V=0,$=0;const{x:j,y:H}=this.size;if(this._helper._latRange){const Te=this._helper._latRange;E=c.U(Te[1])*w,M=c.U(Te[0])*w,M-E<H&&(V=H/(M-E))}_&&(D=c.aN(c.V(_[0])*w,0,w),O=c.aN(c.V(_[1])*w,0,w),O<D&&(O+=w),O-D<j&&($=j/(O-D)));const{x:ee,y:de}=$e(w,n);let he,fe;const ye=Math.max($||0,V||0);if(ye){const Te=new c.P($?(O+D)/2:ee,V?(M+E)/2:de);return p.center=ne(w,Te).wrap(),p.zoom+=c.aj(ye),p}if(this._helper._latRange){const Te=H/2;de-Te<E&&(fe=E+Te),de+Te>M&&(fe=M-Te)}if(_){const Te=(D+O)/2;let _e=ee;this._helper._renderWorldCopies&&(_e=c.aN(ee,Te-w/2,Te+w/2));const Ae=j/2;_e-Ae<D&&(he=D+Ae),_e+Ae>O&&(he=O-Ae)}if(he!==void 0||fe!==void 0){const Te=new c.P(he??ee,fe??de);p.center=ne(w,Te).wrap()}return p}calculateCenterFromCameraLngLatAlt(n,l,p,_){return this._helper.calculateCenterFromCameraLngLatAlt(n,l,p,_)}_calculateNearFarZIfNeeded(n,l,p){if(!this._helper.autoCalculateNearFarZ)return;const _=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=n-_*this._helper._pixelPerMeter/Math.cos(l),E=_<0?w:n,M=Math.PI/2+this.pitchInRadians,D=c.ad(this.fov)*(Math.abs(Math.cos(c.ad(this.roll)))*this.height+Math.abs(Math.sin(c.ad(this.roll)))*this.width)/this.height*(.5+p.y/this.height),O=Math.sin(D)*E/Math.sin(c.ag(Math.PI-M-D,.01,Math.PI-.01)),V=re(this),$=Math.atan(V/this._helper.cameraToCenterDistance),j=c.ad(.75),H=$>j?2*$*(.5+p.y/(2*V)):j,ee=Math.sin(H)*E/Math.sin(c.ag(Math.PI-M-H,.01,Math.PI-.01)),de=Math.min(O,ee);this._helper._farZ=1.01*(Math.cos(Math.PI/2-l)*de+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const n=this.centerOffset,l=$e(this.worldSize,this.center),p=l.x,_=l.y;this._helper._pixelPerMeter=c.ai(1,this.center.lat)*this.worldSize;const w=c.ad(Math.min(this.pitch,ao)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let M;this._calculateNearFarZIfNeeded(E,w,n),M=new Float64Array(16),c.b3(M,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.ap(this._invProjMatrix,M),M[8]=2*-n.x/this._helper._width,M[9]=2*n.y/this._helper._height,this._projectionMatrix=c.b4(M),c.N(M,M,[1,-1,1]),c.M(M,M,[0,0,-this._helper.cameraToCenterDistance]),c.b5(M,M,-this.rollInRadians),c.b6(M,M,this.pitchInRadians),c.b5(M,M,-this.bearingInRadians),c.M(M,M,[-p,-_,0]),this._mercatorMatrix=c.N([],M,[this.worldSize,this.worldSize,this.worldSize]),c.N(M,M,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,M),c.M(M,M,[0,0,-this.elevation]),this._viewProjMatrix=M,this._invViewProjMatrix=c.ap([],M);const D=[0,0,-1,1];c.av(D,D,this._invViewProjMatrix),this._cameraPosition=[D[0]/D[3],D[1]/D[3],D[2]/D[3]],this._fogMatrix=new Float64Array(16),c.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-n.x/this.width,this._fogMatrix[9]=2*n.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-p,-_,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,M);const O=this._helper._width%2/2,V=this._helper._height%2/2,$=Math.cos(this.bearingInRadians),j=Math.sin(-this.bearingInRadians),H=p-Math.round(p)+$*O+j*V,ee=_-Math.round(_)+$*V+j*O,de=new Float64Array(M);if(c.M(de,de,[H>.5?H-1:H,ee>.5?ee-1:ee,0]),this._alignedProjMatrix=de,M=c.ap(new Float64Array(16),this._pixelMatrix),!M)throw new Error("failed to invert matrix");this._pixelMatrixInverse=M,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const n=this.screenPointToMercatorCoordinate(new c.P(0,0)),l=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.av(l,l,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const n=c.ai(1,this.center.lat)*this.worldSize;return xe(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/n).toLngLat()}lngLatToCameraDepth(n,l){const p=c.a0.fromLngLat(n),_=[p.x*this.worldSize,p.y*this.worldSize,l,1];return c.av(_,_,this._viewProjMatrix),_[2]/_[3]}getProjectionData(n){const{overscaledTileID:l,aligned:p,applyTerrainMatrix:_}=n,w=this._helper.getMercatorTileCoordinates(l),E=l?this.calculatePosMatrix(l,p,!0):null;let M;return M=l&&l.terrainRttPosMatrix32f&&_?l.terrainRttPosMatrix32f:E||c.b7(),{mainMatrix:M,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:M}}isLocationOccluded(n){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(n,l,p){return 1}transformLightDirection(n){return c.aS(n)}getRayDirectionFromPixel(n){throw new Error("Not implemented.")}projectTileCoordinates(n,l,p,_){const w=this.calculatePosMatrix(p);let E;_?(E=[n,l,_(n,l),1],c.av(E,E,w)):(E=[n,l,0,1],ko(E,E,w));const M=E[3];return{point:new c.P(E[0]/M,E[1]/M),signedDistanceFromCamera:M,isOccluded:!1}}populateCache(n){for(const l of n)this.calculatePosMatrix(l)}getMatrixForModel(n,l){const p=c.a0.fromLngLat(n,l),_=p.meterInMercatorCoordinateUnits(),w=c.b8();return c.M(w,w,[p.x,p.y,p.z]),c.b5(w,w,Math.PI),c.b6(w,w,Math.PI/2),c.N(w,w,[-_,_,_]),w}getProjectionDataForCustomLayer(n=!0){const l=new c.Z(0,0,0,0,0),p=this.getProjectionData({overscaledTileID:l,applyGlobeMatrix:n}),_=ue(l,this.worldSize);c.O(_,this._viewProjMatrix,_),p.tileMercatorCoords=[0,0,1,1];const w=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],E=c.b9();return c.N(E,_,w),p.fallbackMatrix=E,p.mainMatrix=E,p}getFastPathSimpleProjectionMatrix(n){return this.calculatePosMatrix(n)}}function $r(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Er(b){if(b.useSlerp)if(b.k<1){const n=c.ba(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),l=c.ba(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),p=new Float64Array(4);c.bb(p,n,l,b.k);const _=c.bc(p);b.tr.setRoll(_.roll),b.tr.setPitch(_.pitch),b.tr.setBearing(_.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(c.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(c.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(c.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function pr(b,n,l,p,_){const w=_.padding,E=$e(_.worldSize,l.getNorthWest()),M=$e(_.worldSize,l.getNorthEast()),D=$e(_.worldSize,l.getSouthEast()),O=$e(_.worldSize,l.getSouthWest()),V=c.ad(-p),$=E.rotate(V),j=M.rotate(V),H=D.rotate(V),ee=O.rotate(V),de=new c.P(Math.max($.x,j.x,ee.x,H.x),Math.max($.y,j.y,ee.y,H.y)),he=new c.P(Math.min($.x,j.x,ee.x,H.x),Math.min($.y,j.y,ee.y,H.y)),fe=de.sub(he),ye=(_.width-(w.left+w.right+n.left+n.right))/fe.x,Te=(_.height-(w.top+w.bottom+n.top+n.bottom))/fe.y;if(Te<0||ye<0)return void $r();const _e=Math.min(c.aj(_.scale*Math.min(ye,Te)),b.maxZoom),Ae=c.P.convert(b.offset),Me=new c.P((n.left-n.right)/2,(n.top-n.bottom)/2).rotate(c.ad(p)),ve=Ae.add(Me).mult(_.scale/c.ae(_e));return{center:ne(_.worldSize,E.add(D).div(2).sub(ve)),zoom:_e,bearing:p}}class ds{get useGlobeControls(){return!1}handlePanInertia(n,l){return{easingOffset:n,easingCenter:l.center}}handleMapControlsRollPitchBearingZoom(n,l){n.bearingDelta&&l.setBearing(l.bearing+n.bearingDelta),n.pitchDelta&&l.setPitch(l.pitch+n.pitchDelta),n.rollDelta&&l.setRoll(l.roll+n.rollDelta),n.zoomDelta&&l.setZoom(l.zoom+n.zoomDelta)}handleMapControlsPan(n,l,p){n.around.distSqr(l.centerPoint)<.01||l.setLocationAtPoint(p,n.around)}cameraForBoxAndBearing(n,l,p,_,w){return pr(n,l,p,_,w)}handleJumpToCenterZoom(n,l){n.zoom!==(l.zoom!==void 0?+l.zoom:n.zoom)&&n.setZoom(+l.zoom),l.center!==void 0&&n.setCenter(c.S.convert(l.center))}handleEaseTo(n,l){const p=n.zoom,_=n.padding,w={roll:n.roll,pitch:n.pitch,bearing:n.bearing},E={roll:l.roll===void 0?n.roll:l.roll,pitch:l.pitch===void 0?n.pitch:l.pitch,bearing:l.bearing===void 0?n.bearing:l.bearing},M=l.zoom!==void 0,D=!n.isPaddingEqual(l.padding);let O=!1;const V=M?+l.zoom:n.zoom;let $=n.centerPoint.add(l.offsetAsPoint);const j=n.screenPointToLocation($),{center:H,zoom:ee}=n.getConstrained(c.S.convert(l.center||j),V??p);zi(n,H);const de=$e(n.worldSize,j),he=$e(n.worldSize,H).sub(de),fe=c.ae(ee-p);return O=ee!==p,{easeFunc:ye=>{if(O&&n.setZoom(c.C.number(p,ee,ye)),c.bd(w,E)||Er({startEulerAngles:w,endEulerAngles:E,tr:n,k:ye,useSlerp:w.roll!=E.roll}),D&&(n.interpolatePadding(_,l.padding,ye),$=n.centerPoint.add(l.offsetAsPoint)),l.around)n.setLocationAtPoint(l.around,l.aroundPoint);else{const Te=c.ae(n.zoom-p),_e=ee>p?Math.min(2,fe):Math.max(.5,fe),Ae=Math.pow(_e,1-ye),Me=ne(n.worldSize,de.add(he.mult(ye*Ae)).mult(Te));n.setLocationAtPoint(n.renderWorldCopies?Me.wrap():Me,$)}},isZooming:O,elevationCenter:H}}handleFlyTo(n,l){const p=l.zoom!==void 0,_=n.zoom,w=n.getConstrained(c.S.convert(l.center||l.locationAtOffset),p?+l.zoom:_),E=w.center,M=w.zoom;zi(n,E);const D=$e(n.worldSize,l.locationAtOffset),O=$e(n.worldSize,E).sub(D),V=O.mag(),$=c.ae(M-_);let j;if(l.minZoom!==void 0){const H=Math.min(+l.minZoom,_,M),ee=n.getConstrained(E,H).zoom;j=c.ae(ee-_)}return{easeFunc:(H,ee,de,he)=>{n.setZoom(H===1?M:_+c.aj(ee));const fe=H===1?E:ne(n.worldSize,D.add(O.mult(de)).mult(ee));n.setLocationAtPoint(n.renderWorldCopies?fe.wrap():fe,he)},scaleOfZoom:$,targetCenter:E,scaleOfMinZoom:j,pixelPathLength:V}}}class En{constructor(n,l,p){this.blendFunction=n,this.blendColor=l,this.mask=p}}En.Replace=[1,0],En.disabled=new En(En.Replace,c.be.transparent,[!1,!1,!1,!1]),En.unblended=new En(En.Replace,c.be.transparent,[!0,!0,!0,!0]),En.alphaBlended=new En([1,771],c.be.transparent,[!0,!0,!0,!0]);const fi=2305;class mn{constructor(n,l,p){this.enable=n,this.mode=l,this.frontFace=p}}mn.disabled=new mn(!1,1029,fi),mn.backCCW=new mn(!0,1029,fi),mn.frontCCW=new mn(!0,1028,fi);class dn{constructor(n,l,p){this.func=n,this.mask=l,this.range=p}}dn.ReadOnly=!1,dn.ReadWrite=!0,dn.disabled=new dn(519,dn.ReadOnly,[0,1]);const Ta=7680;class an{constructor(n,l,p,_,w,E){this.test=n,this.ref=l,this.mask=p,this.fail=_,this.depthFail=w,this.pass=E}}an.disabled=new an({func:519,mask:0},0,0,Ta,Ta,Ta);const Jr=new WeakMap;function Mn(b){var n;if(Jr.has(b))return Jr.get(b);{const l=(n=b.getParameter(b.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return Jr.set(b,l),l}}class uo{get awaitingQuery(){return!!this._readbackQueue}constructor(n){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=n;const l=n.context,p=l.gl;this._texFormat=p.RGBA,this._texType=p.UNSIGNED_BYTE;const _=new c.aK;_.emplaceBack(-1,-1),_.emplaceBack(2,-1),_.emplaceBack(-1,2);const w=new c.aM;w.emplaceBack(0,1,2),this._fullscreenTriangle=new us(l.createVertexBuffer(_,cs.members),l.createIndexBuffer(w),c.aL.simpleSegment(0,0,_.length,w.length)),this._resultBuffer=new Uint8Array(4),l.activeTexture.set(p.TEXTURE1);const E=p.createTexture();p.bindTexture(p.TEXTURE_2D,E),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texImage2D(p.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=l.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),Mn(p)&&(this._pbo=p.createBuffer(),p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.bufferData(p.PIXEL_PACK_BUFFER,4,p.STREAM_READ),p.bindBuffer(p.PIXEL_PACK_BUFFER,null))}destroy(){const n=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),n.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(n,l){const p=this._updateCount;return this._readbackQueue?p>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():p>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(n,l),this._updateCount++,this._measuredError}_bindFramebuffer(){const n=this._cachedRenderContext.context,l=n.gl;n.activeTexture.set(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,this._fbo.colorAttachment.get()),n.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(n,l){const p=this._cachedRenderContext.context,_=p.gl;if(this._bindFramebuffer(),p.viewport.set([0,0,this._texWidth,this._texHeight]),p.clear({color:c.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(p,_.TRIANGLES,dn.disabled,an.disabled,En.unblended,mn.disabled,((w,E)=>({u_input:w,u_output_expected:E}))(n,l),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Mn(_)){_.bindBuffer(_.PIXEL_PACK_BUFFER,this._pbo),_.readBuffer(_.COLOR_ATTACHMENT0),_.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),_.bindBuffer(_.PIXEL_PACK_BUFFER,null);const w=_.fenceSync(_.SYNC_GPU_COMMANDS_COMPLETE,0);_.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const n=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Mn(n)){const l=n.clientWaitSync(this._readbackQueue.sync,0,0);if(l===n.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(l===n.TIMEOUT_EXPIRED)return;n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),n.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=uo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(n){let l=0;return l+=n[0]/256,l+=n[1]/65536,l+=n[2]/16777216,n[3]<127&&(l=-l),l/128}}const ia=c.$/128;function bc(b,n){const l=b.granularity!==void 0?Math.max(b.granularity,1):1,p=l+(b.generateBorders?2:0),_=l+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),w=p+1,E=_+1,M=b.generateBorders?-1:0,D=b.generateBorders||b.extendToNorthPole?-1:0,O=l+(b.generateBorders?1:0),V=l+(b.generateBorders||b.extendToSouthPole?1:0),$=w*E,j=p*_*6,H=w*E>65536;if(H&&n==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ee=H||n==="32bit",de=new Int16Array(2*$);let he=0;for(let Te=D;Te<=V;Te++)for(let _e=M;_e<=O;_e++){let Ae=_e/l*c.$;_e===-1&&(Ae=-64),_e===l+1&&(Ae=c.$+ia);let Me=Te/l*c.$;Te===-1&&(Me=b.extendToNorthPole?c.bg:-64),Te===l+1&&(Me=b.extendToSouthPole?c.bh:c.$+ia),de[he++]=Ae,de[he++]=Me}const fe=ee?new Uint32Array(j):new Uint16Array(j);let ye=0;for(let Te=0;Te<_;Te++)for(let _e=0;_e<p;_e++){const Ae=_e+1+Te*w,Me=_e+(Te+1)*w,ve=_e+1+(Te+1)*w;fe[ye++]=_e+Te*w,fe[ye++]=Me,fe[ye++]=Ae,fe[ye++]=Ae,fe[ye++]=Me,fe[ye++]=ve}return{vertices:de.buffer.slice(0),indices:fe.buffer.slice(0),uses32bitIndices:ee}}const Na=new c.aJ({fill:new c.bi(128,2),line:new c.bi(512,0),tile:new c.bi(128,32),stencil:new c.bi(128,1),circle:3});class xu{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return wa.projectionGlobe}get vertexShaderPreludeCode(){return wa.projectionMercator.vertexSource}get subdivisionGranularity(){return Na}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(n){this._errorMeasurement||(this._errorMeasurement=new uo(n));const l=c.U(this._errorQueryLatitudeDegrees),p=2*Math.atan(Math.exp(Math.PI-l*Math.PI*2))-.5*Math.PI,_=this._errorMeasurement.updateErrorLoop(l,p),w=G.now();_!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=_,this._errorMeasurementLastChangeTime=w);const E=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bk(E))}_getMeshKey(n){return`${n.granularity.toString(36)}_${n.generateBorders?"b":""}${n.extendToNorthPole?"n":""}${n.extendToSouthPole?"s":""}`}getMeshFromTileID(n,l,p,_,w){const E=(w==="stencil"?Na.stencil:Na.tile).getGranularityForZoomLevel(l.z);return this._getMesh(n,{granularity:E,generateBorders:p,extendToNorthPole:l.y===0&&_,extendToSouthPole:l.y===(1<<l.z)-1&&_})}_getMesh(n,l){const p=this._getMeshKey(l);if(p in this._tileMeshCache)return this._tileMeshCache[p];const _=function(w,E){const M=bc(E,"16bit"),D=c.aK.deserialize({arrayBuffer:M.vertices,length:M.vertices.byteLength/2/2}),O=c.aM.deserialize({arrayBuffer:M.indices,length:M.indices.byteLength/2/3});return new us(w.createVertexBuffer(D,cs.members),w.createIndexBuffer(O),c.aL.simpleSegment(0,0,D.length,O.length))}(n,l);return this._tileMeshCache[p]=_,_}recalculate(n){}hasTransition(){const n=G.now();let l=!1;return l=l||(n-this._errorMeasurementLastChangeTime)/1e3<.7,l=l||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,l}setErrorQueryLatitudeDegrees(n){this._errorQueryLatitudeDegrees=n}}const co=new c.r({type:new c.D(c.v.projection.type)});class ho extends c.E{constructor(n){super(),this._transitionable=new c.t(co),this.setProjection(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new zl,this._verticalPerspectiveProjection=new xu}get transitionState(){const n=this.properties.get("type");if(typeof n=="string"&&n==="mercator")return 0;if(typeof n=="string"&&n==="vertical-perspective")return 1;if(n instanceof c.bl){if(n.from==="vertical-perspective"&&n.to==="mercator")return 1-n.transition;if(n.from==="mercator"&&n.to==="vertical-perspective")return n.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(n){this._mercatorProjection.updateGPUdependent(n),this._verticalPerspectiveProjection.updateGPUdependent(n)}getMeshFromTileID(n,l,p,_,w){return this.currentProjection.getMeshFromTileID(n,l,p,_,w)}setProjection(n){this._transitionable.setValue("type",(n==null?void 0:n.type)||"mercator")}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}setErrorQueryLatitudeDegrees(n){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(n),this._mercatorProjection.setErrorQueryLatitudeDegrees(n)}}function Sa(b){const n=Vs(b.worldSize,b.center.lat);return 2*Math.PI*n}function Ya(b,n,l,p,_){const w=1/(1<<_),E=n/c.$*w+p*w,M=c.bn((b/c.$*w+l*w)*Math.PI*2+Math.PI,2*Math.PI),D=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,O=Math.cos(D),V=new Float64Array(3);return V[0]=Math.sin(M)*O,V[1]=Math.sin(D),V[2]=Math.cos(M)*O,V}function Oi(b){return function(n,l){const p=Math.cos(l),_=new Float64Array(3);return _[0]=Math.sin(n)*p,_[1]=Math.sin(l),_[2]=Math.cos(n)*p,_}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function Vs(b,n){return b/(2*Math.PI)/Math.cos(n*Math.PI/180)}function No(b){const n=Math.asin(b[1])/Math.PI*180,l=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(l>1e-6){const p=b[0]/l,_=Math.acos(b[2]/l),w=(p>0?_:-_)/Math.PI*180;return new c.S(c.aN(w,-180,180),n)}return new c.S(0,n)}function Bo(b){return Math.cos(b*Math.PI/180)}function Xr(b,n){const l=Bo(b),p=Bo(n);return c.aj(p/l)}function Nl(b,n){const l=b.rotate(n.bearingInRadians),p=n.zoom+Xr(n.center.lat,0),_=c.bj(1/Bo(n.center.lat),1/Bo(Math.min(Math.abs(n.center.lat),60)),c.bm(p,7,3,0,1)),w=360/Sa({worldSize:n.worldSize,center:{lat:n.center.lat}});return new c.S(n.center.lng-l.x*w*_,c.ag(n.center.lat+l.y*w,-85.051129,c.ah))}function fo(b){const n=.5*b,l=Math.sin(n),p=Math.cos(n);return Math.log(l+p)-Math.log(p-l)}function Bl(b,n,l,p){const _=b.lat+l*p;if(Math.abs(l)>1){const w=(Math.sign(b.lat+l)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,E=Math.abs(b.lat+l)*Math.PI/180,M=fo(w+p*(E-w)),D=fo(w),O=fo(E);return new c.S(b.lng+n*((M-D)/(O-D)),_)}return new c.S(b.lng+n*p,_)}class fh{constructor(n){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=n}swapBuffers(){if(!this._hadAnyChanges)return;const n=this._cachePrevious;this._cachePrevious=this._cache,this._cache=n,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(n,l,p,_){const w=`${n.z}_${n.x}_${n.y}_${_!=null&&_.terrain?"t":""}`,E=this._cache.get(w);if(E)return E;const M=this._cachePrevious.get(w);if(M)return this._cache.set(w,M),M;const D=this._boundingVolumeFactory(n,l,p,_);return this._cache.set(w,D),this._hadAnyChanges=!0,D}}class Qa{constructor(n,l,p,_){this.min=p,this.max=_,this.points=n,this.planes=l}static fromAabb(n,l){const p=[];for(let _=0;_<8;_++)p.push([1&~_?n[0]:l[0],(_>>1&1)==1?l[1]:n[1],(_>>2&1)==1?l[2]:n[2]]);return new Qa(p,[[-1,0,0,l[0]],[1,0,0,-n[0]],[0,-1,0,l[1]],[0,1,0,-n[1]],[0,0,-1,l[2]],[0,0,1,-n[2]]],n,l)}static fromCenterSizeAngles(n,l,p){const _=c.bq([],p[0],p[1],p[2]),w=c.br([],[l[0],0,0],_),E=c.br([],[0,l[1],0],_),M=c.br([],[0,0,l[2]],_),D=[...n],O=[...n];for(let $=0;$<8;$++)for(let j=0;j<3;j++){const H=n[j]+w[j]*(1&~$?-1:1)+E[j]*(($>>1&1)==1?1:-1)+M[j]*(($>>2&1)==1?1:-1);D[j]=Math.min(D[j],H),O[j]=Math.max(O[j],H)}const V=[];for(let $=0;$<8;$++){const j=[...n];c.aR(j,j,c.aQ([],w,1&~$?-1:1)),c.aR(j,j,c.aQ([],E,($>>1&1)==1?1:-1)),c.aR(j,j,c.aQ([],M,($>>2&1)==1?1:-1)),V.push(j)}return new Qa(V,[[...w,-c.aW(w,V[0])],[...E,-c.aW(E,V[0])],[...M,-c.aW(M,V[0])],[-w[0],-w[1],-w[2],-c.aW(w,V[7])],[-E[0],-E[1],-E[2],-c.aW(E,V[7])],[-M[0],-M[1],-M[2],-c.aW(M,V[7])]],D,O)}intersectsFrustum(n){let l=!0;const p=this.points.length,_=this.planes.length,w=n.planes.length,E=n.points.length;for(let M=0;M<w;M++){const D=n.planes[M];let O=0;for(let V=0;V<p;V++){const $=this.points[V];D[0]*$[0]+D[1]*$[1]+D[2]*$[2]+D[3]>=0&&O++}if(O===0)return 0;O<p&&(l=!1)}if(l)return 2;for(let M=0;M<_;M++){const D=this.planes[M];let O=0;for(let V=0;V<E;V++){const $=n.points[V];D[0]*$[0]+D[1]*$[1]+D[2]*$[2]+D[3]>=0&&O++}if(O===0)return 0}return 1}intersectsPlane(n){const l=this.points.length;let p=0;for(let _=0;_<l;_++){const w=this.points[_];n[0]*w[0]+n[1]*w[1]+n[2]*w[2]+n[3]>=0&&p++}return p===l?2:p===0?0:1}}function Vl(b,n,l){const p=b-n;return p<0?-p:Math.max(0,p-l)}function xc(b,n,l,p,_){const w=b-l;let E;return E=w<0?Math.min(-w,1+w-_):w>1?Math.min(Math.max(w-_,0),1-w):0,Math.max(E,Vl(n,p,_))}class ph{constructor(){this._boundingVolumeCache=new fh(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(n,l,p,_){const w=1<<p.z,E=1/w,M=p.x/w,D=p.y/w;let O=2;return O=Math.min(O,xc(n,l,M,D,E)),O=Math.min(O,xc(n,l,M+.5,-D-E,E)),O=Math.min(O,xc(n,l,M+.5,2-D-E,E)),O}getWrap(n,l,p){const _=1<<l.z,w=1/_,E=l.x/_,M=Vl(n.x,E,w),D=Vl(n.x,E-1,w),O=Vl(n.x,E+1,w),V=Math.min(M,D,O);return V===O?1:V===D?-1:0}allowVariableZoom(n,l){return lt(n,l)>4}allowWorldCopies(){return!1}getTileBoundingVolume(n,l,p,_){return this._boundingVolumeCache.getTileBoundingVolume(n,l,p,_)}_computeTileBoundingVolume(n,l,p,_){var w,E;let M=p,D=p;if(_!=null&&_.terrain){const O=new c.Z(n.z,l,n.z,n.x,n.y),V=_.terrain.getMinMaxElevation(O);M=(w=V.minElevation)!==null&&w!==void 0?w:p,D=(E=V.maxElevation)!==null&&E!==void 0?E:p}if(M/=c.bt,D/=c.bt,M+=1,D+=1,n.z<=0)return Qa.fromAabb([-D,-D,-D],[D,D,D]);if(n.z===1)return Qa.fromAabb([n.x===0?-D:0,n.y===0?0:-D,-D],[n.x===0?0:D,n.y===0?D:0,D]);{const O=[Ya(0,0,n.x,n.y,n.z),Ya(c.$,0,n.x,n.y,n.z),Ya(c.$,c.$,n.x,n.y,n.z),Ya(0,c.$,n.x,n.y,n.z)],V=[];for(const Ye of O)V.push(c.aQ([],Ye,D));if(D!==M)for(const Ye of O)V.push(c.aQ([],Ye,M));n.y===0&&V.push([0,1,0]),n.y===(1<<n.z)-1&&V.push([0,-1,0]);const $=[1,1,1],j=[-1,-1,-1];for(const Ye of V)for(let at=0;at<3;at++)$[at]=Math.min($[at],Ye[at]),j[at]=Math.max(j[at],Ye[at]);const H=Ya(c.$/2,c.$/2,n.x,n.y,n.z),ee=c.aV([],[0,1,0],H);c.aU(ee,ee);const de=c.aV([],H,ee);c.aU(de,de);const he=c.aV([],O[2],O[1]);c.aU(he,he);const fe=c.aV([],O[0],O[3]);c.aU(fe,fe),V.push(c.aQ([],H,D)),n.y>=(1<<n.z)/2&&V.push(c.aQ([],Ya(c.$/2,0,n.x,n.y,n.z),D)),n.y<(1<<n.z)/2&&V.push(c.aQ([],Ya(c.$/2,c.$,n.x,n.y,n.z),D));const ye=_i(H,V),Te=_i(de,V),_e=[-H[0],-H[1],-H[2],ye.max],Ae=[H[0],H[1],H[2],-ye.min],Me=[-de[0],-de[1],-de[2],Te.max],ve=[de[0],de[1],de[2],-Te.min],Ne=[...he,0],tt=[...fe,0],Xe=[];return n.y===0?Xe.push(c.bs(tt,Ne,_e),c.bs(tt,Ne,Ae)):Xe.push(c.bs(Me,Ne,_e),c.bs(Me,Ne,Ae),c.bs(Me,tt,_e),c.bs(Me,tt,Ae)),n.y===(1<<n.z)-1?Xe.push(c.bs(tt,Ne,_e),c.bs(tt,Ne,Ae)):Xe.push(c.bs(ve,Ne,_e),c.bs(ve,Ne,Ae),c.bs(ve,tt,_e),c.bs(ve,tt,Ae)),new Qa(Xe,[_e,Ae,Me,ve,Ne,tt],$,j)}}}function _i(b,n){let l=1/0,p=-1/0;for(const _ of n){const w=c.aW(b,_);l=Math.min(l,w),p=Math.max(p,w)}return{min:l,max:p}}class sl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,l,p){return this._helper.interpolatePadding(n,l,p)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,l){this._helper.resize(n,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,l){this._helper.overrideNearFarZ(n,l)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n){}constructor(){this._cachedClippingPlane=c.bu(),this._projectionMatrix=c.b8(),this._globeViewProjMatrix32f=c.b7(),this._globeViewProjMatrixNoCorrection=c.b8(),this._globeViewProjMatrixNoCorrectionInverted=c.b8(),this._globeProjMatrixInverted=c.b8(),this._cameraPosition=c.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new hs({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,l)=>this.getConstrained(n,l)}),this._coveringTilesDetailsProvider=new ph}clone(){const n=new sl;return n.apply(this),n}apply(n,l){this._globeLatitudeErrorCorrectionRadians=l||0,this._helper.apply(n)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const n=c.bo();return n[0]=this._cameraPosition[0],n[1]=this._cameraPosition[1],n[2]=this._cameraPosition[2],n}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(n){const{overscaledTileID:l,applyGlobeMatrix:p}=n,_=this._helper.getMercatorTileCoordinates(l);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:_,clippingPlane:this._cachedClippingPlane,projectionTransition:p?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(n){const l=this.pitchInRadians,p=this.cameraToCenterDistance/n,_=Math.sin(l)*p,w=Math.cos(l)*p+1,E=1/Math.sqrt(_*_+w*w)*1;let M=-_,D=w;const O=Math.sqrt(M*M+D*D);M/=O,D/=O;const V=[0,M,D];c.bv(V,V,[0,0,0],-this.bearingInRadians),c.bw(V,V,[0,0,0],-1*this.center.lat*Math.PI/180),c.bx(V,V,[0,0,0],this.center.lng*Math.PI/180);const $=1/c.aY(V);return c.aQ(V,V,$),[...V,-E*$]}isLocationOccluded(n){return!this.isSurfacePointVisible(Oi(n))}transformLightDirection(n){const l=this._helper._center.lng*Math.PI/180,p=this._helper._center.lat*Math.PI/180,_=Math.cos(p),w=[Math.sin(l)*_,Math.sin(p),Math.cos(l)*_],E=[w[2],0,-w[0]],M=[0,0,0];c.aV(M,E,w),c.aU(E,E),c.aU(M,M);const D=[0,0,0];return c.aU(D,[E[0]*n[0]+M[0]*n[1]+w[0]*n[2],E[1]*n[0]+M[1]*n[1]+w[1]*n[2],E[2]*n[0]+M[2]*n[1]+w[2]*n[2]]),D}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(n,l,p){const _=function(M,D,O){const V=1/(1<<O.z);return new c.a0(M/c.$*V+O.x*V,D/c.$*V+O.y*V)}(n,l,p.canonical),w=(E=_.y,[c.bn(_.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(n,l,p,_){const w=p.canonical,E=Ya(n,l,w.x,w.y,w.z),M=1+(_?_(n,l):0)/c.bt,D=[E[0]*M,E[1]*M,E[2]*M,1];c.av(D,D,this._globeViewProjMatrixNoCorrection);const O=this._cachedClippingPlane,V=O[0]*E[0]+O[1]*E[1]+O[2]*E[2]+O[3]<0;return{point:new c.P(D[0]/D[3],D[1]/D[3]),signedDistanceFromCamera:D[3],isOccluded:V}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const n=Vs(this.worldSize,this.center.lat),l=c.b9(),p=c.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*n),c.b3(l,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const _=this.centerOffset;l[8]=2*-_.x/this._helper._width,l[9]=2*_.y/this._helper._height,this._projectionMatrix=c.b4(l),this._globeProjMatrixInverted=c.b9(),c.ap(this._globeProjMatrixInverted,l),c.M(l,l,[0,0,-this.cameraToCenterDistance]),c.b5(l,l,this.rollInRadians),c.b6(l,l,-this.pitchInRadians),c.b5(l,l,this.bearingInRadians),c.M(l,l,[0,0,-n]);const w=c.bo();w[0]=n,w[1]=n,w[2]=n,c.b6(p,l,this.center.lat*Math.PI/180),c.by(p,p,-this.center.lng*Math.PI/180),c.N(p,p,w),this._globeViewProjMatrixNoCorrection=p,c.b6(l,l,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.by(l,l,-this.center.lng*Math.PI/180),c.N(l,l,w),this._globeViewProjMatrix32f=new Float32Array(l),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),c.ap(this._globeViewProjMatrixNoCorrectionInverted,p);const E=c.bo();this._cameraPosition=c.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/n,c.bv(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),c.bw(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),c.bv(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),c.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bw(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),c.bx(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(n);const M=c.b4(this._globeViewProjMatrixNoCorrectionInverted);c.N(M,M,[1,1,-1]),this._cachedFrustum=Hi.fromInvProjectionMatrix(M,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(n){c.w("calculateFogMatrix is not supported on globe projection.");const l=c.b9();return c.af(l),l}getVisibleUnwrappedCoordinates(n){return[new c.b1(0,n)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){n&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,l){if(!this._globeViewProjMatrixNoCorrection)return 1;const p=Oi(n);c.aQ(p,p,1+l/c.bt);const _=c.bu();return c.av(_,[p[0],p[1],p[2],1],this._globeViewProjMatrixNoCorrection),_[2]/_[3]}populateCache(n){}getBounds(){const n=.5*this.width,l=.5*this.height,p=[new c.P(0,0),new c.P(n,0),new c.P(this.width,0),new c.P(this.width,l),new c.P(this.width,this.height),new c.P(n,this.height),new c.P(0,this.height),new c.P(0,l)],_=[];for(const $ of p)_.push(this.unprojectScreenPoint($));let w=0,E=0,M=0,D=0;const O=this.center;for(const $ of _){const j=c.bz(O.lng,$.lng),H=c.bz(O.lat,$.lat);j<E&&(E=j),j>w&&(w=j),H<D&&(D=H),H>M&&(M=H)}const V=[O.lng+E,O.lat+D,O.lng+w,O.lat+M];return this.isSurfacePointOnScreen([0,1,0])&&(V[3]=90,V[0]=-180,V[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(V[1]=-90,V[0]=-180,V[2]=180),new Tr(V)}getConstrained(n,l){const p=c.ag(n.lat,-85.051129,c.ah),_=c.ag(+l,this.minZoom+Xr(0,p),this.maxZoom);return{center:new c.S(n.lng,p),zoom:_}}calculateCenterFromCameraLngLatAlt(n,l,p,_){return this._helper.calculateCenterFromCameraLngLatAlt(n,l,p,_)}setLocationAtPoint(n,l){const p=Oi(this.unprojectScreenPoint(l)),_=Oi(n),w=c.bo();c.bA(w);const E=c.bo();c.bx(E,p,w,-this.center.lng*Math.PI/180),c.bw(E,E,w,this.center.lat*Math.PI/180);const M=_[0]*_[0]+_[2]*_[2],D=E[0]*E[0];if(M<D)return;const O=Math.sqrt(M-D),V=-O,$=c.bB(_[0],_[2],E[0],O),j=c.bB(_[0],_[2],E[0],V),H=c.bo();c.bx(H,_,w,-$);const ee=c.bB(H[1],H[2],E[1],E[2]),de=c.bo();c.bx(de,_,w,-j);const he=c.bB(de[1],de[2],E[1],E[2]),fe=.5*Math.PI,ye=ee>=-fe&&ee<=fe,Te=he>=-fe&&he<=fe;let _e,Ae;if(ye&&Te){const tt=this.center.lng*Math.PI/180,Xe=this.center.lat*Math.PI/180;c.bC($,tt)+c.bC(ee,Xe)<c.bC(j,tt)+c.bC(he,Xe)?(_e=$,Ae=ee):(_e=j,Ae=he)}else if(ye)_e=$,Ae=ee;else{if(!Te)return;_e=j,Ae=he}const Me=_e/Math.PI*180,ve=Ae/Math.PI*180,Ne=this.center.lat;this.setCenter(new c.S(Me,c.ag(ve,-90,90))),this.setZoom(this.zoom+Xr(Ne,this.center.lat))}locationToScreenPoint(n,l){const p=Oi(n);if(l){const _=l.getElevationForLngLatZoom(n,this._helper._tileZoom);c.aQ(p,p,1+_/c.bt)}return this._projectSurfacePointToScreen(p)}_projectSurfacePointToScreen(n){const l=c.bu();return c.av(l,[...n,1],this._globeViewProjMatrixNoCorrection),l[0]/=l[3],l[1]/=l[3],new c.P((.5*l[0]+.5)*this.width,(.5*-l[1]+.5)*this.height)}screenPointToMercatorCoordinate(n,l){if(l){const p=l.pointCoordinate(n);if(p)return p}return c.a0.fromLngLat(this.unprojectScreenPoint(n))}screenPointToLocation(n,l){var p;return(p=this.screenPointToMercatorCoordinate(n,l))===null||p===void 0?void 0:p.toLngLat()}isPointOnMapSurface(n,l){const p=this._cameraPosition,_=this.getRayDirectionFromPixel(n);return!!this.rayPlanetIntersection(p,_)}getRayDirectionFromPixel(n){const l=c.bu();l[0]=n.x/this.width*2-1,l[1]=-1*(n.y/this.height*2-1),l[2]=1,l[3]=1,c.av(l,l,this._globeViewProjMatrixNoCorrectionInverted),l[0]/=l[3],l[1]/=l[3],l[2]/=l[3];const p=c.bo();p[0]=l[0]-this._cameraPosition[0],p[1]=l[1]-this._cameraPosition[1],p[2]=l[2]-this._cameraPosition[2];const _=c.bo();return c.aU(_,p),_}isSurfacePointVisible(n){const l=this._cachedClippingPlane;return l[0]*n[0]+l[1]*n[1]+l[2]*n[2]+l[3]>=0}isSurfacePointOnScreen(n){if(!this.isSurfacePointVisible(n))return!1;const l=c.bu();return c.av(l,[...n,1],this._globeViewProjMatrixNoCorrection),l[0]/=l[3],l[1]/=l[3],l[2]/=l[3],l[0]>-1&&l[0]<1&&l[1]>-1&&l[1]<1&&l[2]>-1&&l[2]<1}rayPlanetIntersection(n,l){const p=c.aW(n,l),_=c.bo(),w=c.bo();c.aQ(w,l,p),c.aT(_,n,w);const E=1-c.aW(_,_);if(E<0)return null;const M=c.aW(n,n)-1,D=-p+(p<0?1:-1)*Math.sqrt(E),O=M/D,V=D;return{tMin:Math.min(O,V),tMax:Math.max(O,V)}}unprojectScreenPoint(n){const l=this._cameraPosition,p=this.getRayDirectionFromPixel(n),_=this.rayPlanetIntersection(l,p);if(_){const V=c.bo();c.aR(V,l,[p[0]*_.tMin,p[1]*_.tMin,p[2]*_.tMin]);const $=c.bo();return c.aU($,V),No($)}const w=this._cachedClippingPlane,E=w[0]*p[0]+w[1]*p[1]+w[2]*p[2],M=-c.b0(w,l)/E,D=c.bo();if(M>0)c.aR(D,l,[p[0]*M,p[1]*M,p[2]*M]);else{const V=c.bo();c.aR(V,l,[2*p[0],2*p[1],2*p[2]]);const $=c.b0(this._cachedClippingPlane,V);c.aT(D,V,[this._cachedClippingPlane[0]*$,this._cachedClippingPlane[1]*$,this._cachedClippingPlane[2]*$])}const O=function(V){const $=c.bo();return $[0]=V[0]*-V[3],$[1]=V[1]*-V[3],$[2]=V[2]*-V[3],{center:$,radius:Math.sqrt(1-V[3]*V[3])}}(w);return No(function(V,$,j){const H=c.bo();c.aT(H,j,V);const ee=c.bo();return c.bp(ee,V,H,$/c.a_(H)),ee}(O.center,O.radius,D))}getMatrixForModel(n,l){const p=c.S.convert(n),_=1/c.bt,w=c.b8();return c.by(w,w,p.lng/180*Math.PI),c.b6(w,w,-p.lat/180*Math.PI),c.M(w,w,[0,0,1+l/c.bt]),c.b6(w,w,.5*Math.PI),c.N(w,w,[_,_,_]),w}getProjectionDataForCustomLayer(n=!0){const l=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:n});return l.tileMercatorCoords=[0,0,1,1],l}getFastPathSimpleProjectionMatrix(n){}}class aa{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,l,p){return this._helper.interpolatePadding(n,l,p)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,l,p=!0){this._helper.resize(n,l,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,l){this._helper.overrideNearFarZ(n,l)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(n,l){this._globeness=n,this._globeLatitudeErrorCorrectionRadians=l,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new hs({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,l)=>this.getConstrained(n,l)}),this._globeness=1,this._mercatorTransform=new jr,this._verticalPerspectiveTransform=new sl}clone(){const n=new aa;return n._globeness=this._globeness,n._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,n.apply(this),n}apply(n){this._helper.apply(n),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(n){const l=this._mercatorTransform.getProjectionData(n),p=this._verticalPerspectiveTransform.getProjectionData(n);return{mainMatrix:this.isGlobeRendering?p.mainMatrix:l.mainMatrix,clippingPlane:p.clippingPlane,tileMercatorCoords:p.tileMercatorCoords,projectionTransition:n.applyGlobeMatrix?this._globeness:0,fallbackMatrix:l.fallbackMatrix}}isLocationOccluded(n){return this.currentTransform.isLocationOccluded(n)}transformLightDirection(n){return this.currentTransform.transformLightDirection(n)}getPixelScale(){return c.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(n,l,p){const _=this._mercatorTransform.getPitchedTextCorrection(n,l,p),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(n,l,p);return c.bj(_,w,this._globeness)}projectTileCoordinates(n,l,p,_){return this.currentTransform.projectTileCoordinates(n,l,p,_)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(n){return this.currentTransform.calculateFogMatrix(n)}getVisibleUnwrappedCoordinates(n){return this.currentTransform.getVisibleUnwrappedCoordinates(n)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(n){this._mercatorTransform.recalculateZoomAndCenter(n),this._verticalPerspectiveTransform.recalculateZoomAndCenter(n)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,l){return this.currentTransform.lngLatToCameraDepth(n,l)}populateCache(n){this._mercatorTransform.populateCache(n),this._verticalPerspectiveTransform.populateCache(n)}getBounds(){return this.currentTransform.getBounds()}getConstrained(n,l){return this.currentTransform.getConstrained(n,l)}calculateCenterFromCameraLngLatAlt(n,l,p,_){return this._helper.calculateCenterFromCameraLngLatAlt(n,l,p,_)}setLocationAtPoint(n,l){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(n,l),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(n,l),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(n,l){return this.currentTransform.locationToScreenPoint(n,l)}screenPointToMercatorCoordinate(n,l){return this.currentTransform.screenPointToMercatorCoordinate(n,l)}screenPointToLocation(n,l){return this.currentTransform.screenPointToLocation(n,l)}isPointOnMapSurface(n,l){return this.currentTransform.isPointOnMapSurface(n,l)}getRayDirectionFromPixel(n){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(n)}getMatrixForModel(n,l){return this.currentTransform.getMatrixForModel(n,l)}getProjectionDataForCustomLayer(n=!0){const l=this._mercatorTransform.getProjectionDataForCustomLayer(n);if(!this.isGlobeRendering)return l;const p=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(n);return p.fallbackMatrix=l.mainMatrix,p}getFastPathSimpleProjectionMatrix(n){return this.currentTransform.getFastPathSimpleProjectionMatrix(n)}}class da{get useGlobeControls(){return!0}handlePanInertia(n,l){const p=Nl(n,l);return Math.abs(p.lng-l.center.lng)>180&&(p.lng=l.center.lng+179.5*Math.sign(p.lng-l.center.lng)),{easingCenter:p,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(n,l){const p=n.around,_=l.screenPointToLocation(p);n.bearingDelta&&l.setBearing(l.bearing+n.bearingDelta),n.pitchDelta&&l.setPitch(l.pitch+n.pitchDelta),n.rollDelta&&l.setRoll(l.roll+n.rollDelta);const w=l.zoom;n.zoomDelta&&l.setZoom(l.zoom+n.zoomDelta);const E=l.zoom-w;if(E===0)return;const M=c.bz(l.center.lng,_.lng),D=M/(Math.abs(M/180)+1),O=c.bz(l.center.lat,_.lat),V=l.getRayDirectionFromPixel(p),$=l.cameraPosition,j=-1*c.aW($,V),H=c.bo();c.aR(H,$,[V[0]*j,V[1]*j,V[2]*j]);const ee=c.aY(H)-1,de=Math.exp(.5*-Math.max(ee-.3,0)),he=Vs(l.worldSize,l.center.lat)/Math.min(l.width,l.height),fe=c.bm(he,.9,.5,1,.25),ye=(1-c.ae(-E))*Math.min(de,fe),Te=l.center.lat,_e=l.zoom,Ae=new c.S(l.center.lng+D*ye,c.ag(l.center.lat+O*ye,-85.051129,c.ah));l.setLocationAtPoint(_,p);const Me=l.center,ve=c.bm(Math.abs(M),45,85,0,1),Ne=c.bm(he,.75,.35,0,1),tt=Math.pow(Math.max(ve,Ne),.25),Xe=c.bz(Me.lng,Ae.lng),Ye=c.bz(Me.lat,Ae.lat);l.setCenter(new c.S(Me.lng+Xe*tt,Me.lat+Ye*tt).wrap()),l.setZoom(_e+Xr(Te,l.center.lat))}handleMapControlsPan(n,l,p){if(!n.panDelta)return;const _=l.center.lat,w=l.zoom;l.setCenter(Nl(n.panDelta,l).wrap()),l.setZoom(w+Xr(_,l.center.lat))}cameraForBoxAndBearing(n,l,p,_,w){const E=pr(n,l,p,_,w),M=l.left/w.width*2-1,D=(w.width-l.right)/w.width*2-1,O=l.top/w.height*-2+1,V=(w.height-l.bottom)/w.height*-2+1,$=c.bz(p.getWest(),p.getEast())<0,j=$?p.getEast():p.getWest(),H=$?p.getWest():p.getEast(),ee=Math.max(p.getNorth(),p.getSouth()),de=Math.min(p.getNorth(),p.getSouth()),he=j+.5*c.bz(j,H),fe=ee+.5*c.bz(ee,de),ye=w.clone();ye.setCenter(E.center),ye.setBearing(E.bearing),ye.setPitch(0),ye.setRoll(0),ye.setZoom(E.zoom);const Te=ye.modelViewProjectionMatrix,_e=[Oi(p.getNorthWest()),Oi(p.getNorthEast()),Oi(p.getSouthWest()),Oi(p.getSouthEast()),Oi(new c.S(H,fe)),Oi(new c.S(j,fe)),Oi(new c.S(he,ee)),Oi(new c.S(he,de))],Ae=Oi(E.center);let Me=Number.POSITIVE_INFINITY;for(const ve of _e)M<0&&(Me=da.getLesserNonNegativeNonNull(Me,da.solveVectorScale(ve,Ae,Te,"x",M))),D>0&&(Me=da.getLesserNonNegativeNonNull(Me,da.solveVectorScale(ve,Ae,Te,"x",D))),O>0&&(Me=da.getLesserNonNegativeNonNull(Me,da.solveVectorScale(ve,Ae,Te,"y",O))),V<0&&(Me=da.getLesserNonNegativeNonNull(Me,da.solveVectorScale(ve,Ae,Te,"y",V)));if(Number.isFinite(Me)&&Me!==0)return E.zoom=ye.zoom+c.aj(Me),E;$r()}handleJumpToCenterZoom(n,l){const p=n.center.lat,_=n.getConstrained(l.center?c.S.convert(l.center):n.center,n.zoom).center;n.setCenter(_.wrap());const w=l.zoom!==void 0?+l.zoom:n.zoom+Xr(p,_.lat);n.zoom!==w&&n.setZoom(w)}handleEaseTo(n,l){const p=n.zoom,_=n.center,w=n.padding,E={roll:n.roll,pitch:n.pitch,bearing:n.bearing},M={roll:l.roll===void 0?n.roll:l.roll,pitch:l.pitch===void 0?n.pitch:l.pitch,bearing:l.bearing===void 0?n.bearing:l.bearing},D=l.zoom!==void 0,O=!n.isPaddingEqual(l.padding);let V=!1;const $=l.center?c.S.convert(l.center):_,j=n.getConstrained($,p).center;zi(n,j);const H=n.clone();H.setCenter(j),H.setZoom(D?+l.zoom:p+Xr(_.lat,$.lat)),H.setBearing(l.bearing);const ee=new c.P(c.ag(n.centerPoint.x+l.offsetAsPoint.x,0,n.width),c.ag(n.centerPoint.y+l.offsetAsPoint.y,0,n.height));H.setLocationAtPoint(j,ee);const de=(l.offset&&l.offsetAsPoint.mag())>0?H.center:j,he=D?+l.zoom:p+Xr(_.lat,de.lat),fe=p+Xr(_.lat,0),ye=he+Xr(de.lat,0),Te=c.bz(_.lng,de.lng),_e=c.bz(_.lat,de.lat),Ae=c.ae(ye-fe);return V=he!==p,{easeFunc:Me=>{if(c.bd(E,M)||Er({startEulerAngles:E,endEulerAngles:M,tr:n,k:Me,useSlerp:E.roll!=M.roll}),O&&n.interpolatePadding(w,l.padding,Me),l.around)c.w("Easing around a point is not supported under globe projection."),n.setLocationAtPoint(l.around,l.aroundPoint);else{const ve=ye>fe?Math.min(2,Ae):Math.max(.5,Ae),Ne=Math.pow(ve,1-Me),tt=Bl(_,Te,_e,Me*Ne);n.setCenter(tt.wrap())}if(V){const ve=c.C.number(fe,ye,Me)+Xr(0,n.center.lat);n.setZoom(ve)}},isZooming:V,elevationCenter:de}}handleFlyTo(n,l){const p=l.zoom!==void 0,_=n.center,w=n.zoom,E=n.padding,M=!n.isPaddingEqual(l.padding),D=n.getConstrained(c.S.convert(l.center||l.locationAtOffset),w).center,O=p?+l.zoom:n.zoom+Xr(n.center.lat,D.lat),V=n.clone();V.setCenter(D),V.setZoom(O),V.setBearing(l.bearing);const $=new c.P(c.ag(n.centerPoint.x+l.offsetAsPoint.x,0,n.width),c.ag(n.centerPoint.y+l.offsetAsPoint.y,0,n.height));V.setLocationAtPoint(D,$);const j=V.center;zi(n,j);const H=function(_e,Ae,Me){const ve=Oi(Ae),Ne=Oi(Me),tt=c.aW(ve,Ne),Xe=Math.acos(tt),Ye=Sa(_e);return Xe/(2*Math.PI)*Ye}(n,_,j),ee=w+Xr(_.lat,0),de=O+Xr(j.lat,0),he=c.ae(de-ee);let fe;if(typeof l.minZoom=="number"){const _e=+l.minZoom+Xr(j.lat,0),Ae=Math.min(_e,ee,de)+Xr(0,j.lat),Me=n.getConstrained(j,Ae).zoom+Xr(j.lat,0);fe=c.ae(Me-ee)}const ye=c.bz(_.lng,j.lng),Te=c.bz(_.lat,j.lat);return{easeFunc:(_e,Ae,Me,ve)=>{const Ne=Bl(_,ye,Te,Me);M&&n.interpolatePadding(E,l.padding,_e);const tt=_e===1?j:Ne;n.setCenter(tt.wrap());const Xe=ee+c.aj(Ae);n.setZoom(_e===1?O:Xe+Xr(0,tt.lat))},scaleOfZoom:he,targetCenter:j,scaleOfMinZoom:fe,pixelPathLength:H}}static solveVectorScale(n,l,p,_,w){const E=_==="x"?[p[0],p[4],p[8],p[12]]:[p[1],p[5],p[9],p[13]],M=[p[3],p[7],p[11],p[15]],D=n[0]*E[0]+n[1]*E[1]+n[2]*E[2],O=n[0]*M[0]+n[1]*M[1]+n[2]*M[2],V=l[0]*E[0]+l[1]*E[1]+l[2]*E[2],$=l[0]*M[0]+l[1]*M[1]+l[2]*M[2];return V+w*O===D+w*$||M[3]*(D-V)+E[3]*($-O)+D*$==V*O?null:(V+E[3]-w*$-w*M[3])/(V-D-w*$+w*O)}static getLesserNonNegativeNonNull(n,l){return l!==null&&l>=0&&l<n?l:n}}class wu{constructor(n){this._globe=n,this._mercatorCameraHelper=new ds,this._verticalPerspectiveCameraHelper=new da}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(n,l){return this.currentHelper.handlePanInertia(n,l)}handleMapControlsRollPitchBearingZoom(n,l){return this.currentHelper.handleMapControlsRollPitchBearingZoom(n,l)}handleMapControlsPan(n,l,p){this.currentHelper.handleMapControlsPan(n,l,p)}cameraForBoxAndBearing(n,l,p,_,w){return this.currentHelper.cameraForBoxAndBearing(n,l,p,_,w)}handleJumpToCenterZoom(n,l){this.currentHelper.handleJumpToCenterZoom(n,l)}handleEaseTo(n,l){return this.currentHelper.handleEaseTo(n,l)}handleFlyTo(n,l){return this.currentHelper.handleFlyTo(n,l)}}const fs=(b,n)=>c.y(b,n&&n.filter(l=>l.identifier!=="source.canvas")),ol=c.bD();class wc extends c.E{constructor(n,l={}){super(),this._rtlPluginLoaded=()=>{for(const p in this.sourceCaches){const _=this.sourceCaches[p].getSource().type;_!=="vector"&&_!=="geojson"||this.sourceCaches[p].reload()}},this.map=n,this.dispatcher=new fn(wn(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",(p,_)=>this.getGlyphs(p,_)),this.dispatcher.registerMessageHandler("GI",(p,_)=>this.getImages(p,_)),this.imageManager=new me,this.imageManager.setEventedParent(this),this.glyphManager=new Ee(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Kn(256,512),this.crossTileSymbolIndex=new Oo,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bF()),zn().on(os,this._rtlPluginLoaded),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const _=this.sourceCaches[p.sourceId];if(!_)return;const w=_.getSource();if(w&&w.vectorLayerIds)for(const E in this._layers){const M=this._layers[E];M.source===w.id&&this._validateLayer(M)}})}setGlobalStateProperty(n,l){var p,_,w;this._checkLoaded();const E=l===null?(w=(_=(p=this.stylesheet.state)===null||p===void 0?void 0:p[n])===null||_===void 0?void 0:_.default)!==null&&w!==void 0?w:null:l;if(c.bG(E,this._globalState[n]))return this;this._globalState[n]=E;const M=this._findGlobalStateAffectedSources([n]);for(const D in this.sourceCaches)M.has(D)&&(this._reloadSource(D),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(n){this._checkLoaded();const l=[];for(const _ in n)!c.bG(this._globalState[_],n[_].default)&&(l.push(_),this._globalState[_]=n[_].default);const p=this._findGlobalStateAffectedSources(l);for(const _ in this.sourceCaches)p.has(_)&&(this._reloadSource(_),this._changed=!0)}_findGlobalStateAffectedSources(n){if(n.length===0)return new Set;const l=new Set;for(const p in this._layers){const _=this._layers[p],w=_.getLayoutAffectingGlobalStateRefs();for(const E of n)w.has(E)&&l.add(_.source)}return l}loadURL(n,l={},p){this.fire(new c.l("dataloading",{dataType:"style"})),l.validate=typeof l.validate!="boolean"||l.validate;const _=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;c.j(_,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,l,p)}).catch(E=>{this._loadStyleRequest=null,E&&!w.signal.aborted&&this.fire(new c.k(E))})}loadJSON(n,l={},p){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,G.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,l.validate=l.validate!==!1,this._load(n,l,p)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(ol,{validate:!1})}_load(n,l,p){var _,w,E;const M=l.transformStyle?l.transformStyle(p,n):n;if(!l.validate||!fs(this,c.z(M))){this._loaded=!0,this.stylesheet=M;for(const D in M.sources)this.addSource(D,M.sources[D],{validate:!1});M.sprite?this._loadSprite(M.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(M.glyphs),this._createLayers(),this.light=new gt(this.stylesheet.light),this._setProjectionInternal(((_=this.stylesheet.projection)===null||_===void 0?void 0:_.type)||"mercator"),this.sky=new nn(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.setGlobalState((E=this.stylesheet.state)!==null&&E!==void 0?E:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){const n=c.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",n),this._order=n.map(l=>l.id),this._layers={},this._serializedLayers=null;for(const l of n){const p=c.bI(l);p.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=p}}_loadSprite(n,l=!1,p=void 0){let _;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(w,E,M,D){return c._(this,void 0,void 0,function*(){const O=We(w),V=M>1?"@2x":"",$={},j={};for(const{id:H,url:ee}of O){const de=E.transformRequest(pe(ee,V,".json"),"SpriteJSON");$[H]=c.j(de,D);const he=E.transformRequest(pe(ee,V,".png"),"SpriteImage");j[H]=qe.getImage(he,D)}return yield Promise.all([...Object.values($),...Object.values(j)]),function(H,ee){return c._(this,void 0,void 0,function*(){const de={};for(const he in H){de[he]={};const fe=G.getImageCanvasContext((yield ee[he]).data),ye=(yield H[he]).data;for(const Te in ye){const{width:_e,height:Ae,x:Me,y:ve,sdf:Ne,pixelRatio:tt,stretchX:Xe,stretchY:Ye,content:at,textFitWidth:Dt,textFitHeight:kt}=ye[Te];de[he][Te]={data:null,pixelRatio:tt,sdf:Ne,stretchX:Xe,stretchY:Ye,content:at,textFitWidth:Dt,textFitHeight:kt,spriteData:{width:_e,height:Ae,x:Me,y:ve,context:fe}}}}return de})}($,j)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(w=>{if(this._spriteRequest=null,w)for(const E in w){this._spritesImagesIds[E]=[];const M=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(D=>!(D in w)):[];for(const D of M)this.imageManager.removeImage(D),this._changedImages[D]=!0;for(const D in w[E]){const O=E==="default"?D:`${E}:${D}`;this._spritesImagesIds[E].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,w[E][D],!1):this.imageManager.addImage(O,w[E][D]),l&&(this._changedImages[O]=!0)}}}).catch(w=>{this._spriteRequest=null,_=w,this.fire(new c.k(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),l&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),p&&p(_)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(n){const l=this.sourceCaches[n.source];if(!l)return;const p=n.sourceLayer;if(!p)return;const _=l.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(p)===-1)&&this.fire(new c.k(new Error(`Source layer "${p}" does not exist on source "${_.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,l=!1){const p=this._serializedAllLayers();if(!n||n.length===0)return Object.values(l?c.bJ(p):p);const _=[];for(const w of n)if(p[w]){const E=l?c.bJ(p[w]):p[w];_.push(E)}return _}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const l=Object.keys(this._layers);for(const p of l){const _=this._layers[p];_.type!=="custom"&&(n[p]=_.serialize())}return n}hasTransitions(){var n,l,p;if(!((n=this.light)===null||n===void 0)&&n.hasTransition()||!((l=this.sky)===null||l===void 0)&&l.hasTransition()||!((p=this.projection)===null||p===void 0)&&p.hasTransition())return!0;for(const _ in this.sourceCaches)if(this.sourceCaches[_].hasTransition())return!0;for(const _ in this._layers)if(this._layers[_].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const l=this._changed;if(l){const _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(_.length||w.length)&&this._updateWorkerLayers(_,w);for(const E in this._updatedSources){const M=this._updatedSources[E];if(M==="reload")this._reloadSource(E);else{if(M!=="clear")throw new Error(`Invalid action ${M}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const p={};for(const _ in this.sourceCaches){const w=this.sourceCaches[_];p[_]=w.used,w.used=!1}for(const _ of this._order){const w=this._layers[_];w.recalculate(n,this._availableImages),!w.isHidden(n.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const _ in p){const w=this.sourceCaches[_];!!p[_]!=!!w.used&&w.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(n),this.sky.recalculate(n),this.projection.recalculate(n),this.z=n.zoom,l&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,l){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,l={}){var p;this._checkLoaded();const _=this.serialize();if(n=l.transformStyle?l.transformStyle(_,n):n,((p=l.validate)===null||p===void 0||p)&&fs(this,c.z(n)))return!1;(n=c.bJ(n)).layers=c.bH(n.layers);const w=c.bK(_,n),E=this._getOperationsToPerform(w);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const M of E.operations)M();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const l=[],p=[];for(const _ of n)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":l.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":l.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":l.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":l.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":l.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":l.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":l.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":l.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":l.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":l.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":l.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":l.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":l.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setSky":l.push(()=>this.setSky.apply(this,_.args));break;case"setProjection":this.setProjection.apply(this,_.args);break;case"setGlobalState":l.push(()=>this.setGlobalState.apply(this,_.args));break;case"setTransition":l.push(()=>{});break;default:p.push(_.command)}return{operations:l,unimplemented:p}}addImage(n,l){if(this.getImage(n))return this.fire(new c.k(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,l),this._afterImageUpdated(n)}updateImage(n,l){this.imageManager.updateImage(n,l)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new c.k(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,l,p={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(c.z.source,`sources.${n}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const _=this.sourceCaches[n]=new ft(n,l,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:n})),_.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===n)return this.fire(new c.k(new Error(`Source "${n}" cannot be removed while layer "${p}" is using it.`)));const l=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],l.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),l.setEventedParent(null),l.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,l){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const p=this.sourceCaches[n].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(l),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,l,p={}){this._checkLoaded();const _=n.id;if(this.getLayer(_))return void this.fire(new c.k(new Error(`Layer "${_}" already exists on this map.`)));let w;if(n.type==="custom"){if(fs(this,c.bL(n)))return;w=c.bI(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(_,n.source),n=c.bJ(n),n=c.e(n,{source:_})),this._validate(c.z.layer,`layers.${_}`,n,{arrayIndex:-1},p))return;w=c.bI(n),this._validateLayer(w),w.setEventedParent(this,{layer:{id:_}})}const E=l?this._order.indexOf(l):this._order.length;if(l&&E===-1)this.fire(new c.k(new Error(`Cannot add layer "${_}" before non-existing layer "${l}".`)));else{if(this._order.splice(E,0,_),this._layerOrderChanged=!0,this._layers[_]=w,this._removedLayers[_]&&w.source&&w.type!=="custom"){const M=this._removedLayers[_];delete this._removedLayers[_],M.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(n,l){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new c.k(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===l)return;const p=this._order.indexOf(n);this._order.splice(p,1);const _=l?this._order.indexOf(l):this._order.length;l&&_===-1?this.fire(new c.k(new Error(`Cannot move layer "${n}" before non-existing layer "${l}".`))):(this._order.splice(_,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const l=this._layers[n];if(!l)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${n}".`)));l.setEventedParent(null);const p=this._order.indexOf(n);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,l,p){this._checkLoaded();const _=this.getLayer(n);_?_.minzoom===l&&_.maxzoom===p||(l!=null&&(_.minzoom=l),p!=null&&(_.maxzoom=p),this._updateLayer(_)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,l,p={}){this._checkLoaded();const _=this.getLayer(n);if(_){if(!c.bG(_.filter,l))return l==null?(_.setFilter(void 0),void this._updateLayer(_)):void(this._validate(c.z.filter,`layers.${_.id}.filter`,l,null,p)||(_.setFilter(c.bJ(l)),this._updateLayer(_)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return c.bJ(this.getLayer(n).filter)}setLayoutProperty(n,l,p,_={}){this._checkLoaded();const w=this.getLayer(n);w?c.bG(w.getLayoutProperty(l),p)||(w.setLayoutProperty(l,p,_),this._updateLayer(w)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,l){const p=this.getLayer(n);if(p)return p.getLayoutProperty(l);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,l,p,_={}){this._checkLoaded();const w=this.getLayer(n);w?c.bG(w.getPaintProperty(l),p)||(w.setPaintProperty(l,p,_)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[n]=!0,this._serializedLayers=null):this.fire(new c.k(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,l){return this.getLayer(n).getPaintProperty(l)}setFeatureState(n,l){this._checkLoaded();const p=n.source,_=n.sourceLayer,w=this.sourceCaches[p];if(w===void 0)return void this.fire(new c.k(new Error(`The source '${p}' does not exist in the map's style.`)));const E=w.getSource().type;E==="geojson"&&_?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||_?(n.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),w.setFeatureState(_,n.id,l)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,l){this._checkLoaded();const p=n.source,_=this.sourceCaches[p];if(_===void 0)return void this.fire(new c.k(new Error(`The source '${p}' does not exist in the map's style.`)));const w=_.getSource().type,E=w==="vector"?n.sourceLayer:void 0;w!=="vector"||E?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(E,n.id,l):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const l=n.source,p=n.sourceLayer,_=this.sourceCaches[l];if(_!==void 0)return _.getSource().type!=="vector"||p?(n.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),_.getFeatureState(p,n.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=c.bM(this.sourceCaches,w=>w.serialize()),l=this._serializeByIds(this._order,!0),p=this.map.getTerrain()||void 0,_=this.stylesheet;return c.bN({version:_.version,name:_.name,metadata:_.metadata,light:_.light,sky:_.sky,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,projection:_.projection,sources:n,layers:l,terrain:p},w=>w!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const l=E=>this._layers[E].type==="fill-extrusion",p={},_=[];for(let E=this._order.length-1;E>=0;E--){const M=this._order[E];if(l(M)){p[M]=E;for(const D of n){const O=D[M];if(O)for(const V of O)_.push(V)}}}_.sort((E,M)=>M.intersectionZ-E.intersectionZ);const w=[];for(let E=this._order.length-1;E>=0;E--){const M=this._order[E];if(l(M))for(let D=_.length-1;D>=0;D--){const O=_[D].feature;if(p[O.layer.id]<E)break;w.push(O),_.pop()}else for(const D of n){const O=D[M];if(O)for(const V of O)w.push(V.feature)}}return w}queryRenderedFeatures(n,l,p){l&&l.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",l.filter,null,l);const _={};if(l&&l.layers){if(!(Array.isArray(l.layers)||l.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const O of l.layers){const V=this._layers[O];if(!V)return this.fire(new c.k(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];_[V.source]=!0}}const w=[];l.availableImages=this._availableImages;const E=this._serializedAllLayers(),M=l.layers instanceof Set?l.layers:Array.isArray(l.layers)?new Set(l.layers):null,D=Object.assign(Object.assign({},l),{layers:M});for(const O in this.sourceCaches)l.layers&&!_[O]||w.push(Ir(this.sourceCaches[O],this._layers,E,n,D,p,this.map.terrain?(V,$,j)=>this.map.terrain.getElevation(V,$,j):void 0));return this.placement&&w.push(function(O,V,$,j,H,ee,de){const he={},fe=ee.queryRenderedSymbols(j),ye=[];for(const Te of Object.keys(fe).map(Number))ye.push(de[Te]);ye.sort(ks);for(const Te of ye){const _e=Te.featureIndex.lookupSymbolFeatures(fe[Te.bucketInstanceId],V,Te.bucketIndex,Te.sourceLayerIndex,H.filter,H.layers,H.availableImages,O);for(const Ae in _e){const Me=he[Ae]=he[Ae]||[],ve=_e[Ae];ve.sort((Ne,tt)=>{const Xe=Te.featureSortOrder;if(Xe){const Ye=Xe.indexOf(Ne.featureIndex);return Xe.indexOf(tt.featureIndex)-Ye}return tt.featureIndex-Ne.featureIndex});for(const Ne of ve)Me.push(Ne)}}return function(Te,_e,Ae){for(const Me in Te)for(const ve of Te[Me])gi(ve,Ae[_e[Me].source]);return Te}(he,O,$)}(this._layers,E,this.sourceCaches,n,D,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(n,l){l&&l.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",l.filter,null,l);const p=this.sourceCaches[n];return p?function(_,w){const E=_.getRenderableIds().map(O=>_.getTileByID(O)),M=[],D={};for(let O=0;O<E.length;O++){const V=E[O],$=V.tileID.canonical.key;D[$]||(D[$]=!0,V.querySourceFeatures(M,w))}return M}(p,l):[]}getLight(){return this.light.getLight()}setLight(n,l={}){this._checkLoaded();const p=this.light.getLight();let _=!1;for(const E in n)if(!c.bG(n[E],p[E])){_=!0;break}if(!_)return;const w={now:G.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(w)}getProjection(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.projection}setProjection(n){if(this._checkLoaded(),this.projection){if(this.projection.name===n.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=n,this._setProjectionInternal(n.type)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,l={}){this._checkLoaded();const p=this.getSky();let _=!1;if(!n&&!p)return;if(n&&!p)_=!0;else if(!n&&p)_=!0;else for(const E in n)if(!c.bG(n[E],p[E])){_=!0;break}if(!_)return;const w={now:G.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,l),this.sky.updateTransitions(w)}_setProjectionInternal(n){const l=function(p){if(Array.isArray(p)){const _=new ho({type:p});return{projection:_,transform:new aa,cameraHelper:new wu(_)}}switch(p){case"mercator":return{projection:new zl,transform:new jr,cameraHelper:new ds};case"globe":{const _=new ho({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:_,transform:new aa,cameraHelper:new wu(_)}}case"vertical-perspective":return{projection:new xu,transform:new sl,cameraHelper:new da};default:return c.w(`Unknown projection name: ${p}. Falling back to mercator projection.`),{projection:new zl,transform:new jr,cameraHelper:new ds}}}(n);this.projection=l.projection,this.map.migrateProjection(l.transform,l.cameraHelper);for(const p in this.sourceCaches)this.sourceCaches[p].reload()}_validate(n,l,p,_,w={}){return(!w||w.validate!==!1)&&fs(this,n.call(c.z,c.e({key:l,style:this.serialize(),value:p,styleSpec:c.v},_)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),zn().off(os,this._rtlPluginLoaded);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const p=this.sourceCaches[l];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const l in this.sourceCaches)this.sourceCaches[l].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,l,p,_,w=!1){let E=!1,M=!1;const D={};for(const O of this._order){const V=this._layers[O];if(V.type!=="symbol")continue;if(!D[V.source]){const j=this.sourceCaches[V.source];D[V.source]=j.getRenderableIds(!0).map(H=>j.getTileByID(H)).sort((H,ee)=>ee.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(ee.tileID)?-1:1))}const $=this.crossTileSymbolIndex.addLayer(V,D[V.source],n.center.lng);E=E||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(G.now(),n.zoom))&&(this.pauseablePlacement=new Xa(n,this.map.terrain,this._order,w,l,p,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,D),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(G.now()),M=!0),E&&this.pauseablePlacement.placement.setStale()),M||E)for(const O of this._order){const V=this._layers[O];V.type==="symbol"&&this.placement.updateLayerOpacities(V,D[V.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(G.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,l){return c._(this,void 0,void 0,function*(){const p=yield this.imageManager.getImages(l.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[l.source];return _&&_.setDependencies(l.tileID.key,l.type,l.icons),p})}getGlyphs(n,l){return c._(this,void 0,void 0,function*(){const p=yield this.glyphManager.getGlyphs(l.stacks),_=this.sourceCaches[l.source];return _&&_.setDependencies(l.tileID.key,l.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,l={}){this._checkLoaded(),n&&this._validate(c.z.glyphs,"glyphs",n,null,l)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,l,p={},_){this._checkLoaded();const w=[{id:n,url:l}],E=[...We(this.stylesheet.sprite),...w];this._validate(c.z.sprite,"sprite",E,null,p)||(this.stylesheet.sprite=E,this._loadSprite(w,!0,_))}removeSprite(n){this._checkLoaded();const l=We(this.stylesheet.sprite);if(l.find(p=>p.id===n)){if(this._spritesImagesIds[n])for(const p of this._spritesImagesIds[n])this.imageManager.removeImage(p),this._changedImages[p]=!0;l.splice(l.findIndex(p=>p.id===n),1),this.stylesheet.sprite=l.length>0?l:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return We(this.stylesheet.sprite)}setSprite(n,l={},p){this._checkLoaded(),n&&this._validate(c.z.sprite,"sprite",n,null,l)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,p):(this._unloadSprite(),p&&p(null)))}}var ud=c.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class cd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,l,p,_,w,E,M,D,O){this.context=n;let V=this.boundPaintVertexBuffers.length!==_.length;for(let $=0;!V&&$<_.length;$++)this.boundPaintVertexBuffers[$]!==_[$]&&(V=!0);!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||V||this.boundIndexBuffer!==w||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==M||this.boundDynamicVertexBuffer2!==D||this.boundDynamicVertexBuffer3!==O?this.freshBind(l,p,_,w,E,M,D,O):(n.bindVertexArray.set(this.vao),M&&M.bind(),w&&w.dynamicDraw&&w.bind(),D&&D.bind(),O&&O.bind())}freshBind(n,l,p,_,w,E,M,D){const O=n.numAttributes,V=this.context,$=V.gl;this.vao&&this.destroy(),this.vao=V.createVertexArray(),V.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=M,this.boundDynamicVertexBuffer3=D,l.enableAttributes($,n);for(const j of p)j.enableAttributes($,n);E&&E.enableAttributes($,n),M&&M.enableAttributes($,n),D&&D.enableAttributes($,n),l.bind(),l.setVertexAttribPointers($,n,w);for(const j of p)j.bind(),j.setVertexAttribPointers($,n,w);E&&(E.bind(),E.setVertexAttribPointers($,n,w)),_&&_.bind(),M&&(M.bind(),M.setVertexAttribPointers($,n,w)),D&&(D.bind(),D.setVertexAttribPointers($,n,w)),V.currentNumAttributes=O}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Tc=(b,n,l,p,_)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:n,u_fog_color:l?l.properties.get("fog-color"):c.be.white,u_fog_ground_blend:l?l.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:_?0:l?l.calculateFogBlendOpacity(p):0,u_horizon_color:l?l.properties.get("horizon-color"):c.be.white,u_horizon_fog_blend:l?l.properties.get("horizon-fog-blend"):1,u_is_globe_mode:_?1:0}),Ba={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Tu(b){const n=[];for(let l=0;l<b.length;l++){if(b[l]===null)continue;const p=b[l].split(" ");n.push(p.pop())}return n}class Su{constructor(n,l,p,_,w,E,M,D,O=[]){const V=n.gl;this.program=V.createProgram();const $=Tu(l.staticAttributes),j=p?p.getBinderAttributes():[],H=$.concat(j),ee=wa.prelude.staticUniforms?Tu(wa.prelude.staticUniforms):[],de=M.staticUniforms?Tu(M.staticUniforms):[],he=l.staticUniforms?Tu(l.staticUniforms):[],fe=p?p.getBinderUniforms():[],ye=ee.concat(de).concat(he).concat(fe),Te=[];for(const Xe of ye)Te.indexOf(Xe)<0&&Te.push(Xe);const _e=p?p.defines():[];Mn(V)&&_e.unshift("#version 300 es"),w&&_e.push("#define OVERDRAW_INSPECTOR;"),E&&_e.push("#define TERRAIN3D;"),D&&_e.push(D),O&&_e.push(...O);let Ae=_e.concat(wa.prelude.fragmentSource,M.fragmentSource,l.fragmentSource).join(`
`),Me=_e.concat(wa.prelude.vertexSource,M.vertexSource,l.vertexSource).join(`
`);Mn(V)||(Ae=function(Xe){return Xe.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Ae),Me=function(Xe){return Xe.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Me));const ve=V.createShader(V.FRAGMENT_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);if(V.shaderSource(ve,Ae),V.compileShader(ve),!V.getShaderParameter(ve,V.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${V.getShaderInfoLog(ve)}`);V.attachShader(this.program,ve);const Ne=V.createShader(V.VERTEX_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);if(V.shaderSource(Ne,Me),V.compileShader(Ne),!V.getShaderParameter(Ne,V.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${V.getShaderInfoLog(Ne)}`);V.attachShader(this.program,Ne),this.attributes={};const tt={};this.numAttributes=H.length;for(let Xe=0;Xe<this.numAttributes;Xe++)H[Xe]&&(V.bindAttribLocation(this.program,Xe,H[Xe]),this.attributes[H[Xe]]=Xe);if(V.linkProgram(this.program),!V.getProgramParameter(this.program,V.LINK_STATUS))throw new Error(`Program failed to link: ${V.getProgramInfoLog(this.program)}`);V.deleteShader(Ne),V.deleteShader(ve);for(let Xe=0;Xe<Te.length;Xe++){const Ye=Te[Xe];if(Ye&&!tt[Ye]){const at=V.getUniformLocation(this.program,Ye);at&&(tt[Ye]=at)}}this.fixedUniforms=_(n,tt),this.terrainUniforms=((Xe,Ye)=>({u_depth:new c.bO(Xe,Ye.u_depth),u_terrain:new c.bO(Xe,Ye.u_terrain),u_terrain_dim:new c.bf(Xe,Ye.u_terrain_dim),u_terrain_matrix:new c.bQ(Xe,Ye.u_terrain_matrix),u_terrain_unpack:new c.bR(Xe,Ye.u_terrain_unpack),u_terrain_exaggeration:new c.bf(Xe,Ye.u_terrain_exaggeration)}))(n,tt),this.projectionUniforms=((Xe,Ye)=>({u_projection_matrix:new c.bQ(Xe,Ye.u_projection_matrix),u_projection_tile_mercator_coords:new c.bR(Xe,Ye.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bR(Xe,Ye.u_projection_clipping_plane),u_projection_transition:new c.bf(Xe,Ye.u_projection_transition),u_projection_fallback_matrix:new c.bQ(Xe,Ye.u_projection_fallback_matrix)}))(n,tt),this.binderUniforms=p?p.getUniforms(n,tt):[]}draw(n,l,p,_,w,E,M,D,O,V,$,j,H,ee,de,he,fe,ye,Te){const _e=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(p),n.setStencilMode(_),n.setColorMode(w),n.setCullFace(E),D){n.activeTexture.set(_e.TEXTURE2),_e.bindTexture(_e.TEXTURE_2D,D.depthTexture),n.activeTexture.set(_e.TEXTURE3),_e.bindTexture(_e.TEXTURE_2D,D.texture);for(const Me in this.terrainUniforms)this.terrainUniforms[Me].set(D[Me])}if(O)for(const Me in O)this.projectionUniforms[Ba[Me]].set(O[Me]);if(M)for(const Me in this.fixedUniforms)this.fixedUniforms[Me].set(M[Me]);he&&he.setUniforms(n,this.binderUniforms,ee,{zoom:de});let Ae=0;switch(l){case _e.LINES:Ae=2;break;case _e.TRIANGLES:Ae=3;break;case _e.LINE_STRIP:Ae=1}for(const Me of H.get()){const ve=Me.vaos||(Me.vaos={});(ve[V]||(ve[V]=new cd)).bind(n,this,$,he?he.getPaintVertexBuffers():[],j,Me.vertexOffset,fe,ye,Te),_e.drawElements(l,Me.primitiveLength*Ae,_e.UNSIGNED_SHORT,Me.primitiveOffset*Ae*2)}}}function ps(b,n,l){const p=1/c.aB(l,1,n.transform.tileZoom),_=Math.pow(2,l.tileID.overscaledZ),w=l.tileSize*Math.pow(2,n.transform.tileZoom)/_,E=w*(l.tileID.canonical.x+l.tileID.wrap*_),M=w*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[p,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[E>>16,M>>16],u_pixel_coord_lower:[65535&E,65535&M]}}const A=(b,n,l,p)=>{const _=b.style.light,w=_.properties.get("position"),E=[w.x,w.y,w.z],M=c.bU();_.properties.get("anchor")==="viewport"&&c.bV(M,b.transform.bearingInRadians),c.bW(E,E,M);const D=b.transform.transformLightDirection(E),O=_.properties.get("color");return{u_lightpos:E,u_lightpos_globe:D,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[O.r,O.g,O.b],u_vertical_gradient:+n,u_opacity:l,u_fill_translate:p}},F=(b,n,l,p,_,w,E)=>c.e(A(b,n,l,p),ps(w,b,E),{u_height_factor:-Math.pow(2,_.overscaledZ)/E.tileSize/8}),Z=(b,n,l,p)=>c.e(ps(n,b,l),{u_fill_translate:p}),ce=(b,n)=>({u_world:b,u_fill_translate:n}),Qe=(b,n,l,p,_)=>c.e(Z(b,n,l,_),{u_world:p}),dt=(b,n,l,p,_)=>{const w=b.transform;let E,M,D=0;if(l.paint.get("circle-pitch-alignment")==="map"){const O=c.aB(n,1,w.zoom);E=!0,M=[O,O],D=O/(c.$*Math.pow(2,n.tileID.overscaledZ))*2*Math.PI*_}else E=!1,M=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:M,u_globe_extrude_scale:D,u_translate:p}},Nt=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),$n=b=>({u_viewport_size:[b.width,b.height]}),Ni=(b,n=1)=>({u_color:b,u_overlay:0,u_overlay_scale:n}),qn=(b,n,l,p)=>{const _=c.aB(b,1,n)/(c.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*p;return{u_extrude_scale:c.aB(b,1,n),u_intensity:l,u_globe_extrude_scale:_}},Zi=(b,n,l,p)=>{const _=c.L();c.bX(_,0,b.width,b.height,0,0,1);const w=b.context.gl;return{u_matrix:_,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:l,u_color_ramp:p,u_opacity:n.paint.get("heatmap-opacity")}},ei=(b,n,l)=>{const p=l.paint.get("hillshade-accent-color");let _;switch(l.paint.get("hillshade-method")){case"basic":_=4;break;case"combined":_=1;break;case"igor":_=2;break;case"multidirectional":_=3;break;default:_=0}const w=l.getIlluminationProperties();for(let E=0;E<w.directionRadians.length;E++)l.paint.get("hillshade-illumination-anchor")==="viewport"&&(w.directionRadians[E]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:sa(0,n.tileID),u_exaggeration:l.paint.get("hillshade-exaggeration"),u_altitudes:w.altitudeRadians,u_azimuths:w.directionRadians,u_accent:p,u_method:_,u_highlights:w.highlightColor,u_shadows:w.shadowColor}},ll=(b,n)=>{const l=n.stride,p=c.L();return c.bX(p,0,c.$,-8192,0,0,1),c.M(p,p,[0,-8192,0]),{u_matrix:p,u_image:1,u_dimension:[l,l],u_zoom:b.overscaledZ,u_unpack:n.getUnpackVector()}};function sa(b,n){const l=Math.pow(2,n.canonical.z),p=n.canonical.y;return[new c.a0(0,p/l).toLngLat().lat,new c.a0(0,(p+1)/l).toLngLat().lat]}const Vo=(b,n)=>({u_image:0,u_unpack:n.getUnpackVector(),u_dimension:[n.stride,n.stride],u_elevation_stops:1,u_color_stops:4,u_opacity:b.paint.get("color-relief-opacity")}),Fl=(b,n,l,p)=>{const _=b.transform;return{u_translation:gh(b,n,l),u_ratio:p/c.aB(n,1,_.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Sc=(b,n,l,p,_)=>c.e(Fl(b,n,l,p),{u_image:0,u_image_height:_}),Sf=(b,n,l,p,_)=>{const w=b.transform,E=mh(n,w);return{u_translation:gh(b,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:p/c.aB(n,1,w.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[E,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},Ef=(b,n,l,p,_,w)=>{const E=b.lineAtlas,M=mh(n,b.transform),D=l.layout.get("line-cap")==="round",O=E.getDash(_.from,D),V=E.getDash(_.to,D),$=O.width*w.fromScale,j=V.width*w.toScale;return c.e(Fl(b,n,l,p),{u_patternscale_a:[M/$,-O.height/2],u_patternscale_b:[M/j,-V.height/2],u_sdfgamma:E.width/(256*Math.min($,j)*b.pixelRatio)/2,u_image:0,u_tex_y_a:O.y,u_tex_y_b:V.y,u_mix:w.t})};function mh(b,n){return 1/c.aB(b,1,n.tileZoom)}function gh(b,n,l){return c.aC(b.transform,n,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const Ul=(b,n,l,p,_)=>{return{u_tl_parent:b,u_scale_parent:n,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(E=p.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(w=p.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Af(p.paint.get("raster-hue-rotate")),u_coords_top:[_[0].x,_[0].y,_[1].x,_[1].y],u_coords_bottom:[_[3].x,_[3].y,_[2].x,_[2].y]};var w,E};function Af(b){b*=Math.PI/180;const n=Math.sin(b),l=Math.cos(b);return[(2*l+1)/3,(-Math.sqrt(3)*n-l+1)/3,(Math.sqrt(3)*n-l+1)/3]}const hd=(b,n,l,p,_,w,E,M,D,O,V,$,j)=>{const H=E.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:H.cameraToCenterDistance,u_pitch:H.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:H.width/H.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:M,u_coord_matrix:D,u_is_text:+V,u_pitch_with_map:+p,u_is_along_line:_,u_is_variable_anchor:w,u_texsize:$,u_texture:0,u_translation:O,u_pitched_scale:j}},Ec=(b,n,l,p,_,w,E,M,D,O,V,$,j,H)=>{const ee=E.transform;return c.e(hd(b,n,l,p,_,w,E,M,D,O,V,$,H),{u_gamma_scale:p?Math.cos(ee.pitch*Math.PI/180)*ee.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},Eg=(b,n,l,p,_,w,E,M,D,O,V,$,j)=>c.e(Ec(b,n,l,p,_,w,E,M,D,O,!0,V,0,j),{u_texsize_icon:$,u_texture_icon:1}),dd=(b,n)=>({u_opacity:b,u_color:n}),Ag=(b,n,l,p,_)=>c.e(function(w,E,M,D){const O=M.imageManager.getPattern(w.from.toString()),V=M.imageManager.getPattern(w.to.toString()),{width:$,height:j}=M.imageManager.getPixelSize(),H=Math.pow(2,D.tileID.overscaledZ),ee=D.tileSize*Math.pow(2,M.transform.tileZoom)/H,de=ee*(D.tileID.canonical.x+D.tileID.wrap*H),he=ee*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[$,j],u_mix:E.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/c.aB(D,1,M.transform.tileZoom),u_pixel_coord_upper:[de>>16,he>>16],u_pixel_coord_lower:[65535&de,65535&he]}}(l,_,n,p),{u_opacity:b}),Xp=(b,n)=>{},Ja={fillExtrusion:(b,n)=>({u_lightpos:new c.bS(b,n.u_lightpos),u_lightpos_globe:new c.bS(b,n.u_lightpos_globe),u_lightintensity:new c.bf(b,n.u_lightintensity),u_lightcolor:new c.bS(b,n.u_lightcolor),u_vertical_gradient:new c.bf(b,n.u_vertical_gradient),u_opacity:new c.bf(b,n.u_opacity),u_fill_translate:new c.bT(b,n.u_fill_translate)}),fillExtrusionPattern:(b,n)=>({u_lightpos:new c.bS(b,n.u_lightpos),u_lightpos_globe:new c.bS(b,n.u_lightpos_globe),u_lightintensity:new c.bf(b,n.u_lightintensity),u_lightcolor:new c.bS(b,n.u_lightcolor),u_vertical_gradient:new c.bf(b,n.u_vertical_gradient),u_height_factor:new c.bf(b,n.u_height_factor),u_opacity:new c.bf(b,n.u_opacity),u_fill_translate:new c.bT(b,n.u_fill_translate),u_image:new c.bO(b,n.u_image),u_texsize:new c.bT(b,n.u_texsize),u_pixel_coord_upper:new c.bT(b,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(b,n.u_pixel_coord_lower),u_scale:new c.bS(b,n.u_scale),u_fade:new c.bf(b,n.u_fade)}),fill:(b,n)=>({u_fill_translate:new c.bT(b,n.u_fill_translate)}),fillPattern:(b,n)=>({u_image:new c.bO(b,n.u_image),u_texsize:new c.bT(b,n.u_texsize),u_pixel_coord_upper:new c.bT(b,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(b,n.u_pixel_coord_lower),u_scale:new c.bS(b,n.u_scale),u_fade:new c.bf(b,n.u_fade),u_fill_translate:new c.bT(b,n.u_fill_translate)}),fillOutline:(b,n)=>({u_world:new c.bT(b,n.u_world),u_fill_translate:new c.bT(b,n.u_fill_translate)}),fillOutlinePattern:(b,n)=>({u_world:new c.bT(b,n.u_world),u_image:new c.bO(b,n.u_image),u_texsize:new c.bT(b,n.u_texsize),u_pixel_coord_upper:new c.bT(b,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(b,n.u_pixel_coord_lower),u_scale:new c.bS(b,n.u_scale),u_fade:new c.bf(b,n.u_fade),u_fill_translate:new c.bT(b,n.u_fill_translate)}),circle:(b,n)=>({u_camera_to_center_distance:new c.bf(b,n.u_camera_to_center_distance),u_scale_with_map:new c.bO(b,n.u_scale_with_map),u_pitch_with_map:new c.bO(b,n.u_pitch_with_map),u_extrude_scale:new c.bT(b,n.u_extrude_scale),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_globe_extrude_scale:new c.bf(b,n.u_globe_extrude_scale),u_translate:new c.bT(b,n.u_translate)}),collisionBox:(b,n)=>({u_pixel_extrude_scale:new c.bT(b,n.u_pixel_extrude_scale)}),collisionCircle:(b,n)=>({u_viewport_size:new c.bT(b,n.u_viewport_size)}),debug:(b,n)=>({u_color:new c.bP(b,n.u_color),u_overlay:new c.bO(b,n.u_overlay),u_overlay_scale:new c.bf(b,n.u_overlay_scale)}),depth:Xp,clippingMask:Xp,heatmap:(b,n)=>({u_extrude_scale:new c.bf(b,n.u_extrude_scale),u_intensity:new c.bf(b,n.u_intensity),u_globe_extrude_scale:new c.bf(b,n.u_globe_extrude_scale)}),heatmapTexture:(b,n)=>({u_matrix:new c.bQ(b,n.u_matrix),u_world:new c.bT(b,n.u_world),u_image:new c.bO(b,n.u_image),u_color_ramp:new c.bO(b,n.u_color_ramp),u_opacity:new c.bf(b,n.u_opacity)}),hillshade:(b,n)=>({u_image:new c.bO(b,n.u_image),u_latrange:new c.bT(b,n.u_latrange),u_exaggeration:new c.bf(b,n.u_exaggeration),u_altitudes:new c.bZ(b,n.u_altitudes),u_azimuths:new c.bZ(b,n.u_azimuths),u_accent:new c.bP(b,n.u_accent),u_method:new c.bO(b,n.u_method),u_shadows:new c.bY(b,n.u_shadows),u_highlights:new c.bY(b,n.u_highlights)}),hillshadePrepare:(b,n)=>({u_matrix:new c.bQ(b,n.u_matrix),u_image:new c.bO(b,n.u_image),u_dimension:new c.bT(b,n.u_dimension),u_zoom:new c.bf(b,n.u_zoom),u_unpack:new c.bR(b,n.u_unpack)}),colorRelief:(b,n)=>({u_image:new c.bO(b,n.u_image),u_unpack:new c.bR(b,n.u_unpack),u_dimension:new c.bT(b,n.u_dimension),u_elevation_stops:new c.bO(b,n.u_elevation_stops),u_color_stops:new c.bO(b,n.u_color_stops),u_opacity:new c.bf(b,n.u_opacity)}),line:(b,n)=>({u_translation:new c.bT(b,n.u_translation),u_ratio:new c.bf(b,n.u_ratio),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_units_to_pixels:new c.bT(b,n.u_units_to_pixels)}),lineGradient:(b,n)=>({u_translation:new c.bT(b,n.u_translation),u_ratio:new c.bf(b,n.u_ratio),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_units_to_pixels:new c.bT(b,n.u_units_to_pixels),u_image:new c.bO(b,n.u_image),u_image_height:new c.bf(b,n.u_image_height)}),linePattern:(b,n)=>({u_translation:new c.bT(b,n.u_translation),u_texsize:new c.bT(b,n.u_texsize),u_ratio:new c.bf(b,n.u_ratio),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_image:new c.bO(b,n.u_image),u_units_to_pixels:new c.bT(b,n.u_units_to_pixels),u_scale:new c.bS(b,n.u_scale),u_fade:new c.bf(b,n.u_fade)}),lineSDF:(b,n)=>({u_translation:new c.bT(b,n.u_translation),u_ratio:new c.bf(b,n.u_ratio),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_units_to_pixels:new c.bT(b,n.u_units_to_pixels),u_patternscale_a:new c.bT(b,n.u_patternscale_a),u_patternscale_b:new c.bT(b,n.u_patternscale_b),u_sdfgamma:new c.bf(b,n.u_sdfgamma),u_image:new c.bO(b,n.u_image),u_tex_y_a:new c.bf(b,n.u_tex_y_a),u_tex_y_b:new c.bf(b,n.u_tex_y_b),u_mix:new c.bf(b,n.u_mix)}),raster:(b,n)=>({u_tl_parent:new c.bT(b,n.u_tl_parent),u_scale_parent:new c.bf(b,n.u_scale_parent),u_buffer_scale:new c.bf(b,n.u_buffer_scale),u_fade_t:new c.bf(b,n.u_fade_t),u_opacity:new c.bf(b,n.u_opacity),u_image0:new c.bO(b,n.u_image0),u_image1:new c.bO(b,n.u_image1),u_brightness_low:new c.bf(b,n.u_brightness_low),u_brightness_high:new c.bf(b,n.u_brightness_high),u_saturation_factor:new c.bf(b,n.u_saturation_factor),u_contrast_factor:new c.bf(b,n.u_contrast_factor),u_spin_weights:new c.bS(b,n.u_spin_weights),u_coords_top:new c.bR(b,n.u_coords_top),u_coords_bottom:new c.bR(b,n.u_coords_bottom)}),symbolIcon:(b,n)=>({u_is_size_zoom_constant:new c.bO(b,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(b,n.u_is_size_feature_constant),u_size_t:new c.bf(b,n.u_size_t),u_size:new c.bf(b,n.u_size),u_camera_to_center_distance:new c.bf(b,n.u_camera_to_center_distance),u_pitch:new c.bf(b,n.u_pitch),u_rotate_symbol:new c.bO(b,n.u_rotate_symbol),u_aspect_ratio:new c.bf(b,n.u_aspect_ratio),u_fade_change:new c.bf(b,n.u_fade_change),u_label_plane_matrix:new c.bQ(b,n.u_label_plane_matrix),u_coord_matrix:new c.bQ(b,n.u_coord_matrix),u_is_text:new c.bO(b,n.u_is_text),u_pitch_with_map:new c.bO(b,n.u_pitch_with_map),u_is_along_line:new c.bO(b,n.u_is_along_line),u_is_variable_anchor:new c.bO(b,n.u_is_variable_anchor),u_texsize:new c.bT(b,n.u_texsize),u_texture:new c.bO(b,n.u_texture),u_translation:new c.bT(b,n.u_translation),u_pitched_scale:new c.bf(b,n.u_pitched_scale)}),symbolSDF:(b,n)=>({u_is_size_zoom_constant:new c.bO(b,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(b,n.u_is_size_feature_constant),u_size_t:new c.bf(b,n.u_size_t),u_size:new c.bf(b,n.u_size),u_camera_to_center_distance:new c.bf(b,n.u_camera_to_center_distance),u_pitch:new c.bf(b,n.u_pitch),u_rotate_symbol:new c.bO(b,n.u_rotate_symbol),u_aspect_ratio:new c.bf(b,n.u_aspect_ratio),u_fade_change:new c.bf(b,n.u_fade_change),u_label_plane_matrix:new c.bQ(b,n.u_label_plane_matrix),u_coord_matrix:new c.bQ(b,n.u_coord_matrix),u_is_text:new c.bO(b,n.u_is_text),u_pitch_with_map:new c.bO(b,n.u_pitch_with_map),u_is_along_line:new c.bO(b,n.u_is_along_line),u_is_variable_anchor:new c.bO(b,n.u_is_variable_anchor),u_texsize:new c.bT(b,n.u_texsize),u_texture:new c.bO(b,n.u_texture),u_gamma_scale:new c.bf(b,n.u_gamma_scale),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_is_halo:new c.bO(b,n.u_is_halo),u_translation:new c.bT(b,n.u_translation),u_pitched_scale:new c.bf(b,n.u_pitched_scale)}),symbolTextAndIcon:(b,n)=>({u_is_size_zoom_constant:new c.bO(b,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(b,n.u_is_size_feature_constant),u_size_t:new c.bf(b,n.u_size_t),u_size:new c.bf(b,n.u_size),u_camera_to_center_distance:new c.bf(b,n.u_camera_to_center_distance),u_pitch:new c.bf(b,n.u_pitch),u_rotate_symbol:new c.bO(b,n.u_rotate_symbol),u_aspect_ratio:new c.bf(b,n.u_aspect_ratio),u_fade_change:new c.bf(b,n.u_fade_change),u_label_plane_matrix:new c.bQ(b,n.u_label_plane_matrix),u_coord_matrix:new c.bQ(b,n.u_coord_matrix),u_is_text:new c.bO(b,n.u_is_text),u_pitch_with_map:new c.bO(b,n.u_pitch_with_map),u_is_along_line:new c.bO(b,n.u_is_along_line),u_is_variable_anchor:new c.bO(b,n.u_is_variable_anchor),u_texsize:new c.bT(b,n.u_texsize),u_texsize_icon:new c.bT(b,n.u_texsize_icon),u_texture:new c.bO(b,n.u_texture),u_texture_icon:new c.bO(b,n.u_texture_icon),u_gamma_scale:new c.bf(b,n.u_gamma_scale),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_is_halo:new c.bO(b,n.u_is_halo),u_translation:new c.bT(b,n.u_translation),u_pitched_scale:new c.bf(b,n.u_pitched_scale)}),background:(b,n)=>({u_opacity:new c.bf(b,n.u_opacity),u_color:new c.bP(b,n.u_color)}),backgroundPattern:(b,n)=>({u_opacity:new c.bf(b,n.u_opacity),u_image:new c.bO(b,n.u_image),u_pattern_tl_a:new c.bT(b,n.u_pattern_tl_a),u_pattern_br_a:new c.bT(b,n.u_pattern_br_a),u_pattern_tl_b:new c.bT(b,n.u_pattern_tl_b),u_pattern_br_b:new c.bT(b,n.u_pattern_br_b),u_texsize:new c.bT(b,n.u_texsize),u_mix:new c.bf(b,n.u_mix),u_pattern_size_a:new c.bT(b,n.u_pattern_size_a),u_pattern_size_b:new c.bT(b,n.u_pattern_size_b),u_scale_a:new c.bf(b,n.u_scale_a),u_scale_b:new c.bf(b,n.u_scale_b),u_pixel_coord_upper:new c.bT(b,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(b,n.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bf(b,n.u_tile_units_to_pixels)}),terrain:(b,n)=>({u_texture:new c.bO(b,n.u_texture),u_ele_delta:new c.bf(b,n.u_ele_delta),u_fog_matrix:new c.bQ(b,n.u_fog_matrix),u_fog_color:new c.bP(b,n.u_fog_color),u_fog_ground_blend:new c.bf(b,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bf(b,n.u_fog_ground_blend_opacity),u_horizon_color:new c.bP(b,n.u_horizon_color),u_horizon_fog_blend:new c.bf(b,n.u_horizon_fog_blend),u_is_globe_mode:new c.bf(b,n.u_is_globe_mode)}),terrainDepth:(b,n)=>({u_ele_delta:new c.bf(b,n.u_ele_delta)}),terrainCoords:(b,n)=>({u_texture:new c.bO(b,n.u_texture),u_terrain_coords_id:new c.bf(b,n.u_terrain_coords_id),u_ele_delta:new c.bf(b,n.u_ele_delta)}),projectionErrorMeasurement:(b,n)=>({u_input:new c.bf(b,n.u_input),u_output_expected:new c.bf(b,n.u_output_expected)}),atmosphere:(b,n)=>({u_sun_pos:new c.bS(b,n.u_sun_pos),u_atmosphere_blend:new c.bf(b,n.u_atmosphere_blend),u_globe_position:new c.bS(b,n.u_globe_position),u_globe_radius:new c.bf(b,n.u_globe_radius),u_inv_proj_matrix:new c.bQ(b,n.u_inv_proj_matrix)}),sky:(b,n)=>({u_sky_color:new c.bP(b,n.u_sky_color),u_horizon_color:new c.bP(b,n.u_horizon_color),u_horizon:new c.bT(b,n.u_horizon),u_horizon_normal:new c.bT(b,n.u_horizon_normal),u_sky_horizon_blend:new c.bf(b,n.u_sky_horizon_blend),u_sky_blend:new c.bf(b,n.u_sky_blend)})};class Ac{constructor(n,l,p){this.context=n;const _=n.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const l=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const If={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fd{constructor(n,l,p,_){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=_,this.context=n;const w=n.gl;this.buffer=w.createBuffer(),n.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,l){for(let p=0;p<this.attributes.length;p++){const _=l.attributes[this.attributes[p].name];_!==void 0&&n.enableVertexAttribArray(_)}}setVertexAttribPointers(n,l,p){for(let _=0;_<this.attributes.length;_++){const w=this.attributes[_],E=l.attributes[w.name];E!==void 0&&n.vertexAttribPointer(E,w.components,n[If[w.type]],!1,this.itemSize,w.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class nr{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class yh extends nr{getDefault(){return c.be.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class po extends nr{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Cf extends nr{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class jl extends nr{getDefault(){return[!0,!0,!0,!0]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class _h extends nr{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Ic extends nr{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class vh extends nr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class $l extends nr{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class ul extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}}class Cc extends nr{getDefault(){return[0,1]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Pf extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}}class Yp extends nr{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Eu extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}}class Mf extends nr{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Qp extends nr{getDefault(){return c.be.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Rf extends nr{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class pd extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}}class md extends nr{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class gd extends nr{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class yd extends nr{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class ql extends nr{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Au extends nr{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ea extends nr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class ms extends nr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class gs extends nr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class ys extends nr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Gl extends nr{getDefault(){return null}set(n){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class cl extends nr{getDefault(){return null}set(n){var l;if(n===this.current&&!this.dirty)return;const p=this.gl;Mn(p)?p.bindVertexArray(n):(l=p.getExtension("OES_vertex_array_object"))===null||l===void 0||l.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class Iu extends nr{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Cu extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Pu extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class mo extends nr{constructor(n,l){super(n),this.context=n,this.parent=l}getDefault(){return null}}class kf extends mo{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class hl extends mo{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class go extends mo{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}const Df="Framebuffer is not complete";class Va{constructor(n,l,p,_,w){this.context=n,this.width=l,this.height=p;const E=n.gl,M=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new kf(n,M),_)this.depthAttachment=w?new go(n,M):new hl(n,M);else if(w)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(Df)}destroy(){const n=this.context.gl,l=this.colorAttachment.get();if(l&&n.deleteTexture(l),this.depthAttachment){const p=this.depthAttachment.get();p&&n.deleteRenderbuffer(p)}n.deleteFramebuffer(this.framebuffer)}}class kn{constructor(n){var l,p;if(this.gl=n,this.clearColor=new yh(this),this.clearDepth=new po(this),this.clearStencil=new Cf(this),this.colorMask=new jl(this),this.depthMask=new _h(this),this.stencilMask=new Ic(this),this.stencilFunc=new vh(this),this.stencilOp=new $l(this),this.stencilTest=new ul(this),this.depthRange=new Cc(this),this.depthTest=new Pf(this),this.depthFunc=new Yp(this),this.blend=new Eu(this),this.blendFunc=new Mf(this),this.blendColor=new Qp(this),this.blendEquation=new Rf(this),this.cullFace=new pd(this),this.cullFaceSide=new md(this),this.frontFace=new gd(this),this.program=new yd(this),this.activeTexture=new ql(this),this.viewport=new Au(this),this.bindFramebuffer=new Ea(this),this.bindRenderbuffer=new ms(this),this.bindTexture=new gs(this),this.bindVertexBuffer=new ys(this),this.bindElementBuffer=new Gl(this),this.bindVertexArray=new cl(this),this.pixelStoreUnpack=new Iu(this),this.pixelStoreUnpackPremultiplyAlpha=new Cu(this),this.pixelStoreUnpackFlipY=new Pu(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Mn(n)){this.HALF_FLOAT=n.HALF_FLOAT;const _=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(l=n.RGBA16F)!==null&&l!==void 0?l:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(p=n.RGB16F)!==null&&p!==void 0?p:_==null?void 0:_.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const _=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,l){return new Ac(this,n,l)}createVertexBuffer(n,l,p){return new fd(this,n,l,p)}createRenderbuffer(n,l,p){const _=this.gl,w=_.createRenderbuffer();return this.bindRenderbuffer.set(w),_.renderbufferStorage(_.RENDERBUFFER,n,l,p),this.bindRenderbuffer.set(null),w}createFramebuffer(n,l,p,_){return new Va(this,n,l,p,_)}clear({color:n,depth:l,stencil:p}){const _=this.gl;let w=0;n&&(w|=_.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(w|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(w|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),_.clear(w)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){c.bG(n.blendFunction,En.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Mn(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var l;return Mn(this.gl)?this.gl.deleteVertexArray(n):(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}let Fa;function Lf(b,n,l,p,_){const w=b.context,E=b.transform,M=w.gl,D=b.useProgram("collisionBox"),O=[];let V=0,$=0;for(let fe=0;fe<p.length;fe++){const ye=p[fe],Te=n.getTile(ye).getBucket(l);if(!Te)continue;const _e=_?Te.textCollisionBox:Te.iconCollisionBox,Ae=Te.collisionCircleArray;Ae.length>0&&(O.push({circleArray:Ae,circleOffset:$,coord:ye}),V+=Ae.length/4,$=V),_e&&D.draw(w,M.LINES,dn.disabled,an.disabled,b.colorModeForRenderPass(),mn.disabled,Nt(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(ye),E.getProjectionData({overscaledTileID:ye,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),l.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,null,b.transform.zoom,null,null,_e.collisionVertexBuffer)}if(!_||!O.length)return;const j=b.useProgram("collisionCircle"),H=new c.b_;H.resize(4*V),H._trim();let ee=0;for(const fe of O)for(let ye=0;ye<fe.circleArray.length/4;ye++){const Te=4*ye,_e=fe.circleArray[Te+0],Ae=fe.circleArray[Te+1],Me=fe.circleArray[Te+2],ve=fe.circleArray[Te+3];H.emplace(ee++,_e,Ae,Me,ve,0),H.emplace(ee++,_e,Ae,Me,ve,1),H.emplace(ee++,_e,Ae,Me,ve,2),H.emplace(ee++,_e,Ae,Me,ve,3)}(!Fa||Fa.length<2*V)&&(Fa=function(fe){const ye=2*fe,Te=new c.c0;Te.resize(ye),Te._trim();for(let _e=0;_e<ye;_e++){const Ae=6*_e;Te.uint16[Ae+0]=4*_e+0,Te.uint16[Ae+1]=4*_e+1,Te.uint16[Ae+2]=4*_e+2,Te.uint16[Ae+3]=4*_e+2,Te.uint16[Ae+4]=4*_e+3,Te.uint16[Ae+5]=4*_e+0}return Te}(V));const de=w.createIndexBuffer(Fa,!0),he=w.createVertexBuffer(H,c.b$.members,!0);for(const fe of O){const ye=$n(b.transform);j.draw(w,M.TRIANGLES,dn.disabled,an.disabled,b.colorModeForRenderPass(),mn.disabled,ye,b.style.map.terrain&&b.style.map.terrain.getTerrainData(fe.coord),null,l.id,he,de,c.aL.simpleSegment(0,2*fe.circleOffset,fe.circleArray.length,fe.circleArray.length/2),null,b.transform.zoom,null,null,null)}he.destroy(),de.destroy()}const bh=c.af(new Float32Array(16));function yo(b,n,l,p,_,w){const{horizontalAlign:E,verticalAlign:M}=c.aG(b);return new c.P((-(E-.5)*n/_+p[0])*w,(-(M-.5)*l/_+p[1])*w)}function zf(b,n,l,p,_,w){const E=n.tileAnchorPoint.add(new c.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let M=p.mult(w);l||(M=M.rotate(-_));const D=E.add(M);return Sn(D.x,D.y,n.pitchedLabelPlaneMatrix,n.getElevation).point}if(l){const M=Mt(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(b),D=Math.atan(M.y/M.x)+(M.x<0?Math.PI:0);return b.add(p.rotate(D))}return b.add(p)}function Of(b,n,l,p,_,w,E,M,D,O,V,$){const j=b.text.placedSymbolArray,H=b.text.dynamicLayoutVertexArray,ee=b.icon.dynamicLayoutVertexArray,de={};H.clear();for(let he=0;he<j.length;he++){const fe=j.get(he),ye=fe.hidden||!fe.crossTileID||b.allowVerticalPlacement&&!fe.placedOrientation?null:p[fe.crossTileID];if(ye){const Te=new c.P(fe.anchorX,fe.anchorY),_e={getElevation:$,width:_.width,height:_.height,pitchedLabelPlaneMatrix:w,pitchWithMap:l,transform:_,tileAnchorPoint:Te,translation:O,unwrappedTileID:V},Ae=l?Qt(Te.x,Te.y,_e):Mt(Te.x,Te.y,_e),Me=on(_.cameraToCenterDistance,Ae.signedDistanceFromCamera);let ve=c.ao(b.textSizeData,M,fe)*Me/c.aA;l&&(ve*=b.tilePixelRatio/E);const{width:Ne,height:tt,anchor:Xe,textOffset:Ye,textBoxScale:at}=ye,Dt=yo(Xe,Ne,tt,Ye,at,ve),kt=_.getPitchedTextCorrection(Te.x+O[0],Te.y+O[1],V),vt=zf(Ae.point,_e,n,Dt,-_.bearingInRadians,kt),qt=b.allowVerticalPlacement&&fe.placedOrientation===c.an.vertical?Math.PI/2:0;for(let An=0;An<fe.numGlyphs;An++)c.au(H,vt,qt);D&&fe.associatedIconIndex>=0&&(de[fe.associatedIconIndex]={shiftedAnchor:vt,angle:qt})}else zs(fe.numGlyphs,H)}if(D){ee.clear();const he=b.icon.placedSymbolArray;for(let fe=0;fe<he.length;fe++){const ye=he.get(fe);if(ye.hidden)zs(ye.numGlyphs,ee);else{const Te=de[fe];if(Te)for(let _e=0;_e<ye.numGlyphs;_e++)c.au(ee,Te.shiftedAnchor,Te.angle);else zs(ye.numGlyphs,ee)}}b.icon.dynamicLayoutVertexBuffer.updateData(ee)}b.text.dynamicLayoutVertexBuffer.updateData(H)}function Mu(b,n,l){return l.iconsInText&&n?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function Ru(b,n,l,p,_,w,E,M,D,O,V,$,j){const H=b.context,ee=H.gl,de=b.transform,he=M==="map",fe=D==="map",ye=M!=="viewport"&&l.layout.get("symbol-placement")!=="point",Te=he&&!fe&&!ye,_e=!l.layout.get("symbol-sort-key").isConstant();let Ae=!1;const Me=b.getDepthModeForSublayer(0,dn.ReadOnly),ve=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ne=[],tt=de.getCircleRadiusCorrection();for(const Xe of p){const Ye=n.getTile(Xe),at=Ye.getBucket(l);if(!at)continue;const Dt=_?at.text:at.icon;if(!Dt||!Dt.segments.get().length||!Dt.hasVisibleVertices)continue;const kt=Dt.programConfigurations.get(l.id),vt=_||at.sdfIcons,qt=_?at.textSizeData:at.iconSizeData,An=fe||de.pitch!==0,Qn=b.useProgram(Mu(vt,_,at),kt),Qr=c.am(qt,de.zoom),gr=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Xe);let ni,yr,_r,Ar,Ki=[0,0],Gn=null;if(_)yr=Ye.glyphAtlasTexture,_r=ee.LINEAR,ni=Ye.glyphAtlasTexture.size,at.iconsInText&&(Ki=Ye.imageAtlasTexture.size,Gn=Ye.imageAtlasTexture,Ar=An||b.options.rotating||b.options.zooming||qt.kind==="composite"||qt.kind==="camera"?ee.LINEAR:ee.NEAREST);else{const Or=l.layout.get("icon-size").constantOr(0)!==1||at.iconsNeedLinear;yr=Ye.imageAtlasTexture,_r=vt||b.options.rotating||b.options.zooming||Or||An?ee.LINEAR:ee.NEAREST,ni=Ye.imageAtlasTexture.size}const Wi=c.aB(Ye,1,b.transform.zoom),pa=Ht(he,b.transform,Wi),nu=c.L();c.ap(nu,pa);const vl=Tn(fe,he,b.transform,Wi),qs=c.aC(de,Ye,w,E),Gs=de.getProjectionData({overscaledTileID:Xe,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),ru=ve&&at.hasTextData(),Oc=l.layout.get("icon-text-fit")!=="none"&&ru&&at.hasIconData();if(ye){const Or=b.style.map.terrain?(la,oi)=>b.style.map.terrain.getElevation(Xe,la,oi):null,vr=l.layout.get("text-rotation-alignment")==="map";Wr(at,b,_,pa,nu,fe,O,vr,Xe.toUnwrapped(),de.width,de.height,qs,Or)}const qu=_&&ve||Oc,ma=ye||qu?bh:fe?pa:b.transform.clipSpaceToPixelsMatrix,Hs=vt&&l.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let bl;bl=vt?at.iconsInText?Eg(qt.kind,Qr,Te,fe,ye,qu,b,ma,vl,qs,ni,Ki,tt):Ec(qt.kind,Qr,Te,fe,ye,qu,b,ma,vl,qs,_,ni,0,tt):hd(qt.kind,Qr,Te,fe,ye,qu,b,ma,vl,qs,_,ni,tt);const Gu={program:Qn,buffers:Dt,uniformValues:bl,projectionData:Gs,atlasTexture:yr,atlasTextureIcon:Gn,atlasInterpolation:_r,atlasInterpolationIcon:Ar,isSDF:vt,hasHalo:Hs};if(_e&&at.canOverlap){Ae=!0;const Or=Dt.segments.get();for(const vr of Or)Ne.push({segments:new c.aL([vr]),sortKey:vr.sortKey,state:Gu,terrainData:gr})}else Ne.push({segments:Dt.segments,sortKey:0,state:Gu,terrainData:gr})}Ae&&Ne.sort((Xe,Ye)=>Xe.sortKey-Ye.sortKey);for(const Xe of Ne){const Ye=Xe.state;if(H.activeTexture.set(ee.TEXTURE0),Ye.atlasTexture.bind(Ye.atlasInterpolation,ee.CLAMP_TO_EDGE),Ye.atlasTextureIcon&&(H.activeTexture.set(ee.TEXTURE1),Ye.atlasTextureIcon&&Ye.atlasTextureIcon.bind(Ye.atlasInterpolationIcon,ee.CLAMP_TO_EDGE)),Ye.isSDF){const at=Ye.uniformValues;Ye.hasHalo&&(at.u_is_halo=1,ku(Ye.buffers,Xe.segments,l,b,Ye.program,Me,V,$,at,Ye.projectionData,Xe.terrainData)),at.u_is_halo=0}ku(Ye.buffers,Xe.segments,l,b,Ye.program,Me,V,$,Ye.uniformValues,Ye.projectionData,Xe.terrainData)}}function ku(b,n,l,p,_,w,E,M,D,O,V){const $=p.context;_.draw($,$.gl.TRIANGLES,w,E,M,mn.backCCW,D,V,O,l.id,b.layoutVertexBuffer,b.indexBuffer,n,l.paint,p.transform.zoom,b.programConfigurations.get(l.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function Du(b,n,l,p,_){const w=b.context,E=w.gl,M=an.disabled,D=new En([E.ONE,E.ONE],c.be.transparent,[!0,!0,!0,!0]),O=n.getBucket(l);if(!O)return;const V=p.key;let $=l.heatmapFbos.get(V);$||($=Aa(w,n.tileSize,n.tileSize),l.heatmapFbos.set(V,$)),w.bindFramebuffer.set($.framebuffer),w.viewport.set([0,0,n.tileSize,n.tileSize]),w.clear({color:c.be.transparent});const j=O.programConfigurations.get(l.id),H=b.useProgram("heatmap",j,!_),ee=b.transform.getProjectionData({overscaledTileID:n.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),de=b.style.map.terrain.getTerrainData(p);H.draw(w,E.TRIANGLES,dn.disabled,M,D,mn.disabled,qn(n,b.transform.zoom,l.paint.get("heatmap-intensity"),1),de,ee,l.id,O.layoutVertexBuffer,O.indexBuffer,O.segments,l.paint,b.transform.zoom,j)}function Ua(b,n,l,p,_){const w=b.context,E=w.gl,M=b.transform;w.setColorMode(b.colorModeForRenderPass());const D=Fo(w,n),O=l.key,V=n.heatmapFbos.get(O);if(!V)return;w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,V.colorAttachment.get()),w.activeTexture.set(E.TEXTURE1),D.bind(E.LINEAR,E.CLAMP_TO_EDGE);const $=M.getProjectionData({overscaledTileID:l,applyTerrainMatrix:_,applyGlobeMatrix:!p});b.useProgram("heatmapTexture").draw(w,E.TRIANGLES,dn.disabled,an.disabled,b.colorModeForRenderPass(),mn.disabled,Zi(b,n,0,1),null,$,n.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,n.paint,M.zoom),V.destroy(),n.heatmapFbos.delete(O)}function Aa(b,n,l){var p,_;const w=b.gl,E=w.createTexture();w.bindTexture(w.TEXTURE_2D,E),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const M=(p=b.HALF_FLOAT)!==null&&p!==void 0?p:w.UNSIGNED_BYTE,D=(_=b.RGBA16F)!==null&&_!==void 0?_:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,D,n,l,0,w.RGBA,M,null);const O=b.createFramebuffer(n,l,!1,!1);return O.colorAttachment.set(E),O}function Fo(b,n){return n.colorRampTexture||(n.colorRampTexture=new c.T(b,n.colorRamp,b.gl.RGBA)),n.colorRampTexture}function _o(b,n,l,p,_){if(!l||!p||!p.imageAtlas)return;const w=p.imageAtlas.patternPositions;let E=w[l.to.toString()],M=w[l.from.toString()];if(!E&&M&&(E=M),!M&&E&&(M=E),!E||!M){const D=_.getPaintProperty(n);E=w[D],M=w[D]}E&&M&&b.setConstantPatternPositions(E,M)}function _s(b,n,l,p,_,w,E,M){const D=b.context.gl,O="fill-pattern",V=l.paint.get(O),$=V&&V.constantOr(1),j=l.getCrossfadeParameters();let H,ee,de,he,fe;const ye=b.transform,Te=l.paint.get("fill-translate"),_e=l.paint.get("fill-translate-anchor");E?(ee=$&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=D.LINES):(ee=$?"fillPattern":"fill",H=D.TRIANGLES);const Ae=V.constantOr(null);for(const Me of p){const ve=n.getTile(Me);if($&&!ve.patternsLoaded())continue;const Ne=ve.getBucket(l);if(!Ne)continue;const tt=Ne.programConfigurations.get(l.id),Xe=b.useProgram(ee,tt),Ye=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Me);$&&(b.context.activeTexture.set(D.TEXTURE0),ve.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),tt.updatePaintBuffers(j)),_o(tt,O,Ae,ve,l);const at=ye.getProjectionData({overscaledTileID:Me,applyGlobeMatrix:!M,applyTerrainMatrix:!0}),Dt=c.aC(ye,ve,Te,_e);if(E){he=Ne.indexBuffer2,fe=Ne.segments2;const vt=[D.drawingBufferWidth,D.drawingBufferHeight];de=ee==="fillOutlinePattern"&&$?Qe(b,j,ve,vt,Dt):ce(vt,Dt)}else he=Ne.indexBuffer,fe=Ne.segments,de=$?Z(b,j,ve,Dt):{u_fill_translate:Dt};const kt=b.stencilModeForClipping(Me);Xe.draw(b.context,H,_,kt,w,mn.backCCW,de,Ye,at,l.id,Ne.layoutVertexBuffer,he,fe,l.paint,b.transform.zoom,tt)}}function Fs(b,n,l,p,_,w,E,M){const D=b.context,O=D.gl,V="fill-extrusion-pattern",$=l.paint.get(V),j=$.constantOr(1),H=l.getCrossfadeParameters(),ee=l.paint.get("fill-extrusion-opacity"),de=$.constantOr(null),he=b.transform;for(const fe of p){const ye=n.getTile(fe),Te=ye.getBucket(l);if(!Te)continue;const _e=b.style.map.terrain&&b.style.map.terrain.getTerrainData(fe),Ae=Te.programConfigurations.get(l.id),Me=b.useProgram(j?"fillExtrusionPattern":"fillExtrusion",Ae);j&&(b.context.activeTexture.set(O.TEXTURE0),ye.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ae.updatePaintBuffers(H));const ve=he.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!M,applyTerrainMatrix:!0});_o(Ae,V,de,ye,l);const Ne=c.aC(he,ye,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),tt=l.paint.get("fill-extrusion-vertical-gradient"),Xe=j?F(b,tt,ee,Ne,fe,H,ye):A(b,tt,ee,Ne);Me.draw(D,D.gl.TRIANGLES,_,w,E,mn.backCCW,Xe,_e,ve,l.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,l.paint,b.transform.zoom,Ae,b.style.map.terrain&&Te.centroidVertexBuffer)}}function Lu(b,n,l,p,_,w,E,M,D){var O;const V=b.style.projection,$=b.context,j=b.transform,H=$.gl,ee=[`#define NUM_ILLUMINATION_SOURCES ${l.paint.get("hillshade-highlight-color").values.length}`],de=b.useProgram("hillshade",null,!1,ee),he=!b.options.moving;for(const fe of p){const ye=n.getTile(fe),Te=ye.fbo;if(!Te)continue;const _e=V.getMeshFromTileID($,fe.canonical,M,!0,"raster"),Ae=(O=b.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(fe);$.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,Te.colorAttachment.get());const Me=j.getProjectionData({overscaledTileID:fe,aligned:he,applyGlobeMatrix:!D,applyTerrainMatrix:!0});de.draw($,H.TRIANGLES,w,_[fe.overscaledZ],E,mn.backCCW,ei(b,ye,l),Ae,Me,l.id,_e.vertexBuffer,_e.indexBuffer,_e.segments)}}function zu(b,n,l,p,_,w,E,M,D){var O;const V=b.style.projection,$=b.context,j=b.transform,H=$.gl,ee=b.useProgram("colorRelief"),de=!b.options.moving;let he=!0;for(const fe of p){const ye=n.getTile(fe),Te=ye.dem;if(he){const tt=H.getParameter(H.MAX_TEXTURE_SIZE),{elevationTexture:Xe,colorTexture:Ye}=l.getColorRampTextures($,tt,Te.getUnpackVector());$.activeTexture.set(H.TEXTURE1),Xe.bind(H.NEAREST,H.CLAMP_TO_EDGE),$.activeTexture.set(H.TEXTURE4),Ye.bind(H.LINEAR,H.CLAMP_TO_EDGE),he=!1}if(!Te||!Te.data)continue;const _e=Te.stride,Ae=Te.getPixels();if($.activeTexture.set(H.TEXTURE0),$.pixelStoreUnpackPremultiplyAlpha.set(!1),ye.demTexture=ye.demTexture||b.getTileTexture(_e),ye.demTexture){const tt=ye.demTexture;tt.update(Ae,{premultiply:!1}),tt.bind(H.LINEAR,H.CLAMP_TO_EDGE)}else ye.demTexture=new c.T($,Ae,H.RGBA,{premultiply:!1}),ye.demTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const Me=V.getMeshFromTileID($,fe.canonical,M,!0,"raster"),ve=(O=b.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(fe),Ne=j.getProjectionData({overscaledTileID:fe,aligned:de,applyGlobeMatrix:!D,applyTerrainMatrix:!0});ee.draw($,H.TRIANGLES,w,_[fe.overscaledZ],E,mn.backCCW,Vo(l,ye.dem),ve,Ne,l.id,Me.vertexBuffer,Me.indexBuffer,Me.segments)}}const xh=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function pi(b,n,l,p,_,w,E,M,D=!1,O=!1){const V=p[p.length-1].overscaledZ,$=b.context,j=$.gl,H=b.useProgram("raster"),ee=b.transform,de=b.style.projection,he=b.colorModeForRenderPass(),fe=!b.options.moving;for(const ye of p){const Te=b.getDepthModeForSublayer(ye.overscaledZ-V,l.paint.get("raster-opacity")===1?dn.ReadWrite:dn.ReadOnly,j.LESS),_e=n.getTile(ye);_e.registerFadeDuration(l.paint.get("raster-fade-duration"));const Ae=n.findLoadedParent(ye,0),Me=n.findLoadedSibling(ye),ve=mi(_e,Ae||Me||null,n,l,b.transform,b.style.map.terrain);let Ne,tt;const Xe=l.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;$.activeTexture.set(j.TEXTURE0),_e.texture.bind(Xe,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),$.activeTexture.set(j.TEXTURE1),Ae?(Ae.texture.bind(Xe,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Ne=Math.pow(2,Ae.tileID.overscaledZ-_e.tileID.overscaledZ),tt=[_e.tileID.canonical.x*Ne%1,_e.tileID.canonical.y*Ne%1]):_e.texture.bind(Xe,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),_e.texture.useMipmap&&$.extTextureFilterAnisotropic&&b.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const Ye=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ye),at=ee.getProjectionData({overscaledTileID:ye,aligned:fe,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),Dt=Ul(tt||[0,0],Ne||1,ve,l,M),kt=de.getMeshFromTileID($,ye.canonical,w,E,"raster");H.draw($,j.TRIANGLES,Te,_?_[ye.overscaledZ]:an.disabled,he,D?mn.frontCCW:mn.backCCW,Dt,Ye,at,l.id,kt.vertexBuffer,kt.indexBuffer,kt.segments)}}function mi(b,n,l,p,_,w){const E=p.paint.get("raster-fade-duration");if(!w&&E>0){const M=G.now(),D=(M-b.timeAdded)/E,O=n?(M-n.timeAdded)/E:-1,V=l.getSource(),$=lt(_,{tileSize:V.tileSize,roundZoom:V.roundZoom}),j=!n||Math.abs(n.tileID.overscaledZ-$)>Math.abs(b.tileID.overscaledZ-$),H=j&&b.refreshedUponExpiration?1:c.ag(j?D:1-O,0,1);return b.refreshedUponExpiration&&D>=1&&(b.refreshedUponExpiration=!1),n?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const or=new c.be(1,0,0,1),Uo=new c.be(0,1,0,1),Us=new c.be(0,0,1,1),_d=new c.be(1,0,1,1),Hl=new c.be(0,1,1,1);function Pc(b,n,l,p){Zl(b,0,n+l/2,b.transform.width,l,p)}function wh(b,n,l,p){Zl(b,n-l/2,0,l,b.transform.height,p)}function Zl(b,n,l,p,_,w){const E=b.context,M=E.gl;M.enable(M.SCISSOR_TEST),M.scissor(n*b.pixelRatio,l*b.pixelRatio,p*b.pixelRatio,_*b.pixelRatio),E.clear({color:w}),M.disable(M.SCISSOR_TEST)}function Mc(b,n,l){const p=b.context,_=p.gl,w=b.useProgram("debug"),E=dn.disabled,M=an.disabled,D=b.colorModeForRenderPass(),O="$debug",V=b.style.map.terrain&&b.style.map.terrain.getTerrainData(l);p.activeTexture.set(_.TEXTURE0);const $=n.getTileByID(l.key).latestRawTileData,j=Math.floor(($&&$.byteLength||0)/1024),H=n.getTile(l).tileSize,ee=512/Math.min(H,512)*(l.overscaledZ/b.transform.zoom)*.5;let de=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(de+=` => ${l.overscaledZ}`),function(fe,ye){fe.initDebugOverlayCanvas();const Te=fe.debugOverlayCanvas,_e=fe.context.gl,Ae=fe.debugOverlayCanvas.getContext("2d");Ae.clearRect(0,0,Te.width,Te.height),Ae.shadowColor="white",Ae.shadowBlur=2,Ae.lineWidth=1.5,Ae.strokeStyle="white",Ae.textBaseline="top",Ae.font="bold 36px Open Sans, sans-serif",Ae.fillText(ye,5,5),Ae.strokeText(ye,5,5),fe.debugOverlayTexture.update(Te),fe.debugOverlayTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE)}(b,`${de} ${j}kB`);const he=b.transform.getProjectionData({overscaledTileID:l,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(p,_.TRIANGLES,E,M,En.alphaBlended,mn.disabled,Ni(c.be.transparent,ee),null,he,O,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),w.draw(p,_.LINE_STRIP,E,M,D,mn.disabled,Ni(c.be.red),V,he,O,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function ti(b,n,l,p){const{isRenderingGlobe:_}=p,w=b.context,E=w.gl,M=b.transform,D=b.colorModeForRenderPass(),O=b.getDepthModeFor3D(),V=b.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,b.width,b.height]);for(const $ of l){const j=n.getTerrainMesh($.tileID),H=b.renderToTexture.getTexture($),ee=n.getTerrainData($.tileID);w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,H.texture);const de=n.getMeshFrameDelta(M.zoom),he=M.calculateFogMatrix($.tileID.toUnwrapped()),fe=Tc(de,he,b.style.sky,M.pitch,_),ye=M.getProjectionData({overscaledTileID:$.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});V.draw(w,E.TRIANGLES,O,an.disabled,D,mn.backCCW,fe,ee,ye,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}}function js(b,n){if(!n.mesh){const l=new c.aK;l.emplaceBack(-1,-1),l.emplaceBack(1,-1),l.emplaceBack(1,1),l.emplaceBack(-1,1);const p=new c.aM;p.emplaceBack(0,1,2),p.emplaceBack(0,2,3),n.mesh=new us(b.createVertexBuffer(l,cs.members),b.createIndexBuffer(p),c.aL.simpleSegment(0,0,l.length,p.length))}return n.mesh}class es{constructor(n,l){this.context=new kn(n),this.transform=l,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ft.maxUnderzooming+ft.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Oo}resize(n,l,p){if(this.width=Math.floor(n*p),this.height=Math.floor(l*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const n=this.context,l=new c.aK;l.emplaceBack(0,0),l.emplaceBack(c.$,0),l.emplaceBack(0,c.$),l.emplaceBack(c.$,c.$),this.tileExtentBuffer=n.createVertexBuffer(l,cs.members),this.tileExtentSegments=c.aL.simpleSegment(0,0,4,2);const p=new c.aK;p.emplaceBack(0,0),p.emplaceBack(c.$,0),p.emplaceBack(0,c.$),p.emplaceBack(c.$,c.$),this.debugBuffer=n.createVertexBuffer(p,cs.members),this.debugSegments=c.aL.simpleSegment(0,0,4,5);const _=new c.c5;_.emplaceBack(0,0,0,0),_.emplaceBack(c.$,0,c.$,0),_.emplaceBack(0,c.$,0,c.$),_.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=n.createVertexBuffer(_,ud.members),this.rasterBoundsSegments=c.aL.simpleSegment(0,0,4,2);const w=new c.aK;w.emplaceBack(0,0),w.emplaceBack(c.$,0),w.emplaceBack(0,c.$),w.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=n.createVertexBuffer(w,cs.members),this.rasterBoundsSegmentsPosOnly=c.aL.simpleSegment(0,0,4,5);const E=new c.aK;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(E,cs.members),this.viewportSegments=c.aL.simpleSegment(0,0,4,2);const M=new c.c6;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(M);const D=new c.aM;D.emplaceBack(1,0,2),D.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(D);const O=this.context.gl;this.stencilClearMode=new an({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.tileExtentMesh=new us(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const n=this.context,l=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=c.L();c.bX(p,0,this.width,this.height,0,0,1),c.N(p,p,[l.drawingBufferWidth,l.drawingBufferHeight,0]);const _={mainMatrix:p,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:p};this.useProgram("clippingMask",null,!0).draw(n,l.TRIANGLES,dn.disabled,this.stencilClearMode,En.disabled,mn.disabled,null,null,_,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,l,p){if(this.currentStencilSource===n.source||!n.isTileClipped()||!l||!l.length)return;this.currentStencilSource=n.source,this.nextStencilID+l.length>256&&this.clearStencil();const _=this.context;_.setColorMode(En.disabled),_.setDepthMode(dn.disabled);const w={};for(const E of l)w[E.key]=this.nextStencilID++;this._renderTileMasks(w,l,p,!0),this._renderTileMasks(w,l,p,!1),this._tileClippingMaskIDs=w}_renderTileMasks(n,l,p,_){const w=this.context,E=w.gl,M=this.style.projection,D=this.transform,O=this.useProgram("clippingMask");for(const V of l){const $=n[V.key],j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(V),H=M.getMeshFromTileID(this.context,V.canonical,_,!0,"stencil"),ee=D.getProjectionData({overscaledTileID:V,applyGlobeMatrix:!p,applyTerrainMatrix:!0});O.draw(w,E.TRIANGLES,dn.disabled,new an({func:E.ALWAYS,mask:0},$,255,E.KEEP,E.KEEP,E.REPLACE),En.disabled,p?mn.disabled:mn.backCCW,null,j,ee,"$clipping",H.vertexBuffer,H.indexBuffer,H.segments)}}_renderTilesDepthBuffer(){const n=this.context,l=n.gl,p=this.style.projection,_=this.transform,w=this.useProgram("depth"),E=this.getDepthModeFor3D(),M=it(_,{tileSize:_.tileSize});for(const D of M){const O=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),V=p.getMeshFromTileID(this.context,D.canonical,!0,!0,"raster"),$=_.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(n,l.TRIANGLES,E,an.disabled,En.disabled,mn.backCCW,null,O,$,"$clipping",V.vertexBuffer,V.indexBuffer,V.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,l=this.context.gl;return new an({func:l.NOTEQUAL,mask:255},n,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(n){const l=this.context.gl;return new an({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,l.KEEP,l.KEEP,l.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(n){const l=this.context.gl,p=n.sort((E,M)=>M.overscaledZ-E.overscaledZ),_=p[p.length-1].overscaledZ,w=p[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const E={};for(let M=0;M<w;M++)E[M+_]=new an({func:l.GEQUAL,mask:255},M+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=w,[E,p]}return[{[_]:an.disabled},p]}stencilConfigForOverlapTwoPass(n){const l=this.context.gl,p=n.sort((E,M)=>M.overscaledZ-E.overscaledZ),_=p[p.length-1].overscaledZ,w=p[0].overscaledZ-_+1;if(this.clearStencil(),w>1){const E={},M={};for(let D=0;D<w;D++)E[D+_]=new an({func:l.GREATER,mask:255},w+1+D,255,l.KEEP,l.KEEP,l.REPLACE),M[D+_]=new an({func:l.GREATER,mask:255},1+D,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID=2*w+1,[E,M,p]}return this.nextStencilID=3,[{[_]:new an({func:l.GREATER,mask:255},2,255,l.KEEP,l.KEEP,l.REPLACE)},{[_]:new an({func:l.GREATER,mask:255},1,255,l.KEEP,l.KEEP,l.REPLACE)},p]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new En([n.CONSTANT_COLOR,n.ONE],new c.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?En.unblended:En.alphaBlended}getDepthModeForSublayer(n,l,p){if(!this.opaquePassEnabledForLayer())return dn.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new dn(p||this.context.gl.LEQUAL,l,[_,_])}getDepthModeFor3D(){return new dn(this.context.gl.LEQUAL,dn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,l){var p,_;this.style=n,this.options=l,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(G.now()),this.imageManager.beginFrame();const w=this.style._order,E=this.style.sourceCaches,M={},D={},O={},V={isRenderingToTexture:!1,isRenderingGlobe:((p=n.projection)===null||p===void 0?void 0:p.transitionState)>0};for(const j in E){const H=E[j];H.used&&H.prepare(this.context),M[j]=H.getVisibleCoordinates(!1),D[j]=M[j].slice().reverse(),O[j]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<w.length;j++)if(this.style._layers[w[j]].is3D()){this.opaquePassCutoff=j;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const j of w){const H=this.style._layers[j];if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const ee=D[H.source];(H.type==="custom"||ee.length)&&this.renderLayer(this,E[H.source],H,ee,V)}if((_=this.style.projection)===null||_===void 0||_.updateGPUdependent({context:this.context,useProgram:j=>this.useProgram(j)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:l.showOverdrawInspector?c.be.black:c.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(j,H){const ee=j.context,de=ee.gl,he=((Me,ve,Ne)=>{const tt=Math.cos(ve.rollInRadians),Xe=Math.sin(ve.rollInRadians),Ye=re(ve),at=ve.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Me.properties.get("sky-color"),u_horizon_color:Me.properties.get("horizon-color"),u_horizon:[(ve.width/2-Ye*Xe)*Ne,(ve.height/2+Ye*tt)*Ne],u_horizon_normal:[-Xe,tt],u_sky_horizon_blend:Me.properties.get("sky-horizon-blend")*ve.height/2*Ne,u_sky_blend:at}})(H,j.style.map.transform,j.pixelRatio),fe=new dn(de.LEQUAL,dn.ReadWrite,[0,1]),ye=an.disabled,Te=j.colorModeForRenderPass(),_e=j.useProgram("sky"),Ae=js(ee,H);_e.draw(ee,de.TRIANGLES,fe,ye,Te,mn.disabled,he,null,void 0,"sky",Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}(this,this.style.sky),this._showOverdrawInspector=l.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[w[this.currentLayer]],H=E[j.source],ee=M[j.source];this._renderTileClippingMasks(j,ee,!1),this.renderLayer(this,H,j,ee,V)}this.renderPass="translucent";let $=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const j=this.style._layers[w[this.currentLayer]],H=E[j.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(j,V))continue;this.opaquePassEnabledForLayer()||$||($=!0,V.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ee=(j.type==="symbol"?O:D)[j.source];this._renderTileClippingMasks(j,M[j.source],!!this.renderToTexture),this.renderLayer(this,H,j,ee,V)}if(V.isRenderingGlobe&&function(j,H,ee){const de=j.context,he=de.gl,fe=j.useProgram("atmosphere"),ye=new dn(he.LEQUAL,dn.ReadOnly,[0,1]),Te=j.transform,_e=function(at,Dt){const kt=at.properties.get("position"),vt=[-kt.x,-kt.y,-kt.z],qt=c.af(new Float64Array(16));return at.properties.get("anchor")==="map"&&(c.b5(qt,qt,Dt.rollInRadians),c.b6(qt,qt,-Dt.pitchInRadians),c.b5(qt,qt,Dt.bearingInRadians),c.b6(qt,qt,Dt.center.lat*Math.PI/180),c.by(qt,qt,-Dt.center.lng*Math.PI/180)),c.c4(vt,vt,qt),vt}(ee,j.transform),Ae=Te.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Me=H.properties.get("atmosphere-blend")*Ae.projectionTransition;if(Me===0)return;const ve=Vs(Te.worldSize,Te.center.lat),Ne=Te.inverseProjectionMatrix,tt=new Float64Array(4);tt[3]=1,c.av(tt,tt,Te.modelViewProjectionMatrix),tt[0]/=tt[3],tt[1]/=tt[3],tt[2]/=tt[3],tt[3]=1,c.av(tt,tt,Ne),tt[0]/=tt[3],tt[1]/=tt[3],tt[2]/=tt[3],tt[3]=1;const Xe=((at,Dt,kt,vt,qt)=>({u_sun_pos:at,u_atmosphere_blend:Dt,u_globe_position:kt,u_globe_radius:vt,u_inv_proj_matrix:qt}))(_e,Me,[tt[0],tt[1],tt[2]],ve,Ne),Ye=js(de,H);fe.draw(de,he.TRIANGLES,ye,an.disabled,En.alphaBlended,mn.disabled,Xe,null,null,"atmosphere",Ye.vertexBuffer,Ye.indexBuffer,Ye.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const j=function(H,ee){let de=null;const he=Object.values(H._layers).flatMap(_e=>_e.source&&!_e.isHidden(ee)?[H.sourceCaches[_e.source]]:[]),fe=he.filter(_e=>_e.getSource().type==="vector"),ye=he.filter(_e=>_e.getSource().type!=="vector"),Te=_e=>{(!de||de.getSource().maxzoom<_e.getSource().maxzoom)&&(de=_e)};return fe.forEach(_e=>Te(_e)),de||ye.forEach(_e=>Te(_e)),de}(this.style,this.transform.zoom);j&&function(H,ee,de){for(let he=0;he<de.length;he++)Mc(H,ee,de[he])}(this,j,j.getVisibleCoordinates())}this.options.showPadding&&function(j){const H=j.transform.padding;Pc(j,j.transform.height-(H.top||0),3,or),Pc(j,H.bottom||0,3,Uo),wh(j,H.left||0,3,Us),wh(j,j.transform.width-(H.right||0),3,_d);const ee=j.transform.centerPoint;(function(de,he,fe,ye){Zl(de,he-1,fe-10,2,20,ye),Zl(de,he-10,fe-1,20,2,ye)})(j,ee.x,j.transform.height-ee.y,Hl)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const l=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix;let _=this.terrainFacilitator.dirty;_||(_=n?!c.c7(l,p):!c.c8(l,p)),_||(_=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),_&&(c.c9(l,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(w,E){const M=w.context,D=M.gl,O=w.transform,V=En.unblended,$=new dn(D.LEQUAL,dn.ReadWrite,[0,1]),j=E.sourceCache.getRenderableTiles(),H=w.useProgram("terrainDepth");M.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),M.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),M.clear({color:c.be.transparent,depth:1});for(const ee of j){const de=E.getTerrainMesh(ee.tileID),he=E.getTerrainData(ee.tileID),fe=O.getProjectionData({overscaledTileID:ee.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ye={u_ele_delta:E.getMeshFrameDelta(O.zoom)};H.draw(M,D.TRIANGLES,$,an.disabled,V,mn.backCCW,ye,he,fe,"terrain",de.vertexBuffer,de.indexBuffer,de.segments)}M.bindFramebuffer.set(null),M.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain),function(w,E){const M=w.context,D=M.gl,O=w.transform,V=En.unblended,$=new dn(D.LEQUAL,dn.ReadWrite,[0,1]),j=E.getCoordsTexture(),H=E.sourceCache.getRenderableTiles(),ee=w.useProgram("terrainCoords");M.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),M.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),M.clear({color:c.be.transparent,depth:1}),E.coordsIndex=[];for(const de of H){const he=E.getTerrainMesh(de.tileID),fe=E.getTerrainData(de.tileID);M.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,j.texture);const ye={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(O.zoom)},Te=O.getProjectionData({overscaledTileID:de.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ee.draw(M,D.TRIANGLES,$,an.disabled,V,mn.backCCW,ye,fe,Te,"terrain",he.vertexBuffer,he.indexBuffer,he.segments),E.coordsIndex.push(de.tileID.key)}M.bindFramebuffer.set(null),M.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain))}renderLayer(n,l,p,_,w){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||(_||[]).length)&&(this.id=p.id,c.ca(p)?function(E,M,D,O,V,$){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:j}=$,H=an.disabled,ee=E.colorModeForRenderPass();(D._unevaluatedLayout.hasValue("text-variable-anchor")||D._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(de,he,fe,ye,Te,_e,Ae,Me,ve){const Ne=he.transform,tt=he.style.map.terrain,Xe=Te==="map",Ye=_e==="map";for(const at of de){const Dt=ye.getTile(at),kt=Dt.getBucket(fe);if(!kt||!kt.text||!kt.text.segments.get().length)continue;const vt=c.am(kt.textSizeData,Ne.zoom),qt=c.aB(Dt,1,he.transform.zoom),An=Ht(Xe,he.transform,qt),Qn=fe.layout.get("icon-text-fit")!=="none"&&kt.hasIconData();if(vt){const Qr=Math.pow(2,Ne.zoom-Dt.tileID.overscaledZ),gr=tt?(ni,yr)=>tt.getElevation(at,ni,yr):null;Of(kt,Xe,Ye,ve,Ne,An,Qr,vt,Qn,c.aC(Ne,Dt,Ae,Me),at.toUnwrapped(),gr)}}}(O,E,D,M,D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),V),D.paint.get("icon-opacity").constantOr(1)!==0&&Ru(E,M,D,O,!1,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),D.layout.get("icon-rotation-alignment"),D.layout.get("icon-pitch-alignment"),D.layout.get("icon-keep-upright"),H,ee,j),D.paint.get("text-opacity").constantOr(1)!==0&&Ru(E,M,D,O,!0,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.layout.get("text-keep-upright"),H,ee,j),M.map.showCollisionBoxes&&(Lf(E,M,D,O,!0),Lf(E,M,D,O,!1))}(n,l,p,_,this.style.placement.variableOffsets,w):c.cb(p)?function(E,M,D,O,V){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=V,j=D.paint.get("circle-opacity"),H=D.paint.get("circle-stroke-width"),ee=D.paint.get("circle-stroke-opacity"),de=!D.layout.get("circle-sort-key").isConstant();if(j.constantOr(1)===0&&(H.constantOr(1)===0||ee.constantOr(1)===0))return;const he=E.context,fe=he.gl,ye=E.transform,Te=E.getDepthModeForSublayer(0,dn.ReadOnly),_e=an.disabled,Ae=E.colorModeForRenderPass(),Me=[],ve=ye.getCircleRadiusCorrection();for(let Ne=0;Ne<O.length;Ne++){const tt=O[Ne],Xe=M.getTile(tt),Ye=Xe.getBucket(D);if(!Ye)continue;const at=D.paint.get("circle-translate"),Dt=D.paint.get("circle-translate-anchor"),kt=c.aC(ye,Xe,at,Dt),vt=Ye.programConfigurations.get(D.id),qt=E.useProgram("circle",vt),An=Ye.layoutVertexBuffer,Qn=Ye.indexBuffer,Qr=E.style.map.terrain&&E.style.map.terrain.getTerrainData(tt),gr={programConfiguration:vt,program:qt,layoutVertexBuffer:An,indexBuffer:Qn,uniformValues:dt(E,Xe,D,kt,ve),terrainData:Qr,projectionData:ye.getProjectionData({overscaledTileID:tt,applyGlobeMatrix:!$,applyTerrainMatrix:!0})};if(de){const ni=Ye.segments.get();for(const yr of ni)Me.push({segments:new c.aL([yr]),sortKey:yr.sortKey,state:gr})}else Me.push({segments:Ye.segments,sortKey:0,state:gr})}de&&Me.sort((Ne,tt)=>Ne.sortKey-tt.sortKey);for(const Ne of Me){const{programConfiguration:tt,program:Xe,layoutVertexBuffer:Ye,indexBuffer:at,uniformValues:Dt,terrainData:kt,projectionData:vt}=Ne.state;Xe.draw(he,fe.TRIANGLES,Te,_e,Ae,mn.backCCW,Dt,kt,vt,D.id,Ye,at,Ne.segments,D.paint,E.transform.zoom,tt)}}(n,l,p,_,w):c.cc(p)?function(E,M,D,O,V){if(D.paint.get("heatmap-opacity")===0)return;const $=E.context,{isRenderingToTexture:j,isRenderingGlobe:H}=V;if(E.style.map.terrain){for(const ee of O){const de=M.getTile(ee);M.hasRenderableParent(ee)||(E.renderPass==="offscreen"?Du(E,de,D,ee,H):E.renderPass==="translucent"&&Ua(E,D,ee,j,H))}$.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?function(ee,de,he,fe){const ye=ee.context,Te=ye.gl,_e=ee.transform,Ae=an.disabled,Me=new En([Te.ONE,Te.ONE],c.be.transparent,[!0,!0,!0,!0]);(function(ve,Ne,tt){const Xe=ve.gl;ve.activeTexture.set(Xe.TEXTURE1),ve.viewport.set([0,0,Ne.width/4,Ne.height/4]);let Ye=tt.heatmapFbos.get(c.c1);Ye?(Xe.bindTexture(Xe.TEXTURE_2D,Ye.colorAttachment.get()),ve.bindFramebuffer.set(Ye.framebuffer)):(Ye=Aa(ve,Ne.width/4,Ne.height/4),tt.heatmapFbos.set(c.c1,Ye))})(ye,ee,he),ye.clear({color:c.be.transparent});for(let ve=0;ve<fe.length;ve++){const Ne=fe[ve];if(de.hasRenderableParent(Ne))continue;const tt=de.getTile(Ne),Xe=tt.getBucket(he);if(!Xe)continue;const Ye=Xe.programConfigurations.get(he.id),at=ee.useProgram("heatmap",Ye),Dt=_e.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),kt=_e.getCircleRadiusCorrection();at.draw(ye,Te.TRIANGLES,dn.disabled,Ae,Me,mn.backCCW,qn(tt,_e.zoom,he.paint.get("heatmap-intensity"),kt),null,Dt,he.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,he.paint,_e.zoom,Ye)}ye.viewport.set([0,0,ee.width,ee.height])}(E,M,D,O):E.renderPass==="translucent"&&function(ee,de){const he=ee.context,fe=he.gl;he.setColorMode(ee.colorModeForRenderPass());const ye=de.heatmapFbos.get(c.c1);ye&&(he.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,ye.colorAttachment.get()),he.activeTexture.set(fe.TEXTURE1),Fo(he,de).bind(fe.LINEAR,fe.CLAMP_TO_EDGE),ee.useProgram("heatmapTexture").draw(he,fe.TRIANGLES,dn.disabled,an.disabled,ee.colorModeForRenderPass(),mn.disabled,Zi(ee,de,0,1),null,null,de.id,ee.viewportBuffer,ee.quadTriangleIndexBuffer,ee.viewportSegments,de.paint,ee.transform.zoom))}(E,D)}(n,l,p,_,w):c.cd(p)?function(E,M,D,O,V){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=V,j=D.paint.get("line-opacity"),H=D.paint.get("line-width");if(j.constantOr(1)===0||H.constantOr(1)===0)return;const ee=E.getDepthModeForSublayer(0,dn.ReadOnly),de=E.colorModeForRenderPass(),he=D.paint.get("line-dasharray"),fe=D.paint.get("line-pattern"),ye=fe.constantOr(1),Te=D.paint.get("line-gradient"),_e=D.getCrossfadeParameters(),Ae=ye?"linePattern":he?"lineSDF":Te?"lineGradient":"line",Me=E.context,ve=Me.gl,Ne=E.transform;let tt=!0;for(const Xe of O){const Ye=M.getTile(Xe);if(ye&&!Ye.patternsLoaded())continue;const at=Ye.getBucket(D);if(!at)continue;const Dt=at.programConfigurations.get(D.id),kt=E.context.program.get(),vt=E.useProgram(Ae,Dt),qt=tt||vt.program!==kt,An=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Xe),Qn=fe.constantOr(null);if(Qn&&Ye.imageAtlas){const _r=Ye.imageAtlas,Ar=_r.patternPositions[Qn.to.toString()],Ki=_r.patternPositions[Qn.from.toString()];Ar&&Ki&&Dt.setConstantPatternPositions(Ar,Ki)}const Qr=Ne.getProjectionData({overscaledTileID:Xe,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),gr=Ne.getPixelScale(),ni=ye?Sf(E,Ye,D,gr,_e):he?Ef(E,Ye,D,gr,he,_e):Te?Sc(E,Ye,D,gr,at.lineClipsArray.length):Fl(E,Ye,D,gr);if(ye)Me.activeTexture.set(ve.TEXTURE0),Ye.imageAtlasTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),Dt.updatePaintBuffers(_e);else if(he&&(qt||E.lineAtlas.dirty))Me.activeTexture.set(ve.TEXTURE0),E.lineAtlas.bind(Me);else if(Te){const _r=at.gradients[D.id];let Ar=_r.texture;if(D.gradientVersion!==_r.version){let Ki=256;if(D.stepInterpolant){const Gn=M.getSource().maxzoom,Wi=Xe.canonical.z===Gn?Math.ceil(1<<E.transform.maxZoom-Xe.canonical.z):1;Ki=c.ag(c.c2(at.maxLineLength/c.$*1024*Wi),256,Me.maxTextureSize)}_r.gradient=c.c3({expression:D.gradientExpression(),evaluationKey:"lineProgress",resolution:Ki,image:_r.gradient||void 0,clips:at.lineClipsArray}),_r.texture?_r.texture.update(_r.gradient):_r.texture=new c.T(Me,_r.gradient,ve.RGBA),_r.version=D.gradientVersion,Ar=_r.texture}Me.activeTexture.set(ve.TEXTURE0),Ar.bind(D.stepInterpolant?ve.NEAREST:ve.LINEAR,ve.CLAMP_TO_EDGE)}const yr=E.stencilModeForClipping(Xe);vt.draw(Me,ve.TRIANGLES,ee,yr,de,mn.disabled,ni,An,Qr,D.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,D.paint,E.transform.zoom,Dt,at.layoutVertexBuffer2),tt=!1}}(n,l,p,_,w):c.ce(p)?function(E,M,D,O,V){const $=D.paint.get("fill-color"),j=D.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const{isRenderingToTexture:H}=V,ee=E.colorModeForRenderPass(),de=D.paint.get("fill-pattern"),he=E.opaquePassEnabledForLayer()&&!de.constantOr(1)&&$.constantOr(c.be.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===he){const fe=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?dn.ReadWrite:dn.ReadOnly);_s(E,M,D,O,fe,ee,!1,H)}if(E.renderPass==="translucent"&&D.paint.get("fill-antialias")){const fe=E.getDepthModeForSublayer(D.getPaintProperty("fill-outline-color")?2:0,dn.ReadOnly);_s(E,M,D,O,fe,ee,!0,H)}}(n,l,p,_,w):c.cf(p)?function(E,M,D,O,V){const $=D.paint.get("fill-extrusion-opacity");if($===0)return;const{isRenderingToTexture:j}=V;if(E.renderPass==="translucent"){const H=new dn(E.context.gl.LEQUAL,dn.ReadWrite,E.depthRangeFor3D);if($!==1||D.paint.get("fill-extrusion-pattern").constantOr(1))Fs(E,M,D,O,H,an.disabled,En.disabled,j),Fs(E,M,D,O,H,E.stencilModeFor3D(),E.colorModeForRenderPass(),j);else{const ee=E.colorModeForRenderPass();Fs(E,M,D,O,H,an.disabled,ee,j)}}}(n,l,p,_,w):c.cg(p)?function(E,M,D,O,V){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=V,j=E.context,H=E.style.projection.useSubdivision,ee=E.getDepthModeForSublayer(0,dn.ReadOnly),de=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(he,fe,ye,Te,_e,Ae,Me){const ve=he.context,Ne=ve.gl;for(const tt of ye){const Xe=fe.getTile(tt),Ye=Xe.dem;if(!Ye||!Ye.data||!Xe.needsHillshadePrepare)continue;const at=Ye.dim,Dt=Ye.stride,kt=Ye.getPixels();if(ve.activeTexture.set(Ne.TEXTURE1),ve.pixelStoreUnpackPremultiplyAlpha.set(!1),Xe.demTexture=Xe.demTexture||he.getTileTexture(Dt),Xe.demTexture){const qt=Xe.demTexture;qt.update(kt,{premultiply:!1}),qt.bind(Ne.NEAREST,Ne.CLAMP_TO_EDGE)}else Xe.demTexture=new c.T(ve,kt,Ne.RGBA,{premultiply:!1}),Xe.demTexture.bind(Ne.NEAREST,Ne.CLAMP_TO_EDGE);ve.activeTexture.set(Ne.TEXTURE0);let vt=Xe.fbo;if(!vt){const qt=new c.T(ve,{width:at,height:at,data:null},Ne.RGBA);qt.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE),vt=Xe.fbo=ve.createFramebuffer(at,at,!0,!1),vt.colorAttachment.set(qt.texture)}ve.bindFramebuffer.set(vt.framebuffer),ve.viewport.set([0,0,at,at]),he.useProgram("hillshadePrepare").draw(ve,Ne.TRIANGLES,_e,Ae,Me,mn.disabled,ll(Xe.tileID,Ye),null,null,Te.id,he.rasterBoundsBuffer,he.quadTriangleIndexBuffer,he.rasterBoundsSegments),Xe.needsHillshadePrepare=!1}})(E,M,O,D,ee,an.disabled,de),j.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(H){const[he,fe,ye]=E.stencilConfigForOverlapTwoPass(O);Lu(E,M,D,ye,he,ee,de,!1,$),Lu(E,M,D,ye,fe,ee,de,!0,$)}else{const[he,fe]=E.getStencilConfigForOverlapAndUpdateStencilID(O);Lu(E,M,D,fe,he,ee,de,!1,$)}}(n,l,p,_,w):c.ch(p)?function(E,M,D,O,V){if(E.renderPass!=="translucent"||!O.length)return;const{isRenderingToTexture:$}=V,j=E.style.projection.useSubdivision,H=E.getDepthModeForSublayer(0,dn.ReadOnly),ee=E.colorModeForRenderPass();if(j){const[de,he,fe]=E.stencilConfigForOverlapTwoPass(O);zu(E,M,D,fe,de,H,ee,!1,$),zu(E,M,D,fe,he,H,ee,!0,$)}else{const[de,he]=E.getStencilConfigForOverlapAndUpdateStencilID(O);zu(E,M,D,he,de,H,ee,!1,$)}}(n,l,p,_,w):c.ci(p)?function(E,M,D,O,V){if(E.renderPass!=="translucent"||D.paint.get("raster-opacity")===0||!O.length)return;const{isRenderingToTexture:$}=V,j=M.getSource(),H=E.style.projection.useSubdivision;if(j instanceof na)pi(E,M,D,O,null,!1,!1,j.tileCoords,j.flippedWindingOrder,$);else if(H){const[ee,de,he]=E.stencilConfigForOverlapTwoPass(O);pi(E,M,D,he,ee,!1,!0,xh,!1,$),pi(E,M,D,he,de,!0,!0,xh,!1,$)}else{const[ee,de]=E.getStencilConfigForOverlapAndUpdateStencilID(O);pi(E,M,D,de,ee,!1,!0,xh,!1,$)}}(n,l,p,_,w):c.cj(p)?function(E,M,D,O,V){const $=D.paint.get("background-color"),j=D.paint.get("background-opacity");if(j===0)return;const{isRenderingToTexture:H}=V,ee=E.context,de=ee.gl,he=E.style.projection,fe=E.transform,ye=fe.tileSize,Te=D.paint.get("background-pattern");if(E.isPatternMissing(Te))return;const _e=!Te&&$.a===1&&j===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==_e)return;const Ae=an.disabled,Me=E.getDepthModeForSublayer(0,_e==="opaque"?dn.ReadWrite:dn.ReadOnly),ve=E.colorModeForRenderPass(),Ne=E.useProgram(Te?"backgroundPattern":"background"),tt=O||it(fe,{tileSize:ye,terrain:E.style.map.terrain});Te&&(ee.activeTexture.set(de.TEXTURE0),E.imageManager.bind(E.context));const Xe=D.getCrossfadeParameters();for(const Ye of tt){const at=fe.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!H,applyTerrainMatrix:!0}),Dt=Te?Ag(j,E,Te,{tileID:Ye,tileSize:ye},Xe):dd(j,$),kt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ye),vt=he.getMeshFromTileID(ee,Ye.canonical,!1,!0,"raster");Ne.draw(ee,de.TRIANGLES,Me,Ae,ve,mn.backCCW,Dt,kt,at,D.id,vt.vertexBuffer,vt.indexBuffer,vt.segments)}}(n,0,p,_,w):c.ck(p)&&function(E,M,D,O){const{isRenderingGlobe:V}=O,$=E.context,j=D.implementation,H=E.style.projection,ee=E.transform,de=ee.getProjectionDataForCustomLayer(V),he={farZ:ee.farZ,nearZ:ee.nearZ,fov:ee.fov*Math.PI/180,modelViewProjectionMatrix:ee.modelViewProjectionMatrix,projectionMatrix:ee.projectionMatrix,shaderData:{variantName:H.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${H.shaderPreludeCode.vertexSource}`,define:H.shaderDefine},defaultProjectionData:de},fe=j.renderingMode?j.renderingMode:"2d";if(E.renderPass==="offscreen"){const ye=j.prerender;ye&&(E.setCustomLayerDefaults(),$.setColorMode(E.colorModeForRenderPass()),ye.call(j,$.gl,he),$.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),$.setColorMode(E.colorModeForRenderPass()),$.setStencilMode(an.disabled);const ye=fe==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,dn.ReadOnly);$.setDepthMode(ye),j.render($.gl,he),$.setDirty(),E.setBaseState(),$.bindFramebuffer.set(null)}}(n,0,p,w))}saveTileTexture(n){const l=this._tileTextures[n.size[0]];l?l.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const l=this._tileTextures[n];return l&&l.length>0?l.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const l=this.imageManager.getPattern(n.from.toString()),p=this.imageManager.getPattern(n.to.toString());return!l||!p}useProgram(n,l,p=!1,_=[]){this.cache=this.cache||{};const w=!!this.style.map.terrain,E=this.style.projection,M=p?wa.projectionMercator:E.shaderPreludeCode,D=p?al:E.shaderDefine,O=n+(l?l.cacheKey:"")+`/${p?dh:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(w?"/terrain":"")+(_?`/${_.join("/")}`:"");return this.cache[O]||(this.cache[O]=new Su(this.context,wa[n],l,Ja[n],this._showOverdrawInspector,w,M,D,_)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:l}=this.context.gl;return this.width!==n||this.height!==l}}function jo(b,n){let l,p=!1,_=null,w=null;const E=()=>{_=null,p&&(b.apply(w,l),_=setTimeout(E,n),p=!1)};return(...M)=>(p=!0,w=this,l=M,_||E(),_)}class vs{constructor(n){this._getCurrentHash=()=>{const l=window.location.hash.replace("#","");if(this._hashName){let p;return l.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(p=_)}),(p&&p[1]||"").split("/")}return l.split("/")},this._onHashChange=()=>{const l=this._getCurrentHash();if(!this._isValidHash(l))return!1;const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0},this._updateHashUnthrottled=()=>{const l=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,l)},this._removeHash=()=>{const l=this._getCurrentHash();if(l.length===0)return;const p=l.join("/");let _=p;_.split("&").length>0&&(_=_.split("&")[0]),this._hashName&&(_=`${this._hashName}=${p}`);let w=window.location.hash.replace(_,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let E=window.location.href.replace(/(#.+)?$/,w);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=jo(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const l=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,_),E=Math.round(l.lng*w)/w,M=Math.round(l.lat*w)/w,D=this._map.getBearing(),O=this._map.getPitch();let V="";if(V+=n?`/${E}/${M}/${p}`:`${p}/${M}/${E}`,(D||O)&&(V+="/"+Math.round(10*D)/10),O&&(V+=`/${Math.round(O)}`),this._hashName){const $=this._hashName;let j=!1;const H=window.location.hash.slice(1).split("&").map(ee=>{const de=ee.split("=")[0];return de===$?(j=!0,`${de}=${V}`):ee}).filter(ee=>ee);return j||H.push(`${$}=${V}`),`#${H.join("&")}`}return`#${V}`}_isValidHash(n){if(n.length<3||n.some(isNaN))return!1;try{new c.S(+n[2],+n[1])}catch{return!1}const l=+n[0],p=+(n[3]||0),_=+(n[4]||0);return l>=this._map.getMinZoom()&&l<=this._map.getMaxZoom()&&p>=-180&&p<=180&&_>=this._map.getMinPitch()&&_<=this._map.getMaxPitch()}}const bs={linearity:.3,easing:c.cl(0,0,.3,1)},ts=c.e({deceleration:2500,maxSpeed:1400},bs),Th=c.e({deceleration:20,maxSpeed:1400},bs),Ou=c.e({deceleration:1e3,maxSpeed:360},bs),Nu=c.e({deceleration:1e3,maxSpeed:90},bs),Sh=c.e({deceleration:1e3,maxSpeed:360},bs);class Kl{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:G.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,l=G.now();for(;n.length>0&&l-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)l.zoom+=w.zoomDelta||0,l.bearing+=w.bearingDelta||0,l.pitch+=w.pitchDelta||0,l.roll+=w.rollDelta||0,w.panDelta&&l.pan._add(w.panDelta),w.around&&(l.around=w.around),w.pinchAround&&(l.pinchAround=w.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(l.pan.mag()){const w=dl(l.pan.mag(),p,c.e({},ts,n||{})),E=l.pan.mult(w.amount/l.pan.mag()),M=this._map.cameraHelper.handlePanInertia(E,this._map.transform);_.center=M.easingCenter,_.offset=M.easingOffset,vi(_,w)}if(l.zoom){const w=dl(l.zoom,p,Th);_.zoom=this._map.transform.zoom+w.amount,vi(_,w)}if(l.bearing){const w=dl(l.bearing,p,Ou);_.bearing=this._map.transform.bearing+c.ag(w.amount,-179,179),vi(_,w)}if(l.pitch){const w=dl(l.pitch,p,Nu);_.pitch=this._map.transform.pitch+w.amount,vi(_,w)}if(l.roll){const w=dl(l.roll,p,Sh);_.roll=this._map.transform.roll+c.ag(w.amount,-179,179),vi(_,w)}if(_.zoom||_.bearing){const w=l.pinchAround===void 0?l.around:l.pinchAround;_.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),c.e(_,{noMoveStart:!0})}}function vi(b,n){(!b.duration||b.duration<n.duration)&&(b.duration=n.duration,b.easing=n.easing)}function dl(b,n,l){const{maxSpeed:p,linearity:_,deceleration:w}=l,E=c.ag(b*_/(n/1e3),-p,p),M=Math.abs(E)/(w*_);return{easing:l.easing,duration:1e3*M,amount:E*(M/2)}}class ja extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,p,_={}){p=p instanceof MouseEvent?p:new MouseEvent(n,p);const w=W.mousePos(l.getCanvas(),p),E=l.unproject(w);super(n,c.e({point:w,lngLat:E,originalEvent:p},_)),this._defaultPrevented=!1,this.target=l}}class vo extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,p){const _=n==="touchend"?p.changedTouches:p.touches,w=W.touchPos(l.getCanvasContainer(),_),E=w.map(D=>l.unproject(D)),M=w.reduce((D,O,V,$)=>D.add(O.div($.length)),new c.P(0,0));super(n,{points:w,point:M,lngLats:E,lngLat:l.unproject(M),originalEvent:p}),this._defaultPrevented=!1}}class Nf extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,p){super(n,{originalEvent:p}),this._defaultPrevented=!1}}class Jp{constructor(n,l){this._map=n,this._clickTolerance=l.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new Nf(n.type,this._map,n))}mousedown(n,l){return this._mousedownPos=l,this._firePreventable(new ja(n.type,this._map,n))}mouseup(n){this._map.fire(new ja(n.type,this._map,n))}click(n,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||this._map.fire(new ja(n.type,this._map,n))}dblclick(n){return this._firePreventable(new ja(n.type,this._map,n))}mouseover(n){this._map.fire(new ja(n.type,this._map,n))}mouseout(n){this._map.fire(new ja(n.type,this._map,n))}touchstart(n){return this._firePreventable(new vo(n.type,this._map,n))}touchmove(n){this._map.fire(new vo(n.type,this._map,n))}touchend(n){this._map.fire(new vo(n.type,this._map,n))}touchcancel(n){this._map.fire(new vo(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bi{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new ja(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ja("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new ja(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wl{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.screenPointToLocation(c.P.convert(n),this._map.terrain)}}class Bu{constructor(n,l){this._map=n,this._tr=new Wl(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,l){this.isEnabled()&&n.shiftKey&&n.button===0&&(W.disableDrag(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(n,l){if(!this._active)return;const p=l;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=p,this._box||(this._box=W.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const w=Math.min(_.x,p.x),E=Math.max(_.x,p.x),M=Math.min(_.y,p.y),D=Math.max(_.y,p.y);W.setTransform(this._box,`translate(${w}px,${M}px)`),this._box.style.width=E-w+"px",this._box.style.height=D-M+"px"}mouseupWindow(n,l){if(!this._active||n.button!==0)return;const p=this._startPos,_=l;if(this.reset(),W.suppressClick(),p.x!==_.x||p.y!==_.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:n})),{cameraAnimation:w=>w.fitScreenCoordinates(p,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(W.remove(this._box),this._box=null),W.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,l){return this._map.fire(new c.l(n,{originalEvent:l}))}}function Xl(b,n){if(b.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${n.length}`);const l={};for(let p=0;p<b.length;p++)l[b[p].identifier]=n[p];return l}class vd{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const w=new c.P(0,0);for(const E of _)w._add(E);return w.div(_.length)}(l),this.touches=Xl(p,l)))}touchmove(n,l,p){if(this.aborted||!this.centroid)return;const _=Xl(p,l);for(const w in this.touches){const E=_[w];(!E||E.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(n,l,p){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class fl{constructor(n){this.singleTap=new vd(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,l,p){this.singleTap.touchstart(n,l,p)}touchmove(n,l,p){this.singleTap.touchmove(n,l,p)}touchend(n,l,p){const _=this.singleTap.touchend(n,l,p);if(_){const w=n.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(_)<30;if(w&&E||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class pl{constructor(n){this._tr=new Wl(n),this._zoomIn=new fl({numTouches:1,numTaps:2}),this._zoomOut=new fl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,l,p){this._zoomIn.touchstart(n,l,p),this._zoomOut.touchstart(n,l,p)}touchmove(n,l,p){this._zoomIn.touchmove(n,l,p),this._zoomOut.touchmove(n,l,p)}touchend(n,l,p){const _=this._zoomIn.touchend(n,l,p),w=this._zoomOut.touchend(n,l,p),E=this._tr;return _?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(_)},{originalEvent:n})}):w?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(w)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rc{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const l=this._moveFunction(...n);if(l.bearingDelta||l.pitchDelta||l.rollDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(n,l){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=Array.isArray(l)?l[0]:l,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,l){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const _=Array.isArray(l)?l[0]:l;return!this._moved&&_.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(p,_))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&W.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const xs=0,bo=2,Bf={[xs]:1,[bo]:2};class bi{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const l=W.mouseButton(n);this._eventButton=l}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(l,p){const _=Bf[p];return l.buttons===void 0||(l.buttons&_)!==_}(n,this._eventButton)}isValidEndEvent(n){return W.mouseButton(n)===this._eventButton}}class Yl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}class bd{constructor(n=new bi({checkCorrectEvent:()=>!0}),l=new Yl){this.mouseMoveStateManager=n,this.oneFingerTouchMoveStateManager=l}_executeRelevantHandler(n,l,p){return n instanceof MouseEvent?l(n):typeof TouchEvent<"u"&&n instanceof TouchEvent?p(n):void 0}startMove(n){this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.startMove(l),l=>this.oneFingerTouchMoveStateManager.startMove(l))}endMove(n){this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.endMove(l),l=>this.oneFingerTouchMoveStateManager.endMove(l))}isValidStartEvent(n){return this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.isValidStartEvent(l),l=>this.oneFingerTouchMoveStateManager.isValidStartEvent(l))}isValidMoveEvent(n){return this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.isValidMoveEvent(l),l=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(l))}isValidEndEvent(n){return this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.isValidEndEvent(l),l=>this.oneFingerTouchMoveStateManager.isValidEndEvent(l))}}const Eh=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=n=>{n.preventDefault()}};class Ah{constructor(n,l){this._clickTolerance=n.clickTolerance||1,this._map=l,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,l,p){return this._calculateTransform(n,l,p)}touchmove(n,l,p){if(this._active){if(!this._shouldBePrevented(p.length))return n.preventDefault(),this._calculateTransform(n,l,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,l,p){this._calculateTransform(n,l,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,l,p){p.length>0&&(this._active=!0);const _=Xl(p,l),w=new c.P(0,0),E=new c.P(0,0);let M=0;for(const O in _){const V=_[O],$=this._touches[O];$&&(w._add(V),E._add(V.sub($)),M++,_[O]=V)}if(this._touches=_,this._shouldBePrevented(M)||!E.mag())return;const D=E.div(M);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(M),panDelta:D}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xd{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(n,l,p){if(!this._firstTwoTouches)return;n.preventDefault();const[_,w]=this._firstTwoTouches,E=Ql(p,l,_),M=Ql(p,l,w);if(!E||!M)return;const D=this._aroundCenter?null:E.add(M).div(2);return this._move([E,M],D,n)}touchend(n,l,p){if(!this._firstTwoTouches)return;const[_,w]=this._firstTwoTouches,E=Ql(p,l,_),M=Ql(p,l,w);E&&M||(this._active&&W.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ql(b,n,l){for(let p=0;p<b.length;p++)if(b[p].identifier===l)return n[p]}function Jl(b,n){return Math.log(b/n)/Math.LN2}class xo extends xd{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,l){const p=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Jl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Jl(this._distance,p),pinchAround:l}}}function Ft(b,n){return 180*b.angleWith(n)/Math.PI}class wd extends xd{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,l,p){const _=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ft(this._vector,_),pinchAround:l}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const l=25/(Math.PI*this._minDiameter)*360,p=Ft(n,this._startVector);return Math.abs(p)<l}}function ml(b){return Math.abs(b.y)>Math.abs(b.x)}class Td extends xd{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,l,p){super.touchstart(n,l,p),this._currentTouchCount=p.length}_start(n){this._lastPoints=n,ml(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,l,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=n[0].sub(this._lastPoints[0]),w=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,w,p.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(_.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(n,l,p){if(this._valid!==void 0)return this._valid;const _=n.mag()>=2,w=l.mag()>=2;if(!_&&!w)return;if(!_||!w)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=n.y>0==l.y>0;return ml(n)&&ml(l)&&E}}const kc={panStep:100,bearingStep:15,pitchStep:10};class ws{constructor(n){this._tr=new Wl(n);const l=kc;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let l=0,p=0,_=0,w=0,E=0;switch(n.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:n.shiftKey?p=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?p=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?_=1:(n.preventDefault(),E=-1);break;case 40:n.shiftKey?_=-1:(n.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:M=>{const D=this._tr;M.easeTo({duration:300,easeId:"keyboardHandler",easing:Ih,zoom:l?Math.round(D.zoom)+l*(n.shiftKey?2:1):D.zoom,bearing:D.bearing+p*this._bearingStep,pitch:D.pitch+_*this._pitchStep,offset:[-w*this._panStep,-E*this._panStep],center:D.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ih(b){return b*(2-b)}const Dn=4.000244140625,$o=1/450;class gl{constructor(n,l){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=n,this._tr=new Wl(n),this._triggerRenderFrame=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=$o}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let l=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const p=G.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%Dn==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(_*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),n.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=n,this._delta-=l,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=W.mousePos(this._map.getCanvas(),n),p=this._tr;this._aroundPoint=this._aroundCenter?p.transform.locationToScreenPoint(c.S.convert(p.center)):l,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const M=n.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=M),typeof this._targetZoom=="number"&&(this._targetZoom+=M)}if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>Dn?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&D!==0&&(D=1/D);const O=typeof this._targetZoom!="number"?n.scale:c.ae(this._targetZoom);this._targetZoom=n.getConstrained(n.getCameraLngLat(),c.aj(O*D)).zoom,this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const l=typeof this._targetZoom!="number"?n.zoom:this._targetZoom,p=this._startZoom,_=this._easing;let w,E=!1;if(this._type==="wheel"&&p&&_){const M=G.now()-this._lastWheelEventTime,D=Math.min((M+5)/200,1),O=_(D);w=c.C.number(p,l,O),D<1?this._frameId||(this._frameId=!0):E=!0}else w=l,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!E,zoomDelta:w-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let l=c.cn;if(this._prevEase){const p=this._prevEase,_=(G.now()-p.start)/p.duration,w=p.easing(_+.01)-p.easing(_),E=.27/Math.sqrt(w*w+1e-4)*.01,M=Math.sqrt(.0729-E*E);l=c.cl(E,M,.25,1)}return this._prevEase={start:G.now(),duration:n,easing:l},l}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class eu{constructor(n,l){this._clickZoom=n,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Vf{constructor(n){this._tr=new Wl(n),this.reset()}reset(){this._active=!1}dblclick(n,l){return n.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(l)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ff{constructor(){this._tap=new fl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,l,p){if(!this._swipePoint)if(this._tapTime){const _=l[0],w=n.timeStamp-this._tapTime<500,E=this._tapPoint.dist(_)<30;w&&E?p.length>0&&(this._swipePoint=_,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(n,l,p)}touchmove(n,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=l[0],w=_.y-this._swipePoint.y;return this._swipePoint=_,n.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(n,l,p)}touchend(n,l,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const _=this._tap.touchend(n,l,p);_&&(this._tapTime=n.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vu{constructor(n,l,p){this._el=n,this._mousePan=l,this._touchPan=p}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class tu{constructor(n,l,p,_){this._pitchWithRotate=n.pitchWithRotate,this._rollEnabled=n.rollEnabled,this._mouseRotate=l,this._mousePitch=p,this._mouseRoll=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Sd{constructor(n,l,p,_){this._el=n,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Uf{constructor(n,l){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=l,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=W.create("div","maplibregl-cooperative-gesture-screen",n);let l=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(l=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=l,this._container.appendChild(_);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=p,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(W.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,l){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:n,originalEvent:l})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const qo=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class Ed extends c.l{}function Ad(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class Go{constructor(n,l){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,w)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=_.type==="renderFrame"?void 0:_,M={needsRenderFrame:!1},D={},O={};for(const{handlerName:j,handler:H,allowed:ee}of this._handlers){if(!H.isEnabled())continue;let de;if(this._blockedByActive(O,ee,j))H.reset();else if(H[w||_.type]){if(c.co(_,w||_.type)){const he=W.mousePos(this._map.getCanvas(),_);de=H[w||_.type](_,he)}else if(c.cp(_,w||_.type)){const he=this._getMapTouches(_.touches),fe=W.touchPos(this._map.getCanvas(),he);de=H[w||_.type](_,fe,he)}else c.cq(w||_.type)||(de=H[w||_.type](_));this.mergeHandlerResult(M,D,de,j,E),de&&de.needsRenderFrame&&this._triggerRenderFrame()}(de||H.isActive())&&(O[j]=H)}const V={};for(const j in this._previousActiveHandlers)O[j]||(V[j]=E);this._previousActiveHandlers=O,(Object.keys(V).length||Ad(M))&&(this._changes.push([M,D,V]),this._triggerRenderFrame()),(Object.keys(O).length||Ad(M))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=M;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Kl(n),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(l);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,w,E]of this._listeners)W.addEventListener(_,w,_===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[n,l,p]of this._listeners)W.removeEventListener(n,l,n===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(n){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new Jp(l,n));const _=l.boxZoom=new Bu(l,n);this._add("boxZoom",_),n.interactive&&n.boxZoom&&_.enable();const w=l.cooperativeGestures=new Uf(l,n.cooperativeGestures);this._add("cooperativeGestures",w),n.cooperativeGestures&&w.enable();const E=new pl(l),M=new Vf(l);l.doubleClickZoom=new eu(M,E),this._add("tapZoom",E),this._add("clickZoom",M),n.interactive&&n.doubleClickZoom&&l.doubleClickZoom.enable();const D=new Ff;this._add("tapDragZoom",D);const O=l.touchPitch=new Td(l);this._add("touchPitch",O),n.interactive&&n.touchPitch&&l.touchPitch.enable(n.touchPitch);const V=()=>l.project(l.getCenter()),$=function({enable:_e,clickTolerance:Ae,aroundCenter:Me=!0,minPixelCenterThreshold:ve=100,rotateDegreesPerPixelMoved:Ne=.8},tt){const Xe=new bi({checkCorrectEvent:Ye=>W.mouseButton(Ye)===0&&Ye.ctrlKey||W.mouseButton(Ye)===2&&!Ye.ctrlKey});return new Rc({clickTolerance:Ae,move:(Ye,at)=>{const Dt=tt();if(Me&&Math.abs(Dt.y-Ye.y)>ve)return{bearingDelta:c.cm(new c.P(Ye.x,at.y),at,Dt)};let kt=(at.x-Ye.x)*Ne;return Me&&at.y<Dt.y&&(kt=-kt),{bearingDelta:kt}},moveStateManager:Xe,enable:_e,assignEvents:Eh})}(n,V),j=function({enable:_e,clickTolerance:Ae,pitchDegreesPerPixelMoved:Me=-.5}){const ve=new bi({checkCorrectEvent:Ne=>W.mouseButton(Ne)===0&&Ne.ctrlKey||W.mouseButton(Ne)===2});return new Rc({clickTolerance:Ae,move:(Ne,tt)=>({pitchDelta:(tt.y-Ne.y)*Me}),moveStateManager:ve,enable:_e,assignEvents:Eh})}(n),H=function({enable:_e,clickTolerance:Ae,rollDegreesPerPixelMoved:Me=.3},ve){const Ne=new bi({checkCorrectEvent:tt=>W.mouseButton(tt)===2&&tt.ctrlKey});return new Rc({clickTolerance:Ae,move:(tt,Xe)=>{const Ye=ve();let at=(Xe.x-tt.x)*Me;return Xe.y<Ye.y&&(at=-at),{rollDelta:at}},moveStateManager:Ne,enable:_e,assignEvents:Eh})}(n,V);l.dragRotate=new tu(n,$,j,H),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",j,["mouseRotate","mouseRoll"]),this._add("mouseRoll",H,["mousePitch"]),n.interactive&&n.dragRotate&&l.dragRotate.enable();const ee=function({enable:_e,clickTolerance:Ae}){const Me=new bi({checkCorrectEvent:ve=>W.mouseButton(ve)===0&&!ve.ctrlKey});return new Rc({clickTolerance:Ae,move:(ve,Ne)=>({around:Ne,panDelta:Ne.sub(ve)}),activateOnStart:!0,moveStateManager:Me,enable:_e,assignEvents:Eh})}(n),de=new Ah(n,l);l.dragPan=new Vu(p,ee,de),this._add("mousePan",ee),this._add("touchPan",de,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&l.dragPan.enable(n.dragPan);const he=new wd,fe=new xo;l.touchZoomRotate=new Sd(p,fe,he,D),this._add("touchRotate",he,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&l.touchZoomRotate.enable(n.touchZoomRotate);const ye=l.scrollZoom=new gl(l,()=>this._triggerRenderFrame());this._add("scrollZoom",ye,["mousePan"]),n.interactive&&n.scrollZoom&&l.scrollZoom.enable(n.scrollZoom);const Te=l.keyboard=new ws(l);this._add("keyboard",Te),n.interactive&&n.keyboard&&l.keyboard.enable(),this._add("blockableMapEvent",new Bi(l))}_add(n,l,p){this._handlers.push({handlerName:n,handler:l,allowed:p}),this._handlersById[n]=l}stop(n){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qo(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,l,p){for(const _ in n)if(_!==p&&(!l||l.indexOf(_)<0))return!0;return!1}_getMapTouches(n){const l=[];for(const p of n)this._el.contains(p.target)&&l.push(p);return l}mergeHandlerResult(n,l,p,_,w){if(!p)return;c.e(n,p);const E={handlerName:_,originalEvent:p.originalEvent||w};p.zoomDelta!==void 0&&(l.zoom=E),p.panDelta!==void 0&&(l.drag=E),p.rollDelta!==void 0&&(l.roll=E),p.pitchDelta!==void 0&&(l.pitch=E),p.bearingDelta!==void 0&&(l.rotate=E)}_applyChanges(){const n={},l={},p={};for(const[_,w,E]of this._changes)_.panDelta&&(n.panDelta=(n.panDelta||new c.P(0,0))._add(_.panDelta)),_.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+_.pitchDelta),_.rollDelta&&(n.rollDelta=(n.rollDelta||0)+_.rollDelta),_.around!==void 0&&(n.around=_.around),_.pinchAround!==void 0&&(n.pinchAround=_.pinchAround),_.noInertia&&(n.noInertia=_.noInertia),c.e(l,w),c.e(p,E);this._updateMapTransform(n,l,p),this._changes=[]}_updateMapTransform(n,l,p){const _=this._map,w=_._getTransformForUpdate(),E=_.terrain;if(!(Ad(n)||E&&this._terrainMovement))return this._fireEvents(l,p,!0);_._stop(!0);let{panDelta:M,zoomDelta:D,bearingDelta:O,pitchDelta:V,rollDelta:$,around:j,pinchAround:H}=n;H!==void 0&&(j=H),j=j||_.transform.centerPoint,E&&!w.isPointOnMapSurface(j)&&(j=w.centerPoint);const ee={panDelta:M,zoomDelta:D,rollDelta:$,pitchDelta:V,bearingDelta:O,around:j};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(j)&&(j=w.centerPoint);const de=j.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(M?j.sub(M):j);E?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ee,w),this._terrainMovement||!l.drag&&!l.zoom?l.drag&&this._terrainMovement?w.setCenter(w.screenPointToLocation(w.centerPoint.sub(M))):this._map.cameraHelper.handleMapControlsPan(ee,w,de):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(ee,w,de))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ee,w),this._map.cameraHelper.handleMapControlsPan(ee,w,de)),_._applyUpdatedTransform(w),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(l,p,!0)}_fireEvents(n,l,p){const _=qo(this._eventsInProgress),w=qo(n),E={};for(const $ in n){const{originalEvent:j}=n[$];this._eventsInProgress[$]||(E[`${$}start`]=j),this._eventsInProgress[$]=n[$]}!_&&w&&this._fireEvent("movestart",w.originalEvent);for(const $ in E)this._fireEvent($,E[$]);w&&this._fireEvent("move",w.originalEvent);for(const $ in n){const{originalEvent:j}=n[$];this._fireEvent($,j)}const M={};let D;for(const $ in this._eventsInProgress){const{handlerName:j,originalEvent:H}=this._eventsInProgress[$];this._handlersById[j].isActive()||(delete this._eventsInProgress[$],D=l[j]||H,M[`${$}end`]=D)}for(const $ in M)this._fireEvent($,M[$]);const O=qo(this._eventsInProgress),V=(_||w)&&!O;if(V&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const $=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&$.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform($)}if(p&&V){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;!$||!$.essential&&G.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:D})),j(this._map.getBearing())&&this._map.resetNorth()):(j($.bearing||this._map.getBearing())&&($.bearing=0),$.freezeElevation=!0,this._map.easeTo($,{originalEvent:D})),this._updatingCamera=!1}}_fireEvent(n,l){this._map.fire(new c.l(n,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new Ed("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Lr extends c.E{constructor(n,l,p){super(),this._renderFrameCallback=()=>{const _=Math.min((G.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(_)),_<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=p.bearingSnap,this.cameraHelper=l,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(n,l){n.apply(this.transform),this.transform=n,this.cameraHelper=l}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(n,l){return this.jumpTo({center:n},l)}getCenterElevation(){return this.transform.elevation}setCenterElevation(n,l){return this.jumpTo({elevation:n},l),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(n){this._centerClampedToGround=n}panBy(n,l,p){return n=c.P.convert(n).mult(-1),this.panTo(this.transform.center,c.e({offset:n},l),p)}panTo(n,l,p){return this.easeTo(c.e({center:n},l),p)}getZoom(){return this.transform.zoom}setZoom(n,l){return this.jumpTo({zoom:n},l),this}zoomTo(n,l,p){return this.easeTo(c.e({zoom:n},l),p)}zoomIn(n,l){return this.zoomTo(this.getZoom()+1,n,l),this}zoomOut(n,l){return this.zoomTo(this.getZoom()-1,n,l),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(n,l){return n!=this.transform.fov&&(this.transform.setFov(n),this.fire(new c.l("movestart",l)).fire(new c.l("move",l)).fire(new c.l("moveend",l))),this}getBearing(){return this.transform.bearing}setBearing(n,l){return this.jumpTo({bearing:n},l),this}getPadding(){return this.transform.padding}setPadding(n,l){return this.jumpTo({padding:n},l),this}rotateTo(n,l,p){return this.easeTo(c.e({bearing:n},l),p)}resetNorth(n,l){return this.rotateTo(0,c.e({duration:1e3},n),l),this}resetNorthPitch(n,l){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},n),l),this}snapToNorth(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this}getPitch(){return this.transform.pitch}setPitch(n,l){return this.jumpTo({pitch:n},l),this}getRoll(){return this.transform.roll}setRoll(n,l){return this.jumpTo({roll:n},l),this}cameraForBounds(n,l){n=Tr.convert(n).adjustAntiMeridian();const p=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),p,l)}_cameraForBoxAndBearing(n,l,p,_){const w={top:0,bottom:0,right:0,left:0};if(typeof(_=c.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const O=_.padding;_.padding={top:O,bottom:O,right:O,left:O}}const E=c.e(w,_.padding);_.padding=E;const M=this.transform,D=new Tr(n,l);return this.cameraHelper.cameraForBoxAndBearing(_,E,D,p,M)}fitBounds(n,l,p){return this._fitInternal(this.cameraForBounds(n,l),l,p)}fitScreenCoordinates(n,l,p,_,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(n)),this.transform.screenPointToLocation(c.P.convert(l)),p,_),_,w)}_fitInternal(n,l,p){return n?(delete(l=c.e(n,l)).padding,l.linear?this.easeTo(l,p):this.flyTo(l,p)):this}jumpTo(n,l){this.stop();const p=this._getTransformForUpdate();let _=!1,w=!1,E=!1;const M=p.zoom;this.cameraHelper.handleJumpToCenterZoom(p,n);const D=p.zoom!==M;return"elevation"in n&&p.elevation!==+n.elevation&&p.setElevation(+n.elevation),"bearing"in n&&p.bearing!==+n.bearing&&(_=!0,p.setBearing(+n.bearing)),"pitch"in n&&p.pitch!==+n.pitch&&(w=!0,p.setPitch(+n.pitch)),"roll"in n&&p.roll!==+n.roll&&(E=!0,p.setRoll(+n.roll)),n.padding==null||p.isPaddingEqual(n.padding)||p.setPadding(n.padding),this._applyUpdatedTransform(p),this.fire(new c.l("movestart",l)).fire(new c.l("move",l)),D&&this.fire(new c.l("zoomstart",l)).fire(new c.l("zoom",l)).fire(new c.l("zoomend",l)),_&&this.fire(new c.l("rotatestart",l)).fire(new c.l("rotate",l)).fire(new c.l("rotateend",l)),w&&this.fire(new c.l("pitchstart",l)).fire(new c.l("pitch",l)).fire(new c.l("pitchend",l)),E&&this.fire(new c.l("rollstart",l)).fire(new c.l("roll",l)).fire(new c.l("rollend",l)),this.fire(new c.l("moveend",l))}calculateCameraOptionsFromTo(n,l,p,_=0){const w=c.a0.fromLngLat(n,l),E=c.a0.fromLngLat(p,_),M=E.x-w.x,D=E.y-w.y,O=E.z-w.z,V=Math.hypot(M,D,O);if(V===0)throw new Error("Can't calculate camera options with same From and To");const $=Math.hypot(M,D),j=c.aj(this.transform.cameraToCenterDistance/V/this.transform.tileSize),H=180*Math.atan2(M,-D)/Math.PI;let ee=180*Math.acos($/V)/Math.PI;return ee=O<0?90-ee:90+ee,{center:E.toLngLat(),elevation:_,zoom:j,pitch:ee,bearing:H}}calculateCameraOptionsFromCameraLngLatAltRotation(n,l,p,_,w){const E=this.transform.calculateCenterFromCameraLngLatAlt(n,l,p,_);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:p,pitch:_,roll:w}}easeTo(n,l){this._stop(!1,n.easeId),((n=c.e({offset:[0,0],duration:500,easing:c.cn},n)).animate===!1||!n.essential&&G.prefersReducedMotion)&&(n.duration=0);const p=this._getTransformForUpdate(),_=this.getBearing(),w=p.pitch,E=p.roll,M="bearing"in n?this._normalizeBearing(n.bearing,_):_,D="pitch"in n?+n.pitch:w,O="roll"in n?this._normalizeBearing(n.roll,E):E,V="padding"in n?n.padding:p.padding,$=c.P.convert(n.offset);let j,H;n.around&&(j=c.S.convert(n.around),H=p.locationToScreenPoint(j));const ee={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},de=this.cameraHelper.handleEaseTo(p,{bearing:M,pitch:D,roll:O,padding:V,around:j,aroundPoint:H,offsetAsPoint:$,offset:n.offset,zoom:n.zoom,center:n.center});return this._rotating=this._rotating||_!==M,this._pitching=this._pitching||D!==w,this._rolling=this._rolling||O!==E,this._padding=!p.isPaddingEqual(V),this._zooming=this._zooming||de.isZooming,this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,ee),this.terrain&&this._prepareElevation(de.elevationCenter),this._ease(he=>{de.easeFunc(he),this.terrain&&!n.freezeElevation&&this._updateElevation(he),this._applyUpdatedTransform(p),this._fireMoveEvents(l)},he=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l,he)},n),this}_prepareEase(n,l,p={}){this._moving=!0,l||p.moving||this.fire(new c.l("movestart",n)),this._zooming&&!p.zooming&&this.fire(new c.l("zoomstart",n)),this._rotating&&!p.rotating&&this.fire(new c.l("rotatestart",n)),this._pitching&&!p.pitching&&this.fire(new c.l("pitchstart",n)),this._rolling&&!p.rolling&&this.fire(new c.l("rollstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const l=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&l!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(p-(l-(p*n+this._elevationStart))/(1-n)),this._elevationTarget=l}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,n))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){if(!this.terrain&&n.elevation>=0&&n.pitch<=90)return{};const l=n.getCameraLngLat(),p=n.getCameraAltitude(),_=this.terrain?this.terrain.getElevationForLngLatZoom(l,n.zoom):0;if(p<_){const w=this.calculateCameraOptionsFromTo(l,_,n.center,n.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(n){const l=[];if(l.push(_=>this._elevateCameraIfInsideTerrain(_)),this.transformCameraUpdate&&l.push(_=>this.transformCameraUpdate(_)),!l.length)return;const p=n.clone();for(const _ of l){const w=p.clone(),{center:E,zoom:M,roll:D,pitch:O,bearing:V,elevation:$}=_(w);E&&w.setCenter(E),$!==void 0&&w.setElevation($),M!==void 0&&w.setZoom(M),D!==void 0&&w.setRoll(D),O!==void 0&&w.setPitch(O),V!==void 0&&w.setBearing(V),p.apply(w)}this.transform.apply(p)}_fireMoveEvents(n){this.fire(new c.l("move",n)),this._zooming&&this.fire(new c.l("zoom",n)),this._rotating&&this.fire(new c.l("rotate",n)),this._pitching&&this.fire(new c.l("pitch",n)),this._rolling&&this.fire(new c.l("roll",n))}_afterEase(n,l){if(this._easeId&&l&&this._easeId===l)return;delete this._easeId;const p=this._zooming,_=this._rotating,w=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,p&&this.fire(new c.l("zoomend",n)),_&&this.fire(new c.l("rotateend",n)),w&&this.fire(new c.l("pitchend",n)),E&&this.fire(new c.l("rollend",n)),this.fire(new c.l("moveend",n))}flyTo(n,l){if(!n.essential&&G.prefersReducedMotion){const at=c.Q(n,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(at,l)}this.stop(),n=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.cn},n);const p=this._getTransformForUpdate(),_=p.bearing,w=p.pitch,E=p.roll,M=p.padding,D="bearing"in n?this._normalizeBearing(n.bearing,_):_,O="pitch"in n?+n.pitch:w,V="roll"in n?this._normalizeBearing(n.roll,E):E,$="padding"in n?n.padding:p.padding,j=c.P.convert(n.offset);let H=p.centerPoint.add(j);const ee=p.screenPointToLocation(H),de=this.cameraHelper.handleFlyTo(p,{bearing:D,pitch:O,roll:V,padding:$,locationAtOffset:ee,offsetAsPoint:j,center:n.center,minZoom:n.minZoom,zoom:n.zoom});let he=n.curve;const fe=Math.max(p.width,p.height),ye=fe/de.scaleOfZoom,Te=de.pixelPathLength;typeof de.scaleOfMinZoom=="number"&&(he=Math.sqrt(fe/de.scaleOfMinZoom/Te*2));const _e=he*he;function Ae(at){const Dt=(ye*ye-fe*fe+(at?-1:1)*_e*_e*Te*Te)/(2*(at?ye:fe)*_e*Te);return Math.log(Math.sqrt(Dt*Dt+1)-Dt)}function Me(at){return(Math.exp(at)-Math.exp(-at))/2}function ve(at){return(Math.exp(at)+Math.exp(-at))/2}const Ne=Ae(!1);let tt=function(at){return ve(Ne)/ve(Ne+he*at)},Xe=function(at){return fe*((ve(Ne)*(Me(Dt=Ne+he*at)/ve(Dt))-Me(Ne))/_e)/Te;var Dt},Ye=(Ae(!0)-Ne)/he;if(Math.abs(Te)<2e-6||!isFinite(Ye)){if(Math.abs(fe-ye)<1e-6)return this.easeTo(n,l);const at=ye<fe?-1:1;Ye=Math.abs(Math.log(ye/fe))/he,Xe=()=>0,tt=Dt=>Math.exp(at*he*Dt)}return n.duration="duration"in n?+n.duration:1e3*Ye/("screenSpeed"in n?+n.screenSpeed/he:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=_!==D,this._pitching=O!==w,this._rolling=V!==E,this._padding=!p.isPaddingEqual($),this._prepareEase(l,!1),this.terrain&&this._prepareElevation(de.targetCenter),this._ease(at=>{const Dt=at*Ye,kt=1/tt(Dt),vt=Xe(Dt);this._rotating&&p.setBearing(c.C.number(_,D,at)),this._pitching&&p.setPitch(c.C.number(w,O,at)),this._rolling&&p.setRoll(c.C.number(E,V,at)),this._padding&&(p.interpolatePadding(M,$,at),H=p.centerPoint.add(j)),de.easeFunc(at,kt,vt,H),this.terrain&&!n.freezeElevation&&this._updateElevation(at),this._applyUpdatedTransform(p),this._fireMoveEvents(l)},()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,l){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,l)}return n||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(n,l,p){p.animate===!1||p.duration===0?(n(1),l()):(this._easeStart=G.now(),this._easeOptions=p,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,l){n=c.aN(n,-180,180);const p=Math.abs(n-l);return Math.abs(n-360-l)<p&&(n-=360),Math.abs(n+360-l)<p&&(n+=360),n}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(n),this.transform.tileZoom):null}}const $s={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ln{constructor(n=$s){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=l=>{!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=W.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=W.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=W.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){W.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,l){const p=this._map._getUIString(`AttributionControl.${l}`);n.title=p,n.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const l=this._map.style.sourceCaches;for(const _ in l){const w=l[_];if(w.used||w.usedForTerrain){const E=w.getSource();E.attribution&&n.indexOf(E.attribution)<0&&n.push(E.attribution)}}n=n.filter(_=>String(_).trim()),n.sort((_,w)=>_.length-w.length),n=n.filter((_,w)=>{for(let E=w+1;E<n.length;E++)if(n[E].indexOf(_)>=0)return!1;return!0});const p=n.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,n.length?(this._innerContainer.innerHTML=W.sanitize(p),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class mr{constructor(n={}){this._updateCompact=()=>{const l=this._container.children;if(l.length){const p=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=W.create("div","maplibregl-ctrl");const l=W.create("a","maplibregl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://maplibre.org/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){W.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class xi{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const l=++this._id;return this._queue.push({callback:n,id:l,cancelled:!1}),l}remove(n){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const _ of p)if(_.id===n)return void(_.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ch=c.aI([{name:"a_pos3d",type:"Int16",components:3}]);class Dc extends c.E{constructor(n){super(),this._lastTilesetChange=G.now(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=n._source.tileSize*2**this.deltaZoom,n.usedForTerrain=!0,n.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,l){this.sourceCache.update(n,l),this._renderableTilesKeys=[];const p={};for(const _ of it(n,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:l,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))p[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.terrainRttPosMatrix32f=new Float64Array(16),c.bX(_.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[_.key]=new di(_,this.tileSize),this._lastTilesetChange=G.now());for(const _ in this._tiles)p[_]||delete this._tiles[_]}freeRtt(n){for(const l in this._tiles){const p=this._tiles[l];(!n||p.tileID.equals(n)||p.tileID.isChildOf(n)||n.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n,l){return l?this._getTerrainCoordsForTileRanges(n,l):this._getTerrainCoordsForRegularTile(n)}_getTerrainCoordsForRegularTile(n){const l={};for(const p of this._renderableTilesKeys){const _=this._tiles[p].tileID,w=n.clone(),E=c.b9();if(_.canonical.equals(n.canonical))c.bX(E,0,c.$,c.$,0,0,1);else if(_.canonical.isChildOf(n.canonical)){const M=_.canonical.z-n.canonical.z,D=_.canonical.x-(_.canonical.x>>M<<M),O=_.canonical.y-(_.canonical.y>>M<<M),V=c.$>>M;c.bX(E,0,V,V,0,0,1),c.M(E,E,[-D*V,-O*V,0])}else{if(!n.canonical.isChildOf(_.canonical))continue;{const M=n.canonical.z-_.canonical.z,D=n.canonical.x-(n.canonical.x>>M<<M),O=n.canonical.y-(n.canonical.y>>M<<M),V=c.$>>M;c.bX(E,0,c.$,c.$,0,0,1),c.M(E,E,[D*V,O*V,0]),c.N(E,E,[1/2**M,1/2**M,0])}}w.terrainRttPosMatrix32f=new Float32Array(E),l[p]=w}return l}_getTerrainCoordsForTileRanges(n,l){const p={};for(const _ of this._renderableTilesKeys){const w=this._tiles[_].tileID;if(!this._isWithinTileRanges(w,l))continue;const E=n.clone(),M=c.b9();if(w.canonical.z===n.canonical.z){const D=n.canonical.x-w.canonical.x,O=n.canonical.y-w.canonical.y;c.bX(M,0,c.$,c.$,0,0,1),c.M(M,M,[D*c.$,O*c.$,0])}else if(w.canonical.z>n.canonical.z){const D=w.canonical.z-n.canonical.z,O=w.canonical.x-(w.canonical.x>>D<<D),V=w.canonical.y-(w.canonical.y>>D<<D),$=n.canonical.x-(w.canonical.x>>D),j=n.canonical.y-(w.canonical.y>>D),H=c.$>>D;c.bX(M,0,H,H,0,0,1),c.M(M,M,[-O*H+$*c.$,-V*H+j*c.$,0])}else{const D=n.canonical.z-w.canonical.z,O=n.canonical.x-(n.canonical.x>>D<<D),V=n.canonical.y-(n.canonical.y>>D<<D),$=(n.canonical.x>>D)-w.canonical.x,j=(n.canonical.y>>D)-w.canonical.y,H=c.$<<D;c.bX(M,0,H,H,0,0,1),c.M(M,M,[O*c.$+$*H,V*c.$+j*H,0])}E.terrainRttPosMatrix32f=new Float32Array(M),p[_]=E}return p}getSourceTile(n,l){const p=this.sourceCache._source;let _=n.overscaledZ-this.deltaZoom;if(_>p.maxzoom&&(_=p.maxzoom),_<p.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(_).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!w||!w.dem)&&l)for(;_>=p.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(n.scaledTo(_--).key);return w}anyTilesAfterTime(n=Date.now()){return this._lastTilesetChange>=n}_isWithinTileRanges(n,l){return l[n.canonical.z]&&n.canonical.x>=l[n.canonical.z].minTileX&&n.canonical.x<=l[n.canonical.z].maxTileX&&n.canonical.y>=l[n.canonical.z].minTileY&&n.canonical.y<=l[n.canonical.z].maxTileY}}class Ia{constructor(n,l,p){this._meshCache={},this.painter=n,this.sourceCache=new Dc(l),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,l,p,_=c.$){var w;if(!(l>=0&&l<_&&p>=0&&p<_))return 0;const E=this.getTerrainData(n),M=(w=E.tile)===null||w===void 0?void 0:w.dem;if(!M)return 0;const D=c.cr([],[l/_*c.$,p/_*c.$],E.u_terrain_matrix),O=[D[0]*M.dim,D[1]*M.dim],V=Math.floor(O[0]),$=Math.floor(O[1]),j=O[0]-V,H=O[1]-$;return M.get(V,$)*(1-j)*(1-H)+M.get(V+1,$)*j*(1-H)+M.get(V,$+1)*(1-j)*H+M.get(V+1,$+1)*j*H}getElevationForLngLatZoom(n,l){if(!c.cs(l,n.wrap()))return 0;const{tileID:p,mercatorX:_,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(n,l);return this.getElevation(p,_%c.$,w%c.$,c.$)}getElevation(n,l,p,_=c.$){return this.getDEMElevation(n,l,p,_)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const _=this.painter.context,w=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(_,w,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(_,new c.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.af([])}const l=this.sourceCache.getSourceTile(n,!0);if(l&&l.dem&&(!l.demTexture||l.needsTerrainPrepare)){const _=this.painter.context;l.demTexture=this.painter.getTileTexture(l.dem.stride),l.demTexture?l.demTexture.update(l.dem.getPixels(),{premultiply:!1}):l.demTexture=new c.T(_,l.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),l.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),l.needsTerrainPrepare=!1}const p=l&&l+l.tileID.key+n.key;if(p&&!this._demMatrixCache[p]){const _=this.sourceCache.sourceCache._source.maxzoom;let w=n.canonical.z-l.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=_?w=n.canonical.z-_:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=n.canonical.x-(n.canonical.x>>w<<w),M=n.canonical.y-(n.canonical.y>>w<<w),D=c.ct(new Float64Array(16),[1/(c.$<<w),1/(c.$<<w),0]);c.M(D,D,[E*c.$,M*c.$,0]),this._demMatrixCache[n.key]={matrix:D,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:l&&l.dem&&l.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:l&&l.dem&&l.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(l&&l.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:l}}getFramebuffer(n){const l=this.painter,p=l.width/devicePixelRatio,_=l.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(l.context,{width:p,height:_,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(l.context,{width:p,height:_,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=l.context.createFramebuffer(p,_,!0,!1),this._fbo.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,p,_))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const l=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,E=0;w<this._coordsTextureSize;w++)for(let M=0;M<this._coordsTextureSize;M++,E+=4)l[E+0]=255&M,l[E+1]=255&w,l[E+2]=M>>8<<4|w>>8,l[E+3]=0;const p=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(l.buffer)),_=new c.T(n,p,n.gl.RGBA,{premultiply:!1});return _.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const l=new Uint8Array(4),p=this.painter.context,_=p.gl,w=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),M=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(w,M-E-1,1,1,_.RGBA,_.UNSIGNED_BYTE,l),p.bindFramebuffer.set(null);const D=l[0]+(l[2]>>4<<8),O=l[1]+((15&l[2])<<8),V=this.coordsIndex[255-l[3]],$=V&&this.sourceCache.getTileByID(V);if(!$)return null;const j=this._coordsTextureSize,H=(1<<$.tileID.canonical.z)*j;return new c.a0(($.tileID.canonical.x*j+D)/H+$.tileID.wrap,($.tileID.canonical.y*j+O)/H,this.getElevation($.tileID,D,O,j))}depthAtPoint(n){const l=new Uint8Array(4),p=this.painter.context,_=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,l),p.bindFramebuffer.set(null),(l[0]/16777216+l[1]/65536+l[2]/256+l[3])/256}getTerrainMesh(n){var l;const p=((l=this.painter.style.projection)===null||l===void 0?void 0:l.transitionState)>0,_=p&&n.canonical.y===0,w=p&&n.canonical.y===(1<<n.canonical.z)-1,E=`m_${_?"n":""}_${w?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const M=this.painter.context,D=new c.cu,O=new c.aM,V=this.meshSize,$=c.$/V,j=V*V;for(let ve=0;ve<=V;ve++)for(let Ne=0;Ne<=V;Ne++)D.emplaceBack(Ne*$,ve*$,0);for(let ve=0;ve<j;ve+=V+1)for(let Ne=0;Ne<V;Ne++)O.emplaceBack(Ne+ve,V+Ne+ve+1,V+Ne+ve+2),O.emplaceBack(Ne+ve,V+Ne+ve+2,Ne+ve+1);const H=D.length,ee=H+(V+1),de=(V+1)*V,he=_?c.bg:0,fe=_?0:1,ye=w?c.bh:c.$,Te=w?0:1;for(let ve=0;ve<=V;ve++)D.emplaceBack(ve*$,he,fe);for(let ve=0;ve<=V;ve++)D.emplaceBack(ve*$,ye,Te);for(let ve=0;ve<V;ve++)O.emplaceBack(de+ve,ee+ve,ee+ve+1),O.emplaceBack(de+ve,ee+ve+1,de+ve+1),O.emplaceBack(0+ve,H+ve+1,H+ve),O.emplaceBack(0+ve,0+ve+1,H+ve+1);const _e=D.length,Ae=_e+2*(V+1);for(const ve of[0,1])for(let Ne=0;Ne<=V;Ne++)for(const tt of[0,1])D.emplaceBack(ve*c.$,Ne*$,tt);for(let ve=0;ve<2*V;ve+=2)O.emplaceBack(_e+ve,_e+ve+1,_e+ve+3),O.emplaceBack(_e+ve,_e+ve+3,_e+ve+2),O.emplaceBack(Ae+ve,Ae+ve+3,Ae+ve+1),O.emplaceBack(Ae+ve,Ae+ve+2,Ae+ve+3);const Me=new us(M.createVertexBuffer(D,Ch.members),M.createIndexBuffer(O),c.aL.simpleSegment(0,0,D.length,O.length));return this._meshCache[E]=Me,Me}getMeshFrameDelta(n){return 2*Math.PI*c.bt/Math.pow(2,Math.max(n,0))/5}getMinTileElevationForLngLatZoom(n,l){var p;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(n,l);return(p=this.getMinMaxElevation(_).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(n){const l=this.getTerrainData(n).tile,p={minElevation:null,maxElevation:null};return l&&l.dem&&(p.minElevation=l.dem.min*this.exaggeration,p.maxElevation=l.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(n,l){const p=c.a0.fromLngLat(n.wrap()),_=(1<<l)*c.$,w=p.x*_,E=p.y*_,M=Math.floor(w/c.$),D=Math.floor(E/c.$);return{tileID:new c.Z(l,0,l,M,D),mercatorX:w,mercatorY:E}}}class Fu{constructor(n,l,p){this._context=n,this._size=l,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const l=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),l.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),l.colorAttachment.set(p.texture),{id:n,fbo:l,texture:p,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(l=>n.id!==l),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const l of this._recentlyUsed)if(!this._objects[l].inUse)return this._objects[l];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const jt={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Jt{constructor(n,l){this.painter=n,this.terrain=l,this.pool=new Fu(n.context,30,l.sourceCache.tileSize*l.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,l){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(p=>!n._layers[p].isHidden(l)),this._coordsAscending={};for(const p in n.sourceCaches){this._coordsAscending[p]={};const _=n.sourceCaches[p].getVisibleCoordinates(),w=n.sourceCaches[p].getSource(),E=w instanceof na?w.terrainTileRanges:null;for(const M of _){const D=this.terrain.sourceCache.getTerrainCoords(M,E);for(const O in D)this._coordsAscending[p][O]||(this._coordsAscending[p][O]=[]),this._coordsAscending[p][O].push(D[O])}}this._coordsAscendingStr={};for(const p of n._order){const _=n._layers[p],w=_.source;if(jt[_.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const E in this._coordsAscending[w])this._coordsAscendingStr[w][E]=this._coordsAscending[w][E].map(M=>M.key).sort().join()}}for(const p of this._renderableTiles)for(const _ in this._coordsAscendingStr){const w=this._coordsAscendingStr[_][p.tileID.key];w&&w!==p.rttCoords[_]&&(p.rtt=[])}}renderLayer(n,l){if(n.isHidden(this.painter.transform.zoom))return!1;const p=Object.assign(Object.assign({},l),{isRenderingToTexture:!0}),_=n.type,w=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(jt[_]&&(this._prevType&&jt[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(n.id),!E))return!0;if(jt[this._prevType]||jt[_]&&E){this._prevType=_;const M=this._stacks.length-1,D=this._stacks[M]||[];for(const O of this._renderableTiles){if(this.pool.isFull()&&(ti(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(O),O.rtt[M]){const $=this.pool.getObjectForId(O.rtt[M].id);if($.stamp===O.rtt[M].stamp){this.pool.useObject($);continue}}const V=this.pool.getOrCreateFreeObject();this.pool.useObject(V),this.pool.stampObject(V),O.rtt[M]={id:V.id,stamp:V.stamp},w.context.bindFramebuffer.set(V.fbo.framebuffer),w.context.clear({color:c.be.transparent,stencil:0}),w.currentStencilSource=void 0;for(let $=0;$<D.length;$++){const j=w.style._layers[D[$]],H=j.source?this._coordsAscending[j.source][O.tileID.key]:[O.tileID];w.context.viewport.set([0,0,V.fbo.width,V.fbo.height]),w._renderTileClippingMasks(j,H,!0),w.renderLayer(w,w.style.sourceCaches[j.source],j,H,p),j.source&&(O.rttCoords[j.source]=this._coordsAscendingStr[j.source][O.tileID.key])}}return ti(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects(),jt[_]}return!1}}const Id={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},si=P,Uu={hash:!1,interactive:!0,bearingSnap:7,attributionControl:$s,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},fa={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class jf{constructor(n,l,p=!1){this.mousedown=w=>{this.startMove(w,W.mousePos(this.element,w)),W.addEventListener(window,"mousemove",this.mousemove),W.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,W.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHanlder.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=W.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),W.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=W.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=l;const _=new bd;this._rotatePitchHanlder=new Rc({clickTolerance:3,move:(w,E)=>{const M=l.getBoundingClientRect(),D=new c.P((M.bottom-M.top)/2,(M.right-M.left)/2);return{bearingDelta:c.cm(new c.P(w.x,E.y),E,D),pitchDelta:p?-.5*(E.y-w.y):void 0}},moveStateManager:_,enable:!0,assignEvents:()=>{}}),this.map=n,W.addEventListener(l,"mousedown",this.mousedown),W.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),W.addEventListener(l,"touchcancel",this.reset)}startMove(n,l){this._rotatePitchHanlder.dragStart(n,l),W.disableDrag()}move(n,l){const p=this.map,{bearingDelta:_,pitchDelta:w}=this._rotatePitchHanlder.dragMove(n,l)||{};_&&p.setBearing(p.getBearing()+_),w&&p.setPitch(p.getPitch()+w)}off(){const n=this.element;W.removeEventListener(n,"mousedown",this.mousedown),W.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend),W.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){W.enableDrag(),W.removeEventListener(window,"mousemove",this.mousemove),W.removeEventListener(window,"mouseup",this.mouseup),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend)}}let oa;function em(b,n,l,p=!1){if(p||!l.getCoveringTilesDetailsProvider().allowWorldCopies())return b==null?void 0:b.wrap();const _=new c.S(b.lng,b.lat);if(b=new c.S(b.lng,b.lat),n){const w=new c.S(b.lng-360,b.lat),E=new c.S(b.lng+360,b.lat),M=l.locationToScreenPoint(b).distSqr(n);l.locationToScreenPoint(w).distSqr(n)<M?b=w:l.locationToScreenPoint(E).distSqr(n)<M&&(b=E)}for(;Math.abs(b.lng-l.center.lng)>180;){const w=l.locationToScreenPoint(b);if(w.x>=0&&w.y>=0&&w.x<=l.width&&w.y<=l.height)break;b.lng>l.center.lng?b.lng-=360:b.lng+=360}return b.lng!==_.lng&&l.isPointOnMapSurface(l.locationToScreenPoint(b))?b:_}const yl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qr(b,n,l){const p=b.classList;for(const _ in yl)p.remove(`maplibregl-${l}-anchor-${_}`);p.add(`maplibregl-${l}-anchor-${n}`)}class Yr extends c.E{constructor(n){if(super(),this._onKeyPress=l=>{const p=l.code,_=l.charCode||l.keyCode;p!=="Space"&&p!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=l=>{const p=l.originalEvent.target,_=this._element;this._popup&&(p===_||_.contains(p))&&this.togglePopup()},this._update=l=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((l==null?void 0:l.type)==="terrain"||(l==null?void 0:l.type)==="render"&&!p)&&this._map.once("render",this._update),this._lngLat=em(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||l&&l.type!=="moveend"||(this._pos=this._pos.round()),W.setTransform(this._element,`${yl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${_}`),G.frameAsync(new AbortController).then(()=>{this._updateOpacity(l&&l.type==="moveend")}).catch(()=>{})},this._onMove=l=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=l=>{this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(n==null?void 0:n.opacity,n==null?void 0:n.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=c.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=W.create("div");const l=W.createNS("http://www.w3.org/2000/svg","svg"),p=41,_=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${p}px`),l.setAttributeNS(null,"width",`${_}px`),l.setAttributeNS(null,"viewBox",`0 0 ${_} ${p}`);const w=W.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const E=W.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const M=W.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"transform","translate(3.0, 29.0)"),M.setAttributeNS(null,"fill","#000000");const D=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of D){const ye=W.createNS("http://www.w3.org/2000/svg","ellipse");ye.setAttributeNS(null,"opacity","0.04"),ye.setAttributeNS(null,"cx","10.5"),ye.setAttributeNS(null,"cy","5.80029008"),ye.setAttributeNS(null,"rx",fe.rx),ye.setAttributeNS(null,"ry",fe.ry),M.appendChild(ye)}const O=W.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const V=W.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(V);const $=W.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const j=W.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(j);const H=W.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const ee=W.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(8.0, 8.0)");const de=W.createNS("http://www.w3.org/2000/svg","circle");de.setAttributeNS(null,"fill","#000000"),de.setAttributeNS(null,"opacity","0.25"),de.setAttributeNS(null,"cx","5.5"),de.setAttributeNS(null,"cy","5.5"),de.setAttributeNS(null,"r","5.4999962");const he=W.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#FFFFFF"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962"),ee.appendChild(de),ee.appendChild(he),E.appendChild(M),E.appendChild(O),E.appendChild($),E.appendChild(H),E.appendChild(ee),l.appendChild(E),l.setAttributeNS(null,"height",p*this._scale+"px"),l.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(l),this._offset=c.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),qr(this._element,this._anchor,"marker"),n&&n.className)for(const l of n.className.split(" "))this._element.classList.add(l);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),n.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),W.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=c.S.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const _=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var l,p;const _=(l=this._map)===null||l===void 0?void 0:l.terrain,w=this._map.transform.isLocationOccluded(this._lngLat);if(!_||w){const H=w?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==H&&(this._element.style.opacity=H))}if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const E=this._map,M=E.terrain.depthAtPoint(this._pos),D=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,D)-M<.006)return void(this._element.style.opacity=this._opacity);const O=-this._offset.y/E.transform.pixelsPerMeter,V=Math.sin(E.getPitch()*Math.PI/180)*O,$=E.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),j=E.transform.lngLatToCameraDepth(this._lngLat,D+V)-$>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&j&&this._popup.remove(),this._element.style.opacity=j?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=c.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,l){return(this._opacity===void 0||n===void 0&&l===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),l!==void 0&&(this._opacityWhenCovered=l),this._map&&this._updateOpacity(!0),this}}const $a={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let zr=0,Ho=!1;const ju={maxWidth:100,unit:"metric"};function $u(b,n,l){const p=l&&l.maxWidth||100,_=b._container.clientHeight/2,w=b._container.clientWidth/2,E=b.unproject([w-p/2,_]),M=b.unproject([w+p/2,_]),D=Math.round(b.project(M).x-b.project(E).x),O=Math.min(p,D,b._container.clientWidth),V=E.distanceTo(M);if(l&&l.unit==="imperial"){const $=3.2808*V;$>5280?_l(n,O,$/5280,b._getUIString("ScaleControl.Miles")):_l(n,O,$,b._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?_l(n,O,V/1852,b._getUIString("ScaleControl.NauticalMiles")):V>=1e3?_l(n,O,V/1e3,b._getUIString("ScaleControl.Kilometers")):_l(n,O,V,b._getUIString("ScaleControl.Meters"))}function _l(b,n,l,p){const _=function(w){const E=Math.pow(10,`${Math.floor(w)}`.length-1);let M=w/E;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(D){const O=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*O)/O}(M),E*M}(l);b.style.width=n*(_/l)+"px",b.innerHTML=`${_}&nbsp;${p}`}const Ts={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Lc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function zc(b){if(b){if(typeof b=="number"){const n=Math.round(Math.abs(b)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,b),"top-left":new c.P(n,n),"top-right":new c.P(-n,n),bottom:new c.P(0,-b),"bottom-left":new c.P(n,-n),"bottom-right":new c.P(-n,-n),left:new c.P(b,0),right:new c.P(-b,0)}}if(b instanceof c.P||Array.isArray(b)){const n=c.P.convert(b);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:c.P.convert(b.center||[0,0]),top:c.P.convert(b.top||[0,0]),"top-left":c.P.convert(b["top-left"]||[0,0]),"top-right":c.P.convert(b["top-right"]||[0,0]),bottom:c.P.convert(b.bottom||[0,0]),"bottom-left":c.P.convert(b["bottom-left"]||[0,0]),"bottom-right":c.P.convert(b["bottom-right"]||[0,0]),left:c.P.convert(b.left||[0,0]),right:c.P.convert(b.right||[0,0])}}return zc(new c.P(0,0))}const Ph=P;y.AJAXError=c.cy,y.Event=c.l,y.Evented=c.E,y.LngLat=c.S,y.MercatorCoordinate=c.a0,y.Point=c.P,y.addProtocol=c.cz,y.config=c.a,y.removeProtocol=c.cA,y.AttributionControl=Ln,y.BoxZoomHandler=Bu,y.CanvasSource=Wa,y.CooperativeGesturesHandler=Uf,y.DoubleClickZoomHandler=eu,y.DragPanHandler=Vu,y.DragRotateHandler=tu,y.EdgeInsets=Li,y.FullscreenControl=class extends c.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var n;let l=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=l==null?void 0:l.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)l=l.shadowRoot.fullscreenElement;l===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){W.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=W.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);W.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},y.GeoJSONSource=za,y.GeolocateControl=class extends c.E{constructor(b){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",n)),this._finish()}},this._updateCamera=n=>{const l=new c.S(n.coords.longitude,n.coords.latitude),p=n.coords.accuracy,_=this._map.getBearing(),w=c.e({bearing:_},this.options.fitBoundsOptions),E=Tr.fromLngLat(l,p);this._map.fitBounds(E,w,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const l=new c.S(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Ho)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=W.create("button","maplibregl-ctrl-geolocate",this._container),W.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=W.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Yr({element:this._dotElement}),this._circleElement=W.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Yr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},$a,b)}onAdd(b){return this._map=b,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(n=!1){if(oa!==void 0&&!n)return oa;if(window.navigator.permissions===void 0)return oa=!!window.navigator.geolocation,oa;try{oa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{oa=!!window.navigator.geolocation}return oa})}().then(n=>this._finishSetupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),W.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,zr=0,Ho=!1}_isOutOfMapMaxBounds(b){const n=this._map.getMaxBounds(),l=b.coords;return n&&(l.longitude<n.getWest()||l.longitude>n.getEast()||l.latitude<n.getSouth()||l.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const b=this._map.getBounds(),n=b.getSouthEast(),l=b.getNorthEast(),p=n.distanceTo(l),_=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":zr--,Ho=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),zr++,zr>1?(b={maximumAge:6e5,timeout:0},Ho=!0):(b=this.options.positionOptions,Ho=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},y.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const n=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(n!=="mercator"&&n?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=W.create("button","maplibregl-ctrl-globe",this._container),W.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){W.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},y.Hash=vs,y.ImageSource=na,y.KeyboardHandler=ws,y.LngLatBounds=Tr,y.LogoControl=mr,y.Map=class extends Lr{constructor(b){var n,l;c.cv.mark(c.cw.create);const p=Object.assign(Object.assign(Object.assign({},Uu),b),{canvasContextAttributes:Object.assign(Object.assign({},Uu.canvasContextAttributes),b.canvasContextAttributes)});if(p.minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const _=new jr,w=new ds;if(p.minZoom!==void 0&&_.setMinZoom(p.minZoom),p.maxZoom!==void 0&&_.setMaxZoom(p.maxZoom),p.minPitch!==void 0&&_.setMinPitch(p.minPitch),p.maxPitch!==void 0&&_.setMaxPitch(p.maxPitch),p.renderWorldCopies!==void 0&&_.setRenderWorldCopies(p.renderWorldCopies),super(_,w,{bearingSnap:p.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new xi,this._controls=[],this._mapId=c.a6(),this._contextLost=M=>{M.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:M}))},this._contextRestored=M=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:M}))},this._onMapScroll=M=>{if(M.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},p.canvasContextAttributes),this._trackResize=p.trackResize===!0,this._bearingSnap=p.bearingSnap,this._centerClampedToGround=p.centerClampedToGround,this._refreshExpiredTiles=p.refreshExpiredTiles===!0,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions===!0,this._collectResourceTiming=p.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Id),p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=p.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=qe.addThrottleControl(()=>this.isMoving()),this._requestManager=new Fe(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let M=!1;const D=jo(O=>{this._trackResize&&!this._removed&&(this.resize(O),this.redraw())},50);this._resizeObserver=new ResizeObserver(O=>{M?D(O):M=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Go(this,p),this._hash=p.hash&&new vs(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,elevation:p.elevation,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,roll:p.roll}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,c.e({},p.fitBoundsOptions,{duration:0}))));const E=typeof p.style=="string"||((l=(n=p.style)===null||n===void 0?void 0:n.projection)===null||l===void 0?void 0:l.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new Ln(typeof p.attributionControl=="boolean"?void 0:p.attributionControl)),p.maplibreLogo&&this.addControl(new mr,p.logoPosition),this.on("style.load",()=>{if(E||this._resizeTransform(),this.transform.unmodified){const M=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(M)}}),this.on("data",M=>{this._update(M.dataType==="style"),this.fire(new c.l(`${M.dataType}data`,M))}),this.on("dataloading",M=>{this.fire(new c.l(`${M.dataType}dataloading`,M))}),this.on("dataabort",M=>{this.fire(new c.l("sourcedataabort",M))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,n){return this.style.setGlobalStateProperty(b,n),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,n){if(n===void 0&&(n=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=b.onAdd(this);this._controls.push(b);const p=this._controlPositions[n];return n.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(b);return n>-1&&this._controls.splice(n,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}calculateCameraOptionsFromTo(b,n,l,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,n,l,p)}resize(b,n=!0){const[l,p]=this._containerDimensions(),_=this._getClampedPixelRatio(l,p);if(this._resizeCanvas(l,p,_),this.painter.resize(l,p,_),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const M=this._getClampedPixelRatio(l,p);this._resizeCanvas(l,p,M),this.painter.resize(l,p,M)}this._resizeTransform(n);const w=!this._moving;return w&&(this.stop(),this.fire(new c.l("movestart",b)).fire(new c.l("move",b))),this.fire(new c.l("resize",b)),w&&this.fire(new c.l("moveend",b)),this}_resizeTransform(b=!0){var n;const[l,p]=this._containerDimensions();this.transform.resize(l,p,b),(n=this._requestedCameraState)===null||n===void 0||n.resize(l,p,b)}_getClampedPixelRatio(b,n){const{0:l,1:p}=this._maxCanvasSize,_=this.getPixelRatio(),w=b*_,E=n*_;return Math.min(w>l?l/w:1,E>p?p/E:1)*_}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Tr.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(c.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(c.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,n,l){if(b==="mouseenter"||b==="mouseover"){let p=!1;return{layers:n,listener:l,delegates:{mousemove:w=>{const E=n.filter(D=>this.getLayer(D)),M=E.length!==0?this.queryRenderedFeatures(w.point,{layers:E}):[];M.length?p||(p=!0,l.call(this,new ja(b,this,w.originalEvent,{features:M}))):p=!1},mouseout:()=>{p=!1}}}}if(b==="mouseleave"||b==="mouseout"){let p=!1;return{layers:n,listener:l,delegates:{mousemove:E=>{const M=n.filter(D=>this.getLayer(D));(M.length!==0?this.queryRenderedFeatures(E.point,{layers:M}):[]).length?p=!0:p&&(p=!1,l.call(this,new ja(b,this,E.originalEvent)))},mouseout:E=>{p&&(p=!1,l.call(this,new ja(b,this,E.originalEvent)))}}}}{const p=_=>{const w=n.filter(M=>this.getLayer(M)),E=w.length!==0?this.queryRenderedFeatures(_.point,{layers:w}):[];E.length&&(_.features=E,l.call(this,_),delete _.features)};return{layers:n,listener:l,delegates:{[b]:p}}}}_saveDelegatedListener(b,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(n)}_removeDelegatedListener(b,n,l){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const p=this._delegatedListeners[b];for(let _=0;_<p.length;_++){const w=p[_];if(w.listener===l&&w.layers.length===n.length&&w.layers.every(E=>n.includes(E))){for(const E in w.delegates)this.off(E,w.delegates[E]);return void p.splice(_,1)}}}on(b,n,l){if(l===void 0)return super.on(b,n);const p=typeof n=="string"?[n]:n,_=this._createDelegatedListener(b,p,l);this._saveDelegatedListener(b,_);for(const w in _.delegates)this.on(w,_.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(b,p,l)}}}once(b,n,l){if(l===void 0)return super.once(b,n);const p=typeof n=="string"?[n]:n,_=this._createDelegatedListener(b,p,l);for(const w in _.delegates){const E=_.delegates[w];_.delegates[w]=(...M)=>{this._removeDelegatedListener(b,p,l),E(...M)}}this._saveDelegatedListener(b,_);for(const w in _.delegates)this.once(w,_.delegates[w]);return this}off(b,n,l){return l===void 0?super.off(b,n):(this._removeDelegatedListener(b,typeof n=="string"?[n]:n,l),this)}queryRenderedFeatures(b,n){if(!this.style)return[];let l;const p=b instanceof c.P||Array.isArray(b),_=p?b:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(p?{}:b)||{},_ instanceof c.P||typeof _[0]=="number")l=[c.P.convert(_)];else{const w=c.P.convert(_[0]),E=c.P.convert(_[1]);l=[w,new c.P(E.x,w.y),E,new c.P(w.x,E.y),w]}return this.style.queryRenderedFeatures(l,n,this.transform)}querySourceFeatures(b,n){return this.style.querySourceFeatures(b,n)}setStyle(b,n){return(n=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(b,n))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const n=this._locale[b];if(n==null)throw new Error(`Missing UI string '${b}'`);return n}_updateStyle(b,n){var l,p;if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,n));const _=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new wc(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,n,_):this.style.loadJSON(b,n,_),this):((p=(l=this.style)===null||l===void 0?void 0:l.projection)===null||p===void 0||p.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new wc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,n){if(typeof b=="string"){const l=this._requestManager.transformRequest(b,"Style");c.j(l,new AbortController).then(p=>{this._updateDiff(p.data,n)}).catch(p=>{p&&this.fire(new c.k(p))})}else typeof b=="object"&&this._updateDiff(b,n)}_updateDiff(b,n){try{this.style.setState(b,n)&&this._update(!0)}catch(l){c.w(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(b,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(b,n){return this._lazyInitEmptyStyle(),this.style.addSource(b,n),this._update(!0)}isSourceLoaded(b){const n=this.style&&this.style.sourceCaches[b];if(n!==void 0)return n.loaded();this.fire(new c.k(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const n=this.style.sourceCaches[b.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&n.reload();for(const l in this.style._layers){const p=this.style._layers[l];p.type==="hillshade"&&p.source===b.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),p.type==="color-relief"&&p.source===b.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ia(this.painter,n,b),this.painter.renderToTexture=new Jt(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=l=>{var p;l.dataType==="style"?this.terrain.sourceCache.freeRtt():l.dataType==="source"&&l.tile&&(l.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((p=l.source)===null||p===void 0?void 0:p.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(l.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:b})),this}getTerrain(){var b,n;return(n=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const n in b){const l=b[n]._tiles;for(const p in l){const _=l[p];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,n,l){if(l){const p=this.getSource(l);if(!p)throw new Error(`There is no source with ID "${l}", cannot set LOD parameters`);p.calculateTileZoom=Je(Math.max(1,b),Math.max(1,n))}else for(const p in this.style.sourceCaches)this.style.sourceCaches[p].getSource().calculateTileZoom=Je(Math.max(1,b),Math.max(1,n));return this._update(!0),this}refreshTiles(b,n){const l=this.style.sourceCaches[b];if(!l)throw new Error(`There is no source cache with ID "${b}", cannot refresh tile`);n===void 0?l.reload(!0):l.refreshTiles(n.map(p=>new c.a3(p.z,p.x,p.y)))}addImage(b,n,l={}){const{pixelRatio:p=1,sdf:_=!1,stretchX:w,stretchY:E,content:M,textFitWidth:D,textFitHeight:O}=l;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||c.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:V,height:$,data:j}=n,H=n;return this.style.addImage(b,{data:new c.R({width:V,height:$},new Uint8Array(j)),pixelRatio:p,stretchX:w,stretchY:E,content:M,textFitWidth:D,textFitHeight:O,sdf:_,version:0,userImage:H}),H.onAdd&&H.onAdd(this,b),this}}{const{width:V,height:$,data:j}=G.getImageData(n);this.style.addImage(b,{data:new c.R({width:V,height:$},j),pixelRatio:p,stretchX:w,stretchY:E,content:M,textFitWidth:D,textFitHeight:O,sdf:_,version:0})}}updateImage(b,n){const l=this.style.getImage(b);if(!l)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=n instanceof HTMLImageElement||c.b(n)?G.getImageData(n):n,{width:_,height:w,data:E}=p;if(_===void 0||w===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==l.data.width||w!==l.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const M=!(n instanceof HTMLImageElement||c.b(n));return l.data.replace(E,M),this.style.updateImage(b,l),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return qe.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,n){return this._lazyInitEmptyStyle(),this.style.addLayer(b,n),this._update(!0)}moveLayer(b,n){return this.style.moveLayer(b,n),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,n,l){return this.style.setLayerZoomRange(b,n,l),this._update(!0)}setFilter(b,n,l={}){return this.style.setFilter(b,n,l),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,n,l,p={}){return this.style.setPaintProperty(b,n,l,p),this._update(!0)}getPaintProperty(b,n){return this.style.getPaintProperty(b,n)}setLayoutProperty(b,n,l,p={}){return this.style.setLayoutProperty(b,n,l,p),this._update(!0)}getLayoutProperty(b,n){return this.style.getLayoutProperty(b,n)}setGlyphs(b,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,n,l={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,n,l,p=>{p||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,n,l=>{l||this._update(!0)}),this}setLight(b,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,n={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,n),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,n){return this.style.setFeatureState(b,n),this._update()}removeFeatureState(b,n){return this.style.removeFeatureState(b,n),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,n=0;return this._container&&(b=this._container.clientWidth||400,n=this._container.clientHeight||300),[b,n]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const n=this._canvasContainer=W.create("div","maplibregl-canvas-container",b);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=W.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const l=this._containerDimensions(),p=this._getClampedPixelRatio(l[0],l[1]);this._resizeCanvas(l[0],l[1],p);const _=this._controlContainer=W.create("div","maplibregl-control-container",b),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{w[E]=W.create("div",`maplibregl-ctrl-${E} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,n,l){this._canvas.width=Math.floor(l*b),this._canvas.height=Math.floor(l*n),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let n=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{n={requestedAttributes:b},p&&(n.statusMessage=p.statusMessage,n.type=p.type)},{once:!0});let l=null;if(l=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!l){const p="Failed to initialize WebGL";throw n?(n.message=p,new Error(JSON.stringify(n))):new Error(p)}this.painter=new es(l,this.transform),ie.testSupport(l)}migrateProjection(b,n){super.migrateProjection(b,n),this.painter.transform=b,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var n,l,p,_,w;const E=this._idleTriggered?this._fadeDuration:0,M=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let D=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const $=this.transform.zoom,j=G.now();this.style.zoomHistory.update($,j);const H=new c.F($,{now:j,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),ee=H.crossFadingFactor();ee===1&&ee===this._crossFadingFactor||(D=!0,this._crossFadingFactor=ee),this.style.update(H)}const O=((l=this.style.projection)===null||l===void 0?void 0:l.transitionState)>0!==M;(p=this.style.projection)===null||p===void 0||p.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((_=this.style.projection)===null||_===void 0?void 0:_.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||O)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,O),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cv.mark(c.cw.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||D)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const V=this._sourcesDirty||this._styleDirty||this._placementDirty;return V||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||V||(this._fullyLoaded=!0,c.cv.mark(c.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),qe.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n!=null&&n.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),W.remove(this._canvasContainer),W.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cv.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,G.frame(this._frameRequest,b=>{c.cv.frame(b),this._frameRequest=null;try{this._render(b)}catch(n){if(!c.cx(n)&&!function(l){return l.message===Df}(n))throw n}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return si}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},y.MapMouseEvent=ja,y.MapTouchEvent=vo,y.MapWheelEvent=Nf,y.Marker=Yr,y.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const n=this._map.getZoom(),l=n===this._map.getMaxZoom(),p=n===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(n,l)=>{const p=this._map._getUIString(`NavigationControl.${l}`);n.title=p,n.setAttribute("aria-label",p)},this.options=c.e({},fa,b),this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),W.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),W.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=W.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new jf(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){W.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,n){const l=W.create("button",b,this._container);return l.type="button",l.addEventListener("click",n),l}},y.Popup=class extends c.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&W.remove(this._content),this._container&&(W.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=W.create("div","maplibregl-popup",this._map.getContainer()),this._tip=W.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=em(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!n)return;const l=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationToScreenPoint(this._lngLat));let p=this.options.anchor;const _=zc(this.options.offset);if(!p){const E=this._container.offsetWidth,M=this._container.offsetHeight;let D;D=l.y+_.bottom.y<M?["top"]:l.y>this._map.transform.height-M?["bottom"]:[],l.x<E/2?D.push("left"):l.x>this._map.transform.width-E/2&&D.push("right"),p=D.length===0?"bottom":D.join("-")}let w=l.add(_[p]);this.options.subpixelPositioning||(w=w.round()),W.setTransform(this._container,`${yl[p]} translate(${w.x}px,${w.y}px)`),qr(this._container,p,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Ts),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=c.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const n=document.createDocumentFragment(),l=document.createElement("body");let p;for(l.innerHTML=b;p=l.firstChild,p;)n.appendChild(p);return this.setDOMContent(n)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=W.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=W.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Lc);b&&b.focus()}},y.RasterDEMTileSource=Cr,y.RasterTileSource=nl,y.ScaleControl=class{constructor(b){this._onMove=()=>{$u(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,$u(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ju),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){W.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},y.ScrollZoomHandler=gl,y.Style=wc,y.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=W.create("button","maplibregl-ctrl-terrain",this._container),W.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){W.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},y.TwoFingersTouchPitchHandler=Td,y.TwoFingersTouchRotateHandler=wd,y.TwoFingersTouchZoomHandler=xo,y.TwoFingersTouchZoomRotateHandler=Sd,y.VectorTileSource=_a,y.VideoSource=Ds,y.addSourceType=(b,n)=>c._(void 0,void 0,void 0,function*(){if(Ls(b))throw new Error(`A source type called "${b}" already exists.`);((l,p)=>{_u[l]=p})(b,n)}),y.clearPrewarmedResources=function(){const b=Rt;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(ze),Rt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},y.createTileMesh=bc,y.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},y.getRTLTextPluginStatus=function(){return zn().getRTLTextPluginStatus()},y.getVersion=function(){return Ph},y.getWorkerCount=function(){return xt.workerCount},y.getWorkerUrl=function(){return c.a.WORKER_URL},y.importScriptInWorkers=function(b){return ii().broadcast("IS",b)},y.prewarm=function(){wn().acquire(ze)},y.setMaxParallelImageRequests=function(b){c.a.MAX_PARALLEL_IMAGE_REQUESTS=b},y.setRTLTextPlugin=function(b,n){return zn().setRTLTextPlugin(b,n)},y.setWorkerCount=function(b){xt.workerCount=b},y.setWorkerUrl=function(b){c.a.WORKER_URL=b}});var m=t;return m})}(Jv)),Jv.exports}var g4=m4();const sn=S_(g4);function y4(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class _4{constructor(){this._apiKey="",this._fetch=y4(),this.tileCacheSize=200}set apiKey(e){this._apiKey=e}get apiKey(){return this._apiKey}set fetch(e){this._fetch=e}get fetch(){return this._fetch}}const Qm=new _4,v4={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1}},b4={ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!0},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!0},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!0},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!0},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!0},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!0},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!0},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!0},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!0},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!0},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!0},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!0},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!0},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!0},WELSH:{code:"cy",flag:"name:cy",name:"Welsh",latin:!0,isMode:!1,geocoding:!0}},F_={...v4,...b4};function x4(r,e=F_){return r in e?r[r]:null}function Jx(r,e=F_){for(const t of Object.values(e))if(t.code===r)return t;return null}function e1(r,e=F_){for(const t of Object.values(e))if(t.flag===r)return t;return null}function w4(r){return r!==null&&typeof r=="object"&&"code"in r&&"flag"in r&&"name"in r&&"latin"in r&&"isMode"in r&&"geocoding"in r&&(typeof r.code=="string"||r.code===null)&&typeof r.flag=="string"&&typeof r.name=="string"&&typeof r.latin=="boolean"&&typeof r.isMode=="boolean"&&typeof r.geocoding=="boolean"}function dS(r,e=F_){return w4(r)?e1(r.flag,e):typeof r!="string"?null:x4(r,e)||Jx(r,e)||e1(r,e)||null}async function T4(r,e={}){if(Qm.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(r).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return Qm.fetch(r,e)}const IC={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(IC);class S4 extends Error{constructor(e,t=""){super(`Call to enpoint ${e.url} failed with the status code ${e.status}. ${t}`),this.res=e}}const fS={403:"Key is missing, invalid or restricted"};async function E4(r={}){const e=new URL("geolocation/ip.json",IC.maptilerApiURL);e.searchParams.set("key",r.apiKey??Qm.apiKey);const t=e.toString(),a=await T4(t);if(!a.ok)throw new S4(a,a.status in fS?fS[a.status]:"");return await a.json()}const pS={info:E4};function CC(r){const e=/^maptiler:\/\/(.*)/;let t;const a=r.trim();let d;return a.startsWith("http://")||a.startsWith("https://")?d=a:(t=e.exec(a))!==null?d=`https://api.maptiler.com/maps/${t[1]}/style.json`:d=`https://api.maptiler.com/maps/${a}/style.json`,d}class PC{constructor(e,t,a,d,m,y,c=!1){this.name=e,this.variantType=t,this.id=a,this.referenceStyle=d,this.description=m,this.imageURL=y,this.deprecated=c}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(e){return this.referenceStyle.hasVariant(e)}getVariant(e){const t=this.referenceStyle.getVariant(e);return this.warnIfDeprecated(t),t}getVariants(){return this.referenceStyle.getVariants().filter(e=>e!==this).map(e=>(this.warnIfDeprecated(e),e))}getImageURL(){return this.imageURL}getExpandedStyleURL(){return CC(this.getId())}warnIfDeprecated(e=this){if(!e.deprecated)return e;const t=e.getFullName();return console.warn(`Style "${t}" is deprecated and will be removed in a future version.`),e}}class MC{constructor(e,t){this.name=e,this.id=t,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(e){this.variants[e.getType()]=e,this.orderedVariants.push(e)}hasVariant(e){return e in this.variants}getVariant(e){return e in this.variants?this.variants[e]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0].warnIfDeprecated()}}const Xy=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",deprecated:!0,name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",deprecated:!0,variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",deprecated:!0,variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",deprecated:!0,variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",deprecated:!0,variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",deprecated:!0,variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",deprecated:!0,description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",deprecated:!0,description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"AQUARELLE",name:"Aquarelle",description:"Watercolor map for creative use",variants:[{id:"aquarelle",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"aquarelle-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"aquarelle-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]},{referenceStyleID:"LANDSCAPE",name:"Landscape",description:"Terrain map for data overlays and visualisations",variants:[{id:"landscape",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"landscape-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"landscape-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]}];function A4(r){return new Proxy(r,{get(e,t,a){return e.hasVariant(t)?e.getVariant(t):t.toString().toUpperCase()===t?r.getDefaultVariant():Reflect.get(e,t,a)}})}function I4(){const r={};for(let e=0;e<Xy.length;e+=1){const t=Xy[e],a=A4(new MC(t.name,t.referenceStyleID));for(let d=0;d<t.variants.length;d+=1){const m=t.variants[d],y=new PC(m.name,m.variantType,m.id,a,m.description,m.imageURL,m.deprecated);a.addVariant(y)}r[t.referenceStyleID]=a}return r}const Yy=I4();var Dv={exports:{}},mS;function C4(){if(mS)return Dv.exports;mS=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(Fe,We,pe){return Function.prototype.apply.call(Fe,We,pe)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(Fe){return Object.getOwnPropertyNames(Fe).concat(Object.getOwnPropertySymbols(Fe))}:t=function(Fe){return Object.getOwnPropertyNames(Fe)};function a(qe){console&&console.warn&&console.warn(qe)}var d=Number.isNaN||function(Fe){return Fe!==Fe};function m(){m.init.call(this)}Dv.exports=m,Dv.exports.once=Oe,m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var y=10;function c(qe){if(typeof qe!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof qe)}Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return y},set:function(qe){if(typeof qe!="number"||qe<0||d(qe))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+qe+".");y=qe}}),m.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(Fe){if(typeof Fe!="number"||Fe<0||d(Fe))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Fe+".");return this._maxListeners=Fe,this};function P(qe){return qe._maxListeners===void 0?m.defaultMaxListeners:qe._maxListeners}m.prototype.getMaxListeners=function(){return P(this)},m.prototype.emit=function(Fe){for(var We=[],pe=1;pe<arguments.length;pe++)We.push(arguments[pe]);var oe=Fe==="error",me=this._events;if(me!==void 0)oe=oe&&me.error===void 0;else if(!oe)return!1;if(oe){var be;if(We.length>0&&(be=We[0]),be instanceof Error)throw be;var Ce=new Error("Unhandled error."+(be?" ("+be.message+")":""));throw Ce.context=be,Ce}var Ve=me[Fe];if(Ve===void 0)return!1;if(typeof Ve=="function")e(Ve,this,We);else for(var Ee=Ve.length,Yn=ie(Ve,Ee),pe=0;pe<Ee;++pe)e(Yn[pe],this,We);return!0};function k(qe,Fe,We,pe){var oe,me,be;if(c(We),me=qe._events,me===void 0?(me=qe._events=Object.create(null),qe._eventsCount=0):(me.newListener!==void 0&&(qe.emit("newListener",Fe,We.listener?We.listener:We),me=qe._events),be=me[Fe]),be===void 0)be=me[Fe]=We,++qe._eventsCount;else if(typeof be=="function"?be=me[Fe]=pe?[We,be]:[be,We]:pe?be.unshift(We):be.push(We),oe=P(qe),oe>0&&be.length>oe&&!be.warned){be.warned=!0;var Ce=new Error("Possible EventEmitter memory leak detected. "+be.length+" "+String(Fe)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ce.name="MaxListenersExceededWarning",Ce.emitter=qe,Ce.type=Fe,Ce.count=be.length,a(Ce)}return qe}m.prototype.addListener=function(Fe,We){return k(this,Fe,We,!1)},m.prototype.on=m.prototype.addListener,m.prototype.prependListener=function(Fe,We){return k(this,Fe,We,!0)};function B(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function X(qe,Fe,We){var pe={fired:!1,wrapFn:void 0,target:qe,type:Fe,listener:We},oe=B.bind(pe);return oe.listener=We,pe.wrapFn=oe,oe}m.prototype.once=function(Fe,We){return c(We),this.on(Fe,X(this,Fe,We)),this},m.prototype.prependOnceListener=function(Fe,We){return c(We),this.prependListener(Fe,X(this,Fe,We)),this},m.prototype.removeListener=function(Fe,We){var pe,oe,me,be,Ce;if(c(We),oe=this._events,oe===void 0)return this;if(pe=oe[Fe],pe===void 0)return this;if(pe===We||pe.listener===We)--this._eventsCount===0?this._events=Object.create(null):(delete oe[Fe],oe.removeListener&&this.emit("removeListener",Fe,pe.listener||We));else if(typeof pe!="function"){for(me=-1,be=pe.length-1;be>=0;be--)if(pe[be]===We||pe[be].listener===We){Ce=pe[be].listener,me=be;break}if(me<0)return this;me===0?pe.shift():Ie(pe,me),pe.length===1&&(oe[Fe]=pe[0]),oe.removeListener!==void 0&&this.emit("removeListener",Fe,Ce||We)}return this},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(Fe){var We,pe,oe;if(pe=this._events,pe===void 0)return this;if(pe.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):pe[Fe]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete pe[Fe]),this;if(arguments.length===0){var me=Object.keys(pe),be;for(oe=0;oe<me.length;++oe)be=me[oe],be!=="removeListener"&&this.removeAllListeners(be);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(We=pe[Fe],typeof We=="function")this.removeListener(Fe,We);else if(We!==void 0)for(oe=We.length-1;oe>=0;oe--)this.removeListener(Fe,We[oe]);return this};function G(qe,Fe,We){var pe=qe._events;if(pe===void 0)return[];var oe=pe[Fe];return oe===void 0?[]:typeof oe=="function"?We?[oe.listener||oe]:[oe]:We?Re(oe):ie(oe,oe.length)}m.prototype.listeners=function(Fe){return G(this,Fe,!0)},m.prototype.rawListeners=function(Fe){return G(this,Fe,!1)},m.listenerCount=function(qe,Fe){return typeof qe.listenerCount=="function"?qe.listenerCount(Fe):W.call(qe,Fe)},m.prototype.listenerCount=W;function W(qe){var Fe=this._events;if(Fe!==void 0){var We=Fe[qe];if(typeof We=="function")return 1;if(We!==void 0)return We.length}return 0}m.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function ie(qe,Fe){for(var We=new Array(Fe),pe=0;pe<Fe;++pe)We[pe]=qe[pe];return We}function Ie(qe,Fe){for(;Fe+1<qe.length;Fe++)qe[Fe]=qe[Fe+1];qe.pop()}function Re(qe){for(var Fe=new Array(qe.length),We=0;We<Fe.length;++We)Fe[We]=qe[We].listener||qe[We];return Fe}function Oe(qe,Fe){return new Promise(function(We,pe){function oe(be){qe.removeListener(Fe,me),pe(be)}function me(){typeof qe.removeListener=="function"&&qe.removeListener("error",oe),We([].slice.call(arguments))}mt(qe,Fe,me,{once:!0}),Fe!=="error"&&Ke(qe,oe,{once:!0})})}function Ke(qe,Fe,We){typeof qe.on=="function"&&mt(qe,"error",Fe,We)}function mt(qe,Fe,We,pe){if(typeof qe.on=="function")pe.once?qe.once(Fe,We):qe.on(Fe,We);else if(typeof qe.addEventListener=="function")qe.addEventListener(Fe,function oe(me){pe.once&&qe.removeEventListener(Fe,oe),We(me)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof qe)}return Dv.exports}var P4=C4();const M4=S_(P4),As=[];for(let r=0;r<256;++r)As.push((r+256).toString(16).slice(1));function R4(r,e=0){return(As[r[e+0]]+As[r[e+1]]+As[r[e+2]]+As[r[e+3]]+"-"+As[r[e+4]]+As[r[e+5]]+"-"+As[r[e+6]]+As[r[e+7]]+"-"+As[r[e+8]]+As[r[e+9]]+"-"+As[r[e+10]]+As[r[e+11]]+As[r[e+12]]+As[r[e+13]]+As[r[e+14]]+As[r[e+15]]).toLowerCase()}let ix;const k4=new Uint8Array(16);function D4(){if(!ix){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ix=crypto.getRandomValues.bind(crypto)}return ix(k4)}const L4=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),gS={randomUUID:L4};function z4(r,e,t){var d;if(gS.randomUUID&&!r)return gS.randomUUID();r=r||{};const a=r.random??((d=r.rng)==null?void 0:d.call(r))??D4();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,R4(a)}const RC="3.7.7",O4=RC,xg=typeof Buffer=="function",yS=typeof TextDecoder=="function"?new TextDecoder:void 0,_S=typeof TextEncoder=="function"?new TextEncoder:void 0,N4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",jy=Array.prototype.slice.call(N4),Lv=(r=>{let e={};return r.forEach((t,a)=>e[t]=a),e})(jy),B4=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Is=String.fromCharCode.bind(String),vS=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):r=>new Uint8Array(Array.prototype.slice.call(r,0)),kC=r=>r.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),DC=r=>r.replace(/[^A-Za-z0-9\+\/]/g,""),LC=r=>{let e,t,a,d,m="";const y=r.length%3;for(let c=0;c<r.length;){if((t=r.charCodeAt(c++))>255||(a=r.charCodeAt(c++))>255||(d=r.charCodeAt(c++))>255)throw new TypeError("invalid character found");e=t<<16|a<<8|d,m+=jy[e>>18&63]+jy[e>>12&63]+jy[e>>6&63]+jy[e&63]}return y?m.slice(0,y-3)+"===".substring(y):m},Ow=typeof btoa=="function"?r=>btoa(r):xg?r=>Buffer.from(r,"binary").toString("base64"):LC,t1=xg?r=>Buffer.from(r).toString("base64"):r=>{let t=[];for(let a=0,d=r.length;a<d;a+=4096)t.push(Is.apply(null,r.subarray(a,a+4096)));return Ow(t.join(""))},e0=(r,e=!1)=>e?kC(t1(r)):t1(r),V4=r=>{if(r.length<2){var e=r.charCodeAt(0);return e<128?r:e<2048?Is(192|e>>>6)+Is(128|e&63):Is(224|e>>>12&15)+Is(128|e>>>6&63)+Is(128|e&63)}else{var e=65536+(r.charCodeAt(0)-55296)*1024+(r.charCodeAt(1)-56320);return Is(240|e>>>18&7)+Is(128|e>>>12&63)+Is(128|e>>>6&63)+Is(128|e&63)}},F4=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,zC=r=>r.replace(F4,V4),bS=xg?r=>Buffer.from(r,"utf8").toString("base64"):_S?r=>t1(_S.encode(r)):r=>Ow(zC(r)),Jm=(r,e=!1)=>e?kC(bS(r)):bS(r),xS=r=>Jm(r,!0),U4=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,j4=r=>{switch(r.length){case 4:var e=(7&r.charCodeAt(0))<<18|(63&r.charCodeAt(1))<<12|(63&r.charCodeAt(2))<<6|63&r.charCodeAt(3),t=e-65536;return Is((t>>>10)+55296)+Is((t&1023)+56320);case 3:return Is((15&r.charCodeAt(0))<<12|(63&r.charCodeAt(1))<<6|63&r.charCodeAt(2));default:return Is((31&r.charCodeAt(0))<<6|63&r.charCodeAt(1))}},OC=r=>r.replace(U4,j4),NC=r=>{if(r=r.replace(/\s+/g,""),!B4.test(r))throw new TypeError("malformed base64.");r+="==".slice(2-(r.length&3));let e,t="",a,d;for(let m=0;m<r.length;)e=Lv[r.charAt(m++)]<<18|Lv[r.charAt(m++)]<<12|(a=Lv[r.charAt(m++)])<<6|(d=Lv[r.charAt(m++)]),t+=a===64?Is(e>>16&255):d===64?Is(e>>16&255,e>>8&255):Is(e>>16&255,e>>8&255,e&255);return t},Nw=typeof atob=="function"?r=>atob(DC(r)):xg?r=>Buffer.from(r,"base64").toString("binary"):NC,BC=xg?r=>vS(Buffer.from(r,"base64")):r=>vS(Nw(r).split("").map(e=>e.charCodeAt(0))),VC=r=>BC(FC(r)),$4=xg?r=>Buffer.from(r,"base64").toString("utf8"):yS?r=>yS.decode(BC(r)):r=>OC(Nw(r)),FC=r=>DC(r.replace(/[-_]/g,e=>e=="-"?"+":"/")),n1=r=>$4(FC(r)),q4=r=>{if(typeof r!="string")return!1;const e=r.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},UC=r=>({value:r,enumerable:!1,writable:!0,configurable:!0}),jC=function(){const r=(e,t)=>Object.defineProperty(String.prototype,e,UC(t));r("fromBase64",function(){return n1(this)}),r("toBase64",function(e){return Jm(this,e)}),r("toBase64URI",function(){return Jm(this,!0)}),r("toBase64URL",function(){return Jm(this,!0)}),r("toUint8Array",function(){return VC(this)})},$C=function(){const r=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,UC(t));r("toBase64",function(e){return e0(this,e)}),r("toBase64URI",function(){return e0(this,!0)}),r("toBase64URL",function(){return e0(this,!0)})},G4=()=>{jC(),$C()},H4={version:RC,VERSION:O4,atob:Nw,atobPolyfill:NC,btoa:Ow,btoaPolyfill:LC,fromBase64:n1,toBase64:Jm,encode:Jm,encodeURI:xS,encodeURL:xS,utob:zC,btou:OC,decode:n1,isValid:q4,fromUint8Array:e0,toUint8Array:VC,extendString:jC,extendUint8Array:$C,extendBuiltins:G4};var Z4=Object.defineProperty,qC=r=>{throw TypeError(r)},K4=(r,e,t)=>e in r?Z4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Un=(r,e,t)=>K4(r,typeof e!="symbol"?e+"":e,t),Bw=(r,e,t)=>e.has(r)||qC("Cannot "+t),dr=(r,e,t)=>(Bw(r,e,"read from private field"),t?t.call(r):e.get(r)),vp=(r,e,t)=>e.has(r)?qC("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Vm=(r,e,t,a)=>(Bw(r,e,"write to private field"),e.set(r,t),t),Al=(r,e,t)=>(Bw(r,e,"access private method"),t);const xr={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...F_};function wS(){if(typeof navigator>"u"){const r=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return Jx(r)||xr.ENGLISH}return Array.from(new Set(navigator.languages.map(r=>r.split("-")[0]))).map(r=>Jx(r)).filter(r=>r)[0]??xr.LOCAL}const Po={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",telemetryURL:"https://api.maptiler.com/metrics",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:xr.STYLE,secondaryLanguage:xr.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Po);const Vw=z4();class W4 extends M4{constructor(){super(...arguments),Un(this,"primaryLanguage",Po.primaryLanguage),Un(this,"secondaryLanguage"),Un(this,"session",!0),Un(this,"caching",!0),Un(this,"telemetry",!0),Un(this,"_unit","metric"),Un(this,"_apiKey","")}set unit(e){this._unit=e,this.emit("unit",e)}get unit(){return this._unit}set apiKey(e){this._apiKey=e,Qm.apiKey=e,this.emit("apiKey",e)}get apiKey(){return this._apiKey}set fetch(e){Qm.fetch=e}get fetch(){return Qm.fetch}}const Ha=new W4,r1="localcache_source",i1="localcache",X4="maptiler_sdk",Y4=1e3,Q4=100,a1=typeof caches<"u",{addProtocol:TS}=sn;function J4(r,e){if(a1&&Ha.caching&&Ha.session&&r.host===Po.maptilerApiHost){if(e==="Source"&&r.href.includes("tiles.json"))return r.href.replace("https://",`${r1}://`);if(e==="Tile"||e==="Glyphs")return r.href.replace("https://",`${i1}://`)}return r.href}let ax;async function GC(){return ax||(ax=await caches.open(X4)),ax}let SS=0;async function eN(){const r=await GC(),e=await r.keys(),t=e.slice(0,Math.max(e.length-Y4,0));for(const a of t)r.delete(a)}function tN(){TS(r1,async(r,e)=>{if(!r.url)throw new Error("");r.url=r.url.replace(`${r1}://`,"https://");const t=r;t.signal=e.signal;const a=await fetch(r.url,t),d=await a.json();return d.tiles&&d.tiles.length>0&&(d.tiles[0]+=`&last-modified=${a.headers.get("Last-Modified")}`),{data:d,cacheControl:a.headers.get("Cache-Control"),expires:a.headers.get("Expires")}}),TS(i1,async(r,e)=>{if(!r.url)throw new Error("");r.url=r.url.replace(`${i1}://`,"https://");const t=new URL(r.url),a=new URL(t);a.searchParams.delete("mtsid"),a.searchParams.delete("key");const d=a.toString(),m=new URL(t);m.searchParams.delete("last-modified");const y=m.toString(),c=async G=>({data:await G.arrayBuffer(),cacheControl:G.headers.get("Cache-Control"),expires:G.headers.get("Expires")}),P=await GC(),k=await P.match(d);if(k)return c(k);const B=r;B.signal=e.signal;const X=await fetch(y,B);return X.status>=200&&X.status<300&&(P.put(d,X.clone()).catch(()=>{}),++SS>Q4&&(eN(),SS=0)),c(X)})}function nN(){if(typeof window>"u")return;const r=sn.getRTLTextPluginStatus();if(r==="unavailable"||r==="requested")try{sn.setRTLTextPlugin(Po.rtlPluginURL,!0)}catch{}}function rN(r,e){for(const t of r)typeof e[t]=="function"&&(e[t]=e[t].bind(e))}function ES(r,e){let t=null;try{t=new URL(r)}catch{return{url:r}}return t.host===Po.maptilerApiHost&&(t.searchParams.has("key")||t.searchParams.append("key",Ha.apiKey),Ha.session&&t.searchParams.append("mtsid",Vw)),{url:J4(t,e)}}function AS(r){return(e,t)=>{if(r!=null){const a=r(e,t),d=ES((a==null?void 0:a.url)??"",t);return{...a,...d}}return ES(e,t)}}function iN(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function aN(r){const e=iN();if(!e)return;let t=null;if(typeof r=="string"?t=document.getElementById(r):r instanceof HTMLElement&&(t=r),!t)throw new Error("The Map container must be provided.");const a=document.createElement("div");throw a.innerHTML=e,a.classList.add("webgl-warning-div"),t.appendChild(a),new Error(e)}function IS(r,e){return!(!Array.isArray(r)||r.length!==2||r[0]!=="get"||typeof r[1]!="string"||e&&!r[1].startsWith("name:")||!e&&r[1]!=="name")}function sN(r,e,t){const a=structuredClone(r),d=m=>{if(typeof m!="string")for(let y=0;y<m.length;y+=1)IS(m[y],t)?m[y]=structuredClone(e):d(m[y])};return IS(a,t)?e:(d(a),a)}function oN(r,e){const t=e?/\{name:\S+\}/:/\{name\}/;return{contains:t.test(r),exactMatch:new RegExp(`^${t.source}$`).test(r)}}function lN(r,e,t){const a=t?/\{name:\S+\}/:/\{name\}/,d=r.split(a);return["concat",...d.flatMap((m,y)=>y===d.length-1?[m]:[m,e])]}function uN(r){var e;const t=/\{name(?::(?<language>\S+))?\}/g,a=[];for(;;){const d=t.exec(r);if(!d)break;const m=((e=d.groups)==null?void 0:e.language)??null;a.push(m)}return a}function cN(r){return!Array.isArray(r)||r.length!==2||r[0]!=="get"||typeof r[1]!="string"?null:r[1].trim()==="name"?{isLanguage:!0,localization:null}:r[1].trim().startsWith("name:")?{isLanguage:!0,localization:r[1].trim().split(":").pop()}:null}function hN(r){const e=[],t=structuredClone(r),a=d=>{if(typeof d!="string")for(let m=0;m<d.length;m+=1){const y=cN(d[m]);y?e.push(y.localization):a(d[m])}};return a([t]),e}function dN(r,e){const t=[];for(const m of r){if(m.type!=="symbol")continue;const y=m,{id:c,layout:P}=y;if(!P||!("text-field"in P))continue;const k=e.getLayoutProperty(c,"text-field");if(k)if(typeof k=="string"){const B=uN(k);t.push(B)}else{const B=hN(k);t.push(B)}}const a=t.flat(),d={unlocalized:0,localized:{}};for(const m of a)m===null?d.unlocalized+=1:(m in d.localized||(d.localized[m]=0),d.localized[m]+=1);return d}let fN=class extends sn.Marker{addTo(r){return super.addTo(r)}};class pN extends sn.Popup{addTo(e){return super.addTo(e)}}class MU extends sn.Style{constructor(e,t={}){super(e,t)}}class RU extends sn.CanvasSource{onAdd(e){super.onAdd(e)}}class kU extends sn.GeoJSONSource{onAdd(e){super.onAdd(e)}}class DU extends sn.ImageSource{onAdd(e){super.onAdd(e)}}class LU extends sn.RasterTileSource{onAdd(e){super.onAdd(e)}}class zU extends sn.RasterDEMTileSource{onAdd(e){super.onAdd(e)}}class OU extends sn.VectorTileSource{onAdd(e){super.onAdd(e)}}class NU extends sn.VideoSource{onAdd(e){super.onAdd(e)}}class mN extends sn.NavigationControl{onAdd(e){return super.onAdd(e)}}class gN extends sn.GeolocateControl{onAdd(e){return super.onAdd(e)}}class BU extends sn.AttributionControl{onAdd(e){return super.onAdd(e)}}class yN extends sn.LogoControl{onAdd(e){return super.onAdd(e)}}class _N extends sn.ScaleControl{onAdd(e){return super.onAdd(e)}}class vN extends sn.FullscreenControl{onAdd(e){return super.onAdd(e)}}class VU extends sn.TerrainControl{onAdd(e){return super.onAdd(e)}}class FU extends sn.BoxZoomHandler{constructor(e,t){super(e,t)}}class UU extends sn.ScrollZoomHandler{constructor(e,t){super(e,t)}}class jU extends sn.CooperativeGesturesHandler{constructor(e,t){super(e,t)}}class $U extends sn.KeyboardHandler{constructor(e){super(e)}}class qU extends sn.TwoFingersTouchPitchHandler{constructor(e){super(e)}}class GU extends sn.MapWheelEvent{constructor(e,t,a){super(e,t,a)}}class HU extends sn.MapTouchEvent{constructor(e,t,a){super(e,t,a)}}class ZU extends sn.MapMouseEvent{constructor(e,t,a,d={}){super(e,t,a,d)}}class CS extends yN{constructor(e={}){super(e),Un(this,"logoURL",""),Un(this,"linkURL",""),this.logoURL=e.logoURL??Po.maptilerLogoURL,this.linkURL=e.linkURL??Po.maptilerURL}onAdd(e){this._map=e,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const t=window.document.createElement("a");return t.style.backgroundRepeat="no-repeat",t.style.cursor="pointer",t.style.display="block",t.style.height="23px",t.style.margin="0 0 -4px -4px",t.style.overflow="hidden",t.style.width="88px",t.style.backgroundImage=`url(${this.logoURL})`,t.style.backgroundSize="100px 30px",t.style.width="100px",t.style.height="30px",t.target="_blank",t.rel="noopener",t.href=this.linkURL,t.setAttribute("aria-label","MapTiler logo"),t.setAttribute("rel","noopener"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var bN=8,xN={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},wN={"*":{type:"source"}},TN=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],SN={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},EN={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},AN={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},IN={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},CN={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},PN={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},MN={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},RN=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],kN={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},DN={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},LN={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},zN={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ON={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},NN={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},BN={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},VN={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},FN={type:"array",value:"*"},UN={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},jN={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},$N={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},qN={type:"array",value:"*",minimum:1},GN={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},HN={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},ZN={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},KN={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},WN=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],XN={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},YN={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},QN={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},JN={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},e6={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},t6={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},n6={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},r6={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},i6={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},a6={"*":{type:"string"}},s6={$version:bN,$root:xN,sources:wN,source:TN,source_vector:SN,source_raster:EN,source_raster_dem:AN,source_geojson:IN,source_video:CN,source_image:PN,layer:MN,layout:RN,layout_background:kN,layout_fill:DN,layout_circle:LN,layout_heatmap:zN,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:ON,layout_symbol:NN,layout_raster:BN,layout_hillshade:VN,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:FN,filter_operator:UN,geometry_type:jN,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:$N,expression:qN,light:GN,sky:HN,terrain:ZN,projection:KN,paint:WN,paint_fill:XN,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:YN,paint_circle:QN,paint_heatmap:JN,paint_symbol:e6,paint_raster:t6,paint_hillshade:n6,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:r6,transition:i6,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:a6};class zt{constructor(e,t,a,d){this.message=(e?`${e}: `:"")+a,d&&(this.identifier=d),t!=null&&t.__line__&&(this.line=t.__line__)}}function A0(r,...e){for(const t of e)for(const a in t)r[a]=t[a];return r}class Jc extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class Fw{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[a,d]of t)this.bindings[a]=d}concat(e){return new Fw(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}}const ob={kind:"null"},Ut={kind:"number"},Xn={kind:"string"},Hn={kind:"boolean"},sh={kind:"color"},lb={kind:"projectionDefinition"},Cp={kind:"object"},Fn={kind:"value"},o6={kind:"error"},ub={kind:"collator"},cb={kind:"formatted"},hb={kind:"padding"},f_={kind:"colorArray"},db={kind:"numberArray"},U_={kind:"resolvedImage"},fb={kind:"variableAnchorOffsetCollection"};function Cl(r,e){return{kind:"array",itemType:r,N:e}}function $i(r){if(r.kind==="array"){const e=$i(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}else return r.kind}const l6=[ob,Ut,Xn,Hn,sh,lb,cb,Cp,Cl(Fn),hb,db,f_,U_,fb];function p_(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!p_(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const t of l6)if(!p_(t,e))return null}}return`Expected ${$i(r)} but found ${$i(e)} instead.`}function Uw(r,e){return e.some(t=>t.kind===r.kind)}function Pp(r,e){return e.some(t=>t==="null"?r===null:t==="array"?Array.isArray(r):t==="object"?r&&!Array.isArray(r)&&typeof r=="object":t===typeof r)}function Xd(r,e){return r.kind==="array"&&e.kind==="array"?r.itemType.kind===e.itemType.kind&&typeof r.N=="number":r.kind===e.kind}const HC=.96422,ZC=1,KC=.82521,WC=4/29,eg=6/29,XC=3*eg*eg,u6=eg*eg*eg,c6=Math.PI/180,h6=180/Math.PI;function YC(r){return r=r%360,r<0&&(r+=360),r}function QC([r,e,t,a]){r=sx(r),e=sx(e),t=sx(t);let d,m;const y=ox((.2225045*r+.7168786*e+.0606169*t)/ZC);r===e&&e===t?d=m=y:(d=ox((.4360747*r+.3850649*e+.1430804*t)/HC),m=ox((.0139322*r+.0971045*e+.7141733*t)/KC));const c=116*y-16;return[c<0?0:c,500*(d-y),200*(y-m),a]}function sx(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function ox(r){return r>u6?Math.pow(r,1/3):r/XC+WC}function JC([r,e,t,a]){let d=(r+16)/116,m=isNaN(e)?d:d+e/500,y=isNaN(t)?d:d-t/200;return d=ZC*ux(d),m=HC*ux(m),y=KC*ux(y),[lx(3.1338561*m-1.6168667*d-.4906146*y),lx(-.9787684*m+1.9161415*d+.033454*y),lx(.0719453*m-.2289914*d+1.4052427*y),a]}function lx(r){return r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055,r<0?0:r>1?1:r}function ux(r){return r>eg?r*r*r:XC*(r-WC)}function d6(r){const[e,t,a,d]=QC(r),m=Math.sqrt(t*t+a*a);return[Math.round(m*1e4)?YC(Math.atan2(a,t)*h6):NaN,m,e,d]}function f6([r,e,t,a]){return r=isNaN(r)?0:r*c6,JC([t,Math.cos(r)*e,Math.sin(r)*e,a])}function p6([r,e,t,a]){r=YC(r),e/=100,t/=100;function d(m){const y=(m+r/30)%12,c=e*Math.min(t,1-t);return t-c*Math.max(-1,Math.min(y-3,9-y,1))}return[d(0),d(8),d(4),a]}const m6=Object.hasOwn||function(r,e){return Object.prototype.hasOwnProperty.call(r,e)};function Qy(r,e){return m6(r,e)?r[e]:void 0}function g6(r){if(r=r.toLowerCase().trim(),r==="transparent")return[0,0,0,0];const e=Qy(y6,r);if(e){const[d,m,y]=e;return[d/255,m/255,y/255,1]}if(r.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(r)){const d=r.length<6?1:2;let m=1;return[zv(r.slice(m,m+=d)),zv(r.slice(m,m+=d)),zv(r.slice(m,m+=d)),zv(r.slice(m,m+d)||"ff")]}if(r.startsWith("rgb")){const d=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,m=r.match(d);if(m){const[y,c,P,k,B,X,G,W,ie,Ie,Re,Oe]=m,Ke=[k||" ",G||" ",Ie].join("");if(Ke==="  "||Ke==="  /"||Ke===",,"||Ke===",,,"){const mt=[P,X,ie].join(""),qe=mt==="%%%"?100:mt===""?255:0;if(qe){const Fe=[Fm(+c/qe,0,1),Fm(+B/qe,0,1),Fm(+W/qe,0,1),Re?PS(+Re,Oe):1];if(MS(Fe))return Fe}}return}}const t=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,a=r.match(t);if(a){const[d,m,y,c,P,k,B,X,G]=a,W=[y||" ",P||" ",B].join("");if(W==="  "||W==="  /"||W===",,"||W===",,,"){const ie=[+m,Fm(+c,0,100),Fm(+k,0,100),X?PS(+X,G):1];if(MS(ie))return p6(ie)}}}function zv(r){return parseInt(r.padEnd(2,r),16)/255}function PS(r,e){return Fm(e?r/100:r,0,1)}function Fm(r,e,t){return Math.min(Math.max(e,r),t)}function MS(r){return!r.some(Number.isNaN)}const y6={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Mp(r,e,t){return r+t*(e-r)}function m_(r,e,t){return r.map((a,d)=>Mp(a,e[d],t))}let qi=class Um{constructor(e,t,a,d=1,m=!0){this.r=e,this.g=t,this.b=a,this.a=d,m||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[e,t,a,d]))}static parse(e){if(e instanceof Um)return e;if(typeof e!="string")return;const t=g6(e);if(t)return new Um(...t,!1)}get rgb(){const{r:e,g:t,b:a,a:d}=this,m=d||1/0;return this.overwriteGetter("rgb",[e/m,t/m,a/m,d])}get hcl(){return this.overwriteGetter("hcl",d6(this.rgb))}get lab(){return this.overwriteGetter("lab",QC(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,a,d]=this.rgb;return`rgba(${[e,t,a].map(m=>Math.round(m*255)).join(",")},${d})`}static interpolate(e,t,a,d="rgb"){switch(d){case"rgb":{const[m,y,c,P]=m_(e.rgb,t.rgb,a);return new Um(m,y,c,P,!1)}case"hcl":{const[m,y,c,P]=e.hcl,[k,B,X,G]=t.hcl;let W,ie;if(!isNaN(m)&&!isNaN(k)){let mt=k-m;k>m&&mt>180?mt-=360:k<m&&m-k>180&&(mt+=360),W=m+a*mt}else isNaN(m)?isNaN(k)?W=NaN:(W=k,(c===1||c===0)&&(ie=B)):(W=m,(X===1||X===0)&&(ie=y));const[Ie,Re,Oe,Ke]=f6([W,ie??Mp(y,B,a),Mp(c,X,a),Mp(P,G,a)]);return new Um(Ie,Re,Oe,Ke,!1)}case"lab":{const[m,y,c,P]=JC(m_(e.lab,t.lab,a));return new Um(m,y,c,P,!1)}}}};qi.black=new qi(0,0,0,1);qi.white=new qi(1,1,1,1);qi.transparent=new qi(0,0,0,0);qi.red=new qi(1,0,0,1);class jw{constructor(e,t,a){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const _6=["bottom","center","top"];class s1{constructor(e,t,a,d,m,y){this.text=e,this.image=t,this.scale=a,this.fontStack=d,this.textColor=m,this.verticalAlign=y}}class Wh{constructor(e){this.sections=e}static fromString(e){return new Wh([new s1(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Wh?e:Wh.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class uc{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof uc)return e;if(typeof e=="number")return new uc([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if(typeof t!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new uc(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a){return new uc(m_(e.values,t.values,a))}}class cc{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof cc)return e;if(typeof e=="number")return new cc([e]);if(Array.isArray(e)){for(const t of e)if(typeof t!="number")return;return new cc(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a){return new cc(m_(e.values,t.values,a))}}class Ml{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ml)return e;if(typeof e=="string"){const a=qi.parse(e);return a?new Ml([a]):void 0}if(!Array.isArray(e))return;const t=[];for(const a of e){if(typeof a!="string")return;const d=qi.parse(a);if(!d)return;t.push(d)}return new Ml(t)}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a,d="rgb"){const m=[];if(e.values.length!=t.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${t.values.length}), cannot interpolate.`);for(let y=0;y<e.values.length;y++)m.push(qi.interpolate(e.values[y],t.values[y],a,d));return new Ml(m)}}class Ji extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const v6=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class oh{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof oh)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let t=0;t<e.length;t+=2){const a=e[t],d=e[t+1];if(typeof a!="string"||!v6.has(a)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new oh(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a){const d=e.values,m=t.values;if(d.length!==m.length)throw new Ji(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const y=[];for(let c=0;c<d.length;c+=2){if(d[c]!==m[c])throw new Ji(`Cannot interpolate values containing mismatched anchors. from[${c}]: ${d[c]}, to[${c}]: ${m[c]}`);y.push(d[c]);const[P,k]=d[c+1],[B,X]=m[c+1];y.push([Mp(P,B,a),Mp(k,X,a)])}return new oh(y)}}class Tf{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Tf({name:e,available:!1}):null}}class sc{constructor(e,t,a){this.from=e,this.to=t,this.transition=a}static interpolate(e,t,a){return new sc(e,t,a)}static parse(e){if(e instanceof sc)return e;if(Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number")return new sc(e[0],e[1],e[2]);if(typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number")return new sc(e.from,e.to,e.transition);if(typeof e=="string")return new sc(e,e,1)}}function eP(r,e,t,a){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255?typeof a>"u"||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[r,e,t,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[r,e,t,a]:[r,e,t]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function g_(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof sc||r instanceof qi||r instanceof jw||r instanceof Wh||r instanceof uc||r instanceof cc||r instanceof Ml||r instanceof oh||r instanceof Tf)return!0;if(Array.isArray(r)){for(const e of r)if(!g_(e))return!1;return!0}else if(typeof r=="object"){for(const e in r)if(!g_(r[e]))return!1;return!0}else return!1}function La(r){if(r===null)return ob;if(typeof r=="string")return Xn;if(typeof r=="boolean")return Hn;if(typeof r=="number")return Ut;if(r instanceof qi)return sh;if(r instanceof sc)return lb;if(r instanceof jw)return ub;if(r instanceof Wh)return cb;if(r instanceof uc)return hb;if(r instanceof cc)return db;if(r instanceof Ml)return f_;if(r instanceof oh)return fb;if(r instanceof Tf)return U_;if(Array.isArray(r)){const e=r.length;let t;for(const a of r){const d=La(a);if(!t)t=d;else{if(t===d)continue;t=Fn;break}}return Cl(t||Fn,e)}else return Cp}function Jy(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof qi||r instanceof sc||r instanceof Wh||r instanceof uc||r instanceof cc||r instanceof Ml||r instanceof oh||r instanceof Tf?r.toString():JSON.stringify(r)}class cg{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(e.length!==2)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!g_(e[1]))return t.error("invalid value");const a=e[1];let d=La(a);const m=t.expectedType;return d.kind==="array"&&d.N===0&&m&&m.kind==="array"&&(typeof m.N!="number"||m.N===0)&&(d=m),new cg(d,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ov={string:Xn,number:Ut,boolean:Hn,object:Cp};class oc{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let a=1,d;const m=e[0];if(m==="array"){let c;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in Ov)||k==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);c=Ov[k],a++}else c=Fn;let P;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);P=e[2],a++}d=Cl(c,P)}else{if(!Ov[m])throw new Error(`Types doesn't contain name = ${m}`);d=Ov[m]}const y=[];for(;a<e.length;a++){const c=t.parse(e[a],a,Fn);if(!c)return null;y.push(c)}return new oc(d,y)}evaluate(e){for(let t=0;t<this.args.length;t++){const a=this.args[t].evaluate(e);if(p_(this.type,La(a))){if(t===this.args.length-1)throw new Ji(`Expected value to be of type ${$i(this.type)}, but found ${$i(La(a))} instead.`)}else return a}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const RS={"to-boolean":Hn,"to-color":sh,"to-number":Ut,"to-string":Xn};class rf{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const a=e[0];if(!RS[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&e.length!==2)return t.error("Expected one argument.");const d=RS[a],m=[];for(let y=1;y<e.length;y++){const c=t.parse(e[y],y,Fn);if(!c)return null;m.push(c)}return new rf(d,m)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,a;for(const d of this.args){if(t=d.evaluate(e),a=null,t instanceof qi)return t;if(typeof t=="string"){const m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&(t.length<3||t.length>4?a=`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:a=eP(t[0],t[1],t[2],t[3]),!a))return new qi(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ji(a||`Could not parse color from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const a of this.args){t=a.evaluate(e);const d=uc.parse(t);if(d)return d}throw new Ji(`Could not parse padding from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"numberArray":{let t;for(const a of this.args){t=a.evaluate(e);const d=cc.parse(t);if(d)return d}throw new Ji(`Could not parse numberArray from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"colorArray":{let t;for(const a of this.args){t=a.evaluate(e);const d=Ml.parse(t);if(d)return d}throw new Ji(`Could not parse colorArray from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const a of this.args){t=a.evaluate(e);const d=oh.parse(t);if(d)return d}throw new Ji(`Could not parse variableAnchorOffsetCollection from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const a of this.args){if(t=a.evaluate(e),t===null)return 0;const d=Number(t);if(!isNaN(d))return d}throw new Ji(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Wh.fromString(Jy(this.args[0].evaluate(e)));case"resolvedImage":return Tf.fromString(Jy(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return Jy(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const b6=["Unknown","Point","LineString","Polygon"];class tP{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?b6[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache.get(e);return t||(t=qi.parse(e),this._parseColorCache.set(e,t)),t}}class pb{constructor(e,t,a=[],d,m=new Fw,y=[]){this.registry=e,this.path=a,this.key=a.map(c=>`[${c}]`).join(""),this.scope=m,this.errors=y,this.expectedType=d,this._isConstant=t}parse(e,t,a,d,m={}){return t?this.concat(t,a,d)._parse(e,m):this._parse(e,m)}_parse(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function a(d,m,y){return y==="assert"?new oc(m,[d]):y==="coerce"?new rf(m,[d]):d}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const c=this.expectedType,P=y.type;if((c.kind==="string"||c.kind==="number"||c.kind==="boolean"||c.kind==="object"||c.kind==="array")&&P.kind==="value")y=a(y,c,t.typeAnnotation||"assert");else if(c.kind==="projectionDefinition"&&["string","array"].includes(P.kind)||["color","formatted","resolvedImage"].includes(c.kind)&&["value","string"].includes(P.kind)||["padding","numberArray"].includes(c.kind)&&["value","number","array"].includes(P.kind)||c.kind==="colorArray"&&["value","string","array"].includes(P.kind)||c.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(P.kind))y=a(y,c,t.typeAnnotation||"coerce");else if(this.checkSubtype(c,P))return null}if(!(y instanceof cg)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const c=new tP;try{y=new cg(y.type,y.evaluate(c))}catch(P){return this.error(P.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,a){const d=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new pb(this.registry,this._isConstant,d,t||null,m,this.errors)}error(e,...t){const a=`${this.key}${t.map(d=>`[${d}]`).join("")}`;this.errors.push(new Jc(a,e))}checkSubtype(e,t){const a=p_(e,t);return a&&this.error(a),a}}class mb{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return t.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return t.error("Variable names must contain only alphanumeric characters or '_'.",m);const c=t.parse(e[m+1],m+1);if(!c)return null;a.push([y,c])}const d=t.parse(e[e.length-1],e.length-1,t.expectedType,a);return d?new mb(a,d):null}outputDefined(){return this.result.outputDefined()}}class gb{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");const a=e[1];return t.scope.has(a)?new gb(a,t.scope.get(a)):t.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class $w{constructor(e,t,a){this.type=e,this.index=t,this.input=a}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,Ut),d=t.parse(e[2],2,Cl(t.expectedType||Fn));if(!a||!d)return null;const m=d.type;return new $w(m.itemType,a,d)}evaluate(e){const t=this.index.evaluate(e),a=this.input.evaluate(e);if(t<0)throw new Ji(`Array index out of bounds: ${t} < 0.`);if(t>=a.length)throw new Ji(`Array index out of bounds: ${t} > ${a.length-1}.`);if(t!==Math.floor(t))throw new Ji(`Array index must be an integer, but found ${t} instead.`);return a[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class qw{constructor(e,t){this.type=Hn,this.needle=e,this.haystack=t}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,Fn),d=t.parse(e[2],2,Fn);return!a||!d?null:Uw(a.type,[Hn,Xn,Ut,ob,Fn])?new qw(a,d):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${$i(a.type)} instead`)}evaluate(e){const t=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!Pp(t,["boolean","string","number","null"]))throw new Ji(`Expected first argument to be of type boolean, string, number or null, but found ${$i(La(t))} instead.`);if(!Pp(a,["string","array"]))throw new Ji(`Expected second argument to be of type array or string, but found ${$i(La(a))} instead.`);return a.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class I0{constructor(e,t,a){this.type=Ut,this.needle=e,this.haystack=t,this.fromIndex=a}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,Fn),d=t.parse(e[2],2,Fn);if(!a||!d)return null;if(!Uw(a.type,[Hn,Xn,Ut,ob,Fn]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${$i(a.type)} instead`);if(e.length===4){const m=t.parse(e[3],3,Ut);return m?new I0(a,d,m):null}else return new I0(a,d)}evaluate(e){const t=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!Pp(t,["boolean","string","number","null"]))throw new Ji(`Expected first argument to be of type boolean, string, number or null, but found ${$i(La(t))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(e)),Pp(a,["string"])){const m=a.indexOf(t,d);return m===-1?-1:[...a.slice(0,m)].length}else{if(Pp(a,["array"]))return a.indexOf(t,d);throw new Ji(`Expected second argument to be of type array or string, but found ${$i(La(a))} instead.`)}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Gw{constructor(e,t,a,d,m,y){this.inputType=e,this.type=t,this.input=a,this.cases=d,this.outputs=m,this.otherwise=y}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!==1)return t.error("Expected an even number of arguments.");let a,d;t.expectedType&&t.expectedType.kind!=="value"&&(d=t.expectedType);const m={},y=[];for(let k=2;k<e.length-1;k+=2){let B=e[k];const X=e[k+1];Array.isArray(B)||(B=[B]);const G=t.concat(k);if(B.length===0)return G.error("Expected at least one branch label.");for(const ie of B){if(typeof ie!="number"&&typeof ie!="string")return G.error("Branch labels must be numbers or strings.");if(typeof ie=="number"&&Math.abs(ie)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ie=="number"&&Math.floor(ie)!==ie)return G.error("Numeric branch labels must be integer values.");if(!a)a=La(ie);else if(G.checkSubtype(a,La(ie)))return null;if(typeof m[String(ie)]<"u")return G.error("Branch labels must be unique.");m[String(ie)]=y.length}const W=t.parse(X,k,d);if(!W)return null;d=d||W.type,y.push(W)}const c=t.parse(e[1],1,Fn);if(!c)return null;const P=t.parse(e[e.length-1],e.length-1,d);return!P||c.type.kind!=="value"&&t.concat(1).checkSubtype(a,c.type)?null:new Gw(a,d,c,m,y,P)}evaluate(e){const t=this.input.evaluate(e);return(La(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Hw{constructor(e,t,a){this.type=e,this.branches=t,this.otherwise=a}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!==0)return t.error("Expected an odd number of arguments.");let a;t.expectedType&&t.expectedType.kind!=="value"&&(a=t.expectedType);const d=[];for(let y=1;y<e.length-1;y+=2){const c=t.parse(e[y],y,Hn);if(!c)return null;const P=t.parse(e[y+1],y+1,a);if(!P)return null;d.push([c,P]),a=a||P.type}const m=t.parse(e[e.length-1],e.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new Hw(a,d,m)}evaluate(e){for(const[t,a]of this.branches)if(t.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,a]of this.branches)e(t),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}}class C0{constructor(e,t,a,d){this.type=e,this.input=t,this.beginIndex=a,this.endIndex=d}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,Fn),d=t.parse(e[2],2,Ut);if(!a||!d)return null;if(!Uw(a.type,[Cl(Fn),Xn,Fn]))return t.error(`Expected first argument to be of type array or string, but found ${$i(a.type)} instead`);if(e.length===4){const m=t.parse(e[3],3,Ut);return m?new C0(a.type,a,d,m):null}else return new C0(a.type,a,d)}evaluate(e){const t=this.input.evaluate(e),a=this.beginIndex.evaluate(e);let d;if(this.endIndex&&(d=this.endIndex.evaluate(e)),Pp(t,["string"]))return[...t].slice(a,d).join("");if(Pp(t,["array"]))return t.slice(a,d);throw new Ji(`Expected first argument to be of type array or string, but found ${$i(La(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function nP(r,e){const t=r.length-1;let a=0,d=t,m=0,y,c;for(;a<=d;)if(m=Math.floor((a+d)/2),y=r[m],c=r[m+1],y<=e){if(m===t||e<c)return m;a=m+1}else if(y>e)d=m-1;else throw new Ji("Input is not a number.");return 0}class yb{constructor(e,t,a){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[d,m]of a)this.labels.push(d),this.outputs.push(m)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");const a=t.parse(e[1],1,Ut);if(!a)return null;const d=[];let m=null;t.expectedType&&t.expectedType.kind!=="value"&&(m=t.expectedType);for(let y=1;y<e.length;y+=2){const c=y===1?-1/0:e[y],P=e[y+1],k=y,B=y+1;if(typeof c!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(d.length&&d[d.length-1][0]>=c)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const X=t.parse(P,B,m);if(!X)return null;m=m||X.type,d.push([c,X])}return new yb(m,a,d)}evaluate(e){const t=this.labels,a=this.outputs;if(t.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=t[0])return a[0].evaluate(e);const m=t.length;if(d>=t[m-1])return a[m-1].evaluate(e);const y=nP(t,d);return a[y].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function x6(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var cx,kS;function w6(){if(kS)return cx;kS=1,cx=r;function r(e,t,a,d){this.cx=3*e,this.bx=3*(a-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(d-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=a,this.p2y=d}return r.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var a=e,d=0;d<8;d++){var m=this.sampleCurveX(a)-e;if(Math.abs(m)<t)return a;var y=this.sampleCurveDerivativeX(a);if(Math.abs(y)<1e-6)break;a=a-m/y}var c=0,P=1;for(a=e,d=0;d<20&&(m=this.sampleCurveX(a),!(Math.abs(m-e)<t));d++)e>m?c=a:P=a,a=(P-c)*.5+c;return a},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},cx}var T6=w6(),S6=x6(T6);class lh{constructor(e,t,a,d,m){this.type=e,this.operator=t,this.interpolation=a,this.input=d,this.labels=[],this.outputs=[];for(const[y,c]of m)this.labels.push(y),this.outputs.push(c)}static interpolationFactor(e,t,a,d){let m=0;if(e.name==="exponential")m=hx(t,e.base,a,d);else if(e.name==="linear")m=hx(t,1,a,d);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new S6(y[0],y[1],y[2],y[3]).solve(hx(t,1,a,d))}return m}static parse(e,t){let[a,d,m,...y]=e;if(!Array.isArray(d)||d.length===0)return t.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const k=d[1];if(typeof k!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:k}}else if(d[0]==="cubic-bezier"){const k=d.slice(1);if(k.length!==4||k.some(B=>typeof B!="number"||B<0||B>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:k}}else return t.error(`Unknown interpolation type ${String(d[0])}`,1,0);if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(m=t.parse(m,2,Ut),!m)return null;const c=[];let P=null;(a==="interpolate-hcl"||a==="interpolate-lab")&&t.expectedType!=f_?P=sh:t.expectedType&&t.expectedType.kind!=="value"&&(P=t.expectedType);for(let k=0;k<y.length;k+=2){const B=y[k],X=y[k+1],G=k+3,W=k+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(c.length&&c[c.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const ie=t.parse(X,W,P);if(!ie)return null;P=P||ie.type,c.push([B,ie])}return!Xd(P,Ut)&&!Xd(P,lb)&&!Xd(P,sh)&&!Xd(P,hb)&&!Xd(P,db)&&!Xd(P,f_)&&!Xd(P,fb)&&!Xd(P,Cl(Ut))?t.error(`Type ${$i(P)} is not interpolatable.`):new lh(P,a,d,m,c)}evaluate(e){const t=this.labels,a=this.outputs;if(t.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=t[0])return a[0].evaluate(e);const m=t.length;if(d>=t[m-1])return a[m-1].evaluate(e);const y=nP(t,d),c=t[y],P=t[y+1],k=lh.interpolationFactor(this.interpolation,d,c,P),B=a[y].evaluate(e),X=a[y+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Mp(B,X,k);case"color":return qi.interpolate(B,X,k);case"padding":return uc.interpolate(B,X,k);case"colorArray":return Ml.interpolate(B,X,k);case"numberArray":return cc.interpolate(B,X,k);case"variableAnchorOffsetCollection":return oh.interpolate(B,X,k);case"array":return m_(B,X,k);case"projectionDefinition":return sc.interpolate(B,X,k)}case"interpolate-hcl":switch(this.type.kind){case"color":return qi.interpolate(B,X,k,"hcl");case"colorArray":return Ml.interpolate(B,X,k,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return qi.interpolate(B,X,k,"lab");case"colorArray":return Ml.interpolate(B,X,k,"lab")}}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function hx(r,e,t,a){const d=a-t,m=r-t;return d===0?0:e===1?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}class y_{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let a=null;const d=t.expectedType;d&&d.kind!=="value"&&(a=d);const m=[];for(const y of e.slice(1)){const c=t.parse(y,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!c)return null;a=a||c.type,m.push(c)}if(!a)throw new Error("No output type");return d&&m.some(y=>p_(d,y.type))?new y_(Fn,m):new y_(a,m)}evaluate(e){let t=null,a=0,d;for(const m of this.args)if(a++,t=m.evaluate(e),t&&t instanceof Tf&&!t.available&&(d||(d=t.name),t=null,a===this.args.length&&(t=d)),t!==null)break;return t}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function DS(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function E6(r,e,t){return e===t}function A6(r,e,t){return e!==t}function I6(r,e,t){return e<t}function C6(r,e,t){return e>t}function P6(r,e,t){return e<=t}function M6(r,e,t){return e>=t}function rP(r,e,t,a){return a.compare(e,t)===0}function R6(r,e,t,a){return!rP(r,e,t,a)}function k6(r,e,t,a){return a.compare(e,t)<0}function D6(r,e,t,a){return a.compare(e,t)>0}function L6(r,e,t,a){return a.compare(e,t)<=0}function z6(r,e,t,a){return a.compare(e,t)>=0}function wg(r,e,t){const a=r!=="=="&&r!=="!=";return class iP{constructor(m,y,c){this.type=Hn,this.lhs=m,this.rhs=y,this.collator=c,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const c=m[0];let P=y.parse(m[1],1,Fn);if(!P)return null;if(!DS(c,P.type))return y.concat(1).error(`"${c}" comparisons are not supported for type '${$i(P.type)}'.`);let k=y.parse(m[2],2,Fn);if(!k)return null;if(!DS(c,k.type))return y.concat(2).error(`"${c}" comparisons are not supported for type '${$i(k.type)}'.`);if(P.type.kind!==k.type.kind&&P.type.kind!=="value"&&k.type.kind!=="value")return y.error(`Cannot compare types '${$i(P.type)}' and '${$i(k.type)}'.`);a&&(P.type.kind==="value"&&k.type.kind!=="value"?P=new oc(k.type,[P]):P.type.kind!=="value"&&k.type.kind==="value"&&(k=new oc(P.type,[k])));let B=null;if(m.length===4){if(P.type.kind!=="string"&&k.type.kind!=="string"&&P.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(B=y.parse(m[3],3,ub),!B)return null}return new iP(P,k,B)}evaluate(m){const y=this.lhs.evaluate(m),c=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const P=La(y),k=La(c);if(P.kind!==k.kind||!(P.kind==="string"||P.kind==="number"))throw new Ji(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${P.kind}, ${k.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const P=La(y),k=La(c);if(P.kind!=="string"||k.kind!=="string")return e(m,y,c)}return this.collator?t(m,y,c,this.collator.evaluate(m)):e(m,y,c)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const O6=wg("==",E6,rP),N6=wg("!=",A6,R6),B6=wg("<",I6,k6),V6=wg(">",C6,D6),F6=wg("<=",P6,L6),U6=wg(">=",M6,z6);class _b{constructor(e,t,a){this.type=ub,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(e.length!==2)return t.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return t.error("Collator options argument must be an object.");const d=t.parse(a["case-sensitive"]===void 0?!1:a["case-sensitive"],1,Hn);if(!d)return null;const m=t.parse(a["diacritic-sensitive"]===void 0?!1:a["diacritic-sensitive"],1,Hn);if(!m)return null;let y=null;return a.locale&&(y=t.parse(a.locale,1,Xn),!y)?null:new _b(d,m,y)}evaluate(e){return new jw(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Zw{constructor(e,t,a,d,m){this.type=Xn,this.number=e,this.locale=t,this.currency=a,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,t){if(e.length!==3)return t.error("Expected two arguments.");const a=t.parse(e[1],1,Ut);if(!a)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return t.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=t.parse(d.locale,1,Xn),!m))return null;let y=null;if(d.currency&&(y=t.parse(d.currency,1,Xn),!y))return null;let c=null;if(d["min-fraction-digits"]&&(c=t.parse(d["min-fraction-digits"],1,Ut),!c))return null;let P=null;return d["max-fraction-digits"]&&(P=t.parse(d["max-fraction-digits"],1,Ut),!P)?null:new Zw(a,m,y,c,P)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Kw{constructor(e){this.type=cb,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return t.error("First argument must be an image or text section.");const d=[];let m=!1;for(let y=1;y<=e.length-1;++y){const c=e[y];if(m&&typeof c=="object"&&!Array.isArray(c)){m=!1;let P=null;if(c["font-scale"]&&(P=t.parse(c["font-scale"],1,Ut),!P))return null;let k=null;if(c["text-font"]&&(k=t.parse(c["text-font"],1,Cl(Xn)),!k))return null;let B=null;if(c["text-color"]&&(B=t.parse(c["text-color"],1,sh),!B))return null;let X=null;if(c["vertical-align"]){if(typeof c["vertical-align"]=="string"&&!_6.includes(c["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${c["vertical-align"]}' instead.`);if(X=t.parse(c["vertical-align"],1,Xn),!X)return null}const G=d[d.length-1];G.scale=P,G.font=k,G.textColor=B,G.verticalAlign=X}else{const P=t.parse(e[y],1,Fn);if(!P)return null;const k=P.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:P,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Kw(d)}evaluate(e){const t=a=>{const d=a.content.evaluate(e);return La(d)===U_?new s1("",d,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(e):null):new s1(Jy(d),null,a.scale?a.scale.evaluate(e):null,a.font?a.font.evaluate(e).join(","):null,a.textColor?a.textColor.evaluate(e):null,a.verticalAlign?a.verticalAlign.evaluate(e):null)};return new Wh(this.sections.map(t))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class Ww{constructor(e){this.type=U_,this.input=e}static parse(e,t){if(e.length!==2)return t.error("Expected two arguments.");const a=t.parse(e[1],1,Xn);return a?new Ww(a):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),a=Tf.fromString(t);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(t)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}}class Xw{constructor(e){this.type=Ut,this.input=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=t.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?t.error(`Expected argument of type string or array, but found ${$i(a.type)} instead.`):new Xw(a):null}evaluate(e){const t=this.input.evaluate(e);if(typeof t=="string")return[...t].length;if(Array.isArray(t))return t.length;throw new Ji(`Expected value to be of type string or array, but found ${$i(La(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const uh=8192;function j6(r,e){const t=$6(r[0]),a=G6(r[1]),d=Math.pow(2,e.z);return[Math.round(t*d*uh),Math.round(a*d*uh)]}function Yw(r,e){const t=Math.pow(2,e.z),a=(r[0]/uh+e.x)/t,d=(r[1]/uh+e.y)/t;return[q6(a),H6(d)]}function $6(r){return(180+r)/360}function q6(r){return r*360-180}function G6(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function H6(r){return 360/Math.PI*Math.atan(Math.exp((180-r*360)*Math.PI/180))-90}function j_(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function __(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function Z6(r,e,t){return e[1]>r[1]!=t[1]>r[1]&&r[0]<(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1])+e[0]}function K6(r,e,t){const a=r[0]-e[0],d=r[1]-e[1],m=r[0]-t[0],y=r[1]-t[1];return a*y-m*d===0&&a*m<=0&&d*y<=0}function vb(r,e,t,a){const d=[e[0]-r[0],e[1]-r[1]],m=[a[0]-t[0],a[1]-t[1]];return Q6(m,d)===0?!1:!!(LS(r,e,t,a)&&LS(t,a,r,e))}function W6(r,e,t){for(const a of t)for(let d=0;d<a.length-1;++d)if(vb(r,e,a[d],a[d+1]))return!0;return!1}function Tg(r,e,t=!1){let a=!1;for(const d of e)for(let m=0;m<d.length-1;m++){if(K6(r,d[m],d[m+1]))return t;Z6(r,d[m],d[m+1])&&(a=!a)}return a}function X6(r,e){for(const t of e)if(Tg(r,t))return!0;return!1}function aP(r,e){for(const t of r)if(!Tg(t,e))return!1;for(let t=0;t<r.length-1;++t)if(W6(r[t],r[t+1],e))return!1;return!0}function Y6(r,e){for(const t of e)if(aP(r,t))return!0;return!1}function Q6(r,e){return r[0]*e[1]-r[1]*e[0]}function LS(r,e,t,a){const d=r[0]-t[0],m=r[1]-t[1],y=e[0]-t[0],c=e[1]-t[1],P=a[0]-t[0],k=a[1]-t[1],B=d*k-P*m,X=y*k-P*c;return B>0&&X<0||B<0&&X>0}function Qw(r,e,t){const a=[];for(let d=0;d<r.length;d++){const m=[];for(let y=0;y<r[d].length;y++){const c=j6(r[d][y],t);j_(e,c),m.push(c)}a.push(m)}return a}function sP(r,e,t){const a=[];for(let d=0;d<r.length;d++){const m=Qw(r[d],e,t);a.push(m)}return a}function oP(r,e,t,a){if(r[0]<t[0]||r[0]>t[2]){const d=a*.5;let m=r[0]-t[0]>d?-a:t[0]-r[0]>d?a:0;m===0&&(m=r[0]-t[2]>d?-a:t[2]-r[0]>d?a:0),r[0]+=m}j_(e,r)}function J6(r){r[0]=r[1]=1/0,r[2]=r[3]=-1/0}function zS(r,e,t,a){const d=Math.pow(2,a.z)*uh,m=[a.x*uh,a.y*uh],y=[];for(const c of r)for(const P of c){const k=[P.x+m[0],P.y+m[1]];oP(k,e,t,d),y.push(k)}return y}function OS(r,e,t,a){const d=Math.pow(2,a.z)*uh,m=[a.x*uh,a.y*uh],y=[];for(const c of r){const P=[];for(const k of c){const B=[k.x+m[0],k.y+m[1]];j_(e,B),P.push(B)}y.push(P)}if(e[2]-e[0]<=d/2){J6(e);for(const c of y)for(const P of c)oP(P,e,t,d)}return y}function eB(r,e){const t=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],d=r.canonicalID();if(e.type==="Polygon"){const m=Qw(e.coordinates,a,d),y=zS(r.geometry(),t,a,d);if(!__(t,a))return!1;for(const c of y)if(!Tg(c,m))return!1}if(e.type==="MultiPolygon"){const m=sP(e.coordinates,a,d),y=zS(r.geometry(),t,a,d);if(!__(t,a))return!1;for(const c of y)if(!X6(c,m))return!1}return!0}function tB(r,e){const t=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],d=r.canonicalID();if(e.type==="Polygon"){const m=Qw(e.coordinates,a,d),y=OS(r.geometry(),t,a,d);if(!__(t,a))return!1;for(const c of y)if(!aP(c,m))return!1}if(e.type==="MultiPolygon"){const m=sP(e.coordinates,a,d),y=OS(r.geometry(),t,a,d);if(!__(t,a))return!1;for(const c of y)if(!Y6(c,m))return!1}return!0}class Rp{constructor(e,t){this.type=Hn,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(g_(e[1])){const a=e[1];if(a.type==="FeatureCollection"){const d=[];for(const m of a.features){const{type:y,coordinates:c}=m.geometry;y==="Polygon"&&d.push(c),y==="MultiPolygon"&&d.push(...c)}if(d.length){const m={type:"MultiPolygon",coordinates:d};return new Rp(a,m)}}else if(a.type==="Feature"){const d=a.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Rp(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Rp(a,a)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return eB(e,this.geometries);if(e.geometryType()==="LineString")return tB(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class lP{constructor(e=[],t=(a,d)=>a<d?-1:a>d?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:a}=this,d=t[e];for(;e>0;){const m=e-1>>1,y=t[m];if(a(d,y)>=0)break;t[e]=y,e=m}t[e]=d}_down(e){const{data:t,compare:a}=this,d=this.length>>1,m=t[e];for(;e<d;){let y=(e<<1)+1;const c=y+1;if(c<this.length&&a(t[c],t[y])<0&&(y=c),a(t[y],m)>=0)break;t[e]=t[y],e=y}t[e]=m}}function nB(r,e){if(r.length<=1)return[r];const t=[];let a,d;for(const m of r){const y=rB(m);y!==0&&(m.area=Math.abs(y),d===void 0&&(d=y<0),d===y<0?(a&&t.push(a),a=[m]):a.push(m))}return a&&t.push(a),t}function rB(r){let e=0;for(let t=0,a=r.length,d=a-1,m,y;t<a;d=t++)m=r[t],y=r[d],e+=(y.x-m.x)*(m.y+y.y);return e}const iB=6378.137,NS=1/298.257223563,BS=NS*(2-NS),VS=Math.PI/180;class Jw{constructor(e){const t=VS*iB*1e3,a=Math.cos(e*VS),d=1/(1-BS*(1-a*a)),m=Math.sqrt(d);this.kx=t*m*a,this.ky=t*m*d*(1-BS)}distance(e,t){const a=this.wrap(e[0]-t[0])*this.kx,d=(e[1]-t[1])*this.ky;return Math.sqrt(a*a+d*d)}pointOnLine(e,t){let a=1/0,d,m,y,c;for(let P=0;P<e.length-1;P++){let k=e[P][0],B=e[P][1],X=this.wrap(e[P+1][0]-k)*this.kx,G=(e[P+1][1]-B)*this.ky,W=0;(X!==0||G!==0)&&(W=(this.wrap(t[0]-k)*this.kx*X+(t[1]-B)*this.ky*G)/(X*X+G*G),W>1?(k=e[P+1][0],B=e[P+1][1]):W>0&&(k+=X/this.kx*W,B+=G/this.ky*W)),X=this.wrap(t[0]-k)*this.kx,G=(t[1]-B)*this.ky;const ie=X*X+G*G;ie<a&&(a=ie,d=k,m=B,y=P,c=W)}return{point:[d,m],index:y,t:Math.max(0,Math.min(1,c))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}const o1=100,l1=50;function uP(r,e){return e[0]-r[0]}function P0(r){return r[1]-r[0]+1}function nd(r,e){return r[1]>=r[0]&&r[1]<e}function u1(r,e){if(r[0]>r[1])return[null,null];const t=P0(r);if(e){if(t===2)return[r,null];const d=Math.floor(t/2);return[[r[0],r[0]+d],[r[0]+d,r[1]]]}if(t===1)return[r,null];const a=Math.floor(t/2)-1;return[[r[0],r[0]+a],[r[0]+a+1,r[1]]]}function c1(r,e){if(!nd(e,r.length))return[1/0,1/0,-1/0,-1/0];const t=[1/0,1/0,-1/0,-1/0];for(let a=e[0];a<=e[1];++a)j_(t,r[a]);return t}function h1(r){const e=[1/0,1/0,-1/0,-1/0];for(const t of r)for(const a of t)j_(e,a);return e}function FS(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function e2(r,e,t){if(!FS(r)||!FS(e))return NaN;let a=0,d=0;return r[2]<e[0]&&(a=e[0]-r[2]),r[0]>e[2]&&(a=r[0]-e[2]),r[1]>e[3]&&(d=r[1]-e[3]),r[3]<e[1]&&(d=e[1]-r[3]),t.distance([0,0],[a,d])}function Ap(r,e,t){const a=t.pointOnLine(e,r);return t.distance(r,a.point)}function t2(r,e,t,a,d){const m=Math.min(Ap(r,[t,a],d),Ap(e,[t,a],d)),y=Math.min(Ap(t,[r,e],d),Ap(a,[r,e],d));return Math.min(m,y)}function aB(r,e,t,a,d){if(!(nd(e,r.length)&&nd(a,t.length)))return 1/0;let m=1/0;for(let y=e[0];y<e[1];++y){const c=r[y],P=r[y+1];for(let k=a[0];k<a[1];++k){const B=t[k],X=t[k+1];if(vb(c,P,B,X))return 0;m=Math.min(m,t2(c,P,B,X,d))}}return m}function sB(r,e,t,a,d){if(!(nd(e,r.length)&&nd(a,t.length)))return NaN;let m=1/0;for(let y=e[0];y<=e[1];++y)for(let c=a[0];c<=a[1];++c)if(m=Math.min(m,d.distance(r[y],t[c])),m===0)return m;return m}function oB(r,e,t){if(Tg(r,e,!0))return 0;let a=1/0;for(const d of e){const m=d[0],y=d[d.length-1];if(m!==y&&(a=Math.min(a,Ap(r,[y,m],t)),a===0))return a;const c=t.pointOnLine(d,r);if(a=Math.min(a,t.distance(r,c.point)),a===0)return a}return a}function lB(r,e,t,a){if(!nd(e,r.length))return NaN;for(let m=e[0];m<=e[1];++m)if(Tg(r[m],t,!0))return 0;let d=1/0;for(let m=e[0];m<e[1];++m){const y=r[m],c=r[m+1];for(const P of t)for(let k=0,B=P.length,X=B-1;k<B;X=k++){const G=P[X],W=P[k];if(vb(y,c,G,W))return 0;d=Math.min(d,t2(y,c,G,W,a))}}return d}function US(r,e){for(const t of r)for(const a of t)if(Tg(a,e,!0))return!0;return!1}function uB(r,e,t,a=1/0){const d=h1(r),m=h1(e);if(a!==1/0&&e2(d,m,t)>=a)return a;if(__(d,m)){if(US(r,e))return 0}else if(US(e,r))return 0;let y=1/0;for(const c of r)for(let P=0,k=c.length,B=k-1;P<k;B=P++){const X=c[B],G=c[P];for(const W of e)for(let ie=0,Ie=W.length,Re=Ie-1;ie<Ie;Re=ie++){const Oe=W[Re],Ke=W[ie];if(vb(X,G,Oe,Ke))return 0;y=Math.min(y,t2(X,G,Oe,Ke,t))}}return y}function jS(r,e,t,a,d,m){if(!m)return;const y=e2(c1(a,m),d,t);y<e&&r.push([y,m,[0,0]])}function Nv(r,e,t,a,d,m,y){if(!m||!y)return;const c=e2(c1(a,m),c1(d,y),t);c<e&&r.push([c,m,y])}function M0(r,e,t,a,d=1/0){let m=Math.min(a.distance(r[0],t[0][0]),d);if(m===0)return m;const y=new lP([[0,[0,r.length-1],[0,0]]],uP),c=h1(t);for(;y.length>0;){const P=y.pop();if(P[0]>=m)continue;const k=P[1],B=e?l1:o1;if(P0(k)<=B){if(!nd(k,r.length))return NaN;if(e){const X=lB(r,k,t,a);if(isNaN(X)||X===0)return X;m=Math.min(m,X)}else for(let X=k[0];X<=k[1];++X){const G=oB(r[X],t,a);if(m=Math.min(m,G),m===0)return 0}}else{const X=u1(k,e);jS(y,m,a,r,c,X[0]),jS(y,m,a,r,c,X[1])}}return m}function R0(r,e,t,a,d,m=1/0){let y=Math.min(m,d.distance(r[0],t[0]));if(y===0)return y;const c=new lP([[0,[0,r.length-1],[0,t.length-1]]],uP);for(;c.length>0;){const P=c.pop();if(P[0]>=y)continue;const k=P[1],B=P[2],X=e?l1:o1,G=a?l1:o1;if(P0(k)<=X&&P0(B)<=G){if(!nd(k,r.length)&&nd(B,t.length))return NaN;let W;if(e&&a)W=aB(r,k,t,B,d),y=Math.min(y,W);else if(e&&!a){const ie=r.slice(k[0],k[1]+1);for(let Ie=B[0];Ie<=B[1];++Ie)if(W=Ap(t[Ie],ie,d),y=Math.min(y,W),y===0)return y}else if(!e&&a){const ie=t.slice(B[0],B[1]+1);for(let Ie=k[0];Ie<=k[1];++Ie)if(W=Ap(r[Ie],ie,d),y=Math.min(y,W),y===0)return y}else W=sB(r,k,t,B,d),y=Math.min(y,W)}else{const W=u1(k,e),ie=u1(B,a);Nv(c,y,d,r,t,W[0],ie[0]),Nv(c,y,d,r,t,W[0],ie[1]),Nv(c,y,d,r,t,W[1],ie[0]),Nv(c,y,d,r,t,W[1],ie[1])}}return y}function cB(r,e){const t=r.geometry(),a=t.flat().map(y=>Yw([y.x,y.y],r.canonical));if(t.length===0)return NaN;const d=new Jw(a[0][1]);let m=1/0;for(const y of e){switch(y.type){case"Point":m=Math.min(m,R0(a,!1,[y.coordinates],!1,d,m));break;case"LineString":m=Math.min(m,R0(a,!1,y.coordinates,!0,d,m));break;case"Polygon":m=Math.min(m,M0(a,!1,y.coordinates,d,m));break}if(m===0)return m}return m}function hB(r,e){const t=r.geometry(),a=t.flat().map(y=>Yw([y.x,y.y],r.canonical));if(t.length===0)return NaN;const d=new Jw(a[0][1]);let m=1/0;for(const y of e){switch(y.type){case"Point":m=Math.min(m,R0(a,!0,[y.coordinates],!1,d,m));break;case"LineString":m=Math.min(m,R0(a,!0,y.coordinates,!0,d,m));break;case"Polygon":m=Math.min(m,M0(a,!0,y.coordinates,d,m));break}if(m===0)return m}return m}function dB(r,e){const t=r.geometry();if(t.length===0||t[0].length===0)return NaN;const a=nB(t).map(y=>y.map(c=>c.map(P=>Yw([P.x,P.y],r.canonical)))),d=new Jw(a[0][0][0][1]);let m=1/0;for(const y of e)for(const c of a){switch(y.type){case"Point":m=Math.min(m,M0([y.coordinates],!1,c,d,m));break;case"LineString":m=Math.min(m,M0(y.coordinates,!0,c,d,m));break;case"Polygon":m=Math.min(m,uB(c,y.coordinates,d,m));break}if(m===0)return m}return m}function dx(r){return r.type==="MultiPolygon"?r.coordinates.map(e=>({type:"Polygon",coordinates:e})):r.type==="MultiLineString"?r.coordinates.map(e=>({type:"LineString",coordinates:e})):r.type==="MultiPoint"?r.coordinates.map(e=>({type:"Point",coordinates:e})):[r]}class kp{constructor(e,t){this.type=Ut,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(g_(e[1])){const a=e[1];if(a.type==="FeatureCollection")return new kp(a,a.features.map(d=>dx(d.geometry)).flat());if(a.type==="Feature")return new kp(a,dx(a.geometry));if("type"in a&&"coordinates"in a)return new kp(a,dx(a))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return cB(e,this.geometries);if(e.geometryType()==="LineString")return hB(e,this.geometries);if(e.geometryType()==="Polygon")return dB(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class $_{constructor(e){this.type=Fn,this.key=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=e[1];return a==null?t.error("Global state property must be defined."):typeof a!="string"?t.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new $_(a)}evaluate(e){var t;const a=(t=e.globals)===null||t===void 0?void 0:t.globalState;return!a||Object.keys(a).length===0?null:Qy(a,this.key)}eachChild(){}outputDefined(){return!1}}const n2={"==":O6,"!=":N6,">":V6,"<":B6,">=":U6,"<=":F6,array:oc,at:$w,boolean:oc,case:Hw,coalesce:y_,collator:_b,format:Kw,image:Ww,in:qw,"index-of":I0,interpolate:lh,"interpolate-hcl":lh,"interpolate-lab":lh,length:Xw,let:mb,literal:cg,match:Gw,number:oc,"number-format":Zw,object:oc,slice:C0,step:yb,string:oc,"to-boolean":rf,"to-color":rf,"to-number":rf,"to-string":rf,var:gb,within:Rp,distance:kp,"global-state":$_};class hc{constructor(e,t,a,d){this.name=e,this.type=t,this._evaluate=a,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const a=e[0],d=hc.definitions[a];if(!d)return t.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,c=y.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let P=null;for(const[k,B]of c){P=new pb(t.registry,k0,t.path,null,t.scope);const X=[];let G=!1;for(let W=1;W<e.length;W++){const ie=e[W],Ie=Array.isArray(k)?k[W-1]:k.type,Re=P.parse(ie,1+X.length,Ie);if(!Re){G=!0;break}X.push(Re)}if(!G){if(Array.isArray(k)&&k.length!==X.length){P.error(`Expected ${k.length} arguments, but found ${X.length} instead.`);continue}for(let W=0;W<X.length;W++){const ie=Array.isArray(k)?k[W]:k.type,Ie=X[W];P.concat(W+1).checkSubtype(ie,Ie.type)}if(P.errors.length===0)return new hc(a,m,B,X)}}if(c.length===1)t.errors.push(...P.errors);else{const k=(c.length?c:y).map(([X])=>pB(X)).join(" | "),B=[];for(let X=1;X<e.length;X++){const G=t.parse(e[X],1+B.length);if(!G)return null;B.push($i(G.type))}t.error(`Expected arguments of type ${k}, but found (${B.join(", ")}) instead.`)}return null}static register(e,t){hc.definitions=t;for(const a in t)e[a]=hc}}function $S(r,[e,t,a,d]){e=e.evaluate(r),t=t.evaluate(r),a=a.evaluate(r);const m=d?d.evaluate(r):1,y=eP(e,t,a,m);if(y)throw new Ji(y);return new qi(e/255,t/255,a/255,m,!1)}function qS(r,e){return r in e}function fx(r,e){const t=e[r];return typeof t>"u"?null:t}function fB(r,e,t,a){for(;t<=a;){const d=t+a>>1;if(e[d]===r)return!0;e[d]>r?a=d-1:t=d+1}return!1}function bp(r){return{type:r}}hc.register(n2,{error:[o6,[Xn],(r,[e])=>{throw new Ji(e.evaluate(r))}],typeof:[Xn,[Fn],(r,[e])=>$i(La(e.evaluate(r)))],"to-rgba":[Cl(Ut,4),[sh],(r,[e])=>{const[t,a,d,m]=e.evaluate(r).rgb;return[t*255,a*255,d*255,m]}],rgb:[sh,[Ut,Ut,Ut],$S],rgba:[sh,[Ut,Ut,Ut,Ut],$S],has:{type:Hn,overloads:[[[Xn],(r,[e])=>qS(e.evaluate(r),r.properties())],[[Xn,Cp],(r,[e,t])=>qS(e.evaluate(r),t.evaluate(r))]]},get:{type:Fn,overloads:[[[Xn],(r,[e])=>fx(e.evaluate(r),r.properties())],[[Xn,Cp],(r,[e,t])=>fx(e.evaluate(r),t.evaluate(r))]]},"feature-state":[Fn,[Xn],(r,[e])=>fx(e.evaluate(r),r.featureState||{})],properties:[Cp,[],r=>r.properties()],"geometry-type":[Xn,[],r=>r.geometryType()],id:[Fn,[],r=>r.id()],zoom:[Ut,[],r=>r.globals.zoom],"heatmap-density":[Ut,[],r=>r.globals.heatmapDensity||0],elevation:[Ut,[],r=>r.globals.elevation||0],"line-progress":[Ut,[],r=>r.globals.lineProgress||0],accumulated:[Fn,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Ut,bp(Ut),(r,e)=>{let t=0;for(const a of e)t+=a.evaluate(r);return t}],"*":[Ut,bp(Ut),(r,e)=>{let t=1;for(const a of e)t*=a.evaluate(r);return t}],"-":{type:Ut,overloads:[[[Ut,Ut],(r,[e,t])=>e.evaluate(r)-t.evaluate(r)],[[Ut],(r,[e])=>-e.evaluate(r)]]},"/":[Ut,[Ut,Ut],(r,[e,t])=>e.evaluate(r)/t.evaluate(r)],"%":[Ut,[Ut,Ut],(r,[e,t])=>e.evaluate(r)%t.evaluate(r)],ln2:[Ut,[],()=>Math.LN2],pi:[Ut,[],()=>Math.PI],e:[Ut,[],()=>Math.E],"^":[Ut,[Ut,Ut],(r,[e,t])=>Math.pow(e.evaluate(r),t.evaluate(r))],sqrt:[Ut,[Ut],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Ut,[Ut],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Ut,[Ut],(r,[e])=>Math.log(e.evaluate(r))],log2:[Ut,[Ut],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Ut,[Ut],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Ut,[Ut],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Ut,[Ut],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Ut,[Ut],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Ut,[Ut],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Ut,[Ut],(r,[e])=>Math.atan(e.evaluate(r))],min:[Ut,bp(Ut),(r,e)=>Math.min(...e.map(t=>t.evaluate(r)))],max:[Ut,bp(Ut),(r,e)=>Math.max(...e.map(t=>t.evaluate(r)))],abs:[Ut,[Ut],(r,[e])=>Math.abs(e.evaluate(r))],round:[Ut,[Ut],(r,[e])=>{const t=e.evaluate(r);return t<0?-Math.round(-t):Math.round(t)}],floor:[Ut,[Ut],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Ut,[Ut],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[Hn,[Xn,Fn],(r,[e,t])=>r.properties()[e.value]===t.value],"filter-id-==":[Hn,[Fn],(r,[e])=>r.id()===e.value],"filter-type-==":[Hn,[Xn],(r,[e])=>r.geometryType()===e.value],"filter-<":[Hn,[Xn,Fn],(r,[e,t])=>{const a=r.properties()[e.value],d=t.value;return typeof a==typeof d&&a<d}],"filter-id-<":[Hn,[Fn],(r,[e])=>{const t=r.id(),a=e.value;return typeof t==typeof a&&t<a}],"filter->":[Hn,[Xn,Fn],(r,[e,t])=>{const a=r.properties()[e.value],d=t.value;return typeof a==typeof d&&a>d}],"filter-id->":[Hn,[Fn],(r,[e])=>{const t=r.id(),a=e.value;return typeof t==typeof a&&t>a}],"filter-<=":[Hn,[Xn,Fn],(r,[e,t])=>{const a=r.properties()[e.value],d=t.value;return typeof a==typeof d&&a<=d}],"filter-id-<=":[Hn,[Fn],(r,[e])=>{const t=r.id(),a=e.value;return typeof t==typeof a&&t<=a}],"filter->=":[Hn,[Xn,Fn],(r,[e,t])=>{const a=r.properties()[e.value],d=t.value;return typeof a==typeof d&&a>=d}],"filter-id->=":[Hn,[Fn],(r,[e])=>{const t=r.id(),a=e.value;return typeof t==typeof a&&t>=a}],"filter-has":[Hn,[Fn],(r,[e])=>e.value in r.properties()],"filter-has-id":[Hn,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Hn,[Cl(Xn)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[Hn,[Cl(Fn)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[Hn,[Xn,Cl(Fn)],(r,[e,t])=>t.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[Hn,[Xn,Cl(Fn)],(r,[e,t])=>fB(r.properties()[e.value],t.value,0,t.value.length-1)],all:{type:Hn,overloads:[[[Hn,Hn],(r,[e,t])=>e.evaluate(r)&&t.evaluate(r)],[bp(Hn),(r,e)=>{for(const t of e)if(!t.evaluate(r))return!1;return!0}]]},any:{type:Hn,overloads:[[[Hn,Hn],(r,[e,t])=>e.evaluate(r)||t.evaluate(r)],[bp(Hn),(r,e)=>{for(const t of e)if(t.evaluate(r))return!0;return!1}]]},"!":[Hn,[Hn],(r,[e])=>!e.evaluate(r)],"is-supported-script":[Hn,[Xn],(r,[e])=>{const t=r.globals&&r.globals.isSupportedScript;return t?t(e.evaluate(r)):!0}],upcase:[Xn,[Xn],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[Xn,[Xn],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[Xn,bp(Fn),(r,e)=>e.map(t=>Jy(t.evaluate(r))).join("")],"resolved-locale":[Xn,[ub],(r,[e])=>e.evaluate(r).resolvedLocale()]});function pB(r){return Array.isArray(r)?`(${r.map($i).join(", ")})`:`(${$i(r.type)}...)`}function k0(r){if(r instanceof gb)return k0(r.boundExpression);if(r instanceof hc&&r.name==="error"||r instanceof _b||r instanceof Rp||r instanceof kp||r instanceof $_)return!1;const e=r instanceof rf||r instanceof oc;let t=!0;return r.eachChild(a=>{e?t=t&&k0(a):t=t&&a instanceof cg}),t?bb(r)&&xb(r,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function bb(r){if(r instanceof hc&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Rp||r instanceof kp)return!1;let e=!0;return r.eachChild(t=>{e&&!bb(t)&&(e=!1)}),e}function v_(r){if(r instanceof hc&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(t=>{e&&!v_(t)&&(e=!1)}),e}function xb(r,e){if(r instanceof hc&&e.indexOf(r.name)>=0)return!1;let t=!0;return r.eachChild(a=>{t&&!xb(a,e)&&(t=!1)}),t}function d1(r){return{result:"success",value:r}}function jm(r){return{result:"error",value:r}}function D0(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function cP(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function hP(r){return!!r.expression&&r.expression.interpolated}function sr(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function r2(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&La(r)===Cp}class mB{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new tP,this._defaultValue=t?_B(t):null,this._enumValues=t&&t.type==="enum"?t.values:null}evaluateWithoutErrorHandling(e,t,a,d,m,y){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=a,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,t,a,d,m,y){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=a||null,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const c=this.expression.evaluate(this._evaluator);if(c==null||typeof c=="number"&&c!==c)return this._defaultValue;if(this._enumValues&&!(c in this._enumValues))throw new Ji(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(c)} instead.`);return c}catch(c){return this._warningHistory[c.message]||(this._warningHistory[c.message]=!0,typeof console<"u"&&console.warn(c.message)),this._defaultValue}}}function dP(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in n2}function fP(r,e){const t=new pb(n2,k0,[],e?yB(e):void 0),a=t.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?d1(new mB(a,e)):jm(t.errors)}class GS{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!v_(t.expression),this.globalStateRefs=i2(t.expression)}evaluateWithoutErrorHandling(e,t,a,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,t,a,d,m,y)}evaluate(e,t,a,d,m,y){return this._styleExpression.evaluate(e,t,a,d,m,y)}}class HS{constructor(e,t,a,d){this.kind=e,this.zoomStops=a,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!v_(t.expression),this.globalStateRefs=i2(t.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,t,a,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,t,a,d,m,y)}evaluate(e,t,a,d,m,y){return this._styleExpression.evaluate(e,t,a,d,m,y)}interpolationFactor(e,t,a){return this.interpolationType?lh.interpolationFactor(this.interpolationType,e,t,a):0}}function gB(r,e){const t=fP(r,e);if(t.result==="error")return t;const a=t.value.expression,d=bb(a);if(!d&&!D0(e))return jm([new Jc("","data expressions not supported")]);const m=xb(a,["zoom"]);if(!m&&!cP(e))return jm([new Jc("","zoom expressions not supported")]);const y=t0(a);if(!y&&!m)return jm([new Jc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(y instanceof Jc)return jm([y]);if(y instanceof lh&&!hP(e))return jm([new Jc("",'"interpolate" expressions cannot be used with this property')]);if(!y)return d1(d?new GS("constant",t.value):new GS("source",t.value));const c=y instanceof lh?y.interpolation:void 0;return d1(d?new HS("camera",t.value,y.labels,c):new HS("composite",t.value,y.labels,c))}function t0(r){let e=null;if(r instanceof mb)e=t0(r.result);else if(r instanceof y_){for(const t of r.args)if(e=t0(t),e)break}else(r instanceof yb||r instanceof lh)&&r.input instanceof hc&&r.input.name==="zoom"&&(e=r);return e instanceof Jc||r.eachChild(t=>{const a=t0(t);a instanceof Jc?e=a:!e&&a?e=new Jc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new Jc("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function i2(r,e=new Set){return r instanceof $_&&e.add(r.key),r.eachChild(t=>{i2(t,e)}),e}function yB(r){const e={color:sh,string:Xn,number:Ut,enum:Xn,boolean:Hn,formatted:cb,padding:hb,numberArray:db,colorArray:f_,projectionDefinition:lb,resolvedImage:U_,variableAnchorOffsetCollection:fb};return r.type==="array"?Cl(e[r.value]||Fn,r.length):e[r.type]}function _B(r){if(r.type==="color"&&r2(r.default))return new qi(0,0,0,0);switch(r.type){case"color":return qi.parse(r.default)||null;case"padding":return uc.parse(r.default)||null;case"numberArray":return cc.parse(r.default)||null;case"colorArray":return Ml.parse(r.default)||null;case"variableAnchorOffsetCollection":return oh.parse(r.default)||null;case"projectionDefinition":return sc.parse(r.default)||null;default:return r.default===void 0?null:r.default}}function pP(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!pP(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function mP(r){const e=r.key,t=r.value;return t?[new zt(e,t,"constants have been deprecated as of v8")]:[]}function ca(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Vp(r){if(Array.isArray(r))return r.map(Vp);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const t in r)e[t]=Vp(r[t]);return e}return ca(r)}function gu(r){const e=r.key,t=r.value,a=r.valueSpec||{},d=r.objectElementValidators||{},m=r.style,y=r.styleSpec,c=r.validateSpec;let P=[];const k=sr(t);if(k!=="object")return[new zt(e,t,`object expected, ${k} found`)];for(const B in t){const X=B.split(".")[0],G=Qy(a,X)||a["*"];let W;if(Qy(d,X))W=d[X];else if(Qy(a,X))W=c;else if(d["*"])W=d["*"];else if(a["*"])W=c;else{P.push(new zt(e,t[B],`unknown property "${B}"`));continue}P=P.concat(W({key:(e&&`${e}.`)+B,value:t[B],valueSpec:G,style:m,styleSpec:y,object:t,objectKey:B,validateSpec:c},t))}for(const B in a)d[B]||a[B].required&&a[B].default===void 0&&t[B]===void 0&&P.push(new zt(e,t,`missing required property "${B}"`));return P}function a2(r){const e=r.value,t=r.valueSpec,a=r.validateSpec,d=r.style,m=r.styleSpec,y=r.key,c=r.arrayElementValidator||a;if(sr(e)!=="array")return[new zt(y,e,`array expected, ${sr(e)} found`)];if(t.length&&e.length!==t.length)return[new zt(y,e,`array length ${t.length} expected, length ${e.length} found`)];if(t["min-length"]&&e.length<t["min-length"])return[new zt(y,e,`array length at least ${t["min-length"]} expected, length ${e.length} found`)];let P={type:t.value,values:t.values};m.$version<7&&(P.function=t.function),sr(t.value)==="object"&&(P=t.value);let k=[];for(let B=0;B<e.length;B++)k=k.concat(c({array:e,arrayIndex:B,value:e[B],valueSpec:P,validateSpec:r.validateSpec,style:d,styleSpec:m,key:`${y}[${B}]`}));return k}function wb(r){const e=r.key,t=r.value,a=r.valueSpec;let d=sr(t);return d==="number"&&t!==t&&(d="NaN"),d!=="number"?[new zt(e,t,`number expected, ${d} found`)]:"minimum"in a&&t<a.minimum?[new zt(e,t,`${t} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&t>a.maximum?[new zt(e,t,`${t} is greater than the maximum value ${a.maximum}`)]:[]}function gP(r){const e=r.valueSpec,t=ca(r.value.type);let a,d={},m,y;const c=t!=="categorical"&&r.value.property===void 0,P=!c,k=sr(r.value.stops)==="array"&&sr(r.value.stops[0])==="array"&&sr(r.value.stops[0][0])==="object",B=gu({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:X,default:ie}});return t==="identity"&&c&&B.push(new zt(r.key,r.value,'missing required property "property"')),t!=="identity"&&!r.value.stops&&B.push(new zt(r.key,r.value,'missing required property "stops"')),t==="exponential"&&r.valueSpec.expression&&!hP(r.valueSpec)&&B.push(new zt(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(P&&!D0(r.valueSpec)?B.push(new zt(r.key,r.value,"property functions not supported")):c&&!cP(r.valueSpec)&&B.push(new zt(r.key,r.value,"zoom functions not supported"))),(t==="categorical"||k)&&r.value.property===void 0&&B.push(new zt(r.key,r.value,'"property" property is required')),B;function X(Ie){if(t==="identity")return[new zt(Ie.key,Ie.value,'identity function may not have a "stops" property')];let Re=[];const Oe=Ie.value;return Re=Re.concat(a2({key:Ie.key,value:Oe,valueSpec:Ie.valueSpec,validateSpec:Ie.validateSpec,style:Ie.style,styleSpec:Ie.styleSpec,arrayElementValidator:G})),sr(Oe)==="array"&&Oe.length===0&&Re.push(new zt(Ie.key,Oe,"array must have at least one stop")),Re}function G(Ie){let Re=[];const Oe=Ie.value,Ke=Ie.key;if(sr(Oe)!=="array")return[new zt(Ke,Oe,`array expected, ${sr(Oe)} found`)];if(Oe.length!==2)return[new zt(Ke,Oe,`array length 2 expected, length ${Oe.length} found`)];if(k){if(sr(Oe[0])!=="object")return[new zt(Ke,Oe,`object expected, ${sr(Oe[0])} found`)];if(Oe[0].zoom===void 0)return[new zt(Ke,Oe,"object stop key must have zoom")];if(Oe[0].value===void 0)return[new zt(Ke,Oe,"object stop key must have value")];if(y&&y>ca(Oe[0].zoom))return[new zt(Ke,Oe[0].zoom,"stop zoom values must appear in ascending order")];ca(Oe[0].zoom)!==y&&(y=ca(Oe[0].zoom),m=void 0,d={}),Re=Re.concat(gu({key:`${Ke}[0]`,value:Oe[0],valueSpec:{zoom:{}},validateSpec:Ie.validateSpec,style:Ie.style,styleSpec:Ie.styleSpec,objectElementValidators:{zoom:wb,value:W}}))}else Re=Re.concat(W({key:`${Ke}[0]`,value:Oe[0],validateSpec:Ie.validateSpec,style:Ie.style,styleSpec:Ie.styleSpec},Oe));return dP(Vp(Oe[1]))?Re.concat([new zt(`${Ke}[1]`,Oe[1],"expressions are not allowed in function stops.")]):Re.concat(Ie.validateSpec({key:`${Ke}[1]`,value:Oe[1],valueSpec:e,validateSpec:Ie.validateSpec,style:Ie.style,styleSpec:Ie.styleSpec}))}function W(Ie,Re){const Oe=sr(Ie.value),Ke=ca(Ie.value),mt=Ie.value!==null?Ie.value:Re;if(!a)a=Oe;else if(Oe!==a)return[new zt(Ie.key,mt,`${Oe} stop domain type must match previous stop domain type ${a}`)];if(Oe!=="number"&&Oe!=="string"&&Oe!=="boolean")return[new zt(Ie.key,mt,"stop domain value must be a number, string, or boolean")];if(Oe!=="number"&&t!=="categorical"){let qe=`number expected, ${Oe} found`;return D0(e)&&t===void 0&&(qe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new zt(Ie.key,mt,qe)]}return t==="categorical"&&Oe==="number"&&(!isFinite(Ke)||Math.floor(Ke)!==Ke)?[new zt(Ie.key,mt,`integer expected, found ${Ke}`)]:t!=="categorical"&&Oe==="number"&&m!==void 0&&Ke<m?[new zt(Ie.key,mt,"stop domain values must appear in ascending order")]:(m=Ke,t==="categorical"&&Ke in d?[new zt(Ie.key,mt,"stop domain values must be unique")]:(d[Ke]=!0,[]))}function ie(Ie){return Ie.validateSpec({key:Ie.key,value:Ie.value,valueSpec:e,validateSpec:Ie.validateSpec,style:Ie.style,styleSpec:Ie.styleSpec})}}function hg(r){const e=(r.expressionContext==="property"?gB:fP)(Vp(r.value),r.valueSpec);if(e.result==="error")return e.value.map(a=>new zt(`${r.key}${a.key}`,r.value,a.message));const t=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!t.outputDefined())return[new zt(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!v_(t))return[new zt(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!v_(t))return[new zt(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!xb(t,["zoom","feature-state"]))return[new zt(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!bb(t))return[new zt(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vB(r){const e=r.value,t=r.key,a=sr(e);return a!=="boolean"?[new zt(t,e,`boolean expected, ${a} found`)]:[]}function f1(r){const e=r.key,t=r.value,a=sr(t);return a!=="string"?[new zt(e,t,`color expected, ${a} found`)]:qi.parse(String(t))?[]:[new zt(e,t,`color expected, "${t}" found`)]}function b_(r){const e=r.key,t=r.value,a=r.valueSpec,d=[];return Array.isArray(a.values)?a.values.indexOf(ca(t))===-1&&d.push(new zt(e,t,`expected one of [${a.values.join(", ")}], ${JSON.stringify(t)} found`)):Object.keys(a.values).indexOf(ca(t))===-1&&d.push(new zt(e,t,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(t)} found`)),d}function s2(r){return pP(Vp(r.value))?hg(A0({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):yP(r)}function yP(r){const e=r.value,t=r.key;if(sr(e)!=="array")return[new zt(t,e,`array expected, ${sr(e)} found`)];const a=r.styleSpec;let d,m=[];if(e.length<1)return[new zt(t,e,"filter array must have at least 1 element")];switch(m=m.concat(b_({key:`${t}[0]`,value:e[0],valueSpec:a.filter_operator,style:r.style,styleSpec:r.styleSpec})),ca(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ca(e[1])==="$type"&&m.push(new zt(t,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new zt(t,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=sr(e[1]),d!=="string"&&m.push(new zt(`${t}[1]`,e[1],`string expected, ${d} found`)));for(let y=2;y<e.length;y++)d=sr(e[y]),ca(e[1])==="$type"?m=m.concat(b_({key:`${t}[${y}]`,value:e[y],valueSpec:a.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&m.push(new zt(`${t}[${y}]`,e[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(yP({key:`${t}[${y}]`,value:e[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=sr(e[1]),e.length!==2?m.push(new zt(t,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&m.push(new zt(`${t}[1]`,e[1],`string expected, ${d} found`));break}return m}function _P(r,e){const t=r.key,a=r.validateSpec,d=r.style,m=r.styleSpec,y=r.value,c=r.objectKey,P=m[`${e}_${r.layerType}`];if(!P)return[];const k=c.match(/^(.*)-transition$/);if(e==="paint"&&k&&P[k[1]]&&P[k[1]].transition)return a({key:t,value:y,valueSpec:m.transition,style:d,styleSpec:m});const B=r.valueSpec||P[c];if(!B)return[new zt(t,y,`unknown property "${c}"`)];let X;if(sr(y)==="string"&&D0(B)&&!B.tokens&&(X=/^{([^}]+)}$/.exec(y)))return[new zt(t,y,`"${c}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(X[1])} }\`.`)];const G=[];return r.layerType==="symbol"&&(c==="text-field"&&d&&!d.glyphs&&G.push(new zt(t,y,'use of "text-field" requires a style "glyphs" property')),c==="text-font"&&r2(Vp(y))&&ca(y.type)==="identity"&&G.push(new zt(t,y,'"text-font" does not support identity functions'))),G.concat(a({key:r.key,value:y,valueSpec:B,style:d,styleSpec:m,expressionContext:"property",propertyType:e,propertyKey:c}))}function vP(r){return _P(r,"paint")}function bP(r){return _P(r,"layout")}function xP(r){let e=[];const t=r.value,a=r.key,d=r.style,m=r.styleSpec;if(sr(t)!=="object")return[new zt(a,t,`object expected, ${sr(t)} found`)];!t.type&&!t.ref&&e.push(new zt(a,t,'either "type" or "ref" is required'));let y=ca(t.type);const c=ca(t.ref);if(t.id){const P=ca(t.id);for(let k=0;k<r.arrayIndex;k++){const B=d.layers[k];ca(B.id)===P&&e.push(new zt(a,t.id,`duplicate layer id "${t.id}", previously used at line ${B.id.__line__}`))}}if("ref"in t){["type","source","source-layer","filter","layout"].forEach(k=>{k in t&&e.push(new zt(a,t[k],`"${k}" is prohibited for ref layers`))});let P;d.layers.forEach(k=>{ca(k.id)===c&&(P=k)}),P?P.ref?e.push(new zt(a,t.ref,"ref cannot reference another ref layer")):y=ca(P.type):e.push(new zt(a,t.ref,`ref layer "${c}" not found`))}else if(y!=="background")if(!t.source)e.push(new zt(a,t,'missing required property "source"'));else{const P=d.sources&&d.sources[t.source],k=P&&ca(P.type);P?k==="vector"&&y==="raster"?e.push(new zt(a,t.source,`layer "${t.id}" requires a raster source`)):k!=="raster-dem"&&y==="hillshade"?e.push(new zt(a,t.source,`layer "${t.id}" requires a raster-dem source`)):k!=="raster-dem"&&y==="color-relief"?e.push(new zt(a,t.source,`layer "${t.id}" requires a raster-dem source`)):k==="raster"&&y!=="raster"?e.push(new zt(a,t.source,`layer "${t.id}" requires a vector source`)):k==="vector"&&!t["source-layer"]?e.push(new zt(a,t,`layer "${t.id}" must specify a "source-layer"`)):k==="raster-dem"&&y!=="hillshade"&&y!=="color-relief"?e.push(new zt(a,t.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):y==="line"&&t.paint&&t.paint["line-gradient"]&&(k!=="geojson"||!P.lineMetrics)&&e.push(new zt(a,t,`layer "${t.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new zt(a,t.source,`source "${t.source}" not found`))}return e=e.concat(gu({key:a,value:t,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*"(){return[]},type(){return r.validateSpec({key:`${a}.type`,value:t.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:t,objectKey:"type"})},filter:s2,layout(P){return gu({layer:t,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*"(k){return bP(A0({layerType:y},k))}}})},paint(P){return gu({layer:t,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*"(k){return vP(A0({layerType:y},k))}}})}}})),e}function Fp(r){const e=r.value,t=r.key,a=sr(e);return a!=="string"?[new zt(t,e,`string expected, ${a} found`)]:[]}function bB(r){var e;const t=(e=r.sourceName)!==null&&e!==void 0?e:"",a=r.value,d=r.styleSpec,m=d.source_raster_dem,y=r.style;let c=[];const P=sr(a);if(a===void 0)return c;if(P!=="object")return c.push(new zt("source_raster_dem",a,`object expected, ${P} found`)),c;const k=ca(a.encoding)==="custom",B=["redFactor","greenFactor","blueFactor","baseShift"],X=r.value.encoding?`"${r.value.encoding}"`:"Default";for(const G in a)!k&&B.includes(G)?c.push(new zt(G,a[G],`In "${t}": "${G}" is only valid when "encoding" is set to "custom". ${X} encoding found`)):m[G]?c=c.concat(r.validateSpec({key:G,value:a[G],valueSpec:m[G],validateSpec:r.validateSpec,style:y,styleSpec:d})):c.push(new zt(G,a[G],`unknown property "${G}"`));return c}const ZS={promoteId:xB};function wP(r){const e=r.value,t=r.key,a=r.styleSpec,d=r.style,m=r.validateSpec;if(!e.type)return[new zt(t,e,'"type" is required')];const y=ca(e.type);let c;switch(y){case"vector":case"raster":return c=gu({key:t,value:e,valueSpec:a[`source_${y.replace("-","_")}`],style:r.style,styleSpec:a,objectElementValidators:ZS,validateSpec:m}),c;case"raster-dem":return c=bB({sourceName:t,value:e,style:r.style,styleSpec:a,validateSpec:m}),c;case"geojson":if(c=gu({key:t,value:e,valueSpec:a.source_geojson,style:d,styleSpec:a,validateSpec:m,objectElementValidators:ZS}),e.cluster)for(const P in e.clusterProperties){const[k,B]=e.clusterProperties[P],X=typeof k=="string"?[k,["accumulated"],["get",P]]:k;c.push(...hg({key:`${t}.${P}.map`,value:B,expressionContext:"cluster-map"})),c.push(...hg({key:`${t}.${P}.reduce`,value:X,expressionContext:"cluster-reduce"}))}return c;case"video":return gu({key:t,value:e,valueSpec:a.source_video,style:d,validateSpec:m,styleSpec:a});case"image":return gu({key:t,value:e,valueSpec:a.source_image,style:d,validateSpec:m,styleSpec:a});case"canvas":return[new zt(t,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return b_({key:`${t}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function xB({key:r,value:e}){if(sr(e)==="string")return Fp({key:r,value:e});{const t=[];for(const a in e)t.push(...Fp({key:`${r}.${a}`,value:e[a]}));return t}}function TP(r){const e=r.value,t=r.styleSpec,a=t.light,d=r.style;let m=[];const y=sr(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new zt("light",e,`object expected, ${y} found`)]),m;for(const c in e){const P=c.match(/^(.*)-transition$/);P&&a[P[1]]&&a[P[1]].transition?m=m.concat(r.validateSpec({key:c,value:e[c],valueSpec:t.transition,validateSpec:r.validateSpec,style:d,styleSpec:t})):a[c]?m=m.concat(r.validateSpec({key:c,value:e[c],valueSpec:a[c],validateSpec:r.validateSpec,style:d,styleSpec:t})):m=m.concat([new zt(c,e[c],`unknown property "${c}"`)])}return m}function SP(r){const e=r.value,t=r.styleSpec,a=t.sky,d=r.style,m=sr(e);if(e===void 0)return[];if(m!=="object")return[new zt("sky",e,`object expected, ${m} found`)];let y=[];for(const c in e)a[c]?y=y.concat(r.validateSpec({key:c,value:e[c],valueSpec:a[c],style:d,styleSpec:t})):y=y.concat([new zt(c,e[c],`unknown property "${c}"`)]);return y}function EP(r){const e=r.value,t=r.styleSpec,a=t.terrain,d=r.style;let m=[];const y=sr(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new zt("terrain",e,`object expected, ${y} found`)]),m;for(const c in e)a[c]?m=m.concat(r.validateSpec({key:c,value:e[c],valueSpec:a[c],validateSpec:r.validateSpec,style:d,styleSpec:t})):m=m.concat([new zt(c,e[c],`unknown property "${c}"`)]);return m}function wB(r){return Fp(r).length===0?[]:hg(r)}function TB(r){return Fp(r).length===0?[]:hg(r)}function SB(r){const e=r.key,t=r.value;if(sr(t)==="array"){if(t.length<1||t.length>4)return[new zt(e,t,`padding requires 1 to 4 values; ${t.length} values found`)];const a={type:"number"};let d=[];for(let m=0;m<t.length;m++)d=d.concat(r.validateSpec({key:`${e}[${m}]`,value:t[m],validateSpec:r.validateSpec,valueSpec:a}));return d}else return wb({key:e,value:t,valueSpec:{}})}function EB(r){const e=r.key,t=r.value;if(sr(t)==="array"){const a={type:"number"};if(t.length<1)return[new zt(e,t,"array length at least 1 expected, length 0 found")];let d=[];for(let m=0;m<t.length;m++)d=d.concat(r.validateSpec({key:`${e}[${m}]`,value:t[m],validateSpec:r.validateSpec,valueSpec:a}));return d}else return wb({key:e,value:t,valueSpec:{}})}function AB(r){const e=r.key,t=r.value;if(sr(t)==="array"){if(t.length<1)return[new zt(e,t,"array length at least 1 expected, length 0 found")];let a=[];for(let d=0;d<t.length;d++)a=a.concat(f1({key:`${e}[${d}]`,value:t[d]}));return a}else return f1({key:e,value:t})}function IB(r){const e=r.key,t=r.value,a=sr(t),d=r.styleSpec;if(a!=="array"||t.length<1||t.length%2!==0)return[new zt(e,t,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let y=0;y<t.length;y+=2)m=m.concat(b_({key:`${e}[${y}]`,value:t[y],valueSpec:d.layout_symbol["text-anchor"]})),m=m.concat(a2({key:`${e}[${y+1}]`,value:t[y+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:d}));return m}function AP(r){let e=[];const t=r.value,a=r.key;if(Array.isArray(t)){const d=[],m=[];for(const y in t){t[y].id&&d.includes(t[y].id)&&e.push(new zt(a,t,`all the sprites' ids must be unique, but ${t[y].id} is duplicated`)),d.push(t[y].id),t[y].url&&m.includes(t[y].url)&&e.push(new zt(a,t,`all the sprites' URLs must be unique, but ${t[y].url} is duplicated`)),m.push(t[y].url);const c={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(gu({key:`${a}[${y}]`,value:t[y],valueSpec:c,validateSpec:r.validateSpec}))}return e}else return Fp({key:a,value:t})}function CB(r){const e=r.value,t=r.styleSpec,a=t.projection,d=r.style,m=sr(e);if(e===void 0)return[];if(m!=="object")return[new zt("projection",e,`object expected, ${m} found`)];let y=[];for(const c in e)a[c]?y=y.concat(r.validateSpec({key:c,value:e[c],valueSpec:a[c],style:d,styleSpec:t})):y=y.concat([new zt(c,e[c],`unknown property "${c}"`)]);return y}function PB(r){const e=r.key;let t=r.value;t=t instanceof String?t.valueOf():t;const a=sr(t);return a==="array"&&!RB(t)&&!MB(t)?[new zt(e,t,`projection expected, invalid array ${JSON.stringify(t)} found`)]:["array","string"].includes(a)?[]:[new zt(e,t,`projection expected, invalid type "${a}" found`)]}function MB(r){return!!["interpolate","step","literal"].includes(r[0])}function RB(r){return Array.isArray(r)&&r.length===3&&typeof r[0]=="string"&&typeof r[1]=="string"&&typeof r[2]=="number"}function kB(r){return!!r&&r.constructor===Object}function IP(r){return kB(r.value)?[]:[new zt(r.key,r.value,`object expected, ${sr(r.value)} found`)]}const KS={"*"(){return[]},array:a2,boolean:vB,number:wb,color:f1,constants:mP,enum:b_,filter:s2,function:gP,layer:xP,object:gu,source:wP,light:TP,sky:SP,terrain:EP,projection:CB,projectionDefinition:PB,string:Fp,formatted:wB,resolvedImage:TB,padding:SB,numberArray:EB,colorArray:AB,variableAnchorOffsetCollection:IB,sprite:AP,state:IP};function L0(r){const e=r.value,t=r.valueSpec,a=r.styleSpec;return r.validateSpec=L0,t.expression&&r2(ca(e))?gP(r):t.expression&&dP(Vp(e))?hg(r):t.type&&KS[t.type]?KS[t.type](r):gu(A0({},r,{valueSpec:t.type?a[t.type]:t}))}function CP(r){const e=r.value,t=r.key,a=Fp(r);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new zt(t,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new zt(t,e,'"glyphs" url must include a "{range}" token'))),a}function Rl(r,e=s6){let t=[];return t=t.concat(L0({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,validateSpec:L0,objectElementValidators:{glyphs:CP,"*"(){return[]}}})),r.constants&&(t=t.concat(mP({key:"constants",value:r.constants}))),PP(t)}Rl.source=yc(gc(wP));Rl.sprite=yc(gc(AP));Rl.glyphs=yc(gc(CP));Rl.light=yc(gc(TP));Rl.sky=yc(gc(SP));Rl.terrain=yc(gc(EP));Rl.state=yc(gc(IP));Rl.layer=yc(gc(xP));Rl.filter=yc(gc(s2));Rl.paintProperty=yc(gc(vP));Rl.layoutProperty=yc(gc(bP));function gc(r){return function(e){return r({...e,validateSpec:L0})}}function PP(r){return[].concat(r).sort((e,t)=>e.line-t.line)}function yc(r){return function(...e){return PP(r.apply(this,e))}}function WS(r){if(!r)return{style:Yy[Xy[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0};if(typeof r=="string"){const e=LB(r);return e.isValidStyle?{style:e.styleObject,requiresUrlMonitoring:!1,isFallback:!1}:e.isValidJSON?{style:Yy[Xy[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}:r.startsWith("http")?{style:r,requiresUrlMonitoring:!0,isFallback:!1}:r.toLowerCase().includes(".json")?{style:DB(r),requiresUrlMonitoring:!0,isFallback:!1}:{style:CC(r),requiresUrlMonitoring:!0,isFallback:!1}}return r instanceof PC?{style:r.getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:r instanceof MC?{style:r.getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:Rl(r).length===0?{style:r,requiresUrlMonitoring:!1,isFallback:!1}:{style:Yy[Xy[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}}function DB(r){try{return new URL(r).href}catch{}return new URL(r,location.origin).href}function LB(r){try{const e=JSON.parse(r),t=Rl(e);return{isValidJSON:!0,isValidStyle:t.length===0,styleObject:t.length===0?e:null}}catch{return{isValidJSON:!1,isValidStyle:!1,styleObject:null}}}function Xh(r,e,t){const a=window.document.createElement(r);return e!==void 0&&(a.className=e),t&&t.appendChild(a),a}function o2(r){r.parentNode&&r.parentNode.removeChild(r)}class zB{constructor(){Un(this,"_map"),Un(this,"_container"),Un(this,"_terrainButton"),rN(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(e){return this._map=e,this._container=Xh("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Xh("button","maplibregl-ctrl-terrain",this._container),Xh("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){o2(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class OB extends mN{constructor(e={}){super({showCompass:e.showCompass??!0,showZoom:e.showZoom??!0,visualizePitch:e.visualizePitch??!0}),Un(this,"_rotateCompassArrow",()=>{const t=this._map.getBearing(),a=this._map.getPitch(),d=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(a*(Math.PI/180))**.5)}) rotateX(${Math.min(70,a)}deg) rotateZ(${-t}deg)`:`rotate(${-t}deg)`;this._compassIcon.style.transform=d}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",t=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}))}_createButton(e,t){const a=super._createButton(e,t);return a.clickFunction=t,a}}const XS=sn.Marker,YS=sn.LngLat,NB=sn.LngLatBounds;class BB extends gN{constructor(){super(...arguments),Un(this,"lastUpdatedCenter",new YS(0,0)),Un(this,"_updateCamera",e=>{var t;const a=new YS(e.coords.longitude,e.coords.latitude),d=e.coords.accuracy,m={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},y=this._map.getZoom();y>(((t=this.options.fitBoundsOptions)==null?void 0:t.maxZoom)??30)&&(m.zoom=y),this._map.fitBounds(NB.fromLngLat(a,d),m,{geolocateSource:!0});let c=!1;const P=()=>{c=!0};this._map.once("click",P),this._map.once("dblclick",P),this._map.once("dragstart",P),this._map.once("mousedown",P),this._map.once("touchstart",P),this._map.once("wheel",P),this._map.once("moveend",()=>{this._map.off("click",P),this._map.off("dblclick",P),this._map.off("dragstart",P),this._map.off("mousedown",P),this._map.off("touchstart",P),this._map.off("wheel",P),!c&&(this.lastUpdatedCenter=this._map.getCenter())})}),Un(this,"_finishSetupUI",e=>{if(this._map){if(e===!1){const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Xh("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new XS({element:this._dotElement}),this._circleElement=Xh("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new XS({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",t=>{const a=t.originalEvent&&t.originalEvent.type==="resize",d=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!t.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!a&&d>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),Un(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const e=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],t=this._map.project(e),a=this._map.unproject([t.x,t.y]),d=this._map.unproject([t.x+20,t.y]),m=a.distanceTo(d)/20,y=Math.ceil(2*this._accuracy/m);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;case"BACKGROUND_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}}var Il,Xc,wp,Tp,fu,n0,Io,MP,pu,RP;class px{constructor(e,t){vp(this,Io),vp(this,Il),Un(this,"map"),vp(this,Xc),vp(this,wp),vp(this,Tp),vp(this,fu,!1),vp(this,n0),e.style!==void 0&&Vm(this,fu,!0),Vm(this,Il,{zoomAdjust:-4,position:"top-right",...t,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...e,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...e.containerStyle??{}}}),e.lockZoom!==void 0&&(dr(this,Il).minZoom=e.lockZoom,dr(this,Il).maxZoom=e.lockZoom)}setStyle(e,t){dr(this,fu)||this.map.setStyle(e,t),Al(this,Io,pu).call(this)}addLayer(e,t){return dr(this,fu)||this.map.addLayer(e,t),Al(this,Io,pu).call(this),this.map}moveLayer(e,t){return dr(this,fu)||this.map.moveLayer(e,t),Al(this,Io,pu).call(this),this.map}removeLayer(e){return dr(this,fu)||this.map.removeLayer(e),Al(this,Io,pu).call(this),this}setLayerZoomRange(e,t,a){return dr(this,fu)||this.map.setLayerZoomRange(e,t,a),Al(this,Io,pu).call(this),this}setFilter(e,t,a){return dr(this,fu)||this.map.setFilter(e,t,a),Al(this,Io,pu).call(this),this}setPaintProperty(e,t,a,d){return dr(this,fu)||this.map.setPaintProperty(e,t,a,d),Al(this,Io,pu).call(this),this}setLayoutProperty(e,t,a,d){return dr(this,fu)||this.map.setLayoutProperty(e,t,a,d),Al(this,Io,pu).call(this),this}setGlyphs(e,t){return dr(this,fu)||this.map.setGlyphs(e,t),Al(this,Io,pu).call(this),this}onAdd(e){Vm(this,Xc,e),Vm(this,wp,Xh("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[t,a]of Object.entries(dr(this,Il).containerStyle))dr(this,wp).style.setProperty(t,a);return dr(this,Il).container=dr(this,wp),dr(this,Il).zoom=e.getZoom()+dr(this,Il).zoomAdjust,this.map=new kP(dr(this,Il)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{Al(this,Io,MP).call(this,dr(this,Il).parentRect),Vm(this,n0,Al(this,Io,RP).call(this))}),dr(this,wp)}onRemove(){var e;(e=dr(this,n0))==null||e.call(this),o2(dr(this,wp))}}Il=new WeakMap,Xc=new WeakMap,wp=new WeakMap,Tp=new WeakMap,fu=new WeakMap,n0=new WeakMap,Io=new WeakSet,MP=function(r){r===void 0||r.linePaint===void 0&&r.fillPaint===void 0||(Vm(this,Tp,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:dr(this,Tp)}),(r.lineLayout!==void 0||r.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...r.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...r.linePaint}}),r.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...r.fillPaint}}),Al(this,Io,pu).call(this))},pu=function(){if(dr(this,Tp)===void 0)return;const{devicePixelRatio:r}=window,e=dr(this,Xc).getCanvas(),t=e.width/r,a=e.height/r,d=dr(this,Xc).unproject.bind(dr(this,Xc)),m=d([0,0]),y=d([t,0]),c=d([0,a]),P=d([t,a]);dr(this,Tp).geometry.coordinates=[[c.toArray(),P.toArray(),y.toArray(),m.toArray(),c.toArray()]];const k=this.map.getSource("parentRect");k!==void 0&&k.setData(dr(this,Tp))},RP=function(){const{pitchAdjust:r}=dr(this,Il),e=()=>{m("parent")},t=()=>{m("minimap")},a=()=>{dr(this,Xc).on("move",e),this.map.on("move",t)},d=()=>{dr(this,Xc).off("move",e),this.map.off("move",t)},m=y=>{d();const c=y==="parent"?dr(this,Xc):this.map,P=y==="parent"?this.map:dr(this,Xc),k=c.getCenter(),B=c.getZoom()+dr(this,Il).zoomAdjust*(y==="parent"?1:-1),X=c.getBearing(),G=c.getPitch();P.jumpTo({center:k,zoom:B,bearing:X,pitch:r?G:0}),Al(this,Io,pu).call(this),a()};return a(),()=>{d()}};class VB{constructor(){Un(this,"map"),Un(this,"container"),Un(this,"projectionButton")}onAdd(e){return this.map=e,this.container=Xh("div","maplibregl-ctrl maplibregl-ctrl-group"),this.projectionButton=Xh("button","maplibregl-ctrl-projection",this.container),Xh("span","maplibregl-ctrl-icon",this.projectionButton).setAttribute("aria-hidden","true"),this.projectionButton.type="button",this.projectionButton.addEventListener("click",this.toggleProjection.bind(this)),e.on("projectiontransition",this.updateProjectionIcon.bind(this)),this.updateProjectionIcon(),this.container}onRemove(){o2(this.container),this.map.off("projectiontransition",this.updateProjectionIcon),this.map=void 0}toggleProjection(){this.map.getProjection()===void 0&&this.map.setProjection({type:"mercator"}),this.map.isGlobeProjection()?this.map.enableMercatorProjection():this.map.enableGlobeProjection(),this.updateProjectionIcon()}updateProjectionIcon(){this.projectionButton.classList.remove("maplibregl-ctrl-projection-globe"),this.projectionButton.classList.remove("maplibregl-ctrl-projection-mercator"),this.map.isGlobeProjection()?(this.projectionButton.classList.add("maplibregl-ctrl-projection-mercator"),this.projectionButton.title="Enable Mercator projection"):(this.projectionButton.classList.add("maplibregl-ctrl-projection-globe"),this.projectionButton.title="Enable Globe projection")}}const FB="3.3.0",UB={version:FB};class jB{constructor(e,t=2e3){Un(this,"map"),Un(this,"registeredModules",new Set),this.map=e,setTimeout(async()=>{if(!Ha.telemetry)return;const a=this.preparePayload();try{(await fetch(a,{method:"POST"})).ok||console.warn("The metrics could not be sent to MapTiler Cloud")}catch(d){console.warn("The metrics could not be sent to MapTiler Cloud",d)}},Math.max(1e3,t))}registerModule(e,t){this.registeredModules.add(`${e}:${t}`)}preparePayload(){const e=new URL(Po.telemetryURL);return e.searchParams.append("sdk",UB.version),e.searchParams.append("key",Ha.apiKey),e.searchParams.append("mtsid",Vw),e.searchParams.append("session",Ha.session?"1":"0"),e.searchParams.append("caching",Ha.caching?"1":"0"),e.searchParams.append("lang-updated",this.map.isLanguageUpdated()?"1":"0"),e.searchParams.append("terrain",this.map.getTerrain()?"1":"0"),e.searchParams.append("globe",this.map.isGlobeProjection()?"1":"0"),this.registeredModules.size>0&&e.searchParams.append("modules",Array.from(this.registeredModules).join("|")),e.href}}const $B={POINT:"POINT",COUNTRY:"COUNTRY"};let kP=class DP extends sn.Map{constructor(e){aN(e.container),e.apiKey&&(Ha.apiKey=e.apiKey);const{style:t,requiresUrlMonitoring:a,isFallback:d}=WS(e.style);d&&console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style."),Ha.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");const m=location.hash;let y={compact:!1};e.customAttribution?y.customAttribution=e.customAttribution:e.attributionControl&&typeof e.attributionControl=="object"&&(y={...y,...e.attributionControl});const c={...e,style:t,maplibreLogo:!1,transformRequest:AS(e.transformRequest),attributionControl:e.forceNoAttributionControl===!0?!1:y};delete c.style,super(c),Un(this,"options"),Un(this,"telemetry"),Un(this,"isTerrainEnabled",!1),Un(this,"terrainExaggeration",1),Un(this,"primaryLanguage"),Un(this,"terrainGrowing",!1),Un(this,"terrainFlattening",!1),Un(this,"minimap"),Un(this,"forceLanguageUpdate"),Un(this,"languageAlwaysBeenStyle"),Un(this,"isReady",!1),Un(this,"terrainAnimationDuration",1e3),Un(this,"monitoredStyleUrls"),Un(this,"styleInProcess",!1),Un(this,"curentProjection"),Un(this,"originalLabelStyle",new window.Map),Un(this,"isStyleLocalized",!1),Un(this,"languageIsUpdated",!1),this.options=e,this.setStyle(t),a&&this.monitorStyleUrl(t);const P=()=>{let W="The distant style could not be loaded.";this.getStyle()?W+="Leaving the style as is.":(this.setStyle(Yy.STREETS),W+=`Loading default MapTiler Cloud style "${Yy.STREETS.getDefaultVariant().getId()}" as a fallback.`),console.warn(W)};if(this.on("style.load",()=>{this.styleInProcess=!1}),this.on("error",W=>{if(W.error instanceof sn.AJAXError){const ie=W.error.url,Ie=new URL(ie);Ie.search="";const Re=Ie.href;this.monitoredStyleUrls&&this.monitoredStyleUrls.has(Re)&&(this.monitoredStyleUrls.delete(Re),P());return}if(this.styleInProcess){P();return}}),Ha.caching&&!a1&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),Ha.caching&&a1&&tN(),typeof e.language>"u")this.primaryLanguage=Ha.primaryLanguage;else{const W=dS(e.language,xr);this.primaryLanguage=W??Ha.primaryLanguage}this.forceLanguageUpdate=!(this.primaryLanguage===xr.STYLE||this.primaryLanguage===xr.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===xr.STYLE,this.terrainExaggeration=e.terrainExaggeration??this.terrainExaggeration,this.curentProjection=e.projection,this.on("styledata",()=>{this.curentProjection==="mercator"?this.setProjection({type:"mercator"}):this.curentProjection==="globe"&&this.setProjection({type:"globe"})}),this.once("styledata",async()=>{if(!e.geolocate||e.center||e.hash&&m)return;try{if(e.geolocate===$B.COUNTRY){await this.fitToIpBounds();return}}catch(ie){console.warn(ie.message)}let W;try{await this.centerOnIpPoint(e.zoom),W=this.getCameraHash()}catch(ie){console.warn(ie.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(ie=>{W===this.getCameraHash()&&(this.terrain?this.easeTo({center:[ie.coords.longitude,ie.coords.latitude],zoom:e.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[ie.coords.longitude,ie.coords.latitude],zoom:e.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let W={logo:null};try{const ie=Object.keys(this.style.sourceCaches).map(Re=>this.getSource(Re)).filter(Re=>Re&&"url"in Re&&typeof Re.url=="string"&&Re.url.includes("tiles.json")),Ie=new URL(ie[0].url);Ie.searchParams.has("key")||Ie.searchParams.append("key",Ha.apiKey),W=await(await fetch(Ie.href)).json()}catch{}if(e.forceNoAttributionControl!==!0)if("logo"in W&&W.logo){const ie=W.logo;this.addControl(new CS({logoURL:ie}),e.logoPosition)}else e.maptilerLogo&&this.addControl(new CS,e.logoPosition);if(e.scaleControl){const ie=e.scaleControl===!0||e.scaleControl===void 0?"bottom-right":e.scaleControl,Ie=new _N({unit:Ha.unit});this.addControl(Ie,ie),Ha.on("unit",Re=>{Ie.setUnit(Re)})}if(e.navigationControl!==!1){const ie=e.navigationControl===!0||e.navigationControl===void 0?"top-right":e.navigationControl;this.addControl(new OB,ie)}if(e.geolocateControl!==!1){const ie=e.geolocateControl===!0||e.geolocateControl===void 0?"top-right":e.geolocateControl;this.addControl(new BB({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),ie)}if(e.terrainControl){const ie=e.terrainControl===!0||e.terrainControl===void 0?"top-right":e.terrainControl;this.addControl(new zB,ie)}if(e.projectionControl){const ie=e.projectionControl===!0||e.projectionControl===void 0?"top-right":e.projectionControl;this.addControl(new VB,ie)}if(e.fullscreenControl){const ie=e.fullscreenControl===!0||e.fullscreenControl===void 0?"top-right":e.fullscreenControl;this.addControl(new vN({}),ie)}this.isReady=!0,this.fire("ready",{target:this})});let k=!1,B=!1,X;this.once("ready",()=>{k=!0,B&&this.fire("loadWithTerrain",X)}),this.once("style.load",()=>{const{minimap:W}=e;if(typeof W=="object"){const{zoom:ie,center:Ie,style:Re,language:Oe,apiKey:Ke,maptilerLogo:mt,canvasContextAttributes:qe,refreshExpiredTiles:Fe,maxBounds:We,scrollZoom:pe,minZoom:oe,maxZoom:me,boxZoom:be,locale:Ce,fadeDuration:Ve,crossSourceCollisions:Ee,clickTolerance:Yn,bounds:jn,fitBoundsOptions:gt,pixelRatio:Bt,validateStyle:nn}=e;this.minimap=new px(W,{zoom:ie,center:Ie,style:Re,language:Oe,apiKey:Ke,container:"null",maptilerLogo:mt,canvasContextAttributes:qe,refreshExpiredTiles:Fe,maxBounds:We,scrollZoom:pe,minZoom:oe,maxZoom:me,boxZoom:be,locale:Ce,fadeDuration:Ve,crossSourceCollisions:Ee,clickTolerance:Yn,bounds:jn,fitBoundsOptions:gt,pixelRatio:Bt,validateStyle:nn}),this.addControl(this.minimap,W.position??"bottom-left")}else W===!0?(this.minimap=new px({},e),this.addControl(this.minimap,"bottom-left")):W!==void 0&&W!==!1&&(this.minimap=new px({},e),this.addControl(this.minimap,W))});const G=W=>{W.terrain&&(B=!0,X={type:"loadWithTerrain",target:this,terrain:W.terrain},this.off("terrain",G),k&&this.fire("loadWithTerrain",X))};this.on("terrain",G),e.terrain&&this.enableTerrain(e.terrainExaggeration??this.terrainExaggeration),this.once("load",()=>{this.getCanvas().addEventListener("webglcontextlost",W=>{if(this._removed===!0){console.warn("[webglcontextlost]","WebGL context lost after map removal. This is harmless.");return}console.warn("[webglcontextlost]","Unexpected loss of WebGL context!"),this.fire("webglContextLost",W)})}),this.telemetry=new jB(this)}recreate(){const e={center:this.getCenter(),zoom:this.getZoom(),bearing:this.getBearing(),pitch:this.getPitch()};this.remove(),Object.assign(this,new DP({...this.options})),this.once("load",()=>{this.jumpTo(e)})}setTerrainAnimationDuration(e){this.terrainAnimationDuration=Math.max(e,0)}async onLoadAsync(){return new Promise(e=>{if(this.loaded()){e(this);return}this.once("load",()=>{e(this)})})}async onReadyAsync(){return new Promise(e=>{if(this.isReady){e(this);return}this.once("ready",()=>{e(this)})})}async onLoadWithTerrainAsync(){return new Promise(e=>{if(this.isReady&&this.terrain){e(this);return}this.once("loadWithTerrain",()=>{e(this)})})}monitorStyleUrl(e){typeof this.monitoredStyleUrls>"u"&&(this.monitoredStyleUrls=new Set);const t=new URL(e);t.search="",this.monitoredStyleUrls.add(t.href)}setStyle(e,t){var a;this.originalLabelStyle.clear(),(a=this.minimap)==null||a.setStyle(e),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1});const d=WS(e);if(d.requiresUrlMonitoring&&this.monitorStyleUrl(d.style),d.isFallback){if(this.getStyle())return console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Keeping the curent style instead."),this;console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style.")}return this.styleInProcess=!0,super.setStyle(d.style,t),this}addLayer(e,t){var a;return(a=this.minimap)==null||a.addLayer(e,t),super.addLayer(e,t)}moveLayer(e,t){var a;return(a=this.minimap)==null||a.moveLayer(e,t),super.moveLayer(e,t)}removeLayer(e){var t;return(t=this.minimap)==null||t.removeLayer(e),super.removeLayer(e)}setLayerZoomRange(e,t,a){var d;return(d=this.minimap)==null||d.setLayerZoomRange(e,t,a),super.setLayerZoomRange(e,t,a)}setFilter(e,t,a){var d;return(d=this.minimap)==null||d.setFilter(e,t,a),super.setFilter(e,t,a)}setPaintProperty(e,t,a,d){var m;return(m=this.minimap)==null||m.setPaintProperty(e,t,a,d),super.setPaintProperty(e,t,a,d)}setLayoutProperty(e,t,a,d){var m;return(m=this.minimap)==null||m.setLayoutProperty(e,t,a,d),super.setLayoutProperty(e,t,a,d)}setGlyphs(e,t){var a;return(a=this.minimap)==null||a.setGlyphs(e,t),super.setGlyphs(e,t)}getStyleLanguage(){return!this.style||!this.style.stylesheet||!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?e1(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(e){var t;(t=this.minimap)==null||t.map.setLanguage(e),this.onStyleReady(()=>{this.setPrimaryLanguage(e)})}setPrimaryLanguage(e){const t=this.getStyleLanguage(),a=dS(e,xr);if(!a){console.warn(`The language "${a}" is not supported.`);return}if(!(a.flag===xr.STYLE.flag&&t&&(t.flag===xr.AUTO.flag||t.flag===xr.VISITOR.flag))&&(a.flag!==xr.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===a&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===xr.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=a;let d=a;if(a.flag===xr.STYLE.flag){if(!t){console.warn("The style has no default languages or has an invalid one.");return}d=t}let m=xr.LOCAL.flag,y=["get",m];d.flag===xr.VISITOR.flag?(m=wS().flag,y=["case",["all",["has",m],["has",xr.LOCAL.flag]],["case",["==",["get",m],["get",xr.LOCAL.flag]],["get",xr.LOCAL.flag],["format",["get",m],{"font-scale":.8},`
`,["get",xr.LOCAL.flag],{"font-scale":1.1}]],["get",xr.LOCAL.flag]]):d.flag===xr.VISITOR_ENGLISH.flag?(m=xr.ENGLISH.flag,y=["case",["all",["has",m],["has",xr.LOCAL.flag]],["case",["==",["get",m],["get",xr.LOCAL.flag]],["get",xr.LOCAL.flag],["format",["get",m],{"font-scale":.8},`
`,["get",xr.LOCAL.flag],{"font-scale":1.1}]],["get",xr.LOCAL.flag]]):d.flag===xr.AUTO.flag?(m=wS().flag,y=["coalesce",["get",m],["get",xr.LOCAL.flag]]):d===xr.LOCAL?(m=xr.LOCAL.flag,y=["get",m]):(m=d.flag,y=["coalesce",["get",m],["get",xr.LOCAL.flag]]);const{layers:c}=this.getStyle(),P=this.originalLabelStyle.size===0;if(P){const k=dN(c,this);this.isStyleLocalized=Object.keys(k.localized).length>0}for(const k of c){if(k.type!=="symbol")continue;const B=k,X=this.getSource(B.source);if(!X||!("url"in X&&typeof X.url=="string")||new URL(X.url).host!==Po.maptilerApiHost)continue;const{id:G,layout:W}=B;if(!W||!("text-field"in W))continue;let ie;if(P?(ie=this.getLayoutProperty(G,"text-field"),this.originalLabelStyle.set(G,ie)):ie=this.originalLabelStyle.get(G),typeof ie=="string"){const{contains:Ie,exactMatch:Re}=oN(ie,this.isStyleLocalized);if(!Ie)continue;if(Re)this.setLayoutProperty(G,"text-field",y);else{const Oe=lN(ie,y,this.isStyleLocalized);this.setLayoutProperty(G,"text-field",Oe)}}else{const Ie=sN(ie,y,this.isStyleLocalized);this.setLayoutProperty(G,"text-field",Ie)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(e){if(!this.terrain)return;const t=performance.now(),a=this.terrain.exaggeration,d=e-a,m=()=>{if(!this.terrain||this.terrainFlattening)return;const y=(performance.now()-t)/this.terrainAnimationDuration;if(y<.99){const c=1-(1-y)**4,P=a+c*d;this.terrain.exaggeration=P,requestAnimationFrame(m)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=e,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(m)}enableTerrain(e=this.terrainExaggeration){if(e<0){console.warn("Terrain exaggeration cannot be negative.");return}const t=d=>{!this.terrain||d.type!=="data"||d.dataType!=="source"||!("source"in d)||d.sourceId!=="maptiler-terrain"||d.source.type!=="raster-dem"||d.isSourceLoaded&&(this.off("data",t),this.growTerrain(e))},a=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=e,this.on("data",t),this.addSource(Po.terrainSourceId,{type:"raster-dem",url:Po.terrainSourceURL}),this.setTerrain({source:Po.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(e);return}this.loaded()||this.isTerrainEnabled?a():this.once("load",()=>{this.getTerrain()&&this.getSource(Po.terrainSourceId)||a()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const e=performance.now(),t=this.terrain.exaggeration,a=()=>{if(!this.terrain||this.terrainGrowing)return;const d=(performance.now()-e)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,d<.99){const m=(1-d)**4,y=t*m;this.terrain.exaggeration=y,requestAnimationFrame(a)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Po.terrainSourceId)&&this.removeSource(Po.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(a)}setTerrainExaggeration(e,t=!0){!t&&this.terrain?(this.terrainExaggeration=e,this.terrain.exaggeration=e,this.triggerRepaint()):this.enableTerrain(e)}onStyleReady(e){this.isStyleLoaded()?e():this.once("styledata",()=>{e()})}async fitToIpBounds(){const e=await pS.info();this.fitBounds(e.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(e){const t=await pS.info();this.jumpTo({center:[t.longitude??0,t.latitude??0],zoom:e||11})}getCameraHash(){const e=new Float32Array(5),t=this.getCenter();return e[0]=t.lng,e[1]=t.lat,e[2]=this.getZoom(),e[3]=this.getPitch(),e[4]=this.getBearing(),H4.fromUint8Array(new Uint8Array(e.buffer))}getSdkConfig(){return Ha}getMaptilerSessionId(){return Vw}setTransformRequest(e){return super.setTransformRequest(AS(e)),this}isGlobeProjection(){const e=this.getProjection();return e?e.type==="globe":!1}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}};function Bv(r){const e=r.toString(16);return e.length===1?`0${e}`:e}function qB(r){return`#${Bv(r[0])}${Bv(r[1])}${Bv(r[2])}${r.length===4?Bv(r[3]):""}`}let In=class $m extends Array{constructor(e={}){super(),Un(this,"min",0),Un(this,"max",1),"min"in e&&(this.min=e.min),"max"in e&&(this.max=e.max),"stops"in e&&this.setStops(e.stops,{clone:!1})}static fromArrayDefinition(e){return new $m({stops:e.map(t=>({value:t[0],color:t[1]}))})}setStops(e,t={clone:!0}){const a=t.clone?this.clone():this;a.length=0;let d=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY;for(let y=0;y<e.length;y+=1)d=Math.min(d,e[y].value),m=Math.max(m,e[y].value),a.push({value:e[y].value,color:e[y].color.slice()});return a.sort((y,c)=>y.value<c.value?-1:1),this.min=d,this.max=m,a}scale(e,t,a={clone:!0}){const d=a.clone,m=this[0].value,y=this.at(-1).value-m,c=t-e,P=[];for(let k=0;k<this.length;k+=1){const B=(this[k].value-m)/y*c+e;d?P.push({value:B,color:this[k].color.slice()}):this[k].value=B}return d?new $m({stops:P}):this}at(e){return e<0?this[this.length+e]:this[e]}clone(){return new $m({stops:this.getRawColorStops()})}getRawColorStops(){const e=[];for(let t=0;t<this.length;t+=1)e.push({value:this[t].value,color:this[t].color});return e}reverse(e={clone:!0}){const t=e.clone?this.clone():this;for(let a=0;a<~~(t.length/2);a+=1){const d=t[a].color;t[a].color=t.at(-(a+1)).color,t.at(-(a+1)).color=d}return t}getBounds(){return{min:this.min,max:this.max}}getColor(e,t={smooth:!0}){if(e<=this[0].value)return this[0].color;if(e>=this.at(-1).value)return this.at(-1).color;for(let a=0;a<this.length-1;a+=1){if(e>this[a+1].value)continue;const d=this[a].color;if(!t.smooth)return d.slice();const m=this[a].value,y=this[a+1].value,c=this[a+1].color,P=(y-e)/(y-m);return d.map((k,B)=>Math.round(k*P+c[B]*(1-P)))}return[0,0,0]}getColorHex(e,t={smooth:!0,withAlpha:!1}){return qB(this.getColor(e,t))}getColorRelative(e,t={smooth:!0}){const a=this.getBounds();return this.getColor(a.min+e*(a.max-a.min),t)}getCanvasStrip(e={horizontal:!0,size:512,smooth:!0}){const t=document.createElement("canvas");t.width=e.horizontal?e.size:1,t.height=e.horizontal?1:e.size;const a=t.getContext("2d");if(!a)throw new Error("Canvs context is missing");const d=a.getImageData(0,0,t.width,t.height),m=d.data,y=e.size,c=this[0].value,P=(this.at(-1).value-c)/y;for(let k=0;k<y;k+=1){const B=this.getColor(c+k*P,{smooth:e.smooth});m[k*4]=B[0],m[k*4+1]=B[1],m[k*4+2]=B[2],m[k*4+3]=B.length>3?B[3]:255}return a.putImageData(d,0,0),t}resample(e,t=15){const a=this.getBounds(),d=this.scale(0,1),m=1/(t-1);let y;if(e==="ease-in-square")y=Array.from({length:t},(c,P)=>{const k=P*m,B=k**2,X=d.getColor(B);return{value:k,color:X}});else if(e==="ease-out-square")y=Array.from({length:t},(c,P)=>{const k=P*m,B=1-(1-k)**2,X=d.getColor(B);return{value:k,color:X}});else if(e==="ease-out-sqrt")y=Array.from({length:t},(c,P)=>{const k=P*m,B=k**.5,X=d.getColor(B);return{value:k,color:X}});else if(e==="ease-in-sqrt")y=Array.from({length:t},(c,P)=>{const k=P*m,B=1-(1-k)**.5,X=d.getColor(B);return{value:k,color:X}});else if(e==="ease-out-exp")y=Array.from({length:t},(c,P)=>{const k=P*m,B=1-2**(-10*k),X=d.getColor(B);return{value:k,color:X}});else if(e==="ease-in-exp")y=Array.from({length:t},(c,P)=>{const k=P*m,B=2**(10*k-10),X=d.getColor(B);return{value:k,color:X}});else throw new Error("Invalid ressampling method.");return new $m({stops:y}).scale(a.min,a.max)}transparentStart(){const e=this.getRawColorStops();e.unshift({value:e[0].value,color:e[0].color.slice()}),e[1].value+=.001;for(const t of e)t.color.length===3&&t.color.push(255);return e[0].color[3]=0,new $m({stops:e})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}};new In({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),new In({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new In({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),new In({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),new In({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),new In({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),new In({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),new In({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),new In({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),new In({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),new In({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),new In({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new In({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),new In({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),new In({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),new In({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),new In({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),new In({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),new In({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),new In({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),new In({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),new In({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),new In({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),new In({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),new In({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),new In({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),new In({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),new In({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),new In({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),new In({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),new In({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),new In({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),new In({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),new In({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),new In({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),new In({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),new In({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),new In({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),new In({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),new In({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),new In({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),new In({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),new In({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),new In({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),new In({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),new In({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),new In({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),new In({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),new In({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]});nN();sn.Map;sn.Marker;sn.Popup;sn.Style;sn.CanvasSource;sn.GeoJSONSource;sn.ImageSource;sn.RasterTileSource;sn.RasterDEMTileSource;sn.VectorTileSource;sn.VideoSource;sn.NavigationControl;sn.GeolocateControl;sn.AttributionControl;sn.LogoControl;sn.ScaleControl;sn.FullscreenControl;sn.TerrainControl;sn.BoxZoomHandler;sn.ScrollZoomHandler;sn.CooperativeGesturesHandler;sn.KeyboardHandler;sn.TwoFingersTouchPitchHandler;sn.MapWheelEvent;sn.MapTouchEvent;sn.MapMouseEvent;sn.config;sn.getVersion;const{setRTLTextPlugin:KU,getRTLTextPluginStatus:WU,LngLat:XU,LngLatBounds:YU,MercatorCoordinate:QU,Evented:JU,AJAXError:ej,prewarm:tj,clearPrewarmedResources:nj,Hash:rj,Point:ij,EdgeInsets:aj,DragRotateHandler:sj,DragPanHandler:oj,TwoFingersTouchZoomRotateHandler:lj,DoubleClickZoomHandler:uj,TwoFingersTouchZoomHandler:cj,TwoFingersTouchRotateHandler:hj,getWorkerCount:dj,setWorkerCount:fj,getMaxParallelImageRequests:pj,setMaxParallelImageRequests:mj,getWorkerUrl:gj,setWorkerUrl:yj,addSourceType:_j,importScriptInWorkers:vj,addProtocol:bj,removeProtocol:xj}=sn;function GB(){const[r,e]=ct.useState([]),[t,a]=ct.useState([]),[d,m]=ct.useState(!0),[y,c]=ct.useState(null),[P,k]=ct.useState(null),[B,X]=ct.useState(""),[G,W]=ct.useState(0),[ie,Ie]=ct.useState(0),Re=ct.useRef(null),Oe=ct.useRef(null),Ke=ct.useRef({}),mt="Tx0tJslnlndsHe3hs95w",qe=5,Fe=pe=>{const oe=[...pe];for(let me=oe.length-1;me>0;me--){const be=Math.floor(Math.random()*(me+1));[oe[me],oe[be]]=[oe[be],oe[me]]}return oe};ct.useEffect(()=>{let pe=!0;return(async()=>{try{const be=(await zw(S0($h,"Airports"))).docs.map(Ce=>({id:Ce.id,...Ce.data()}));if(pe){if(console.log("Betöltött repülőterek:"),be.forEach(Ce=>{console.log(`ICAO Code: ${Ce["ICAO Code"]}, Airport: ${Ce.Airport}`)}),e(be),be.length>0){const Ce=Fe(be);a(Ce),k(Ce[0]),Ie(1)}else console.warn("Nincsenek repülőterek az adatbázisban."),c("Nincsenek repülőterek az adatbázisban.");m(!1)}}catch(me){pe&&(console.error("Hiba a repülőterek betöltésekor:",me),c("Nem sikerült betölteni a repülőtereket: "+me.message),m(!1))}})(),()=>{pe=!1}},[]),ct.useEffect(()=>{if(!(!Re.current||r.length===0))return Ha.apiKey=mt,Oe.current=new kP({container:Re.current,style:"https://api.maptiler.com/maps/01974fe0-7e99-7127-b3bd-efa9385fdb1e/style.json?key=Tx0tJslnlndsHe3hs95w",center:[0,20],zoom:2}),r.forEach(pe=>{const{Lat:oe,Long:me,"ICAO Code":be,Airport:Ce}=pe;if(oe&&me){const Ve=new pN({offset:25}).setHTML(`<h3>${be}</h3><p>${Ce}</p>`),Ee=document.createElement("div");Ee.style.backgroundColor="red",Ee.style.width="12px",Ee.style.height="12px",Ee.style.borderRadius="50%",Ee.style.border="2px solid white",Ee.style.cursor="pointer";const Yn=new fN({element:Ee}).setLngLat([parseFloat(me),parseFloat(oe)]).setPopup(Ve).addTo(Oe.current);Ke.current[be]={marker:Yn,element:Ee},Yn.getElement().addEventListener("click",()=>{P&&be===P["ICAO Code"]&&(Ee.style.backgroundColor="green",Oe.current.flyTo({center:[parseFloat(me),parseFloat(oe)],zoom:qe,duration:2e3}),Oe.current.once("moveend",()=>{const jn=ie;if(jn<t.length)k(t[jn]),Ie(gt=>gt+1);else{const gt=Fe(r);a(gt),k(gt[0]),Ie(1)}}))})}}),()=>{Oe.current&&Oe.current.remove()}},[r]);const We=pe=>{var be;pe.preventDefault();const oe=B.trim().toLowerCase(),me=P==null?void 0:P.Airport.toLowerCase();if(oe===me){const Ce=r.find(Ve=>Ve["ICAO Code"]===P["ICAO Code"]);if(Ce&&Ce.Lat&&Ce.Long){const Ve=(be=Ke.current[Ce["ICAO Code"]])==null?void 0:be.element;Ve&&(Ve.style.backgroundColor="green"),Oe.current.flyTo({center:[parseFloat(Ce.Long),parseFloat(Ce.Lat)],zoom:qe,duration:2e3}),Oe.current.once("moveend",()=>{const Ee=ie;if(Ee<t.length)k(t[Ee]),Ie(Yn=>Yn+1);else{Object.values(Ke.current).forEach(({element:jn})=>{jn.style.backgroundColor="red"});const Yn=Fe(r);a(Yn),k(Yn[0]),Ie(1),W(0)}})}}else W(Ce=>Ce+1);X("")};return d?He.jsx("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:He.jsx("p",{children:"Betöltés..."})}):y?He.jsx("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:He.jsx("p",{className:"text-red-500",children:y})}):He.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gray-100",children:He.jsxs("div",{className:"relative w-full max-w-7xl p-4",children:[P&&He.jsxs("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-white p-4 rounded-lg shadow z-10 flex flex-col items-center gap-2",children:[He.jsxs("p",{className:"text-lg font-bold text-center",children:["Keresd meg a térképen: ",P["ICAO Code"]]}),He.jsxs("form",{onSubmit:We,className:"flex gap-2",children:[He.jsx("input",{type:"text",value:B,onChange:pe=>X(pe.target.value),placeholder:"Írd be a repülőtér nevét",className:"p-2 border rounded",autoFocus:!0}),He.jsx("button",{type:"submit",className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Ellenőrzés"})]})]}),He.jsxs("div",{className:"relative w-full h-[800px] rounded-lg shadow",children:[He.jsx("div",{ref:Re,className:"w-full h-full"}),He.jsx("div",{className:"absolute bottom-4 left-4 bg-white p-2 rounded-lg shadow z-10",children:He.jsxs("p",{className:"text-lg font-bold text-red-600",children:["Hibák: ",G]})}),He.jsx("div",{className:"absolute bottom-4 right-4 bg-white p-2 rounded-lg shadow z-10",children:He.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[ie,"/",r.length]})})]})]})})}function HB(){return He.jsxs("div",{className:"container mx-auto p-4",children:[He.jsx("h1",{className:"text-2xl font-bold",children:"Aircrafts"}),He.jsx("p",{children:"This is the Aircrafts page."})]})}/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */function ZB(r,e,t){return(e=WB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function QS(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),t.push.apply(t,a)}return t}function Ot(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?QS(Object(t),!0).forEach(function(a){ZB(r,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):QS(Object(t)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(t,a))})}return r}function KB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var a=t.call(r,e);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function WB(r){var e=KB(r,"string");return typeof e=="symbol"?e:e+""}const JS=()=>{};let l2={},LP={},zP=null,OP={mark:JS,measure:JS};try{typeof window<"u"&&(l2=window),typeof document<"u"&&(LP=document),typeof MutationObserver<"u"&&(zP=MutationObserver),typeof performance<"u"&&(OP=performance)}catch{}const{userAgent:eE=""}=l2.navigator||{},gf=l2,Mi=LP,tE=zP,Vv=OP;gf.document;const od=!!Mi.documentElement&&!!Mi.head&&typeof Mi.addEventListener=="function"&&typeof Mi.createElement=="function",NP=~eE.indexOf("MSIE")||~eE.indexOf("Trident/");var XB=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,YB=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,BP={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},QB={GROUP:"duotone-group",PRIMARY:"primary",SECONDARY:"secondary"},VP=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],ro="classic",Tb="duotone",JB="sharp",eV="sharp-duotone",FP=[ro,Tb,JB,eV],tV={classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}},nV={"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}},rV=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),iV={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}},aV=["fak","fa-kit","fakd","fa-kit-duotone"],nE={kit:{fak:"kit","fa-kit":"kit"},"kit-duotone":{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"}},sV=["kit"],oV={kit:{"fa-kit":"fak"}},lV=["fak","fakd"],uV={kit:{fak:"fa-kit"}},rE={kit:{kit:"fak"},"kit-duotone":{"kit-duotone":"fakd"}},Fv={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},cV=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],hV=["fak","fa-kit","fakd","fa-kit-duotone"],dV={"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},fV={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}},pV={classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]},p1={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},mV=["fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],m1=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt",...cV,...mV],gV=["solid","regular","light","thin","duotone","brands"],UP=[1,2,3,4,5,6,7,8,9,10],yV=UP.concat([11,12,13,14,15,16,17,18,19,20]),_V=[...Object.keys(pV),...gV,"2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",Fv.GROUP,Fv.SWAP_OPACITY,Fv.PRIMARY,Fv.SECONDARY].concat(UP.map(r=>"".concat(r,"x"))).concat(yV.map(r=>"w-".concat(r))),vV={"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}};const rd="___FONT_AWESOME___",g1=16,jP="fa",$P="svg-inline--fa",Up="data-fa-i2svg",y1="data-fa-pseudo-element",bV="data-fa-pseudo-element-pending",u2="data-prefix",c2="data-icon",iE="fontawesome-i2svg",xV="async",wV=["HTML","HEAD","STYLE","SCRIPT"],qP=(()=>{try{return!0}catch{return!1}})();function q_(r){return new Proxy(r,{get(e,t){return t in e?e[t]:e[ro]}})}const GP=Ot({},BP);GP[ro]=Ot(Ot(Ot(Ot({},{"fa-duotone":"duotone"}),BP[ro]),nE.kit),nE["kit-duotone"]);const TV=q_(GP),_1=Ot({},iV);_1[ro]=Ot(Ot(Ot(Ot({},{duotone:"fad"}),_1[ro]),rE.kit),rE["kit-duotone"]);const aE=q_(_1),v1=Ot({},p1);v1[ro]=Ot(Ot({},v1[ro]),uV.kit);const h2=q_(v1),b1=Ot({},fV);b1[ro]=Ot(Ot({},b1[ro]),oV.kit);q_(b1);const SV=XB,HP="fa-layers-text",EV=YB,AV=Ot({},tV);q_(AV);const IV=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],mx=QB,CV=[...sV,..._V],e_=gf.FontAwesomeConfig||{};function PV(r){var e=Mi.querySelector("script["+r+"]");if(e)return e.getAttribute(r)}function MV(r){return r===""?!0:r==="false"?!1:r==="true"?!0:r}Mi&&typeof Mi.querySelector=="function"&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(e=>{let[t,a]=e;const d=MV(PV(t));d!=null&&(e_[a]=d)});const ZP={styleDefault:"solid",familyDefault:ro,cssPrefix:jP,replacementClass:$P,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};e_.familyPrefix&&(e_.cssPrefix=e_.familyPrefix);const dg=Ot(Ot({},ZP),e_);dg.autoReplaceSvg||(dg.observeMutations=!1);const hn={};Object.keys(ZP).forEach(r=>{Object.defineProperty(hn,r,{enumerable:!0,set:function(e){dg[r]=e,t_.forEach(t=>t(hn))},get:function(){return dg[r]}})});Object.defineProperty(hn,"familyPrefix",{enumerable:!0,set:function(r){dg.cssPrefix=r,t_.forEach(e=>e(hn))},get:function(){return dg.cssPrefix}});gf.FontAwesomeConfig=hn;const t_=[];function RV(r){return t_.push(r),()=>{t_.splice(t_.indexOf(r),1)}}const Yd=g1,eh={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function kV(r){if(!r||!od)return;const e=Mi.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=r;const t=Mi.head.childNodes;let a=null;for(let d=t.length-1;d>-1;d--){const m=t[d],y=(m.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(y)>-1&&(a=m)}return Mi.head.insertBefore(e,a),r}const DV="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function x_(){let r=12,e="";for(;r-- >0;)e+=DV[Math.random()*62|0];return e}function Sg(r){const e=[];for(let t=(r||[]).length>>>0;t--;)e[t]=r[t];return e}function d2(r){return r.classList?Sg(r.classList):(r.getAttribute("class")||"").split(" ").filter(e=>e)}function KP(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function LV(r){return Object.keys(r||{}).reduce((e,t)=>e+"".concat(t,'="').concat(KP(r[t]),'" '),"").trim()}function Sb(r){return Object.keys(r||{}).reduce((e,t)=>e+"".concat(t,": ").concat(r[t].trim(),";"),"")}function f2(r){return r.size!==eh.size||r.x!==eh.x||r.y!==eh.y||r.rotate!==eh.rotate||r.flipX||r.flipY}function zV(r){let{transform:e,containerWidth:t,iconWidth:a}=r;const d={transform:"translate(".concat(t/2," 256)")},m="translate(".concat(e.x*32,", ").concat(e.y*32,") "),y="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),c="rotate(".concat(e.rotate," 0 0)"),P={transform:"".concat(m," ").concat(y," ").concat(c)},k={transform:"translate(".concat(a/2*-1," -256)")};return{outer:d,inner:P,path:k}}function OV(r){let{transform:e,width:t=g1,height:a=g1,startCentered:d=!1}=r,m="";return d&&NP?m+="translate(".concat(e.x/Yd-t/2,"em, ").concat(e.y/Yd-a/2,"em) "):d?m+="translate(calc(-50% + ".concat(e.x/Yd,"em), calc(-50% + ").concat(e.y/Yd,"em)) "):m+="translate(".concat(e.x/Yd,"em, ").concat(e.y/Yd,"em) "),m+="scale(".concat(e.size/Yd*(e.flipX?-1:1),", ").concat(e.size/Yd*(e.flipY?-1:1),") "),m+="rotate(".concat(e.rotate,"deg) "),m}var NV=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}`;function WP(){const r=jP,e=$P,t=hn.cssPrefix,a=hn.replacementClass;let d=NV;if(t!==r||a!==e){const m=new RegExp("\\.".concat(r,"\\-"),"g"),y=new RegExp("\\--".concat(r,"\\-"),"g"),c=new RegExp("\\.".concat(e),"g");d=d.replace(m,".".concat(t,"-")).replace(y,"--".concat(t,"-")).replace(c,".".concat(a))}return d}let sE=!1;function gx(){hn.autoAddCss&&!sE&&(kV(WP()),sE=!0)}var BV={mixout(){return{dom:{css:WP,insertCss:gx}}},hooks(){return{beforeDOMElementCreation(){gx()},beforeI2svg(){gx()}}}};const id=gf||{};id[rd]||(id[rd]={});id[rd].styles||(id[rd].styles={});id[rd].hooks||(id[rd].hooks={});id[rd].shims||(id[rd].shims=[]);var th=id[rd];const XP=[],YP=function(){Mi.removeEventListener("DOMContentLoaded",YP),z0=1,XP.map(r=>r())};let z0=!1;od&&(z0=(Mi.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Mi.readyState),z0||Mi.addEventListener("DOMContentLoaded",YP));function VV(r){od&&(z0?setTimeout(r,0):XP.push(r))}function G_(r){const{tag:e,attributes:t={},children:a=[]}=r;return typeof r=="string"?KP(r):"<".concat(e," ").concat(LV(t),">").concat(a.map(G_).join(""),"</").concat(e,">")}function oE(r,e,t){if(r&&r[e]&&r[e][t])return{prefix:e,iconName:t,icon:r[e][t]}}var yx=function(e,t,a,d){var m=Object.keys(e),y=m.length,c=t,P,k,B;for(a===void 0?(P=1,B=e[m[0]]):(P=0,B=a);P<y;P++)k=m[P],B=c(B,e[k],k,e);return B};function FV(r){const e=[];let t=0;const a=r.length;for(;t<a;){const d=r.charCodeAt(t++);if(d>=55296&&d<=56319&&t<a){const m=r.charCodeAt(t++);(m&64512)==56320?e.push(((d&1023)<<10)+(m&1023)+65536):(e.push(d),t--)}else e.push(d)}return e}function x1(r){const e=FV(r);return e.length===1?e[0].toString(16):null}function UV(r,e){const t=r.length;let a=r.charCodeAt(e),d;return a>=55296&&a<=56319&&t>e+1&&(d=r.charCodeAt(e+1),d>=56320&&d<=57343)?(a-55296)*1024+d-56320+65536:a}function lE(r){return Object.keys(r).reduce((e,t)=>{const a=r[t];return!!a.icon?e[a.iconName]=a.icon:e[t]=a,e},{})}function w1(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{skipHooks:a=!1}=t,d=lE(e);typeof th.hooks.addPack=="function"&&!a?th.hooks.addPack(r,lE(e)):th.styles[r]=Ot(Ot({},th.styles[r]||{}),d),r==="fas"&&w1("fa",e)}const{styles:w_,shims:jV}=th,QP=Object.keys(h2),$V=QP.reduce((r,e)=>(r[e]=Object.keys(h2[e]),r),{});let p2=null,JP={},eM={},tM={},nM={},rM={};function qV(r){return~CV.indexOf(r)}function GV(r,e){const t=e.split("-"),a=t[0],d=t.slice(1).join("-");return a===r&&d!==""&&!qV(d)?d:null}const iM=()=>{const r=a=>yx(w_,(d,m,y)=>(d[y]=yx(m,a,{}),d),{});JP=r((a,d,m)=>(d[3]&&(a[d[3]]=m),d[2]&&d[2].filter(c=>typeof c=="number").forEach(c=>{a[c.toString(16)]=m}),a)),eM=r((a,d,m)=>(a[m]=m,d[2]&&d[2].filter(c=>typeof c=="string").forEach(c=>{a[c]=m}),a)),rM=r((a,d,m)=>{const y=d[2];return a[m]=m,y.forEach(c=>{a[c]=m}),a});const e="far"in w_||hn.autoFetchSvg,t=yx(jV,(a,d)=>{const m=d[0];let y=d[1];const c=d[2];return y==="far"&&!e&&(y="fas"),typeof m=="string"&&(a.names[m]={prefix:y,iconName:c}),typeof m=="number"&&(a.unicodes[m.toString(16)]={prefix:y,iconName:c}),a},{names:{},unicodes:{}});tM=t.names,nM=t.unicodes,p2=Eb(hn.styleDefault,{family:hn.familyDefault})};RV(r=>{p2=Eb(r.styleDefault,{family:hn.familyDefault})});iM();function m2(r,e){return(JP[r]||{})[e]}function HV(r,e){return(eM[r]||{})[e]}function Ip(r,e){return(rM[r]||{})[e]}function aM(r){return tM[r]||{prefix:null,iconName:null}}function ZV(r){const e=nM[r],t=m2("fas",r);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}function yf(){return p2}const sM=()=>({prefix:null,iconName:null,rest:[]});function KV(r){let e=ro;const t=QP.reduce((a,d)=>(a[d]="".concat(hn.cssPrefix,"-").concat(d),a),{});return FP.forEach(a=>{(r.includes(t[a])||r.some(d=>$V[a].includes(d)))&&(e=a)}),e}function Eb(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{family:t=ro}=e,a=TV[t][r];if(t===Tb&&!r)return"fad";const d=aE[t][r]||aE[t][a],m=r in th.styles?r:null;return d||m||null}function WV(r){let e=[],t=null;return r.forEach(a=>{const d=GV(hn.cssPrefix,a);d?t=d:a&&e.push(a)}),{iconName:t,rest:e}}function uE(r){return r.sort().filter((e,t,a)=>a.indexOf(e)===t)}function Ab(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{skipLookups:t=!1}=e;let a=null;const d=m1.concat(hV),m=uE(r.filter(X=>d.includes(X))),y=uE(r.filter(X=>!m1.includes(X))),c=m.filter(X=>(a=X,!VP.includes(X))),[P=null]=c,k=KV(m),B=Ot(Ot({},WV(y)),{},{prefix:Eb(P,{family:k})});return Ot(Ot(Ot({},B),JV({values:r,family:k,styles:w_,config:hn,canonical:B,givenPrefix:a})),XV(t,a,B))}function XV(r,e,t){let{prefix:a,iconName:d}=t;if(r||!a||!d)return{prefix:a,iconName:d};const m=e==="fa"?aM(d):{},y=Ip(a,d);return d=m.iconName||y||d,a=m.prefix||a,a==="far"&&!w_.far&&w_.fas&&!hn.autoFetchSvg&&(a="fas"),{prefix:a,iconName:d}}const YV=FP.filter(r=>r!==ro||r!==Tb),QV=Object.keys(p1).filter(r=>r!==ro).map(r=>Object.keys(p1[r])).flat();function JV(r){const{values:e,family:t,canonical:a,givenPrefix:d="",styles:m={},config:y={}}=r,c=t===Tb,P=e.includes("fa-duotone")||e.includes("fad"),k=y.familyDefault==="duotone",B=a.prefix==="fad"||a.prefix==="fa-duotone";if(!c&&(P||k||B)&&(a.prefix="fad"),(e.includes("fa-brands")||e.includes("fab"))&&(a.prefix="fab"),!a.prefix&&YV.includes(t)&&(Object.keys(m).find(G=>QV.includes(G))||y.autoFetchSvg)){const G=rV.get(t).defaultShortPrefixId;a.prefix=G,a.iconName=Ip(a.prefix,a.iconName)||a.iconName}return(a.prefix==="fa"||d==="fa")&&(a.prefix=yf()||"fas"),a}class eF{constructor(){this.definitions={}}add(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];const d=t.reduce(this._pullDefinitions,{});Object.keys(d).forEach(m=>{this.definitions[m]=Ot(Ot({},this.definitions[m]||{}),d[m]),w1(m,d[m]);const y=h2[ro][m];y&&w1(y,d[m]),iM()})}reset(){this.definitions={}}_pullDefinitions(e,t){const a=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(a).map(d=>{const{prefix:m,iconName:y,icon:c}=a[d],P=c[2];e[m]||(e[m]={}),P.length>0&&P.forEach(k=>{typeof k=="string"&&(e[m][k]=c)}),e[m][y]=c}),e}}let cE=[],Gm={};const tg={},tF=Object.keys(tg);function nF(r,e){let{mixoutsTo:t}=e;return cE=r,Gm={},Object.keys(tg).forEach(a=>{tF.indexOf(a)===-1&&delete tg[a]}),cE.forEach(a=>{const d=a.mixout?a.mixout():{};if(Object.keys(d).forEach(m=>{typeof d[m]=="function"&&(t[m]=d[m]),typeof d[m]=="object"&&Object.keys(d[m]).forEach(y=>{t[m]||(t[m]={}),t[m][y]=d[m][y]})}),a.hooks){const m=a.hooks();Object.keys(m).forEach(y=>{Gm[y]||(Gm[y]=[]),Gm[y].push(m[y])})}a.provides&&a.provides(tg)}),t}function T1(r,e){for(var t=arguments.length,a=new Array(t>2?t-2:0),d=2;d<t;d++)a[d-2]=arguments[d];return(Gm[r]||[]).forEach(y=>{e=y.apply(null,[e,...a])}),e}function jp(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),a=1;a<e;a++)t[a-1]=arguments[a];(Gm[r]||[]).forEach(m=>{m.apply(null,t)})}function _f(){const r=arguments[0],e=Array.prototype.slice.call(arguments,1);return tg[r]?tg[r].apply(null,e):void 0}function S1(r){r.prefix==="fa"&&(r.prefix="fas");let{iconName:e}=r;const t=r.prefix||yf();if(e)return e=Ip(t,e)||e,oE(oM.definitions,t,e)||oE(th.styles,t,e)}const oM=new eF,rF=()=>{hn.autoReplaceSvg=!1,hn.observeMutations=!1,jp("noAuto")},iF={i2svg:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return od?(jp("beforeI2svg",r),_f("pseudoElements2svg",r),_f("i2svg",r)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e}=r;hn.autoReplaceSvg===!1&&(hn.autoReplaceSvg=!0),hn.observeMutations=!0,VV(()=>{sF({autoReplaceSvgRoot:e}),jp("watch",r)})}},aF={icon:r=>{if(r===null)return null;if(typeof r=="object"&&r.prefix&&r.iconName)return{prefix:r.prefix,iconName:Ip(r.prefix,r.iconName)||r.iconName};if(Array.isArray(r)&&r.length===2){const e=r[1].indexOf("fa-")===0?r[1].slice(3):r[1],t=Eb(r[0]);return{prefix:t,iconName:Ip(t,e)||e}}if(typeof r=="string"&&(r.indexOf("".concat(hn.cssPrefix,"-"))>-1||r.match(SV))){const e=Ab(r.split(" "),{skipLookups:!0});return{prefix:e.prefix||yf(),iconName:Ip(e.prefix,e.iconName)||e.iconName}}if(typeof r=="string"){const e=yf();return{prefix:e,iconName:Ip(e,r)||r}}}},kl={noAuto:rF,config:hn,dom:iF,parse:aF,library:oM,findIconDefinition:S1,toHtml:G_},sF=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e=Mi}=r;(Object.keys(th.styles).length>0||hn.autoFetchSvg)&&od&&hn.autoReplaceSvg&&kl.dom.i2svg({node:e})};function Ib(r,e){return Object.defineProperty(r,"abstract",{get:e}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(t=>G_(t))}}),Object.defineProperty(r,"node",{get:function(){if(!od)return;const t=Mi.createElement("div");return t.innerHTML=r.html,t.children}}),r}function oF(r){let{children:e,main:t,mask:a,attributes:d,styles:m,transform:y}=r;if(f2(y)&&t.found&&!a.found){const{width:c,height:P}=t,k={x:c/P/2,y:.5};d.style=Sb(Ot(Ot({},m),{},{"transform-origin":"".concat(k.x+y.x/16,"em ").concat(k.y+y.y/16,"em")}))}return[{tag:"svg",attributes:d,children:e}]}function lF(r){let{prefix:e,iconName:t,children:a,attributes:d,symbol:m}=r;const y=m===!0?"".concat(e,"-").concat(hn.cssPrefix,"-").concat(t):m;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Ot(Ot({},d),{},{id:y}),children:a}]}]}function g2(r){const{icons:{main:e,mask:t},prefix:a,iconName:d,transform:m,symbol:y,title:c,maskId:P,titleId:k,extra:B,watchable:X=!1}=r,{width:G,height:W}=t.found?t:e,ie=lV.includes(a),Ie=[hn.replacementClass,d?"".concat(hn.cssPrefix,"-").concat(d):""].filter(Fe=>B.classes.indexOf(Fe)===-1).filter(Fe=>Fe!==""||!!Fe).concat(B.classes).join(" ");let Re={children:[],attributes:Ot(Ot({},B.attributes),{},{"data-prefix":a,"data-icon":d,class:Ie,role:B.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(G," ").concat(W)})};const Oe=ie&&!~B.classes.indexOf("fa-fw")?{width:"".concat(G/W*16*.0625,"em")}:{};X&&(Re.attributes[Up]=""),c&&(Re.children.push({tag:"title",attributes:{id:Re.attributes["aria-labelledby"]||"title-".concat(k||x_())},children:[c]}),delete Re.attributes.title);const Ke=Ot(Ot({},Re),{},{prefix:a,iconName:d,main:e,mask:t,maskId:P,transform:m,symbol:y,styles:Ot(Ot({},Oe),B.styles)}),{children:mt,attributes:qe}=t.found&&e.found?_f("generateAbstractMask",Ke)||{children:[],attributes:{}}:_f("generateAbstractIcon",Ke)||{children:[],attributes:{}};return Ke.children=mt,Ke.attributes=qe,y?lF(Ke):oF(Ke)}function hE(r){const{content:e,width:t,height:a,transform:d,title:m,extra:y,watchable:c=!1}=r,P=Ot(Ot(Ot({},y.attributes),m?{title:m}:{}),{},{class:y.classes.join(" ")});c&&(P[Up]="");const k=Ot({},y.styles);f2(d)&&(k.transform=OV({transform:d,startCentered:!0,width:t,height:a}),k["-webkit-transform"]=k.transform);const B=Sb(k);B.length>0&&(P.style=B);const X=[];return X.push({tag:"span",attributes:P,children:[e]}),m&&X.push({tag:"span",attributes:{class:"sr-only"},children:[m]}),X}function uF(r){const{content:e,title:t,extra:a}=r,d=Ot(Ot(Ot({},a.attributes),t?{title:t}:{}),{},{class:a.classes.join(" ")}),m=Sb(a.styles);m.length>0&&(d.style=m);const y=[];return y.push({tag:"span",attributes:d,children:[e]}),t&&y.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),y}const{styles:_x}=th;function E1(r){const e=r[0],t=r[1],[a]=r.slice(4);let d=null;return Array.isArray(a)?d={tag:"g",attributes:{class:"".concat(hn.cssPrefix,"-").concat(mx.GROUP)},children:[{tag:"path",attributes:{class:"".concat(hn.cssPrefix,"-").concat(mx.SECONDARY),fill:"currentColor",d:a[0]}},{tag:"path",attributes:{class:"".concat(hn.cssPrefix,"-").concat(mx.PRIMARY),fill:"currentColor",d:a[1]}}]}:d={tag:"path",attributes:{fill:"currentColor",d:a}},{found:!0,width:e,height:t,icon:d}}const cF={found:!1,width:512,height:512};function hF(r,e){!qP&&!hn.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(e,'" is missing.'))}function A1(r,e){let t=e;return e==="fa"&&hn.styleDefault!==null&&(e=yf()),new Promise((a,d)=>{if(t==="fa"){const m=aM(r)||{};r=m.iconName||r,e=m.prefix||e}if(r&&e&&_x[e]&&_x[e][r]){const m=_x[e][r];return a(E1(m))}hF(r,e),a(Ot(Ot({},cF),{},{icon:hn.showMissingIcons&&r?_f("missingIconAbstract")||{}:{}}))})}const dE=()=>{},I1=hn.measurePerformance&&Vv&&Vv.mark&&Vv.measure?Vv:{mark:dE,measure:dE},$y='FA "6.7.2"',dF=r=>(I1.mark("".concat($y," ").concat(r," begins")),()=>lM(r)),lM=r=>{I1.mark("".concat($y," ").concat(r," ends")),I1.measure("".concat($y," ").concat(r),"".concat($y," ").concat(r," begins"),"".concat($y," ").concat(r," ends"))};var y2={begin:dF,end:lM};const r0=()=>{};function fE(r){return typeof(r.getAttribute?r.getAttribute(Up):null)=="string"}function fF(r){const e=r.getAttribute?r.getAttribute(u2):null,t=r.getAttribute?r.getAttribute(c2):null;return e&&t}function pF(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(hn.replacementClass)}function mF(){return hn.autoReplaceSvg===!0?i0.replace:i0[hn.autoReplaceSvg]||i0.replace}function gF(r){return Mi.createElementNS("http://www.w3.org/2000/svg",r)}function yF(r){return Mi.createElement(r)}function uM(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{ceFn:t=r.tag==="svg"?gF:yF}=e;if(typeof r=="string")return Mi.createTextNode(r);const a=t(r.tag);return Object.keys(r.attributes||[]).forEach(function(m){a.setAttribute(m,r.attributes[m])}),(r.children||[]).forEach(function(m){a.appendChild(uM(m,{ceFn:t}))}),a}function _F(r){let e=" ".concat(r.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}const i0={replace:function(r){const e=r[0];if(e.parentNode)if(r[1].forEach(t=>{e.parentNode.insertBefore(uM(t),e)}),e.getAttribute(Up)===null&&hn.keepOriginalSource){let t=Mi.createComment(_F(e));e.parentNode.replaceChild(t,e)}else e.remove()},nest:function(r){const e=r[0],t=r[1];if(~d2(e).indexOf(hn.replacementClass))return i0.replace(r);const a=new RegExp("".concat(hn.cssPrefix,"-.*"));if(delete t[0].attributes.id,t[0].attributes.class){const m=t[0].attributes.class.split(" ").reduce((y,c)=>(c===hn.replacementClass||c.match(a)?y.toSvg.push(c):y.toNode.push(c),y),{toNode:[],toSvg:[]});t[0].attributes.class=m.toSvg.join(" "),m.toNode.length===0?e.removeAttribute("class"):e.setAttribute("class",m.toNode.join(" "))}const d=t.map(m=>G_(m)).join(`
`);e.setAttribute(Up,""),e.innerHTML=d}};function pE(r){r()}function cM(r,e){const t=typeof e=="function"?e:r0;if(r.length===0)t();else{let a=pE;hn.mutateApproach===xV&&(a=gf.requestAnimationFrame||pE),a(()=>{const d=mF(),m=y2.begin("mutate");r.map(d),m(),t()})}}let _2=!1;function hM(){_2=!0}function C1(){_2=!1}let O0=null;function mE(r){if(!tE||!hn.observeMutations)return;const{treeCallback:e=r0,nodeCallback:t=r0,pseudoElementsCallback:a=r0,observeMutationsRoot:d=Mi}=r;O0=new tE(m=>{if(_2)return;const y=yf();Sg(m).forEach(c=>{if(c.type==="childList"&&c.addedNodes.length>0&&!fE(c.addedNodes[0])&&(hn.searchPseudoElements&&a(c.target),e(c.target)),c.type==="attributes"&&c.target.parentNode&&hn.searchPseudoElements&&a(c.target.parentNode),c.type==="attributes"&&fE(c.target)&&~IV.indexOf(c.attributeName))if(c.attributeName==="class"&&fF(c.target)){const{prefix:P,iconName:k}=Ab(d2(c.target));c.target.setAttribute(u2,P||y),k&&c.target.setAttribute(c2,k)}else pF(c.target)&&t(c.target)})}),od&&O0.observe(d,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function vF(){O0&&O0.disconnect()}function bF(r){const e=r.getAttribute("style");let t=[];return e&&(t=e.split(";").reduce((a,d)=>{const m=d.split(":"),y=m[0],c=m.slice(1);return y&&c.length>0&&(a[y]=c.join(":").trim()),a},{})),t}function xF(r){const e=r.getAttribute("data-prefix"),t=r.getAttribute("data-icon"),a=r.innerText!==void 0?r.innerText.trim():"";let d=Ab(d2(r));return d.prefix||(d.prefix=yf()),e&&t&&(d.prefix=e,d.iconName=t),d.iconName&&d.prefix||(d.prefix&&a.length>0&&(d.iconName=HV(d.prefix,r.innerText)||m2(d.prefix,x1(r.innerText))),!d.iconName&&hn.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(d.iconName=r.firstChild.data)),d}function wF(r){const e=Sg(r.attributes).reduce((d,m)=>(d.name!=="class"&&d.name!=="style"&&(d[m.name]=m.value),d),{}),t=r.getAttribute("title"),a=r.getAttribute("data-fa-title-id");return hn.autoA11y&&(t?e["aria-labelledby"]="".concat(hn.replacementClass,"-title-").concat(a||x_()):(e["aria-hidden"]="true",e.focusable="false")),e}function TF(){return{iconName:null,title:null,titleId:null,prefix:null,transform:eh,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function gE(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0};const{iconName:t,prefix:a,rest:d}=xF(r),m=wF(r),y=T1("parseNodeAttributes",{},r);let c=e.styleParser?bF(r):[];return Ot({iconName:t,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:a,transform:eh,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:d,styles:c,attributes:m}},y)}const{styles:SF}=th;function dM(r){const e=hn.autoReplaceSvg==="nest"?gE(r,{styleParser:!1}):gE(r);return~e.extra.classes.indexOf(HP)?_f("generateLayersText",r,e):_f("generateSvgReplacementMutation",r,e)}function EF(){return[...aV,...m1]}function yE(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!od)return Promise.resolve();const t=Mi.documentElement.classList,a=B=>t.add("".concat(iE,"-").concat(B)),d=B=>t.remove("".concat(iE,"-").concat(B)),m=hn.autoFetchSvg?EF():VP.concat(Object.keys(SF));m.includes("fa")||m.push("fa");const y=[".".concat(HP,":not([").concat(Up,"])")].concat(m.map(B=>".".concat(B,":not([").concat(Up,"])"))).join(", ");if(y.length===0)return Promise.resolve();let c=[];try{c=Sg(r.querySelectorAll(y))}catch{}if(c.length>0)a("pending"),d("complete");else return Promise.resolve();const P=y2.begin("onTree"),k=c.reduce((B,X)=>{try{const G=dM(X);G&&B.push(G)}catch(G){qP||G.name==="MissingIcon"&&console.error(G)}return B},[]);return new Promise((B,X)=>{Promise.all(k).then(G=>{cM(G,()=>{a("active"),a("complete"),d("pending"),typeof e=="function"&&e(),P(),B()})}).catch(G=>{P(),X(G)})})}function AF(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;dM(r).then(t=>{t&&cM([t],e)})}function IF(r){return function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(e||{}).icon?e:S1(e||{});let{mask:d}=t;return d&&(d=(d||{}).icon?d:S1(d||{})),r(a,Ot(Ot({},t),{},{mask:d}))}}const CF=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:t=eh,symbol:a=!1,mask:d=null,maskId:m=null,title:y=null,titleId:c=null,classes:P=[],attributes:k={},styles:B={}}=e;if(!r)return;const{prefix:X,iconName:G,icon:W}=r;return Ib(Ot({type:"icon"},r),()=>(jp("beforeDOMElementCreation",{iconDefinition:r,params:e}),hn.autoA11y&&(y?k["aria-labelledby"]="".concat(hn.replacementClass,"-title-").concat(c||x_()):(k["aria-hidden"]="true",k.focusable="false")),g2({icons:{main:E1(W),mask:d?E1(d.icon):{found:!1,width:null,height:null,icon:{}}},prefix:X,iconName:G,transform:Ot(Ot({},eh),t),symbol:a,title:y,maskId:m,titleId:c,extra:{attributes:k,styles:B,classes:P}})))};var PF={mixout(){return{icon:IF(CF)}},hooks(){return{mutationObserverCallbacks(r){return r.treeCallback=yE,r.nodeCallback=AF,r}}},provides(r){r.i2svg=function(e){const{node:t=Mi,callback:a=()=>{}}=e;return yE(t,a)},r.generateSvgReplacementMutation=function(e,t){const{iconName:a,title:d,titleId:m,prefix:y,transform:c,symbol:P,mask:k,maskId:B,extra:X}=t;return new Promise((G,W)=>{Promise.all([A1(a,y),k.iconName?A1(k.iconName,k.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(ie=>{let[Ie,Re]=ie;G([e,g2({icons:{main:Ie,mask:Re},prefix:y,iconName:a,transform:c,symbol:P,maskId:B,title:d,titleId:m,extra:X,watchable:!0})])}).catch(W)})},r.generateAbstractIcon=function(e){let{children:t,attributes:a,main:d,transform:m,styles:y}=e;const c=Sb(y);c.length>0&&(a.style=c);let P;return f2(m)&&(P=_f("generateAbstractTransformGrouping",{main:d,transform:m,containerWidth:d.width,iconWidth:d.width})),t.push(P||d.icon),{children:t,attributes:a}}}},MF={mixout(){return{layer(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{classes:t=[]}=e;return Ib({type:"layer"},()=>{jp("beforeDOMElementCreation",{assembler:r,params:e});let a=[];return r(d=>{Array.isArray(d)?d.map(m=>{a=a.concat(m.abstract)}):a=a.concat(d.abstract)}),[{tag:"span",attributes:{class:["".concat(hn.cssPrefix,"-layers"),...t].join(" ")},children:a}]})}}}},RF={mixout(){return{counter(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{title:t=null,classes:a=[],attributes:d={},styles:m={}}=e;return Ib({type:"counter",content:r},()=>(jp("beforeDOMElementCreation",{content:r,params:e}),uF({content:r.toString(),title:t,extra:{attributes:d,styles:m,classes:["".concat(hn.cssPrefix,"-layers-counter"),...a]}})))}}}},kF={mixout(){return{text(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:t=eh,title:a=null,classes:d=[],attributes:m={},styles:y={}}=e;return Ib({type:"text",content:r},()=>(jp("beforeDOMElementCreation",{content:r,params:e}),hE({content:r,transform:Ot(Ot({},eh),t),title:a,extra:{attributes:m,styles:y,classes:["".concat(hn.cssPrefix,"-layers-text"),...d]}})))}}},provides(r){r.generateLayersText=function(e,t){const{title:a,transform:d,extra:m}=t;let y=null,c=null;if(NP){const P=parseInt(getComputedStyle(e).fontSize,10),k=e.getBoundingClientRect();y=k.width/P,c=k.height/P}return hn.autoA11y&&!a&&(m.attributes["aria-hidden"]="true"),Promise.resolve([e,hE({content:e.innerHTML,width:y,height:c,transform:d,title:a,extra:m,watchable:!0})])}}};const DF=new RegExp('"',"ug"),_E=[1105920,1112319],vE=Ot(Ot(Ot(Ot({},{FontAwesome:{normal:"fas",400:"fas"}}),nV),vV),dV),P1=Object.keys(vE).reduce((r,e)=>(r[e.toLowerCase()]=vE[e],r),{}),LF=Object.keys(P1).reduce((r,e)=>{const t=P1[e];return r[e]=t[900]||[...Object.entries(t)][0][1],r},{});function zF(r){const e=r.replace(DF,""),t=UV(e,0),a=t>=_E[0]&&t<=_E[1],d=e.length===2?e[0]===e[1]:!1;return{value:x1(d?e[0]:e),isSecondary:a||d}}function OF(r,e){const t=r.replace(/^['"]|['"]$/g,"").toLowerCase(),a=parseInt(e),d=isNaN(a)?"normal":a;return(P1[t]||{})[d]||LF[t]}function bE(r,e){const t="".concat(bV).concat(e.replace(":","-"));return new Promise((a,d)=>{if(r.getAttribute(t)!==null)return a();const y=Sg(r.children).filter(G=>G.getAttribute(y1)===e)[0],c=gf.getComputedStyle(r,e),P=c.getPropertyValue("font-family"),k=P.match(EV),B=c.getPropertyValue("font-weight"),X=c.getPropertyValue("content");if(y&&!k)return r.removeChild(y),a();if(k&&X!=="none"&&X!==""){const G=c.getPropertyValue("content");let W=OF(P,B);const{value:ie,isSecondary:Ie}=zF(G),Re=k[0].startsWith("FontAwesome");let Oe=m2(W,ie),Ke=Oe;if(Re){const mt=ZV(ie);mt.iconName&&mt.prefix&&(Oe=mt.iconName,W=mt.prefix)}if(Oe&&!Ie&&(!y||y.getAttribute(u2)!==W||y.getAttribute(c2)!==Ke)){r.setAttribute(t,Ke),y&&r.removeChild(y);const mt=TF(),{extra:qe}=mt;qe.attributes[y1]=e,A1(Oe,W).then(Fe=>{const We=g2(Ot(Ot({},mt),{},{icons:{main:Fe,mask:sM()},prefix:W,iconName:Ke,extra:qe,watchable:!0})),pe=Mi.createElementNS("http://www.w3.org/2000/svg","svg");e==="::before"?r.insertBefore(pe,r.firstChild):r.appendChild(pe),pe.outerHTML=We.map(oe=>G_(oe)).join(`
`),r.removeAttribute(t),a()}).catch(d)}else a()}else a()})}function NF(r){return Promise.all([bE(r,"::before"),bE(r,"::after")])}function BF(r){return r.parentNode!==document.head&&!~wV.indexOf(r.tagName.toUpperCase())&&!r.getAttribute(y1)&&(!r.parentNode||r.parentNode.tagName!=="svg")}function xE(r){if(od)return new Promise((e,t)=>{const a=Sg(r.querySelectorAll("*")).filter(BF).map(NF),d=y2.begin("searchPseudoElements");hM(),Promise.all(a).then(()=>{d(),C1(),e()}).catch(()=>{d(),C1(),t()})})}var VF={hooks(){return{mutationObserverCallbacks(r){return r.pseudoElementsCallback=xE,r}}},provides(r){r.pseudoElements2svg=function(e){const{node:t=Mi}=e;hn.searchPseudoElements&&xE(t)}}};let wE=!1;var FF={mixout(){return{dom:{unwatch(){hM(),wE=!0}}}},hooks(){return{bootstrap(){mE(T1("mutationObserverCallbacks",{}))},noAuto(){vF()},watch(r){const{observeMutationsRoot:e}=r;wE?C1():mE(T1("mutationObserverCallbacks",{observeMutationsRoot:e}))}}}};const TE=r=>{let e={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return r.toLowerCase().split(" ").reduce((t,a)=>{const d=a.toLowerCase().split("-"),m=d[0];let y=d.slice(1).join("-");if(m&&y==="h")return t.flipX=!0,t;if(m&&y==="v")return t.flipY=!0,t;if(y=parseFloat(y),isNaN(y))return t;switch(m){case"grow":t.size=t.size+y;break;case"shrink":t.size=t.size-y;break;case"left":t.x=t.x-y;break;case"right":t.x=t.x+y;break;case"up":t.y=t.y-y;break;case"down":t.y=t.y+y;break;case"rotate":t.rotate=t.rotate+y;break}return t},e)};var UF={mixout(){return{parse:{transform:r=>TE(r)}}},hooks(){return{parseNodeAttributes(r,e){const t=e.getAttribute("data-fa-transform");return t&&(r.transform=TE(t)),r}}},provides(r){r.generateAbstractTransformGrouping=function(e){let{main:t,transform:a,containerWidth:d,iconWidth:m}=e;const y={transform:"translate(".concat(d/2," 256)")},c="translate(".concat(a.x*32,", ").concat(a.y*32,") "),P="scale(".concat(a.size/16*(a.flipX?-1:1),", ").concat(a.size/16*(a.flipY?-1:1),") "),k="rotate(".concat(a.rotate," 0 0)"),B={transform:"".concat(c," ").concat(P," ").concat(k)},X={transform:"translate(".concat(m/2*-1," -256)")},G={outer:y,inner:B,path:X};return{tag:"g",attributes:Ot({},G.outer),children:[{tag:"g",attributes:Ot({},G.inner),children:[{tag:t.icon.tag,children:t.icon.children,attributes:Ot(Ot({},t.icon.attributes),G.path)}]}]}}}};const vx={x:0,y:0,width:"100%",height:"100%"};function SE(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r.attributes&&(r.attributes.fill||e)&&(r.attributes.fill="black"),r}function jF(r){return r.tag==="g"?r.children:[r]}var $F={hooks(){return{parseNodeAttributes(r,e){const t=e.getAttribute("data-fa-mask"),a=t?Ab(t.split(" ").map(d=>d.trim())):sM();return a.prefix||(a.prefix=yf()),r.mask=a,r.maskId=e.getAttribute("data-fa-mask-id"),r}}},provides(r){r.generateAbstractMask=function(e){let{children:t,attributes:a,main:d,mask:m,maskId:y,transform:c}=e;const{width:P,icon:k}=d,{width:B,icon:X}=m,G=zV({transform:c,containerWidth:B,iconWidth:P}),W={tag:"rect",attributes:Ot(Ot({},vx),{},{fill:"white"})},ie=k.children?{children:k.children.map(SE)}:{},Ie={tag:"g",attributes:Ot({},G.inner),children:[SE(Ot({tag:k.tag,attributes:Ot(Ot({},k.attributes),G.path)},ie))]},Re={tag:"g",attributes:Ot({},G.outer),children:[Ie]},Oe="mask-".concat(y||x_()),Ke="clip-".concat(y||x_()),mt={tag:"mask",attributes:Ot(Ot({},vx),{},{id:Oe,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[W,Re]},qe={tag:"defs",children:[{tag:"clipPath",attributes:{id:Ke},children:jF(X)},mt]};return t.push(qe,{tag:"rect",attributes:Ot({fill:"currentColor","clip-path":"url(#".concat(Ke,")"),mask:"url(#".concat(Oe,")")},vx)}),{children:t,attributes:a}}}},qF={provides(r){let e=!1;gf.matchMedia&&(e=gf.matchMedia("(prefers-reduced-motion: reduce)").matches),r.missingIconAbstract=function(){const t=[],a={fill:"currentColor"},d={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};t.push({tag:"path",attributes:Ot(Ot({},a),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const m=Ot(Ot({},d),{},{attributeName:"opacity"}),y={tag:"circle",attributes:Ot(Ot({},a),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||y.children.push({tag:"animate",attributes:Ot(Ot({},d),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Ot(Ot({},m),{},{values:"1;0;1;1;0;1;"})}),t.push(y),t.push({tag:"path",attributes:Ot(Ot({},a),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:Ot(Ot({},m),{},{values:"1;0;0;0;0;1;"})}]}),e||t.push({tag:"path",attributes:Ot(Ot({},a),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Ot(Ot({},m),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:t}}}},GF={hooks(){return{parseNodeAttributes(r,e){const t=e.getAttribute("data-fa-symbol"),a=t===null?!1:t===""?!0:t;return r.symbol=a,r}}}},HF=[BV,PF,MF,RF,kF,VF,FF,UF,$F,qF,GF];nF(HF,{mixoutsTo:kl});kl.noAuto;kl.config;kl.library;kl.dom;const M1=kl.parse;kl.findIconDefinition;kl.toHtml;const ZF=kl.icon;kl.layer;kl.text;kl.counter;var bx={exports:{}},xx,EE;function KF(){if(EE)return xx;EE=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return xx=r,xx}var wx,AE;function WF(){if(AE)return wx;AE=1;var r=KF();function e(){}function t(){}return t.resetWarningCache=e,wx=function(){function a(y,c,P,k,B,X){if(X!==r){var G=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw G.name="Invariant Violation",G}}a.isRequired=a;function d(){return a}var m={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:d,element:a,elementType:a,instanceOf:d,node:a,objectOf:d,oneOf:d,oneOfType:d,shape:d,exact:d,checkPropTypes:t,resetWarningCache:e};return m.PropTypes=m,m},wx}var IE;function XF(){return IE||(IE=1,bx.exports=WF()()),bx.exports}var YF=XF();const ar=S_(YF);function CE(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),t.push.apply(t,a)}return t}function Qc(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?CE(Object(t),!0).forEach(function(a){Hm(r,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):CE(Object(t)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(t,a))})}return r}function N0(r){"@babel/helpers - typeof";return N0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N0(r)}function Hm(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function QF(r,e){if(r==null)return{};var t={},a=Object.keys(r),d,m;for(m=0;m<a.length;m++)d=a[m],!(e.indexOf(d)>=0)&&(t[d]=r[d]);return t}function JF(r,e){if(r==null)return{};var t=QF(r,e),a,d;if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(r);for(d=0;d<m.length;d++)a=m[d],!(e.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(r,a)&&(t[a]=r[a])}return t}function R1(r){return eU(r)||tU(r)||nU(r)||rU()}function eU(r){if(Array.isArray(r))return k1(r)}function tU(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function nU(r,e){if(r){if(typeof r=="string")return k1(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return k1(r,e)}}function k1(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=r[t];return a}function rU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iU(r){var e,t=r.beat,a=r.fade,d=r.beatFade,m=r.bounce,y=r.shake,c=r.flash,P=r.spin,k=r.spinPulse,B=r.spinReverse,X=r.pulse,G=r.fixedWidth,W=r.inverse,ie=r.border,Ie=r.listItem,Re=r.flip,Oe=r.size,Ke=r.rotation,mt=r.pull,qe=(e={"fa-beat":t,"fa-fade":a,"fa-beat-fade":d,"fa-bounce":m,"fa-shake":y,"fa-flash":c,"fa-spin":P,"fa-spin-reverse":B,"fa-spin-pulse":k,"fa-pulse":X,"fa-fw":G,"fa-inverse":W,"fa-border":ie,"fa-li":Ie,"fa-flip":Re===!0,"fa-flip-horizontal":Re==="horizontal"||Re==="both","fa-flip-vertical":Re==="vertical"||Re==="both"},Hm(e,"fa-".concat(Oe),typeof Oe<"u"&&Oe!==null),Hm(e,"fa-rotate-".concat(Ke),typeof Ke<"u"&&Ke!==null&&Ke!==0),Hm(e,"fa-pull-".concat(mt),typeof mt<"u"&&mt!==null),Hm(e,"fa-swap-opacity",r.swapOpacity),e);return Object.keys(qe).map(function(Fe){return qe[Fe]?Fe:null}).filter(function(Fe){return Fe})}function aU(r){return r=r-0,r===r}function fM(r){return aU(r)?r:(r=r.replace(/[\-_\s]+(.)?/g,function(e,t){return t?t.toUpperCase():""}),r.substr(0,1).toLowerCase()+r.substr(1))}var sU=["style"];function oU(r){return r.charAt(0).toUpperCase()+r.slice(1)}function lU(r){return r.split(";").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,t){var a=t.indexOf(":"),d=fM(t.slice(0,a)),m=t.slice(a+1).trim();return d.startsWith("webkit")?e[oU(d)]=m:e[d]=m,e},{})}function pM(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string")return e;var a=(e.children||[]).map(function(P){return pM(r,P)}),d=Object.keys(e.attributes||{}).reduce(function(P,k){var B=e.attributes[k];switch(k){case"class":P.attrs.className=B,delete e.attributes.class;break;case"style":P.attrs.style=lU(B);break;default:k.indexOf("aria-")===0||k.indexOf("data-")===0?P.attrs[k.toLowerCase()]=B:P.attrs[fM(k)]=B}return P},{attrs:{}}),m=t.style,y=m===void 0?{}:m,c=JF(t,sU);return d.attrs.style=Qc(Qc({},d.attrs.style),y),r.apply(void 0,[e.tag,Qc(Qc({},d.attrs),c)].concat(R1(a)))}var mM=!1;try{mM=!0}catch{}function uU(){if(!mM&&console&&typeof console.error=="function"){var r;(r=console).error.apply(r,arguments)}}function PE(r){if(r&&N0(r)==="object"&&r.prefix&&r.iconName&&r.icon)return r;if(M1.icon)return M1.icon(r);if(r===null)return null;if(r&&N0(r)==="object"&&r.prefix&&r.iconName)return r;if(Array.isArray(r)&&r.length===2)return{prefix:r[0],iconName:r[1]};if(typeof r=="string")return{prefix:"fas",iconName:r}}function Tx(r,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?Hm({},r,e):{}}var ME={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},T_=L1.forwardRef(function(r,e){var t=Qc(Qc({},ME),r),a=t.icon,d=t.mask,m=t.symbol,y=t.className,c=t.title,P=t.titleId,k=t.maskId,B=PE(a),X=Tx("classes",[].concat(R1(iU(t)),R1((y||"").split(" ")))),G=Tx("transform",typeof t.transform=="string"?M1.transform(t.transform):t.transform),W=Tx("mask",PE(d)),ie=ZF(B,Qc(Qc(Qc(Qc({},X),G),W),{},{symbol:m,title:c,titleId:P,maskId:k}));if(!ie)return uU("Could not find icon",B),null;var Ie=ie.abstract,Re={ref:e};return Object.keys(t).forEach(function(Oe){ME.hasOwnProperty(Oe)||(Re[Oe]=t[Oe])}),cU(Ie[0],Re)});T_.displayName="FontAwesomeIcon";T_.propTypes={beat:ar.bool,border:ar.bool,beatFade:ar.bool,bounce:ar.bool,className:ar.string,fade:ar.bool,flash:ar.bool,mask:ar.oneOfType([ar.object,ar.array,ar.string]),maskId:ar.string,fixedWidth:ar.bool,inverse:ar.bool,flip:ar.oneOf([!0,!1,"horizontal","vertical","both"]),icon:ar.oneOfType([ar.object,ar.array,ar.string]),listItem:ar.bool,pull:ar.oneOf(["right","left"]),pulse:ar.bool,rotation:ar.oneOf([0,90,180,270]),shake:ar.bool,size:ar.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:ar.bool,spinPulse:ar.bool,spinReverse:ar.bool,symbol:ar.oneOfType([ar.bool,ar.string]),title:ar.string,titleId:ar.string,transform:ar.oneOfType([ar.string,ar.object]),swapOpacity:ar.bool};var cU=pM.bind(null,L1.createElement);/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const hU={prefix:"fas",iconName:"pencil",icon:[512,512,[9999,61504,"pencil-alt"],"f303","M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1 0 32c0 8.8 7.2 16 16 16l32 0zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"]},dU=hU,fU={prefix:"fas",iconName:"arrows-rotate",icon:[512,512,[128472,"refresh","sync"],"f021","M105.1 202.6c7.7-21.8 20.2-42.3 37.8-59.8c62.5-62.5 163.8-62.5 226.3 0L386.3 160 352 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l111.5 0c0 0 0 0 0 0l.4 0c17.7 0 32-14.3 32-32l0-112c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 35.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5zM39 289.3c-5 1.5-9.8 4.2-13.7 8.2c-4 4-6.7 8.8-8.1 14c-.3 1.2-.6 2.5-.8 3.8c-.3 1.7-.4 3.4-.4 5.1L16 432c0 17.7 14.3 32 32 32s32-14.3 32-32l0-35.1 17.6 17.5c0 0 0 0 0 0c87.5 87.4 229.3 87.4 316.7 0c24.4-24.4 42.1-53.1 52.9-83.8c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.5 62.5-163.8 62.5-226.3 0l-.1-.1L125.6 352l34.4 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L48.4 288c-1.6 0-3.2 .1-4.8 .3s-3.1 .5-4.6 1z"]},pU=fU,mU={prefix:"fas",iconName:"trash",icon:[448,512,[],"f1f8","M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z"]};function gU(){const[r,e]=ct.useState([]),[t,a]=ct.useState([]),[d,m]=ct.useState(0),[y,c]=ct.useState(""),[P,k]=ct.useState(0),[B,X]=ct.useState(!0),[G,W]=ct.useState(null),[ie,Ie]=ct.useState(!0),Re=mt=>{const qe=[...mt];for(let Fe=qe.length-1;Fe>0;Fe--){const We=Math.floor(Math.random()*(Fe+1));[qe[Fe],qe[We]]=[qe[We],qe[Fe]]}return qe};ct.useEffect(()=>{(async()=>{try{const Fe=(await zw(S0($h,"Callsigns"))).docs.map(We=>({id:We.id,...We.data()}));e(Fe),a(Re(Fe)),X(!1)}catch(qe){W("Failed to fetch callsigns: "+qe.message),X(!1)}})()},[]);const Oe=()=>{Ie(!ie),c(""),m(0),k(0),a(Re(r))},Ke=mt=>{mt.preventDefault();const qe=t[d],Fe=y.trim().replace(/\s/g,"").toLowerCase(),We=ie?qe.Callsign.replace(/\s/g,"").toLowerCase():qe["ICAO Code"].replace(/\s/g,"").toLowerCase();Fe===We?d+1<t.length?(m(d+1),c("")):(a(Re(r)),m(0),k(0),c("")):k(P+1)};return B?He.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[He.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Callsign Quiz"}),He.jsx("p",{children:"Loading..."})]}):G?He.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[He.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Callsign Quiz"}),He.jsx("p",{className:"text-red-500",children:G})]}):r.length===0?He.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[He.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Callsign Quiz"}),He.jsx("p",{children:"No callsigns found."})]}):He.jsx("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:He.jsxs("div",{className:"bg-white p-6 rounded-lg shadow max-w-md w-full flex flex-col gap-4 relative",children:[He.jsx("button",{onClick:Oe,title:"Toggle Question Type",className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",children:He.jsx(T_,{icon:pU})}),He.jsx("div",{children:He.jsx("p",{className:"text-lg font-bold flex justify-center",children:ie?t[d]["ICAO Code"]:t[d].Callsign})}),He.jsxs("form",{onSubmit:Ke,className:"flex flex-col gap-4",children:[He.jsx("input",{type:"text",value:y,onChange:mt=>c(mt.target.value),placeholder:ie?"Enter Callsign":"Enter ICAO Code",className:"p-2 border rounded",autoFocus:!0}),He.jsx("button",{type:"submit",className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Next Callsign"})]}),He.jsxs("div",{className:"flex justify-between",children:[He.jsxs("p",{className:"text-lg font-bold text-gray-500",children:["Errors: ",P]}),He.jsxs("p",{className:"text-lg font-bold text-gray-500",children:["Question: ",d+1,"/",t.length]})]})]})})}function yU(){return He.jsxs("div",{className:"container mx-auto p-4",children:[He.jsx("h1",{className:"text-2xl font-bold",children:"Constraints"}),He.jsx("p",{children:"This is the Constraints page."})]})}function _U(){return He.jsxs("div",{className:"container mx-auto p-4",children:[He.jsx("h1",{className:"text-2xl font-bold",children:"External Points"}),He.jsx("p",{children:"This is the External Points page."})]})}function vU(){return He.jsxs("div",{className:"container mx-auto p-4",children:[He.jsx("h1",{className:"text-2xl font-bold",children:"Internal Points"}),He.jsx("p",{children:"This is the Internal Points page."})]})}function bU(){const[r,e]=ct.useState(""),[t,a]=ct.useState(""),[d,m]=ct.useState(null),[y,c]=ct.useState(null),[P,k]=ct.useState(!1);ct.useEffect(()=>{const W=Sp.onAuthStateChanged(async ie=>{if(ie)try{const Ie=await TC(Ym($h,"users",ie.uid));if(Ie.exists()){const Re=Ie.data().role;m(Re)}else m(null)}catch(Ie){c(Ie.message)}else m(null)});return()=>W()},[]);const B=async W=>{W.preventDefault();try{await RA(Sp,r,t),c(null),e(""),a("")}catch(ie){c(ie.message)}},X=async W=>{W.preventDefault();try{const ie=await O5(Sp,r,t);await l4(Ym($h,"users",ie.user.uid),{role:"ATCO"}),m("ATCO"),c(null),e(""),a(""),k(!1)}catch(ie){c(ie.message)}},G=async()=>{try{await V5(Sp),m(null),c(null)}catch(W){c(W.message)}};return Sp.currentUser?He.jsxs("div",{className:"container mx-auto p-4 min-h-screen bg-gray-100",children:[He.jsx("h1",{className:"text-2xl font-bold mb-8 text-center",children:"Dashboard"}),d==="Supervisor"?He.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[He.jsx(Co,{to:"/dashboard/aircrafts",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:He.jsx("h3",{className:"text-lg font-semibold text-center",children:"Aircrafts"})}),He.jsx(Co,{to:"/dashboard/airspaces",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:He.jsx("h3",{className:"text-lg font-semibold text-center",children:"Airspaces"})}),He.jsx(Co,{to:"/dashboard/callsigns",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:He.jsx("h3",{className:"text-lg font-semibold text-center",children:"Callsigns"})}),He.jsx(Co,{to:"/dashboard/constraints",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:He.jsx("h3",{className:"text-lg font-semibold text-center",children:"Constraints"})}),He.jsx(Co,{to:"/dashboard/ext_points",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:He.jsx("h3",{className:"text-lg font-semibold text-center",children:"External Points"})}),He.jsx(Co,{to:"/dashboard/int_points",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:He.jsx("h3",{className:"text-lg font-semibold text-center",children:"Internal Points"})})]}):He.jsx("div",{className:"bg-white p-6 rounded-lg shadow max-w-md w-full mx-auto",children:He.jsx("p",{className:"text-lg mb-4 text-center",children:"Nincs jogosultságod módosítani az adatbázist"})}),He.jsx("div",{className:"flex justify-center mt-6",children:He.jsx("button",{onClick:G,className:"p-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Logout"})}),y&&He.jsx("p",{className:"mt-4 text-red-500 text-center",children:y})]}):He.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[He.jsx("h1",{className:"text-2xl font-bold mb-8",children:"Dashboard"}),He.jsxs("div",{className:"bg-white p-6 rounded-lg shadow max-w-md w-full",children:[He.jsx("h2",{className:"text-xl font-semibold mb-4",children:P?"Register":"Login"}),He.jsxs("form",{onSubmit:P?X:B,className:"flex flex-col gap-4",children:[He.jsx("input",{type:"email",value:r,onChange:W=>e(W.target.value),placeholder:"Email",className:"p-2 border rounded"}),He.jsx("input",{type:"password",value:t,onChange:W=>a(W.target.value),placeholder:"Password",className:"p-2 border rounded"}),He.jsx("button",{type:"submit",className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:P?"Register":"Login"})]}),He.jsx("button",{onClick:()=>k(!P),className:"mt-4 text-blue-500 hover:underline",children:P?"Switch to Login":"Switch to Register"}),y&&He.jsx("p",{className:"mt-4 text-red-500",children:y})]})]})}function xU(){return He.jsx("div",{className:"container mx-auto p-4",children:He.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard Aircrafts"})})}function wU(){return He.jsx("div",{className:"container mx-auto p-4",children:He.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard Airspaces"})})}function TU(){const[r,e]=ct.useState([]),[t,a]=ct.useState(!0),[d,m]=ct.useState(null),[y,c]=ct.useState(""),[P,k]=ct.useState(""),[B,X]=ct.useState(!1),[G,W]=ct.useState(null),[ie,Ie]=ct.useState(""),[Re,Oe]=ct.useState("");ct.useEffect(()=>{(async()=>{try{const pe=Sp.currentUser;if(pe){const Ce=await TC(Ym($h,"users",pe.uid));Ce.exists()&&X(Ce.data().role==="Supervisor")}const oe=r4(S0($h,"Callsigns"),i4("Callsign","asc")),be=(await zw(oe)).docs.map(Ce=>({id:Ce.id,...Ce.data()}));e(be),a(!1)}catch(pe){m("Failed to fetch data: "+pe.message),a(!1)}})()},[]);const Ke=async We=>{if(We.key!=="Enter")return;const pe=y.trim().toUpperCase();if(pe.length!==3){m("ICAO Code must be exactly 3 characters.");return}if(!P.trim()){m("Callsign is required.");return}if(!B){m("Only Supervisors can add callsigns.");return}try{const oe=await h4(S0($h,"Callsigns"),{"ICAO Code":pe,Callsign:P.trim()});e(me=>[...me,{id:oe.id,"ICAO Code":pe,Callsign:P.trim()}].sort((Ce,Ve)=>Ce.Callsign.localeCompare(Ve.Callsign))),c(""),k(""),m(null)}catch(oe){m("Failed to add callsign: "+oe.message)}},mt=We=>{if(!B){m("Only Supervisors can edit callsigns.");return}W(We.id),Ie(We["ICAO Code"]),Oe(We.Callsign)},qe=async We=>{if(We.key!=="Enter")return;const pe=ie.trim().toUpperCase();if(pe.length!==3){m("ICAO Code must be exactly 3 characters.");return}if(!Re.trim()){m("Callsign is required.");return}try{const oe=Ym($h,"Callsigns",G);await u4(oe,{"ICAO Code":pe,Callsign:Re.trim()}),e(me=>me.map(Ce=>Ce.id===G?{...Ce,"ICAO Code":pe,Callsign:Re.trim()}:Ce).sort((Ce,Ve)=>Ce.Callsign.localeCompare(Ve.Callsign))),W(null),Ie(""),Oe(""),m(null)}catch(oe){m("Failed to update callsign: "+oe.message)}},Fe=async We=>{if(!B){m("Only Supervisors can delete callsigns.");return}try{await c4(Ym($h,"Callsigns",We)),e(pe=>pe.filter(oe=>oe.id!==We)),m(null)}catch(pe){m("Failed to delete callsign: "+pe.message)}};return t?He.jsxs("div",{className:"container mx-auto p-4",children:[He.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Callsigns"}),He.jsx("p",{children:"Loading..."})]}):d?He.jsxs("div",{className:"container mx-auto p-4",children:[He.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Callsigns"}),He.jsx("p",{className:"text-red-600",children:d})]}):He.jsxs("div",{className:"container mx-auto p-4",children:[He.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Callsigns"}),He.jsx("div",{className:"overflow-x-auto",children:He.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[He.jsx("thead",{children:He.jsxs("tr",{className:"bg-blue-100",children:[He.jsx("th",{className:"py-2 px-3 border-b text-left",children:"ID"}),He.jsx("th",{className:"py-2 px-3 border-b text-left",children:"ICAO Code"}),He.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Callsign"}),He.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Actions"})]})}),He.jsxs("tbody",{children:[r.map((We,pe)=>He.jsxs("tr",{className:"hover:bg-gray-50",children:[He.jsx("td",{className:"py-2 px-3 border-b",children:pe+1}),He.jsx("td",{className:"py-2 px-3 border-b",children:G===We.id?He.jsx("input",{type:"text",value:ie,onChange:oe=>Ie(oe.target.value),onKeyDown:qe,maxLength:3,className:"w-full p-2 border rounded"}):We["ICAO Code"]}),He.jsx("td",{className:"py-2 px-3 border-b",children:G===We.id?He.jsx("input",{type:"text",value:Re,onChange:oe=>Oe(oe.target.value),onKeyDown:qe,className:"w-full p-2 border rounded"}):We.Callsign}),He.jsx("td",{className:"py-2 px-3 border-b flex space-x-2",children:B&&He.jsxs(He.Fragment,{children:[He.jsx("button",{onClick:()=>mt(We),title:"Edit",className:"text-yellow-500 hover:text-yellow-700 mr-2",disabled:G!==null,children:He.jsx(T_,{icon:dU})}),He.jsx("button",{onClick:()=>Fe(We.id),title:"Delete",className:"text-red-500 hover:text-red-700",disabled:G!==null,children:He.jsx(T_,{icon:mU})})]})})]},We.id)),He.jsxs("tr",{children:[He.jsx("td",{className:"py-2 px-3 border-b",children:r.length+1}),He.jsx("td",{className:"py-2 px-3 border-b",children:He.jsx("input",{type:"text",value:y,onChange:We=>c(We.target.value),onKeyDown:Ke,placeholder:"Enter ICAO Code",maxLength:3,className:"w-full p-2 border rounded",disabled:!B||G!==null})}),He.jsx("td",{className:"py-2 px-3 border-b",children:He.jsx("input",{type:"text",value:P,onChange:We=>k(We.target.value),onKeyDown:Ke,placeholder:"Enter Callsign",className:"w-full p-2 border rounded",disabled:!B||G!==null})}),He.jsx("td",{className:"py-2 px-3 border-b"})]})]})]})}),d&&He.jsx("p",{className:"mt-4 text-red-600",children:d})]})}function SU(){return He.jsx("div",{className:"container mx-auto p-4",children:He.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard Constraints"})})}function EU(){return He.jsx("div",{className:"container mx-auto p-4",children:He.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard External Points"})})}function AU(){return He.jsx("div",{className:"container mx-auto p-4",children:He.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard Internal Points"})})}function IU(){const[r,e]=ct.useState(""),[t,a]=ct.useState(""),d=async m=>{m.preventDefault();try{await RA(Sp,r,t),alert("Successfully logged in!")}catch(y){alert(y.message)}};return He.jsxs("div",{className:"container mx-auto p-4",children:[He.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Login"}),He.jsxs("form",{onSubmit:d,className:"flex flex-col gap-4 max-w-sm",children:[He.jsx("input",{type:"email",value:r,onChange:m=>e(m.target.value),placeholder:"Email",className:"p-2 border rounded"}),He.jsx("input",{type:"password",value:t,onChange:m=>a(m.target.value),placeholder:"Password",className:"p-2 border rounded"}),He.jsx("button",{type:"submit",className:"p-2 bg-blue-500 text-white rounded",children:"Login"})]})]})}function CU(){return He.jsx("div",{className:"min-h-screen bg-gray-100",children:He.jsxs(bR,{children:[He.jsx(Js,{path:"/login",element:He.jsx(IU,{})}),He.jsx(Js,{path:"/",element:He.jsxs("div",{className:"container mx-auto p-4",children:[He.jsx("h1",{className:"text-3xl font-bold text-center mb-8 text-blue-600",children:"ATCO Training"}),He.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[He.jsx(Co,{to:"/airspaces",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:He.jsx("h2",{className:"text-xl font-semibold text-center",children:"Airspaces"})}),He.jsx(Co,{to:"/aircrafts",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:He.jsx("h2",{className:"text-xl font-semibold text-center",children:"Aircrafts"})}),He.jsx(Co,{to:"/callsigns",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:He.jsx("h2",{className:"text-xl font-semibold text-center",children:"Callsigns"})}),He.jsx(Co,{to:"/constraints",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:He.jsx("h2",{className:"text-xl font-semibold text-center",children:"Constraints"})}),He.jsx(Co,{to:"/ext_points",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:He.jsx("h2",{className:"text-xl font-semibold text-center",children:"External Points"})}),He.jsx(Co,{to:"/int_points",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:He.jsx("h2",{className:"text-xl font-semibold text-center",children:"Internal Points"})}),He.jsx(Co,{to:"/dashboard",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:He.jsx("h2",{className:"text-xl font-semibold text-center",children:"Dashboard"})})]})]})}),He.jsx(Js,{path:"/airspaces",element:He.jsx(GB,{})}),He.jsx(Js,{path:"/aircrafts",element:He.jsx(HB,{})}),He.jsx(Js,{path:"/callsigns",element:He.jsx(gU,{})}),He.jsx(Js,{path:"/constraints",element:He.jsx(yU,{})}),He.jsx(Js,{path:"/ext_points",element:He.jsx(_U,{})}),He.jsx(Js,{path:"/int_points",element:He.jsx(vU,{})}),He.jsx(Js,{path:"/dashboard",element:He.jsx(bU,{})}),He.jsx(Js,{path:"/dashboard/aircrafts",element:He.jsx(xU,{})}),He.jsx(Js,{path:"/dashboard/airspaces",element:He.jsx(wU,{})}),He.jsx(Js,{path:"/dashboard/callsigns",element:He.jsx(TU,{})}),He.jsx(Js,{path:"/dashboard/constraints",element:He.jsx(SU,{})}),He.jsx(Js,{path:"/dashboard/ext_points",element:He.jsx(EU,{})}),He.jsx(Js,{path:"/dashboard/int_points",element:He.jsx(AU,{})})]})})}CM.createRoot(document.getElementById("root")).render(He.jsx(L1.StrictMode,{children:He.jsx(qR,{children:He.jsx(CU,{})})}));
