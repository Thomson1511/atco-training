(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const y of m.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&a(y)}).observe(document,{childList:!0,subtree:!0});function t(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function a(d){if(d.ep)return;d.ep=!0;const m=t(d);fetch(d.href,m)}})();function A_(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var jb={exports:{}},zy={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C2;function AP(){if(C2)return zy;C2=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,d,m){var y=null;if(m!==void 0&&(y=""+m),d.key!==void 0&&(y=""+d.key),"key"in d){m={};for(var c in d)c!=="key"&&(m[c]=d[c])}else m=d;return d=m.ref,{$$typeof:r,type:a,key:y,ref:d!==void 0?d:null,props:m}}return zy.Fragment=e,zy.jsx=t,zy.jsxs=t,zy}var I2;function CP(){return I2||(I2=1,jb.exports=AP()),jb.exports}var de=CP(),Ub={exports:{}},Kn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M2;function IP(){if(M2)return Kn;M2=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),y=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),R=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),K=Symbol.iterator;function $(Re){return Re===null||typeof Re!="object"?null:(Re=K&&Re[K]||Re["@@iterator"],typeof Re=="function"?Re:null)}var W={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},re=Object.assign,Me={};function Ce(Re,_t,At){this.props=Re,this.context=_t,this.refs=Me,this.updater=At||W}Ce.prototype.isReactComponent={},Ce.prototype.setState=function(Re,_t){if(typeof Re!="object"&&typeof Re!="function"&&Re!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Re,_t,"setState")},Ce.prototype.forceUpdate=function(Re){this.updater.enqueueForceUpdate(this,Re,"forceUpdate")};function Be(){}Be.prototype=Ce.prototype;function He(Re,_t,At){this.props=Re,this.context=_t,this.refs=Me,this.updater=At||W}var ut=He.prototype=new Be;ut.constructor=He,re(ut,Ce.prototype),ut.isPureReactComponent=!0;var Ue=Array.isArray,Fe={H:null,A:null,T:null,S:null,V:null},Ze=Object.prototype.hasOwnProperty;function me(Re,_t,At,St,Qt,En){return At=En.ref,{$$typeof:r,type:Re,key:_t,ref:At!==void 0?At:null,props:En}}function se(Re,_t){return me(Re.type,_t,void 0,void 0,void 0,Re.props)}function ye(Re){return typeof Re=="object"&&Re!==null&&Re.$$typeof===r}function we(Re){var _t={"=":"=0",":":"=2"};return"$"+Re.replace(/[=:]/g,function(At){return _t[At]})}var Ee=/\/+/g;function ke(Re,_t){return typeof Re=="object"&&Re!==null&&Re.key!=null?we(""+Re.key):_t.toString(36)}function ve(){}function Bt(Re){switch(Re.status){case"fulfilled":return Re.value;case"rejected":throw Re.reason;default:switch(typeof Re.status=="string"?Re.then(ve,ve):(Re.status="pending",Re.then(function(_t){Re.status==="pending"&&(Re.status="fulfilled",Re.value=_t)},function(_t){Re.status==="pending"&&(Re.status="rejected",Re.reason=_t)})),Re.status){case"fulfilled":return Re.value;case"rejected":throw Re.reason}}throw Re}function Kt(Re,_t,At,St,Qt){var En=typeof Re;(En==="undefined"||En==="boolean")&&(Re=null);var gn=!1;if(Re===null)gn=!0;else switch(En){case"bigint":case"string":case"number":gn=!0;break;case"object":switch(Re.$$typeof){case r:case e:gn=!0;break;case B:return gn=Re._init,Kt(gn(Re._payload),_t,At,St,Qt)}}if(gn)return Qt=Qt(Re),gn=St===""?"."+ke(Re,0):St,Ue(Qt)?(At="",gn!=null&&(At=gn.replace(Ee,"$&/")+"/"),Kt(Qt,_t,At,"",function(Cr){return Cr})):Qt!=null&&(ye(Qt)&&(Qt=se(Qt,At+(Qt.key==null||Re&&Re.key===Qt.key?"":(""+Qt.key).replace(Ee,"$&/")+"/")+gn)),_t.push(Qt)),1;gn=0;var ii=St===""?".":St+":";if(Ue(Re))for(var wr=0;wr<Re.length;wr++)St=Re[wr],En=ii+ke(St,wr),gn+=Kt(St,_t,At,En,Qt);else if(wr=$(Re),typeof wr=="function")for(Re=wr.call(Re),wr=0;!(St=Re.next()).done;)St=St.value,En=ii+ke(St,wr++),gn+=Kt(St,_t,At,En,Qt);else if(En==="object"){if(typeof Re.then=="function")return Kt(Bt(Re),_t,At,St,Qt);throw _t=String(Re),Error("Objects are not valid as a React child (found: "+(_t==="[object Object]"?"object with keys {"+Object.keys(Re).join(", ")+"}":_t)+"). If you meant to render a collection of children, use an array instead.")}return gn}function et(Re,_t,At){if(Re==null)return Re;var St=[],Qt=0;return Kt(Re,St,"","",function(En){return _t.call(At,En,Qt++)}),St}function Mt(Re){if(Re._status===-1){var _t=Re._result;_t=_t(),_t.then(function(At){(Re._status===0||Re._status===-1)&&(Re._status=1,Re._result=At)},function(At){(Re._status===0||Re._status===-1)&&(Re._status=2,Re._result=At)}),Re._status===-1&&(Re._status=0,Re._result=_t)}if(Re._status===1)return Re._result.default;throw Re._result}var Tt=typeof reportError=="function"?reportError:function(Re){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Re=="object"&&Re!==null&&typeof Re.message=="string"?String(Re.message):String(Re),error:Re});if(!window.dispatchEvent(_t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Re);return}console.error(Re)};function Gt(){}return Kn.Children={map:et,forEach:function(Re,_t,At){et(Re,function(){_t.apply(this,arguments)},At)},count:function(Re){var _t=0;return et(Re,function(){_t++}),_t},toArray:function(Re){return et(Re,function(_t){return _t})||[]},only:function(Re){if(!ye(Re))throw Error("React.Children.only expected to receive a single React element child.");return Re}},Kn.Component=Ce,Kn.Fragment=t,Kn.Profiler=d,Kn.PureComponent=He,Kn.StrictMode=a,Kn.Suspense=M,Kn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Fe,Kn.__COMPILER_RUNTIME={__proto__:null,c:function(Re){return Fe.H.useMemoCache(Re)}},Kn.cache=function(Re){return function(){return Re.apply(null,arguments)}},Kn.cloneElement=function(Re,_t,At){if(Re==null)throw Error("The argument must be a React element, but you passed "+Re+".");var St=re({},Re.props),Qt=Re.key,En=void 0;if(_t!=null)for(gn in _t.ref!==void 0&&(En=void 0),_t.key!==void 0&&(Qt=""+_t.key),_t)!Ze.call(_t,gn)||gn==="key"||gn==="__self"||gn==="__source"||gn==="ref"&&_t.ref===void 0||(St[gn]=_t[gn]);var gn=arguments.length-2;if(gn===1)St.children=At;else if(1<gn){for(var ii=Array(gn),wr=0;wr<gn;wr++)ii[wr]=arguments[wr+2];St.children=ii}return me(Re.type,Qt,void 0,void 0,En,St)},Kn.createContext=function(Re){return Re={$$typeof:y,_currentValue:Re,_currentValue2:Re,_threadCount:0,Provider:null,Consumer:null},Re.Provider=Re,Re.Consumer={$$typeof:m,_context:Re},Re},Kn.createElement=function(Re,_t,At){var St,Qt={},En=null;if(_t!=null)for(St in _t.key!==void 0&&(En=""+_t.key),_t)Ze.call(_t,St)&&St!=="key"&&St!=="__self"&&St!=="__source"&&(Qt[St]=_t[St]);var gn=arguments.length-2;if(gn===1)Qt.children=At;else if(1<gn){for(var ii=Array(gn),wr=0;wr<gn;wr++)ii[wr]=arguments[wr+2];Qt.children=ii}if(Re&&Re.defaultProps)for(St in gn=Re.defaultProps,gn)Qt[St]===void 0&&(Qt[St]=gn[St]);return me(Re,En,void 0,void 0,null,Qt)},Kn.createRef=function(){return{current:null}},Kn.forwardRef=function(Re){return{$$typeof:c,render:Re}},Kn.isValidElement=ye,Kn.lazy=function(Re){return{$$typeof:B,_payload:{_status:-1,_result:Re},_init:Mt}},Kn.memo=function(Re,_t){return{$$typeof:R,type:Re,compare:_t===void 0?null:_t}},Kn.startTransition=function(Re){var _t=Fe.T,At={};Fe.T=At;try{var St=Re(),Qt=Fe.S;Qt!==null&&Qt(At,St),typeof St=="object"&&St!==null&&typeof St.then=="function"&&St.then(Gt,Tt)}catch(En){Tt(En)}finally{Fe.T=_t}},Kn.unstable_useCacheRefresh=function(){return Fe.H.useCacheRefresh()},Kn.use=function(Re){return Fe.H.use(Re)},Kn.useActionState=function(Re,_t,At){return Fe.H.useActionState(Re,_t,At)},Kn.useCallback=function(Re,_t){return Fe.H.useCallback(Re,_t)},Kn.useContext=function(Re){return Fe.H.useContext(Re)},Kn.useDebugValue=function(){},Kn.useDeferredValue=function(Re,_t){return Fe.H.useDeferredValue(Re,_t)},Kn.useEffect=function(Re,_t,At){var St=Fe.H;if(typeof At=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return St.useEffect(Re,_t)},Kn.useId=function(){return Fe.H.useId()},Kn.useImperativeHandle=function(Re,_t,At){return Fe.H.useImperativeHandle(Re,_t,At)},Kn.useInsertionEffect=function(Re,_t){return Fe.H.useInsertionEffect(Re,_t)},Kn.useLayoutEffect=function(Re,_t){return Fe.H.useLayoutEffect(Re,_t)},Kn.useMemo=function(Re,_t){return Fe.H.useMemo(Re,_t)},Kn.useOptimistic=function(Re,_t){return Fe.H.useOptimistic(Re,_t)},Kn.useReducer=function(Re,_t,At){return Fe.H.useReducer(Re,_t,At)},Kn.useRef=function(Re){return Fe.H.useRef(Re)},Kn.useState=function(Re){return Fe.H.useState(Re)},Kn.useSyncExternalStore=function(Re,_t,At){return Fe.H.useSyncExternalStore(Re,_t,At)},Kn.useTransition=function(){return Fe.H.useTransition()},Kn.version="19.1.0",Kn}var P2;function z1(){return P2||(P2=1,Ub.exports=IP()),Ub.exports}var We=z1();const O1=A_(We);var qb={exports:{}},Oy={},$b={exports:{}},Gb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R2;function MP(){return R2||(R2=1,function(r){function e(et,Mt){var Tt=et.length;et.push(Mt);e:for(;0<Tt;){var Gt=Tt-1>>>1,Re=et[Gt];if(0<d(Re,Mt))et[Gt]=Mt,et[Tt]=Re,Tt=Gt;else break e}}function t(et){return et.length===0?null:et[0]}function a(et){if(et.length===0)return null;var Mt=et[0],Tt=et.pop();if(Tt!==Mt){et[0]=Tt;e:for(var Gt=0,Re=et.length,_t=Re>>>1;Gt<_t;){var At=2*(Gt+1)-1,St=et[At],Qt=At+1,En=et[Qt];if(0>d(St,Tt))Qt<Re&&0>d(En,St)?(et[Gt]=En,et[Qt]=Tt,Gt=Qt):(et[Gt]=St,et[At]=Tt,Gt=At);else if(Qt<Re&&0>d(En,Tt))et[Gt]=En,et[Qt]=Tt,Gt=Qt;else break e}}return Mt}function d(et,Mt){var Tt=et.sortIndex-Mt.sortIndex;return Tt!==0?Tt:et.id-Mt.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;r.unstable_now=function(){return m.now()}}else{var y=Date,c=y.now();r.unstable_now=function(){return y.now()-c}}var M=[],R=[],B=1,K=null,$=3,W=!1,re=!1,Me=!1,Ce=!1,Be=typeof setTimeout=="function"?setTimeout:null,He=typeof clearTimeout=="function"?clearTimeout:null,ut=typeof setImmediate<"u"?setImmediate:null;function Ue(et){for(var Mt=t(R);Mt!==null;){if(Mt.callback===null)a(R);else if(Mt.startTime<=et)a(R),Mt.sortIndex=Mt.expirationTime,e(M,Mt);else break;Mt=t(R)}}function Fe(et){if(Me=!1,Ue(et),!re)if(t(M)!==null)re=!0,Ze||(Ze=!0,ke());else{var Mt=t(R);Mt!==null&&Kt(Fe,Mt.startTime-et)}}var Ze=!1,me=-1,se=5,ye=-1;function we(){return Ce?!0:!(r.unstable_now()-ye<se)}function Ee(){if(Ce=!1,Ze){var et=r.unstable_now();ye=et;var Mt=!0;try{e:{re=!1,Me&&(Me=!1,He(me),me=-1),W=!0;var Tt=$;try{t:{for(Ue(et),K=t(M);K!==null&&!(K.expirationTime>et&&we());){var Gt=K.callback;if(typeof Gt=="function"){K.callback=null,$=K.priorityLevel;var Re=Gt(K.expirationTime<=et);if(et=r.unstable_now(),typeof Re=="function"){K.callback=Re,Ue(et),Mt=!0;break t}K===t(M)&&a(M),Ue(et)}else a(M);K=t(M)}if(K!==null)Mt=!0;else{var _t=t(R);_t!==null&&Kt(Fe,_t.startTime-et),Mt=!1}}break e}finally{K=null,$=Tt,W=!1}Mt=void 0}}finally{Mt?ke():Ze=!1}}}var ke;if(typeof ut=="function")ke=function(){ut(Ee)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,Bt=ve.port2;ve.port1.onmessage=Ee,ke=function(){Bt.postMessage(null)}}else ke=function(){Be(Ee,0)};function Kt(et,Mt){me=Be(function(){et(r.unstable_now())},Mt)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(et){et.callback=null},r.unstable_forceFrameRate=function(et){0>et||125<et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<et?Math.floor(1e3/et):5},r.unstable_getCurrentPriorityLevel=function(){return $},r.unstable_next=function(et){switch($){case 1:case 2:case 3:var Mt=3;break;default:Mt=$}var Tt=$;$=Mt;try{return et()}finally{$=Tt}},r.unstable_requestPaint=function(){Ce=!0},r.unstable_runWithPriority=function(et,Mt){switch(et){case 1:case 2:case 3:case 4:case 5:break;default:et=3}var Tt=$;$=et;try{return Mt()}finally{$=Tt}},r.unstable_scheduleCallback=function(et,Mt,Tt){var Gt=r.unstable_now();switch(typeof Tt=="object"&&Tt!==null?(Tt=Tt.delay,Tt=typeof Tt=="number"&&0<Tt?Gt+Tt:Gt):Tt=Gt,et){case 1:var Re=-1;break;case 2:Re=250;break;case 5:Re=1073741823;break;case 4:Re=1e4;break;default:Re=5e3}return Re=Tt+Re,et={id:B++,callback:Mt,priorityLevel:et,startTime:Tt,expirationTime:Re,sortIndex:-1},Tt>Gt?(et.sortIndex=Tt,e(R,et),t(M)===null&&et===t(R)&&(Me?(He(me),me=-1):Me=!0,Kt(Fe,Tt-Gt))):(et.sortIndex=Re,e(M,et),re||W||(re=!0,Ze||(Ze=!0,ke()))),et},r.unstable_shouldYield=we,r.unstable_wrapCallback=function(et){var Mt=$;return function(){var Tt=$;$=Mt;try{return et.apply(this,arguments)}finally{$=Tt}}}}(Gb)),Gb}var k2;function PP(){return k2||(k2=1,$b.exports=MP()),$b.exports}var Hb={exports:{}},Qs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D2;function RP(){if(D2)return Qs;D2=1;var r=z1();function e(M){var R="https://react.dev/errors/"+M;if(1<arguments.length){R+="?args[]="+encodeURIComponent(arguments[1]);for(var B=2;B<arguments.length;B++)R+="&args[]="+encodeURIComponent(arguments[B])}return"Minified React error #"+M+"; visit "+R+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},d=Symbol.for("react.portal");function m(M,R,B){var K=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:K==null?null:""+K,children:M,containerInfo:R,implementation:B}}var y=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(M,R){if(M==="font")return"";if(typeof R=="string")return R==="use-credentials"?R:""}return Qs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Qs.createPortal=function(M,R){var B=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!R||R.nodeType!==1&&R.nodeType!==9&&R.nodeType!==11)throw Error(e(299));return m(M,R,null,B)},Qs.flushSync=function(M){var R=y.T,B=a.p;try{if(y.T=null,a.p=2,M)return M()}finally{y.T=R,a.p=B,a.d.f()}},Qs.preconnect=function(M,R){typeof M=="string"&&(R?(R=R.crossOrigin,R=typeof R=="string"?R==="use-credentials"?R:"":void 0):R=null,a.d.C(M,R))},Qs.prefetchDNS=function(M){typeof M=="string"&&a.d.D(M)},Qs.preinit=function(M,R){if(typeof M=="string"&&R&&typeof R.as=="string"){var B=R.as,K=c(B,R.crossOrigin),$=typeof R.integrity=="string"?R.integrity:void 0,W=typeof R.fetchPriority=="string"?R.fetchPriority:void 0;B==="style"?a.d.S(M,typeof R.precedence=="string"?R.precedence:void 0,{crossOrigin:K,integrity:$,fetchPriority:W}):B==="script"&&a.d.X(M,{crossOrigin:K,integrity:$,fetchPriority:W,nonce:typeof R.nonce=="string"?R.nonce:void 0})}},Qs.preinitModule=function(M,R){if(typeof M=="string")if(typeof R=="object"&&R!==null){if(R.as==null||R.as==="script"){var B=c(R.as,R.crossOrigin);a.d.M(M,{crossOrigin:B,integrity:typeof R.integrity=="string"?R.integrity:void 0,nonce:typeof R.nonce=="string"?R.nonce:void 0})}}else R==null&&a.d.M(M)},Qs.preload=function(M,R){if(typeof M=="string"&&typeof R=="object"&&R!==null&&typeof R.as=="string"){var B=R.as,K=c(B,R.crossOrigin);a.d.L(M,B,{crossOrigin:K,integrity:typeof R.integrity=="string"?R.integrity:void 0,nonce:typeof R.nonce=="string"?R.nonce:void 0,type:typeof R.type=="string"?R.type:void 0,fetchPriority:typeof R.fetchPriority=="string"?R.fetchPriority:void 0,referrerPolicy:typeof R.referrerPolicy=="string"?R.referrerPolicy:void 0,imageSrcSet:typeof R.imageSrcSet=="string"?R.imageSrcSet:void 0,imageSizes:typeof R.imageSizes=="string"?R.imageSizes:void 0,media:typeof R.media=="string"?R.media:void 0})}},Qs.preloadModule=function(M,R){if(typeof M=="string")if(R){var B=c(R.as,R.crossOrigin);a.d.m(M,{as:typeof R.as=="string"&&R.as!=="script"?R.as:void 0,crossOrigin:B,integrity:typeof R.integrity=="string"?R.integrity:void 0})}else a.d.m(M)},Qs.requestFormReset=function(M){a.d.r(M)},Qs.unstable_batchedUpdates=function(M,R){return M(R)},Qs.useFormState=function(M,R,B){return y.H.useFormState(M,R,B)},Qs.useFormStatus=function(){return y.H.useHostTransitionStatus()},Qs.version="19.1.0",Qs}var L2;function kP(){if(L2)return Hb.exports;L2=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Hb.exports=RP(),Hb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z2;function DP(){if(z2)return Oy;z2=1;var r=PP(),e=z1(),t=kP();function a(s){var h="https://react.dev/errors/"+s;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+s+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function m(s){var h=s,g=s;if(s.alternate)for(;h.return;)h=h.return;else{s=h;do h=s,(h.flags&4098)!==0&&(g=h.return),s=h.return;while(s)}return h.tag===3?g:null}function y(s){if(s.tag===13){var h=s.memoizedState;if(h===null&&(s=s.alternate,s!==null&&(h=s.memoizedState)),h!==null)return h.dehydrated}return null}function c(s){if(m(s)!==s)throw Error(a(188))}function M(s){var h=s.alternate;if(!h){if(h=m(s),h===null)throw Error(a(188));return h!==s?null:s}for(var g=s,x=h;;){var I=g.return;if(I===null)break;var L=I.alternate;if(L===null){if(x=I.return,x!==null){g=x;continue}break}if(I.child===L.child){for(L=I.child;L;){if(L===g)return c(I),s;if(L===x)return c(I),h;L=L.sibling}throw Error(a(188))}if(g.return!==x.return)g=I,x=L;else{for(var Q=!1,ae=I.child;ae;){if(ae===g){Q=!0,g=I,x=L;break}if(ae===x){Q=!0,x=I,g=L;break}ae=ae.sibling}if(!Q){for(ae=L.child;ae;){if(ae===g){Q=!0,g=L,x=I;break}if(ae===x){Q=!0,x=L,g=I;break}ae=ae.sibling}if(!Q)throw Error(a(189))}}if(g.alternate!==x)throw Error(a(190))}if(g.tag!==3)throw Error(a(188));return g.stateNode.current===g?s:h}function R(s){var h=s.tag;if(h===5||h===26||h===27||h===6)return s;for(s=s.child;s!==null;){if(h=R(s),h!==null)return h;s=s.sibling}return null}var B=Object.assign,K=Symbol.for("react.element"),$=Symbol.for("react.transitional.element"),W=Symbol.for("react.portal"),re=Symbol.for("react.fragment"),Me=Symbol.for("react.strict_mode"),Ce=Symbol.for("react.profiler"),Be=Symbol.for("react.provider"),He=Symbol.for("react.consumer"),ut=Symbol.for("react.context"),Ue=Symbol.for("react.forward_ref"),Fe=Symbol.for("react.suspense"),Ze=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),se=Symbol.for("react.lazy"),ye=Symbol.for("react.activity"),we=Symbol.for("react.memo_cache_sentinel"),Ee=Symbol.iterator;function ke(s){return s===null||typeof s!="object"?null:(s=Ee&&s[Ee]||s["@@iterator"],typeof s=="function"?s:null)}var ve=Symbol.for("react.client.reference");function Bt(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ve?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case re:return"Fragment";case Ce:return"Profiler";case Me:return"StrictMode";case Fe:return"Suspense";case Ze:return"SuspenseList";case ye:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case W:return"Portal";case ut:return(s.displayName||"Context")+".Provider";case He:return(s._context.displayName||"Context")+".Consumer";case Ue:var h=s.render;return s=s.displayName,s||(s=h.displayName||h.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case me:return h=s.displayName||null,h!==null?h:Bt(s.type)||"Memo";case se:h=s._payload,s=s._init;try{return Bt(s(h))}catch{}}return null}var Kt=Array.isArray,et=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Mt=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Tt={pending:!1,data:null,method:null,action:null},Gt=[],Re=-1;function _t(s){return{current:s}}function At(s){0>Re||(s.current=Gt[Re],Gt[Re]=null,Re--)}function St(s,h){Re++,Gt[Re]=s.current,s.current=h}var Qt=_t(null),En=_t(null),gn=_t(null),ii=_t(null);function wr(s,h){switch(St(gn,h),St(En,s),St(Qt,null),h.nodeType){case 9:case 11:s=(s=h.documentElement)&&(s=s.namespaceURI)?xy(s):0;break;default:if(s=h.tagName,h=h.namespaceURI)h=xy(h),s=wy(h,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}At(Qt),St(Qt,s)}function Cr(){At(Qt),At(En),At(gn)}function Ds(s){s.memoizedState!==null&&St(ii,s);var h=Qt.current,g=wy(h,s.type);h!==g&&(St(En,s),St(Qt,g))}function gi(s){En.current===s&&(At(Qt),At(En)),ii.current===s&&(At(ii),le._currentValue=Tt)}var ao=Object.prototype.hasOwnProperty,Tr=r.unstable_scheduleCallback,ya=r.unstable_cancelCallback,_a=r.unstable_shouldYield,rl=r.unstable_requestPaint,Ir=r.unstable_now,Oa=r.unstable_getCurrentPriorityLevel,na=r.unstable_ImmediatePriority,Ls=r.unstable_UserBlockingPriority,Xa=r.unstable_NormalPriority,bu=r.unstable_LowPriority,zs=r.unstable_IdlePriority,ls=r.log,ko=r.unstable_setDisableYieldValue,fr=null,Bn=null;function di(s){if(typeof ls=="function"&&ko(s),Bn&&typeof Bn.setStrictMode=="function")try{Bn.setStrictMode(fr,s)}catch{}}var Ri=Math.clz32?Math.clz32:Ge,xu=Math.log,so=Math.LN2;function Ge(s){return s>>>=0,s===0?32:31-(xu(s)/so|0)|0}var ne=256,ie=4194304;function ue(s){var h=s&42;if(h!==0)return h;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Te(s,h,g){var x=s.pendingLanes;if(x===0)return 0;var I=0,L=s.suspendedLanes,Q=s.pingedLanes;s=s.warmLanes;var ae=x&134217727;return ae!==0?(x=ae&~L,x!==0?I=ue(x):(Q&=ae,Q!==0?I=ue(Q):g||(g=ae&~s,g!==0&&(I=ue(g))))):(ae=x&~L,ae!==0?I=ue(ae):Q!==0?I=ue(Q):g||(g=x&~s,g!==0&&(I=ue(g)))),I===0?0:h!==0&&h!==I&&(h&L)===0&&(L=I&-I,g=h&-h,L>=g||L===32&&(g&4194048)!==0)?h:I}function Oe(s,h){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&h)===0}function $e(s,h){switch(s){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tt(){var s=ne;return ne<<=1,(ne&4194048)===0&&(ne=256),s}function je(){var s=ie;return ie<<=1,(ie&62914560)===0&&(ie=4194304),s}function ht(s){for(var h=[],g=0;31>g;g++)h.push(s);return h}function st(s,h){s.pendingLanes|=h,h!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ke(s,h,g,x,I,L){var Q=s.pendingLanes;s.pendingLanes=g,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=g,s.entangledLanes&=g,s.errorRecoveryDisabledLanes&=g,s.shellSuspendCounter=0;var ae=s.entanglements,De=s.expirationTimes,at=s.hiddenUpdates;for(g=Q&~g;0<g;){var vt=31-Ri(g),Et=1<<vt;ae[vt]=0,De[vt]=-1;var ct=at[vt];if(ct!==null)for(at[vt]=null,vt=0;vt<ct.length;vt++){var dt=ct[vt];dt!==null&&(dt.lane&=-536870913)}g&=~Et}x!==0&&mt(s,x,0),L!==0&&I===0&&s.tag!==0&&(s.suspendedLanes|=L&~(Q&~h))}function mt(s,h,g){s.pendingLanes|=h,s.suspendedLanes&=~h;var x=31-Ri(h);s.entangledLanes|=h,s.entanglements[x]=s.entanglements[x]|1073741824|g&4194090}function ze(s,h){var g=s.entangledLanes|=h;for(s=s.entanglements;g;){var x=31-Ri(g),I=1<<x;I&h|s[x]&h&&(s[x]|=h),g&=~I}}function Ot(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function on(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function jt(){var s=Mt.p;return s!==0?s:(s=window.event,s===void 0?32:Wt(s.type))}function Jt(s,h){var g=Mt.p;try{return Mt.p=s,h()}finally{Mt.p=g}}var Xt=Math.random().toString(36).slice(2),An="__reactFiber$"+Xt,vn="__reactProps$"+Xt,Cn="__reactContainer$"+Xt,cn="__reactEvents$"+Xt,jn="__reactListeners$"+Xt,Kr="__reactHandles$"+Xt,kt="__reactResources$"+Xt,ai="__reactMarker$"+Xt;function cr(s){delete s[An],delete s[vn],delete s[cn],delete s[jn],delete s[Kr]}function va(s){var h=s[An];if(h)return h;for(var g=s.parentNode;g;){if(h=g[Cn]||g[An]){if(g=h.alternate,h.child!==null||g!==null&&g.child!==null)for(s=Tv(s);s!==null;){if(g=s[An])return g;s=Tv(s)}return h}s=g,g=s.parentNode}return null}function ba(s){if(s=s[An]||s[Cn]){var h=s.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return s}return null}function Dt(s){var h=s.tag;if(h===5||h===26||h===27||h===6)return s.stateNode;throw Error(a(33))}function hn(s){var h=s[kt];return h||(h=s[kt]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function nn(s){s[ai]=!0}var ha=new Set,il={};function ki(s,h){yn(s,h),yn(s+"Capture",h)}function yn(s,h){for(il[s]=h,s=0;s<h.length;s++)ha.add(h[s])}var Os=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Do={},kr={};function Ll(s){return ao.call(kr,s)?!0:ao.call(Do,s)?!1:Os.test(s)?kr[s]=!0:(Do[s]=!0,!1)}function Ns(s,h,g){if(Ll(h))if(g===null)s.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":s.removeAttribute(h);return;case"boolean":var x=h.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(h);return}}s.setAttribute(h,""+g)}}function ra(s,h,g){if(g===null)s.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttribute(h,""+g)}}function yi(s,h,g,x){if(x===null)s.removeAttribute(g);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(g);return}s.setAttributeNS(h,g,""+x)}}var Gi,Dr;function Lo(s){if(Gi===void 0)try{throw Error()}catch(g){var h=g.stack.trim().match(/\n( *(at )?)/);Gi=h&&h[1]||"",Dr=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Gi+s+Dr}var zo=!1;function al(s,h){if(!s||zo)return"";zo=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(h){var Et=function(){throw Error()};if(Object.defineProperty(Et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Et,[])}catch(dt){var ct=dt}Reflect.construct(s,[],Et)}else{try{Et.call()}catch(dt){ct=dt}s.call(Et.prototype)}}else{try{throw Error()}catch(dt){ct=dt}(Et=s())&&typeof Et.catch=="function"&&Et.catch(function(){})}}catch(dt){if(dt&&ct&&typeof dt.stack=="string")return[dt.stack,ct.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=x.DetermineComponentFrameRoot(),Q=L[0],ae=L[1];if(Q&&ae){var De=Q.split(`
`),at=ae.split(`
`);for(I=x=0;x<De.length&&!De[x].includes("DetermineComponentFrameRoot");)x++;for(;I<at.length&&!at[I].includes("DetermineComponentFrameRoot");)I++;if(x===De.length||I===at.length)for(x=De.length-1,I=at.length-1;1<=x&&0<=I&&De[x]!==at[I];)I--;for(;1<=x&&0<=I;x--,I--)if(De[x]!==at[I]){if(x!==1||I!==1)do if(x--,I--,0>I||De[x]!==at[I]){var vt=`
`+De[x].replace(" at new "," at ");return s.displayName&&vt.includes("<anonymous>")&&(vt=vt.replace("<anonymous>",s.displayName)),vt}while(1<=x&&0<=I);break}}}finally{zo=!1,Error.prepareStackTrace=g}return(g=s?s.displayName||s.name:"")?Lo(g):""}function oo(s){switch(s.tag){case 26:case 27:case 5:return Lo(s.type);case 16:return Lo("Lazy");case 13:return Lo("Suspense");case 19:return Lo("SuspenseList");case 0:case 15:return al(s.type,!1);case 11:return al(s.type.render,!1);case 1:return al(s.type,!0);case 31:return Lo("Activity");default:return""}}function us(s){try{var h="";do h+=oo(s),s=s.return;while(s);return h}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function xa(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function bc(s){var h=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function dd(s){var h=bc(s)?"checked":"value",g=Object.getOwnPropertyDescriptor(s.constructor.prototype,h),x=""+s[h];if(!s.hasOwnProperty(h)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var I=g.get,L=g.set;return Object.defineProperty(s,h,{configurable:!0,get:function(){return I.call(this)},set:function(Q){x=""+Q,L.call(this,Q)}}),Object.defineProperty(s,h,{enumerable:g.enumerable}),{getValue:function(){return x},setValue:function(Q){x=""+Q},stopTracking:function(){s._valueTracker=null,delete s[h]}}}}function lo(s){s._valueTracker||(s._valueTracker=dd(s))}function xc(s){if(!s)return!1;var h=s._valueTracker;if(!h)return!0;var g=h.getValue(),x="";return s&&(x=bc(s)?s.checked?"true":"false":s.value),s=x,s!==g?(h.setValue(s),!0):!1}function zl(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var wu=/[\n"\\]/g;function Di(s){return s.replace(wu,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Ya(s,h,g,x,I,L,Q,ae){s.name="",Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?s.type=Q:s.removeAttribute("type"),h!=null?Q==="number"?(h===0&&s.value===""||s.value!=h)&&(s.value=""+xa(h)):s.value!==""+xa(h)&&(s.value=""+xa(h)):Q!=="submit"&&Q!=="reset"||s.removeAttribute("value"),h!=null?Oo(s,Q,xa(h)):g!=null?Oo(s,Q,xa(g)):x!=null&&s.removeAttribute("value"),I==null&&L!=null&&(s.defaultChecked=!!L),I!=null&&(s.checked=I&&typeof I!="function"&&typeof I!="symbol"),ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?s.name=""+xa(ae):s.removeAttribute("name")}function Bs(s,h,g,x,I,L,Q,ae){if(L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(s.type=L),h!=null||g!=null){if(!(L!=="submit"&&L!=="reset"||h!=null))return;g=g!=null?""+xa(g):"",h=h!=null?""+xa(h):g,ae||h===s.value||(s.value=h),s.defaultValue=h}x=x??I,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=ae?s.checked:!!x,s.defaultChecked=!!x,Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(s.name=Q)}function Oo(s,h,g){h==="number"&&zl(s.ownerDocument)===s||s.defaultValue===""+g||(s.defaultValue=""+g)}function uo(s,h,g,x){if(s=s.options,h){h={};for(var I=0;I<g.length;I++)h["$"+g[I]]=!0;for(g=0;g<s.length;g++)I=h.hasOwnProperty("$"+s[g].value),s[g].selected!==I&&(s[g].selected=I),I&&x&&(s[g].defaultSelected=!0)}else{for(g=""+xa(g),h=null,I=0;I<s.length;I++){if(s[I].value===g){s[I].selected=!0,x&&(s[I].defaultSelected=!0);return}h!==null||s[I].disabled||(h=s[I])}h!==null&&(h.selected=!0)}}function Sr(s,h,g){if(h!=null&&(h=""+xa(h),h!==s.value&&(s.value=h),g==null)){s.defaultValue!==h&&(s.defaultValue=h);return}s.defaultValue=g!=null?""+xa(g):""}function No(s,h,g,x){if(h==null){if(x!=null){if(g!=null)throw Error(a(92));if(Kt(x)){if(1<x.length)throw Error(a(93));x=x[0]}g=x}g==null&&(g=""),h=g}g=xa(h),s.defaultValue=g,x=s.textContent,x===g&&x!==""&&x!==null&&(s.value=x)}function Na(s,h){if(h){var g=s.firstChild;if(g&&g===s.lastChild&&g.nodeType===3){g.nodeValue=h;return}}s.textContent=h}var wa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ln(s,h,g){var x=h.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?x?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="":x?s.setProperty(h,g):typeof g!="number"||g===0||wa.has(h)?h==="float"?s.cssFloat=g:s[h]=(""+g).trim():s[h]=g+"px"}function cs(s,h,g){if(h!=null&&typeof h!="object")throw Error(a(62));if(s=s.style,g!=null){for(var x in g)!g.hasOwnProperty(x)||h!=null&&h.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var I in h)x=h[I],h.hasOwnProperty(I)&&g[I]!==x&&Ln(s,I,x)}else for(var L in h)h.hasOwnProperty(L)&&Ln(s,L,h[L])}function hs(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),mh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ol(s){return mh.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Li=null;function zi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var wn=null,ds=null;function Nl(s){var h=ba(s);if(h&&(s=h.stateNode)){var g=s[vn]||null;e:switch(s=h.stateNode,h.type){case"input":if(Ya(s,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),h=g.name,g.type==="radio"&&h!=null){for(g=s;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Di(""+h)+'"][type="radio"]'),h=0;h<g.length;h++){var x=g[h];if(x!==s&&x.form===s.form){var I=x[vn]||null;if(!I)throw Error(a(90));Ya(x,I.value,I.defaultValue,I.defaultValue,I.checked,I.defaultChecked,I.type,I.name)}}for(h=0;h<g.length;h++)x=g[h],x.form===s.form&&xc(x)}break e;case"textarea":Sr(s,g.value,g.defaultValue);break e;case"select":h=g.value,h!=null&&uo(s,!!g.multiple,h,!1)}}}var Fs=!1;function Hi(s,h,g){if(Fs)return s(h,g);Fs=!0;try{var x=s(h);return x}finally{if(Fs=!1,(wn!==null||ds!==null)&&(Si(),wn&&(h=wn,s=ds,ds=wn=null,Nl(h),s)))for(h=0;h<s.length;h++)Nl(s[h])}}function Ur(s,h){var g=s.stateNode;if(g===null)return null;var x=g[vn]||null;if(x===null)return null;g=x[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(g&&typeof g!="function")throw Error(a(231,h,typeof g));return g}var qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Er=!1;if(qr)try{var pr={};Object.defineProperty(pr,"passive",{get:function(){Er=!0}}),window.addEventListener("test",pr,pr),window.removeEventListener("test",pr,pr)}catch{Er=!1}var fs=null,In=null,fi=null;function _n(){if(fi)return fi;var s,h=In,g=h.length,x,I="value"in fs?fs.value:fs.textContent,L=I.length;for(s=0;s<g&&h[s]===I[s];s++);var Q=g-s;for(x=1;x<=Q&&h[g-x]===I[L-x];x++);return fi=I.slice(s,1<x?1-x:void 0)}function mn(s){var h=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&h===13&&(s=13)):s=h,s===10&&(s=13),32<=s||s===13?s:0}function Ta(){return!0}function ln(){return!1}function Jr(s){function h(g,x,I,L,Q){this._reactName=g,this._targetInst=I,this.type=x,this.nativeEvent=L,this.target=Q,this.currentTarget=null;for(var ae in s)s.hasOwnProperty(ae)&&(g=s[ae],this[ae]=g?g(L):L[ae]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?Ta:ln,this.isPropagationStopped=ln,this}return B(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Ta)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Ta)},persist:function(){},isPersistent:Ta}),h}var Dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},co=Jr(Dn),ia=B({},Dn,{view:0,detail:0}),wc=Jr(ia),Ba,Tu,ho,fo=B({},ia,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_i,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ho&&(ho&&s.type==="mousemove"?(Ba=s.screenX-ho.screenX,Tu=s.screenY-ho.screenY):Tu=Ba=0,ho=s),Ba)},movementY:function(s){return"movementY"in s?s.movementY:Tu}}),Sa=Jr(fo),Qa=B({},fo,{dataTransfer:0}),Oi=Jr(Qa),Vs=B({},ia,{relatedTarget:0}),Bo=Jr(Vs),Fo=B({},Dn,{animationName:0,elapsedTime:0,pseudoElement:0}),Xr=Jr(Fo),Bl=B({},Dn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),po=Jr(Bl),Fl=B({},Dn,{data:0}),gh=Jr(Fl),Ja={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yh(s){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(s):(s=Tc[s])?!!h[s]:!1}function _i(){return yh}var ol=B({},ia,{key:function(s){if(s.key){var h=Ja[s.key]||s.key;if(h!=="Unidentified")return h}return s.type==="keypress"?(s=mn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Vl[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_i,charCode:function(s){return s.type==="keypress"?mn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?mn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),aa=Jr(ol),da=B({},fo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Su=Jr(da),ps=B({},ia,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_i}),ll=Jr(ps),Sc=B({},Dn,{propertyName:0,elapsedTime:0,pseudoElement:0}),fd=Jr(Sc),pd=B({},fo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Ec=Jr(pd),Fa=B({},Dn,{newState:0,oldState:0}),Eu=Jr(Fa),Au=[9,13,27,32],ms=qr&&"CompositionEvent"in window,A=null;qr&&"documentMode"in document&&(A=document.documentMode);var V=qr&&"TextEvent"in window&&!A,Z=qr&&(!ms||A&&8<A&&11>=A),ce=" ",Je=!1;function pt(s,h){switch(s){case"keyup":return Au.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vt(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Gn=!1;function Ni(s,h){switch(s){case"compositionend":return Vt(h);case"keypress":return h.which!==32?null:(Je=!0,ce);case"textInput":return s=h.data,s===ce&&Je?null:s;default:return null}}function Hn(s,h){if(Gn)return s==="compositionend"||!ms&&pt(s,h)?(s=_n(),fi=In=fs=null,Gn=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Z&&h.locale!=="ko"?null:h.data;default:return null}}var Zi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ei(s){var h=s&&s.nodeName&&s.nodeName.toLowerCase();return h==="input"?!!Zi[s.type]:h==="textarea"}function ul(s,h,g,x){wn?ds?ds.push(x):ds=[x]:wn=x,h=gp(h,"onChange"),0<h.length&&(g=new co("onChange","change",null,g,x),s.push({event:g,listeners:h}))}var sa=null,Vo=null;function jl(s){_v(s,0)}function Ac(s){var h=Dt(s);if(xc(h))return s}function If(s,h){if(s==="change")return h}var Mf=!1;if(qr){var _h;if(qr){var vh="oninput"in document;if(!vh){var Ul=document.createElement("div");Ul.setAttribute("oninput","return;"),vh=typeof Ul.oninput=="function"}_h=vh}else _h=!1;Mf=_h&&(!document.documentMode||9<document.documentMode)}function Pf(){sa&&(sa.detachEvent("onpropertychange",md),Vo=sa=null)}function md(s){if(s.propertyName==="value"&&Ac(Vo)){var h=[];ul(h,Vo,s,zi(s)),Hi(jl,h)}}function Cc(s,h,g){s==="focusin"?(Pf(),sa=h,Vo=g,sa.attachEvent("onpropertychange",md)):s==="focusout"&&Pf()}function Ig(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ac(Vo)}function gd(s,h){if(s==="click")return Ac(h)}function Mg(s,h){if(s==="input"||s==="change")return Ac(h)}function Jp(s,h){return s===h&&(s!==0||1/s===1/h)||s!==s&&h!==h}var es=typeof Object.is=="function"?Object.is:Jp;function Ic(s,h){if(es(s,h))return!0;if(typeof s!="object"||s===null||typeof h!="object"||h===null)return!1;var g=Object.keys(s),x=Object.keys(h);if(g.length!==x.length)return!1;for(x=0;x<g.length;x++){var I=g[x];if(!ao.call(h,I)||!es(s[I],h[I]))return!1}return!0}function Rf(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function yd(s,h){var g=Rf(s);s=0;for(var x;g;){if(g.nodeType===3){if(x=s+g.textContent.length,s<=h&&x>=h)return{node:g,offset:h-s};s=x}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=Rf(g)}}function nr(s,h){return s&&h?s===h?!0:s&&s.nodeType===3?!1:h&&h.nodeType===3?nr(s,h.parentNode):"contains"in s?s.contains(h):s.compareDocumentPosition?!!(s.compareDocumentPosition(h)&16):!1:!1}function bh(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var h=zl(s.document);h instanceof s.HTMLIFrameElement;){try{var g=typeof h.contentWindow.location.href=="string"}catch{g=!1}if(g)s=h.contentWindow;else break;h=zl(s.document)}return h}function mo(s){var h=s&&s.nodeName&&s.nodeName.toLowerCase();return h&&(h==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||h==="textarea"||s.contentEditable==="true")}var kf=qr&&"documentMode"in document&&11>=document.documentMode,ql=null,xh=null,Mc=null,wh=!1;function $l(s,h,g){var x=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;wh||ql==null||ql!==zl(x)||(x=ql,"selectionStart"in x&&mo(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Mc&&Ic(Mc,x)||(Mc=x,x=gp(xh,"onSelect"),0<x.length&&(h=new co("onSelect","select",null,h,g),s.push({event:h,listeners:x}),h.target=ql)))}function cl(s,h){var g={};return g[s.toLowerCase()]=h.toLowerCase(),g["Webkit"+s]="webkit"+h,g["Moz"+s]="moz"+h,g}var Pc={animationend:cl("Animation","AnimationEnd"),animationiteration:cl("Animation","AnimationIteration"),animationstart:cl("Animation","AnimationStart"),transitionrun:cl("Transition","TransitionRun"),transitionstart:cl("Transition","TransitionStart"),transitioncancel:cl("Transition","TransitionCancel"),transitionend:cl("Transition","TransitionEnd")},Df={},em={};qr&&(em=document.createElement("div").style,"AnimationEvent"in window||(delete Pc.animationend.animation,delete Pc.animationiteration.animation,delete Pc.animationstart.animation),"TransitionEvent"in window||delete Pc.transitionend.transition);function Cu(s){if(Df[s])return Df[s];if(!Pc[s])return s;var h=Pc[s],g;for(g in h)if(h.hasOwnProperty(g)&&g in em)return Df[s]=h[g];return s}var Lf=Cu("animationend"),tm=Cu("animationiteration"),zf=Cu("animationstart"),_d=Cu("transitionrun"),vd=Cu("transitionstart"),bd=Cu("transitioncancel"),xd=Cu("transitionend"),Gl=new Map,Iu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Iu.push("scrollEnd");function Ea(s,h){Gl.set(s,h),ki(h,[s])}var gs=new WeakMap;function ys(s,h){if(typeof s=="object"&&s!==null){var g=gs.get(s);return g!==void 0?g:(h={value:s,source:h,stack:us(h)},gs.set(s,h),h)}return{value:s,source:h,stack:us(h)}}var _s=[],Hl=0,hl=0;function Mu(){for(var s=Hl,h=hl=Hl=0;h<s;){var g=_s[h];_s[h++]=null;var x=_s[h];_s[h++]=null;var I=_s[h];_s[h++]=null;var L=_s[h];if(_s[h++]=null,x!==null&&I!==null){var Q=x.pending;Q===null?I.next=I:(I.next=Q.next,Q.next=I),x.pending=I}L!==0&&Of(g,I,L)}}function Pu(s,h,g,x){_s[Hl++]=s,_s[Hl++]=h,_s[Hl++]=g,_s[Hl++]=x,hl|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function Ru(s,h,g,x){return Pu(s,h,g,x),dl(s)}function go(s,h){return Pu(s,null,null,h),dl(s)}function Of(s,h,g){s.lanes|=g;var x=s.alternate;x!==null&&(x.lanes|=g);for(var I=!1,L=s.return;L!==null;)L.childLanes|=g,x=L.alternate,x!==null&&(x.childLanes|=g),L.tag===22&&(s=L.stateNode,s===null||s._visibility&1||(I=!0)),s=L,L=L.return;return s.tag===3?(L=s.stateNode,I&&h!==null&&(I=31-Ri(g),s=L.hiddenUpdates,x=s[I],x===null?s[I]=[h]:x.push(h),h.lane=g|536870912),L):null}function dl(s){if(50<up)throw up=0,ey=null,Error(a(185));for(var h=s.return;h!==null;)s=h,h=s.return;return s.tag===3?s.stateNode:null}var yo={};function Nf(s,h,g,x){this.tag=s,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Va(s,h,g,x){return new Nf(s,h,g,x)}function zn(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ja(s,h){var g=s.alternate;return g===null?(g=Va(s.tag,h,s.key,s.mode),g.elementType=s.elementType,g.type=s.type,g.stateNode=s.stateNode,g.alternate=s,s.alternate=g):(g.pendingProps=h,g.type=s.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=s.flags&65011712,g.childLanes=s.childLanes,g.lanes=s.lanes,g.child=s.child,g.memoizedProps=s.memoizedProps,g.memoizedState=s.memoizedState,g.updateQueue=s.updateQueue,h=s.dependencies,g.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},g.sibling=s.sibling,g.index=s.index,g.ref=s.ref,g.refCleanup=s.refCleanup,g}function Bf(s,h){s.flags&=65011714;var g=s.alternate;return g===null?(s.childLanes=0,s.lanes=h,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=g.childLanes,s.lanes=g.lanes,s.child=g.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=g.memoizedProps,s.memoizedState=g.memoizedState,s.updateQueue=g.updateQueue,s.type=g.type,h=g.dependencies,s.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),s}function Th(s,h,g,x,I,L){var Q=0;if(x=s,typeof s=="function")zn(s)&&(Q=1);else if(typeof s=="string")Q=S(s,g,Qt.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case ye:return s=Va(31,g,h,I),s.elementType=ye,s.lanes=L,s;case re:return _o(g.children,I,L,h);case Me:Q=8,I|=24;break;case Ce:return s=Va(12,g,h,I|2),s.elementType=Ce,s.lanes=L,s;case Fe:return s=Va(13,g,h,I),s.elementType=Fe,s.lanes=L,s;case Ze:return s=Va(19,g,h,I),s.elementType=Ze,s.lanes=L,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Be:case ut:Q=10;break e;case He:Q=9;break e;case Ue:Q=11;break e;case me:Q=14;break e;case se:Q=16,x=null;break e}Q=29,g=Error(a(130,s===null?"null":typeof s,"")),x=null}return h=Va(Q,g,h,I),h.elementType=s,h.type=x,h.lanes=L,h}function _o(s,h,g,x){return s=Va(7,s,x,h),s.lanes=g,s}function Ff(s,h,g){return s=Va(6,s,null,h),s.lanes=g,s}function Vf(s,h,g){return h=Va(4,s.children!==null?s.children:[],s.key,h),h.lanes=g,h.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},h}var ku=[],Du=0,Lu=null,zu=0,Ua=[],Aa=0,jo=null,vo=1,vs="";function js(s,h){ku[Du++]=zu,ku[Du++]=Lu,Lu=s,zu=h}function Ou(s,h,g){Ua[Aa++]=vo,Ua[Aa++]=vs,Ua[Aa++]=jo,jo=s;var x=vo;s=vs;var I=32-Ri(x)-1;x&=~(1<<I),g+=1;var L=32-Ri(h)+I;if(30<L){var Q=I-I%5;L=(x&(1<<Q)-1).toString(32),x>>=Q,I-=Q,vo=1<<32-Ri(h)+I|g<<I|x,vs=L+s}else vo=1<<L|g<<I|x,vs=s}function Nu(s){s.return!==null&&(js(s,1),Ou(s,1,0))}function Sh(s){for(;s===Lu;)Lu=ku[--Du],ku[Du]=null,zu=ku[--Du],ku[Du]=null;for(;s===jo;)jo=Ua[--Aa],Ua[Aa]=null,vs=Ua[--Aa],Ua[Aa]=null,vo=Ua[--Aa],Ua[Aa]=null}var pi=null,mi=null,or=!1,Uo=null,Us=!1,wd=Error(a(519));function Zl(s){var h=Error(a(418,""));throw qs(ys(h,s)),wd}function Rc(s){var h=s.stateNode,g=s.type,x=s.memoizedProps;switch(h[An]=s,h[vn]=x,g){case"dialog":er("cancel",h),er("close",h);break;case"iframe":case"object":case"embed":er("load",h);break;case"video":case"audio":for(g=0;g<mp.length;g++)er(mp[g],h);break;case"source":er("error",h);break;case"img":case"image":case"link":er("error",h),er("load",h);break;case"details":er("toggle",h);break;case"input":er("invalid",h),Bs(h,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),lo(h);break;case"select":er("invalid",h);break;case"textarea":er("invalid",h),No(h,x.value,x.defaultValue,x.children),lo(h)}g=x.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||h.textContent===""+g||x.suppressHydrationWarning===!0||Kd(h.textContent,g)?(x.popover!=null&&(er("beforetoggle",h),er("toggle",h)),x.onScroll!=null&&er("scroll",h),x.onScrollEnd!=null&&er("scrollend",h),x.onClick!=null&&(h.onclick=yp),h=!0):h=!1,h||Zl(s)}function Eh(s){for(pi=s.return;pi;)switch(pi.tag){case 5:case 13:Us=!1;return;case 27:case 3:Us=!0;return;default:pi=pi.return}}function Wl(s){if(s!==pi)return!1;if(!or)return Eh(s),or=!0,!1;var h=s.tag,g;if((g=h!==3&&h!==27)&&((g=h===5)&&(g=s.type,g=!(g!=="form"&&g!=="button")||Ty(s.type,s.memoizedProps)),g=!g),g&&mi&&Zl(s),Eh(s),h===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,h=0;s;){if(s.nodeType===8)if(g=s.data,g==="/$"){if(h===0){mi=Xs(s.nextSibling);break e}h--}else g!=="$"&&g!=="$!"&&g!=="$?"||h++;s=s.nextSibling}mi=null}}else h===27?(h=mi,Zc(s.type)?(s=Cy,Cy=null,mi=s):mi=h):mi=pi?Xs(s.stateNode.nextSibling):null;return!0}function kc(){mi=pi=null,or=!1}function ti(){var s=Uo;return s!==null&&(Ws===null?Ws=s:Ws.push.apply(Ws,s),Uo=null),s}function qs(s){Uo===null?Uo=[s]:Uo.push(s)}var ts=_t(null),qo=null,bs=null;function xs(s,h,g){St(ts,h._currentValue),h._currentValue=g}function ns(s){s._currentValue=ts.current,At(ts)}function Ah(s,h,g){for(;s!==null;){var x=s.alternate;if((s.childLanes&h)!==h?(s.childLanes|=h,x!==null&&(x.childLanes|=h)):x!==null&&(x.childLanes&h)!==h&&(x.childLanes|=h),s===g)break;s=s.return}}function Bu(s,h,g,x){var I=s.child;for(I!==null&&(I.return=s);I!==null;){var L=I.dependencies;if(L!==null){var Q=I.child;L=L.firstContext;e:for(;L!==null;){var ae=L;L=I;for(var De=0;De<h.length;De++)if(ae.context===h[De]){L.lanes|=g,ae=L.alternate,ae!==null&&(ae.lanes|=g),Ah(L.return,g,s),x||(Q=null);break e}L=ae.next}}else if(I.tag===18){if(Q=I.return,Q===null)throw Error(a(341));Q.lanes|=g,L=Q.alternate,L!==null&&(L.lanes|=g),Ah(Q,g,s),Q=null}else Q=I.child;if(Q!==null)Q.return=I;else for(Q=I;Q!==null;){if(Q===s){Q=null;break}if(I=Q.sibling,I!==null){I.return=Q.return,Q=I;break}Q=Q.return}I=Q}}function Fu(s,h,g,x){s=null;for(var I=h,L=!1;I!==null;){if(!L){if((I.flags&524288)!==0)L=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var Q=I.alternate;if(Q===null)throw Error(a(387));if(Q=Q.memoizedProps,Q!==null){var ae=I.type;es(I.pendingProps.value,Q.value)||(s!==null?s.push(ae):s=[ae])}}else if(I===ii.current){if(Q=I.alternate,Q===null)throw Error(a(387));Q.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(s!==null?s.push(le):s=[le])}I=I.return}s!==null&&Bu(h,s,g,x),h.flags|=262144}function Ch(s){for(s=s.firstContext;s!==null;){if(!es(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Kl(s){qo=s,bs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function vi(s){return qa(qo,s)}function fl(s,h){return qo===null&&Kl(s),qa(s,h)}function qa(s,h){var g=h._currentValue;if(h={context:h,memoizedValue:g,next:null},bs===null){if(s===null)throw Error(a(308));bs=h,s.dependencies={lanes:0,firstContext:h},s.flags|=524288}else bs=bs.next=h;return g}var bo=typeof AbortController<"u"?AbortController:function(){var s=[],h=this.signal={aborted:!1,addEventListener:function(g,x){s.push(x)}};this.abort=function(){h.aborted=!0,s.forEach(function(g){return g()})}},jf=r.unstable_scheduleCallback,nm=r.unstable_NormalPriority,Bi={$$typeof:ut,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xl(){return{controller:new bo,data:new Map,refCount:0}}function Vu(s){s.refCount--,s.refCount===0&&jf(nm,function(){s.controller.abort()})}var Yl=null,Td=0,pl=0,ml=null;function Dc(s,h){if(Yl===null){var g=Yl=[];Td=0,pl=Gc(),ml={status:"pending",value:void 0,then:function(x){g.push(x)}}}return Td++,h.then(ws,ws),h}function ws(){if(--Td===0&&Yl!==null){ml!==null&&(ml.status="fulfilled");var s=Yl;Yl=null,pl=0,ml=null;for(var h=0;h<s.length;h++)(0,s[h])()}}function xo(s,h){var g=[],x={status:"pending",value:null,reason:null,then:function(I){g.push(I)}};return s.then(function(){x.status="fulfilled",x.value=h;for(var I=0;I<g.length;I++)(0,g[I])(h)},function(I){for(x.status="rejected",x.reason=I,I=0;I<g.length;I++)(0,g[I])(void 0)}),x}var Uf=et.S;et.S=function(s,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&Dc(s,h),Uf!==null&&Uf(s,h)};var bi=_t(null);function Ql(){var s=bi.current;return s!==null?s:Pr.pooledCache}function Sd(s,h){h===null?St(bi,bi.current):St(bi,h.pool)}function Ih(){var s=Ql();return s===null?null:{parent:Bi._currentValue,pool:s}}var Mh=Error(a(460)),Ed=Error(a(474)),Jl=Error(a(542)),eu={then:function(){}};function wo(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ut(){}function Ad(s,h,g){switch(g=s[g],g===void 0?s.push(h):g!==h&&(h.then(Ut,Ut),h=g),h.status){case"fulfilled":return h.value;case"rejected":throw s=h.reason,Lc(s),s;default:if(typeof h.status=="string")h.then(Ut,Ut);else{if(s=Pr,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=h,s.status="pending",s.then(function(x){if(h.status==="pending"){var I=h;I.status="fulfilled",I.value=x}},function(x){if(h.status==="pending"){var I=h;I.status="rejected",I.reason=x}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw s=h.reason,Lc(s),s}throw gl=h,Mh}}var gl=null;function Cd(){if(gl===null)throw Error(a(459));var s=gl;return gl=null,s}function Lc(s){if(s===Mh||s===Jl)throw Error(a(483))}var Ts=!1;function Ph(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function On(s,h){s=s.updateQueue,h.updateQueue===s&&(h.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function $o(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function yl(s,h,g){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Mr&2)!==0){var I=x.pending;return I===null?h.next=h:(h.next=I.next,I.next=h),x.pending=h,h=dl(s),Of(s,null,g),h}return Pu(s,x,h,g),dl(s)}function tu(s,h,g){if(h=h.updateQueue,h!==null&&(h=h.shared,(g&4194048)!==0)){var x=h.lanes;x&=s.pendingLanes,g|=x,h.lanes=g,ze(s,g)}}function qf(s,h){var g=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,g===x)){var I=null,L=null;if(g=g.firstBaseUpdate,g!==null){do{var Q={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};L===null?I=L=Q:L=L.next=Q,g=g.next}while(g!==null);L===null?I=L=h:L=L.next=h}else I=L=h;g={baseState:x.baseState,firstBaseUpdate:I,lastBaseUpdate:L,shared:x.shared,callbacks:x.callbacks},s.updateQueue=g;return}s=g.lastBaseUpdate,s===null?g.firstBaseUpdate=h:s.next=h,g.lastBaseUpdate=h}var $f=!1;function ju(){if($f){var s=ml;if(s!==null)throw s}}function nu(s,h,g,x){$f=!1;var I=s.updateQueue;Ts=!1;var L=I.firstBaseUpdate,Q=I.lastBaseUpdate,ae=I.shared.pending;if(ae!==null){I.shared.pending=null;var De=ae,at=De.next;De.next=null,Q===null?L=at:Q.next=at,Q=De;var vt=s.alternate;vt!==null&&(vt=vt.updateQueue,ae=vt.lastBaseUpdate,ae!==Q&&(ae===null?vt.firstBaseUpdate=at:ae.next=at,vt.lastBaseUpdate=De))}if(L!==null){var Et=I.baseState;Q=0,vt=at=De=null,ae=L;do{var ct=ae.lane&-536870913,dt=ct!==ae.lane;if(dt?(rr&ct)===ct:(x&ct)===ct){ct!==0&&ct===pl&&($f=!0),vt!==null&&(vt=vt.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var fn=s,bn=ae;ct=h;var jr=g;switch(bn.tag){case 1:if(fn=bn.payload,typeof fn=="function"){Et=fn.call(jr,Et,ct);break e}Et=fn;break e;case 3:fn.flags=fn.flags&-65537|128;case 0:if(fn=bn.payload,ct=typeof fn=="function"?fn.call(jr,Et,ct):fn,ct==null)break e;Et=B({},Et,ct);break e;case 2:Ts=!0}}ct=ae.callback,ct!==null&&(s.flags|=64,dt&&(s.flags|=8192),dt=I.callbacks,dt===null?I.callbacks=[ct]:dt.push(ct))}else dt={lane:ct,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},vt===null?(at=vt=dt,De=Et):vt=vt.next=dt,Q|=ct;if(ae=ae.next,ae===null){if(ae=I.shared.pending,ae===null)break;dt=ae,ae=dt.next,dt.next=null,I.lastBaseUpdate=dt,I.shared.pending=null}}while(!0);vt===null&&(De=Et),I.baseState=De,I.firstBaseUpdate=at,I.lastBaseUpdate=vt,L===null&&(I.shared.lanes=0),qc|=Q,s.lanes=Q,s.memoizedState=Et}}function Id(s,h){if(typeof s!="function")throw Error(a(191,s));s.call(h)}function Gf(s,h){var g=s.callbacks;if(g!==null)for(s.callbacks=null,s=0;s<g.length;s++)Id(g[s],h)}var Go=_t(null),Md=_t(0);function Pd(s,h){s=uu,St(Md,s),St(Go,h),uu=s|h.baseLanes}function Ho(){St(Md,uu),St(Go,Go.current)}function Lr(){uu=Md.current,At(Go),At(Md)}var $s=0,Nn=null,mr=null,xi=null,Rh=!1,zc=!1,Ca=!1,Uu=0,$t=0,rn=null,Rd=0;function si(){throw Error(a(321))}function qu(s,h){if(h===null)return!1;for(var g=0;g<h.length&&g<s.length;g++)if(!es(s[g],h[g]))return!1;return!0}function fa(s,h,g,x,I,L){return $s=L,Nn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,et.H=s===null||s.memoizedState===null?Zs:xl,Ca=!1,L=g(x,I),Ca=!1,zc&&(L=oa(h,g,x,I)),Hf(s),L}function Hf(s){et.H=ma;var h=mr!==null&&mr.next!==null;if($s=0,xi=mr=Nn=null,Rh=!1,$t=0,rn=null,h)throw Error(a(300));s===null||Ma||(s=s.dependencies,s!==null&&Ch(s)&&(Ma=!0))}function oa(s,h,g,x){Nn=s;var I=0;do{if(zc&&(rn=null),$t=0,zc=!1,25<=I)throw Error(a(301));if(I+=1,xi=mr=null,s.updateQueue!=null){var L=s.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}et.H=Zu,L=h(g,x)}while(zc);return L}function rm(){var s=et.H,h=s.useState()[0];return h=typeof h.then=="function"?$u(h):h,s=s.useState()[0],(mr!==null?mr.memoizedState:null)!==s&&(Nn.flags|=1024),h}function _l(){var s=Uu!==0;return Uu=0,s}function $r(s,h,g){h.updateQueue=s.updateQueue,h.flags&=-2053,s.lanes&=~g}function Yr(s){if(Rh){for(s=s.memoizedState;s!==null;){var h=s.queue;h!==null&&(h.pending=null),s=s.next}Rh=!1}$s=0,xi=mr=Nn=null,zc=!1,$t=Uu=0,rn=null}function $a(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?Nn.memoizedState=xi=s:xi=xi.next=s,xi}function zr(){if(mr===null){var s=Nn.alternate;s=s!==null?s.memoizedState:null}else s=mr.next;var h=xi===null?Nn.memoizedState:xi.next;if(h!==null)xi=h,mr=s;else{if(s===null)throw Nn.alternate===null?Error(a(467)):Error(a(310));mr=s,s={memoizedState:mr.memoizedState,baseState:mr.baseState,baseQueue:mr.baseQueue,queue:mr.queue,next:null},xi===null?Nn.memoizedState=xi=s:xi=xi.next=s}return xi}function Zo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $u(s){var h=$t;return $t+=1,rn===null&&(rn=[]),s=Ad(rn,s,h),h=Nn,(xi===null?h.memoizedState:xi.next)===null&&(h=h.alternate,et.H=h===null||h.memoizedState===null?Zs:xl),s}function Gu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return $u(s);if(s.$$typeof===ut)return vi(s)}throw Error(a(438,String(s)))}function vl(s){var h=null,g=Nn.updateQueue;if(g!==null&&(h=g.memoCache),h==null){var x=Nn.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(h={data:x.data.map(function(I){return I.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),g===null&&(g=Zo(),Nn.updateQueue=g),g.memoCache=h,g=h.data[h.index],g===void 0)for(g=h.data[h.index]=Array(s),x=0;x<s;x++)g[x]=we;return h.index++,g}function Ss(s,h){return typeof h=="function"?h(s):h}function Oc(s){var h=zr();return Nc(h,mr,s)}function Nc(s,h,g){var x=s.queue;if(x===null)throw Error(a(311));x.lastRenderedReducer=g;var I=s.baseQueue,L=x.pending;if(L!==null){if(I!==null){var Q=I.next;I.next=L.next,L.next=Q}h.baseQueue=I=L,x.pending=null}if(L=s.baseState,I===null)s.memoizedState=L;else{h=I.next;var ae=Q=null,De=null,at=h,vt=!1;do{var Et=at.lane&-536870913;if(Et!==at.lane?(rr&Et)===Et:($s&Et)===Et){var ct=at.revertLane;if(ct===0)De!==null&&(De=De.next={lane:0,revertLane:0,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null}),Et===pl&&(vt=!0);else if(($s&ct)===ct){at=at.next,ct===pl&&(vt=!0);continue}else Et={lane:0,revertLane:at.revertLane,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},De===null?(ae=De=Et,Q=L):De=De.next=Et,Nn.lanes|=ct,qc|=ct;Et=at.action,Ca&&g(L,Et),L=at.hasEagerState?at.eagerState:g(L,Et)}else ct={lane:Et,revertLane:at.revertLane,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},De===null?(ae=De=ct,Q=L):De=De.next=ct,Nn.lanes|=Et,qc|=Et;at=at.next}while(at!==null&&at!==h);if(De===null?Q=L:De.next=ae,!es(L,s.memoizedState)&&(Ma=!0,vt&&(g=ml,g!==null)))throw g;s.memoizedState=L,s.baseState=Q,s.baseQueue=De,x.lastRenderedState=L}return I===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function kh(s){var h=zr(),g=h.queue;if(g===null)throw Error(a(311));g.lastRenderedReducer=s;var x=g.dispatch,I=g.pending,L=h.memoizedState;if(I!==null){g.pending=null;var Q=I=I.next;do L=s(L,Q.action),Q=Q.next;while(Q!==I);es(L,h.memoizedState)||(Ma=!0),h.memoizedState=L,h.baseQueue===null&&(h.baseState=L),g.lastRenderedState=L}return[L,x]}function b(s,h,g){var x=Nn,I=zr(),L=or;if(L){if(g===void 0)throw Error(a(407));g=g()}else g=h();var Q=!es((mr||I).memoizedState,g);Q&&(I.memoizedState=g,Ma=!0),I=I.queue;var ae=p.bind(null,x,I,s);if(Ve(2048,8,ae,[s]),I.getSnapshot!==h||Q||xi!==null&&xi.memoizedState.tag&1){if(x.flags|=2048,be(9,Pe(),l.bind(null,x,I,g,h),null),Pr===null)throw Error(a(349));L||($s&124)!==0||n(x,h,g)}return g}function n(s,h,g){s.flags|=16384,s={getSnapshot:h,value:g},h=Nn.updateQueue,h===null?(h=Zo(),Nn.updateQueue=h,h.stores=[s]):(g=h.stores,g===null?h.stores=[s]:g.push(s))}function l(s,h,g,x){h.value=g,h.getSnapshot=x,_(h)&&w(s)}function p(s,h,g){return g(function(){_(h)&&w(s)})}function _(s){var h=s.getSnapshot;s=s.value;try{var g=h();return!es(s,g)}catch{return!0}}function w(s){var h=go(s,2);h!==null&&Ao(h,s,2)}function E(s){var h=$a();if(typeof s=="function"){var g=s;if(s=g(),Ca){di(!0);try{g()}finally{di(!1)}}}return h.memoizedState=h.baseState=s,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:s},h}function P(s,h,g,x){return s.baseState=g,Nc(s,mr,typeof x=="function"?x:Ss)}function D(s,h,g,x,I){if(iu(s))throw Error(a(485));if(s=h.action,s!==null){var L={payload:I,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Q){L.listeners.push(Q)}};et.T!==null?g(!0):L.isTransition=!1,x(L),g=h.pending,g===null?(L.next=h.pending=L,O(h,L)):(L.next=g.next,h.pending=g.next=L)}}function O(s,h){var g=h.action,x=h.payload,I=s.state;if(h.isTransition){var L=et.T,Q={};et.T=Q;try{var ae=g(I,x),De=et.S;De!==null&&De(Q,ae),F(s,h,ae)}catch(at){U(s,h,at)}finally{et.T=L}}else try{L=g(I,x),F(s,h,L)}catch(at){U(s,h,at)}}function F(s,h,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(x){q(s,h,x)},function(x){return U(s,h,x)}):q(s,h,g)}function q(s,h,g){h.status="fulfilled",h.value=g,H(h),s.state=g,h=s.pending,h!==null&&(g=h.next,g===h?s.pending=null:(g=g.next,h.next=g,O(s,g)))}function U(s,h,g){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do h.status="rejected",h.reason=g,H(h),h=h.next;while(h!==x)}s.action=null}function H(s){s=s.listeners;for(var h=0;h<s.length;h++)(0,s[h])()}function ee(s,h){return h}function fe(s,h){if(or){var g=Pr.formState;if(g!==null){e:{var x=Nn;if(or){if(mi){t:{for(var I=mi,L=Us;I.nodeType!==8;){if(!L){I=null;break t}if(I=Xs(I.nextSibling),I===null){I=null;break t}}L=I.data,I=L==="F!"||L==="F"?I:null}if(I){mi=Xs(I.nextSibling),x=I.data==="F!";break e}}Zl(x)}x=!1}x&&(h=g[0])}}return g=$a(),g.memoizedState=g.baseState=h,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ee,lastRenderedState:h},g.queue=x,g=bl.bind(null,Nn,x),x.dispatch=g,x=E(!1),L=Hs.bind(null,Nn,!1,x.queue),x=$a(),I={state:h,dispatch:null,action:s,pending:null},x.queue=I,g=D.bind(null,Nn,I,L,g),I.dispatch=g,x.memoizedState=s,[h,g,!1]}function he(s){var h=zr();return pe(h,mr,s)}function pe(s,h,g){if(h=Nc(s,h,ee)[0],s=Oc(Ss)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var x=$u(h)}catch(Q){throw Q===Mh?Jl:Q}else x=h;h=zr();var I=h.queue,L=I.dispatch;return g!==h.memoizedState&&(Nn.flags|=2048,be(9,Pe(),_e.bind(null,I,g),null)),[x,L,s]}function _e(s,h){s.action=h}function Ae(s){var h=zr(),g=mr;if(g!==null)return pe(h,g,s);zr(),h=h.memoizedState,g=zr();var x=g.queue.dispatch;return g.memoizedState=s,[h,x,!1]}function be(s,h,g,x){return s={tag:s,create:g,deps:x,inst:h,next:null},h=Nn.updateQueue,h===null&&(h=Zo(),Nn.updateQueue=h),g=h.lastEffect,g===null?h.lastEffect=s.next=s:(x=g.next,g.next=s,s.next=x,h.lastEffect=s),s}function Pe(){return{destroy:void 0,resource:void 0}}function Le(){return zr().memoizedState}function xe(s,h,g,x){var I=$a();x=x===void 0?null:x,Nn.flags|=s,I.memoizedState=be(1|h,Pe(),g,x)}function Ve(s,h,g,x){var I=zr();x=x===void 0?null:x;var L=I.memoizedState.inst;mr!==null&&x!==null&&qu(x,mr.memoizedState.deps)?I.memoizedState=be(h,L,g,x):(Nn.flags|=s,I.memoizedState=be(1|h,L,g,x))}function rt(s,h){xe(8390656,8,s,h)}function Ye(s,h){Ve(2048,8,s,h)}function Qe(s,h){return Ve(4,2,s,h)}function ot(s,h){return Ve(4,4,s,h)}function zt(s,h){if(typeof h=="function"){s=s();var g=h(s);return function(){typeof g=="function"?g():h(null)}}if(h!=null)return s=s(),h.current=s,function(){h.current=null}}function Lt(s,h,g){g=g!=null?g.concat([s]):null,Ve(4,4,zt.bind(null,h,s),g)}function bt(){}function Zt(s,h){var g=zr();h=h===void 0?null:h;var x=g.memoizedState;return h!==null&&qu(h,x[1])?x[0]:(g.memoizedState=[s,h],s)}function Mn(s,h){var g=zr();h=h===void 0?null:h;var x=g.memoizedState;if(h!==null&&qu(h,x[1]))return x[0];if(x=s(),Ca){di(!0);try{s()}finally{di(!1)}}return g.memoizedState=[x,h],x}function Qn(s,h,g){return g===void 0||($s&1073741824)!==0?s.memoizedState=h:(s.memoizedState=g,s=lv(),Nn.lanes|=s,qc|=s,g)}function Qr(s,h,g,x){return es(g,h)?g:Go.current!==null?(s=Qn(s,g,x),es(s,h)||(Ma=!0),s):($s&42)===0?(Ma=!0,s.memoizedState=g):(s=lv(),Nn.lanes|=s,qc|=s,h)}function gr(s,h,g,x,I){var L=Mt.p;Mt.p=L!==0&&8>L?L:8;var Q=et.T,ae={};et.T=ae,Hs(s,!1,h,g);try{var De=I(),at=et.S;if(at!==null&&at(ae,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var vt=xo(De,x);Gs(s,h,vt,Ks(s))}else Gs(s,h,x,Ks(s))}catch(Et){Gs(s,h,{then:function(){},status:"rejected",reason:Et},Ks())}finally{Mt.p=L,et.T=Q}}function ni(){}function yr(s,h,g,x){if(s.tag!==5)throw Error(a(476));var I=_r(s).queue;gr(s,I,h,Tt,g===null?ni:function(){return Ar(s),g(x)})}function _r(s){var h=s.memoizedState;if(h!==null)return h;h={memoizedState:Tt,baseState:Tt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:Tt},next:null};var g={};return h.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:g},next:null},s.memoizedState=h,s=s.alternate,s!==null&&(s.memoizedState=h),h}function Ar(s){var h=_r(s).next.queue;Gs(s,h,{},Ks())}function Wi(){return vi(le)}function Zn(){return zr().memoizedState}function Ki(){return zr().memoizedState}function pa(s){for(var h=s.return;h!==null;){switch(h.tag){case 24:case 3:var g=Ks();s=$o(g);var x=yl(h,s,g);x!==null&&(Ao(x,h,g),tu(x,h,g)),h={cache:Xl()},s.payload=h;return}h=h.return}}function ru(s,h,g){var x=Ks();g={lane:x,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null},iu(s)?Bc(h,g):(g=Ru(s,h,g,x),g!==null&&(Ao(g,s,x),Hu(g,h,x)))}function bl(s,h,g){var x=Ks();Gs(s,h,g,x)}function Gs(s,h,g,x){var I={lane:x,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null};if(iu(s))Bc(h,I);else{var L=s.alternate;if(s.lanes===0&&(L===null||L.lanes===0)&&(L=h.lastRenderedReducer,L!==null))try{var Q=h.lastRenderedState,ae=L(Q,g);if(I.hasEagerState=!0,I.eagerState=ae,es(ae,Q))return Pu(s,h,I,0),Pr===null&&Mu(),!1}catch{}finally{}if(g=Ru(s,h,I,x),g!==null)return Ao(g,s,x),Hu(g,h,x),!0}return!1}function Hs(s,h,g,x){if(x={lane:2,revertLane:Gc(),action:x,hasEagerState:!1,eagerState:null,next:null},iu(s)){if(h)throw Error(a(479))}else h=Ru(s,g,x,2),h!==null&&Ao(h,s,2)}function iu(s){var h=s.alternate;return s===Nn||h!==null&&h===Nn}function Bc(s,h){zc=Rh=!0;var g=s.pending;g===null?h.next=h:(h.next=g.next,g.next=h),s.pending=h}function Hu(s,h,g){if((g&4194048)!==0){var x=h.lanes;x&=s.pendingLanes,g|=x,h.lanes=g,ze(s,g)}}var ma={readContext:vi,use:Gu,useCallback:si,useContext:si,useEffect:si,useImperativeHandle:si,useLayoutEffect:si,useInsertionEffect:si,useMemo:si,useReducer:si,useRef:si,useState:si,useDebugValue:si,useDeferredValue:si,useTransition:si,useSyncExternalStore:si,useId:si,useHostTransitionStatus:si,useFormState:si,useActionState:si,useOptimistic:si,useMemoCache:si,useCacheRefresh:si},Zs={readContext:vi,use:Gu,useCallback:function(s,h){return $a().memoizedState=[s,h===void 0?null:h],s},useContext:vi,useEffect:rt,useImperativeHandle:function(s,h,g){g=g!=null?g.concat([s]):null,xe(4194308,4,zt.bind(null,h,s),g)},useLayoutEffect:function(s,h){return xe(4194308,4,s,h)},useInsertionEffect:function(s,h){xe(4,2,s,h)},useMemo:function(s,h){var g=$a();h=h===void 0?null:h;var x=s();if(Ca){di(!0);try{s()}finally{di(!1)}}return g.memoizedState=[x,h],x},useReducer:function(s,h,g){var x=$a();if(g!==void 0){var I=g(h);if(Ca){di(!0);try{g(h)}finally{di(!1)}}}else I=h;return x.memoizedState=x.baseState=I,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:I},x.queue=s,s=s.dispatch=ru.bind(null,Nn,s),[x.memoizedState,s]},useRef:function(s){var h=$a();return s={current:s},h.memoizedState=s},useState:function(s){s=E(s);var h=s.queue,g=bl.bind(null,Nn,h);return h.dispatch=g,[s.memoizedState,g]},useDebugValue:bt,useDeferredValue:function(s,h){var g=$a();return Qn(g,s,h)},useTransition:function(){var s=E(!1);return s=gr.bind(null,Nn,s.queue,!0,!1),$a().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,h,g){var x=Nn,I=$a();if(or){if(g===void 0)throw Error(a(407));g=g()}else{if(g=h(),Pr===null)throw Error(a(349));(rr&124)!==0||n(x,h,g)}I.memoizedState=g;var L={value:g,getSnapshot:h};return I.queue=L,rt(p.bind(null,x,L,s),[s]),x.flags|=2048,be(9,Pe(),l.bind(null,x,L,g,h),null),g},useId:function(){var s=$a(),h=Pr.identifierPrefix;if(or){var g=vs,x=vo;g=(x&~(1<<32-Ri(x)-1)).toString(32)+g,h=""+h+"R"+g,g=Uu++,0<g&&(h+="H"+g.toString(32)),h+=""}else g=Rd++,h=""+h+"r"+g.toString(32)+"";return s.memoizedState=h},useHostTransitionStatus:Wi,useFormState:fe,useActionState:fe,useOptimistic:function(s){var h=$a();h.memoizedState=h.baseState=s;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=g,h=Hs.bind(null,Nn,!0,g),g.dispatch=h,[s,h]},useMemoCache:vl,useCacheRefresh:function(){return $a().memoizedState=pa.bind(null,Nn)}},xl={readContext:vi,use:Gu,useCallback:Zt,useContext:vi,useEffect:Ye,useImperativeHandle:Lt,useInsertionEffect:Qe,useLayoutEffect:ot,useMemo:Mn,useReducer:Oc,useRef:Le,useState:function(){return Oc(Ss)},useDebugValue:bt,useDeferredValue:function(s,h){var g=zr();return Qr(g,mr.memoizedState,s,h)},useTransition:function(){var s=Oc(Ss)[0],h=zr().memoizedState;return[typeof s=="boolean"?s:$u(s),h]},useSyncExternalStore:b,useId:Zn,useHostTransitionStatus:Wi,useFormState:he,useActionState:he,useOptimistic:function(s,h){var g=zr();return P(g,mr,s,h)},useMemoCache:vl,useCacheRefresh:Ki},Zu={readContext:vi,use:Gu,useCallback:Zt,useContext:vi,useEffect:Ye,useImperativeHandle:Lt,useInsertionEffect:Qe,useLayoutEffect:ot,useMemo:Mn,useReducer:kh,useRef:Le,useState:function(){return kh(Ss)},useDebugValue:bt,useDeferredValue:function(s,h){var g=zr();return mr===null?Qn(g,s,h):Qr(g,mr.memoizedState,s,h)},useTransition:function(){var s=kh(Ss)[0],h=zr().memoizedState;return[typeof s=="boolean"?s:$u(s),h]},useSyncExternalStore:b,useId:Zn,useHostTransitionStatus:Wi,useFormState:Ae,useActionState:Ae,useOptimistic:function(s,h){var g=zr();return mr!==null?P(g,mr,s,h):(g.baseState=s,[s,g.queue.dispatch])},useMemoCache:vl,useCacheRefresh:Ki},Or=null,vr=0;function la(s){var h=vr;return vr+=1,Or===null&&(Or=[]),Ad(Or,s,h)}function oi(s,h){h=h.props.ref,s.ref=h!==void 0?h:null}function Dh(s,h){throw h.$$typeof===K?Error(a(525)):(s=Object.prototype.toString.call(h),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":s)))}function im(s){var h=s._init;return h(s._payload)}function kd(s){function h(Xe,qe){if(s){var it=Xe.deletions;it===null?(Xe.deletions=[qe],Xe.flags|=16):it.push(qe)}}function g(Xe,qe){if(!s)return null;for(;qe!==null;)h(Xe,qe),qe=qe.sibling;return null}function x(Xe){for(var qe=new Map;Xe!==null;)Xe.key!==null?qe.set(Xe.key,Xe):qe.set(Xe.index,Xe),Xe=Xe.sibling;return qe}function I(Xe,qe){return Xe=ja(Xe,qe),Xe.index=0,Xe.sibling=null,Xe}function L(Xe,qe,it){return Xe.index=it,s?(it=Xe.alternate,it!==null?(it=it.index,it<qe?(Xe.flags|=67108866,qe):it):(Xe.flags|=67108866,qe)):(Xe.flags|=1048576,qe)}function Q(Xe){return s&&Xe.alternate===null&&(Xe.flags|=67108866),Xe}function ae(Xe,qe,it,wt){return qe===null||qe.tag!==6?(qe=Ff(it,Xe.mode,wt),qe.return=Xe,qe):(qe=I(qe,it),qe.return=Xe,qe)}function De(Xe,qe,it,wt){var an=it.type;return an===re?vt(Xe,qe,it.props.children,wt,it.key):qe!==null&&(qe.elementType===an||typeof an=="object"&&an!==null&&an.$$typeof===se&&im(an)===qe.type)?(qe=I(qe,it.props),oi(qe,it),qe.return=Xe,qe):(qe=Th(it.type,it.key,it.props,null,Xe.mode,wt),oi(qe,it),qe.return=Xe,qe)}function at(Xe,qe,it,wt){return qe===null||qe.tag!==4||qe.stateNode.containerInfo!==it.containerInfo||qe.stateNode.implementation!==it.implementation?(qe=Vf(it,Xe.mode,wt),qe.return=Xe,qe):(qe=I(qe,it.children||[]),qe.return=Xe,qe)}function vt(Xe,qe,it,wt,an){return qe===null||qe.tag!==7?(qe=_o(it,Xe.mode,wt,an),qe.return=Xe,qe):(qe=I(qe,it),qe.return=Xe,qe)}function Et(Xe,qe,it){if(typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint")return qe=Ff(""+qe,Xe.mode,it),qe.return=Xe,qe;if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case $:return it=Th(qe.type,qe.key,qe.props,null,Xe.mode,it),oi(it,qe),it.return=Xe,it;case W:return qe=Vf(qe,Xe.mode,it),qe.return=Xe,qe;case se:var wt=qe._init;return qe=wt(qe._payload),Et(Xe,qe,it)}if(Kt(qe)||ke(qe))return qe=_o(qe,Xe.mode,it,null),qe.return=Xe,qe;if(typeof qe.then=="function")return Et(Xe,la(qe),it);if(qe.$$typeof===ut)return Et(Xe,fl(Xe,qe),it);Dh(Xe,qe)}return null}function ct(Xe,qe,it,wt){var an=qe!==null?qe.key:null;if(typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint")return an!==null?null:ae(Xe,qe,""+it,wt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case $:return it.key===an?De(Xe,qe,it,wt):null;case W:return it.key===an?at(Xe,qe,it,wt):null;case se:return an=it._init,it=an(it._payload),ct(Xe,qe,it,wt)}if(Kt(it)||ke(it))return an!==null?null:vt(Xe,qe,it,wt,null);if(typeof it.then=="function")return ct(Xe,qe,la(it),wt);if(it.$$typeof===ut)return ct(Xe,qe,fl(Xe,it),wt);Dh(Xe,it)}return null}function dt(Xe,qe,it,wt,an){if(typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint")return Xe=Xe.get(it)||null,ae(qe,Xe,""+wt,an);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case $:return Xe=Xe.get(wt.key===null?it:wt.key)||null,De(qe,Xe,wt,an);case W:return Xe=Xe.get(wt.key===null?it:wt.key)||null,at(qe,Xe,wt,an);case se:var Xn=wt._init;return wt=Xn(wt._payload),dt(Xe,qe,it,wt,an)}if(Kt(wt)||ke(wt))return Xe=Xe.get(it)||null,vt(qe,Xe,wt,an,null);if(typeof wt.then=="function")return dt(Xe,qe,it,la(wt),an);if(wt.$$typeof===ut)return dt(Xe,qe,it,fl(qe,wt),an);Dh(qe,wt)}return null}function fn(Xe,qe,it,wt){for(var an=null,Xn=null,dn=qe,Tn=qe=0,Zr=null;dn!==null&&Tn<it.length;Tn++){dn.index>Tn?(Zr=dn,dn=null):Zr=dn.sibling;var ir=ct(Xe,dn,it[Tn],wt);if(ir===null){dn===null&&(dn=Zr);break}s&&dn&&ir.alternate===null&&h(Xe,dn),qe=L(ir,qe,Tn),Xn===null?an=ir:Xn.sibling=ir,Xn=ir,dn=Zr}if(Tn===it.length)return g(Xe,dn),or&&js(Xe,Tn),an;if(dn===null){for(;Tn<it.length;Tn++)dn=Et(Xe,it[Tn],wt),dn!==null&&(qe=L(dn,qe,Tn),Xn===null?an=dn:Xn.sibling=dn,Xn=dn);return or&&js(Xe,Tn),an}for(dn=x(dn);Tn<it.length;Tn++)Zr=dt(dn,Xe,Tn,it[Tn],wt),Zr!==null&&(s&&Zr.alternate!==null&&dn.delete(Zr.key===null?Tn:Zr.key),qe=L(Zr,qe,Tn),Xn===null?an=Zr:Xn.sibling=Zr,Xn=Zr);return s&&dn.forEach(function(sc){return h(Xe,sc)}),or&&js(Xe,Tn),an}function bn(Xe,qe,it,wt){if(it==null)throw Error(a(151));for(var an=null,Xn=null,dn=qe,Tn=qe=0,Zr=null,ir=it.next();dn!==null&&!ir.done;Tn++,ir=it.next()){dn.index>Tn?(Zr=dn,dn=null):Zr=dn.sibling;var sc=ct(Xe,dn,ir.value,wt);if(sc===null){dn===null&&(dn=Zr);break}s&&dn&&sc.alternate===null&&h(Xe,dn),qe=L(sc,qe,Tn),Xn===null?an=sc:Xn.sibling=sc,Xn=sc,dn=Zr}if(ir.done)return g(Xe,dn),or&&js(Xe,Tn),an;if(dn===null){for(;!ir.done;Tn++,ir=it.next())ir=Et(Xe,ir.value,wt),ir!==null&&(qe=L(ir,qe,Tn),Xn===null?an=ir:Xn.sibling=ir,Xn=ir);return or&&js(Xe,Tn),an}for(dn=x(dn);!ir.done;Tn++,ir=it.next())ir=dt(dn,Xe,Tn,ir.value,wt),ir!==null&&(s&&ir.alternate!==null&&dn.delete(ir.key===null?Tn:ir.key),qe=L(ir,qe,Tn),Xn===null?an=ir:Xn.sibling=ir,Xn=ir);return s&&dn.forEach(function(Vb){return h(Xe,Vb)}),or&&js(Xe,Tn),an}function jr(Xe,qe,it,wt){if(typeof it=="object"&&it!==null&&it.type===re&&it.key===null&&(it=it.props.children),typeof it=="object"&&it!==null){switch(it.$$typeof){case $:e:{for(var an=it.key;qe!==null;){if(qe.key===an){if(an=it.type,an===re){if(qe.tag===7){g(Xe,qe.sibling),wt=I(qe,it.props.children),wt.return=Xe,Xe=wt;break e}}else if(qe.elementType===an||typeof an=="object"&&an!==null&&an.$$typeof===se&&im(an)===qe.type){g(Xe,qe.sibling),wt=I(qe,it.props),oi(wt,it),wt.return=Xe,Xe=wt;break e}g(Xe,qe);break}else h(Xe,qe);qe=qe.sibling}it.type===re?(wt=_o(it.props.children,Xe.mode,wt,it.key),wt.return=Xe,Xe=wt):(wt=Th(it.type,it.key,it.props,null,Xe.mode,wt),oi(wt,it),wt.return=Xe,Xe=wt)}return Q(Xe);case W:e:{for(an=it.key;qe!==null;){if(qe.key===an)if(qe.tag===4&&qe.stateNode.containerInfo===it.containerInfo&&qe.stateNode.implementation===it.implementation){g(Xe,qe.sibling),wt=I(qe,it.children||[]),wt.return=Xe,Xe=wt;break e}else{g(Xe,qe);break}else h(Xe,qe);qe=qe.sibling}wt=Vf(it,Xe.mode,wt),wt.return=Xe,Xe=wt}return Q(Xe);case se:return an=it._init,it=an(it._payload),jr(Xe,qe,it,wt)}if(Kt(it))return fn(Xe,qe,it,wt);if(ke(it)){if(an=ke(it),typeof an!="function")throw Error(a(150));return it=an.call(it),bn(Xe,qe,it,wt)}if(typeof it.then=="function")return jr(Xe,qe,la(it),wt);if(it.$$typeof===ut)return jr(Xe,qe,fl(Xe,it),wt);Dh(Xe,it)}return typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint"?(it=""+it,qe!==null&&qe.tag===6?(g(Xe,qe.sibling),wt=I(qe,it),wt.return=Xe,Xe=wt):(g(Xe,qe),wt=Ff(it,Xe.mode,wt),wt.return=Xe,Xe=wt),Q(Xe)):g(Xe,qe)}return function(Xe,qe,it,wt){try{vr=0;var an=jr(Xe,qe,it,wt);return Or=null,an}catch(dn){if(dn===Mh||dn===Jl)throw dn;var Xn=Va(29,dn,null,Xe.mode);return Xn.lanes=wt,Xn.return=Xe,Xn}finally{}}}var Wo=kd(!0),Wu=kd(!1),Fi=_t(null),Gr=null;function Ia(s){var h=s.alternate;St(wi,wi.current&1),St(Fi,s),Gr===null&&(h===null||Go.current!==null||h.memoizedState!==null)&&(Gr=s)}function Dd(s){if(s.tag===22){if(St(wi,wi.current),St(Fi,s),Gr===null){var h=s.alternate;h!==null&&h.memoizedState!==null&&(Gr=s)}}else Ga()}function Ga(){St(wi,wi.current),St(Fi,Fi.current)}function To(s){At(Fi),Gr===s&&(Gr=null),At(wi)}var wi=_t(0);function au(s){for(var h=s;h!==null;){if(h.tag===13){var g=h.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||Yd(g)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===s)break;for(;h.sibling===null;){if(h.return===null||h.return===s)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function am(s,h,g,x){h=s.memoizedState,g=g(x,h),g=g==null?h:B({},h,g),s.memoizedState=g,s.lanes===0&&(s.updateQueue.baseState=g)}var Ku={enqueueSetState:function(s,h,g){s=s._reactInternals;var x=Ks(),I=$o(x);I.payload=h,g!=null&&(I.callback=g),h=yl(s,I,x),h!==null&&(Ao(h,s,x),tu(h,s,x))},enqueueReplaceState:function(s,h,g){s=s._reactInternals;var x=Ks(),I=$o(x);I.tag=1,I.payload=h,g!=null&&(I.callback=g),h=yl(s,I,x),h!==null&&(Ao(h,s,x),tu(h,s,x))},enqueueForceUpdate:function(s,h){s=s._reactInternals;var g=Ks(),x=$o(g);x.tag=2,h!=null&&(x.callback=h),h=yl(s,x,g),h!==null&&(Ao(h,s,g),tu(h,s,g))}};function Fc(s,h,g,x,I,L,Q){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,L,Q):h.prototype&&h.prototype.isPureReactComponent?!Ic(g,x)||!Ic(I,L):!0}function Pg(s,h,g,x){s=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(g,x),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(g,x),h.state!==s&&Ku.enqueueReplaceState(h,h.state,null)}function Lh(s,h){var g=h;if("ref"in h){g={};for(var x in h)x!=="ref"&&(g[x]=h[x])}if(s=s.defaultProps){g===h&&(g=B({},g));for(var I in s)g[I]===void 0&&(g[I]=s[I])}return g}var Ld=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Rg(s){Ld(s)}function W_(s){console.error(s)}function kg(s){Ld(s)}function sm(s,h){try{var g=s.onUncaughtError;g(h.value,{componentStack:h.stack})}catch(x){setTimeout(function(){throw x})}}function om(s,h,g){try{var x=s.onCaughtError;x(g.value,{componentStack:g.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function Dg(s,h,g){return g=$o(g),g.tag=3,g.payload={element:null},g.callback=function(){sm(s,h)},g}function lm(s){return s=$o(s),s.tag=3,s}function Lg(s,h,g,x){var I=g.type.getDerivedStateFromError;if(typeof I=="function"){var L=x.value;s.payload=function(){return I(L)},s.callback=function(){om(h,g,x)}}var Q=g.stateNode;Q!==null&&typeof Q.componentDidCatch=="function"&&(s.callback=function(){om(h,g,x),typeof I!="function"&&(ec===null?ec=new Set([this]):ec.add(this));var ae=x.stack;this.componentDidCatch(x.value,{componentStack:ae!==null?ae:""})})}function K_(s,h,g,x,I){if(g.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(h=g.alternate,h!==null&&Fu(h,g,I,!0),g=Fi.current,g!==null){switch(g.tag){case 13:return Gr===null?iy():g.alternate===null&&Vi===0&&(Vi=3),g.flags&=-257,g.flags|=65536,g.lanes=I,x===eu?g.flags|=16384:(h=g.updateQueue,h===null?g.updateQueue=new Set([x]):h.add(x),hy(s,x,I)),!1;case 22:return g.flags|=65536,x===eu?g.flags|=16384:(h=g.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([x])},g.updateQueue=h):(g=h.retryQueue,g===null?h.retryQueue=new Set([x]):g.add(x)),hy(s,x,I)),!1}throw Error(a(435,g.tag))}return hy(s,x,I),iy(),!1}if(or)return h=Fi.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=I,x!==wd&&(s=Error(a(422),{cause:x}),qs(ys(s,g)))):(x!==wd&&(h=Error(a(423),{cause:x}),qs(ys(h,g))),s=s.current.alternate,s.flags|=65536,I&=-I,s.lanes|=I,x=ys(x,g),I=Dg(s.stateNode,x,I),qf(s,I),Vi!==4&&(Vi=2)),!1;var L=Error(a(520),{cause:x});if(L=ys(L,g),op===null?op=[L]:op.push(L),Vi!==4&&(Vi=2),h===null)return!0;x=ys(x,g),g=h;do{switch(g.tag){case 3:return g.flags|=65536,s=I&-I,g.lanes|=s,s=Dg(g.stateNode,x,s),qf(g,s),!1;case 1:if(h=g.type,L=g.stateNode,(g.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(ec===null||!ec.has(L))))return g.flags|=65536,I&=-I,g.lanes|=I,I=lm(I),Lg(I,s,g,x),qf(g,I),!1}g=g.return}while(g!==null);return!1}var zh=Error(a(461)),Ma=!1;function Xi(s,h,g,x){h.child=s===null?Wu(h,null,g,x):Wo(h,s.child,g,x)}function Zf(s,h,g,x,I){g=g.render;var L=h.ref;if("ref"in x){var Q={};for(var ae in x)ae!=="ref"&&(Q[ae]=x[ae])}else Q=x;return Kl(h),x=fa(s,h,g,Q,L,I),ae=_l(),s!==null&&!Ma?($r(s,h,I),Xu(s,h,I)):(or&&ae&&Nu(h),h.flags|=1,Xi(s,h,x,I),h.child)}function Wf(s,h,g,x,I){if(s===null){var L=g.type;return typeof L=="function"&&!zn(L)&&L.defaultProps===void 0&&g.compare===null?(h.tag=15,h.type=L,zg(s,h,L,x,I)):(s=Th(g.type,null,x,h,h.mode,I),s.ref=h.ref,s.return=h,h.child=s)}if(L=s.child,!fm(s,I)){var Q=L.memoizedProps;if(g=g.compare,g=g!==null?g:Ic,g(Q,x)&&s.ref===h.ref)return Xu(s,h,I)}return h.flags|=1,s=ja(L,x),s.ref=h.ref,s.return=h,h.child=s}function zg(s,h,g,x,I){if(s!==null){var L=s.memoizedProps;if(Ic(L,x)&&s.ref===h.ref)if(Ma=!1,h.pendingProps=x=L,fm(s,I))(s.flags&131072)!==0&&(Ma=!0);else return h.lanes=s.lanes,Xu(s,h,I)}return cm(s,h,g,x,I)}function Og(s,h,g){var x=h.pendingProps,I=x.children,L=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((h.flags&128)!==0){if(x=L!==null?L.baseLanes|g:g,s!==null){for(I=h.child=s.child,L=0;I!==null;)L=L|I.lanes|I.childLanes,I=I.sibling;h.childLanes=L&~x}else h.childLanes=0,h.child=null;return X_(s,h,x,g)}if((g&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},s!==null&&Sd(h,L!==null?L.cachePool:null),L!==null?Pd(h,L):Ho(),Dd(h);else return h.lanes=h.childLanes=536870912,X_(s,h,L!==null?L.baseLanes|g:g,g)}else L!==null?(Sd(h,L.cachePool),Pd(h,L),Ga(),h.memoizedState=null):(s!==null&&Sd(h,null),Ho(),Ga());return Xi(s,h,I,g),h.child}function X_(s,h,g,x){var I=Ql();return I=I===null?null:{parent:Bi._currentValue,pool:I},h.memoizedState={baseLanes:g,cachePool:I},s!==null&&Sd(h,null),Ho(),Dd(h),s!==null&&Fu(s,h,x,!0),null}function um(s,h){var g=h.ref;if(g===null)s!==null&&s.ref!==null&&(h.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(a(284));(s===null||s.ref!==g)&&(h.flags|=4194816)}}function cm(s,h,g,x,I){return Kl(h),g=fa(s,h,g,x,void 0,I),x=_l(),s!==null&&!Ma?($r(s,h,I),Xu(s,h,I)):(or&&x&&Nu(h),h.flags|=1,Xi(s,h,g,I),h.child)}function Ng(s,h,g,x,I,L){return Kl(h),h.updateQueue=null,g=oa(h,x,g,I),Hf(s),x=_l(),s!==null&&!Ma?($r(s,h,L),Xu(s,h,L)):(or&&x&&Nu(h),h.flags|=1,Xi(s,h,g,L),h.child)}function Bg(s,h,g,x,I){if(Kl(h),h.stateNode===null){var L=yo,Q=g.contextType;typeof Q=="object"&&Q!==null&&(L=vi(Q)),L=new g(x,L),h.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=Ku,h.stateNode=L,L._reactInternals=h,L=h.stateNode,L.props=x,L.state=h.memoizedState,L.refs={},Ph(h),Q=g.contextType,L.context=typeof Q=="object"&&Q!==null?vi(Q):yo,L.state=h.memoizedState,Q=g.getDerivedStateFromProps,typeof Q=="function"&&(am(h,g,Q,x),L.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(Q=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),Q!==L.state&&Ku.enqueueReplaceState(L,L.state,null),nu(h,x,L,I),ju(),L.state=h.memoizedState),typeof L.componentDidMount=="function"&&(h.flags|=4194308),x=!0}else if(s===null){L=h.stateNode;var ae=h.memoizedProps,De=Lh(g,ae);L.props=De;var at=L.context,vt=g.contextType;Q=yo,typeof vt=="object"&&vt!==null&&(Q=vi(vt));var Et=g.getDerivedStateFromProps;vt=typeof Et=="function"||typeof L.getSnapshotBeforeUpdate=="function",ae=h.pendingProps!==ae,vt||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(ae||at!==Q)&&Pg(h,L,x,Q),Ts=!1;var ct=h.memoizedState;L.state=ct,nu(h,x,L,I),ju(),at=h.memoizedState,ae||ct!==at||Ts?(typeof Et=="function"&&(am(h,g,Et,x),at=h.memoizedState),(De=Ts||Fc(h,g,De,x,ct,at,Q))?(vt||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(h.flags|=4194308)):(typeof L.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=x,h.memoizedState=at),L.props=x,L.state=at,L.context=Q,x=De):(typeof L.componentDidMount=="function"&&(h.flags|=4194308),x=!1)}else{L=h.stateNode,On(s,h),Q=h.memoizedProps,vt=Lh(g,Q),L.props=vt,Et=h.pendingProps,ct=L.context,at=g.contextType,De=yo,typeof at=="object"&&at!==null&&(De=vi(at)),ae=g.getDerivedStateFromProps,(at=typeof ae=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(Q!==Et||ct!==De)&&Pg(h,L,x,De),Ts=!1,ct=h.memoizedState,L.state=ct,nu(h,x,L,I),ju();var dt=h.memoizedState;Q!==Et||ct!==dt||Ts||s!==null&&s.dependencies!==null&&Ch(s.dependencies)?(typeof ae=="function"&&(am(h,g,ae,x),dt=h.memoizedState),(vt=Ts||Fc(h,g,vt,x,ct,dt,De)||s!==null&&s.dependencies!==null&&Ch(s.dependencies))?(at||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(x,dt,De),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(x,dt,De)),typeof L.componentDidUpdate=="function"&&(h.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof L.componentDidUpdate!="function"||Q===s.memoizedProps&&ct===s.memoizedState||(h.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||Q===s.memoizedProps&&ct===s.memoizedState||(h.flags|=1024),h.memoizedProps=x,h.memoizedState=dt),L.props=x,L.state=dt,L.context=De,x=vt):(typeof L.componentDidUpdate!="function"||Q===s.memoizedProps&&ct===s.memoizedState||(h.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||Q===s.memoizedProps&&ct===s.memoizedState||(h.flags|=1024),x=!1)}return L=x,um(s,h),x=(h.flags&128)!==0,L||x?(L=h.stateNode,g=x&&typeof g.getDerivedStateFromError!="function"?null:L.render(),h.flags|=1,s!==null&&x?(h.child=Wo(h,s.child,null,I),h.child=Wo(h,null,g,I)):Xi(s,h,g,I),h.memoizedState=L.state,s=h.child):s=Xu(s,h,I),s}function Y_(s,h,g,x){return kc(),h.flags|=256,Xi(s,h,g,x),h.child}var Kf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hm(s){return{baseLanes:s,cachePool:Ih()}}function Xf(s,h,g){return s=s!==null?s.childLanes&~g:0,h&&(s|=Qo),s}function zd(s,h,g){var x=h.pendingProps,I=!1,L=(h.flags&128)!==0,Q;if((Q=L)||(Q=s!==null&&s.memoizedState===null?!1:(wi.current&2)!==0),Q&&(I=!0,h.flags&=-129),Q=(h.flags&32)!==0,h.flags&=-33,s===null){if(or){if(I?Ia(h):Ga(),or){var ae=mi,De;if(De=ae){e:{for(De=ae,ae=Us;De.nodeType!==8;){if(!ae){ae=null;break e}if(De=Xs(De.nextSibling),De===null){ae=null;break e}}ae=De}ae!==null?(h.memoizedState={dehydrated:ae,treeContext:jo!==null?{id:vo,overflow:vs}:null,retryLane:536870912,hydrationErrors:null},De=Va(18,null,null,0),De.stateNode=ae,De.return=h,h.child=De,pi=h,mi=null,De=!0):De=!1}De||Zl(h)}if(ae=h.memoizedState,ae!==null&&(ae=ae.dehydrated,ae!==null))return Yd(ae)?h.lanes=32:h.lanes=536870912,null;To(h)}return ae=x.children,x=x.fallback,I?(Ga(),I=h.mode,ae=Yf({mode:"hidden",children:ae},I),x=_o(x,I,g,null),ae.return=h,x.return=h,ae.sibling=x,h.child=ae,I=h.child,I.memoizedState=hm(g),I.childLanes=Xf(s,Q,g),h.memoizedState=Kf,x):(Ia(h),Ha(h,ae))}if(De=s.memoizedState,De!==null&&(ae=De.dehydrated,ae!==null)){if(L)h.flags&256?(Ia(h),h.flags&=-257,h=Qf(s,h,g)):h.memoizedState!==null?(Ga(),h.child=s.child,h.flags|=128,h=null):(Ga(),I=x.fallback,ae=h.mode,x=Yf({mode:"visible",children:x.children},ae),I=_o(I,ae,g,null),I.flags|=2,x.return=h,I.return=h,x.sibling=I,h.child=x,Wo(h,s.child,null,g),x=h.child,x.memoizedState=hm(g),x.childLanes=Xf(s,Q,g),h.memoizedState=Kf,h=I);else if(Ia(h),Yd(ae)){if(Q=ae.nextSibling&&ae.nextSibling.dataset,Q)var at=Q.dgst;Q=at,x=Error(a(419)),x.stack="",x.digest=Q,qs({value:x,source:null,stack:null}),h=Qf(s,h,g)}else if(Ma||Fu(s,h,g,!1),Q=(g&s.childLanes)!==0,Ma||Q){if(Q=Pr,Q!==null&&(x=g&-g,x=(x&42)!==0?1:Ot(x),x=(x&(Q.suspendedLanes|g))!==0?0:x,x!==0&&x!==De.retryLane))throw De.retryLane=x,go(s,x),Ao(Q,s,x),zh;ae.data==="$?"||iy(),h=Qf(s,h,g)}else ae.data==="$?"?(h.flags|=192,h.child=s.child,h=null):(s=De.treeContext,mi=Xs(ae.nextSibling),pi=h,or=!0,Uo=null,Us=!1,s!==null&&(Ua[Aa++]=vo,Ua[Aa++]=vs,Ua[Aa++]=jo,vo=s.id,vs=s.overflow,jo=h),h=Ha(h,x.children),h.flags|=4096);return h}return I?(Ga(),I=x.fallback,ae=h.mode,De=s.child,at=De.sibling,x=ja(De,{mode:"hidden",children:x.children}),x.subtreeFlags=De.subtreeFlags&65011712,at!==null?I=ja(at,I):(I=_o(I,ae,g,null),I.flags|=2),I.return=h,x.return=h,x.sibling=I,h.child=x,x=I,I=h.child,ae=s.child.memoizedState,ae===null?ae=hm(g):(De=ae.cachePool,De!==null?(at=Bi._currentValue,De=De.parent!==at?{parent:at,pool:at}:De):De=Ih(),ae={baseLanes:ae.baseLanes|g,cachePool:De}),I.memoizedState=ae,I.childLanes=Xf(s,Q,g),h.memoizedState=Kf,x):(Ia(h),g=s.child,s=g.sibling,g=ja(g,{mode:"visible",children:x.children}),g.return=h,g.sibling=null,s!==null&&(Q=h.deletions,Q===null?(h.deletions=[s],h.flags|=16):Q.push(s)),h.child=g,h.memoizedState=null,g)}function Ha(s,h){return h=Yf({mode:"visible",children:h},s.mode),h.return=s,s.child=h}function Yf(s,h){return s=Va(22,s,null,h),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Qf(s,h,g){return Wo(h,s.child,null,g),s=Ha(h,h.pendingProps.children),s.flags|=2,h.memoizedState=null,s}function Q_(s,h,g){s.lanes|=h;var x=s.alternate;x!==null&&(x.lanes|=h),Ah(s.return,h,g)}function dm(s,h,g,x,I){var L=s.memoizedState;L===null?s.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:x,tail:g,tailMode:I}:(L.isBackwards=h,L.rendering=null,L.renderingStartTime=0,L.last=x,L.tail=g,L.tailMode=I)}function J_(s,h,g){var x=h.pendingProps,I=x.revealOrder,L=x.tail;if(Xi(s,h,x.children,g),x=wi.current,(x&2)!==0)x=x&1|2,h.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=h.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Q_(s,g,h);else if(s.tag===19)Q_(s,g,h);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===h)break e;for(;s.sibling===null;){if(s.return===null||s.return===h)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(St(wi,x),I){case"forwards":for(g=h.child,I=null;g!==null;)s=g.alternate,s!==null&&au(s)===null&&(I=g),g=g.sibling;g=I,g===null?(I=h.child,h.child=null):(I=g.sibling,g.sibling=null),dm(h,!1,I,g,L);break;case"backwards":for(g=null,I=h.child,h.child=null;I!==null;){if(s=I.alternate,s!==null&&au(s)===null){h.child=I;break}s=I.sibling,I.sibling=g,g=I,I=s}dm(h,!0,g,null,L);break;case"together":dm(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Xu(s,h,g){if(s!==null&&(h.dependencies=s.dependencies),qc|=h.lanes,(g&h.childLanes)===0)if(s!==null){if(Fu(s,h,g,!1),(g&h.childLanes)===0)return null}else return null;if(s!==null&&h.child!==s.child)throw Error(a(153));if(h.child!==null){for(s=h.child,g=ja(s,s.pendingProps),h.child=g,g.return=h;s.sibling!==null;)s=s.sibling,g=g.sibling=ja(s,s.pendingProps),g.return=h;g.sibling=null}return h.child}function fm(s,h){return(s.lanes&h)!==0?!0:(s=s.dependencies,!!(s!==null&&Ch(s)))}function Pb(s,h,g){switch(h.tag){case 3:wr(h,h.stateNode.containerInfo),xs(h,Bi,s.memoizedState.cache),kc();break;case 27:case 5:Ds(h);break;case 4:wr(h,h.stateNode.containerInfo);break;case 10:xs(h,h.type,h.memoizedProps.value);break;case 13:var x=h.memoizedState;if(x!==null)return x.dehydrated!==null?(Ia(h),h.flags|=128,null):(g&h.child.childLanes)!==0?zd(s,h,g):(Ia(h),s=Xu(s,h,g),s!==null?s.sibling:null);Ia(h);break;case 19:var I=(s.flags&128)!==0;if(x=(g&h.childLanes)!==0,x||(Fu(s,h,g,!1),x=(g&h.childLanes)!==0),I){if(x)return J_(s,h,g);h.flags|=128}if(I=h.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),St(wi,wi.current),x)break;return null;case 22:case 23:return h.lanes=0,Og(s,h,g);case 24:xs(h,Bi,s.memoizedState.cache)}return Xu(s,h,g)}function pm(s,h,g){if(s!==null)if(s.memoizedProps!==h.pendingProps)Ma=!0;else{if(!fm(s,g)&&(h.flags&128)===0)return Ma=!1,Pb(s,h,g);Ma=(s.flags&131072)!==0}else Ma=!1,or&&(h.flags&1048576)!==0&&Ou(h,zu,h.index);switch(h.lanes=0,h.tag){case 16:e:{s=h.pendingProps;var x=h.elementType,I=x._init;if(x=I(x._payload),h.type=x,typeof x=="function")zn(x)?(s=Lh(x,s),h.tag=1,h=Bg(null,h,x,s,g)):(h.tag=0,h=cm(null,h,x,s,g));else{if(x!=null){if(I=x.$$typeof,I===Ue){h.tag=11,h=Zf(null,h,x,s,g);break e}else if(I===me){h.tag=14,h=Wf(null,h,x,s,g);break e}}throw h=Bt(x)||x,Error(a(306,h,""))}}return h;case 0:return cm(s,h,h.type,h.pendingProps,g);case 1:return x=h.type,I=Lh(x,h.pendingProps),Bg(s,h,x,I,g);case 3:e:{if(wr(h,h.stateNode.containerInfo),s===null)throw Error(a(387));x=h.pendingProps;var L=h.memoizedState;I=L.element,On(s,h),nu(h,x,null,g);var Q=h.memoizedState;if(x=Q.cache,xs(h,Bi,x),x!==L.cache&&Bu(h,[Bi],g,!0),ju(),x=Q.element,L.isDehydrated)if(L={element:x,isDehydrated:!1,cache:Q.cache},h.updateQueue.baseState=L,h.memoizedState=L,h.flags&256){h=Y_(s,h,x,g);break e}else if(x!==I){I=ys(Error(a(424)),h),qs(I),h=Y_(s,h,x,g);break e}else{switch(s=h.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(mi=Xs(s.firstChild),pi=h,or=!0,Uo=null,Us=!0,g=Wu(h,null,x,g),h.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(kc(),x===I){h=Xu(s,h,g);break e}Xi(s,h,x,g)}h=h.child}return h;case 26:return um(s,h),s===null?(g=Dy(h.type,null,h.pendingProps,null))?h.memoizedState=g:or||(g=h.type,s=h.pendingProps,x=_p(gn.current).createElement(g),x[An]=h,x[vn]=s,Br(x,g,s),nn(x),h.stateNode=x):h.memoizedState=Dy(h.type,s.memoizedProps,h.pendingProps,s.memoizedState),null;case 27:return Ds(h),s===null&&or&&(x=h.stateNode=Sv(h.type,h.pendingProps,gn.current),pi=h,Us=!0,I=mi,Zc(h.type)?(Cy=I,mi=Xs(x.firstChild)):mi=I),Xi(s,h,h.pendingProps.children,g),um(s,h),s===null&&(h.flags|=4194304),h.child;case 5:return s===null&&or&&((I=x=mi)&&(x=zm(x,h.type,h.pendingProps,Us),x!==null?(h.stateNode=x,pi=h,mi=Xs(x.firstChild),Us=!1,I=!0):I=!1),I||Zl(h)),Ds(h),I=h.type,L=h.pendingProps,Q=s!==null?s.memoizedProps:null,x=L.children,Ty(I,L)?x=null:Q!==null&&Ty(I,Q)&&(h.flags|=32),h.memoizedState!==null&&(I=fa(s,h,rm,null,null,g),le._currentValue=I),um(s,h),Xi(s,h,x,g),h.child;case 6:return s===null&&or&&((s=g=mi)&&(g=wv(g,h.pendingProps,Us),g!==null?(h.stateNode=g,pi=h,mi=null,s=!0):s=!1),s||Zl(h)),null;case 13:return zd(s,h,g);case 4:return wr(h,h.stateNode.containerInfo),x=h.pendingProps,s===null?h.child=Wo(h,null,x,g):Xi(s,h,x,g),h.child;case 11:return Zf(s,h,h.type,h.pendingProps,g);case 7:return Xi(s,h,h.pendingProps,g),h.child;case 8:return Xi(s,h,h.pendingProps.children,g),h.child;case 12:return Xi(s,h,h.pendingProps.children,g),h.child;case 10:return x=h.pendingProps,xs(h,h.type,x.value),Xi(s,h,x.children,g),h.child;case 9:return I=h.type._context,x=h.pendingProps.children,Kl(h),I=vi(I),x=x(I),h.flags|=1,Xi(s,h,x,g),h.child;case 14:return Wf(s,h,h.type,h.pendingProps,g);case 15:return zg(s,h,h.type,h.pendingProps,g);case 19:return J_(s,h,g);case 31:return x=h.pendingProps,g=h.mode,x={mode:x.mode,children:x.children},s===null?(g=Yf(x,g),g.ref=h.ref,h.child=g,g.return=h,h=g):(g=ja(s.child,x),g.ref=h.ref,h.child=g,g.return=h,h=g),h;case 22:return Og(s,h,g);case 24:return Kl(h),x=vi(Bi),s===null?(I=Ql(),I===null&&(I=Pr,L=Xl(),I.pooledCache=L,L.refCount++,L!==null&&(I.pooledCacheLanes|=g),I=L),h.memoizedState={parent:x,cache:I},Ph(h),xs(h,Bi,I)):((s.lanes&g)!==0&&(On(s,h),nu(h,null,null,g),ju()),I=s.memoizedState,L=h.memoizedState,I.parent!==x?(I={parent:x,cache:x},h.memoizedState=I,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=I),xs(h,Bi,x)):(x=L.cache,xs(h,Bi,x),x!==I.cache&&Bu(h,[Bi],g,!0))),Xi(s,h,h.pendingProps.children,g),h.child;case 29:throw h.pendingProps}throw Error(a(156,h.tag))}function su(s){s.flags|=4}function Fg(s,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!C(h)){if(h=Fi.current,h!==null&&((rr&4194048)===rr?Gr!==null:(rr&62914560)!==rr&&(rr&536870912)===0||h!==Gr))throw gl=eu,Ed;s.flags|=8192}}function mm(s,h){h!==null&&(s.flags|=4),s.flags&16384&&(h=s.tag!==22?je():536870912,s.lanes|=h,jd|=h)}function Jf(s,h){if(!or)switch(s.tailMode){case"hidden":h=s.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?s.tail=null:g.sibling=null;break;case"collapsed":g=s.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?h||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Ti(s){var h=s.alternate!==null&&s.alternate.child===s.child,g=0,x=0;if(h)for(var I=s.child;I!==null;)g|=I.lanes|I.childLanes,x|=I.subtreeFlags&65011712,x|=I.flags&65011712,I.return=s,I=I.sibling;else for(I=s.child;I!==null;)g|=I.lanes|I.childLanes,x|=I.subtreeFlags,x|=I.flags,I.return=s,I=I.sibling;return s.subtreeFlags|=x,s.childLanes=g,h}function Vg(s,h,g){var x=h.pendingProps;switch(Sh(h),h.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ti(h),null;case 1:return Ti(h),null;case 3:return g=h.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),h.memoizedState.cache!==x&&(h.flags|=2048),ns(Bi),Cr(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(s===null||s.child===null)&&(Wl(h)?su(h):s===null||s.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,ti())),Ti(h),null;case 26:return g=h.memoizedState,s===null?(su(h),g!==null?(Ti(h),Fg(h,g)):(Ti(h),h.flags&=-16777217)):g?g!==s.memoizedState?(su(h),Ti(h),Fg(h,g)):(Ti(h),h.flags&=-16777217):(s.memoizedProps!==x&&su(h),Ti(h),h.flags&=-16777217),null;case 27:gi(h),g=gn.current;var I=h.type;if(s!==null&&h.stateNode!=null)s.memoizedProps!==x&&su(h);else{if(!x){if(h.stateNode===null)throw Error(a(166));return Ti(h),null}s=Qt.current,Wl(h)?Rc(h):(s=Sv(I,x,g),h.stateNode=s,su(h))}return Ti(h),null;case 5:if(gi(h),g=h.type,s!==null&&h.stateNode!=null)s.memoizedProps!==x&&su(h);else{if(!x){if(h.stateNode===null)throw Error(a(166));return Ti(h),null}if(s=Qt.current,Wl(h))Rc(h);else{switch(I=_p(gn.current),s){case 1:s=I.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:s=I.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":s=I.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":s=I.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":s=I.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?I.createElement("select",{is:x.is}):I.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?I.createElement(g,{is:x.is}):I.createElement(g)}}s[An]=h,s[vn]=x;e:for(I=h.child;I!==null;){if(I.tag===5||I.tag===6)s.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===h)break e;for(;I.sibling===null;){if(I.return===null||I.return===h)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}h.stateNode=s;e:switch(Br(s,g,x),g){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&su(h)}}return Ti(h),h.flags&=-16777217,null;case 6:if(s&&h.stateNode!=null)s.memoizedProps!==x&&su(h);else{if(typeof x!="string"&&h.stateNode===null)throw Error(a(166));if(s=gn.current,Wl(h)){if(s=h.stateNode,g=h.memoizedProps,x=null,I=pi,I!==null)switch(I.tag){case 27:case 5:x=I.memoizedProps}s[An]=h,s=!!(s.nodeValue===g||x!==null&&x.suppressHydrationWarning===!0||Kd(s.nodeValue,g)),s||Zl(h)}else s=_p(s).createTextNode(x),s[An]=h,h.stateNode=s}return Ti(h),null;case 13:if(x=h.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(I=Wl(h),x!==null&&x.dehydrated!==null){if(s===null){if(!I)throw Error(a(318));if(I=h.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(a(317));I[An]=h}else kc(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ti(h),I=!1}else I=ti(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=I),I=!0;if(!I)return h.flags&256?(To(h),h):(To(h),null)}if(To(h),(h.flags&128)!==0)return h.lanes=g,h;if(g=x!==null,s=s!==null&&s.memoizedState!==null,g){x=h.child,I=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(I=x.alternate.memoizedState.cachePool.pool);var L=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(L=x.memoizedState.cachePool.pool),L!==I&&(x.flags|=2048)}return g!==s&&g&&(h.child.flags|=8192),mm(h,h.updateQueue),Ti(h),null;case 4:return Cr(),s===null&&yy(h.stateNode.containerInfo),Ti(h),null;case 10:return ns(h.type),Ti(h),null;case 19:if(At(wi),I=h.memoizedState,I===null)return Ti(h),null;if(x=(h.flags&128)!==0,L=I.rendering,L===null)if(x)Jf(I,!1);else{if(Vi!==0||s!==null&&(s.flags&128)!==0)for(s=h.child;s!==null;){if(L=au(s),L!==null){for(h.flags|=128,Jf(I,!1),s=L.updateQueue,h.updateQueue=s,mm(h,s),h.subtreeFlags=0,s=g,g=h.child;g!==null;)Bf(g,s),g=g.sibling;return St(wi,wi.current&1|2),h.child}s=s.sibling}I.tail!==null&&Ir()>lp&&(h.flags|=128,x=!0,Jf(I,!1),h.lanes=4194304)}else{if(!x)if(s=au(L),s!==null){if(h.flags|=128,x=!0,s=s.updateQueue,h.updateQueue=s,mm(h,s),Jf(I,!0),I.tail===null&&I.tailMode==="hidden"&&!L.alternate&&!or)return Ti(h),null}else 2*Ir()-I.renderingStartTime>lp&&g!==536870912&&(h.flags|=128,x=!0,Jf(I,!1),h.lanes=4194304);I.isBackwards?(L.sibling=h.child,h.child=L):(s=I.last,s!==null?s.sibling=L:h.child=L,I.last=L)}return I.tail!==null?(h=I.tail,I.rendering=h,I.tail=h.sibling,I.renderingStartTime=Ir(),h.sibling=null,s=wi.current,St(wi,x?s&1|2:s&1),h):(Ti(h),null);case 22:case 23:return To(h),Lr(),x=h.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(h.flags|=8192):x&&(h.flags|=8192),x?(g&536870912)!==0&&(h.flags&128)===0&&(Ti(h),h.subtreeFlags&6&&(h.flags|=8192)):Ti(h),g=h.updateQueue,g!==null&&mm(h,g.retryQueue),g=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(g=s.memoizedState.cachePool.pool),x=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==g&&(h.flags|=2048),s!==null&&At(bi),null;case 24:return g=null,s!==null&&(g=s.memoizedState.cache),h.memoizedState.cache!==g&&(h.flags|=2048),ns(Bi),Ti(h),null;case 25:return null;case 30:return null}throw Error(a(156,h.tag))}function jg(s,h){switch(Sh(h),h.tag){case 1:return s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 3:return ns(Bi),Cr(),s=h.flags,(s&65536)!==0&&(s&128)===0?(h.flags=s&-65537|128,h):null;case 26:case 27:case 5:return gi(h),null;case 13:if(To(h),s=h.memoizedState,s!==null&&s.dehydrated!==null){if(h.alternate===null)throw Error(a(340));kc()}return s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 19:return At(wi),null;case 4:return Cr(),null;case 10:return ns(h.type),null;case 22:case 23:return To(h),Lr(),s!==null&&At(bi),s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 24:return ns(Bi),null;case 25:return null;default:return null}}function Ug(s,h){switch(Sh(h),h.tag){case 3:ns(Bi),Cr();break;case 26:case 27:case 5:gi(h);break;case 4:Cr();break;case 13:To(h);break;case 19:At(wi);break;case 10:ns(h.type);break;case 22:case 23:To(h),Lr(),s!==null&&At(bi);break;case 24:ns(Bi)}}function wl(s,h){try{var g=h.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var I=x.next;g=I;do{if((g.tag&s)===s){x=void 0;var L=g.create,Q=g.inst;x=L(),Q.destroy=x}g=g.next}while(g!==I)}}catch(ae){Nr(h,h.return,ae)}}function Ko(s,h,g){try{var x=h.updateQueue,I=x!==null?x.lastEffect:null;if(I!==null){var L=I.next;x=L;do{if((x.tag&s)===s){var Q=x.inst,ae=Q.destroy;if(ae!==void 0){Q.destroy=void 0,I=h;var De=g,at=ae;try{at()}catch(vt){Nr(I,De,vt)}}}x=x.next}while(x!==L)}}catch(vt){Nr(h,h.return,vt)}}function ev(s){var h=s.updateQueue;if(h!==null){var g=s.stateNode;try{Gf(h,g)}catch(x){Nr(s,s.return,x)}}}function tv(s,h,g){g.props=Lh(s.type,s.memoizedProps),g.state=s.memoizedState;try{g.componentWillUnmount()}catch(x){Nr(s,h,x)}}function ep(s,h){try{var g=s.ref;if(g!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof g=="function"?s.refCleanup=g(x):g.current=x}}catch(I){Nr(s,h,I)}}function ou(s,h){var g=s.ref,x=s.refCleanup;if(g!==null)if(typeof x=="function")try{x()}catch(I){Nr(s,h,I)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(I){Nr(s,h,I)}else g.current=null}function nv(s){var h=s.type,g=s.memoizedProps,x=s.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":g.autoFocus&&x.focus();break e;case"img":g.src?x.src=g.src:g.srcSet&&(x.srcset=g.srcSet)}}catch(I){Nr(s,s.return,I)}}function qg(s,h,g){try{var x=s.stateNode;Xd(x,s.type,g,h),x[vn]=h}catch(I){Nr(s,s.return,I)}}function rv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Zc(s.type)||s.tag===4}function tp(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||rv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Zc(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function $g(s,h,g){var x=s.tag;if(x===5||x===6)s=s.stateNode,h?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(s,h):(h=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,h.appendChild(s),g=g._reactRootContainer,g!=null||h.onclick!==null||(h.onclick=yp));else if(x!==4&&(x===27&&Zc(s.type)&&(g=s.stateNode,h=null),s=s.child,s!==null))for($g(s,h,g),s=s.sibling;s!==null;)$g(s,h,g),s=s.sibling}function np(s,h,g){var x=s.tag;if(x===5||x===6)s=s.stateNode,h?g.insertBefore(s,h):g.appendChild(s);else if(x!==4&&(x===27&&Zc(s.type)&&(g=s.stateNode),s=s.child,s!==null))for(np(s,h,g),s=s.sibling;s!==null;)np(s,h,g),s=s.sibling}function Od(s){var h=s.stateNode,g=s.memoizedProps;try{for(var x=s.type,I=h.attributes;I.length;)h.removeAttributeNode(I[0]);Br(h,x,g),h[An]=s,h[vn]=g}catch(L){Nr(s,s.return,L)}}var Yu=!1,Fn=!1,Vc=!1,Gg=typeof WeakSet=="function"?WeakSet:Set,Yi=null;function gm(s,h){if(s=s.containerInfo,ac=yt,s=bh(s),mo(s)){if("selectionStart"in s)var g={start:s.selectionStart,end:s.selectionEnd};else e:{g=(g=s.ownerDocument)&&g.defaultView||window;var x=g.getSelection&&g.getSelection();if(x&&x.rangeCount!==0){g=x.anchorNode;var I=x.anchorOffset,L=x.focusNode;x=x.focusOffset;try{g.nodeType,L.nodeType}catch{g=null;break e}var Q=0,ae=-1,De=-1,at=0,vt=0,Et=s,ct=null;t:for(;;){for(var dt;Et!==g||I!==0&&Et.nodeType!==3||(ae=Q+I),Et!==L||x!==0&&Et.nodeType!==3||(De=Q+x),Et.nodeType===3&&(Q+=Et.nodeValue.length),(dt=Et.firstChild)!==null;)ct=Et,Et=dt;for(;;){if(Et===s)break t;if(ct===g&&++at===I&&(ae=Q),ct===L&&++vt===x&&(De=Q),(dt=Et.nextSibling)!==null)break;Et=ct,ct=Et.parentNode}Et=dt}g=ae===-1||De===-1?null:{start:ae,end:De}}else g=null}g=g||{start:0,end:0}}else g=null;for(km={focusedElem:s,selectionRange:g},yt=!1,Yi=h;Yi!==null;)if(h=Yi,s=h.child,(h.subtreeFlags&1024)!==0&&s!==null)s.return=h,Yi=s;else for(;Yi!==null;){switch(h=Yi,L=h.alternate,s=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&L!==null){s=void 0,g=h,I=L.memoizedProps,L=L.memoizedState,x=g.stateNode;try{var fn=Lh(g.type,I,g.elementType===g.type);s=x.getSnapshotBeforeUpdate(fn,L),x.__reactInternalSnapshotBeforeUpdate=s}catch(bn){Nr(g,g.return,bn)}}break;case 3:if((s&1024)!==0){if(s=h.stateNode.containerInfo,g=s.nodeType,g===9)Lm(s);else if(g===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Lm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=h.sibling,s!==null){s.return=h.return,Yi=s;break}Yi=h.return}}function Nd(s,h,g){var x=g.flags;switch(g.tag){case 0:case 11:case 15:Yo(s,g),x&4&&wl(5,g);break;case 1:if(Yo(s,g),x&4)if(s=g.stateNode,h===null)try{s.componentDidMount()}catch(Q){Nr(g,g.return,Q)}else{var I=Lh(g.type,h.memoizedProps);h=h.memoizedState;try{s.componentDidUpdate(I,h,s.__reactInternalSnapshotBeforeUpdate)}catch(Q){Nr(g,g.return,Q)}}x&64&&ev(g),x&512&&ep(g,g.return);break;case 3:if(Yo(s,g),x&64&&(s=g.updateQueue,s!==null)){if(h=null,g.child!==null)switch(g.child.tag){case 27:case 5:h=g.child.stateNode;break;case 1:h=g.child.stateNode}try{Gf(s,h)}catch(Q){Nr(g,g.return,Q)}}break;case 27:h===null&&x&4&&Od(g);case 26:case 5:Yo(s,g),h===null&&x&4&&nv(g),x&512&&ep(g,g.return);break;case 12:Yo(s,g);break;case 13:Yo(s,g),x&4&&rp(s,g),x&64&&(s=g.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(g=kb.bind(null,g),Om(s,g))));break;case 22:if(x=g.memoizedState!==null||Yu,!x){h=h!==null&&h.memoizedState!==null||Fn,I=Yu;var L=Fn;Yu=x,(Fn=h)&&!L?Ju(s,g,(g.subtreeFlags&8772)!==0):Yo(s,g),Yu=I,Fn=L}break;case 30:break;default:Yo(s,g)}}function Hg(s){var h=s.alternate;h!==null&&(s.alternate=null,Hg(h)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(h=s.stateNode,h!==null&&cr(h)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var li=null,Pa=!1;function Tl(s,h,g){for(g=g.child;g!==null;)Oh(s,h,g),g=g.sibling}function Oh(s,h,g){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(fr,g)}catch{}switch(g.tag){case 26:Fn||ou(g,h),Tl(s,h,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:Fn||ou(g,h);var x=li,I=Pa;Zc(g.type)&&(li=g.stateNode,Pa=!1),Tl(s,h,g),du(g.stateNode),li=x,Pa=I;break;case 5:Fn||ou(g,h);case 6:if(x=li,I=Pa,li=null,Tl(s,h,g),li=x,Pa=I,li!==null)if(Pa)try{(li.nodeType===9?li.body:li.nodeName==="HTML"?li.ownerDocument.body:li).removeChild(g.stateNode)}catch(L){Nr(g,h,L)}else try{li.removeChild(g.stateNode)}catch(L){Nr(g,h,L)}break;case 18:li!==null&&(Pa?(s=li,Ay(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,g.stateNode),hi(s)):Ay(li,g.stateNode));break;case 4:x=li,I=Pa,li=g.stateNode.containerInfo,Pa=!0,Tl(s,h,g),li=x,Pa=I;break;case 0:case 11:case 14:case 15:Fn||Ko(2,g,h),Fn||Ko(4,g,h),Tl(s,h,g);break;case 1:Fn||(ou(g,h),x=g.stateNode,typeof x.componentWillUnmount=="function"&&tv(g,h,x)),Tl(s,h,g);break;case 21:Tl(s,h,g);break;case 22:Fn=(x=Fn)||g.memoizedState!==null,Tl(s,h,g),Fn=x;break;default:Tl(s,h,g)}}function rp(s,h){if(h.memoizedState===null&&(s=h.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{hi(s)}catch(g){Nr(h,h.return,g)}}function Bd(s){switch(s.tag){case 13:case 19:var h=s.stateNode;return h===null&&(h=s.stateNode=new Gg),h;case 22:return s=s.stateNode,h=s._retryCache,h===null&&(h=s._retryCache=new Gg),h;default:throw Error(a(435,s.tag))}}function Nh(s,h){var g=Bd(s);h.forEach(function(x){var I=Db.bind(null,s,x);g.has(x)||(g.add(x),x.then(I,I))})}function So(s,h){var g=h.deletions;if(g!==null)for(var x=0;x<g.length;x++){var I=g[x],L=s,Q=h,ae=Q;e:for(;ae!==null;){switch(ae.tag){case 27:if(Zc(ae.type)){li=ae.stateNode,Pa=!1;break e}break;case 5:li=ae.stateNode,Pa=!1;break e;case 3:case 4:li=ae.stateNode.containerInfo,Pa=!0;break e}ae=ae.return}if(li===null)throw Error(a(160));Oh(L,Q,I),li=null,Pa=!1,L=I.alternate,L!==null&&(L.return=null),I.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)jc(h,s),h=h.sibling}var Xo=null;function jc(s,h){var g=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:So(h,s),Eo(s),x&4&&(Ko(3,s,s.return),wl(3,s),Ko(5,s,s.return));break;case 1:So(h,s),Eo(s),x&512&&(Fn||g===null||ou(g,g.return)),x&64&&Yu&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(g=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=g===null?x:g.concat(x))));break;case 26:var I=Xo;if(So(h,s),Eo(s),x&512&&(Fn||g===null||ou(g,g.return)),x&4){var L=g!==null?g.memoizedState:null;if(x=s.memoizedState,g===null)if(x===null)if(s.stateNode===null){e:{x=s.type,g=s.memoizedProps,I=I.ownerDocument||I;t:switch(x){case"title":L=I.getElementsByTagName("title")[0],(!L||L[ai]||L[An]||L.namespaceURI==="http://www.w3.org/2000/svg"||L.hasAttribute("itemprop"))&&(L=I.createElement(x),I.head.insertBefore(L,I.querySelector("head > title"))),Br(L,x,g),L[An]=s,nn(L),x=L;break e;case"link":var Q=v("link","href",I).get(x+(g.href||""));if(Q){for(var ae=0;ae<Q.length;ae++)if(L=Q[ae],L.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&L.getAttribute("rel")===(g.rel==null?null:g.rel)&&L.getAttribute("title")===(g.title==null?null:g.title)&&L.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){Q.splice(ae,1);break t}}L=I.createElement(x),Br(L,x,g),I.head.appendChild(L);break;case"meta":if(Q=v("meta","content",I).get(x+(g.content||""))){for(ae=0;ae<Q.length;ae++)if(L=Q[ae],L.getAttribute("content")===(g.content==null?null:""+g.content)&&L.getAttribute("name")===(g.name==null?null:g.name)&&L.getAttribute("property")===(g.property==null?null:g.property)&&L.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&L.getAttribute("charset")===(g.charSet==null?null:g.charSet)){Q.splice(ae,1);break t}}L=I.createElement(x),Br(L,x,g),I.head.appendChild(L);break;default:throw Error(a(468,x))}L[An]=s,nn(L),x=L}s.stateNode=x}else T(I,s.type,s.stateNode);else s.stateNode=Cv(I,x,s.memoizedProps);else L!==x?(L===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):L.count--,x===null?T(I,s.type,s.stateNode):Cv(I,x,s.memoizedProps)):x===null&&s.stateNode!==null&&qg(s,s.memoizedProps,g.memoizedProps)}break;case 27:So(h,s),Eo(s),x&512&&(Fn||g===null||ou(g,g.return)),g!==null&&x&4&&qg(s,s.memoizedProps,g.memoizedProps);break;case 5:if(So(h,s),Eo(s),x&512&&(Fn||g===null||ou(g,g.return)),s.flags&32){I=s.stateNode;try{Na(I,"")}catch(dt){Nr(s,s.return,dt)}}x&4&&s.stateNode!=null&&(I=s.memoizedProps,qg(s,I,g!==null?g.memoizedProps:I)),x&1024&&(Vc=!0);break;case 6:if(So(h,s),Eo(s),x&4){if(s.stateNode===null)throw Error(a(162));x=s.memoizedProps,g=s.stateNode;try{g.nodeValue=x}catch(dt){Nr(s,s.return,dt)}}break;case 3:if(f=null,I=Xo,Xo=vp(h.containerInfo),So(h,s),Xo=I,Eo(s),x&4&&g!==null&&g.memoizedState.isDehydrated)try{hi(h.containerInfo)}catch(dt){Nr(s,s.return,dt)}Vc&&(Vc=!1,Zg(s));break;case 4:x=Xo,Xo=vp(s.stateNode.containerInfo),So(h,s),Eo(s),Xo=x;break;case 12:So(h,s),Eo(s);break;case 13:So(h,s),Eo(s),s.child.flags&8192&&s.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Qg=Ir()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Nh(s,x)));break;case 22:I=s.memoizedState!==null;var De=g!==null&&g.memoizedState!==null,at=Yu,vt=Fn;if(Yu=at||I,Fn=vt||De,So(h,s),Fn=vt,Yu=at,Eo(s),x&8192)e:for(h=s.stateNode,h._visibility=I?h._visibility&-2:h._visibility|1,I&&(g===null||De||Yu||Fn||Qu(s)),g=null,h=s;;){if(h.tag===5||h.tag===26){if(g===null){De=g=h;try{if(L=De.stateNode,I)Q=L.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none";else{ae=De.stateNode;var Et=De.memoizedProps.style,ct=Et!=null&&Et.hasOwnProperty("display")?Et.display:null;ae.style.display=ct==null||typeof ct=="boolean"?"":(""+ct).trim()}}catch(dt){Nr(De,De.return,dt)}}}else if(h.tag===6){if(g===null){De=h;try{De.stateNode.nodeValue=I?"":De.memoizedProps}catch(dt){Nr(De,De.return,dt)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===s)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===s)break e;for(;h.sibling===null;){if(h.return===null||h.return===s)break e;g===h&&(g=null),h=h.return}g===h&&(g=null),h.sibling.return=h.return,h=h.sibling}x&4&&(x=s.updateQueue,x!==null&&(g=x.retryQueue,g!==null&&(x.retryQueue=null,Nh(s,g))));break;case 19:So(h,s),Eo(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Nh(s,x)));break;case 30:break;case 21:break;default:So(h,s),Eo(s)}}function Eo(s){var h=s.flags;if(h&2){try{for(var g,x=s.return;x!==null;){if(rv(x)){g=x;break}x=x.return}if(g==null)throw Error(a(160));switch(g.tag){case 27:var I=g.stateNode,L=tp(s);np(s,L,I);break;case 5:var Q=g.stateNode;g.flags&32&&(Na(Q,""),g.flags&=-33);var ae=tp(s);np(s,ae,Q);break;case 3:case 4:var De=g.stateNode.containerInfo,at=tp(s);$g(s,at,De);break;default:throw Error(a(161))}}catch(vt){Nr(s,s.return,vt)}s.flags&=-3}h&4096&&(s.flags&=-4097)}function Zg(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var h=s;Zg(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),s=s.sibling}}function Yo(s,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)Nd(s,h.alternate,h),h=h.sibling}function Qu(s){for(s=s.child;s!==null;){var h=s;switch(h.tag){case 0:case 11:case 14:case 15:Ko(4,h,h.return),Qu(h);break;case 1:ou(h,h.return);var g=h.stateNode;typeof g.componentWillUnmount=="function"&&tv(h,h.return,g),Qu(h);break;case 27:du(h.stateNode);case 26:case 5:ou(h,h.return),Qu(h);break;case 22:h.memoizedState===null&&Qu(h);break;case 30:Qu(h);break;default:Qu(h)}s=s.sibling}}function Ju(s,h,g){for(g=g&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var x=h.alternate,I=s,L=h,Q=L.flags;switch(L.tag){case 0:case 11:case 15:Ju(I,L,g),wl(4,L);break;case 1:if(Ju(I,L,g),x=L,I=x.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(at){Nr(x,x.return,at)}if(x=L,I=x.updateQueue,I!==null){var ae=x.stateNode;try{var De=I.shared.hiddenCallbacks;if(De!==null)for(I.shared.hiddenCallbacks=null,I=0;I<De.length;I++)Id(De[I],ae)}catch(at){Nr(x,x.return,at)}}g&&Q&64&&ev(L),ep(L,L.return);break;case 27:Od(L);case 26:case 5:Ju(I,L,g),g&&x===null&&Q&4&&nv(L),ep(L,L.return);break;case 12:Ju(I,L,g);break;case 13:Ju(I,L,g),g&&Q&4&&rp(I,L);break;case 22:L.memoizedState===null&&Ju(I,L,g),ep(L,L.return);break;case 30:break;default:Ju(I,L,g)}h=h.sibling}}function ym(s,h){var g=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(g=s.memoizedState.cachePool.pool),s=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(s=h.memoizedState.cachePool.pool),s!==g&&(s!=null&&s.refCount++,g!=null&&Vu(g))}function Wg(s,h){s=null,h.alternate!==null&&(s=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==s&&(h.refCount++,s!=null&&Vu(s))}function lu(s,h,g,x){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)iv(s,h,g,x),h=h.sibling}function iv(s,h,g,x){var I=h.flags;switch(h.tag){case 0:case 11:case 15:lu(s,h,g,x),I&2048&&wl(9,h);break;case 1:lu(s,h,g,x);break;case 3:lu(s,h,g,x),I&2048&&(s=null,h.alternate!==null&&(s=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==s&&(h.refCount++,s!=null&&Vu(s)));break;case 12:if(I&2048){lu(s,h,g,x),s=h.stateNode;try{var L=h.memoizedProps,Q=L.id,ae=L.onPostCommit;typeof ae=="function"&&ae(Q,h.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(De){Nr(h,h.return,De)}}else lu(s,h,g,x);break;case 13:lu(s,h,g,x);break;case 23:break;case 22:L=h.stateNode,Q=h.alternate,h.memoizedState!==null?L._visibility&2?lu(s,h,g,x):ip(s,h):L._visibility&2?lu(s,h,g,x):(L._visibility|=2,Fd(s,h,g,x,(h.subtreeFlags&10256)!==0)),I&2048&&ym(Q,h);break;case 24:lu(s,h,g,x),I&2048&&Wg(h.alternate,h);break;default:lu(s,h,g,x)}}function Fd(s,h,g,x,I){for(I=I&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var L=s,Q=h,ae=g,De=x,at=Q.flags;switch(Q.tag){case 0:case 11:case 15:Fd(L,Q,ae,De,I),wl(8,Q);break;case 23:break;case 22:var vt=Q.stateNode;Q.memoizedState!==null?vt._visibility&2?Fd(L,Q,ae,De,I):ip(L,Q):(vt._visibility|=2,Fd(L,Q,ae,De,I)),I&&at&2048&&ym(Q.alternate,Q);break;case 24:Fd(L,Q,ae,De,I),I&&at&2048&&Wg(Q.alternate,Q);break;default:Fd(L,Q,ae,De,I)}h=h.sibling}}function ip(s,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var g=s,x=h,I=x.flags;switch(x.tag){case 22:ip(g,x),I&2048&&ym(x.alternate,x);break;case 24:ip(g,x),I&2048&&Wg(x.alternate,x);break;default:ip(g,x)}h=h.sibling}}var Bh=8192;function Fh(s){if(s.subtreeFlags&Bh)for(s=s.child;s!==null;)_m(s),s=s.sibling}function _m(s){switch(s.tag){case 26:Fh(s),s.flags&Bh&&s.memoizedState!==null&&N(Xo,s.memoizedState,s.memoizedProps);break;case 5:Fh(s);break;case 3:case 4:var h=Xo;Xo=vp(s.stateNode.containerInfo),Fh(s),Xo=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=Bh,Bh=16777216,Fh(s),Bh=h):Fh(s));break;default:Fh(s)}}function Kg(s){var h=s.alternate;if(h!==null&&(s=h.child,s!==null)){h.child=null;do h=s.sibling,s.sibling=null,s=h;while(s!==null)}}function Vh(s){var h=s.deletions;if((s.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var x=h[g];Yi=x,sp(x,s)}Kg(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Xg(s),s=s.sibling}function Xg(s){switch(s.tag){case 0:case 11:case 15:Vh(s),s.flags&2048&&Ko(9,s,s.return);break;case 3:Vh(s);break;case 12:Vh(s);break;case 22:var h=s.stateNode;s.memoizedState!==null&&h._visibility&2&&(s.return===null||s.return.tag!==13)?(h._visibility&=-3,ap(s)):Vh(s);break;default:Vh(s)}}function ap(s){var h=s.deletions;if((s.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var x=h[g];Yi=x,sp(x,s)}Kg(s)}for(s=s.child;s!==null;){switch(h=s,h.tag){case 0:case 11:case 15:Ko(8,h,h.return),ap(h);break;case 22:g=h.stateNode,g._visibility&2&&(g._visibility&=-3,ap(h));break;default:ap(h)}s=s.sibling}}function sp(s,h){for(;Yi!==null;){var g=Yi;switch(g.tag){case 0:case 11:case 15:Ko(8,g,h);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var x=g.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Vu(g.memoizedState.cache)}if(x=g.child,x!==null)x.return=g,Yi=x;else e:for(g=s;Yi!==null;){x=Yi;var I=x.sibling,L=x.return;if(Hg(x),x===g){Yi=null;break e}if(I!==null){I.return=L,Yi=I;break e}Yi=L}}}var av={getCacheForType:function(s){var h=vi(Bi),g=h.data.get(s);return g===void 0&&(g=s(),h.data.set(s,g)),g}},sv=typeof WeakMap=="function"?WeakMap:Map,Mr=0,Pr=null,Jn=null,rr=0,hr=0,Es=null,Uc=!1,Vd=!1,vm=!1,uu=0,Vi=0,qc=0,Sl=0,bm=0,Qo=0,jd=0,op=null,Ws=null,Yg=!1,Qg=0,lp=1/0,Ud=null,ec=null,Ra=0,tc=null,qd=null,nc=0,Jg=0,xm=null,ov=null,up=0,ey=null;function Ks(){if((Mr&2)!==0&&rr!==0)return rr&-rr;if(et.T!==null){var s=pl;return s!==0?s:Gc()}return jt()}function lv(){Qo===0&&(Qo=(rr&536870912)===0||or?tt():536870912);var s=Fi.current;return s!==null&&(s.flags|=32),Qo}function Ao(s,h,g){(s===Pr&&(hr===2||hr===9)||s.cancelPendingCommit!==null)&&(Gd(s,0),rc(s,rr,Qo,!1)),st(s,g),((Mr&2)===0||s!==Pr)&&(s===Pr&&((Mr&2)===0&&(Sl|=g),Vi===4&&rc(s,rr,Qo,!1)),el(s))}function $d(s,h,g){if((Mr&6)!==0)throw Error(a(327));var x=!g&&(h&124)===0&&(h&s.expiredLanes)===0||Oe(s,h),I=x?uv(s,h):ay(s,h,!0),L=x;do{if(I===0){Vd&&!x&&rc(s,h,0,!1);break}else{if(g=s.current.alternate,L&&!ny(g)){I=ay(s,h,!1),L=!1;continue}if(I===2){if(L=h,s.errorRecoveryDisabledLanes&L)var Q=0;else Q=s.pendingLanes&-536870913,Q=Q!==0?Q:Q&536870912?536870912:0;if(Q!==0){h=Q;e:{var ae=s;I=op;var De=ae.current.memoizedState.isDehydrated;if(De&&(Gd(ae,Q).flags|=256),Q=ay(ae,Q,!1),Q!==2){if(vm&&!De){ae.errorRecoveryDisabledLanes|=L,Sl|=L,I=4;break e}L=Ws,Ws=I,L!==null&&(Ws===null?Ws=L:Ws.push.apply(Ws,L))}I=Q}if(L=!1,I!==2)continue}}if(I===1){Gd(s,0),rc(s,h,0,!0);break}e:{switch(x=s,L=I,L){case 0:case 1:throw Error(a(345));case 4:if((h&4194048)!==h)break;case 6:rc(x,h,Qo,!Uc);break e;case 2:Ws=null;break;case 3:case 5:break;default:throw Error(a(329))}if((h&62914560)===h&&(I=Qg+300-Ir(),10<I)){if(rc(x,h,Qo,!Uc),Te(x,0,!0)!==0)break e;x.timeoutHandle=Sy(ty.bind(null,x,g,Ws,Ud,Yg,h,Qo,Sl,jd,Uc,L,2,-0,0),I);break e}ty(x,g,Ws,Ud,Yg,h,Qo,Sl,jd,Uc,L,0,-0,0)}}break}while(!0);el(s)}function ty(s,h,g,x,I,L,Q,ae,De,at,vt,Et,ct,dt){if(s.timeoutHandle=-1,Et=h.subtreeFlags,(Et&8192||(Et&16785408)===16785408)&&(k={stylesheets:null,count:0,unsuspend:z},_m(h),Et=j(),Et!==null)){s.cancelPendingCommit=Et(cv.bind(null,s,h,L,g,x,I,Q,ae,De,vt,1,ct,dt)),rc(s,L,Q,!at);return}cv(s,h,L,g,x,I,Q,ae,De)}function ny(s){for(var h=s;;){var g=h.tag;if((g===0||g===11||g===15)&&h.flags&16384&&(g=h.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var x=0;x<g.length;x++){var I=g[x],L=I.getSnapshot;I=I.value;try{if(!es(L(),I))return!1}catch{return!1}}if(g=h.child,h.subtreeFlags&16384&&g!==null)g.return=h,h=g;else{if(h===s)break;for(;h.sibling===null;){if(h.return===null||h.return===s)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function rc(s,h,g,x){h&=~bm,h&=~Sl,s.suspendedLanes|=h,s.pingedLanes&=~h,x&&(s.warmLanes|=h),x=s.expirationTimes;for(var I=h;0<I;){var L=31-Ri(I),Q=1<<L;x[L]=-1,I&=~Q}g!==0&&mt(s,g,h)}function Si(){return(Mr&6)===0?(fp(0),!1):!0}function cp(){if(Jn!==null){if(hr===0)var s=Jn.return;else s=Jn,bs=qo=null,Yr(s),Or=null,vr=0,s=Jn;for(;s!==null;)Ug(s.alternate,s),s=s.return;Jn=null}}function Gd(s,h){var g=s.timeoutHandle;g!==-1&&(s.timeoutHandle=-1,bv(g)),g=s.cancelPendingCommit,g!==null&&(s.cancelPendingCommit=null,g()),cp(),Pr=s,Jn=g=ja(s.current,null),rr=h,hr=0,Es=null,Uc=!1,Vd=Oe(s,h),vm=!1,jd=Qo=bm=Sl=qc=Vi=0,Ws=op=null,Yg=!1,(h&8)!==0&&(h|=h&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=h;0<x;){var I=31-Ri(x),L=1<<I;h|=s[I],x&=~L}return uu=h,Mu(),g}function ry(s,h){Nn=null,et.H=ma,h===Mh||h===Jl?(h=Cd(),hr=3):h===Ed?(h=Cd(),hr=4):hr=h===zh?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,Es=h,Jn===null&&(Vi=1,sm(s,ys(h,s.current)))}function ic(){var s=et.H;return et.H=ma,s===null?ma:s}function wm(){var s=et.A;return et.A=av,s}function iy(){Vi=4,Uc||(rr&4194048)!==rr&&Fi.current!==null||(Vd=!0),(qc&134217727)===0&&(Sl&134217727)===0||Pr===null||rc(Pr,rr,Qo,!1)}function ay(s,h,g){var x=Mr;Mr|=2;var I=ic(),L=wm();(Pr!==s||rr!==h)&&(Ud=null,Gd(s,h)),h=!1;var Q=Vi;e:do try{if(hr!==0&&Jn!==null){var ae=Jn,De=Es;switch(hr){case 8:cp(),Q=6;break e;case 3:case 2:case 9:case 6:Fi.current===null&&(h=!0);var at=hr;if(hr=0,Es=null,El(s,ae,De,at),g&&Vd){Q=0;break e}break;default:at=hr,hr=0,Es=null,El(s,ae,De,at)}}Rb(),Q=Vi;break}catch(vt){ry(s,vt)}while(!0);return h&&s.shellSuspendCounter++,bs=qo=null,Mr=x,et.H=I,et.A=L,Jn===null&&(Pr=null,rr=0,Mu()),Q}function Rb(){for(;Jn!==null;)oy(Jn)}function uv(s,h){var g=Mr;Mr|=2;var x=ic(),I=wm();Pr!==s||rr!==h?(Ud=null,lp=Ir()+500,Gd(s,h)):Vd=Oe(s,h);e:do try{if(hr!==0&&Jn!==null){h=Jn;var L=Es;t:switch(hr){case 1:hr=0,Es=null,El(s,h,L,1);break;case 2:case 9:if(wo(L)){hr=0,Es=null,Hd(h);break}h=function(){hr!==2&&hr!==9||Pr!==s||(hr=7),el(s)},L.then(h,h);break e;case 3:hr=7;break e;case 4:hr=5;break e;case 7:wo(L)?(hr=0,Es=null,Hd(h)):(hr=0,Es=null,El(s,h,L,7));break;case 5:var Q=null;switch(Jn.tag){case 26:Q=Jn.memoizedState;case 5:case 27:var ae=Jn;if(!Q||C(Q)){hr=0,Es=null;var De=ae.sibling;if(De!==null)Jn=De;else{var at=ae.return;at!==null?(Jn=at,jh(at)):Jn=null}break t}}hr=0,Es=null,El(s,h,L,5);break;case 6:hr=0,Es=null,El(s,h,L,6);break;case 8:cp(),Vi=6;break e;default:throw Error(a(462))}}sy();break}catch(vt){ry(s,vt)}while(!0);return bs=qo=null,et.H=x,et.A=I,Mr=g,Jn!==null?0:(Pr=null,rr=0,Mu(),Vi)}function sy(){for(;Jn!==null&&!_a();)oy(Jn)}function oy(s){var h=pm(s.alternate,s,uu);s.memoizedProps=s.pendingProps,h===null?jh(s):Jn=h}function Hd(s){var h=s,g=h.alternate;switch(h.tag){case 15:case 0:h=Ng(g,h,h.pendingProps,h.type,void 0,rr);break;case 11:h=Ng(g,h,h.pendingProps,h.type.render,h.ref,rr);break;case 5:Yr(h);default:Ug(g,h),h=Jn=Bf(h,uu),h=pm(g,h,uu)}s.memoizedProps=s.pendingProps,h===null?jh(s):Jn=h}function El(s,h,g,x){bs=qo=null,Yr(h),Or=null,vr=0;var I=h.return;try{if(K_(s,I,h,g,rr)){Vi=1,sm(s,ys(g,s.current)),Jn=null;return}}catch(L){if(I!==null)throw Jn=I,L;Vi=1,sm(s,ys(g,s.current)),Jn=null;return}h.flags&32768?(or||x===1?s=!0:Vd||(rr&536870912)!==0?s=!1:(Uc=s=!0,(x===2||x===9||x===3||x===6)&&(x=Fi.current,x!==null&&x.tag===13&&(x.flags|=16384))),hp(h,s)):jh(h)}function jh(s){var h=s;do{if((h.flags&32768)!==0){hp(h,Uc);return}s=h.return;var g=Vg(h.alternate,h,uu);if(g!==null){Jn=g;return}if(h=h.sibling,h!==null){Jn=h;return}Jn=h=s}while(h!==null);Vi===0&&(Vi=5)}function hp(s,h){do{var g=jg(s.alternate,s);if(g!==null){g.flags&=32767,Jn=g;return}if(g=s.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!h&&(s=s.sibling,s!==null)){Jn=s;return}Jn=s=g}while(s!==null);Vi=6,Jn=null}function cv(s,h,g,x,I,L,Q,ae,De){s.cancelPendingCommit=null;do dp();while(Ra!==0);if((Mr&6)!==0)throw Error(a(327));if(h!==null){if(h===s.current)throw Error(a(177));if(L=h.lanes|h.childLanes,L|=hl,Ke(s,g,L,Q,ae,De),s===Pr&&(Jn=Pr=null,rr=0),qd=h,tc=s,nc=g,Jg=L,xm=I,ov=x,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Lb(Xa,function(){return cy(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||x){x=et.T,et.T=null,I=Mt.p,Mt.p=2,Q=Mr,Mr|=4;try{gm(s,h,g)}finally{Mr=Q,Mt.p=I,et.T=x}}Ra=1,hv(),ly(),uy()}}function hv(){if(Ra===1){Ra=0;var s=tc,h=qd,g=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||g){g=et.T,et.T=null;var x=Mt.p;Mt.p=2;var I=Mr;Mr|=4;try{jc(h,s);var L=km,Q=bh(s.containerInfo),ae=L.focusedElem,De=L.selectionRange;if(Q!==ae&&ae&&ae.ownerDocument&&nr(ae.ownerDocument.documentElement,ae)){if(De!==null&&mo(ae)){var at=De.start,vt=De.end;if(vt===void 0&&(vt=at),"selectionStart"in ae)ae.selectionStart=at,ae.selectionEnd=Math.min(vt,ae.value.length);else{var Et=ae.ownerDocument||document,ct=Et&&Et.defaultView||window;if(ct.getSelection){var dt=ct.getSelection(),fn=ae.textContent.length,bn=Math.min(De.start,fn),jr=De.end===void 0?bn:Math.min(De.end,fn);!dt.extend&&bn>jr&&(Q=jr,jr=bn,bn=Q);var Xe=yd(ae,bn),qe=yd(ae,jr);if(Xe&&qe&&(dt.rangeCount!==1||dt.anchorNode!==Xe.node||dt.anchorOffset!==Xe.offset||dt.focusNode!==qe.node||dt.focusOffset!==qe.offset)){var it=Et.createRange();it.setStart(Xe.node,Xe.offset),dt.removeAllRanges(),bn>jr?(dt.addRange(it),dt.extend(qe.node,qe.offset)):(it.setEnd(qe.node,qe.offset),dt.addRange(it))}}}}for(Et=[],dt=ae;dt=dt.parentNode;)dt.nodeType===1&&Et.push({element:dt,left:dt.scrollLeft,top:dt.scrollTop});for(typeof ae.focus=="function"&&ae.focus(),ae=0;ae<Et.length;ae++){var wt=Et[ae];wt.element.scrollLeft=wt.left,wt.element.scrollTop=wt.top}}yt=!!ac,km=ac=null}finally{Mr=I,Mt.p=x,et.T=g}}s.current=h,Ra=2}}function ly(){if(Ra===2){Ra=0;var s=tc,h=qd,g=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||g){g=et.T,et.T=null;var x=Mt.p;Mt.p=2;var I=Mr;Mr|=4;try{Nd(s,h.alternate,h)}finally{Mr=I,Mt.p=x,et.T=g}}Ra=3}}function uy(){if(Ra===4||Ra===3){Ra=0,rl();var s=tc,h=qd,g=nc,x=ov;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Ra=5:(Ra=0,qd=tc=null,dv(s,s.pendingLanes));var I=s.pendingLanes;if(I===0&&(ec=null),on(g),h=h.stateNode,Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(fr,h,void 0,(h.current.flags&128)===128)}catch{}if(x!==null){h=et.T,I=Mt.p,Mt.p=2,et.T=null;try{for(var L=s.onRecoverableError,Q=0;Q<x.length;Q++){var ae=x[Q];L(ae.value,{componentStack:ae.stack})}}finally{et.T=h,Mt.p=I}}(nc&3)!==0&&dp(),el(s),I=s.pendingLanes,(g&4194090)!==0&&(I&42)!==0?s===ey?up++:(up=0,ey=s):up=0,fp(0)}}function dv(s,h){(s.pooledCacheLanes&=h)===0&&(h=s.pooledCache,h!=null&&(s.pooledCache=null,Vu(h)))}function dp(s){return hv(),ly(),uy(),cy()}function cy(){if(Ra!==5)return!1;var s=tc,h=Jg;Jg=0;var g=on(nc),x=et.T,I=Mt.p;try{Mt.p=32>g?32:g,et.T=null,g=xm,xm=null;var L=tc,Q=nc;if(Ra=0,qd=tc=null,nc=0,(Mr&6)!==0)throw Error(a(331));var ae=Mr;if(Mr|=4,Xg(L.current),iv(L,L.current,Q,g),Mr=ae,fp(0,!1),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(fr,L)}catch{}return!0}finally{Mt.p=I,et.T=x,dv(s,h)}}function Tm(s,h,g){h=ys(g,h),h=Dg(s.stateNode,h,2),s=yl(s,h,2),s!==null&&(st(s,2),el(s))}function Nr(s,h,g){if(s.tag===3)Tm(s,s,g);else for(;h!==null;){if(h.tag===3){Tm(h,s,g);break}else if(h.tag===1){var x=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(ec===null||!ec.has(x))){s=ys(g,s),g=lm(2),x=yl(h,g,2),x!==null&&(Lg(g,x,h,s),st(x,2),el(x));break}}h=h.return}}function hy(s,h,g){var x=s.pingCache;if(x===null){x=s.pingCache=new sv;var I=new Set;x.set(h,I)}else I=x.get(h),I===void 0&&(I=new Set,x.set(h,I));I.has(g)||(vm=!0,I.add(g),s=fv.bind(null,s,h,g),h.then(s,s))}function fv(s,h,g){var x=s.pingCache;x!==null&&x.delete(h),s.pingedLanes|=s.suspendedLanes&g,s.warmLanes&=~g,Pr===s&&(rr&g)===g&&(Vi===4||Vi===3&&(rr&62914560)===rr&&300>Ir()-Qg?(Mr&2)===0&&Gd(s,0):bm|=g,jd===rr&&(jd=0)),el(s)}function pv(s,h){h===0&&(h=je()),s=go(s,h),s!==null&&(st(s,h),el(s))}function kb(s){var h=s.memoizedState,g=0;h!==null&&(g=h.retryLane),pv(s,g)}function Db(s,h){var g=0;switch(s.tag){case 13:var x=s.stateNode,I=s.memoizedState;I!==null&&(g=I.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(a(314))}x!==null&&x.delete(h),pv(s,g)}function Lb(s,h){return Tr(s,h)}var Sm=null,Uh=null,Em=!1,Jo=!1,cu=!1,$c=0;function el(s){s!==Uh&&s.next===null&&(Uh===null?Sm=Uh=s:Uh=Uh.next=s),Jo=!0,Em||(Em=!0,dy())}function fp(s,h){if(!cu&&Jo){cu=!0;do for(var g=!1,x=Sm;x!==null;){if(s!==0){var I=x.pendingLanes;if(I===0)var L=0;else{var Q=x.suspendedLanes,ae=x.pingedLanes;L=(1<<31-Ri(42|s)+1)-1,L&=I&~(Q&~ae),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(g=!0,Cm(x,L))}else L=rr,L=Te(x,x===Pr?L:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(L&3)===0||Oe(x,L)||(g=!0,Cm(x,L));x=x.next}while(g);cu=!1}}function zb(){pp()}function pp(){Jo=Em=!1;var s=0;$c!==0&&(Hc()&&(s=$c),$c=0);for(var h=Ir(),g=null,x=Sm;x!==null;){var I=x.next,L=Am(x,h);L===0?(x.next=null,g===null?Sm=I:g.next=I,I===null&&(Uh=g)):(g=x,(s!==0||(L&3)!==0)&&(Jo=!0)),x=I}fp(s)}function Am(s,h){for(var g=s.suspendedLanes,x=s.pingedLanes,I=s.expirationTimes,L=s.pendingLanes&-62914561;0<L;){var Q=31-Ri(L),ae=1<<Q,De=I[Q];De===-1?((ae&g)===0||(ae&x)!==0)&&(I[Q]=$e(ae,h)):De<=h&&(s.expiredLanes|=ae),L&=~ae}if(h=Pr,g=rr,g=Te(s,s===h?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,g===0||s===h&&(hr===2||hr===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&ya(x),s.callbackNode=null,s.callbackPriority=0;if((g&3)===0||Oe(s,g)){if(h=g&-g,h===s.callbackPriority)return h;switch(x!==null&&ya(x),on(g)){case 2:case 8:g=Ls;break;case 32:g=Xa;break;case 268435456:g=zs;break;default:g=Xa}return x=mv.bind(null,s),g=Tr(g,x),s.callbackPriority=h,s.callbackNode=g,h}return x!==null&&x!==null&&ya(x),s.callbackPriority=2,s.callbackNode=null,2}function mv(s,h){if(Ra!==0&&Ra!==5)return s.callbackNode=null,s.callbackPriority=0,null;var g=s.callbackNode;if(dp()&&s.callbackNode!==g)return null;var x=rr;return x=Te(s,s===Pr?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:($d(s,x,h),Am(s,Ir()),s.callbackNode!=null&&s.callbackNode===g?mv.bind(null,s):null)}function Cm(s,h){if(dp())return null;$d(s,h,!0)}function dy(){xv(function(){(Mr&6)!==0?Tr(na,zb):pp()})}function Gc(){return $c===0&&($c=tt()),$c}function fy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ol(""+s)}function py(s,h){var g=h.ownerDocument.createElement("input");return g.name=h.name,g.value=h.value,s.id&&g.setAttribute("form",s.id),h.parentNode.insertBefore(g,h),s=new FormData(s),g.parentNode.removeChild(g),s}function my(s,h,g,x,I){if(h==="submit"&&g&&g.stateNode===I){var L=fy((I[vn]||null).action),Q=x.submitter;Q&&(h=(h=Q[vn]||null)?fy(h.formAction):Q.getAttribute("formAction"),h!==null&&(L=h,Q=null));var ae=new co("action","action",null,x,I);s.push({event:ae,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if($c!==0){var De=Q?py(I,Q):new FormData(I);yr(g,{pending:!0,data:De,method:I.method,action:L},null,De)}}else typeof L=="function"&&(ae.preventDefault(),De=Q?py(I,Q):new FormData(I),yr(g,{pending:!0,data:De,method:I.method,action:L},L,De))},currentTarget:I}]})}}for(var Im=0;Im<Iu.length;Im++){var Zd=Iu[Im],gv=Zd.toLowerCase(),Ob=Zd[0].toUpperCase()+Zd.slice(1);Ea(gv,"on"+Ob)}Ea(Lf,"onAnimationEnd"),Ea(tm,"onAnimationIteration"),Ea(zf,"onAnimationStart"),Ea("dblclick","onDoubleClick"),Ea("focusin","onFocus"),Ea("focusout","onBlur"),Ea(_d,"onTransitionRun"),Ea(vd,"onTransitionStart"),Ea(bd,"onTransitionCancel"),Ea(xd,"onTransitionEnd"),yn("onMouseEnter",["mouseout","mouseover"]),yn("onMouseLeave",["mouseout","mouseover"]),yn("onPointerEnter",["pointerout","pointerover"]),yn("onPointerLeave",["pointerout","pointerover"]),ki("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ki("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ki("onBeforeInput",["compositionend","keypress","textInput","paste"]),ki("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ki("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ki("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(mp));function _v(s,h){h=(h&4)!==0;for(var g=0;g<s.length;g++){var x=s[g],I=x.event;x=x.listeners;e:{var L=void 0;if(h)for(var Q=x.length-1;0<=Q;Q--){var ae=x[Q],De=ae.instance,at=ae.currentTarget;if(ae=ae.listener,De!==L&&I.isPropagationStopped())break e;L=ae,I.currentTarget=at;try{L(I)}catch(vt){Ld(vt)}I.currentTarget=null,L=De}else for(Q=0;Q<x.length;Q++){if(ae=x[Q],De=ae.instance,at=ae.currentTarget,ae=ae.listener,De!==L&&I.isPropagationStopped())break e;L=ae,I.currentTarget=at;try{L(I)}catch(vt){Ld(vt)}I.currentTarget=null,L=De}}}}function er(s,h){var g=h[cn];g===void 0&&(g=h[cn]=new Set);var x=s+"__bubble";g.has(x)||(Pm(h,s,2,!1),g.add(x))}function gy(s,h,g){var x=0;h&&(x|=4),Pm(g,s,x,h)}var Mm="_reactListening"+Math.random().toString(36).slice(2);function yy(s){if(!s[Mm]){s[Mm]=!0,ha.forEach(function(g){g!=="selectionchange"&&(yv.has(g)||gy(g,!1,s),gy(g,!0,s))});var h=s.nodeType===9?s:s.ownerDocument;h===null||h[Mm]||(h[Mm]=!0,gy("selectionchange",!1,h))}}function Pm(s,h,g,x){switch(Wt(h)){case 2:var I=lt;break;case 8:I=ft;break;default:I=Ct}g=I.bind(null,h,g,s),I=void 0,!Er||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(I=!0),x?I!==void 0?s.addEventListener(h,g,{capture:!0,passive:I}):s.addEventListener(h,g,!0):I!==void 0?s.addEventListener(h,g,{passive:I}):s.addEventListener(h,g,!1)}function hu(s,h,g,x,I){var L=x;if((h&1)===0&&(h&2)===0&&x!==null)e:for(;;){if(x===null)return;var Q=x.tag;if(Q===3||Q===4){var ae=x.stateNode.containerInfo;if(ae===I)break;if(Q===4)for(Q=x.return;Q!==null;){var De=Q.tag;if((De===3||De===4)&&Q.stateNode.containerInfo===I)return;Q=Q.return}for(;ae!==null;){if(Q=va(ae),Q===null)return;if(De=Q.tag,De===5||De===6||De===26||De===27){x=L=Q;continue e}ae=ae.parentNode}}x=x.return}Hi(function(){var at=L,vt=zi(g),Et=[];e:{var ct=Gl.get(s);if(ct!==void 0){var dt=co,fn=s;switch(s){case"keypress":if(mn(g)===0)break e;case"keydown":case"keyup":dt=aa;break;case"focusin":fn="focus",dt=Bo;break;case"focusout":fn="blur",dt=Bo;break;case"beforeblur":case"afterblur":dt=Bo;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dt=Sa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dt=Oi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dt=ll;break;case Lf:case tm:case zf:dt=Xr;break;case xd:dt=fd;break;case"scroll":case"scrollend":dt=wc;break;case"wheel":dt=Ec;break;case"copy":case"cut":case"paste":dt=po;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dt=Su;break;case"toggle":case"beforetoggle":dt=Eu}var bn=(h&4)!==0,jr=!bn&&(s==="scroll"||s==="scrollend"),Xe=bn?ct!==null?ct+"Capture":null:ct;bn=[];for(var qe=at,it;qe!==null;){var wt=qe;if(it=wt.stateNode,wt=wt.tag,wt!==5&&wt!==26&&wt!==27||it===null||Xe===null||(wt=Ur(qe,Xe),wt!=null&&bn.push(Wd(qe,wt,it))),jr)break;qe=qe.return}0<bn.length&&(ct=new dt(ct,fn,null,g,vt),Et.push({event:ct,listeners:bn}))}}if((h&7)===0){e:{if(ct=s==="mouseover"||s==="pointerover",dt=s==="mouseout"||s==="pointerout",ct&&g!==Li&&(fn=g.relatedTarget||g.fromElement)&&(va(fn)||fn[Cn]))break e;if((dt||ct)&&(ct=vt.window===vt?vt:(ct=vt.ownerDocument)?ct.defaultView||ct.parentWindow:window,dt?(fn=g.relatedTarget||g.toElement,dt=at,fn=fn?va(fn):null,fn!==null&&(jr=m(fn),bn=fn.tag,fn!==jr||bn!==5&&bn!==27&&bn!==6)&&(fn=null)):(dt=null,fn=at),dt!==fn)){if(bn=Sa,wt="onMouseLeave",Xe="onMouseEnter",qe="mouse",(s==="pointerout"||s==="pointerover")&&(bn=Su,wt="onPointerLeave",Xe="onPointerEnter",qe="pointer"),jr=dt==null?ct:Dt(dt),it=fn==null?ct:Dt(fn),ct=new bn(wt,qe+"leave",dt,g,vt),ct.target=jr,ct.relatedTarget=it,wt=null,va(vt)===at&&(bn=new bn(Xe,qe+"enter",fn,g,vt),bn.target=it,bn.relatedTarget=jr,wt=bn),jr=wt,dt&&fn)t:{for(bn=dt,Xe=fn,qe=0,it=bn;it;it=qh(it))qe++;for(it=0,wt=Xe;wt;wt=qh(wt))it++;for(;0<qe-it;)bn=qh(bn),qe--;for(;0<it-qe;)Xe=qh(Xe),it--;for(;qe--;){if(bn===Xe||Xe!==null&&bn===Xe.alternate)break t;bn=qh(bn),Xe=qh(Xe)}bn=null}else bn=null;dt!==null&&_y(Et,ct,dt,bn,!1),fn!==null&&jr!==null&&_y(Et,jr,fn,bn,!0)}}e:{if(ct=at?Dt(at):window,dt=ct.nodeName&&ct.nodeName.toLowerCase(),dt==="select"||dt==="input"&&ct.type==="file")var an=If;else if(ei(ct))if(Mf)an=Mg;else{an=Ig;var Xn=Cc}else dt=ct.nodeName,!dt||dt.toLowerCase()!=="input"||ct.type!=="checkbox"&&ct.type!=="radio"?at&&hs(at.elementType)&&(an=If):an=gd;if(an&&(an=an(s,at))){ul(Et,an,g,vt);break e}Xn&&Xn(s,ct,at),s==="focusout"&&at&&ct.type==="number"&&at.memoizedProps.value!=null&&Oo(ct,"number",ct.value)}switch(Xn=at?Dt(at):window,s){case"focusin":(ei(Xn)||Xn.contentEditable==="true")&&(ql=Xn,xh=at,Mc=null);break;case"focusout":Mc=xh=ql=null;break;case"mousedown":wh=!0;break;case"contextmenu":case"mouseup":case"dragend":wh=!1,$l(Et,g,vt);break;case"selectionchange":if(kf)break;case"keydown":case"keyup":$l(Et,g,vt)}var dn;if(ms)e:{switch(s){case"compositionstart":var Tn="onCompositionStart";break e;case"compositionend":Tn="onCompositionEnd";break e;case"compositionupdate":Tn="onCompositionUpdate";break e}Tn=void 0}else Gn?pt(s,g)&&(Tn="onCompositionEnd"):s==="keydown"&&g.keyCode===229&&(Tn="onCompositionStart");Tn&&(Z&&g.locale!=="ko"&&(Gn||Tn!=="onCompositionStart"?Tn==="onCompositionEnd"&&Gn&&(dn=_n()):(fs=vt,In="value"in fs?fs.value:fs.textContent,Gn=!0)),Xn=gp(at,Tn),0<Xn.length&&(Tn=new gh(Tn,s,null,g,vt),Et.push({event:Tn,listeners:Xn}),dn?Tn.data=dn:(dn=Vt(g),dn!==null&&(Tn.data=dn)))),(dn=V?Ni(s,g):Hn(s,g))&&(Tn=gp(at,"onBeforeInput"),0<Tn.length&&(Xn=new gh("onBeforeInput","beforeinput",null,g,vt),Et.push({event:Xn,listeners:Tn}),Xn.data=dn)),my(Et,s,at,g,vt)}_v(Et,h)})}function Wd(s,h,g){return{instance:s,listener:h,currentTarget:g}}function gp(s,h){for(var g=h+"Capture",x=[];s!==null;){var I=s,L=I.stateNode;if(I=I.tag,I!==5&&I!==26&&I!==27||L===null||(I=Ur(s,g),I!=null&&x.unshift(Wd(s,I,L)),I=Ur(s,h),I!=null&&x.push(Wd(s,I,L))),s.tag===3)return x;s=s.return}return[]}function qh(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function _y(s,h,g,x,I){for(var L=h._reactName,Q=[];g!==null&&g!==x;){var ae=g,De=ae.alternate,at=ae.stateNode;if(ae=ae.tag,De!==null&&De===x)break;ae!==5&&ae!==26&&ae!==27||at===null||(De=at,I?(at=Ur(g,L),at!=null&&Q.unshift(Wd(g,at,De))):I||(at=Ur(g,L),at!=null&&Q.push(Wd(g,at,De)))),g=g.return}Q.length!==0&&s.push({event:h,listeners:Q})}var vv=/\r\n?/g,vy=/\u0000|\uFFFD/g;function by(s){return(typeof s=="string"?s:""+s).replace(vv,`
`).replace(vy,"")}function Kd(s,h){return h=by(h),by(s)===h}function yp(){}function Rr(s,h,g,x,I,L){switch(g){case"children":typeof x=="string"?h==="body"||h==="textarea"&&x===""||Na(s,x):(typeof x=="number"||typeof x=="bigint")&&h!=="body"&&Na(s,""+x);break;case"className":ra(s,"class",x);break;case"tabIndex":ra(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":ra(s,g,x);break;case"style":cs(s,x,L);break;case"data":if(h!=="object"){ra(s,"data",x);break}case"src":case"href":if(x===""&&(h!=="a"||g!=="href")){s.removeAttribute(g);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(g);break}x=Ol(""+x),s.setAttribute(g,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof L=="function"&&(g==="formAction"?(h!=="input"&&Rr(s,h,"name",I.name,I,null),Rr(s,h,"formEncType",I.formEncType,I,null),Rr(s,h,"formMethod",I.formMethod,I,null),Rr(s,h,"formTarget",I.formTarget,I,null)):(Rr(s,h,"encType",I.encType,I,null),Rr(s,h,"method",I.method,I,null),Rr(s,h,"target",I.target,I,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(g);break}x=Ol(""+x),s.setAttribute(g,x);break;case"onClick":x!=null&&(s.onclick=yp);break;case"onScroll":x!=null&&er("scroll",s);break;case"onScrollEnd":x!=null&&er("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(a(61));if(g=x.__html,g!=null){if(I.children!=null)throw Error(a(60));s.innerHTML=g}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}g=Ol(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(g,""+x):s.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(g,""):s.removeAttribute(g);break;case"capture":case"download":x===!0?s.setAttribute(g,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(g,x):s.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(g,x):s.removeAttribute(g);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(g):s.setAttribute(g,x);break;case"popover":er("beforetoggle",s),er("toggle",s),Ns(s,"popover",x);break;case"xlinkActuate":yi(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":yi(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":yi(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":yi(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":yi(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":yi(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":yi(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":yi(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":yi(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Ns(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=sl.get(g)||g,Ns(s,g,x))}}function Rm(s,h,g,x,I,L){switch(g){case"style":cs(s,x,L);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(a(61));if(g=x.__html,g!=null){if(I.children!=null)throw Error(a(60));s.innerHTML=g}}break;case"children":typeof x=="string"?Na(s,x):(typeof x=="number"||typeof x=="bigint")&&Na(s,""+x);break;case"onScroll":x!=null&&er("scroll",s);break;case"onScrollEnd":x!=null&&er("scrollend",s);break;case"onClick":x!=null&&(s.onclick=yp);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!il.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(I=g.endsWith("Capture"),h=g.slice(2,I?g.length-7:void 0),L=s[vn]||null,L=L!=null?L[g]:null,typeof L=="function"&&s.removeEventListener(h,L,I),typeof x=="function")){typeof L!="function"&&L!==null&&(g in s?s[g]=null:s.hasAttribute(g)&&s.removeAttribute(g)),s.addEventListener(h,x,I);break e}g in s?s[g]=x:x===!0?s.setAttribute(g,""):Ns(s,g,x)}}}function Br(s,h,g){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":er("error",s),er("load",s);var x=!1,I=!1,L;for(L in g)if(g.hasOwnProperty(L)){var Q=g[L];if(Q!=null)switch(L){case"src":x=!0;break;case"srcSet":I=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,h));default:Rr(s,h,L,Q,g,null)}}I&&Rr(s,h,"srcSet",g.srcSet,g,null),x&&Rr(s,h,"src",g.src,g,null);return;case"input":er("invalid",s);var ae=L=Q=I=null,De=null,at=null;for(x in g)if(g.hasOwnProperty(x)){var vt=g[x];if(vt!=null)switch(x){case"name":I=vt;break;case"type":Q=vt;break;case"checked":De=vt;break;case"defaultChecked":at=vt;break;case"value":L=vt;break;case"defaultValue":ae=vt;break;case"children":case"dangerouslySetInnerHTML":if(vt!=null)throw Error(a(137,h));break;default:Rr(s,h,x,vt,g,null)}}Bs(s,L,ae,De,at,Q,I,!1),lo(s);return;case"select":er("invalid",s),x=Q=L=null;for(I in g)if(g.hasOwnProperty(I)&&(ae=g[I],ae!=null))switch(I){case"value":L=ae;break;case"defaultValue":Q=ae;break;case"multiple":x=ae;default:Rr(s,h,I,ae,g,null)}h=L,g=Q,s.multiple=!!x,h!=null?uo(s,!!x,h,!1):g!=null&&uo(s,!!x,g,!0);return;case"textarea":er("invalid",s),L=I=x=null;for(Q in g)if(g.hasOwnProperty(Q)&&(ae=g[Q],ae!=null))switch(Q){case"value":x=ae;break;case"defaultValue":I=ae;break;case"children":L=ae;break;case"dangerouslySetInnerHTML":if(ae!=null)throw Error(a(91));break;default:Rr(s,h,Q,ae,g,null)}No(s,x,I,L),lo(s);return;case"option":for(De in g)if(g.hasOwnProperty(De)&&(x=g[De],x!=null))switch(De){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Rr(s,h,De,x,g,null)}return;case"dialog":er("beforetoggle",s),er("toggle",s),er("cancel",s),er("close",s);break;case"iframe":case"object":er("load",s);break;case"video":case"audio":for(x=0;x<mp.length;x++)er(mp[x],s);break;case"image":er("error",s),er("load",s);break;case"details":er("toggle",s);break;case"embed":case"source":case"link":er("error",s),er("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(at in g)if(g.hasOwnProperty(at)&&(x=g[at],x!=null))switch(at){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,h));default:Rr(s,h,at,x,g,null)}return;default:if(hs(h)){for(vt in g)g.hasOwnProperty(vt)&&(x=g[vt],x!==void 0&&Rm(s,h,vt,x,g,void 0));return}}for(ae in g)g.hasOwnProperty(ae)&&(x=g[ae],x!=null&&Rr(s,h,ae,x,g,null))}function Xd(s,h,g,x){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var I=null,L=null,Q=null,ae=null,De=null,at=null,vt=null;for(dt in g){var Et=g[dt];if(g.hasOwnProperty(dt)&&Et!=null)switch(dt){case"checked":break;case"value":break;case"defaultValue":De=Et;default:x.hasOwnProperty(dt)||Rr(s,h,dt,null,x,Et)}}for(var ct in x){var dt=x[ct];if(Et=g[ct],x.hasOwnProperty(ct)&&(dt!=null||Et!=null))switch(ct){case"type":L=dt;break;case"name":I=dt;break;case"checked":at=dt;break;case"defaultChecked":vt=dt;break;case"value":Q=dt;break;case"defaultValue":ae=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(a(137,h));break;default:dt!==Et&&Rr(s,h,ct,dt,x,Et)}}Ya(s,Q,ae,De,at,vt,L,I);return;case"select":dt=Q=ae=ct=null;for(L in g)if(De=g[L],g.hasOwnProperty(L)&&De!=null)switch(L){case"value":break;case"multiple":dt=De;default:x.hasOwnProperty(L)||Rr(s,h,L,null,x,De)}for(I in x)if(L=x[I],De=g[I],x.hasOwnProperty(I)&&(L!=null||De!=null))switch(I){case"value":ct=L;break;case"defaultValue":ae=L;break;case"multiple":Q=L;default:L!==De&&Rr(s,h,I,L,x,De)}h=ae,g=Q,x=dt,ct!=null?uo(s,!!g,ct,!1):!!x!=!!g&&(h!=null?uo(s,!!g,h,!0):uo(s,!!g,g?[]:"",!1));return;case"textarea":dt=ct=null;for(ae in g)if(I=g[ae],g.hasOwnProperty(ae)&&I!=null&&!x.hasOwnProperty(ae))switch(ae){case"value":break;case"children":break;default:Rr(s,h,ae,null,x,I)}for(Q in x)if(I=x[Q],L=g[Q],x.hasOwnProperty(Q)&&(I!=null||L!=null))switch(Q){case"value":ct=I;break;case"defaultValue":dt=I;break;case"children":break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(a(91));break;default:I!==L&&Rr(s,h,Q,I,x,L)}Sr(s,ct,dt);return;case"option":for(var fn in g)if(ct=g[fn],g.hasOwnProperty(fn)&&ct!=null&&!x.hasOwnProperty(fn))switch(fn){case"selected":s.selected=!1;break;default:Rr(s,h,fn,null,x,ct)}for(De in x)if(ct=x[De],dt=g[De],x.hasOwnProperty(De)&&ct!==dt&&(ct!=null||dt!=null))switch(De){case"selected":s.selected=ct&&typeof ct!="function"&&typeof ct!="symbol";break;default:Rr(s,h,De,ct,x,dt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bn in g)ct=g[bn],g.hasOwnProperty(bn)&&ct!=null&&!x.hasOwnProperty(bn)&&Rr(s,h,bn,null,x,ct);for(at in x)if(ct=x[at],dt=g[at],x.hasOwnProperty(at)&&ct!==dt&&(ct!=null||dt!=null))switch(at){case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(a(137,h));break;default:Rr(s,h,at,ct,x,dt)}return;default:if(hs(h)){for(var jr in g)ct=g[jr],g.hasOwnProperty(jr)&&ct!==void 0&&!x.hasOwnProperty(jr)&&Rm(s,h,jr,void 0,x,ct);for(vt in x)ct=x[vt],dt=g[vt],!x.hasOwnProperty(vt)||ct===dt||ct===void 0&&dt===void 0||Rm(s,h,vt,ct,x,dt);return}}for(var Xe in g)ct=g[Xe],g.hasOwnProperty(Xe)&&ct!=null&&!x.hasOwnProperty(Xe)&&Rr(s,h,Xe,null,x,ct);for(Et in x)ct=x[Et],dt=g[Et],!x.hasOwnProperty(Et)||ct===dt||ct==null&&dt==null||Rr(s,h,Et,ct,x,dt)}var ac=null,km=null;function _p(s){return s.nodeType===9?s:s.ownerDocument}function xy(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wy(s,h){if(s===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&h==="foreignObject"?0:s}function Ty(s,h){return s==="textarea"||s==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Dm=null;function Hc(){var s=window.event;return s&&s.type==="popstate"?s===Dm?!1:(Dm=s,!0):(Dm=null,!1)}var Sy=typeof setTimeout=="function"?setTimeout:void 0,bv=typeof clearTimeout=="function"?clearTimeout:void 0,Ey=typeof Promise=="function"?Promise:void 0,xv=typeof queueMicrotask=="function"?queueMicrotask:typeof Ey<"u"?function(s){return Ey.resolve(null).then(s).catch(Nb)}:Sy;function Nb(s){setTimeout(function(){throw s})}function Zc(s){return s==="head"}function Ay(s,h){var g=h,x=0,I=0;do{var L=g.nextSibling;if(s.removeChild(g),L&&L.nodeType===8)if(g=L.data,g==="/$"){if(0<x&&8>x){g=x;var Q=s.ownerDocument;if(g&1&&du(Q.documentElement),g&2&&du(Q.body),g&4)for(g=Q.head,du(g),Q=g.firstChild;Q;){var ae=Q.nextSibling,De=Q.nodeName;Q[ai]||De==="SCRIPT"||De==="STYLE"||De==="LINK"&&Q.rel.toLowerCase()==="stylesheet"||g.removeChild(Q),Q=ae}}if(I===0){s.removeChild(L),hi(h);return}I--}else g==="$"||g==="$?"||g==="$!"?I++:x=g.charCodeAt(0)-48;else x=0;g=L}while(g);hi(h)}function Lm(s){var h=s.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var g=h;switch(h=h.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":Lm(g),cr(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}s.removeChild(g)}}function zm(s,h,g,x){for(;s.nodeType===1;){var I=g;if(s.nodeName.toLowerCase()!==h.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[ai])switch(h){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(L=s.getAttribute("rel"),L==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(L!==I.rel||s.getAttribute("href")!==(I.href==null||I.href===""?null:I.href)||s.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin)||s.getAttribute("title")!==(I.title==null?null:I.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(L=s.getAttribute("src"),(L!==(I.src==null?null:I.src)||s.getAttribute("type")!==(I.type==null?null:I.type)||s.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin))&&L&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(h==="input"&&s.type==="hidden"){var L=I.name==null?null:""+I.name;if(I.type==="hidden"&&s.getAttribute("name")===L)return s}else return s;if(s=Xs(s.nextSibling),s===null)break}return null}function wv(s,h,g){if(h==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!g||(s=Xs(s.nextSibling),s===null))return null;return s}function Yd(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Om(s,h){var g=s.ownerDocument;if(s.data!=="$?"||g.readyState==="complete")h();else{var x=function(){h(),g.removeEventListener("DOMContentLoaded",x)};g.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Xs(s){for(;s!=null;s=s.nextSibling){var h=s.nodeType;if(h===1||h===3)break;if(h===8){if(h=s.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return s}var Cy=null;function Tv(s){s=s.previousSibling;for(var h=0;s;){if(s.nodeType===8){var g=s.data;if(g==="$"||g==="$!"||g==="$?"){if(h===0)return s;h--}else g==="/$"&&h++}s=s.previousSibling}return null}function Sv(s,h,g){switch(h=_p(g),s){case"html":if(s=h.documentElement,!s)throw Error(a(452));return s;case"head":if(s=h.head,!s)throw Error(a(453));return s;case"body":if(s=h.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function du(s){for(var h=s.attributes;h.length;)s.removeAttributeNode(h[0]);cr(s)}var Fr=new Map,Nm=new Set;function vp(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var fu=Mt.d;Mt.d={f:Iy,r:Bb,D:Fb,C:Ev,L:Py,m:Ry,X:bp,S:Av,M:ky};function Iy(){var s=fu.f(),h=Si();return s||h}function Bb(s){var h=ba(s);h!==null&&h.tag===5&&h.type==="form"?Ar(h):fu.r(s)}var $h=typeof document>"u"?null:document;function My(s,h,g){var x=$h;if(x&&typeof h=="string"&&h){var I=Di(h);I='link[rel="'+s+'"][href="'+I+'"]',typeof g=="string"&&(I+='[crossorigin="'+g+'"]'),Nm.has(I)||(Nm.add(I),s={rel:s,crossOrigin:g,href:h},x.querySelector(I)===null&&(h=x.createElement("link"),Br(h,"link",s),nn(h),x.head.appendChild(h)))}}function Fb(s){fu.D(s),My("dns-prefetch",s,null)}function Ev(s,h){fu.C(s,h),My("preconnect",s,h)}function Py(s,h,g){fu.L(s,h,g);var x=$h;if(x&&s&&h){var I='link[rel="preload"][as="'+Di(h)+'"]';h==="image"&&g&&g.imageSrcSet?(I+='[imagesrcset="'+Di(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(I+='[imagesizes="'+Di(g.imageSizes)+'"]')):I+='[href="'+Di(s)+'"]';var L=I;switch(h){case"style":L=Wc(s);break;case"script":L=Xc(s)}Fr.has(L)||(s=B({rel:"preload",href:h==="image"&&g&&g.imageSrcSet?void 0:s,as:h},g),Fr.set(L,s),x.querySelector(I)!==null||h==="style"&&x.querySelector(Kc(L))||h==="script"&&x.querySelector(Gh(L))||(h=x.createElement("link"),Br(h,"link",s),nn(h),x.head.appendChild(h)))}}function Ry(s,h){fu.m(s,h);var g=$h;if(g&&s){var x=h&&typeof h.as=="string"?h.as:"script",I='link[rel="modulepreload"][as="'+Di(x)+'"][href="'+Di(s)+'"]',L=I;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":L=Xc(s)}if(!Fr.has(L)&&(s=B({rel:"modulepreload",href:s},h),Fr.set(L,s),g.querySelector(I)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Gh(L)))return}x=g.createElement("link"),Br(x,"link",s),nn(x),g.head.appendChild(x)}}}function Av(s,h,g){fu.S(s,h,g);var x=$h;if(x&&s){var I=hn(x).hoistableStyles,L=Wc(s);h=h||"default";var Q=I.get(L);if(!Q){var ae={loading:0,preload:null};if(Q=x.querySelector(Kc(L)))ae.loading=5;else{s=B({rel:"stylesheet",href:s,"data-precedence":h},g),(g=Fr.get(L))&&i(s,g);var De=Q=x.createElement("link");nn(De),Br(De,"link",s),De._p=new Promise(function(at,vt){De.onload=at,De.onerror=vt}),De.addEventListener("load",function(){ae.loading|=1}),De.addEventListener("error",function(){ae.loading|=2}),ae.loading|=4,u(Q,h,x)}Q={type:"stylesheet",instance:Q,count:1,state:ae},I.set(L,Q)}}}function bp(s,h){fu.X(s,h);var g=$h;if(g&&s){var x=hn(g).hoistableScripts,I=Xc(s),L=x.get(I);L||(L=g.querySelector(Gh(I)),L||(s=B({src:s,async:!0},h),(h=Fr.get(I))&&o(s,h),L=g.createElement("script"),nn(L),Br(L,"link",s),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},x.set(I,L))}}function ky(s,h){fu.M(s,h);var g=$h;if(g&&s){var x=hn(g).hoistableScripts,I=Xc(s),L=x.get(I);L||(L=g.querySelector(Gh(I)),L||(s=B({src:s,async:!0,type:"module"},h),(h=Fr.get(I))&&o(s,h),L=g.createElement("script"),nn(L),Br(L,"link",s),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},x.set(I,L))}}function Dy(s,h,g,x){var I=(I=gn.current)?vp(I):null;if(!I)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(h=Wc(g.href),g=hn(I).hoistableStyles,x=g.get(h),x||(x={type:"style",instance:null,count:0,state:null},g.set(h,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){s=Wc(g.href);var L=hn(I).hoistableStyles,Q=L.get(s);if(Q||(I=I.ownerDocument||I,Q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},L.set(s,Q),(L=I.querySelector(Kc(s)))&&!L._p&&(Q.instance=L,Q.state.loading=5),Fr.has(s)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Fr.set(s,g),L||Ly(I,s,g,Q.state))),h&&x===null)throw Error(a(528,""));return Q}if(h&&x!==null)throw Error(a(529,""));return null;case"script":return h=g.async,g=g.src,typeof g=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Xc(g),g=hn(I).hoistableScripts,x=g.get(h),x||(x={type:"script",instance:null,count:0,state:null},g.set(h,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Wc(s){return'href="'+Di(s)+'"'}function Kc(s){return'link[rel="stylesheet"]['+s+"]"}function Qd(s){return B({},s,{"data-precedence":s.precedence,precedence:null})}function Ly(s,h,g,x){s.querySelector('link[rel="preload"][as="style"]['+h+"]")?x.loading=1:(h=s.createElement("link"),x.preload=h,h.addEventListener("load",function(){return x.loading|=1}),h.addEventListener("error",function(){return x.loading|=2}),Br(h,"link",g),nn(h),s.head.appendChild(h))}function Xc(s){return'[src="'+Di(s)+'"]'}function Gh(s){return"script[async]"+s}function Cv(s,h,g){if(h.count++,h.instance===null)switch(h.type){case"style":var x=s.querySelector('style[data-href~="'+Di(g.href)+'"]');if(x)return h.instance=x,nn(x),x;var I=B({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),nn(x),Br(x,"style",I),u(x,g.precedence,s),h.instance=x;case"stylesheet":I=Wc(g.href);var L=s.querySelector(Kc(I));if(L)return h.state.loading|=4,h.instance=L,nn(L),L;x=Qd(g),(I=Fr.get(I))&&i(x,I),L=(s.ownerDocument||s).createElement("link"),nn(L);var Q=L;return Q._p=new Promise(function(ae,De){Q.onload=ae,Q.onerror=De}),Br(L,"link",x),h.state.loading|=4,u(L,g.precedence,s),h.instance=L;case"script":return L=Xc(g.src),(I=s.querySelector(Gh(L)))?(h.instance=I,nn(I),I):(x=g,(I=Fr.get(L))&&(x=B({},g),o(x,I)),s=s.ownerDocument||s,I=s.createElement("script"),nn(I),Br(I,"link",x),s.head.appendChild(I),h.instance=I);case"void":return null;default:throw Error(a(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(x=h.instance,h.state.loading|=4,u(x,g.precedence,s));return h.instance}function u(s,h,g){for(var x=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),I=x.length?x[x.length-1]:null,L=I,Q=0;Q<x.length;Q++){var ae=x[Q];if(ae.dataset.precedence===h)L=ae;else if(L!==I)break}L?L.parentNode.insertBefore(s,L.nextSibling):(h=g.nodeType===9?g.head:g,h.insertBefore(s,h.firstChild))}function i(s,h){s.crossOrigin==null&&(s.crossOrigin=h.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=h.referrerPolicy),s.title==null&&(s.title=h.title)}function o(s,h){s.crossOrigin==null&&(s.crossOrigin=h.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=h.referrerPolicy),s.integrity==null&&(s.integrity=h.integrity)}var f=null;function v(s,h,g){if(f===null){var x=new Map,I=f=new Map;I.set(g,x)}else I=f,x=I.get(g),x||(x=new Map,I.set(g,x));if(x.has(s))return x;for(x.set(s,null),g=g.getElementsByTagName(s),I=0;I<g.length;I++){var L=g[I];if(!(L[ai]||L[An]||s==="link"&&L.getAttribute("rel")==="stylesheet")&&L.namespaceURI!=="http://www.w3.org/2000/svg"){var Q=L.getAttribute(h)||"";Q=s+Q;var ae=x.get(Q);ae?ae.push(L):x.set(Q,[L])}}return x}function T(s,h,g){s=s.ownerDocument||s,s.head.insertBefore(g,h==="title"?s.querySelector("head > title"):null)}function S(s,h,g){if(g===1||h.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return s=h.disabled,typeof h.precedence=="string"&&s==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function C(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var k=null;function z(){}function N(s,h,g){if(k===null)throw Error(a(475));var x=k;if(h.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var I=Wc(g.href),L=s.querySelector(Kc(I));if(L){s=L._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=G.bind(x),s.then(x,x)),h.state.loading|=4,h.instance=L,nn(L);return}L=s.ownerDocument||s,g=Qd(g),(I=Fr.get(I))&&i(g,I),L=L.createElement("link"),nn(L);var Q=L;Q._p=new Promise(function(ae,De){Q.onload=ae,Q.onerror=De}),Br(L,"link",g),h.instance=L}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(h,s),(s=h.state.preload)&&(h.state.loading&3)===0&&(x.count++,h=G.bind(x),s.addEventListener("load",h),s.addEventListener("error",h))}}function j(){if(k===null)throw Error(a(475));var s=k;return s.stylesheets&&s.count===0&&J(s,s.stylesheets),0<s.count?function(h){var g=setTimeout(function(){if(s.stylesheets&&J(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=h,function(){s.unsuspend=null,clearTimeout(g)}}:null}function G(){if(this.count--,this.count===0){if(this.stylesheets)J(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Y=null;function J(s,h){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Y=new Map,h.forEach(te,s),Y=null,G.call(s))}function te(s,h){if(!(h.state.loading&4)){var g=Y.get(s);if(g)var x=g.get(null);else{g=new Map,Y.set(s,g);for(var I=s.querySelectorAll("link[data-precedence],style[data-precedence]"),L=0;L<I.length;L++){var Q=I[L];(Q.nodeName==="LINK"||Q.getAttribute("media")!=="not all")&&(g.set(Q.dataset.precedence,Q),x=Q)}x&&g.set(null,x)}I=h.instance,Q=I.getAttribute("data-precedence"),L=g.get(Q)||x,L===x&&g.set(null,I),g.set(Q,I),this.count++,x=G.bind(this),I.addEventListener("load",x),I.addEventListener("error",x),L?L.parentNode.insertBefore(I,L.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(I,s.firstChild)),h.state.loading|=4}}var le={$$typeof:ut,Provider:null,Consumer:null,_currentValue:Tt,_currentValue2:Tt,_threadCount:0};function ge(s,h,g,x,I,L,Q,ae){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ht(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ht(0),this.hiddenUpdates=ht(null),this.identifierPrefix=x,this.onUncaughtError=I,this.onCaughtError=L,this.onRecoverableError=Q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function Ne(s,h,g,x,I,L,Q,ae,De,at,vt,Et){return s=new ge(s,h,g,Q,ae,De,at,Et),h=1,L===!0&&(h|=24),L=Va(3,null,null,h),s.current=L,L.stateNode=s,h=Xl(),h.refCount++,s.pooledCache=h,h.refCount++,L.memoizedState={element:x,isDehydrated:g,cache:h},Ph(L),s}function Se(s){return s?(s=yo,s):yo}function X(s,h,g,x,I,L){I=Se(I),x.context===null?x.context=I:x.pendingContext=I,x=$o(h),x.payload={element:g},L=L===void 0?null:L,L!==null&&(x.callback=L),g=yl(s,x,h),g!==null&&(Ao(g,s,h),tu(g,s,h))}function oe(s,h){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var g=s.retryLane;s.retryLane=g!==0&&g<h?g:h}}function Ie(s,h){oe(s,h),(s=s.alternate)&&oe(s,h)}function nt(s){if(s.tag===13){var h=go(s,67108864);h!==null&&Ao(h,s,67108864),Ie(s,67108864)}}var yt=!0;function lt(s,h,g,x){var I=et.T;et.T=null;var L=Mt.p;try{Mt.p=2,Ct(s,h,g,x)}finally{Mt.p=L,et.T=I}}function ft(s,h,g,x){var I=et.T;et.T=null;var L=Mt.p;try{Mt.p=8,Ct(s,h,g,x)}finally{Mt.p=L,et.T=I}}function Ct(s,h,g,x){if(yt){var I=xt(x);if(I===null)hu(s,h,x,Rt,g),rs(s,x);else if(ri(I,s,h,g,x))x.stopPropagation();else if(rs(s,x),h&4&&-1<Co.indexOf(s)){for(;I!==null;){var L=ba(I);if(L!==null)switch(L.tag){case 3:if(L=L.stateNode,L.current.memoizedState.isDehydrated){var Q=ue(L.pendingLanes);if(Q!==0){var ae=L;for(ae.pendingLanes|=2,ae.entangledLanes|=2;Q;){var De=1<<31-Ri(Q);ae.entanglements[1]|=De,Q&=~De}el(L),(Mr&6)===0&&(lp=Ir()+500,fp(0))}}break;case 13:ae=go(L,2),ae!==null&&Ao(ae,L,2),Si(),Ie(L,2)}if(L=xt(x),L===null&&hu(s,h,x,Rt,g),L===I)break;I=L}I!==null&&x.stopPropagation()}else hu(s,h,x,null,g)}}function xt(s){return s=zi(s),gt(s)}var Rt=null;function gt(s){if(Rt=null,s=va(s),s!==null){var h=m(s);if(h===null)s=null;else{var g=h.tag;if(g===13){if(s=y(h),s!==null)return s;s=null}else if(g===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;s=null}else h!==s&&(s=null)}}return Rt=s,null}function Wt(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Oa()){case na:return 2;case Ls:return 8;case Xa:case bu:return 32;case zs:return 268435456;default:return 32}default:return 32}}var sn=!1,Yt=null,Ht=null,Sn=null,Vr=new Map,ui=new Map,ci=[],Co="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rs(s,h){switch(s){case"focusin":case"focusout":Yt=null;break;case"dragenter":case"dragleave":Ht=null;break;case"mouseover":case"mouseout":Sn=null;break;case"pointerover":case"pointerout":Vr.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":ui.delete(h.pointerId)}}function Ei(s,h,g,x,I,L){return s===null||s.nativeEvent!==L?(s={blockedOn:h,domEventName:g,eventSystemFlags:x,nativeEvent:L,targetContainers:[I]},h!==null&&(h=ba(h),h!==null&&nt(h)),s):(s.eventSystemFlags|=x,h=s.targetContainers,I!==null&&h.indexOf(I)===-1&&h.push(I),s)}function ri(s,h,g,x,I){switch(h){case"focusin":return Yt=Ei(Yt,s,h,g,x,I),!0;case"dragenter":return Ht=Ei(Ht,s,h,g,x,I),!0;case"mouseover":return Sn=Ei(Sn,s,h,g,x,I),!0;case"pointerover":var L=I.pointerId;return Vr.set(L,Ei(Vr.get(L)||null,s,h,g,x,I)),!0;case"gotpointercapture":return L=I.pointerId,ui.set(L,Ei(ui.get(L)||null,s,h,g,x,I)),!0}return!1}function Qi(s){var h=va(s.target);if(h!==null){var g=m(h);if(g!==null){if(h=g.tag,h===13){if(h=y(g),h!==null){s.blockedOn=h,Jt(s.priority,function(){if(g.tag===13){var x=Ks();x=Ot(x);var I=go(g,x);I!==null&&Ao(I,g,x),Ie(g,x)}});return}}else if(h===3&&g.stateNode.current.memoizedState.isDehydrated){s.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ji(s){if(s.blockedOn!==null)return!1;for(var h=s.targetContainers;0<h.length;){var g=xt(s.nativeEvent);if(g===null){g=s.nativeEvent;var x=new g.constructor(g.type,g);Li=x,g.target.dispatchEvent(x),Li=null}else return h=ba(g),h!==null&&nt(h),s.blockedOn=g,!1;h.shift()}return!0}function ua(s,h,g){ji(s)&&g.delete(h)}function is(){sn=!1,Yt!==null&&ji(Yt)&&(Yt=null),Ht!==null&&ji(Ht)&&(Ht=null),Sn!==null&&ji(Sn)&&(Sn=null),Vr.forEach(ua),ui.forEach(ua)}function as(s,h){s.blockedOn===h&&(s.blockedOn=null,sn||(sn=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,is)))}var Ai=null;function ss(s){Ai!==s&&(Ai=s,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Ai===s&&(Ai=null);for(var h=0;h<s.length;h+=3){var g=s[h],x=s[h+1],I=s[h+2];if(typeof x!="function"){if(gt(x||g)===null)continue;break}var L=ba(g);L!==null&&(s.splice(h,3),h-=3,yr(L,{pending:!0,data:I,method:g.method,action:x},x,I))}}))}function hi(s){function h(De){return as(De,s)}Yt!==null&&as(Yt,s),Ht!==null&&as(Ht,s),Sn!==null&&as(Sn,s),Vr.forEach(h),ui.forEach(h);for(var g=0;g<ci.length;g++){var x=ci[g];x.blockedOn===s&&(x.blockedOn=null)}for(;0<ci.length&&(g=ci[0],g.blockedOn===null);)Qi(g),g.blockedOn===null&&ci.shift();if(g=(s.ownerDocument||s).$$reactFormReplay,g!=null)for(x=0;x<g.length;x+=3){var I=g[x],L=g[x+1],Q=I[vn]||null;if(typeof L=="function")Q||ss(g);else if(Q){var ae=null;if(L&&L.hasAttribute("formAction")){if(I=L,Q=L[vn]||null)ae=Q.formAction;else if(gt(I)!==null)continue}else ae=Q.action;typeof ae=="function"?g[x+1]=ae:(g.splice(x,3),x-=3),ss(g)}}}function Ui(s){this._internalRoot=s}Ci.prototype.render=Ui.prototype.render=function(s){var h=this._internalRoot;if(h===null)throw Error(a(409));var g=h.current,x=Ks();X(g,x,s,h,null,null)},Ci.prototype.unmount=Ui.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var h=s.containerInfo;X(s.current,2,null,s,null,null),Si(),h[Cn]=null}};function Ci(s){this._internalRoot=s}Ci.prototype.unstable_scheduleHydration=function(s){if(s){var h=jt();s={blockedOn:null,target:s,priority:h};for(var g=0;g<ci.length&&h!==0&&h<ci[g].priority;g++);ci.splice(g,0,s),g===0&&Qi(s)}};var Ii=e.version;if(Ii!=="19.1.0")throw Error(a(527,Ii,"19.1.0"));Mt.findDOMNode=function(s){var h=s._reactInternals;if(h===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=M(h),s=s!==null?R(s):null,s=s===null?null:s.stateNode,s};var Hr={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:et,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ys=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ys.isDisabled&&Ys.supportsFiber)try{fr=Ys.inject(Hr),Bn=Ys}catch{}}return Oy.createRoot=function(s,h){if(!d(s))throw Error(a(299));var g=!1,x="",I=Rg,L=W_,Q=kg,ae=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onUncaughtError!==void 0&&(I=h.onUncaughtError),h.onCaughtError!==void 0&&(L=h.onCaughtError),h.onRecoverableError!==void 0&&(Q=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(ae=h.unstable_transitionCallbacks)),h=Ne(s,1,!1,null,null,g,x,I,L,Q,ae,null),s[Cn]=h.current,yy(s),new Ui(h)},Oy.hydrateRoot=function(s,h,g){if(!d(s))throw Error(a(299));var x=!1,I="",L=Rg,Q=W_,ae=kg,De=null,at=null;return g!=null&&(g.unstable_strictMode===!0&&(x=!0),g.identifierPrefix!==void 0&&(I=g.identifierPrefix),g.onUncaughtError!==void 0&&(L=g.onUncaughtError),g.onCaughtError!==void 0&&(Q=g.onCaughtError),g.onRecoverableError!==void 0&&(ae=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(De=g.unstable_transitionCallbacks),g.formState!==void 0&&(at=g.formState)),h=Ne(s,1,!0,h,g??null,x,I,L,Q,ae,De,at),h.context=Se(null),g=h.current,x=Ks(),x=Ot(x),I=$o(x),I.callback=null,yl(g,I,x),g=x,h.current.lanes=g,st(h,g),el(h),s[Cn]=h.current,yy(s),new Ci(h)},Oy.version="19.1.0",Oy}var O2;function LP(){if(O2)return qb.exports;O2=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),qb.exports=DP(),qb.exports}var zP=LP();const OP=A_(zP);var Ny={},N2;function NP(){if(N2)return Ny;N2=1,Object.defineProperty(Ny,"__esModule",{value:!0}),Ny.parse=y,Ny.serialize=R;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,d=Object.prototype.toString,m=(()=>{const $=function(){};return $.prototype=Object.create(null),$})();function y($,W){const re=new m,Me=$.length;if(Me<2)return re;const Ce=(W==null?void 0:W.decode)||B;let Be=0;do{const He=$.indexOf("=",Be);if(He===-1)break;const ut=$.indexOf(";",Be),Ue=ut===-1?Me:ut;if(He>Ue){Be=$.lastIndexOf(";",He-1)+1;continue}const Fe=c($,Be,He),Ze=M($,He,Fe),me=$.slice(Fe,Ze);if(re[me]===void 0){let se=c($,He+1,Ue),ye=M($,Ue,se);const we=Ce($.slice(se,ye));re[me]=we}Be=Ue+1}while(Be<Me);return re}function c($,W,re){do{const Me=$.charCodeAt(W);if(Me!==32&&Me!==9)return W}while(++W<re);return re}function M($,W,re){for(;W>re;){const Me=$.charCodeAt(--W);if(Me!==32&&Me!==9)return W+1}return re}function R($,W,re){const Me=(re==null?void 0:re.encode)||encodeURIComponent;if(!r.test($))throw new TypeError(`argument name is invalid: ${$}`);const Ce=Me(W);if(!e.test(Ce))throw new TypeError(`argument val is invalid: ${W}`);let Be=$+"="+Ce;if(!re)return Be;if(re.maxAge!==void 0){if(!Number.isInteger(re.maxAge))throw new TypeError(`option maxAge is invalid: ${re.maxAge}`);Be+="; Max-Age="+re.maxAge}if(re.domain){if(!t.test(re.domain))throw new TypeError(`option domain is invalid: ${re.domain}`);Be+="; Domain="+re.domain}if(re.path){if(!a.test(re.path))throw new TypeError(`option path is invalid: ${re.path}`);Be+="; Path="+re.path}if(re.expires){if(!K(re.expires)||!Number.isFinite(re.expires.valueOf()))throw new TypeError(`option expires is invalid: ${re.expires}`);Be+="; Expires="+re.expires.toUTCString()}if(re.httpOnly&&(Be+="; HttpOnly"),re.secure&&(Be+="; Secure"),re.partitioned&&(Be+="; Partitioned"),re.priority)switch(typeof re.priority=="string"?re.priority.toLowerCase():void 0){case"low":Be+="; Priority=Low";break;case"medium":Be+="; Priority=Medium";break;case"high":Be+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${re.priority}`)}if(re.sameSite)switch(typeof re.sameSite=="string"?re.sameSite.toLowerCase():re.sameSite){case!0:case"strict":Be+="; SameSite=Strict";break;case"lax":Be+="; SameSite=Lax";break;case"none":Be+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${re.sameSite}`)}return Be}function B($){if($.indexOf("%")===-1)return $;try{return decodeURIComponent($)}catch{return $}}function K($){return d.call($)==="[object Date]"}return Ny}NP();var B2="popstate";function BP(r={}){function e(d,m){let{pathname:y="/",search:c="",hash:M=""}=Hp(d.location.hash.substring(1));return!y.startsWith("/")&&!y.startsWith(".")&&(y="/"+y),Ax("",{pathname:y,search:c,hash:M},m.state&&m.state.usr||null,m.state&&m.state.key||"default")}function t(d,m){let y=d.document.querySelector("base"),c="";if(y&&y.getAttribute("href")){let M=d.location.href,R=M.indexOf("#");c=R===-1?M:M.slice(0,R)}return c+"#"+(typeof m=="string"?m:a_(m))}function a(d,m){pc(d.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(m)})`)}return VP(e,t,a,r)}function ea(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function pc(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function FP(){return Math.random().toString(36).substring(2,10)}function F2(r,e){return{usr:r.state,key:r.key,idx:e}}function Ax(r,e,t=null,a){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?Hp(e):e,state:t,key:e&&e.key||a||FP()}}function a_({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function Hp(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let a=r.indexOf("?");a>=0&&(e.search=r.substring(a),r=r.substring(0,a)),r&&(e.pathname=r)}return e}function VP(r,e,t,a={}){let{window:d=document.defaultView,v5Compat:m=!1}=a,y=d.history,c="POP",M=null,R=B();R==null&&(R=0,y.replaceState({...y.state,idx:R},""));function B(){return(y.state||{idx:null}).idx}function K(){c="POP";let Ce=B(),Be=Ce==null?null:Ce-R;R=Ce,M&&M({action:c,location:Me.location,delta:Be})}function $(Ce,Be){c="PUSH";let He=Ax(Me.location,Ce,Be);t&&t(He,Ce),R=B()+1;let ut=F2(He,R),Ue=Me.createHref(He);try{y.pushState(ut,"",Ue)}catch(Fe){if(Fe instanceof DOMException&&Fe.name==="DataCloneError")throw Fe;d.location.assign(Ue)}m&&M&&M({action:c,location:Me.location,delta:1})}function W(Ce,Be){c="REPLACE";let He=Ax(Me.location,Ce,Be);t&&t(He,Ce),R=B();let ut=F2(He,R),Ue=Me.createHref(He);y.replaceState(ut,"",Ue),m&&M&&M({action:c,location:Me.location,delta:0})}function re(Ce){return jP(Ce)}let Me={get action(){return c},get location(){return r(d,y)},listen(Ce){if(M)throw new Error("A history only accepts one active listener");return d.addEventListener(B2,K),M=Ce,()=>{d.removeEventListener(B2,K),M=null}},createHref(Ce){return e(d,Ce)},createURL:re,encodeLocation(Ce){let Be=re(Ce);return{pathname:Be.pathname,search:Be.search,hash:Be.hash}},push:$,replace:W,go(Ce){return y.go(Ce)}};return Me}function jP(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ea(t,"No window.location.(origin|href) available to create URL");let a=typeof r=="string"?r:a_(r);return a=a.replace(/ $/,"%20"),!e&&a.startsWith("//")&&(a=t+a),new URL(a,t)}function FE(r,e,t="/"){return UP(r,e,t,!1)}function UP(r,e,t,a){let d=typeof e=="string"?Hp(e):e,m=ed(d.pathname||"/",t);if(m==null)return null;let y=VE(r);qP(y);let c=null;for(let M=0;c==null&&M<y.length;++M){let R=eR(m);c=QP(y[M],R,a)}return c}function VE(r,e=[],t=[],a=""){let d=(m,y,c)=>{let M={relativePath:c===void 0?m.path||"":c,caseSensitive:m.caseSensitive===!0,childrenIndex:y,route:m};M.relativePath.startsWith("/")&&(ea(M.relativePath.startsWith(a),`Absolute route path "${M.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),M.relativePath=M.relativePath.slice(a.length));let R=Kh([a,M.relativePath]),B=t.concat(M);m.children&&m.children.length>0&&(ea(m.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${R}".`),VE(m.children,e,B,R)),!(m.path==null&&!m.index)&&e.push({path:R,score:XP(R,m.index),routesMeta:B})};return r.forEach((m,y)=>{var c;if(m.path===""||!((c=m.path)!=null&&c.includes("?")))d(m,y);else for(let M of jE(m.path))d(m,y,M)}),e}function jE(r){let e=r.split("/");if(e.length===0)return[];let[t,...a]=e,d=t.endsWith("?"),m=t.replace(/\?$/,"");if(a.length===0)return d?[m,""]:[m];let y=jE(a.join("/")),c=[];return c.push(...y.map(M=>M===""?m:[m,M].join("/"))),d&&c.push(...y),c.map(M=>r.startsWith("/")&&M===""?"/":M)}function qP(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:YP(e.routesMeta.map(a=>a.childrenIndex),t.routesMeta.map(a=>a.childrenIndex)))}var $P=/^:[\w-]+$/,GP=3,HP=2,ZP=1,WP=10,KP=-2,V2=r=>r==="*";function XP(r,e){let t=r.split("/"),a=t.length;return t.some(V2)&&(a+=KP),e&&(a+=HP),t.filter(d=>!V2(d)).reduce((d,m)=>d+($P.test(m)?GP:m===""?ZP:WP),a)}function YP(r,e){return r.length===e.length&&r.slice(0,-1).every((a,d)=>a===e[d])?r[r.length-1]-e[e.length-1]:0}function QP(r,e,t=!1){let{routesMeta:a}=r,d={},m="/",y=[];for(let c=0;c<a.length;++c){let M=a[c],R=c===a.length-1,B=m==="/"?e:e.slice(m.length)||"/",K=o0({path:M.relativePath,caseSensitive:M.caseSensitive,end:R},B),$=M.route;if(!K&&R&&t&&!a[a.length-1].route.index&&(K=o0({path:M.relativePath,caseSensitive:M.caseSensitive,end:!1},B)),!K)return null;Object.assign(d,K.params),y.push({params:d,pathname:Kh([m,K.pathname]),pathnameBase:iR(Kh([m,K.pathnameBase])),route:$}),K.pathnameBase!=="/"&&(m=Kh([m,K.pathnameBase]))}return y}function o0(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,a]=JP(r.path,r.caseSensitive,r.end),d=e.match(t);if(!d)return null;let m=d[0],y=m.replace(/(.)\/+$/,"$1"),c=d.slice(1);return{params:a.reduce((R,{paramName:B,isOptional:K},$)=>{if(B==="*"){let re=c[$]||"";y=m.slice(0,m.length-re.length).replace(/(.)\/+$/,"$1")}const W=c[$];return K&&!W?R[B]=void 0:R[B]=(W||"").replace(/%2F/g,"/"),R},{}),pathname:m,pathnameBase:y,pattern:r}}function JP(r,e=!1,t=!0){pc(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let a=[],d="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(y,c,M)=>(a.push({paramName:c,isOptional:M!=null}),M?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(a.push({paramName:"*"}),d+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?d+="\\/*$":r!==""&&r!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,e?void 0:"i"),a]}function eR(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return pc(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function ed(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,a=r.charAt(t);return a&&a!=="/"?null:r.slice(t)||"/"}function tR(r,e="/"){let{pathname:t,search:a="",hash:d=""}=typeof r=="string"?Hp(r):r;return{pathname:t?t.startsWith("/")?t:nR(t,e):e,search:aR(a),hash:sR(d)}}function nR(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(d=>{d===".."?t.length>1&&t.pop():d!=="."&&t.push(d)}),t.length>1?t.join("/"):"/"}function Zb(r,e,t,a){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rR(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function UE(r){let e=rR(r);return e.map((t,a)=>a===e.length-1?t.pathname:t.pathnameBase)}function qE(r,e,t,a=!1){let d;typeof r=="string"?d=Hp(r):(d={...r},ea(!d.pathname||!d.pathname.includes("?"),Zb("?","pathname","search",d)),ea(!d.pathname||!d.pathname.includes("#"),Zb("#","pathname","hash",d)),ea(!d.search||!d.search.includes("#"),Zb("#","search","hash",d)));let m=r===""||d.pathname==="",y=m?"/":d.pathname,c;if(y==null)c=t;else{let K=e.length-1;if(!a&&y.startsWith("..")){let $=y.split("/");for(;$[0]==="..";)$.shift(),K-=1;d.pathname=$.join("/")}c=K>=0?e[K]:"/"}let M=tR(d,c),R=y&&y!=="/"&&y.endsWith("/"),B=(m||y===".")&&t.endsWith("/");return!M.pathname.endsWith("/")&&(R||B)&&(M.pathname+="/"),M}var Kh=r=>r.join("/").replace(/\/\/+/g,"/"),iR=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),aR=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,sR=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function oR(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var $E=["POST","PUT","PATCH","DELETE"];new Set($E);var lR=["GET",...$E];new Set(lR);var mg=We.createContext(null);mg.displayName="DataRouter";var F0=We.createContext(null);F0.displayName="DataRouterState";var GE=We.createContext({isTransitioning:!1});GE.displayName="ViewTransition";var uR=We.createContext(new Map);uR.displayName="Fetchers";var cR=We.createContext(null);cR.displayName="Await";var ph=We.createContext(null);ph.displayName="Navigation";var C_=We.createContext(null);C_.displayName="Location";var ud=We.createContext({outlet:null,matches:[],isDataRoute:!1});ud.displayName="Route";var N1=We.createContext(null);N1.displayName="RouteError";function hR(r,{relative:e}={}){ea(I_(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:a}=We.useContext(ph),{hash:d,pathname:m,search:y}=M_(r,{relative:e}),c=m;return t!=="/"&&(c=m==="/"?t:Kh([t,m])),a.createHref({pathname:c,search:y,hash:d})}function I_(){return We.useContext(C_)!=null}function Zp(){return ea(I_(),"useLocation() may be used only in the context of a <Router> component."),We.useContext(C_).location}var HE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ZE(r){We.useContext(ph).static||We.useLayoutEffect(r)}function dR(){let{isDataRoute:r}=We.useContext(ud);return r?ER():fR()}function fR(){ea(I_(),"useNavigate() may be used only in the context of a <Router> component.");let r=We.useContext(mg),{basename:e,navigator:t}=We.useContext(ph),{matches:a}=We.useContext(ud),{pathname:d}=Zp(),m=JSON.stringify(UE(a)),y=We.useRef(!1);return ZE(()=>{y.current=!0}),We.useCallback((M,R={})=>{if(pc(y.current,HE),!y.current)return;if(typeof M=="number"){t.go(M);return}let B=qE(M,JSON.parse(m),d,R.relative==="path");r==null&&e!=="/"&&(B.pathname=B.pathname==="/"?e:Kh([e,B.pathname])),(R.replace?t.replace:t.push)(B,R.state,R)},[e,t,m,d,r])}We.createContext(null);function M_(r,{relative:e}={}){let{matches:t}=We.useContext(ud),{pathname:a}=Zp(),d=JSON.stringify(UE(t));return We.useMemo(()=>qE(r,JSON.parse(d),a,e==="path"),[r,d,a,e])}function pR(r,e){return WE(r,e)}function WE(r,e,t,a){var Be;ea(I_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:d}=We.useContext(ph),{matches:m}=We.useContext(ud),y=m[m.length-1],c=y?y.params:{},M=y?y.pathname:"/",R=y?y.pathnameBase:"/",B=y&&y.route;{let He=B&&B.path||"";KE(M,!B||He.endsWith("*")||He.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${M}" (under <Route path="${He}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${He}"> to <Route path="${He==="/"?"*":`${He}/*`}">.`)}let K=Zp(),$;if(e){let He=typeof e=="string"?Hp(e):e;ea(R==="/"||((Be=He.pathname)==null?void 0:Be.startsWith(R)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${R}" but pathname "${He.pathname}" was given in the \`location\` prop.`),$=He}else $=K;let W=$.pathname||"/",re=W;if(R!=="/"){let He=R.replace(/^\//,"").split("/");re="/"+W.replace(/^\//,"").split("/").slice(He.length).join("/")}let Me=FE(r,{pathname:re});pc(B||Me!=null,`No routes matched location "${$.pathname}${$.search}${$.hash}" `),pc(Me==null||Me[Me.length-1].route.element!==void 0||Me[Me.length-1].route.Component!==void 0||Me[Me.length-1].route.lazy!==void 0,`Matched leaf route at location "${$.pathname}${$.search}${$.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Ce=vR(Me&&Me.map(He=>Object.assign({},He,{params:Object.assign({},c,He.params),pathname:Kh([R,d.encodeLocation?d.encodeLocation(He.pathname).pathname:He.pathname]),pathnameBase:He.pathnameBase==="/"?R:Kh([R,d.encodeLocation?d.encodeLocation(He.pathnameBase).pathname:He.pathnameBase])})),m,t,a);return e&&Ce?We.createElement(C_.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...$},navigationType:"POP"}},Ce):Ce}function mR(){let r=SR(),e=oR(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,a="rgba(200,200,200, 0.5)",d={padding:"0.5rem",backgroundColor:a},m={padding:"2px 4px",backgroundColor:a},y=null;return console.error("Error handled by React Router default ErrorBoundary:",r),y=We.createElement(We.Fragment,null,We.createElement("p",null," Hey developer "),We.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",We.createElement("code",{style:m},"ErrorBoundary")," or"," ",We.createElement("code",{style:m},"errorElement")," prop on your route.")),We.createElement(We.Fragment,null,We.createElement("h2",null,"Unexpected Application Error!"),We.createElement("h3",{style:{fontStyle:"italic"}},e),t?We.createElement("pre",{style:d},t):null,y)}var gR=We.createElement(mR,null),yR=class extends We.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?We.createElement(ud.Provider,{value:this.props.routeContext},We.createElement(N1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function _R({routeContext:r,match:e,children:t}){let a=We.useContext(mg);return a&&a.static&&a.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=e.route.id),We.createElement(ud.Provider,{value:r},t)}function vR(r,e=[],t=null,a=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let d=r,m=t==null?void 0:t.errors;if(m!=null){let M=d.findIndex(R=>R.route.id&&(m==null?void 0:m[R.route.id])!==void 0);ea(M>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(m).join(",")}`),d=d.slice(0,Math.min(d.length,M+1))}let y=!1,c=-1;if(t)for(let M=0;M<d.length;M++){let R=d[M];if((R.route.HydrateFallback||R.route.hydrateFallbackElement)&&(c=M),R.route.id){let{loaderData:B,errors:K}=t,$=R.route.loader&&!B.hasOwnProperty(R.route.id)&&(!K||K[R.route.id]===void 0);if(R.route.lazy||$){y=!0,c>=0?d=d.slice(0,c+1):d=[d[0]];break}}}return d.reduceRight((M,R,B)=>{let K,$=!1,W=null,re=null;t&&(K=m&&R.route.id?m[R.route.id]:void 0,W=R.route.errorElement||gR,y&&(c<0&&B===0?(KE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),$=!0,re=null):c===B&&($=!0,re=R.route.hydrateFallbackElement||null)));let Me=e.concat(d.slice(0,B+1)),Ce=()=>{let Be;return K?Be=W:$?Be=re:R.route.Component?Be=We.createElement(R.route.Component,null):R.route.element?Be=R.route.element:Be=M,We.createElement(_R,{match:R,routeContext:{outlet:M,matches:Me,isDataRoute:t!=null},children:Be})};return t&&(R.route.ErrorBoundary||R.route.errorElement||B===0)?We.createElement(yR,{location:t.location,revalidation:t.revalidation,component:W,error:K,children:Ce(),routeContext:{outlet:null,matches:Me,isDataRoute:!0}}):Ce()},null)}function B1(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function bR(r){let e=We.useContext(mg);return ea(e,B1(r)),e}function xR(r){let e=We.useContext(F0);return ea(e,B1(r)),e}function wR(r){let e=We.useContext(ud);return ea(e,B1(r)),e}function F1(r){let e=wR(r),t=e.matches[e.matches.length-1];return ea(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function TR(){return F1("useRouteId")}function SR(){var a;let r=We.useContext(N1),e=xR("useRouteError"),t=F1("useRouteError");return r!==void 0?r:(a=e.errors)==null?void 0:a[t]}function ER(){let{router:r}=bR("useNavigate"),e=F1("useNavigate"),t=We.useRef(!1);return ZE(()=>{t.current=!0}),We.useCallback(async(d,m={})=>{pc(t.current,HE),t.current&&(typeof d=="number"?r.navigate(d):await r.navigate(d,{fromRouteId:e,...m}))},[r,e])}var j2={};function KE(r,e,t){!e&&!j2[r]&&(j2[r]=!0,pc(!1,t))}We.memo(AR);function AR({routes:r,future:e,state:t}){return WE(r,void 0,t,e)}function eo(r){ea(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function CR({basename:r="/",children:e=null,location:t,navigationType:a="POP",navigator:d,static:m=!1}){ea(!I_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let y=r.replace(/^\/*/,"/"),c=We.useMemo(()=>({basename:y,navigator:d,static:m,future:{}}),[y,d,m]);typeof t=="string"&&(t=Hp(t));let{pathname:M="/",search:R="",hash:B="",state:K=null,key:$="default"}=t,W=We.useMemo(()=>{let re=ed(M,y);return re==null?null:{location:{pathname:re,search:R,hash:B,state:K,key:$},navigationType:a}},[y,M,R,B,K,$,a]);return pc(W!=null,`<Router basename="${y}"> is not able to match the URL "${M}${R}${B}" because it does not start with the basename, so the <Router> won't render anything.`),W==null?null:We.createElement(ph.Provider,{value:c},We.createElement(C_.Provider,{children:e,value:W}))}function IR({children:r,location:e}){return pR(Cx(r),e)}function Cx(r,e=[]){let t=[];return We.Children.forEach(r,(a,d)=>{if(!We.isValidElement(a))return;let m=[...e,d];if(a.type===We.Fragment){t.push.apply(t,Cx(a.props.children,m));return}ea(a.type===eo,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ea(!a.props.index||!a.props.children,"An index route cannot have child routes.");let y={id:a.props.id||m.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(y.children=Cx(a.props.children,m)),t.push(y)}),t}var qv="get",$v="application/x-www-form-urlencoded";function V0(r){return r!=null&&typeof r.tagName=="string"}function MR(r){return V0(r)&&r.tagName.toLowerCase()==="button"}function PR(r){return V0(r)&&r.tagName.toLowerCase()==="form"}function RR(r){return V0(r)&&r.tagName.toLowerCase()==="input"}function kR(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function DR(r,e){return r.button===0&&(!e||e==="_self")&&!kR(r)}var Iv=null;function LR(){if(Iv===null)try{new FormData(document.createElement("form"),0),Iv=!1}catch{Iv=!0}return Iv}var zR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Wb(r){return r!=null&&!zR.has(r)?(pc(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${$v}"`),null):r}function OR(r,e){let t,a,d,m,y;if(PR(r)){let c=r.getAttribute("action");a=c?ed(c,e):null,t=r.getAttribute("method")||qv,d=Wb(r.getAttribute("enctype"))||$v,m=new FormData(r)}else if(MR(r)||RR(r)&&(r.type==="submit"||r.type==="image")){let c=r.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let M=r.getAttribute("formaction")||c.getAttribute("action");if(a=M?ed(M,e):null,t=r.getAttribute("formmethod")||c.getAttribute("method")||qv,d=Wb(r.getAttribute("formenctype"))||Wb(c.getAttribute("enctype"))||$v,m=new FormData(c,r),!LR()){let{name:R,type:B,value:K}=r;if(B==="image"){let $=R?`${R}.`:"";m.append(`${$}x`,"0"),m.append(`${$}y`,"0")}else R&&m.append(R,K)}}else{if(V0(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=qv,a=null,d=$v,y=r}return m&&d==="text/plain"&&(y=m,m=void 0),{action:a,method:t.toLowerCase(),encType:d,formData:m,body:y}}function V1(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}async function NR(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function BR(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function FR(r,e,t){let a=await Promise.all(r.map(async d=>{let m=e.routes[d.route.id];if(m){let y=await NR(m,t);return y.links?y.links():[]}return[]}));return qR(a.flat(1).filter(BR).filter(d=>d.rel==="stylesheet"||d.rel==="preload").map(d=>d.rel==="stylesheet"?{...d,rel:"prefetch",as:"style"}:{...d,rel:"prefetch"}))}function U2(r,e,t,a,d,m){let y=(M,R)=>t[R]?M.route.id!==t[R].route.id:!0,c=(M,R)=>{var B;return t[R].pathname!==M.pathname||((B=t[R].route.path)==null?void 0:B.endsWith("*"))&&t[R].params["*"]!==M.params["*"]};return m==="assets"?e.filter((M,R)=>y(M,R)||c(M,R)):m==="data"?e.filter((M,R)=>{var K;let B=a.routes[M.route.id];if(!B||!B.hasLoader)return!1;if(y(M,R)||c(M,R))return!0;if(M.route.shouldRevalidate){let $=M.route.shouldRevalidate({currentUrl:new URL(d.pathname+d.search+d.hash,window.origin),currentParams:((K=t[0])==null?void 0:K.params)||{},nextUrl:new URL(r,window.origin),nextParams:M.params,defaultShouldRevalidate:!0});if(typeof $=="boolean")return $}return!0}):[]}function VR(r,e,{includeHydrateFallback:t}={}){return jR(r.map(a=>{let d=e.routes[a.route.id];if(!d)return[];let m=[d.module];return d.clientActionModule&&(m=m.concat(d.clientActionModule)),d.clientLoaderModule&&(m=m.concat(d.clientLoaderModule)),t&&d.hydrateFallbackModule&&(m=m.concat(d.hydrateFallbackModule)),d.imports&&(m=m.concat(d.imports)),m}).flat(1))}function jR(r){return[...new Set(r)]}function UR(r){let e={},t=Object.keys(r).sort();for(let a of t)e[a]=r[a];return e}function qR(r,e){let t=new Set;return new Set(e),r.reduce((a,d)=>{let m=JSON.stringify(UR(d));return t.has(m)||(t.add(m),a.push({key:m,link:d})),a},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $R=new Set([100,101,204,205]);function GR(r,e){let t=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return t.pathname==="/"?t.pathname="_root.data":e&&ed(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function XE(){let r=We.useContext(mg);return V1(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function HR(){let r=We.useContext(F0);return V1(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var j1=We.createContext(void 0);j1.displayName="FrameworkContext";function YE(){let r=We.useContext(j1);return V1(r,"You must render this element inside a <HydratedRouter> element"),r}function ZR(r,e){let t=We.useContext(j1),[a,d]=We.useState(!1),[m,y]=We.useState(!1),{onFocus:c,onBlur:M,onMouseEnter:R,onMouseLeave:B,onTouchStart:K}=e,$=We.useRef(null);We.useEffect(()=>{if(r==="render"&&y(!0),r==="viewport"){let Me=Be=>{Be.forEach(He=>{y(He.isIntersecting)})},Ce=new IntersectionObserver(Me,{threshold:.5});return $.current&&Ce.observe($.current),()=>{Ce.disconnect()}}},[r]),We.useEffect(()=>{if(a){let Me=setTimeout(()=>{y(!0)},100);return()=>{clearTimeout(Me)}}},[a]);let W=()=>{d(!0)},re=()=>{d(!1),y(!1)};return t?r!=="intent"?[m,$,{}]:[m,$,{onFocus:By(c,W),onBlur:By(M,re),onMouseEnter:By(R,W),onMouseLeave:By(B,re),onTouchStart:By(K,W)}]:[!1,$,{}]}function By(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function WR({page:r,...e}){let{router:t}=XE(),a=We.useMemo(()=>FE(t.routes,r,t.basename),[t.routes,r,t.basename]);return a?We.createElement(XR,{page:r,matches:a,...e}):null}function KR(r){let{manifest:e,routeModules:t}=YE(),[a,d]=We.useState([]);return We.useEffect(()=>{let m=!1;return FR(r,e,t).then(y=>{m||d(y)}),()=>{m=!0}},[r,e,t]),a}function XR({page:r,matches:e,...t}){let a=Zp(),{manifest:d,routeModules:m}=YE(),{basename:y}=XE(),{loaderData:c,matches:M}=HR(),R=We.useMemo(()=>U2(r,e,M,d,a,"data"),[r,e,M,d,a]),B=We.useMemo(()=>U2(r,e,M,d,a,"assets"),[r,e,M,d,a]),K=We.useMemo(()=>{if(r===a.pathname+a.search+a.hash)return[];let re=new Set,Me=!1;if(e.forEach(Be=>{var ut;let He=d.routes[Be.route.id];!He||!He.hasLoader||(!R.some(Ue=>Ue.route.id===Be.route.id)&&Be.route.id in c&&((ut=m[Be.route.id])!=null&&ut.shouldRevalidate)||He.hasClientLoader?Me=!0:re.add(Be.route.id))}),re.size===0)return[];let Ce=GR(r,y);return Me&&re.size>0&&Ce.searchParams.set("_routes",e.filter(Be=>re.has(Be.route.id)).map(Be=>Be.route.id).join(",")),[Ce.pathname+Ce.search]},[y,c,a,d,R,e,r,m]),$=We.useMemo(()=>VR(B,d),[B,d]),W=KR(B);return We.createElement(We.Fragment,null,K.map(re=>We.createElement("link",{key:re,rel:"prefetch",as:"fetch",href:re,...t})),$.map(re=>We.createElement("link",{key:re,rel:"modulepreload",href:re,...t})),W.map(({key:re,link:Me})=>We.createElement("link",{key:re,...Me})))}function YR(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var QE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{QE&&(window.__reactRouterVersion="7.6.2")}catch{}function QR({basename:r,children:e,window:t}){let a=We.useRef();a.current==null&&(a.current=BP({window:t,v5Compat:!0}));let d=a.current,[m,y]=We.useState({action:d.action,location:d.location}),c=We.useCallback(M=>{We.startTransition(()=>y(M))},[y]);return We.useLayoutEffect(()=>d.listen(c),[d,c]),We.createElement(CR,{basename:r,children:e,location:m.location,navigationType:m.action,navigator:d})}var JE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mo=We.forwardRef(function({onClick:e,discover:t="render",prefetch:a="none",relative:d,reloadDocument:m,replace:y,state:c,target:M,to:R,preventScrollReset:B,viewTransition:K,...$},W){let{basename:re}=We.useContext(ph),Me=typeof R=="string"&&JE.test(R),Ce,Be=!1;if(typeof R=="string"&&Me&&(Ce=R,QE))try{let ye=new URL(window.location.href),we=R.startsWith("//")?new URL(ye.protocol+R):new URL(R),Ee=ed(we.pathname,re);we.origin===ye.origin&&Ee!=null?R=Ee+we.search+we.hash:Be=!0}catch{pc(!1,`<Link to="${R}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let He=hR(R,{relative:d}),[ut,Ue,Fe]=ZR(a,$),Ze=nk(R,{replace:y,state:c,target:M,preventScrollReset:B,relative:d,viewTransition:K});function me(ye){e&&e(ye),ye.defaultPrevented||Ze(ye)}let se=We.createElement("a",{...$,...Fe,href:Ce||He,onClick:Be||m?e:me,ref:YR(W,Ue),target:M,"data-discover":!Me&&t==="render"?"true":void 0});return ut&&!Me?We.createElement(We.Fragment,null,se,We.createElement(WR,{page:He})):se});Mo.displayName="Link";var JR=We.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:a="",end:d=!1,style:m,to:y,viewTransition:c,children:M,...R},B){let K=M_(y,{relative:R.relative}),$=Zp(),W=We.useContext(F0),{navigator:re,basename:Me}=We.useContext(ph),Ce=W!=null&&ok(K)&&c===!0,Be=re.encodeLocation?re.encodeLocation(K).pathname:K.pathname,He=$.pathname,ut=W&&W.navigation&&W.navigation.location?W.navigation.location.pathname:null;t||(He=He.toLowerCase(),ut=ut?ut.toLowerCase():null,Be=Be.toLowerCase()),ut&&Me&&(ut=ed(ut,Me)||ut);const Ue=Be!=="/"&&Be.endsWith("/")?Be.length-1:Be.length;let Fe=He===Be||!d&&He.startsWith(Be)&&He.charAt(Ue)==="/",Ze=ut!=null&&(ut===Be||!d&&ut.startsWith(Be)&&ut.charAt(Be.length)==="/"),me={isActive:Fe,isPending:Ze,isTransitioning:Ce},se=Fe?e:void 0,ye;typeof a=="function"?ye=a(me):ye=[a,Fe?"active":null,Ze?"pending":null,Ce?"transitioning":null].filter(Boolean).join(" ");let we=typeof m=="function"?m(me):m;return We.createElement(Mo,{...R,"aria-current":se,className:ye,ref:B,style:we,to:y,viewTransition:c},typeof M=="function"?M(me):M)});JR.displayName="NavLink";var ek=We.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:a,replace:d,state:m,method:y=qv,action:c,onSubmit:M,relative:R,preventScrollReset:B,viewTransition:K,...$},W)=>{let re=ak(),Me=sk(c,{relative:R}),Ce=y.toLowerCase()==="get"?"get":"post",Be=typeof c=="string"&&JE.test(c),He=ut=>{if(M&&M(ut),ut.defaultPrevented)return;ut.preventDefault();let Ue=ut.nativeEvent.submitter,Fe=(Ue==null?void 0:Ue.getAttribute("formmethod"))||y;re(Ue||ut.currentTarget,{fetcherKey:e,method:Fe,navigate:t,replace:d,state:m,relative:R,preventScrollReset:B,viewTransition:K})};return We.createElement("form",{ref:W,method:Ce,action:Me,onSubmit:a?M:He,...$,"data-discover":!Be&&r==="render"?"true":void 0})});ek.displayName="Form";function tk(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function eA(r){let e=We.useContext(mg);return ea(e,tk(r)),e}function nk(r,{target:e,replace:t,state:a,preventScrollReset:d,relative:m,viewTransition:y}={}){let c=dR(),M=Zp(),R=M_(r,{relative:m});return We.useCallback(B=>{if(DR(B,e)){B.preventDefault();let K=t!==void 0?t:a_(M)===a_(R);c(r,{replace:K,state:a,preventScrollReset:d,relative:m,viewTransition:y})}},[M,c,R,t,a,e,r,d,m,y])}var rk=0,ik=()=>`__${String(++rk)}__`;function ak(){let{router:r}=eA("useSubmit"),{basename:e}=We.useContext(ph),t=TR();return We.useCallback(async(a,d={})=>{let{action:m,method:y,encType:c,formData:M,body:R}=OR(a,e);if(d.navigate===!1){let B=d.fetcherKey||ik();await r.fetch(B,t,d.action||m,{preventScrollReset:d.preventScrollReset,formData:M,body:R,formMethod:d.method||y,formEncType:d.encType||c,flushSync:d.flushSync})}else await r.navigate(d.action||m,{preventScrollReset:d.preventScrollReset,formData:M,body:R,formMethod:d.method||y,formEncType:d.encType||c,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[r,e,t])}function sk(r,{relative:e}={}){let{basename:t}=We.useContext(ph),a=We.useContext(ud);ea(a,"useFormAction must be used inside a RouteContext");let[d]=a.matches.slice(-1),m={...M_(r||".",{relative:e})},y=Zp();if(r==null){m.search=y.search;let c=new URLSearchParams(m.search),M=c.getAll("index");if(M.some(B=>B==="")){c.delete("index"),M.filter(K=>K).forEach(K=>c.append("index",K));let B=c.toString();m.search=B?`?${B}`:""}}return(!r||r===".")&&d.route.index&&(m.search=m.search?m.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(m.pathname=m.pathname==="/"?t:Kh([t,m.pathname])),a_(m)}function ok(r,e={}){let t=We.useContext(GE);ea(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=eA("useViewTransitionState"),d=M_(r,{relative:e.relative});if(!t.isTransitioning)return!1;let m=ed(t.currentLocation.pathname,a)||t.currentLocation.pathname,y=ed(t.nextLocation.pathname,a)||t.nextLocation.pathname;return o0(d.pathname,y)!=null||o0(d.pathname,m)!=null}[...$R];const lk=()=>{};var q2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA=function(r){const e=[];let t=0;for(let a=0;a<r.length;a++){let d=r.charCodeAt(a);d<128?e[t++]=d:d<2048?(e[t++]=d>>6|192,e[t++]=d&63|128):(d&64512)===55296&&a+1<r.length&&(r.charCodeAt(a+1)&64512)===56320?(d=65536+((d&1023)<<10)+(r.charCodeAt(++a)&1023),e[t++]=d>>18|240,e[t++]=d>>12&63|128,e[t++]=d>>6&63|128,e[t++]=d&63|128):(e[t++]=d>>12|224,e[t++]=d>>6&63|128,e[t++]=d&63|128)}return e},uk=function(r){const e=[];let t=0,a=0;for(;t<r.length;){const d=r[t++];if(d<128)e[a++]=String.fromCharCode(d);else if(d>191&&d<224){const m=r[t++];e[a++]=String.fromCharCode((d&31)<<6|m&63)}else if(d>239&&d<365){const m=r[t++],y=r[t++],c=r[t++],M=((d&7)<<18|(m&63)<<12|(y&63)<<6|c&63)-65536;e[a++]=String.fromCharCode(55296+(M>>10)),e[a++]=String.fromCharCode(56320+(M&1023))}else{const m=r[t++],y=r[t++];e[a++]=String.fromCharCode((d&15)<<12|(m&63)<<6|y&63)}}return e.join("")},nA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let d=0;d<r.length;d+=3){const m=r[d],y=d+1<r.length,c=y?r[d+1]:0,M=d+2<r.length,R=M?r[d+2]:0,B=m>>2,K=(m&3)<<4|c>>4;let $=(c&15)<<2|R>>6,W=R&63;M||(W=64,y||($=64)),a.push(t[B],t[K],t[$],t[W])}return a.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(tA(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):uk(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let d=0;d<r.length;){const m=t[r.charAt(d++)],c=d<r.length?t[r.charAt(d)]:0;++d;const R=d<r.length?t[r.charAt(d)]:64;++d;const K=d<r.length?t[r.charAt(d)]:64;if(++d,m==null||c==null||R==null||K==null)throw new ck;const $=m<<2|c>>4;if(a.push($),R!==64){const W=c<<4&240|R>>2;if(a.push(W),K!==64){const re=R<<6&192|K;a.push(re)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class ck extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hk=function(r){const e=tA(r);return nA.encodeByteArray(e,!0)},l0=function(r){return hk(r).replace(/\./g,"")},rA=function(r){try{return nA.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fk=()=>dk().__FIREBASE_DEFAULTS__,pk=()=>{if(typeof process>"u"||typeof q2>"u")return;const r=q2.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},mk=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&rA(r[1]);return e&&JSON.parse(e)},j0=()=>{try{return lk()||fk()||pk()||mk()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},iA=r=>{var e,t;return(t=(e=j0())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},gk=r=>{const e=iA(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},aA=()=>{var r;return(r=j0())===null||r===void 0?void 0:r.config},sA=r=>{var e;return(e=j0())===null||e===void 0?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(r){return r.endsWith(".cloudworkstations.dev")}async function oA(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",d=r.iat||0,m=r.sub||r.user_id;if(!m)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const y=Object.assign({iss:`https://securetoken.google.com/${a}`,aud:a,iat:d,exp:d+3600,auth_time:d,sub:m,user_id:m,firebase:{sign_in_provider:"custom",identities:{}}},r);return[l0(JSON.stringify(t)),l0(JSON.stringify(y)),""].join(".")}const Zy={};function vk(){const r={prod:[],emulator:[]};for(const e of Object.keys(Zy))Zy[e]?r.emulator.push(e):r.prod.push(e);return r}function bk(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let $2=!1;function lA(r,e){if(typeof window>"u"||typeof document>"u"||!P_(window.location.host)||Zy[r]===e||Zy[r]||$2)return;Zy[r]=e;function t($){return`__firebase__banner__${$}`}const a="__firebase__banner",m=vk().prod.length>0;function y(){const $=document.getElementById(a);$&&$.remove()}function c($){$.style.display="flex",$.style.background="#7faaf0",$.style.position="fixed",$.style.bottom="5px",$.style.left="5px",$.style.padding=".5em",$.style.borderRadius="5px",$.style.alignItems="center"}function M($,W){$.setAttribute("width","24"),$.setAttribute("id",W),$.setAttribute("height","24"),$.setAttribute("viewBox","0 0 24 24"),$.setAttribute("fill","none"),$.style.marginLeft="-6px"}function R(){const $=document.createElement("span");return $.style.cursor="pointer",$.style.marginLeft="16px",$.style.fontSize="24px",$.innerHTML=" &times;",$.onclick=()=>{$2=!0,y()},$}function B($,W){$.setAttribute("id",W),$.innerText="Learn more",$.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",$.setAttribute("target","__blank"),$.style.paddingLeft="5px",$.style.textDecoration="underline"}function K(){const $=bk(a),W=t("text"),re=document.getElementById(W)||document.createElement("span"),Me=t("learnmore"),Ce=document.getElementById(Me)||document.createElement("a"),Be=t("preprendIcon"),He=document.getElementById(Be)||document.createElementNS("http://www.w3.org/2000/svg","svg");if($.created){const ut=$.element;c(ut),B(Ce,Me);const Ue=R();M(He,Be),ut.append(He,re,Ce,Ue),document.body.appendChild(ut)}m?(re.innerText="Preview backend disconnected.",He.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(He.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,re.innerText="Preview backend running in this workspace."),re.setAttribute("id",W)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",K):K()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ro())}function wk(){var r;const e=(r=j0())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Tk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Sk(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function Ek(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ak(){const r=ro();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function Ck(){return!wk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ik(){try{return typeof indexedDB=="object"}catch{return!1}}function Mk(){return new Promise((r,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",d=self.indexedDB.open(a);d.onsuccess=()=>{d.result.close(),t||self.indexedDB.deleteDatabase(a),r(!0)},d.onupgradeneeded=()=>{t=!1},d.onerror=()=>{var m;e(((m=d.error)===null||m===void 0?void 0:m.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk="FirebaseError";class cd extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=Pk,Object.setPrototypeOf(this,cd.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R_.prototype.create)}}class R_{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},d=`${this.service}/${e}`,m=this.errors[e],y=m?Rk(m,a):"Error",c=`${this.serviceName}: ${y} (${d}).`;return new cd(d,c,a)}}function Rk(r,e){return r.replace(kk,(t,a)=>{const d=e[a];return d!=null?String(d):`<${a}?>`})}const kk=/\{\$([^}]+)}/g;function Dk(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Op(r,e){if(r===e)return!0;const t=Object.keys(r),a=Object.keys(e);for(const d of t){if(!a.includes(d))return!1;const m=r[d],y=e[d];if(G2(m)&&G2(y)){if(!Op(m,y))return!1}else if(m!==y)return!1}for(const d of a)if(!t.includes(d))return!1;return!0}function G2(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(r){const e=[];for(const[t,a]of Object.entries(r))Array.isArray(a)?a.forEach(d=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(d))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function Fy(r){const e={};return r.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[d,m]=a.split("=");e[decodeURIComponent(d)]=decodeURIComponent(m)}}),e}function Vy(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function Lk(r,e){const t=new zk(r,e);return t.subscribe.bind(t)}class zk{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let d;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");Ok(e,["next","error","complete"])?d=e:d={next:e,error:t,complete:a},d.next===void 0&&(d.next=Kb),d.error===void 0&&(d.error=Kb),d.complete===void 0&&(d.complete=Kb);const m=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?d.error(this.finalError):d.complete()}catch{}}),this.observers.push(d),m}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ok(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function Kb(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(r){return r&&r._delegate?r._delegate:r}class Np{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new yk;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const d=this.getOrInitializeService({instanceIdentifier:t});d&&a.resolve(d)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const a=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),d=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(a)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:a})}catch(m){if(d)return null;throw m}else{if(d)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Fk(e))try{this.getOrInitializeService({instanceIdentifier:Ep})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(t);try{const m=this.getOrInitializeService({instanceIdentifier:d});a.resolve(m)}catch{}}}}clearInstance(e=Ep){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ep){return this.instances.has(e)}getOptions(e=Ep){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const d=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[m,y]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(m);a===c&&y.resolve(d)}return d}onInit(e,t){var a;const d=this.normalizeInstanceIdentifier(t),m=(a=this.onInitCallbacks.get(d))!==null&&a!==void 0?a:new Set;m.add(e),this.onInitCallbacks.set(d,m);const y=this.instances.get(d);return y&&e(y,d),()=>{m.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const d of a)try{d(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:Bk(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=Ep){return this.component?this.component.multipleInstances?e:Ep:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Bk(r){return r===Ep?void 0:r}function Fk(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Nk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lr;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(lr||(lr={}));const jk={debug:lr.DEBUG,verbose:lr.VERBOSE,info:lr.INFO,warn:lr.WARN,error:lr.ERROR,silent:lr.SILENT},Uk=lr.INFO,qk={[lr.DEBUG]:"log",[lr.VERBOSE]:"log",[lr.INFO]:"info",[lr.WARN]:"warn",[lr.ERROR]:"error"},$k=(r,e,...t)=>{if(e<r.logLevel)return;const a=new Date().toISOString(),d=qk[e];if(d)console[d](`[${a}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class U1{constructor(e){this.name=e,this._logLevel=Uk,this._logHandler=$k,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in lr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,lr.DEBUG,...e),this._logHandler(this,lr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,lr.VERBOSE,...e),this._logHandler(this,lr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,lr.INFO,...e),this._logHandler(this,lr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,lr.WARN,...e),this._logHandler(this,lr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,lr.ERROR,...e),this._logHandler(this,lr.ERROR,...e)}}const Gk=(r,e)=>e.some(t=>r instanceof t);let H2,Z2;function Hk(){return H2||(H2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Zk(){return Z2||(Z2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const uA=new WeakMap,Ix=new WeakMap,cA=new WeakMap,Xb=new WeakMap,q1=new WeakMap;function Wk(r){const e=new Promise((t,a)=>{const d=()=>{r.removeEventListener("success",m),r.removeEventListener("error",y)},m=()=>{t(uf(r.result)),d()},y=()=>{a(r.error),d()};r.addEventListener("success",m),r.addEventListener("error",y)});return e.then(t=>{t instanceof IDBCursor&&uA.set(t,r)}).catch(()=>{}),q1.set(e,r),e}function Kk(r){if(Ix.has(r))return;const e=new Promise((t,a)=>{const d=()=>{r.removeEventListener("complete",m),r.removeEventListener("error",y),r.removeEventListener("abort",y)},m=()=>{t(),d()},y=()=>{a(r.error||new DOMException("AbortError","AbortError")),d()};r.addEventListener("complete",m),r.addEventListener("error",y),r.addEventListener("abort",y)});Ix.set(r,e)}let Mx={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Ix.get(r);if(e==="objectStoreNames")return r.objectStoreNames||cA.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return uf(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function Xk(r){Mx=r(Mx)}function Yk(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=r.call(Yb(this),e,...t);return cA.set(a,e.sort?e.sort():[e]),uf(a)}:Zk().includes(r)?function(...e){return r.apply(Yb(this),e),uf(uA.get(this))}:function(...e){return uf(r.apply(Yb(this),e))}}function Qk(r){return typeof r=="function"?Yk(r):(r instanceof IDBTransaction&&Kk(r),Gk(r,Hk())?new Proxy(r,Mx):r)}function uf(r){if(r instanceof IDBRequest)return Wk(r);if(Xb.has(r))return Xb.get(r);const e=Qk(r);return e!==r&&(Xb.set(r,e),q1.set(e,r)),e}const Yb=r=>q1.get(r);function Jk(r,e,{blocked:t,upgrade:a,blocking:d,terminated:m}={}){const y=indexedDB.open(r,e),c=uf(y);return a&&y.addEventListener("upgradeneeded",M=>{a(uf(y.result),M.oldVersion,M.newVersion,uf(y.transaction),M)}),t&&y.addEventListener("blocked",M=>t(M.oldVersion,M.newVersion,M)),c.then(M=>{m&&M.addEventListener("close",()=>m()),d&&M.addEventListener("versionchange",R=>d(R.oldVersion,R.newVersion,R))}).catch(()=>{}),c}const eD=["get","getKey","getAll","getAllKeys","count"],tD=["put","add","delete","clear"],Qb=new Map;function W2(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Qb.get(e))return Qb.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,d=tD.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(d||eD.includes(t)))return;const m=async function(y,...c){const M=this.transaction(y,d?"readwrite":"readonly");let R=M.store;return a&&(R=R.index(c.shift())),(await Promise.all([R[t](...c),d&&M.done]))[0]};return Qb.set(e,m),m}Xk(r=>({...r,get:(e,t,a)=>W2(e,t)||r.get(e,t,a),has:(e,t)=>!!W2(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(rD(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function rD(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Px="@firebase/app",K2="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td=new U1("@firebase/app"),iD="@firebase/app-compat",aD="@firebase/analytics-compat",sD="@firebase/analytics",oD="@firebase/app-check-compat",lD="@firebase/app-check",uD="@firebase/auth",cD="@firebase/auth-compat",hD="@firebase/database",dD="@firebase/data-connect",fD="@firebase/database-compat",pD="@firebase/functions",mD="@firebase/functions-compat",gD="@firebase/installations",yD="@firebase/installations-compat",_D="@firebase/messaging",vD="@firebase/messaging-compat",bD="@firebase/performance",xD="@firebase/performance-compat",wD="@firebase/remote-config",TD="@firebase/remote-config-compat",SD="@firebase/storage",ED="@firebase/storage-compat",AD="@firebase/firestore",CD="@firebase/ai",ID="@firebase/firestore-compat",MD="firebase",PD="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rx="[DEFAULT]",RD={[Px]:"fire-core",[iD]:"fire-core-compat",[sD]:"fire-analytics",[aD]:"fire-analytics-compat",[lD]:"fire-app-check",[oD]:"fire-app-check-compat",[uD]:"fire-auth",[cD]:"fire-auth-compat",[hD]:"fire-rtdb",[dD]:"fire-data-connect",[fD]:"fire-rtdb-compat",[pD]:"fire-fn",[mD]:"fire-fn-compat",[gD]:"fire-iid",[yD]:"fire-iid-compat",[_D]:"fire-fcm",[vD]:"fire-fcm-compat",[bD]:"fire-perf",[xD]:"fire-perf-compat",[wD]:"fire-rc",[TD]:"fire-rc-compat",[SD]:"fire-gcs",[ED]:"fire-gcs-compat",[AD]:"fire-fst",[ID]:"fire-fst-compat",[CD]:"fire-vertex","fire-js":"fire-js",[MD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=new Map,kD=new Map,kx=new Map;function X2(r,e){try{r.container.addComponent(e)}catch(t){td.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ig(r){const e=r.name;if(kx.has(e))return td.debug(`There were multiple attempts to register component ${e}.`),!1;kx.set(e,r);for(const t of u0.values())X2(t,r);for(const t of kD.values())X2(t,r);return!0}function $1(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function gu(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cf=new R_("app","Firebase",DD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e,t,a){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new Np("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cf.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg=PD;function hA(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const a=Object.assign({name:Rx,automaticDataCollectionEnabled:!0},e),d=a.name;if(typeof d!="string"||!d)throw cf.create("bad-app-name",{appName:String(d)});if(t||(t=aA()),!t)throw cf.create("no-options");const m=u0.get(d);if(m){if(Op(t,m.options)&&Op(a,m.config))return m;throw cf.create("duplicate-app",{appName:d})}const y=new Vk(d);for(const M of kx.values())y.addComponent(M);const c=new LD(t,a,y);return u0.set(d,c),c}function dA(r=Rx){const e=u0.get(r);if(!e&&r===Rx&&aA())return hA();if(!e)throw cf.create("no-app",{appName:r});return e}function hf(r,e,t){var a;let d=(a=RD[r])!==null&&a!==void 0?a:r;t&&(d+=`-${t}`);const m=d.match(/\s|\//),y=e.match(/\s|\//);if(m||y){const c=[`Unable to register library "${d}" with version "${e}":`];m&&c.push(`library name "${d}" contains illegal characters (whitespace or "/")`),m&&y&&c.push("and"),y&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),td.warn(c.join(" "));return}ig(new Np(`${d}-version`,()=>({library:d,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD="firebase-heartbeat-database",OD=1,s_="firebase-heartbeat-store";let Jb=null;function fA(){return Jb||(Jb=Jk(zD,OD,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(s_)}catch(t){console.warn(t)}}}}).catch(r=>{throw cf.create("idb-open",{originalErrorMessage:r.message})})),Jb}async function ND(r){try{const t=(await fA()).transaction(s_),a=await t.objectStore(s_).get(pA(r));return await t.done,a}catch(e){if(e instanceof cd)td.warn(e.message);else{const t=cf.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});td.warn(t.message)}}}async function Y2(r,e){try{const a=(await fA()).transaction(s_,"readwrite");await a.objectStore(s_).put(e,pA(r)),await a.done}catch(t){if(t instanceof cd)td.warn(t.message);else{const a=cf.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});td.warn(a.message)}}}function pA(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=1024,FD=30;class VD{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new UD(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const d=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),m=Q2();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===m||this._heartbeatsCache.heartbeats.some(y=>y.date===m))return;if(this._heartbeatsCache.heartbeats.push({date:m,agent:d}),this._heartbeatsCache.heartbeats.length>FD){const y=qD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(y,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){td.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Q2(),{heartbeatsToSend:a,unsentEntries:d}=jD(this._heartbeatsCache.heartbeats),m=l0(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,d.length>0?(this._heartbeatsCache.heartbeats=d,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),m}catch(t){return td.warn(t),""}}}function Q2(){return new Date().toISOString().substring(0,10)}function jD(r,e=BD){const t=[];let a=r.slice();for(const d of r){const m=t.find(y=>y.agent===d.agent);if(m){if(m.dates.push(d.date),J2(t)>e){m.dates.pop();break}}else if(t.push({agent:d.agent,dates:[d.date]}),J2(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class UD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ik()?Mk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ND(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const d=await this.read();return Y2(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:d.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const d=await this.read();return Y2(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:d.lastSentHeartbeatDate,heartbeats:[...d.heartbeats,...e.heartbeats]})}else return}}function J2(r){return l0(JSON.stringify({version:2,heartbeats:r})).length}function qD(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let a=1;a<r.length;a++)r[a].date<t&&(t=r[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $D(r){ig(new Np("platform-logger",e=>new nD(e),"PRIVATE")),ig(new Np("heartbeat",e=>new VD(e),"PRIVATE")),hf(Px,K2,r),hf(Px,K2,"esm2017"),hf("fire-js","")}$D("");var GD="firebase",HD="11.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hf(GD,HD,"app");function G1(r,e){var t={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&e.indexOf(a)<0&&(t[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,a=Object.getOwnPropertySymbols(r);d<a.length;d++)e.indexOf(a[d])<0&&Object.prototype.propertyIsEnumerable.call(r,a[d])&&(t[a[d]]=r[a[d]]);return t}function mA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZD=mA,gA=new R_("auth","Firebase",mA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0=new U1("@firebase/auth");function WD(r,...e){c0.logLevel<=lr.WARN&&c0.warn(`Auth (${gg}): ${r}`,...e)}function Gv(r,...e){c0.logLevel<=lr.ERROR&&c0.error(`Auth (${gg}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(r,...e){throw H1(r,...e)}function ih(r,...e){return H1(r,...e)}function yA(r,e,t){const a=Object.assign(Object.assign({},ZD()),{[e]:t});return new R_("auth","Firebase",a).create(e,{appName:r.name})}function Xh(r){return yA(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function H1(r,...e){if(typeof r!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=r.name),r._errorFactory.create(t,...a)}return gA.create(r,...e)}function Rn(r,e,...t){if(!r)throw H1(e,...t)}function Zh(r){const e="INTERNAL ASSERTION FAILED: "+r;throw Gv(e),new Error(e)}function nd(r,e){r||Zh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.href)||""}function KD(){return eT()==="http:"||eT()==="https:"}function eT(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(KD()||Sk()||"connection"in navigator)?navigator.onLine:!0}function YD(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(e,t){this.shortDelay=e,this.longDelay=t,nd(t>e,"Short delay should be less than long delay!"),this.isMobile=xk()||Ek()}get(){return XD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z1(r,e){nd(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Zh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Zh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Zh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],e5=new D_(3e4,6e4);function Tf(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}async function Sf(r,e,t,a,d={}){return vA(r,d,async()=>{let m={},y={};a&&(e==="GET"?y=a:m={body:JSON.stringify(a)});const c=k_(Object.assign({key:r.config.apiKey},y)).slice(1),M=await r._getAdditionalHeaders();M["Content-Type"]="application/json",r.languageCode&&(M["X-Firebase-Locale"]=r.languageCode);const R=Object.assign({method:e,headers:M},m);return Tk()||(R.referrerPolicy="no-referrer"),r.emulatorConfig&&P_(r.emulatorConfig.host)&&(R.credentials="include"),_A.fetch()(await bA(r,r.config.apiHost,t,c),R)})}async function vA(r,e,t){r._canInitEmulator=!1;const a=Object.assign(Object.assign({},QD),e);try{const d=new n5(r),m=await Promise.race([t(),d.promise]);d.clearNetworkTimeout();const y=await m.json();if("needConfirmation"in y)throw Mv(r,"account-exists-with-different-credential",y);if(m.ok&&!("errorMessage"in y))return y;{const c=m.ok?y.errorMessage:y.error.message,[M,R]=c.split(" : ");if(M==="FEDERATED_USER_ID_ALREADY_LINKED")throw Mv(r,"credential-already-in-use",y);if(M==="EMAIL_EXISTS")throw Mv(r,"email-already-in-use",y);if(M==="USER_DISABLED")throw Mv(r,"user-disabled",y);const B=a[M]||M.toLowerCase().replace(/[_\s]+/g,"-");if(R)throw yA(r,B,R);mc(r,B)}}catch(d){if(d instanceof cd)throw d;mc(r,"network-request-failed",{message:String(d)})}}async function L_(r,e,t,a,d={}){const m=await Sf(r,e,t,a,d);return"mfaPendingCredential"in m&&mc(r,"multi-factor-auth-required",{_serverResponse:m}),m}async function bA(r,e,t,a){const d=`${e}${t}?${a}`,m=r,y=m.config.emulator?Z1(r.config,d):`${r.config.apiScheme}://${d}`;return JD.includes(t)&&(await m._persistenceManagerAvailable,m._getPersistenceType()==="COOKIE")?m._getPersistence()._getFinalTarget(y).toString():y}function t5(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class n5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(ih(this.auth,"network-request-failed")),e5.get())})}}function Mv(r,e,t){const a={appName:r.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const d=ih(r,e,a);return d.customData._tokenResponse=t,d}function tT(r){return r!==void 0&&r.enterprise!==void 0}class r5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return t5(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function i5(r,e){return Sf(r,"GET","/v2/recaptchaConfig",Tf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a5(r,e){return Sf(r,"POST","/v1/accounts:delete",e)}async function h0(r,e){return Sf(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wy(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function s5(r,e=!1){const t=Rs(r),a=await t.getIdToken(e),d=W1(a);Rn(d&&d.exp&&d.auth_time&&d.iat,t.auth,"internal-error");const m=typeof d.firebase=="object"?d.firebase:void 0,y=m==null?void 0:m.sign_in_provider;return{claims:d,token:a,authTime:Wy(ex(d.auth_time)),issuedAtTime:Wy(ex(d.iat)),expirationTime:Wy(ex(d.exp)),signInProvider:y||null,signInSecondFactor:(m==null?void 0:m.sign_in_second_factor)||null}}function ex(r){return Number(r)*1e3}function W1(r){const[e,t,a]=r.split(".");if(e===void 0||t===void 0||a===void 0)return Gv("JWT malformed, contained fewer than 3 sections"),null;try{const d=rA(t);return d?JSON.parse(d):(Gv("Failed to decode base64 JWT payload"),null)}catch(d){return Gv("Caught error parsing JWT payload as JSON",d==null?void 0:d.toString()),null}}function nT(r){const e=W1(r);return Rn(e,"internal-error"),Rn(typeof e.exp<"u","internal-error"),Rn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o_(r,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof cd&&o5(a)&&r.auth.currentUser===r&&await r.auth.signOut(),a}}function o5({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const d=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,d)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wy(this.lastLoginAt),this.creationTime=Wy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d0(r){var e;const t=r.auth,a=await r.getIdToken(),d=await o_(r,h0(t,{idToken:a}));Rn(d==null?void 0:d.users.length,t,"internal-error");const m=d.users[0];r._notifyReloadListener(m);const y=!((e=m.providerUserInfo)===null||e===void 0)&&e.length?xA(m.providerUserInfo):[],c=c5(r.providerData,y),M=r.isAnonymous,R=!(r.email&&m.passwordHash)&&!(c!=null&&c.length),B=M?R:!1,K={uid:m.localId,displayName:m.displayName||null,photoURL:m.photoUrl||null,email:m.email||null,emailVerified:m.emailVerified||!1,phoneNumber:m.phoneNumber||null,tenantId:m.tenantId||null,providerData:c,metadata:new Lx(m.createdAt,m.lastLoginAt),isAnonymous:B};Object.assign(r,K)}async function u5(r){const e=Rs(r);await d0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function c5(r,e){return[...r.filter(a=>!e.some(d=>d.providerId===a.providerId)),...e]}function xA(r){return r.map(e=>{var{providerId:t}=e,a=G1(e,["providerId"]);return{providerId:t,uid:a.rawId||"",displayName:a.displayName||null,email:a.email||null,phoneNumber:a.phoneNumber||null,photoURL:a.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h5(r,e){const t=await vA(r,{},async()=>{const a=k_({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:d,apiKey:m}=r.config,y=await bA(r,d,"/v1/token",`key=${m}`),c=await r._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",_A.fetch()(y,{method:"POST",headers:c,body:a})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function d5(r,e){return Sf(r,"POST","/v2/accounts:revokeToken",Tf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rn(e.idToken,"internal-error"),Rn(typeof e.idToken<"u","internal-error"),Rn(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Rn(e.length!==0,"internal-error");const t=nT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Rn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:d,expiresIn:m}=await h5(e,t);this.updateTokensAndExpiration(a,d,Number(m))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:d,expirationTime:m}=t,y=new Xm;return a&&(Rn(typeof a=="string","internal-error",{appName:e}),y.refreshToken=a),d&&(Rn(typeof d=="string","internal-error",{appName:e}),y.accessToken=d),m&&(Rn(typeof m=="number","internal-error",{appName:e}),y.expirationTime=m),y}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xm,this.toJSON())}_performRefresh(){return Zh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(r,e){Rn(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class cc{constructor(e){var{uid:t,auth:a,stsTokenManager:d}=e,m=G1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new l5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=a,this.stsTokenManager=d,this.accessToken=d.accessToken,this.displayName=m.displayName||null,this.email=m.email||null,this.emailVerified=m.emailVerified||!1,this.phoneNumber=m.phoneNumber||null,this.photoURL=m.photoURL||null,this.isAnonymous=m.isAnonymous||!1,this.tenantId=m.tenantId||null,this.providerData=m.providerData?[...m.providerData]:[],this.metadata=new Lx(m.createdAt||void 0,m.lastLoginAt||void 0)}async getIdToken(e){const t=await o_(this,this.stsTokenManager.getToken(this.auth,e));return Rn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return s5(this,e)}reload(){return u5(this)}_assign(e){this!==e&&(Rn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new cc(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Rn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await d0(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gu(this.auth.app))return Promise.reject(Xh(this.auth));const e=await this.getIdToken();return await o_(this,a5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var a,d,m,y,c,M,R,B;const K=(a=t.displayName)!==null&&a!==void 0?a:void 0,$=(d=t.email)!==null&&d!==void 0?d:void 0,W=(m=t.phoneNumber)!==null&&m!==void 0?m:void 0,re=(y=t.photoURL)!==null&&y!==void 0?y:void 0,Me=(c=t.tenantId)!==null&&c!==void 0?c:void 0,Ce=(M=t._redirectEventId)!==null&&M!==void 0?M:void 0,Be=(R=t.createdAt)!==null&&R!==void 0?R:void 0,He=(B=t.lastLoginAt)!==null&&B!==void 0?B:void 0,{uid:ut,emailVerified:Ue,isAnonymous:Fe,providerData:Ze,stsTokenManager:me}=t;Rn(ut&&me,e,"internal-error");const se=Xm.fromJSON(this.name,me);Rn(typeof ut=="string",e,"internal-error"),Jd(K,e.name),Jd($,e.name),Rn(typeof Ue=="boolean",e,"internal-error"),Rn(typeof Fe=="boolean",e,"internal-error"),Jd(W,e.name),Jd(re,e.name),Jd(Me,e.name),Jd(Ce,e.name),Jd(Be,e.name),Jd(He,e.name);const ye=new cc({uid:ut,auth:e,email:$,emailVerified:Ue,displayName:K,isAnonymous:Fe,photoURL:re,phoneNumber:W,tenantId:Me,stsTokenManager:se,createdAt:Be,lastLoginAt:He});return Ze&&Array.isArray(Ze)&&(ye.providerData=Ze.map(we=>Object.assign({},we))),Ce&&(ye._redirectEventId=Ce),ye}static async _fromIdTokenResponse(e,t,a=!1){const d=new Xm;d.updateFromServerResponse(t);const m=new cc({uid:t.localId,auth:e,stsTokenManager:d,isAnonymous:a});return await d0(m),m}static async _fromGetAccountInfoResponse(e,t,a){const d=t.users[0];Rn(d.localId!==void 0,"internal-error");const m=d.providerUserInfo!==void 0?xA(d.providerUserInfo):[],y=!(d.email&&d.passwordHash)&&!(m!=null&&m.length),c=new Xm;c.updateFromIdToken(a);const M=new cc({uid:d.localId,auth:e,stsTokenManager:c,isAnonymous:y}),R={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:m,metadata:new Lx(d.createdAt,d.lastLoginAt),isAnonymous:!(d.email&&d.passwordHash)&&!(m!=null&&m.length)};return Object.assign(M,R),M}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT=new Map;function Wh(r){nd(r instanceof Function,"Expected a class definition");let e=rT.get(r);return e?(nd(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,rT.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}wA.type="NONE";const iT=wA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hv(r,e,t){return`firebase:${r}:${e}:${t}`}class Ym{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:d,name:m}=this.auth;this.fullUserKey=Hv(this.userKey,d.apiKey,m),this.fullPersistenceKey=Hv("persistence",d.apiKey,m),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await h0(this.auth,{idToken:e}).catch(()=>{});return t?cc._fromGetAccountInfoResponse(this.auth,t,e):null}return cc._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new Ym(Wh(iT),e,a);const d=(await Promise.all(t.map(async R=>{if(await R._isAvailable())return R}))).filter(R=>R);let m=d[0]||Wh(iT);const y=Hv(a,e.config.apiKey,e.name);let c=null;for(const R of t)try{const B=await R._get(y);if(B){let K;if(typeof B=="string"){const $=await h0(e,{idToken:B}).catch(()=>{});if(!$)break;K=await cc._fromGetAccountInfoResponse(e,$,B)}else K=cc._fromJSON(e,B);R!==m&&(c=K),m=R;break}}catch{}const M=d.filter(R=>R._shouldAllowMigration);return!m._shouldAllowMigration||!M.length?new Ym(m,e,a):(m=M[0],c&&await m._set(y,c.toJSON()),await Promise.all(t.map(async R=>{if(R!==m)try{await R._remove(y)}catch{}})),new Ym(m,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(AA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(TA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IA(e))return"Blackberry";if(MA(e))return"Webos";if(SA(e))return"Safari";if((e.includes("chrome/")||EA(e))&&!e.includes("edge/"))return"Chrome";if(CA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=r.match(t);if((a==null?void 0:a.length)===2)return a[1]}return"Other"}function TA(r=ro()){return/firefox\//i.test(r)}function SA(r=ro()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function EA(r=ro()){return/crios\//i.test(r)}function AA(r=ro()){return/iemobile/i.test(r)}function CA(r=ro()){return/android/i.test(r)}function IA(r=ro()){return/blackberry/i.test(r)}function MA(r=ro()){return/webos/i.test(r)}function K1(r=ro()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function f5(r=ro()){var e;return K1(r)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function p5(){return Ak()&&document.documentMode===10}function PA(r=ro()){return K1(r)||CA(r)||MA(r)||IA(r)||/windows phone/i.test(r)||AA(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(r,e=[]){let t;switch(r){case"Browser":t=aT(ro());break;case"Worker":t=`${aT(ro())}-${r}`;break;default:t=r}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${gg}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=m=>new Promise((y,c)=>{try{const M=e(m);y(M)}catch(M){c(M)}});a.onAbort=t,this.queue.push(a);const d=this.queue.length-1;return()=>{this.queue[d]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const d of t)try{d()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a==null?void 0:a.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g5(r,e={}){return Sf(r,"GET","/v2/passwordPolicy",Tf(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y5=6;class _5{constructor(e){var t,a,d,m;const y=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=y.minPasswordLength)!==null&&t!==void 0?t:y5,y.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=y.maxPasswordLength),y.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=y.containsLowercaseCharacter),y.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=y.containsUppercaseCharacter),y.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=y.containsNumericCharacter),y.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=y.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(d=(a=e.allowedNonAlphanumericCharacters)===null||a===void 0?void 0:a.join(""))!==null&&d!==void 0?d:"",this.forceUpgradeOnSignin=(m=e.forceUpgradeOnSignin)!==null&&m!==void 0?m:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,a,d,m,y,c;const M={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,M),this.validatePasswordCharacterOptions(e,M),M.isValid&&(M.isValid=(t=M.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),M.isValid&&(M.isValid=(a=M.meetsMaxPasswordLength)!==null&&a!==void 0?a:!0),M.isValid&&(M.isValid=(d=M.containsLowercaseLetter)!==null&&d!==void 0?d:!0),M.isValid&&(M.isValid=(m=M.containsUppercaseLetter)!==null&&m!==void 0?m:!0),M.isValid&&(M.isValid=(y=M.containsNumericCharacter)!==null&&y!==void 0?y:!0),M.isValid&&(M.isValid=(c=M.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),M}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,d=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),d&&(t.meetsMaxPasswordLength=e.length<=d)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let d=0;d<e.length;d++)a=e.charAt(d),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,d,m){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=d)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v5{constructor(e,t,a,d){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=d,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sT(this),this.idTokenSubscription=new sT(this),this.beforeStateQueue=new m5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=d.sdkClientVersion,this._persistenceManagerAvailable=new Promise(m=>this._resolvePersistenceManagerAvailable=m)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Wh(t)),this._initializationPromise=this.queue(async()=>{var a,d,m;if(!this._deleted&&(this.persistenceManager=await Ym.create(this,e),(a=this._resolvePersistenceManagerAvailable)===null||a===void 0||a.call(this),!this._deleted)){if(!((d=this._popupRedirectResolver)===null||d===void 0)&&d._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((m=this.currentUser)===null||m===void 0?void 0:m.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await h0(this,{idToken:e}),a=await cc._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(gu(this.app)){const y=this.app.settings.authIdToken;return y?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(y).then(c,c))}):this.directlySetCurrentUser(null)}const a=await this.assertedPersistence.getCurrentUser();let d=a,m=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const y=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=d==null?void 0:d._redirectEventId,M=await this.tryRedirectSignIn(e);(!y||y===c)&&(M!=null&&M.user)&&(d=M.user,m=!0)}if(!d)return this.directlySetCurrentUser(null);if(!d._redirectEventId){if(m)try{await this.beforeStateQueue.runMiddleware(d)}catch(y){d=a,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(y))}return d?this.reloadAndSetCurrentUserOrClear(d):this.directlySetCurrentUser(null)}return Rn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===d._redirectEventId?this.directlySetCurrentUser(d):this.reloadAndSetCurrentUserOrClear(d)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await d0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=YD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gu(this.app))return Promise.reject(Xh(this));const t=e?Rs(e):null;return t&&Rn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Rn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gu(this.app)?Promise.reject(Xh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gu(this.app)?Promise.reject(Xh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await g5(this),t=new _5(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new R_("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await d5(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Wh(e)||this._popupRedirectResolver;Rn(t,this,"argument-error"),this.redirectPersistenceManager=await Ym.create(this,[Wh(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const a=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,d){if(this._deleted)return()=>{};const m=typeof t=="function"?t:t.next.bind(t);let y=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rn(c,this,"internal-error"),c.then(()=>{y||m(this.currentUser)}),typeof t=="function"){const M=e.addObserver(t,a,d);return()=>{y=!0,M()}}else{const M=e.addObserver(t);return()=>{y=!0,M()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=RA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const a=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());a&&(t["X-Firebase-Client"]=a);const d=await this._getAppCheckToken();return d&&(t["X-Firebase-AppCheck"]=d),t}async _getAppCheckToken(){var e;if(gu(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&WD(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Wp(r){return Rs(r)}class sT{constructor(e){this.auth=e,this.observer=null,this.addObserver=Lk(t=>this.observer=t)}get next(){return Rn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let U0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function b5(r){U0=r}function kA(r){return U0.loadJS(r)}function x5(){return U0.recaptchaEnterpriseScript}function w5(){return U0.gapiScript}function T5(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class S5{constructor(){this.enterprise=new E5}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class E5{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const A5="recaptcha-enterprise",DA="NO_RECAPTCHA";class C5{constructor(e){this.type=A5,this.auth=Wp(e)}async verify(e="verify",t=!1){async function a(m){if(!t){if(m.tenantId==null&&m._agentRecaptchaConfig!=null)return m._agentRecaptchaConfig.siteKey;if(m.tenantId!=null&&m._tenantRecaptchaConfigs[m.tenantId]!==void 0)return m._tenantRecaptchaConfigs[m.tenantId].siteKey}return new Promise(async(y,c)=>{i5(m,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(M=>{if(M.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const R=new r5(M);return m.tenantId==null?m._agentRecaptchaConfig=R:m._tenantRecaptchaConfigs[m.tenantId]=R,y(R.siteKey)}}).catch(M=>{c(M)})})}function d(m,y,c){const M=window.grecaptcha;tT(M)?M.enterprise.ready(()=>{M.enterprise.execute(m,{action:e}).then(R=>{y(R)}).catch(()=>{y(DA)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new S5().execute("siteKey",{action:"verify"}):new Promise((m,y)=>{a(this.auth).then(c=>{if(!t&&tT(window.grecaptcha))d(c,m,y);else{if(typeof window>"u"){y(new Error("RecaptchaVerifier is only supported in browser"));return}let M=x5();M.length!==0&&(M+=c),kA(M).then(()=>{d(c,m,y)}).catch(R=>{y(R)})}}).catch(c=>{y(c)})})}}async function oT(r,e,t,a=!1,d=!1){const m=new C5(r);let y;if(d)y=DA;else try{y=await m.verify(t)}catch{y=await m.verify(t,!0)}const c=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const M=c.phoneEnrollmentInfo.phoneNumber,R=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:M,recaptchaToken:R,captchaResponse:y,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const M=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:M,captchaResponse:y,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return a?Object.assign(c,{captchaResp:y}):Object.assign(c,{captchaResponse:y}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function zx(r,e,t,a,d){var m;if(!((m=r._getRecaptchaConfig())===null||m===void 0)&&m.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const y=await oT(r,e,t,t==="getOobCode");return a(r,y)}else return a(r,e).catch(async y=>{if(y.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await oT(r,e,t,t==="getOobCode");return a(r,c)}else return Promise.reject(y)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I5(r,e){const t=$1(r,"auth");if(t.isInitialized()){const d=t.getImmediate(),m=t.getOptions();if(Op(m,e??{}))return d;mc(d,"already-initialized")}return t.initialize({options:e})}function M5(r,e){const t=(e==null?void 0:e.persistence)||[],a=(Array.isArray(t)?t:[t]).map(Wh);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(a,e==null?void 0:e.popupRedirectResolver)}function P5(r,e,t){const a=Wp(r);Rn(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const d=!1,m=LA(e),{host:y,port:c}=R5(e),M=c===null?"":`:${c}`,R={url:`${m}//${y}${M}/`},B=Object.freeze({host:y,port:c,protocol:m.replace(":",""),options:Object.freeze({disableWarnings:d})});if(!a._canInitEmulator){Rn(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Rn(Op(R,a.config.emulator)&&Op(B,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=R,a.emulatorConfig=B,a.settings.appVerificationDisabledForTesting=!0,P_(y)?(oA(`${m}//${y}${M}`),lA("Auth",!0)):k5()}function LA(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function R5(r){const e=LA(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",d=/^(\[[^\]]+\])(:|$)/.exec(a);if(d){const m=d[1];return{host:m,port:lT(a.substr(m.length+1))}}else{const[m,y]=a.split(":");return{host:m,port:lT(y)}}}function lT(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function k5(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Zh("not implemented")}_getIdTokenResponse(e){return Zh("not implemented")}_linkToIdToken(e,t){return Zh("not implemented")}_getReauthenticationResolver(e){return Zh("not implemented")}}async function D5(r,e){return Sf(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L5(r,e){return L_(r,"POST","/v1/accounts:signInWithPassword",Tf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z5(r,e){return L_(r,"POST","/v1/accounts:signInWithEmailLink",Tf(r,e))}async function O5(r,e){return L_(r,"POST","/v1/accounts:signInWithEmailLink",Tf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_ extends X1{constructor(e,t,a,d=null){super("password",a),this._email=e,this._password=t,this._tenantId=d}static _fromEmailAndPassword(e,t){return new l_(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new l_(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zx(e,t,"signInWithPassword",L5);case"emailLink":return z5(e,{email:this._email,oobCode:this._password});default:mc(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zx(e,a,"signUpPassword",D5);case"emailLink":return O5(e,{idToken:t,email:this._email,oobCode:this._password});default:mc(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qm(r,e){return L_(r,"POST","/v1/accounts:signInWithIdp",Tf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N5="http://localhost";class Bp extends X1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Bp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):mc("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:d}=t,m=G1(t,["providerId","signInMethod"]);if(!a||!d)return null;const y=new Bp(a,d);return y.idToken=m.idToken||void 0,y.accessToken=m.accessToken||void 0,y.secret=m.secret,y.nonce=m.nonce,y.pendingToken=m.pendingToken||null,y}_getIdTokenResponse(e){const t=this.buildRequest();return Qm(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,Qm(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qm(e,t)}buildRequest(){const e={requestUri:N5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=k_(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B5(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function F5(r){const e=Fy(Vy(r)).link,t=e?Fy(Vy(e)).deep_link_id:null,a=Fy(Vy(r)).deep_link_id;return(a?Fy(Vy(a)).link:null)||a||t||e||r}class Y1{constructor(e){var t,a,d,m,y,c;const M=Fy(Vy(e)),R=(t=M.apiKey)!==null&&t!==void 0?t:null,B=(a=M.oobCode)!==null&&a!==void 0?a:null,K=B5((d=M.mode)!==null&&d!==void 0?d:null);Rn(R&&B&&K,"argument-error"),this.apiKey=R,this.operation=K,this.code=B,this.continueUrl=(m=M.continueUrl)!==null&&m!==void 0?m:null,this.languageCode=(y=M.lang)!==null&&y!==void 0?y:null,this.tenantId=(c=M.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const t=F5(e);try{return new Y1(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(){this.providerId=yg.PROVIDER_ID}static credential(e,t){return l_._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Y1.parseLink(t);return Rn(a,"argument-error"),l_._fromEmailAndCode(e,a.code,a.tenantId)}}yg.PROVIDER_ID="password";yg.EMAIL_PASSWORD_SIGN_IN_METHOD="password";yg.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_ extends zA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf extends z_{constructor(){super("facebook.com")}static credential(e){return Bp._fromParams({providerId:nf.PROVIDER_ID,signInMethod:nf.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nf.credentialFromTaggedObject(e)}static credentialFromError(e){return nf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nf.credential(e.oauthAccessToken)}catch{return null}}}nf.FACEBOOK_SIGN_IN_METHOD="facebook.com";nf.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf extends z_{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Bp._fromParams({providerId:rf.PROVIDER_ID,signInMethod:rf.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return rf.credentialFromTaggedObject(e)}static credentialFromError(e){return rf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return rf.credential(t,a)}catch{return null}}}rf.GOOGLE_SIGN_IN_METHOD="google.com";rf.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af extends z_{constructor(){super("github.com")}static credential(e){return Bp._fromParams({providerId:af.PROVIDER_ID,signInMethod:af.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return af.credentialFromTaggedObject(e)}static credentialFromError(e){return af.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return af.credential(e.oauthAccessToken)}catch{return null}}}af.GITHUB_SIGN_IN_METHOD="github.com";af.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf extends z_{constructor(){super("twitter.com")}static credential(e,t){return Bp._fromParams({providerId:sf.PROVIDER_ID,signInMethod:sf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return sf.credentialFromTaggedObject(e)}static credentialFromError(e){return sf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return sf.credential(t,a)}catch{return null}}}sf.TWITTER_SIGN_IN_METHOD="twitter.com";sf.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V5(r,e){return L_(r,"POST","/v1/accounts:signUp",Tf(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,d=!1){const m=await cc._fromIdTokenResponse(e,a,d),y=uT(a);return new Fp({user:m,providerId:y,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const d=uT(a);return new Fp({user:e,providerId:d,_tokenResponse:a,operationType:t})}}function uT(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0 extends cd{constructor(e,t,a,d){var m;super(t.code,t.message),this.operationType=a,this.user=d,Object.setPrototypeOf(this,f0.prototype),this.customData={appName:e.name,tenantId:(m=e.tenantId)!==null&&m!==void 0?m:void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,d){return new f0(e,t,a,d)}}function OA(r,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(m=>{throw m.code==="auth/multi-factor-auth-required"?f0._fromErrorAndOperation(r,m,e,a):m})}async function j5(r,e,t=!1){const a=await o_(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Fp._forOperation(r,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U5(r,e,t=!1){const{auth:a}=r;if(gu(a.app))return Promise.reject(Xh(a));const d="reauthenticate";try{const m=await o_(r,OA(a,d,e,r),t);Rn(m.idToken,a,"internal-error");const y=W1(m.idToken);Rn(y,a,"internal-error");const{sub:c}=y;return Rn(r.uid===c,a,"user-mismatch"),Fp._forOperation(r,d,m)}catch(m){throw(m==null?void 0:m.code)==="auth/user-not-found"&&mc(a,"user-mismatch"),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NA(r,e,t=!1){if(gu(r.app))return Promise.reject(Xh(r));const a="signIn",d=await OA(r,a,e),m=await Fp._fromIdTokenResponse(r,a,d);return t||await r._updateCurrentUser(m.user),m}async function q5(r,e){return NA(Wp(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BA(r){const e=Wp(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function $5(r,e,t){if(gu(r.app))return Promise.reject(Xh(r));const a=Wp(r),y=await zx(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",V5).catch(M=>{throw M.code==="auth/password-does-not-meet-requirements"&&BA(r),M}),c=await Fp._fromIdTokenResponse(a,"signIn",y);return await a._updateCurrentUser(c.user),c}function FA(r,e,t){return gu(r.app)?Promise.reject(Xh(r)):q5(Rs(r),yg.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&BA(r),a})}function G5(r,e,t,a){return Rs(r).onIdTokenChanged(e,t,a)}function H5(r,e,t){return Rs(r).beforeAuthStateChanged(e,t)}function Z5(r){return Rs(r).signOut()}const p0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(p0,"1"),this.storage.removeItem(p0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W5=1e3,K5=10;class jA extends VA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=PA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),d=this.localCache[t];a!==d&&e(t,d,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((y,c,M)=>{this.notifyListeners(y,M)});return}const a=e.key;t?this.detachListener():this.stopPolling();const d=()=>{const y=this.storage.getItem(a);!t&&this.localCache[a]===y||this.notifyListeners(a,y)},m=this.storage.getItem(a);p5()&&m!==e.newValue&&e.newValue!==e.oldValue?setTimeout(d,K5):d()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const d of Array.from(a))d(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},W5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}jA.type="LOCAL";const X5=jA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA extends VA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}UA.type="SESSION";const qA=UA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(d=>d.isListeningto(e));if(t)return t;const a=new q0(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:d,data:m}=t.data,y=this.handlersMap[d];if(!(y!=null&&y.size))return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:d});const c=Array.from(y).map(async R=>R(t.origin,m)),M=await Y5(c);t.ports[0].postMessage({status:"done",eventId:a,eventType:d,response:M})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}q0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(r="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const d=typeof MessageChannel<"u"?new MessageChannel:null;if(!d)throw new Error("connection_unavailable");let m,y;return new Promise((c,M)=>{const R=Q1("",20);d.port1.start();const B=setTimeout(()=>{M(new Error("unsupported_event"))},a);y={messageChannel:d,onMessage(K){const $=K;if($.data.eventId===R)switch($.data.status){case"ack":clearTimeout(B),m=setTimeout(()=>{M(new Error("timeout"))},3e3);break;case"done":clearTimeout(m),c($.data.response);break;default:clearTimeout(B),clearTimeout(m),M(new Error("invalid_response"));break}}},this.handlers.add(y),d.port1.addEventListener("message",y.onMessage),this.target.postMessage({eventType:e,eventId:R,data:t},[d.port2])}).finally(()=>{y&&this.removeMessageHandler(y)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ah(){return window}function J5(r){ah().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(){return typeof ah().WorkerGlobalScope<"u"&&typeof ah().importScripts=="function"}async function eL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tL(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)===null||r===void 0?void 0:r.controller)||null}function nL(){return $A()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA="firebaseLocalStorageDb",rL=1,m0="firebaseLocalStorage",HA="fbase_key";class O_{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $0(r,e){return r.transaction([m0],e?"readwrite":"readonly").objectStore(m0)}function iL(){const r=indexedDB.deleteDatabase(GA);return new O_(r).toPromise()}function Ox(){const r=indexedDB.open(GA,rL);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const a=r.result;try{a.createObjectStore(m0,{keyPath:HA})}catch(d){t(d)}}),r.addEventListener("success",async()=>{const a=r.result;a.objectStoreNames.contains(m0)?e(a):(a.close(),await iL(),e(await Ox()))})})}async function cT(r,e,t){const a=$0(r,!0).put({[HA]:e,value:t});return new O_(a).toPromise()}async function aL(r,e){const t=$0(r,!1).get(e),a=await new O_(t).toPromise();return a===void 0?null:a.value}function hT(r,e){const t=$0(r,!0).delete(e);return new O_(t).toPromise()}const sL=800,oL=3;class ZA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ox(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>oL)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $A()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=q0._getInstance(nL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await eL(),!this.activeServiceWorker)return;this.sender=new Q5(this.activeServiceWorker);const a=await this.sender._send("ping",{},800);a&&!((e=a[0])===null||e===void 0)&&e.fulfilled&&!((t=a[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ox();return await cT(e,p0,"1"),await hT(e,p0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>cT(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>aL(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>hT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(d=>{const m=$0(d,!1).getAll();return new O_(m).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:d,value:m}of e)a.add(d),JSON.stringify(this.localCache[d])!==JSON.stringify(m)&&(this.notifyListeners(d,m),t.push(d));for(const d of Object.keys(this.localCache))this.localCache[d]&&!a.has(d)&&(this.notifyListeners(d,null),t.push(d));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const d of Array.from(a))d(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ZA.type="LOCAL";const lL=ZA;new D_(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uL(r,e){return e?Wh(e):(Rn(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1 extends X1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function cL(r){return NA(r.auth,new J1(r),r.bypassAuthState)}function hL(r){const{auth:e,user:t}=r;return Rn(t,e,"internal-error"),U5(t,new J1(r),r.bypassAuthState)}async function dL(r){const{auth:e,user:t}=r;return Rn(t,e,"internal-error"),j5(t,new J1(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e,t,a,d,m=!1){this.auth=e,this.resolver=a,this.user=d,this.bypassAuthState=m,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:d,tenantId:m,error:y,type:c}=e;if(y){this.reject(y);return}const M={auth:this.auth,requestUri:t,sessionId:a,tenantId:m||void 0,postBody:d||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(M))}catch(R){this.reject(R)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return cL;case"linkViaPopup":case"linkViaRedirect":return dL;case"reauthViaPopup":case"reauthViaRedirect":return hL;default:mc(this.auth,"internal-error")}}resolve(e){nd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){nd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL=new D_(2e3,1e4);class Zm extends WA{constructor(e,t,a,d,m){super(e,t,d,m),this.provider=a,this.authWindow=null,this.pollId=null,Zm.currentPopupAction&&Zm.currentPopupAction.cancel(),Zm.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rn(e,this.auth,"internal-error"),e}async onExecution(){nd(this.filter.length===1,"Popup operations only handle one event");const e=Q1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ih(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ih(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zm.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if(!((a=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||a===void 0)&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ih(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fL.get())};e()}}Zm.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL="pendingRedirect",Zv=new Map;class mL extends WA{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=Zv.get(this.auth._key());if(!e){try{const a=await gL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}Zv.set(this.auth._key(),e)}return this.bypassAuthState||Zv.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function gL(r,e){const t=vL(e),a=_L(r);if(!await a._isAvailable())return!1;const d=await a._get(t)==="true";return await a._remove(t),d}function yL(r,e){Zv.set(r._key(),e)}function _L(r){return Wh(r._redirectPersistence)}function vL(r){return Hv(pL,r.config.apiKey,r.name)}async function bL(r,e,t=!1){if(gu(r.app))return Promise.reject(Xh(r));const a=Wp(r),d=uL(a,e),y=await new mL(a,d,t).execute();return y&&!t&&(delete y.user._redirectEventId,await a._persistUserIfCurrent(y.user),await a._setRedirectUser(null,e)),y}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xL=10*60*1e3;class wL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!KA(e)){const d=((a=e.error.code)===null||a===void 0?void 0:a.split("auth/")[1])||"internal-error";t.onError(ih(this.auth,d))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xL&&this.cachedEventUids.clear(),this.cachedEventUids.has(dT(e))}saveEventToCache(e){this.cachedEventUids.add(dT(e)),this.lastProcessedEventTime=Date.now()}}function dT(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function KA({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function TL(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return KA(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SL(r,e={}){return Sf(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,AL=/^https?/;async function CL(r){if(r.config.emulator)return;const{authorizedDomains:e}=await SL(r);for(const t of e)try{if(IL(t))return}catch{}mc(r,"unauthorized-domain")}function IL(r){const e=Dx(),{protocol:t,hostname:a}=new URL(e);if(r.startsWith("chrome-extension://")){const y=new URL(r);return y.hostname===""&&a===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&y.hostname===a}if(!AL.test(t))return!1;if(EL.test(r))return a===r;const d=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+d+"|"+d+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML=new D_(3e4,6e4);function fT(){const r=ah().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function PL(r){return new Promise((e,t)=>{var a,d,m;function y(){fT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fT(),t(ih(r,"network-request-failed"))},timeout:ML.get()})}if(!((d=(a=ah().gapi)===null||a===void 0?void 0:a.iframes)===null||d===void 0)&&d.Iframe)e(gapi.iframes.getContext());else if(!((m=ah().gapi)===null||m===void 0)&&m.load)y();else{const c=T5("iframefcb");return ah()[c]=()=>{gapi.load?y():t(ih(r,"network-request-failed"))},kA(`${w5()}?onload=${c}`).catch(M=>t(M))}}).catch(e=>{throw Wv=null,e})}let Wv=null;function RL(r){return Wv=Wv||PL(r),Wv}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kL=new D_(5e3,15e3),DL="__/auth/iframe",LL="emulator/auth/iframe",zL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NL(r){const e=r.config;Rn(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?Z1(e,LL):`https://${r.config.authDomain}/${DL}`,a={apiKey:e.apiKey,appName:r.name,v:gg},d=OL.get(r.config.apiHost);d&&(a.eid=d);const m=r._getFrameworks();return m.length&&(a.fw=m.join(",")),`${t}?${k_(a).slice(1)}`}async function BL(r){const e=await RL(r),t=ah().gapi;return Rn(t,r,"internal-error"),e.open({where:document.body,url:NL(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zL,dontclear:!0},a=>new Promise(async(d,m)=>{await a.restyle({setHideOnLeave:!1});const y=ih(r,"network-request-failed"),c=ah().setTimeout(()=>{m(y)},kL.get());function M(){ah().clearTimeout(c),d(a)}a.ping(M).then(M,()=>{m(y)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VL=500,jL=600,UL="_blank",qL="http://localhost";class pT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $L(r,e,t,a=VL,d=jL){const m=Math.max((window.screen.availHeight-d)/2,0).toString(),y=Math.max((window.screen.availWidth-a)/2,0).toString();let c="";const M=Object.assign(Object.assign({},FL),{width:a.toString(),height:d.toString(),top:m,left:y}),R=ro().toLowerCase();t&&(c=EA(R)?UL:t),TA(R)&&(e=e||qL,M.scrollbars="yes");const B=Object.entries(M).reduce(($,[W,re])=>`${$}${W}=${re},`,"");if(f5(R)&&c!=="_self")return GL(e||"",c),new pT(null);const K=window.open(e||"",c,B);Rn(K,r,"popup-blocked");try{K.focus()}catch{}return new pT(K)}function GL(r,e){const t=document.createElement("a");t.href=r,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL="__/auth/handler",ZL="emulator/auth/handler",WL=encodeURIComponent("fac");async function mT(r,e,t,a,d,m){Rn(r.config.authDomain,r,"auth-domain-config-required"),Rn(r.config.apiKey,r,"invalid-api-key");const y={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:a,v:gg,eventId:d};if(e instanceof zA){e.setDefaultLanguage(r.languageCode),y.providerId=e.providerId||"",Dk(e.getCustomParameters())||(y.customParameters=JSON.stringify(e.getCustomParameters()));for(const[B,K]of Object.entries({}))y[B]=K}if(e instanceof z_){const B=e.getScopes().filter(K=>K!=="");B.length>0&&(y.scopes=B.join(","))}r.tenantId&&(y.tid=r.tenantId);const c=y;for(const B of Object.keys(c))c[B]===void 0&&delete c[B];const M=await r._getAppCheckToken(),R=M?`#${WL}=${encodeURIComponent(M)}`:"";return`${KL(r)}?${k_(c).slice(1)}${R}`}function KL({config:r}){return r.emulator?Z1(r,ZL):`https://${r.authDomain}/${HL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx="webStorageSupport";class XL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qA,this._completeRedirectFn=bL,this._overrideRedirectResult=yL}async _openPopup(e,t,a,d){var m;nd((m=this.eventManagers[e._key()])===null||m===void 0?void 0:m.manager,"_initialize() not called before _openPopup()");const y=await mT(e,t,a,Dx(),d);return $L(e,y,Q1())}async _openRedirect(e,t,a,d){await this._originValidation(e);const m=await mT(e,t,a,Dx(),d);return J5(m),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:d,promise:m}=this.eventManagers[t];return d?Promise.resolve(d):(nd(m,"If manager is not set, promise should be"),m)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await BL(e),a=new wL(e);return t.register("authEvent",d=>(Rn(d==null?void 0:d.authEvent,e,"invalid-auth-event"),{status:a.onEvent(d.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(tx,{type:tx},d=>{var m;const y=(m=d==null?void 0:d[0])===null||m===void 0?void 0:m[tx];y!==void 0&&t(!!y),mc(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=CL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return PA()||SA()||K1()}}const YL=XL;var gT="@firebase/auth",yT="1.10.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e((a==null?void 0:a.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Rn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JL(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function e3(r){ig(new Np("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),d=e.getProvider("heartbeat"),m=e.getProvider("app-check-internal"),{apiKey:y,authDomain:c}=a.options;Rn(y&&!y.includes(":"),"invalid-api-key",{appName:a.name});const M={apiKey:y,authDomain:c,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:RA(r)},R=new v5(a,d,m,M);return M5(R,t),R},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),ig(new Np("auth-internal",e=>{const t=Wp(e.getProvider("auth").getImmediate());return(a=>new QL(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),hf(gT,yT,JL(r)),hf(gT,yT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3=5*60,n3=sA("authIdTokenMaxAge")||t3;let _T=null;const r3=r=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>n3)return;const d=t==null?void 0:t.token;_T!==d&&(_T=d,await fetch(r,{method:d?"POST":"DELETE",headers:d?{Authorization:`Bearer ${d}`}:{}}))};function i3(r=dA()){const e=$1(r,"auth");if(e.isInitialized())return e.getImmediate();const t=I5(r,{popupRedirectResolver:YL,persistence:[lL,X5,qA]}),a=sA("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const m=new URL(a,location.origin);if(location.origin===m.origin){const y=r3(m.toString());H5(t,y,()=>y(t.currentUser)),G5(t,c=>y(c))}}const d=iA("auth");return d&&P5(t,`http://${d}`),t}function a3(){var r,e;return(e=(r=document.getElementsByTagName("head"))===null||r===void 0?void 0:r[0])!==null&&e!==void 0?e:document}b5({loadJS(r){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",r),a.onload=e,a.onerror=d=>{const m=ih("internal-error");m.customData=d,t(m)},a.type="text/javascript",a.charset="UTF-8",a3().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});e3("Browser");var vT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var df,XA;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(me,se){function ye(){}ye.prototype=se.prototype,me.D=se.prototype,me.prototype=new ye,me.prototype.constructor=me,me.C=function(we,Ee,ke){for(var ve=Array(arguments.length-2),Bt=2;Bt<arguments.length;Bt++)ve[Bt-2]=arguments[Bt];return se.prototype[Ee].apply(we,ve)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function d(me,se,ye){ye||(ye=0);var we=Array(16);if(typeof se=="string")for(var Ee=0;16>Ee;++Ee)we[Ee]=se.charCodeAt(ye++)|se.charCodeAt(ye++)<<8|se.charCodeAt(ye++)<<16|se.charCodeAt(ye++)<<24;else for(Ee=0;16>Ee;++Ee)we[Ee]=se[ye++]|se[ye++]<<8|se[ye++]<<16|se[ye++]<<24;se=me.g[0],ye=me.g[1],Ee=me.g[2];var ke=me.g[3],ve=se+(ke^ye&(Ee^ke))+we[0]+3614090360&4294967295;se=ye+(ve<<7&4294967295|ve>>>25),ve=ke+(Ee^se&(ye^Ee))+we[1]+3905402710&4294967295,ke=se+(ve<<12&4294967295|ve>>>20),ve=Ee+(ye^ke&(se^ye))+we[2]+606105819&4294967295,Ee=ke+(ve<<17&4294967295|ve>>>15),ve=ye+(se^Ee&(ke^se))+we[3]+3250441966&4294967295,ye=Ee+(ve<<22&4294967295|ve>>>10),ve=se+(ke^ye&(Ee^ke))+we[4]+4118548399&4294967295,se=ye+(ve<<7&4294967295|ve>>>25),ve=ke+(Ee^se&(ye^Ee))+we[5]+1200080426&4294967295,ke=se+(ve<<12&4294967295|ve>>>20),ve=Ee+(ye^ke&(se^ye))+we[6]+2821735955&4294967295,Ee=ke+(ve<<17&4294967295|ve>>>15),ve=ye+(se^Ee&(ke^se))+we[7]+4249261313&4294967295,ye=Ee+(ve<<22&4294967295|ve>>>10),ve=se+(ke^ye&(Ee^ke))+we[8]+1770035416&4294967295,se=ye+(ve<<7&4294967295|ve>>>25),ve=ke+(Ee^se&(ye^Ee))+we[9]+2336552879&4294967295,ke=se+(ve<<12&4294967295|ve>>>20),ve=Ee+(ye^ke&(se^ye))+we[10]+4294925233&4294967295,Ee=ke+(ve<<17&4294967295|ve>>>15),ve=ye+(se^Ee&(ke^se))+we[11]+2304563134&4294967295,ye=Ee+(ve<<22&4294967295|ve>>>10),ve=se+(ke^ye&(Ee^ke))+we[12]+1804603682&4294967295,se=ye+(ve<<7&4294967295|ve>>>25),ve=ke+(Ee^se&(ye^Ee))+we[13]+4254626195&4294967295,ke=se+(ve<<12&4294967295|ve>>>20),ve=Ee+(ye^ke&(se^ye))+we[14]+2792965006&4294967295,Ee=ke+(ve<<17&4294967295|ve>>>15),ve=ye+(se^Ee&(ke^se))+we[15]+1236535329&4294967295,ye=Ee+(ve<<22&4294967295|ve>>>10),ve=se+(Ee^ke&(ye^Ee))+we[1]+4129170786&4294967295,se=ye+(ve<<5&4294967295|ve>>>27),ve=ke+(ye^Ee&(se^ye))+we[6]+3225465664&4294967295,ke=se+(ve<<9&4294967295|ve>>>23),ve=Ee+(se^ye&(ke^se))+we[11]+643717713&4294967295,Ee=ke+(ve<<14&4294967295|ve>>>18),ve=ye+(ke^se&(Ee^ke))+we[0]+3921069994&4294967295,ye=Ee+(ve<<20&4294967295|ve>>>12),ve=se+(Ee^ke&(ye^Ee))+we[5]+3593408605&4294967295,se=ye+(ve<<5&4294967295|ve>>>27),ve=ke+(ye^Ee&(se^ye))+we[10]+38016083&4294967295,ke=se+(ve<<9&4294967295|ve>>>23),ve=Ee+(se^ye&(ke^se))+we[15]+3634488961&4294967295,Ee=ke+(ve<<14&4294967295|ve>>>18),ve=ye+(ke^se&(Ee^ke))+we[4]+3889429448&4294967295,ye=Ee+(ve<<20&4294967295|ve>>>12),ve=se+(Ee^ke&(ye^Ee))+we[9]+568446438&4294967295,se=ye+(ve<<5&4294967295|ve>>>27),ve=ke+(ye^Ee&(se^ye))+we[14]+3275163606&4294967295,ke=se+(ve<<9&4294967295|ve>>>23),ve=Ee+(se^ye&(ke^se))+we[3]+4107603335&4294967295,Ee=ke+(ve<<14&4294967295|ve>>>18),ve=ye+(ke^se&(Ee^ke))+we[8]+1163531501&4294967295,ye=Ee+(ve<<20&4294967295|ve>>>12),ve=se+(Ee^ke&(ye^Ee))+we[13]+2850285829&4294967295,se=ye+(ve<<5&4294967295|ve>>>27),ve=ke+(ye^Ee&(se^ye))+we[2]+4243563512&4294967295,ke=se+(ve<<9&4294967295|ve>>>23),ve=Ee+(se^ye&(ke^se))+we[7]+1735328473&4294967295,Ee=ke+(ve<<14&4294967295|ve>>>18),ve=ye+(ke^se&(Ee^ke))+we[12]+2368359562&4294967295,ye=Ee+(ve<<20&4294967295|ve>>>12),ve=se+(ye^Ee^ke)+we[5]+4294588738&4294967295,se=ye+(ve<<4&4294967295|ve>>>28),ve=ke+(se^ye^Ee)+we[8]+2272392833&4294967295,ke=se+(ve<<11&4294967295|ve>>>21),ve=Ee+(ke^se^ye)+we[11]+1839030562&4294967295,Ee=ke+(ve<<16&4294967295|ve>>>16),ve=ye+(Ee^ke^se)+we[14]+4259657740&4294967295,ye=Ee+(ve<<23&4294967295|ve>>>9),ve=se+(ye^Ee^ke)+we[1]+2763975236&4294967295,se=ye+(ve<<4&4294967295|ve>>>28),ve=ke+(se^ye^Ee)+we[4]+1272893353&4294967295,ke=se+(ve<<11&4294967295|ve>>>21),ve=Ee+(ke^se^ye)+we[7]+4139469664&4294967295,Ee=ke+(ve<<16&4294967295|ve>>>16),ve=ye+(Ee^ke^se)+we[10]+3200236656&4294967295,ye=Ee+(ve<<23&4294967295|ve>>>9),ve=se+(ye^Ee^ke)+we[13]+681279174&4294967295,se=ye+(ve<<4&4294967295|ve>>>28),ve=ke+(se^ye^Ee)+we[0]+3936430074&4294967295,ke=se+(ve<<11&4294967295|ve>>>21),ve=Ee+(ke^se^ye)+we[3]+3572445317&4294967295,Ee=ke+(ve<<16&4294967295|ve>>>16),ve=ye+(Ee^ke^se)+we[6]+76029189&4294967295,ye=Ee+(ve<<23&4294967295|ve>>>9),ve=se+(ye^Ee^ke)+we[9]+3654602809&4294967295,se=ye+(ve<<4&4294967295|ve>>>28),ve=ke+(se^ye^Ee)+we[12]+3873151461&4294967295,ke=se+(ve<<11&4294967295|ve>>>21),ve=Ee+(ke^se^ye)+we[15]+530742520&4294967295,Ee=ke+(ve<<16&4294967295|ve>>>16),ve=ye+(Ee^ke^se)+we[2]+3299628645&4294967295,ye=Ee+(ve<<23&4294967295|ve>>>9),ve=se+(Ee^(ye|~ke))+we[0]+4096336452&4294967295,se=ye+(ve<<6&4294967295|ve>>>26),ve=ke+(ye^(se|~Ee))+we[7]+1126891415&4294967295,ke=se+(ve<<10&4294967295|ve>>>22),ve=Ee+(se^(ke|~ye))+we[14]+2878612391&4294967295,Ee=ke+(ve<<15&4294967295|ve>>>17),ve=ye+(ke^(Ee|~se))+we[5]+4237533241&4294967295,ye=Ee+(ve<<21&4294967295|ve>>>11),ve=se+(Ee^(ye|~ke))+we[12]+1700485571&4294967295,se=ye+(ve<<6&4294967295|ve>>>26),ve=ke+(ye^(se|~Ee))+we[3]+2399980690&4294967295,ke=se+(ve<<10&4294967295|ve>>>22),ve=Ee+(se^(ke|~ye))+we[10]+4293915773&4294967295,Ee=ke+(ve<<15&4294967295|ve>>>17),ve=ye+(ke^(Ee|~se))+we[1]+2240044497&4294967295,ye=Ee+(ve<<21&4294967295|ve>>>11),ve=se+(Ee^(ye|~ke))+we[8]+1873313359&4294967295,se=ye+(ve<<6&4294967295|ve>>>26),ve=ke+(ye^(se|~Ee))+we[15]+4264355552&4294967295,ke=se+(ve<<10&4294967295|ve>>>22),ve=Ee+(se^(ke|~ye))+we[6]+2734768916&4294967295,Ee=ke+(ve<<15&4294967295|ve>>>17),ve=ye+(ke^(Ee|~se))+we[13]+1309151649&4294967295,ye=Ee+(ve<<21&4294967295|ve>>>11),ve=se+(Ee^(ye|~ke))+we[4]+4149444226&4294967295,se=ye+(ve<<6&4294967295|ve>>>26),ve=ke+(ye^(se|~Ee))+we[11]+3174756917&4294967295,ke=se+(ve<<10&4294967295|ve>>>22),ve=Ee+(se^(ke|~ye))+we[2]+718787259&4294967295,Ee=ke+(ve<<15&4294967295|ve>>>17),ve=ye+(ke^(Ee|~se))+we[9]+3951481745&4294967295,me.g[0]=me.g[0]+se&4294967295,me.g[1]=me.g[1]+(Ee+(ve<<21&4294967295|ve>>>11))&4294967295,me.g[2]=me.g[2]+Ee&4294967295,me.g[3]=me.g[3]+ke&4294967295}a.prototype.u=function(me,se){se===void 0&&(se=me.length);for(var ye=se-this.blockSize,we=this.B,Ee=this.h,ke=0;ke<se;){if(Ee==0)for(;ke<=ye;)d(this,me,ke),ke+=this.blockSize;if(typeof me=="string"){for(;ke<se;)if(we[Ee++]=me.charCodeAt(ke++),Ee==this.blockSize){d(this,we),Ee=0;break}}else for(;ke<se;)if(we[Ee++]=me[ke++],Ee==this.blockSize){d(this,we),Ee=0;break}}this.h=Ee,this.o+=se},a.prototype.v=function(){var me=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);me[0]=128;for(var se=1;se<me.length-8;++se)me[se]=0;var ye=8*this.o;for(se=me.length-8;se<me.length;++se)me[se]=ye&255,ye/=256;for(this.u(me),me=Array(16),se=ye=0;4>se;++se)for(var we=0;32>we;we+=8)me[ye++]=this.g[se]>>>we&255;return me};function m(me,se){var ye=c;return Object.prototype.hasOwnProperty.call(ye,me)?ye[me]:ye[me]=se(me)}function y(me,se){this.h=se;for(var ye=[],we=!0,Ee=me.length-1;0<=Ee;Ee--){var ke=me[Ee]|0;we&&ke==se||(ye[Ee]=ke,we=!1)}this.g=ye}var c={};function M(me){return-128<=me&&128>me?m(me,function(se){return new y([se|0],0>se?-1:0)}):new y([me|0],0>me?-1:0)}function R(me){if(isNaN(me)||!isFinite(me))return K;if(0>me)return Ce(R(-me));for(var se=[],ye=1,we=0;me>=ye;we++)se[we]=me/ye|0,ye*=4294967296;return new y(se,0)}function B(me,se){if(me.length==0)throw Error("number format error: empty string");if(se=se||10,2>se||36<se)throw Error("radix out of range: "+se);if(me.charAt(0)=="-")return Ce(B(me.substring(1),se));if(0<=me.indexOf("-"))throw Error('number format error: interior "-" character');for(var ye=R(Math.pow(se,8)),we=K,Ee=0;Ee<me.length;Ee+=8){var ke=Math.min(8,me.length-Ee),ve=parseInt(me.substring(Ee,Ee+ke),se);8>ke?(ke=R(Math.pow(se,ke)),we=we.j(ke).add(R(ve))):(we=we.j(ye),we=we.add(R(ve)))}return we}var K=M(0),$=M(1),W=M(16777216);r=y.prototype,r.m=function(){if(Me(this))return-Ce(this).m();for(var me=0,se=1,ye=0;ye<this.g.length;ye++){var we=this.i(ye);me+=(0<=we?we:4294967296+we)*se,se*=4294967296}return me},r.toString=function(me){if(me=me||10,2>me||36<me)throw Error("radix out of range: "+me);if(re(this))return"0";if(Me(this))return"-"+Ce(this).toString(me);for(var se=R(Math.pow(me,6)),ye=this,we="";;){var Ee=Ue(ye,se).g;ye=Be(ye,Ee.j(se));var ke=((0<ye.g.length?ye.g[0]:ye.h)>>>0).toString(me);if(ye=Ee,re(ye))return ke+we;for(;6>ke.length;)ke="0"+ke;we=ke+we}},r.i=function(me){return 0>me?0:me<this.g.length?this.g[me]:this.h};function re(me){if(me.h!=0)return!1;for(var se=0;se<me.g.length;se++)if(me.g[se]!=0)return!1;return!0}function Me(me){return me.h==-1}r.l=function(me){return me=Be(this,me),Me(me)?-1:re(me)?0:1};function Ce(me){for(var se=me.g.length,ye=[],we=0;we<se;we++)ye[we]=~me.g[we];return new y(ye,~me.h).add($)}r.abs=function(){return Me(this)?Ce(this):this},r.add=function(me){for(var se=Math.max(this.g.length,me.g.length),ye=[],we=0,Ee=0;Ee<=se;Ee++){var ke=we+(this.i(Ee)&65535)+(me.i(Ee)&65535),ve=(ke>>>16)+(this.i(Ee)>>>16)+(me.i(Ee)>>>16);we=ve>>>16,ke&=65535,ve&=65535,ye[Ee]=ve<<16|ke}return new y(ye,ye[ye.length-1]&-2147483648?-1:0)};function Be(me,se){return me.add(Ce(se))}r.j=function(me){if(re(this)||re(me))return K;if(Me(this))return Me(me)?Ce(this).j(Ce(me)):Ce(Ce(this).j(me));if(Me(me))return Ce(this.j(Ce(me)));if(0>this.l(W)&&0>me.l(W))return R(this.m()*me.m());for(var se=this.g.length+me.g.length,ye=[],we=0;we<2*se;we++)ye[we]=0;for(we=0;we<this.g.length;we++)for(var Ee=0;Ee<me.g.length;Ee++){var ke=this.i(we)>>>16,ve=this.i(we)&65535,Bt=me.i(Ee)>>>16,Kt=me.i(Ee)&65535;ye[2*we+2*Ee]+=ve*Kt,He(ye,2*we+2*Ee),ye[2*we+2*Ee+1]+=ke*Kt,He(ye,2*we+2*Ee+1),ye[2*we+2*Ee+1]+=ve*Bt,He(ye,2*we+2*Ee+1),ye[2*we+2*Ee+2]+=ke*Bt,He(ye,2*we+2*Ee+2)}for(we=0;we<se;we++)ye[we]=ye[2*we+1]<<16|ye[2*we];for(we=se;we<2*se;we++)ye[we]=0;return new y(ye,0)};function He(me,se){for(;(me[se]&65535)!=me[se];)me[se+1]+=me[se]>>>16,me[se]&=65535,se++}function ut(me,se){this.g=me,this.h=se}function Ue(me,se){if(re(se))throw Error("division by zero");if(re(me))return new ut(K,K);if(Me(me))return se=Ue(Ce(me),se),new ut(Ce(se.g),Ce(se.h));if(Me(se))return se=Ue(me,Ce(se)),new ut(Ce(se.g),se.h);if(30<me.g.length){if(Me(me)||Me(se))throw Error("slowDivide_ only works with positive integers.");for(var ye=$,we=se;0>=we.l(me);)ye=Fe(ye),we=Fe(we);var Ee=Ze(ye,1),ke=Ze(we,1);for(we=Ze(we,2),ye=Ze(ye,2);!re(we);){var ve=ke.add(we);0>=ve.l(me)&&(Ee=Ee.add(ye),ke=ve),we=Ze(we,1),ye=Ze(ye,1)}return se=Be(me,Ee.j(se)),new ut(Ee,se)}for(Ee=K;0<=me.l(se);){for(ye=Math.max(1,Math.floor(me.m()/se.m())),we=Math.ceil(Math.log(ye)/Math.LN2),we=48>=we?1:Math.pow(2,we-48),ke=R(ye),ve=ke.j(se);Me(ve)||0<ve.l(me);)ye-=we,ke=R(ye),ve=ke.j(se);re(ke)&&(ke=$),Ee=Ee.add(ke),me=Be(me,ve)}return new ut(Ee,me)}r.A=function(me){return Ue(this,me).h},r.and=function(me){for(var se=Math.max(this.g.length,me.g.length),ye=[],we=0;we<se;we++)ye[we]=this.i(we)&me.i(we);return new y(ye,this.h&me.h)},r.or=function(me){for(var se=Math.max(this.g.length,me.g.length),ye=[],we=0;we<se;we++)ye[we]=this.i(we)|me.i(we);return new y(ye,this.h|me.h)},r.xor=function(me){for(var se=Math.max(this.g.length,me.g.length),ye=[],we=0;we<se;we++)ye[we]=this.i(we)^me.i(we);return new y(ye,this.h^me.h)};function Fe(me){for(var se=me.g.length+1,ye=[],we=0;we<se;we++)ye[we]=me.i(we)<<1|me.i(we-1)>>>31;return new y(ye,me.h)}function Ze(me,se){var ye=se>>5;se%=32;for(var we=me.g.length-ye,Ee=[],ke=0;ke<we;ke++)Ee[ke]=0<se?me.i(ke+ye)>>>se|me.i(ke+ye+1)<<32-se:me.i(ke+ye);return new y(Ee,me.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,XA=a,y.prototype.add=y.prototype.add,y.prototype.multiply=y.prototype.j,y.prototype.modulo=y.prototype.A,y.prototype.compare=y.prototype.l,y.prototype.toNumber=y.prototype.m,y.prototype.toString=y.prototype.toString,y.prototype.getBits=y.prototype.i,y.fromNumber=R,y.fromString=B,df=y}).apply(typeof vT<"u"?vT:typeof self<"u"?self:typeof window<"u"?window:{});var Pv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var YA,jy,QA,Kv,Nx,JA,eC,tC;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(A,V,Z){return A==Array.prototype||A==Object.prototype||(A[V]=Z.value),A};function t(A){A=[typeof globalThis=="object"&&globalThis,A,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pv=="object"&&Pv];for(var V=0;V<A.length;++V){var Z=A[V];if(Z&&Z.Math==Math)return Z}throw Error("Cannot find global object")}var a=t(this);function d(A,V){if(V)e:{var Z=a;A=A.split(".");for(var ce=0;ce<A.length-1;ce++){var Je=A[ce];if(!(Je in Z))break e;Z=Z[Je]}A=A[A.length-1],ce=Z[A],V=V(ce),V!=ce&&V!=null&&e(Z,A,{configurable:!0,writable:!0,value:V})}}function m(A,V){A instanceof String&&(A+="");var Z=0,ce=!1,Je={next:function(){if(!ce&&Z<A.length){var pt=Z++;return{value:V(pt,A[pt]),done:!1}}return ce=!0,{done:!0,value:void 0}}};return Je[Symbol.iterator]=function(){return Je},Je}d("Array.prototype.values",function(A){return A||function(){return m(this,function(V,Z){return Z})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var y=y||{},c=this||self;function M(A){var V=typeof A;return V=V!="object"?V:A?Array.isArray(A)?"array":V:"null",V=="array"||V=="object"&&typeof A.length=="number"}function R(A){var V=typeof A;return V=="object"&&A!=null||V=="function"}function B(A,V,Z){return A.call.apply(A.bind,arguments)}function K(A,V,Z){if(!A)throw Error();if(2<arguments.length){var ce=Array.prototype.slice.call(arguments,2);return function(){var Je=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Je,ce),A.apply(V,Je)}}return function(){return A.apply(V,arguments)}}function $(A,V,Z){return $=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?B:K,$.apply(null,arguments)}function W(A,V){var Z=Array.prototype.slice.call(arguments,1);return function(){var ce=Z.slice();return ce.push.apply(ce,arguments),A.apply(this,ce)}}function re(A,V){function Z(){}Z.prototype=V.prototype,A.aa=V.prototype,A.prototype=new Z,A.prototype.constructor=A,A.Qb=function(ce,Je,pt){for(var Vt=Array(arguments.length-2),Gn=2;Gn<arguments.length;Gn++)Vt[Gn-2]=arguments[Gn];return V.prototype[Je].apply(ce,Vt)}}function Me(A){const V=A.length;if(0<V){const Z=Array(V);for(let ce=0;ce<V;ce++)Z[ce]=A[ce];return Z}return[]}function Ce(A,V){for(let Z=1;Z<arguments.length;Z++){const ce=arguments[Z];if(M(ce)){const Je=A.length||0,pt=ce.length||0;A.length=Je+pt;for(let Vt=0;Vt<pt;Vt++)A[Je+Vt]=ce[Vt]}else A.push(ce)}}class Be{constructor(V,Z){this.i=V,this.j=Z,this.h=0,this.g=null}get(){let V;return 0<this.h?(this.h--,V=this.g,this.g=V.next,V.next=null):V=this.i(),V}}function He(A){return/^[\s\xa0]*$/.test(A)}function ut(){var A=c.navigator;return A&&(A=A.userAgent)?A:""}function Ue(A){return Ue[" "](A),A}Ue[" "]=function(){};var Fe=ut().indexOf("Gecko")!=-1&&!(ut().toLowerCase().indexOf("webkit")!=-1&&ut().indexOf("Edge")==-1)&&!(ut().indexOf("Trident")!=-1||ut().indexOf("MSIE")!=-1)&&ut().indexOf("Edge")==-1;function Ze(A,V,Z){for(const ce in A)V.call(Z,A[ce],ce,A)}function me(A,V){for(const Z in A)V.call(void 0,A[Z],Z,A)}function se(A){const V={};for(const Z in A)V[Z]=A[Z];return V}const ye="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function we(A,V){let Z,ce;for(let Je=1;Je<arguments.length;Je++){ce=arguments[Je];for(Z in ce)A[Z]=ce[Z];for(let pt=0;pt<ye.length;pt++)Z=ye[pt],Object.prototype.hasOwnProperty.call(ce,Z)&&(A[Z]=ce[Z])}}function Ee(A){var V=1;A=A.split(":");const Z=[];for(;0<V&&A.length;)Z.push(A.shift()),V--;return A.length&&Z.push(A.join(":")),Z}function ke(A){c.setTimeout(()=>{throw A},0)}function ve(){var A=Gt;let V=null;return A.g&&(V=A.g,A.g=A.g.next,A.g||(A.h=null),V.next=null),V}class Bt{constructor(){this.h=this.g=null}add(V,Z){const ce=Kt.get();ce.set(V,Z),this.h?this.h.next=ce:this.g=ce,this.h=ce}}var Kt=new Be(()=>new et,A=>A.reset());class et{constructor(){this.next=this.g=this.h=null}set(V,Z){this.h=V,this.g=Z,this.next=null}reset(){this.next=this.g=this.h=null}}let Mt,Tt=!1,Gt=new Bt,Re=()=>{const A=c.Promise.resolve(void 0);Mt=()=>{A.then(_t)}};var _t=()=>{for(var A;A=ve();){try{A.h.call(A.g)}catch(Z){ke(Z)}var V=Kt;V.j(A),100>V.h&&(V.h++,A.next=V.g,V.g=A)}Tt=!1};function At(){this.s=this.s,this.C=this.C}At.prototype.s=!1,At.prototype.ma=function(){this.s||(this.s=!0,this.N())},At.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function St(A,V){this.type=A,this.g=this.target=V,this.defaultPrevented=!1}St.prototype.h=function(){this.defaultPrevented=!0};var Qt=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var A=!1,V=Object.defineProperty({},"passive",{get:function(){A=!0}});try{const Z=()=>{};c.addEventListener("test",Z,V),c.removeEventListener("test",Z,V)}catch{}return A}();function En(A,V){if(St.call(this,A?A.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,A){var Z=this.type=A.type,ce=A.changedTouches&&A.changedTouches.length?A.changedTouches[0]:null;if(this.target=A.target||A.srcElement,this.g=V,V=A.relatedTarget){if(Fe){e:{try{Ue(V.nodeName);var Je=!0;break e}catch{}Je=!1}Je||(V=null)}}else Z=="mouseover"?V=A.fromElement:Z=="mouseout"&&(V=A.toElement);this.relatedTarget=V,ce?(this.clientX=ce.clientX!==void 0?ce.clientX:ce.pageX,this.clientY=ce.clientY!==void 0?ce.clientY:ce.pageY,this.screenX=ce.screenX||0,this.screenY=ce.screenY||0):(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0),this.button=A.button,this.key=A.key||"",this.ctrlKey=A.ctrlKey,this.altKey=A.altKey,this.shiftKey=A.shiftKey,this.metaKey=A.metaKey,this.pointerId=A.pointerId||0,this.pointerType=typeof A.pointerType=="string"?A.pointerType:gn[A.pointerType]||"",this.state=A.state,this.i=A,A.defaultPrevented&&En.aa.h.call(this)}}re(En,St);var gn={2:"touch",3:"pen",4:"mouse"};En.prototype.h=function(){En.aa.h.call(this);var A=this.i;A.preventDefault?A.preventDefault():A.returnValue=!1};var ii="closure_listenable_"+(1e6*Math.random()|0),wr=0;function Cr(A,V,Z,ce,Je){this.listener=A,this.proxy=null,this.src=V,this.type=Z,this.capture=!!ce,this.ha=Je,this.key=++wr,this.da=this.fa=!1}function Ds(A){A.da=!0,A.listener=null,A.proxy=null,A.src=null,A.ha=null}function gi(A){this.src=A,this.g={},this.h=0}gi.prototype.add=function(A,V,Z,ce,Je){var pt=A.toString();A=this.g[pt],A||(A=this.g[pt]=[],this.h++);var Vt=Tr(A,V,ce,Je);return-1<Vt?(V=A[Vt],Z||(V.fa=!1)):(V=new Cr(V,this.src,pt,!!ce,Je),V.fa=Z,A.push(V)),V};function ao(A,V){var Z=V.type;if(Z in A.g){var ce=A.g[Z],Je=Array.prototype.indexOf.call(ce,V,void 0),pt;(pt=0<=Je)&&Array.prototype.splice.call(ce,Je,1),pt&&(Ds(V),A.g[Z].length==0&&(delete A.g[Z],A.h--))}}function Tr(A,V,Z,ce){for(var Je=0;Je<A.length;++Je){var pt=A[Je];if(!pt.da&&pt.listener==V&&pt.capture==!!Z&&pt.ha==ce)return Je}return-1}var ya="closure_lm_"+(1e6*Math.random()|0),_a={};function rl(A,V,Z,ce,Je){if(Array.isArray(V)){for(var pt=0;pt<V.length;pt++)rl(A,V[pt],Z,ce,Je);return null}return Z=ko(Z),A&&A[ii]?A.K(V,Z,R(ce)?!!ce.capture:!1,Je):Ir(A,V,Z,!1,ce,Je)}function Ir(A,V,Z,ce,Je,pt){if(!V)throw Error("Invalid event type");var Vt=R(Je)?!!Je.capture:!!Je,Gn=zs(A);if(Gn||(A[ya]=Gn=new gi(A)),Z=Gn.add(V,Z,ce,Vt,pt),Z.proxy)return Z;if(ce=Oa(),Z.proxy=ce,ce.src=A,ce.listener=Z,A.addEventListener)Qt||(Je=Vt),Je===void 0&&(Je=!1),A.addEventListener(V.toString(),ce,Je);else if(A.attachEvent)A.attachEvent(Xa(V.toString()),ce);else if(A.addListener&&A.removeListener)A.addListener(ce);else throw Error("addEventListener and attachEvent are unavailable.");return Z}function Oa(){function A(Z){return V.call(A.src,A.listener,Z)}const V=bu;return A}function na(A,V,Z,ce,Je){if(Array.isArray(V))for(var pt=0;pt<V.length;pt++)na(A,V[pt],Z,ce,Je);else ce=R(ce)?!!ce.capture:!!ce,Z=ko(Z),A&&A[ii]?(A=A.i,V=String(V).toString(),V in A.g&&(pt=A.g[V],Z=Tr(pt,Z,ce,Je),-1<Z&&(Ds(pt[Z]),Array.prototype.splice.call(pt,Z,1),pt.length==0&&(delete A.g[V],A.h--)))):A&&(A=zs(A))&&(V=A.g[V.toString()],A=-1,V&&(A=Tr(V,Z,ce,Je)),(Z=-1<A?V[A]:null)&&Ls(Z))}function Ls(A){if(typeof A!="number"&&A&&!A.da){var V=A.src;if(V&&V[ii])ao(V.i,A);else{var Z=A.type,ce=A.proxy;V.removeEventListener?V.removeEventListener(Z,ce,A.capture):V.detachEvent?V.detachEvent(Xa(Z),ce):V.addListener&&V.removeListener&&V.removeListener(ce),(Z=zs(V))?(ao(Z,A),Z.h==0&&(Z.src=null,V[ya]=null)):Ds(A)}}}function Xa(A){return A in _a?_a[A]:_a[A]="on"+A}function bu(A,V){if(A.da)A=!0;else{V=new En(V,this);var Z=A.listener,ce=A.ha||A.src;A.fa&&Ls(A),A=Z.call(ce,V)}return A}function zs(A){return A=A[ya],A instanceof gi?A:null}var ls="__closure_events_fn_"+(1e9*Math.random()>>>0);function ko(A){return typeof A=="function"?A:(A[ls]||(A[ls]=function(V){return A.handleEvent(V)}),A[ls])}function fr(){At.call(this),this.i=new gi(this),this.M=this,this.F=null}re(fr,At),fr.prototype[ii]=!0,fr.prototype.removeEventListener=function(A,V,Z,ce){na(this,A,V,Z,ce)};function Bn(A,V){var Z,ce=A.F;if(ce)for(Z=[];ce;ce=ce.F)Z.push(ce);if(A=A.M,ce=V.type||V,typeof V=="string")V=new St(V,A);else if(V instanceof St)V.target=V.target||A;else{var Je=V;V=new St(ce,A),we(V,Je)}if(Je=!0,Z)for(var pt=Z.length-1;0<=pt;pt--){var Vt=V.g=Z[pt];Je=di(Vt,ce,!0,V)&&Je}if(Vt=V.g=A,Je=di(Vt,ce,!0,V)&&Je,Je=di(Vt,ce,!1,V)&&Je,Z)for(pt=0;pt<Z.length;pt++)Vt=V.g=Z[pt],Je=di(Vt,ce,!1,V)&&Je}fr.prototype.N=function(){if(fr.aa.N.call(this),this.i){var A=this.i,V;for(V in A.g){for(var Z=A.g[V],ce=0;ce<Z.length;ce++)Ds(Z[ce]);delete A.g[V],A.h--}}this.F=null},fr.prototype.K=function(A,V,Z,ce){return this.i.add(String(A),V,!1,Z,ce)},fr.prototype.L=function(A,V,Z,ce){return this.i.add(String(A),V,!0,Z,ce)};function di(A,V,Z,ce){if(V=A.i.g[String(V)],!V)return!0;V=V.concat();for(var Je=!0,pt=0;pt<V.length;++pt){var Vt=V[pt];if(Vt&&!Vt.da&&Vt.capture==Z){var Gn=Vt.listener,Ni=Vt.ha||Vt.src;Vt.fa&&ao(A.i,Vt),Je=Gn.call(Ni,ce)!==!1&&Je}}return Je&&!ce.defaultPrevented}function Ri(A,V,Z){if(typeof A=="function")Z&&(A=$(A,Z));else if(A&&typeof A.handleEvent=="function")A=$(A.handleEvent,A);else throw Error("Invalid listener argument");return 2147483647<Number(V)?-1:c.setTimeout(A,V||0)}function xu(A){A.g=Ri(()=>{A.g=null,A.i&&(A.i=!1,xu(A))},A.l);const V=A.h;A.h=null,A.m.apply(null,V)}class so extends At{constructor(V,Z){super(),this.m=V,this.l=Z,this.h=null,this.i=!1,this.g=null}j(V){this.h=arguments,this.g?this.i=!0:xu(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ge(A){At.call(this),this.h=A,this.g={}}re(Ge,At);var ne=[];function ie(A){Ze(A.g,function(V,Z){this.g.hasOwnProperty(Z)&&Ls(V)},A),A.g={}}Ge.prototype.N=function(){Ge.aa.N.call(this),ie(this)},Ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ue=c.JSON.stringify,Te=c.JSON.parse,Oe=class{stringify(A){return c.JSON.stringify(A,void 0)}parse(A){return c.JSON.parse(A,void 0)}};function $e(){}$e.prototype.h=null;function tt(A){return A.h||(A.h=A.i())}function je(){}var ht={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function st(){St.call(this,"d")}re(st,St);function Ke(){St.call(this,"c")}re(Ke,St);var mt={},ze=null;function Ot(){return ze=ze||new fr}mt.La="serverreachability";function on(A){St.call(this,mt.La,A)}re(on,St);function jt(A){const V=Ot();Bn(V,new on(V))}mt.STAT_EVENT="statevent";function Jt(A,V){St.call(this,mt.STAT_EVENT,A),this.stat=V}re(Jt,St);function Xt(A){const V=Ot();Bn(V,new Jt(V,A))}mt.Ma="timingevent";function An(A,V){St.call(this,mt.Ma,A),this.size=V}re(An,St);function vn(A,V){if(typeof A!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){A()},V)}function Cn(){this.g=!0}Cn.prototype.xa=function(){this.g=!1};function cn(A,V,Z,ce,Je,pt){A.info(function(){if(A.g)if(pt)for(var Vt="",Gn=pt.split("&"),Ni=0;Ni<Gn.length;Ni++){var Hn=Gn[Ni].split("=");if(1<Hn.length){var Zi=Hn[0];Hn=Hn[1];var ei=Zi.split("_");Vt=2<=ei.length&&ei[1]=="type"?Vt+(Zi+"="+Hn+"&"):Vt+(Zi+"=redacted&")}}else Vt=null;else Vt=pt;return"XMLHTTP REQ ("+ce+") [attempt "+Je+"]: "+V+`
`+Z+`
`+Vt})}function jn(A,V,Z,ce,Je,pt,Vt){A.info(function(){return"XMLHTTP RESP ("+ce+") [ attempt "+Je+"]: "+V+`
`+Z+`
`+pt+" "+Vt})}function Kr(A,V,Z,ce){A.info(function(){return"XMLHTTP TEXT ("+V+"): "+ai(A,Z)+(ce?" "+ce:"")})}function kt(A,V){A.info(function(){return"TIMEOUT: "+V})}Cn.prototype.info=function(){};function ai(A,V){if(!A.g)return V;if(!V)return null;try{var Z=JSON.parse(V);if(Z){for(A=0;A<Z.length;A++)if(Array.isArray(Z[A])){var ce=Z[A];if(!(2>ce.length)){var Je=ce[1];if(Array.isArray(Je)&&!(1>Je.length)){var pt=Je[0];if(pt!="noop"&&pt!="stop"&&pt!="close")for(var Vt=1;Vt<Je.length;Vt++)Je[Vt]=""}}}}return ue(Z)}catch{return V}}var cr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},va={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ba;function Dt(){}re(Dt,$e),Dt.prototype.g=function(){return new XMLHttpRequest},Dt.prototype.i=function(){return{}},ba=new Dt;function hn(A,V,Z,ce){this.j=A,this.i=V,this.l=Z,this.R=ce||1,this.U=new Ge(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new nn}function nn(){this.i=null,this.g="",this.h=!1}var ha={},il={};function ki(A,V,Z){A.L=1,A.v=No(Ya(V)),A.m=Z,A.P=!0,yn(A,null)}function yn(A,V){A.F=Date.now(),kr(A),A.A=Ya(A.v);var Z=A.A,ce=A.R;Array.isArray(ce)||(ce=[String(ce)]),Nl(Z.i,"t",ce),A.C=0,Z=A.j.J,A.h=new nn,A.g=fd(A.j,Z?V:null,!A.m),0<A.O&&(A.M=new so($(A.Y,A,A.g),A.O)),V=A.U,Z=A.g,ce=A.ca;var Je="readystatechange";Array.isArray(Je)||(Je&&(ne[0]=Je.toString()),Je=ne);for(var pt=0;pt<Je.length;pt++){var Vt=rl(Z,Je[pt],ce||V.handleEvent,!1,V.h||V);if(!Vt)break;V.g[Vt.key]=Vt}V=A.H?se(A.H):{},A.m?(A.u||(A.u="POST"),V["Content-Type"]="application/x-www-form-urlencoded",A.g.ea(A.A,A.u,A.m,V)):(A.u="GET",A.g.ea(A.A,A.u,null,V)),jt(),cn(A.i,A.u,A.A,A.l,A.R,A.m)}hn.prototype.ca=function(A){A=A.target;const V=this.M;V&&Sa(A)==3?V.j():this.Y(A)},hn.prototype.Y=function(A){try{if(A==this.g)e:{const ei=Sa(this.g);var V=this.g.Ba();const ul=this.g.Z();if(!(3>ei)&&(ei!=3||this.g&&(this.h.h||this.g.oa()||Qa(this.g)))){this.J||ei!=4||V==7||(V==8||0>=ul?jt(3):jt(2)),Ns(this);var Z=this.g.Z();this.X=Z;t:if(Os(this)){var ce=Qa(this.g);A="";var Je=ce.length,pt=Sa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yi(this),ra(this);var Vt="";break t}this.h.i=new c.TextDecoder}for(V=0;V<Je;V++)this.h.h=!0,A+=this.h.i.decode(ce[V],{stream:!(pt&&V==Je-1)});ce.length=0,this.h.g+=A,this.C=0,Vt=this.h.g}else Vt=this.g.oa();if(this.o=Z==200,jn(this.i,this.u,this.A,this.l,this.R,ei,Z),this.o){if(this.T&&!this.K){t:{if(this.g){var Gn,Ni=this.g;if((Gn=Ni.g?Ni.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!He(Gn)){var Hn=Gn;break t}}Hn=null}if(Z=Hn)Kr(this.i,this.l,Z,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gi(this,Z);else{this.o=!1,this.s=3,Xt(12),yi(this),ra(this);break e}}if(this.P){Z=!0;let sa;for(;!this.J&&this.C<Vt.length;)if(sa=Do(this,Vt),sa==il){ei==4&&(this.s=4,Xt(14),Z=!1),Kr(this.i,this.l,null,"[Incomplete Response]");break}else if(sa==ha){this.s=4,Xt(15),Kr(this.i,this.l,Vt,"[Invalid Chunk]"),Z=!1;break}else Kr(this.i,this.l,sa,null),Gi(this,sa);if(Os(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ei!=4||Vt.length!=0||this.h.h||(this.s=1,Xt(16),Z=!1),this.o=this.o&&Z,!Z)Kr(this.i,this.l,Vt,"[Invalid Chunked Response]"),yi(this),ra(this);else if(0<Vt.length&&!this.W){this.W=!0;var Zi=this.j;Zi.g==this&&Zi.ba&&!Zi.M&&(Zi.j.info("Great, no buffering proxy detected. Bytes received: "+Vt.length),_i(Zi),Zi.M=!0,Xt(11))}}else Kr(this.i,this.l,Vt,null),Gi(this,Vt);ei==4&&yi(this),this.o&&!this.J&&(ei==4?da(this.j,this):(this.o=!1,kr(this)))}else Oi(this.g),Z==400&&0<Vt.indexOf("Unknown SID")?(this.s=3,Xt(12)):(this.s=0,Xt(13)),yi(this),ra(this)}}}catch{}finally{}};function Os(A){return A.g?A.u=="GET"&&A.L!=2&&A.j.Ca:!1}function Do(A,V){var Z=A.C,ce=V.indexOf(`
`,Z);return ce==-1?il:(Z=Number(V.substring(Z,ce)),isNaN(Z)?ha:(ce+=1,ce+Z>V.length?il:(V=V.slice(ce,ce+Z),A.C=ce+Z,V)))}hn.prototype.cancel=function(){this.J=!0,yi(this)};function kr(A){A.S=Date.now()+A.I,Ll(A,A.I)}function Ll(A,V){if(A.B!=null)throw Error("WatchDog timer not null");A.B=vn($(A.ba,A),V)}function Ns(A){A.B&&(c.clearTimeout(A.B),A.B=null)}hn.prototype.ba=function(){this.B=null;const A=Date.now();0<=A-this.S?(kt(this.i,this.A),this.L!=2&&(jt(),Xt(17)),yi(this),this.s=2,ra(this)):Ll(this,this.S-A)};function ra(A){A.j.G==0||A.J||da(A.j,A)}function yi(A){Ns(A);var V=A.M;V&&typeof V.ma=="function"&&V.ma(),A.M=null,ie(A.U),A.g&&(V=A.g,A.g=null,V.abort(),V.ma())}function Gi(A,V){try{var Z=A.j;if(Z.G!=0&&(Z.g==A||oo(Z.h,A))){if(!A.K&&oo(Z.h,A)&&Z.G==3){try{var ce=Z.Da.g.parse(V)}catch{ce=null}if(Array.isArray(ce)&&ce.length==3){var Je=ce;if(Je[0]==0){e:if(!Z.u){if(Z.g)if(Z.g.F+3e3<A.F)aa(Z),Xr(Z);else break e;yh(Z),Xt(18)}}else Z.za=Je[1],0<Z.za-Z.T&&37500>Je[2]&&Z.F&&Z.v==0&&!Z.C&&(Z.C=vn($(Z.Za,Z),6e3));if(1>=al(Z.h)&&Z.ca){try{Z.ca()}catch{}Z.ca=void 0}}else ps(Z,11)}else if((A.K||Z.g==A)&&aa(Z),!He(V))for(Je=Z.Da.g.parse(V),V=0;V<Je.length;V++){let Hn=Je[V];if(Z.T=Hn[0],Hn=Hn[1],Z.G==2)if(Hn[0]=="c"){Z.K=Hn[1],Z.ia=Hn[2];const Zi=Hn[3];Zi!=null&&(Z.la=Zi,Z.j.info("VER="+Z.la));const ei=Hn[4];ei!=null&&(Z.Aa=ei,Z.j.info("SVER="+Z.Aa));const ul=Hn[5];ul!=null&&typeof ul=="number"&&0<ul&&(ce=1.5*ul,Z.L=ce,Z.j.info("backChannelRequestTimeoutMs_="+ce)),ce=Z;const sa=A.g;if(sa){const Vo=sa.g?sa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vo){var pt=ce.h;pt.g||Vo.indexOf("spdy")==-1&&Vo.indexOf("quic")==-1&&Vo.indexOf("h2")==-1||(pt.j=pt.l,pt.g=new Set,pt.h&&(us(pt,pt.h),pt.h=null))}if(ce.D){const jl=sa.g?sa.g.getResponseHeader("X-HTTP-Session-Id"):null;jl&&(ce.ya=jl,Sr(ce.I,ce.D,jl))}}Z.G=3,Z.l&&Z.l.ua(),Z.ba&&(Z.R=Date.now()-A.F,Z.j.info("Handshake RTT: "+Z.R+"ms")),ce=Z;var Vt=A;if(ce.qa=Sc(ce,ce.J?ce.ia:null,ce.W),Vt.K){xa(ce.h,Vt);var Gn=Vt,Ni=ce.L;Ni&&(Gn.I=Ni),Gn.B&&(Ns(Gn),kr(Gn)),ce.g=Vt}else Tc(ce);0<Z.i.length&&po(Z)}else Hn[0]!="stop"&&Hn[0]!="close"||ps(Z,7);else Z.G==3&&(Hn[0]=="stop"||Hn[0]=="close"?Hn[0]=="stop"?ps(Z,7):Fo(Z):Hn[0]!="noop"&&Z.l&&Z.l.ta(Hn),Z.v=0)}}jt(4)}catch{}}var Dr=class{constructor(A,V){this.g=A,this.map=V}};function Lo(A){this.l=A||10,c.PerformanceNavigationTiming?(A=c.performance.getEntriesByType("navigation"),A=0<A.length&&(A[0].nextHopProtocol=="hq"||A[0].nextHopProtocol=="h2")):A=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=A?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function zo(A){return A.h?!0:A.g?A.g.size>=A.j:!1}function al(A){return A.h?1:A.g?A.g.size:0}function oo(A,V){return A.h?A.h==V:A.g?A.g.has(V):!1}function us(A,V){A.g?A.g.add(V):A.h=V}function xa(A,V){A.h&&A.h==V?A.h=null:A.g&&A.g.has(V)&&A.g.delete(V)}Lo.prototype.cancel=function(){if(this.i=bc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const A of this.g.values())A.cancel();this.g.clear()}};function bc(A){if(A.h!=null)return A.i.concat(A.h.D);if(A.g!=null&&A.g.size!==0){let V=A.i;for(const Z of A.g.values())V=V.concat(Z.D);return V}return Me(A.i)}function dd(A){if(A.V&&typeof A.V=="function")return A.V();if(typeof Map<"u"&&A instanceof Map||typeof Set<"u"&&A instanceof Set)return Array.from(A.values());if(typeof A=="string")return A.split("");if(M(A)){for(var V=[],Z=A.length,ce=0;ce<Z;ce++)V.push(A[ce]);return V}V=[],Z=0;for(ce in A)V[Z++]=A[ce];return V}function lo(A){if(A.na&&typeof A.na=="function")return A.na();if(!A.V||typeof A.V!="function"){if(typeof Map<"u"&&A instanceof Map)return Array.from(A.keys());if(!(typeof Set<"u"&&A instanceof Set)){if(M(A)||typeof A=="string"){var V=[];A=A.length;for(var Z=0;Z<A;Z++)V.push(Z);return V}V=[],Z=0;for(const ce in A)V[Z++]=ce;return V}}}function xc(A,V){if(A.forEach&&typeof A.forEach=="function")A.forEach(V,void 0);else if(M(A)||typeof A=="string")Array.prototype.forEach.call(A,V,void 0);else for(var Z=lo(A),ce=dd(A),Je=ce.length,pt=0;pt<Je;pt++)V.call(void 0,ce[pt],Z&&Z[pt],A)}var zl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wu(A,V){if(A){A=A.split("&");for(var Z=0;Z<A.length;Z++){var ce=A[Z].indexOf("="),Je=null;if(0<=ce){var pt=A[Z].substring(0,ce);Je=A[Z].substring(ce+1)}else pt=A[Z];V(pt,Je?decodeURIComponent(Je.replace(/\+/g," ")):"")}}}function Di(A){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,A instanceof Di){this.h=A.h,Bs(this,A.j),this.o=A.o,this.g=A.g,Oo(this,A.s),this.l=A.l;var V=A.i,Z=new Li;Z.i=V.i,V.g&&(Z.g=new Map(V.g),Z.h=V.h),uo(this,Z),this.m=A.m}else A&&(V=String(A).match(zl))?(this.h=!1,Bs(this,V[1]||"",!0),this.o=Na(V[2]||""),this.g=Na(V[3]||"",!0),Oo(this,V[4]),this.l=Na(V[5]||"",!0),uo(this,V[6]||"",!0),this.m=Na(V[7]||"")):(this.h=!1,this.i=new Li(null,this.h))}Di.prototype.toString=function(){var A=[],V=this.j;V&&A.push(wa(V,cs,!0),":");var Z=this.g;return(Z||V=="file")&&(A.push("//"),(V=this.o)&&A.push(wa(V,cs,!0),"@"),A.push(encodeURIComponent(String(Z)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),Z=this.s,Z!=null&&A.push(":",String(Z))),(Z=this.l)&&(this.g&&Z.charAt(0)!="/"&&A.push("/"),A.push(wa(Z,Z.charAt(0)=="/"?sl:hs,!0))),(Z=this.i.toString())&&A.push("?",Z),(Z=this.m)&&A.push("#",wa(Z,Ol)),A.join("")};function Ya(A){return new Di(A)}function Bs(A,V,Z){A.j=Z?Na(V,!0):V,A.j&&(A.j=A.j.replace(/:$/,""))}function Oo(A,V){if(V){if(V=Number(V),isNaN(V)||0>V)throw Error("Bad port number "+V);A.s=V}else A.s=null}function uo(A,V,Z){V instanceof Li?(A.i=V,Hi(A.i,A.h)):(Z||(V=wa(V,mh)),A.i=new Li(V,A.h))}function Sr(A,V,Z){A.i.set(V,Z)}function No(A){return Sr(A,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),A}function Na(A,V){return A?V?decodeURI(A.replace(/%25/g,"%2525")):decodeURIComponent(A):""}function wa(A,V,Z){return typeof A=="string"?(A=encodeURI(A).replace(V,Ln),Z&&(A=A.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A):null}function Ln(A){return A=A.charCodeAt(0),"%"+(A>>4&15).toString(16)+(A&15).toString(16)}var cs=/[#\/\?@]/g,hs=/[#\?:]/g,sl=/[#\?]/g,mh=/[#\?@]/g,Ol=/#/g;function Li(A,V){this.h=this.g=null,this.i=A||null,this.j=!!V}function zi(A){A.g||(A.g=new Map,A.h=0,A.i&&wu(A.i,function(V,Z){A.add(decodeURIComponent(V.replace(/\+/g," ")),Z)}))}r=Li.prototype,r.add=function(A,V){zi(this),this.i=null,A=Fs(this,A);var Z=this.g.get(A);return Z||this.g.set(A,Z=[]),Z.push(V),this.h+=1,this};function wn(A,V){zi(A),V=Fs(A,V),A.g.has(V)&&(A.i=null,A.h-=A.g.get(V).length,A.g.delete(V))}function ds(A,V){return zi(A),V=Fs(A,V),A.g.has(V)}r.forEach=function(A,V){zi(this),this.g.forEach(function(Z,ce){Z.forEach(function(Je){A.call(V,Je,ce,this)},this)},this)},r.na=function(){zi(this);const A=Array.from(this.g.values()),V=Array.from(this.g.keys()),Z=[];for(let ce=0;ce<V.length;ce++){const Je=A[ce];for(let pt=0;pt<Je.length;pt++)Z.push(V[ce])}return Z},r.V=function(A){zi(this);let V=[];if(typeof A=="string")ds(this,A)&&(V=V.concat(this.g.get(Fs(this,A))));else{A=Array.from(this.g.values());for(let Z=0;Z<A.length;Z++)V=V.concat(A[Z])}return V},r.set=function(A,V){return zi(this),this.i=null,A=Fs(this,A),ds(this,A)&&(this.h-=this.g.get(A).length),this.g.set(A,[V]),this.h+=1,this},r.get=function(A,V){return A?(A=this.V(A),0<A.length?String(A[0]):V):V};function Nl(A,V,Z){wn(A,V),0<Z.length&&(A.i=null,A.g.set(Fs(A,V),Me(Z)),A.h+=Z.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const A=[],V=Array.from(this.g.keys());for(var Z=0;Z<V.length;Z++){var ce=V[Z];const pt=encodeURIComponent(String(ce)),Vt=this.V(ce);for(ce=0;ce<Vt.length;ce++){var Je=pt;Vt[ce]!==""&&(Je+="="+encodeURIComponent(String(Vt[ce]))),A.push(Je)}}return this.i=A.join("&")};function Fs(A,V){return V=String(V),A.j&&(V=V.toLowerCase()),V}function Hi(A,V){V&&!A.j&&(zi(A),A.i=null,A.g.forEach(function(Z,ce){var Je=ce.toLowerCase();ce!=Je&&(wn(this,ce),Nl(this,Je,Z))},A)),A.j=V}function Ur(A,V){const Z=new Cn;if(c.Image){const ce=new Image;ce.onload=W(Er,Z,"TestLoadImage: loaded",!0,V,ce),ce.onerror=W(Er,Z,"TestLoadImage: error",!1,V,ce),ce.onabort=W(Er,Z,"TestLoadImage: abort",!1,V,ce),ce.ontimeout=W(Er,Z,"TestLoadImage: timeout",!1,V,ce),c.setTimeout(function(){ce.ontimeout&&ce.ontimeout()},1e4),ce.src=A}else V(!1)}function qr(A,V){const Z=new Cn,ce=new AbortController,Je=setTimeout(()=>{ce.abort(),Er(Z,"TestPingServer: timeout",!1,V)},1e4);fetch(A,{signal:ce.signal}).then(pt=>{clearTimeout(Je),pt.ok?Er(Z,"TestPingServer: ok",!0,V):Er(Z,"TestPingServer: server error",!1,V)}).catch(()=>{clearTimeout(Je),Er(Z,"TestPingServer: error",!1,V)})}function Er(A,V,Z,ce,Je){try{Je&&(Je.onload=null,Je.onerror=null,Je.onabort=null,Je.ontimeout=null),ce(Z)}catch{}}function pr(){this.g=new Oe}function fs(A,V,Z){const ce=Z||"";try{xc(A,function(Je,pt){let Vt=Je;R(Je)&&(Vt=ue(Je)),V.push(ce+pt+"="+encodeURIComponent(Vt))})}catch(Je){throw V.push(ce+"type="+encodeURIComponent("_badmap")),Je}}function In(A){this.l=A.Ub||null,this.j=A.eb||!1}re(In,$e),In.prototype.g=function(){return new fi(this.l,this.j)},In.prototype.i=function(A){return function(){return A}}({});function fi(A,V){fr.call(this),this.D=A,this.o=V,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}re(fi,fr),r=fi.prototype,r.open=function(A,V){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=A,this.A=V,this.readyState=1,Ta(this)},r.send=function(A){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const V={headers:this.u,method:this.B,credentials:this.m,cache:void 0};A&&(V.body=A),(this.D||c).fetch(new Request(this.A,V)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,mn(this)),this.readyState=0},r.Sa=function(A){if(this.g&&(this.l=A,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=A.headers,this.readyState=2,Ta(this)),this.g&&(this.readyState=3,Ta(this),this.g)))if(this.responseType==="arraybuffer")A.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in A){if(this.j=A.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_n(this)}else A.text().then(this.Ra.bind(this),this.ga.bind(this))};function _n(A){A.j.read().then(A.Pa.bind(A)).catch(A.ga.bind(A))}r.Pa=function(A){if(this.g){if(this.o&&A.value)this.response.push(A.value);else if(!this.o){var V=A.value?A.value:new Uint8Array(0);(V=this.v.decode(V,{stream:!A.done}))&&(this.response=this.responseText+=V)}A.done?mn(this):Ta(this),this.readyState==3&&_n(this)}},r.Ra=function(A){this.g&&(this.response=this.responseText=A,mn(this))},r.Qa=function(A){this.g&&(this.response=A,mn(this))},r.ga=function(){this.g&&mn(this)};function mn(A){A.readyState=4,A.l=null,A.j=null,A.v=null,Ta(A)}r.setRequestHeader=function(A,V){this.u.append(A,V)},r.getResponseHeader=function(A){return this.h&&this.h.get(A.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const A=[],V=this.h.entries();for(var Z=V.next();!Z.done;)Z=Z.value,A.push(Z[0]+": "+Z[1]),Z=V.next();return A.join(`\r
`)};function Ta(A){A.onreadystatechange&&A.onreadystatechange.call(A)}Object.defineProperty(fi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(A){this.m=A?"include":"same-origin"}});function ln(A){let V="";return Ze(A,function(Z,ce){V+=ce,V+=":",V+=Z,V+=`\r
`}),V}function Jr(A,V,Z){e:{for(ce in Z){var ce=!1;break e}ce=!0}ce||(Z=ln(Z),typeof A=="string"?Z!=null&&encodeURIComponent(String(Z)):Sr(A,V,Z))}function Dn(A){fr.call(this),this.headers=new Map,this.o=A||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}re(Dn,fr);var co=/^https?$/i,ia=["POST","PUT"];r=Dn.prototype,r.Ha=function(A){this.J=A},r.ea=function(A,V,Z,ce){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+A);V=V?V.toUpperCase():"GET",this.D=A,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ba.g(),this.v=this.o?tt(this.o):tt(ba),this.g.onreadystatechange=$(this.Ea,this);try{this.B=!0,this.g.open(V,String(A),!0),this.B=!1}catch(pt){wc(this,pt);return}if(A=Z||"",Z=new Map(this.headers),ce)if(Object.getPrototypeOf(ce)===Object.prototype)for(var Je in ce)Z.set(Je,ce[Je]);else if(typeof ce.keys=="function"&&typeof ce.get=="function")for(const pt of ce.keys())Z.set(pt,ce.get(pt));else throw Error("Unknown input type for opt_headers: "+String(ce));ce=Array.from(Z.keys()).find(pt=>pt.toLowerCase()=="content-type"),Je=c.FormData&&A instanceof c.FormData,!(0<=Array.prototype.indexOf.call(ia,V,void 0))||ce||Je||Z.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pt,Vt]of Z)this.g.setRequestHeader(pt,Vt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{fo(this),this.u=!0,this.g.send(A),this.u=!1}catch(pt){wc(this,pt)}};function wc(A,V){A.h=!1,A.g&&(A.j=!0,A.g.abort(),A.j=!1),A.l=V,A.m=5,Ba(A),ho(A)}function Ba(A){A.A||(A.A=!0,Bn(A,"complete"),Bn(A,"error"))}r.abort=function(A){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=A||7,Bn(this,"complete"),Bn(this,"abort"),ho(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ho(this,!0)),Dn.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Tu(this):this.bb())},r.bb=function(){Tu(this)};function Tu(A){if(A.h&&typeof y<"u"&&(!A.v[1]||Sa(A)!=4||A.Z()!=2)){if(A.u&&Sa(A)==4)Ri(A.Ea,0,A);else if(Bn(A,"readystatechange"),Sa(A)==4){A.h=!1;try{const Vt=A.Z();e:switch(Vt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var V=!0;break e;default:V=!1}var Z;if(!(Z=V)){var ce;if(ce=Vt===0){var Je=String(A.D).match(zl)[1]||null;!Je&&c.self&&c.self.location&&(Je=c.self.location.protocol.slice(0,-1)),ce=!co.test(Je?Je.toLowerCase():"")}Z=ce}if(Z)Bn(A,"complete"),Bn(A,"success");else{A.m=6;try{var pt=2<Sa(A)?A.g.statusText:""}catch{pt=""}A.l=pt+" ["+A.Z()+"]",Ba(A)}}finally{ho(A)}}}}function ho(A,V){if(A.g){fo(A);const Z=A.g,ce=A.v[0]?()=>{}:null;A.g=null,A.v=null,V||Bn(A,"ready");try{Z.onreadystatechange=ce}catch{}}}function fo(A){A.I&&(c.clearTimeout(A.I),A.I=null)}r.isActive=function(){return!!this.g};function Sa(A){return A.g?A.g.readyState:0}r.Z=function(){try{return 2<Sa(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(A){if(this.g){var V=this.g.responseText;return A&&V.indexOf(A)==0&&(V=V.substring(A.length)),Te(V)}};function Qa(A){try{if(!A.g)return null;if("response"in A.g)return A.g.response;switch(A.H){case"":case"text":return A.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in A.g)return A.g.mozResponseArrayBuffer}return null}catch{return null}}function Oi(A){const V={};A=(A.g&&2<=Sa(A)&&A.g.getAllResponseHeaders()||"").split(`\r
`);for(let ce=0;ce<A.length;ce++){if(He(A[ce]))continue;var Z=Ee(A[ce]);const Je=Z[0];if(Z=Z[1],typeof Z!="string")continue;Z=Z.trim();const pt=V[Je]||[];V[Je]=pt,pt.push(Z)}me(V,function(ce){return ce.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vs(A,V,Z){return Z&&Z.internalChannelParams&&Z.internalChannelParams[A]||V}function Bo(A){this.Aa=0,this.i=[],this.j=new Cn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Vs("failFast",!1,A),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Vs("baseRetryDelayMs",5e3,A),this.cb=Vs("retryDelaySeedMs",1e4,A),this.Wa=Vs("forwardChannelMaxRetries",2,A),this.wa=Vs("forwardChannelRequestTimeoutMs",2e4,A),this.pa=A&&A.xmlHttpFactory||void 0,this.Xa=A&&A.Tb||void 0,this.Ca=A&&A.useFetchStreams||!1,this.L=void 0,this.J=A&&A.supportsCrossDomainXhr||!1,this.K="",this.h=new Lo(A&&A.concurrentRequestLimit),this.Da=new pr,this.P=A&&A.fastHandshake||!1,this.O=A&&A.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=A&&A.Rb||!1,A&&A.xa&&this.j.xa(),A&&A.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&A&&A.detectBufferingProxy||!1,this.ja=void 0,A&&A.longPollingTimeout&&0<A.longPollingTimeout&&(this.ja=A.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Bo.prototype,r.la=8,r.G=1,r.connect=function(A,V,Z,ce){Xt(0),this.W=A,this.H=V||{},Z&&ce!==void 0&&(this.H.OSID=Z,this.H.OAID=ce),this.F=this.X,this.I=Sc(this,null,this.W),po(this)};function Fo(A){if(Bl(A),A.G==3){var V=A.U++,Z=Ya(A.I);if(Sr(Z,"SID",A.K),Sr(Z,"RID",V),Sr(Z,"TYPE","terminate"),Ja(A,Z),V=new hn(A,A.j,V),V.L=2,V.v=No(Ya(Z)),Z=!1,c.navigator&&c.navigator.sendBeacon)try{Z=c.navigator.sendBeacon(V.v.toString(),"")}catch{}!Z&&c.Image&&(new Image().src=V.v,Z=!0),Z||(V.g=fd(V.j,null),V.g.ea(V.v)),V.F=Date.now(),kr(V)}ll(A)}function Xr(A){A.g&&(_i(A),A.g.cancel(),A.g=null)}function Bl(A){Xr(A),A.u&&(c.clearTimeout(A.u),A.u=null),aa(A),A.h.cancel(),A.s&&(typeof A.s=="number"&&c.clearTimeout(A.s),A.s=null)}function po(A){if(!zo(A.h)&&!A.s){A.s=!0;var V=A.Ga;Mt||Re(),Tt||(Mt(),Tt=!0),Gt.add(V,A),A.B=0}}function Fl(A,V){return al(A.h)>=A.h.j-(A.s?1:0)?!1:A.s?(A.i=V.D.concat(A.i),!0):A.G==1||A.G==2||A.B>=(A.Va?0:A.Wa)?!1:(A.s=vn($(A.Ga,A,V),Su(A,A.B)),A.B++,!0)}r.Ga=function(A){if(this.s)if(this.s=null,this.G==1){if(!A){this.U=Math.floor(1e5*Math.random()),A=this.U++;const Je=new hn(this,this.j,A);let pt=this.o;if(this.S&&(pt?(pt=se(pt),we(pt,this.S)):pt=this.S),this.m!==null||this.O||(Je.H=pt,pt=null),this.P)e:{for(var V=0,Z=0;Z<this.i.length;Z++){t:{var ce=this.i[Z];if("__data__"in ce.map&&(ce=ce.map.__data__,typeof ce=="string")){ce=ce.length;break t}ce=void 0}if(ce===void 0)break;if(V+=ce,4096<V){V=Z;break e}if(V===4096||Z===this.i.length-1){V=Z+1;break e}}V=1e3}else V=1e3;V=Vl(this,Je,V),Z=Ya(this.I),Sr(Z,"RID",A),Sr(Z,"CVER",22),this.D&&Sr(Z,"X-HTTP-Session-Id",this.D),Ja(this,Z),pt&&(this.O?V="headers="+encodeURIComponent(String(ln(pt)))+"&"+V:this.m&&Jr(Z,this.m,pt)),us(this.h,Je),this.Ua&&Sr(Z,"TYPE","init"),this.P?(Sr(Z,"$req",V),Sr(Z,"SID","null"),Je.T=!0,ki(Je,Z,null)):ki(Je,Z,V),this.G=2}}else this.G==3&&(A?gh(this,A):this.i.length==0||zo(this.h)||gh(this))};function gh(A,V){var Z;V?Z=V.l:Z=A.U++;const ce=Ya(A.I);Sr(ce,"SID",A.K),Sr(ce,"RID",Z),Sr(ce,"AID",A.T),Ja(A,ce),A.m&&A.o&&Jr(ce,A.m,A.o),Z=new hn(A,A.j,Z,A.B+1),A.m===null&&(Z.H=A.o),V&&(A.i=V.D.concat(A.i)),V=Vl(A,Z,1e3),Z.I=Math.round(.5*A.wa)+Math.round(.5*A.wa*Math.random()),us(A.h,Z),ki(Z,ce,V)}function Ja(A,V){A.H&&Ze(A.H,function(Z,ce){Sr(V,ce,Z)}),A.l&&xc({},function(Z,ce){Sr(V,ce,Z)})}function Vl(A,V,Z){Z=Math.min(A.i.length,Z);var ce=A.l?$(A.l.Na,A.l,A):null;e:{var Je=A.i;let pt=-1;for(;;){const Vt=["count="+Z];pt==-1?0<Z?(pt=Je[0].g,Vt.push("ofs="+pt)):pt=0:Vt.push("ofs="+pt);let Gn=!0;for(let Ni=0;Ni<Z;Ni++){let Hn=Je[Ni].g;const Zi=Je[Ni].map;if(Hn-=pt,0>Hn)pt=Math.max(0,Je[Ni].g-100),Gn=!1;else try{fs(Zi,Vt,"req"+Hn+"_")}catch{ce&&ce(Zi)}}if(Gn){ce=Vt.join("&");break e}}}return A=A.i.splice(0,Z),V.D=A,ce}function Tc(A){if(!A.g&&!A.u){A.Y=1;var V=A.Fa;Mt||Re(),Tt||(Mt(),Tt=!0),Gt.add(V,A),A.v=0}}function yh(A){return A.g||A.u||3<=A.v?!1:(A.Y++,A.u=vn($(A.Fa,A),Su(A,A.v)),A.v++,!0)}r.Fa=function(){if(this.u=null,ol(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var A=2*this.R;this.j.info("BP detection timer enabled: "+A),this.A=vn($(this.ab,this),A)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Xt(10),Xr(this),ol(this))};function _i(A){A.A!=null&&(c.clearTimeout(A.A),A.A=null)}function ol(A){A.g=new hn(A,A.j,"rpc",A.Y),A.m===null&&(A.g.H=A.o),A.g.O=0;var V=Ya(A.qa);Sr(V,"RID","rpc"),Sr(V,"SID",A.K),Sr(V,"AID",A.T),Sr(V,"CI",A.F?"0":"1"),!A.F&&A.ja&&Sr(V,"TO",A.ja),Sr(V,"TYPE","xmlhttp"),Ja(A,V),A.m&&A.o&&Jr(V,A.m,A.o),A.L&&(A.g.I=A.L);var Z=A.g;A=A.ia,Z.L=1,Z.v=No(Ya(V)),Z.m=null,Z.P=!0,yn(Z,A)}r.Za=function(){this.C!=null&&(this.C=null,Xr(this),yh(this),Xt(19))};function aa(A){A.C!=null&&(c.clearTimeout(A.C),A.C=null)}function da(A,V){var Z=null;if(A.g==V){aa(A),_i(A),A.g=null;var ce=2}else if(oo(A.h,V))Z=V.D,xa(A.h,V),ce=1;else return;if(A.G!=0){if(V.o)if(ce==1){Z=V.m?V.m.length:0,V=Date.now()-V.F;var Je=A.B;ce=Ot(),Bn(ce,new An(ce,Z)),po(A)}else Tc(A);else if(Je=V.s,Je==3||Je==0&&0<V.X||!(ce==1&&Fl(A,V)||ce==2&&yh(A)))switch(Z&&0<Z.length&&(V=A.h,V.i=V.i.concat(Z)),Je){case 1:ps(A,5);break;case 4:ps(A,10);break;case 3:ps(A,6);break;default:ps(A,2)}}}function Su(A,V){let Z=A.Ta+Math.floor(Math.random()*A.cb);return A.isActive()||(Z*=2),Z*V}function ps(A,V){if(A.j.info("Error code "+V),V==2){var Z=$(A.fb,A),ce=A.Xa;const Je=!ce;ce=new Di(ce||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Bs(ce,"https"),No(ce),Je?Ur(ce.toString(),Z):qr(ce.toString(),Z)}else Xt(2);A.G=0,A.l&&A.l.sa(V),ll(A),Bl(A)}r.fb=function(A){A?(this.j.info("Successfully pinged google.com"),Xt(2)):(this.j.info("Failed to ping google.com"),Xt(1))};function ll(A){if(A.G=0,A.ka=[],A.l){const V=bc(A.h);(V.length!=0||A.i.length!=0)&&(Ce(A.ka,V),Ce(A.ka,A.i),A.h.i.length=0,Me(A.i),A.i.length=0),A.l.ra()}}function Sc(A,V,Z){var ce=Z instanceof Di?Ya(Z):new Di(Z);if(ce.g!="")V&&(ce.g=V+"."+ce.g),Oo(ce,ce.s);else{var Je=c.location;ce=Je.protocol,V=V?V+"."+Je.hostname:Je.hostname,Je=+Je.port;var pt=new Di(null);ce&&Bs(pt,ce),V&&(pt.g=V),Je&&Oo(pt,Je),Z&&(pt.l=Z),ce=pt}return Z=A.D,V=A.ya,Z&&V&&Sr(ce,Z,V),Sr(ce,"VER",A.la),Ja(A,ce),ce}function fd(A,V,Z){if(V&&!A.J)throw Error("Can't create secondary domain capable XhrIo object.");return V=A.Ca&&!A.pa?new Dn(new In({eb:Z})):new Dn(A.pa),V.Ha(A.J),V}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function pd(){}r=pd.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Ec(){}Ec.prototype.g=function(A,V){return new Fa(A,V)};function Fa(A,V){fr.call(this),this.g=new Bo(V),this.l=A,this.h=V&&V.messageUrlParams||null,A=V&&V.messageHeaders||null,V&&V.clientProtocolHeaderRequired&&(A?A["X-Client-Protocol"]="webchannel":A={"X-Client-Protocol":"webchannel"}),this.g.o=A,A=V&&V.initMessageHeaders||null,V&&V.messageContentType&&(A?A["X-WebChannel-Content-Type"]=V.messageContentType:A={"X-WebChannel-Content-Type":V.messageContentType}),V&&V.va&&(A?A["X-WebChannel-Client-Profile"]=V.va:A={"X-WebChannel-Client-Profile":V.va}),this.g.S=A,(A=V&&V.Sb)&&!He(A)&&(this.g.m=A),this.v=V&&V.supportsCrossDomainXhr||!1,this.u=V&&V.sendRawJson||!1,(V=V&&V.httpSessionIdParam)&&!He(V)&&(this.g.D=V,A=this.h,A!==null&&V in A&&(A=this.h,V in A&&delete A[V])),this.j=new ms(this)}re(Fa,fr),Fa.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Fa.prototype.close=function(){Fo(this.g)},Fa.prototype.o=function(A){var V=this.g;if(typeof A=="string"){var Z={};Z.__data__=A,A=Z}else this.u&&(Z={},Z.__data__=ue(A),A=Z);V.i.push(new Dr(V.Ya++,A)),V.G==3&&po(V)},Fa.prototype.N=function(){this.g.l=null,delete this.j,Fo(this.g),delete this.g,Fa.aa.N.call(this)};function Eu(A){st.call(this),A.__headers__&&(this.headers=A.__headers__,this.statusCode=A.__status__,delete A.__headers__,delete A.__status__);var V=A.__sm__;if(V){e:{for(const Z in V){A=Z;break e}A=void 0}(this.i=A)&&(A=this.i,V=V!==null&&A in V?V[A]:void 0),this.data=V}else this.data=A}re(Eu,st);function Au(){Ke.call(this),this.status=1}re(Au,Ke);function ms(A){this.g=A}re(ms,pd),ms.prototype.ua=function(){Bn(this.g,"a")},ms.prototype.ta=function(A){Bn(this.g,new Eu(A))},ms.prototype.sa=function(A){Bn(this.g,new Au)},ms.prototype.ra=function(){Bn(this.g,"b")},Ec.prototype.createWebChannel=Ec.prototype.g,Fa.prototype.send=Fa.prototype.o,Fa.prototype.open=Fa.prototype.m,Fa.prototype.close=Fa.prototype.close,tC=function(){return new Ec},eC=function(){return Ot()},JA=mt,Nx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cr.NO_ERROR=0,cr.TIMEOUT=8,cr.HTTP_ERROR=6,Kv=cr,va.COMPLETE="complete",QA=va,je.EventType=ht,ht.OPEN="a",ht.CLOSE="b",ht.ERROR="c",ht.MESSAGE="d",fr.prototype.listen=fr.prototype.K,jy=je,Dn.prototype.listenOnce=Dn.prototype.L,Dn.prototype.getLastError=Dn.prototype.Ka,Dn.prototype.getLastErrorCode=Dn.prototype.Ba,Dn.prototype.getStatus=Dn.prototype.Z,Dn.prototype.getResponseJson=Dn.prototype.Oa,Dn.prototype.getResponseText=Dn.prototype.oa,Dn.prototype.send=Dn.prototype.ea,Dn.prototype.setWithCredentials=Dn.prototype.Ha,YA=Dn}).apply(typeof Pv<"u"?Pv:typeof self<"u"?self:typeof window<"u"?window:{});const bT="@firebase/firestore",xT="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}to.UNAUTHENTICATED=new to(null),to.GOOGLE_CREDENTIALS=new to("google-credentials-uid"),to.FIRST_PARTY=new to("first-party-uid"),to.MOCK_USER=new to("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _g="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp=new U1("@firebase/firestore");function Bm(){return Vp.logLevel}function en(r,...e){if(Vp.logLevel<=lr.DEBUG){const t=e.map(ew);Vp.debug(`Firestore (${_g}): ${r}`,...t)}}function rd(r,...e){if(Vp.logLevel<=lr.ERROR){const t=e.map(ew);Vp.error(`Firestore (${_g}): ${r}`,...t)}}function ag(r,...e){if(Vp.logLevel<=lr.WARN){const t=e.map(ew);Vp.warn(`Firestore (${_g}): ${r}`,...t)}}function ew(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(r,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,nC(r,a,t)}function nC(r,e,t){let a=`FIRESTORE (${_g}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw rd(a),new Error(a)}function Wr(r,e,t,a){let d="Unexpected state";typeof t=="string"?d=t:a=t,r||nC(e,d,a)}function Un(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const It={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class tn extends cd{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class s3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(to.UNAUTHENTICATED))}shutdown(){}}class o3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class l3{constructor(e){this.t=e,this.currentUser=to.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Wr(this.o===void 0,42304);let a=this.i;const d=M=>this.i!==a?(a=this.i,t(M)):Promise.resolve();let m=new Yh;this.o=()=>{this.i++,this.currentUser=this.u(),m.resolve(),m=new Yh,e.enqueueRetryable(()=>d(this.currentUser))};const y=()=>{const M=m;e.enqueueRetryable(async()=>{await M.promise,await d(this.currentUser)})},c=M=>{en("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=M,this.o&&(this.auth.addAuthTokenListener(this.o),y())};this.t.onInit(M=>c(M)),setTimeout(()=>{if(!this.auth){const M=this.t.getImmediate({optional:!0});M?c(M):(en("FirebaseAuthCredentialsProvider","Auth not yet detected"),m.resolve(),m=new Yh)}},0),y()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(a=>this.i!==e?(en("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Wr(typeof a.accessToken=="string",31837,{l:a}),new rC(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Wr(e===null||typeof e=="string",2055,{h:e}),new to(e)}}class u3{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=to.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class c3{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new u3(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(to.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class wT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class h3{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,gu(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Wr(this.o===void 0,3512);const a=m=>{m.error!=null&&en("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${m.error.message}`);const y=m.token!==this.m;return this.m=m.token,en("FirebaseAppCheckTokenProvider",`Received ${y?"new":"existing"} token.`),y?t(m.token):Promise.resolve()};this.o=m=>{e.enqueueRetryable(()=>a(m))};const d=m=>{en("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=m,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(m=>d(m)),setTimeout(()=>{if(!this.appCheck){const m=this.V.getImmediate({optional:!0});m?d(m):en("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new wT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Wr(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wT(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d3(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<r;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const d=d3(40);for(let m=0;m<d.length;++m)a.length<20&&d[m]<t&&(a+=e.charAt(d[m]%62))}return a}}function tr(r,e){return r<e?-1:r>e?1:0}function Bx(r,e){let t=0;for(;t<r.length&&t<e.length;){const a=r.codePointAt(t),d=e.codePointAt(t);if(a!==d){if(a<128&&d<128)return tr(a,d);{const m=iC(),y=f3(m.encode(TT(r,t)),m.encode(TT(e,t)));return y!==0?y:tr(a,d)}}t+=a>65535?2:1}return tr(r.length,e.length)}function TT(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function f3(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return tr(r[t],e[t]);return tr(r.length,e.length)}function sg(r,e,t){return r.length===e.length&&r.every((a,d)=>t(a,e[d]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST=-62135596800,ET=1e6;class Wa{static now(){return Wa.fromMillis(Date.now())}static fromDate(e){return Wa.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*ET);return new Wa(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new tn(It.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new tn(It.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ST)throw new tn(It.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new tn(It.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ET}_compareTo(e){return this.seconds===e.seconds?tr(this.nanoseconds,e.nanoseconds):tr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-ST;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{static fromTimestamp(e){return new Vn(e)}static min(){return new Vn(new Wa(0,0))}static max(){return new Vn(new Wa(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AT="__name__";class Jc{constructor(e,t,a){t===void 0?t=0:t>e.length&&kn(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&kn(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Jc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Jc?e.forEach(a=>{t.push(a)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let d=0;d<a;d++){const m=Jc.compareSegments(e.get(d),t.get(d));if(m!==0)return m}return tr(e.length,t.length)}static compareSegments(e,t){const a=Jc.isNumericId(e),d=Jc.isNumericId(t);return a&&!d?-1:!a&&d?1:a&&d?Jc.extractNumericId(e).compare(Jc.extractNumericId(t)):Bx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return df.fromString(e.substring(4,e.length-2))}}class Mi extends Jc{construct(e,t,a){return new Mi(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new tn(It.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter(d=>d.length>0))}return new Mi(t)}static emptyPath(){return new Mi([])}}const p3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ps extends Jc{construct(e,t,a){return new Ps(e,t,a)}static isValidIdentifier(e){return p3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ps.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===AT}static keyField(){return new Ps([AT])}static fromServerFormat(e){const t=[];let a="",d=0;const m=()=>{if(a.length===0)throw new tn(It.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let y=!1;for(;d<e.length;){const c=e[d];if(c==="\\"){if(d+1===e.length)throw new tn(It.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const M=e[d+1];if(M!=="\\"&&M!=="."&&M!=="`")throw new tn(It.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=M,d+=2}else c==="`"?(y=!y,d++):c!=="."||y?(a+=c,d++):(m(),d++)}if(m(),y)throw new tn(It.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ps(t)}static emptyPath(){return new Ps([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.path=e}static fromPath(e){return new xn(Mi.fromString(e))}static fromName(e){return new xn(Mi.fromString(e).popFirst(5))}static empty(){return new xn(Mi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mi.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mi.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xn(new Mi(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u_=-1;function m3(r,e){const t=r.toTimestamp().seconds,a=r.toTimestamp().nanoseconds+1,d=Vn.fromTimestamp(a===1e9?new Wa(t+1,0):new Wa(t,a));return new pf(d,xn.empty(),e)}function g3(r){return new pf(r.readTime,r.key,u_)}class pf{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new pf(Vn.min(),xn.empty(),u_)}static max(){return new pf(Vn.max(),xn.empty(),u_)}}function y3(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=xn.comparator(r.documentKey,e.documentKey),t!==0?t:tr(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class v3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vg(r){if(r.code!==It.FAILED_PRECONDITION||r.message!==_3)throw r;en("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&kn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Pt((a,d)=>{this.nextCallback=m=>{this.wrapSuccess(e,m).next(a,d)},this.catchCallback=m=>{this.wrapFailure(t,m).next(a,d)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Pt?t:Pt.resolve(t)}catch(t){return Pt.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Pt.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Pt.reject(t)}static resolve(e){return new Pt((t,a)=>{t(e)})}static reject(e){return new Pt((t,a)=>{a(e)})}static waitFor(e){return new Pt((t,a)=>{let d=0,m=0,y=!1;e.forEach(c=>{++d,c.next(()=>{++m,y&&m===d&&t()},M=>a(M))}),y=!0,m===d&&t()})}static or(e){let t=Pt.resolve(!1);for(const a of e)t=t.next(d=>d?Pt.resolve(d):a());return t}static forEach(e,t){const a=[];return e.forEach((d,m)=>{a.push(t.call(this,d,m))}),this.waitFor(a)}static mapArray(e,t){return new Pt((a,d)=>{const m=e.length,y=new Array(m);let c=0;for(let M=0;M<m;M++){const R=M;t(e[R]).next(B=>{y[R]=B,++c,c===m&&a(y)},B=>d(B))}})}static doWhile(e,t){return new Pt((a,d)=>{const m=()=>{e()===!0?t().next(()=>{m()},d):a()};m()})}}function b3(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function bg(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ue(a),this.ce=a=>t.writeSequenceNumber(a))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}G0.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=-1;function H0(r){return r==null}function g0(r){return r===0&&1/r==-1/0}function x3(r){return typeof r=="number"&&Number.isInteger(r)&&!g0(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC="";function w3(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=CT(e)),e=T3(r.get(t),e);return CT(e)}function T3(r,e){let t=e;const a=r.length;for(let d=0;d<a;d++){const m=r.charAt(d);switch(m){case"\0":t+="";break;case sC:t+="";break;default:t+=m}}return t}function CT(r){return r+sC+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IT(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Ef(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function oC(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e,t){this.comparator=e,this.root=t||Ms.EMPTY}insert(e,t){return new ta(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ms.BLACK,null,null))}remove(e){return new ta(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ms.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const d=this.comparator(e,a.key);if(d===0)return t+a.left.size;d<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,a)=>(e(t,a),!1))}toString(){const e=[];return this.inorderTraversal((t,a)=>(e.push(`${t}:${a}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rv(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rv(this.root,e,this.comparator,!0)}}class Rv{constructor(e,t,a,d){this.isReverse=d,this.nodeStack=[];let m=1;for(;!e.isEmpty();)if(m=t?a(e.key,t):1,t&&d&&(m*=-1),m<0)e=this.isReverse?e.left:e.right;else{if(m===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ms{constructor(e,t,a,d,m){this.key=e,this.value=t,this.color=a??Ms.RED,this.left=d??Ms.EMPTY,this.right=m??Ms.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,d,m){return new Ms(e??this.key,t??this.value,a??this.color,d??this.left,m??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let d=this;const m=a(e,d.key);return d=m<0?d.copy(null,null,null,d.left.insert(e,t,a),null):m===0?d.copy(null,t,null,null,null):d.copy(null,null,null,null,d.right.insert(e,t,a)),d.fixUp()}removeMin(){if(this.left.isEmpty())return Ms.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,d=this;if(t(e,d.key)<0)d.left.isEmpty()||d.left.isRed()||d.left.left.isRed()||(d=d.moveRedLeft()),d=d.copy(null,null,null,d.left.remove(e,t),null);else{if(d.left.isRed()&&(d=d.rotateRight()),d.right.isEmpty()||d.right.isRed()||d.right.left.isRed()||(d=d.moveRedRight()),t(e,d.key)===0){if(d.right.isEmpty())return Ms.EMPTY;a=d.right.min(),d=d.copy(a.key,a.value,null,null,d.right.removeMin())}d=d.copy(null,null,null,null,d.right.remove(e,t))}return d.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ms.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ms.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw kn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw kn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw kn(27949);return e+(this.isRed()?0:1)}}Ms.EMPTY=null,Ms.RED=!0,Ms.BLACK=!1;Ms.EMPTY=new class{constructor(){this.size=0}get key(){throw kn(57766)}get value(){throw kn(16141)}get color(){throw kn(16727)}get left(){throw kn(29726)}get right(){throw kn(36894)}copy(e,t,a,d,m){return this}insert(e,t,a){return new Ms(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e){this.comparator=e,this.data=new ta(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,a)=>(e(t),!1))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const d=a.getNext();if(this.comparator(d.key,e[1])>=0)return;t(d.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new MT(this.data.getIterator())}getIteratorFrom(e){return new MT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(a=>{t=t.add(a)}),t}isEqual(e){if(!(e instanceof Ka)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const d=t.getNext().key,m=a.getNext().key;if(this.comparator(d,m)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ka(this.comparator);return t.data=e,t}}class MT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e){this.fields=e,e.sort(Ps.comparator)}static empty(){return new Pl([])}unionWith(e){let t=new Ka(Ps.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new Pl(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sg(this.fields,e.fields,(t,a)=>t.isEqual(a))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(d){try{return atob(d)}catch(m){throw typeof DOMException<"u"&&m instanceof DOMException?new lC("Invalid base64 string: "+m):m}}(e);return new ks(t)}static fromUint8Array(e){const t=function(d){let m="";for(let y=0;y<d.length;++y)m+=String.fromCharCode(d[y]);return m}(e);return new ks(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const a=new Uint8Array(t.length);for(let d=0;d<t.length;d++)a[d]=t.charCodeAt(d);return a}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ks.EMPTY_BYTE_STRING=new ks("");const S3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mf(r){if(Wr(!!r,39018),typeof r=="string"){let e=0;const t=S3.exec(r);if(Wr(!!t,46558,{timestamp:r}),t[1]){let d=t[1];d=(d+"000000000").substr(0,9),e=Number(d)}const a=new Date(r);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:ga(r.seconds),nanos:ga(r.nanos)}}function ga(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function gf(r){return typeof r=="string"?ks.fromBase64String(r):ks.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="server_timestamp",cC="__type__",hC="__previous_value__",dC="__local_write_time__";function nw(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[cC])===null||t===void 0?void 0:t.stringValue)===uC}function Z0(r){const e=r.mapValue.fields[hC];return nw(e)?Z0(e):e}function c_(r){const e=mf(r.mapValue.fields[dC].timestampValue);return new Wa(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E3{constructor(e,t,a,d,m,y,c,M,R,B){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=d,this.ssl=m,this.forceLongPolling=y,this.autoDetectLongPolling=c,this.longPollingOptions=M,this.useFetchStreams=R,this.isUsingEmulator=B}}const y0="(default)";class h_{constructor(e,t){this.projectId=e,this.database=t||y0}static empty(){return new h_("","")}get isDefaultDatabase(){return this.database===y0}isEqual(e){return e instanceof h_&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="__type__",A3="__max__",kv={mapValue:{}},pC="__vector__",_0="value";function yf(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?nw(r)?4:I3(r)?9007199254740991:C3(r)?10:11:kn(28295,{value:r})}function dh(r,e){if(r===e)return!0;const t=yf(r);if(t!==yf(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return c_(r).isEqual(c_(e));case 3:return function(d,m){if(typeof d.timestampValue=="string"&&typeof m.timestampValue=="string"&&d.timestampValue.length===m.timestampValue.length)return d.timestampValue===m.timestampValue;const y=mf(d.timestampValue),c=mf(m.timestampValue);return y.seconds===c.seconds&&y.nanos===c.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(d,m){return gf(d.bytesValue).isEqual(gf(m.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(d,m){return ga(d.geoPointValue.latitude)===ga(m.geoPointValue.latitude)&&ga(d.geoPointValue.longitude)===ga(m.geoPointValue.longitude)}(r,e);case 2:return function(d,m){if("integerValue"in d&&"integerValue"in m)return ga(d.integerValue)===ga(m.integerValue);if("doubleValue"in d&&"doubleValue"in m){const y=ga(d.doubleValue),c=ga(m.doubleValue);return y===c?g0(y)===g0(c):isNaN(y)&&isNaN(c)}return!1}(r,e);case 9:return sg(r.arrayValue.values||[],e.arrayValue.values||[],dh);case 10:case 11:return function(d,m){const y=d.mapValue.fields||{},c=m.mapValue.fields||{};if(IT(y)!==IT(c))return!1;for(const M in y)if(y.hasOwnProperty(M)&&(c[M]===void 0||!dh(y[M],c[M])))return!1;return!0}(r,e);default:return kn(52216,{left:r})}}function d_(r,e){return(r.values||[]).find(t=>dh(t,e))!==void 0}function og(r,e){if(r===e)return 0;const t=yf(r),a=yf(e);if(t!==a)return tr(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return tr(r.booleanValue,e.booleanValue);case 2:return function(m,y){const c=ga(m.integerValue||m.doubleValue),M=ga(y.integerValue||y.doubleValue);return c<M?-1:c>M?1:c===M?0:isNaN(c)?isNaN(M)?0:-1:1}(r,e);case 3:return PT(r.timestampValue,e.timestampValue);case 4:return PT(c_(r),c_(e));case 5:return Bx(r.stringValue,e.stringValue);case 6:return function(m,y){const c=gf(m),M=gf(y);return c.compareTo(M)}(r.bytesValue,e.bytesValue);case 7:return function(m,y){const c=m.split("/"),M=y.split("/");for(let R=0;R<c.length&&R<M.length;R++){const B=tr(c[R],M[R]);if(B!==0)return B}return tr(c.length,M.length)}(r.referenceValue,e.referenceValue);case 8:return function(m,y){const c=tr(ga(m.latitude),ga(y.latitude));return c!==0?c:tr(ga(m.longitude),ga(y.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return RT(r.arrayValue,e.arrayValue);case 10:return function(m,y){var c,M,R,B;const K=m.fields||{},$=y.fields||{},W=(c=K[_0])===null||c===void 0?void 0:c.arrayValue,re=(M=$[_0])===null||M===void 0?void 0:M.arrayValue,Me=tr(((R=W==null?void 0:W.values)===null||R===void 0?void 0:R.length)||0,((B=re==null?void 0:re.values)===null||B===void 0?void 0:B.length)||0);return Me!==0?Me:RT(W,re)}(r.mapValue,e.mapValue);case 11:return function(m,y){if(m===kv.mapValue&&y===kv.mapValue)return 0;if(m===kv.mapValue)return 1;if(y===kv.mapValue)return-1;const c=m.fields||{},M=Object.keys(c),R=y.fields||{},B=Object.keys(R);M.sort(),B.sort();for(let K=0;K<M.length&&K<B.length;++K){const $=Bx(M[K],B[K]);if($!==0)return $;const W=og(c[M[K]],R[B[K]]);if(W!==0)return W}return tr(M.length,B.length)}(r.mapValue,e.mapValue);default:throw kn(23264,{Pe:t})}}function PT(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return tr(r,e);const t=mf(r),a=mf(e),d=tr(t.seconds,a.seconds);return d!==0?d:tr(t.nanos,a.nanos)}function RT(r,e){const t=r.values||[],a=e.values||[];for(let d=0;d<t.length&&d<a.length;++d){const m=og(t[d],a[d]);if(m)return m}return tr(t.length,a.length)}function lg(r){return Fx(r)}function Fx(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const a=mf(t);return`time(${a.seconds},${a.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return gf(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return xn.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let a="[",d=!0;for(const m of t.values||[])d?d=!1:a+=",",a+=Fx(m);return a+"]"}(r.arrayValue):"mapValue"in r?function(t){const a=Object.keys(t.fields||{}).sort();let d="{",m=!0;for(const y of a)m?m=!1:d+=",",d+=`${y}:${Fx(t.fields[y])}`;return d+"}"}(r.mapValue):kn(61005,{value:r})}function Xv(r){switch(yf(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Z0(r);return e?16+Xv(e):16;case 5:return 2*r.stringValue.length;case 6:return gf(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(a){return(a.values||[]).reduce((d,m)=>d+Xv(m),0)}(r.arrayValue);case 10:case 11:return function(a){let d=0;return Ef(a.fields,(m,y)=>{d+=m.length+Xv(y)}),d}(r.mapValue);default:throw kn(13486,{value:r})}}function kT(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Vx(r){return!!r&&"integerValue"in r}function rw(r){return!!r&&"arrayValue"in r}function DT(r){return!!r&&"nullValue"in r}function LT(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Yv(r){return!!r&&"mapValue"in r}function C3(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[fC])===null||t===void 0?void 0:t.stringValue)===pC}function Ky(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return Ef(r.mapValue.fields,(t,a)=>e.mapValue.fields[t]=Ky(a)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ky(r.arrayValue.values[t]);return e}return Object.assign({},r)}function I3(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===A3}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e){this.value=e}static empty(){return new nl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!Yv(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ky(t)}setAll(e){let t=Ps.emptyPath(),a={},d=[];e.forEach((y,c)=>{if(!t.isImmediateParentOf(c)){const M=this.getFieldsMap(t);this.applyChanges(M,a,d),a={},d=[],t=c.popLast()}y?a[c.lastSegment()]=Ky(y):d.push(c.lastSegment())});const m=this.getFieldsMap(t);this.applyChanges(m,a,d)}delete(e){const t=this.field(e.popLast());Yv(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dh(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let d=t.mapValue.fields[e.get(a)];Yv(d)&&d.mapValue.fields||(d={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=d),t=d}return t.mapValue.fields}applyChanges(e,t,a){Ef(t,(d,m)=>e[d]=m);for(const d of a)delete e[d]}clone(){return new nl(Ky(this.value))}}function mC(r){const e=[];return Ef(r.fields,(t,a)=>{const d=new Ps([t]);if(Yv(a)){const m=mC(a.mapValue).fields;if(m.length===0)e.push(d);else for(const y of m)e.push(d.child(y))}else e.push(d)}),new Pl(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,t,a,d,m,y,c){this.key=e,this.documentType=t,this.version=a,this.readTime=d,this.createTime=m,this.data=y,this.documentState=c}static newInvalidDocument(e){return new no(e,0,Vn.min(),Vn.min(),Vn.min(),nl.empty(),0)}static newFoundDocument(e,t,a,d){return new no(e,1,t,Vn.min(),a,d,0)}static newNoDocument(e,t){return new no(e,2,t,Vn.min(),Vn.min(),nl.empty(),0)}static newUnknownDocument(e,t){return new no(e,3,t,Vn.min(),Vn.min(),nl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Vn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Vn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof no&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new no(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e,t){this.position=e,this.inclusive=t}}function zT(r,e,t){let a=0;for(let d=0;d<r.position.length;d++){const m=e[d],y=r.position[d];if(m.field.isKeyField()?a=xn.comparator(xn.fromName(y.referenceValue),t.key):a=og(y,t.data.field(m.field)),m.dir==="desc"&&(a*=-1),a!==0)break}return a}function OT(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!dh(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,t="asc"){this.field=e,this.dir=t}}function M3(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{}class Da extends gC{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new R3(e,t,a):t==="array-contains"?new L3(e,a):t==="in"?new z3(e,a):t==="not-in"?new O3(e,a):t==="array-contains-any"?new N3(e,a):new Da(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new k3(e,a):new D3(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(og(t,this.value)):t!==null&&yf(this.value)===yf(t)&&this.matchesComparison(og(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return kn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gc extends gC{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new gc(e,t)}matches(e){return yC(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function yC(r){return r.op==="and"}function _C(r){return P3(r)&&yC(r)}function P3(r){for(const e of r.filters)if(e instanceof gc)return!1;return!0}function jx(r){if(r instanceof Da)return r.field.canonicalString()+r.op.toString()+lg(r.value);if(_C(r))return r.filters.map(e=>jx(e)).join(",");{const e=r.filters.map(t=>jx(t)).join(",");return`${r.op}(${e})`}}function vC(r,e){return r instanceof Da?function(a,d){return d instanceof Da&&a.op===d.op&&a.field.isEqual(d.field)&&dh(a.value,d.value)}(r,e):r instanceof gc?function(a,d){return d instanceof gc&&a.op===d.op&&a.filters.length===d.filters.length?a.filters.reduce((m,y,c)=>m&&vC(y,d.filters[c]),!0):!1}(r,e):void kn(19439)}function bC(r){return r instanceof Da?function(t){return`${t.field.canonicalString()} ${t.op} ${lg(t.value)}`}(r):r instanceof gc?function(t){return t.op.toString()+" {"+t.getFilters().map(bC).join(" ,")+"}"}(r):"Filter"}class R3 extends Da{constructor(e,t,a){super(e,t,a),this.key=xn.fromName(a.referenceValue)}matches(e){const t=xn.comparator(e.key,this.key);return this.matchesComparison(t)}}class k3 extends Da{constructor(e,t){super(e,"in",t),this.keys=xC("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class D3 extends Da{constructor(e,t){super(e,"not-in",t),this.keys=xC("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function xC(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(a=>xn.fromName(a.referenceValue))}class L3 extends Da{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return rw(t)&&d_(t.arrayValue,this.value)}}class z3 extends Da{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&d_(this.value.arrayValue,t)}}class O3 extends Da{constructor(e,t){super(e,"not-in",t)}matches(e){if(d_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!d_(this.value.arrayValue,t)}}class N3 extends Da{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!rw(t)||!t.arrayValue.values)&&t.arrayValue.values.some(a=>d_(this.value.arrayValue,a))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B3{constructor(e,t=null,a=[],d=[],m=null,y=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=d,this.limit=m,this.startAt=y,this.endAt=c,this.Ie=null}}function NT(r,e=null,t=[],a=[],d=null,m=null,y=null){return new B3(r,e,t,a,d,m,y)}function iw(r){const e=Un(r);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(a=>jx(a)).join(","),t+="|ob:",t+=e.orderBy.map(a=>function(m){return m.field.canonicalString()+m.dir}(a)).join(","),H0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(a=>lg(a)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(a=>lg(a)).join(",")),e.Ie=t}return e.Ie}function aw(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!M3(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!vC(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!OT(r.startAt,e.startAt)&&OT(r.endAt,e.endAt)}function Ux(r){return xn.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(e,t=null,a=[],d=[],m=null,y="F",c=null,M=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=d,this.limit=m,this.limitType=y,this.startAt=c,this.endAt=M,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function F3(r,e,t,a,d,m,y,c){return new xg(r,e,t,a,d,m,y,c)}function sw(r){return new xg(r)}function BT(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function wC(r){return r.collectionGroup!==null}function Xy(r){const e=Un(r);if(e.Ee===null){e.Ee=[];const t=new Set;for(const m of e.explicitOrderBy)e.Ee.push(m),t.add(m.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(y){let c=new Ka(Ps.comparator);return y.filters.forEach(M=>{M.getFlattenedFilters().forEach(R=>{R.isInequality()&&(c=c.add(R.field))})}),c})(e).forEach(m=>{t.has(m.canonicalString())||m.isKeyField()||e.Ee.push(new f_(m,a))}),t.has(Ps.keyField().canonicalString())||e.Ee.push(new f_(Ps.keyField(),a))}return e.Ee}function sh(r){const e=Un(r);return e.de||(e.de=V3(e,Xy(r))),e.de}function V3(r,e){if(r.limitType==="F")return NT(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(d=>{const m=d.dir==="desc"?"asc":"desc";return new f_(d.field,m)});const t=r.endAt?new v0(r.endAt.position,r.endAt.inclusive):null,a=r.startAt?new v0(r.startAt.position,r.startAt.inclusive):null;return NT(r.path,r.collectionGroup,e,r.filters,r.limit,t,a)}}function qx(r,e){const t=r.filters.concat([e]);return new xg(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function $x(r,e,t){return new xg(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function W0(r,e){return aw(sh(r),sh(e))&&r.limitType===e.limitType}function TC(r){return`${iw(sh(r))}|lt:${r.limitType}`}function Fm(r){return`Query(target=${function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map(d=>bC(d)).join(", ")}]`),H0(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map(d=>function(y){return`${y.field.canonicalString()} (${y.dir})`}(d)).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map(d=>lg(d)).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map(d=>lg(d)).join(",")),`Target(${a})`}(sh(r))}; limitType=${r.limitType})`}function K0(r,e){return e.isFoundDocument()&&function(a,d){const m=d.key.path;return a.collectionGroup!==null?d.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(m):xn.isDocumentKey(a.path)?a.path.isEqual(m):a.path.isImmediateParentOf(m)}(r,e)&&function(a,d){for(const m of Xy(a))if(!m.field.isKeyField()&&d.data.field(m.field)===null)return!1;return!0}(r,e)&&function(a,d){for(const m of a.filters)if(!m.matches(d))return!1;return!0}(r,e)&&function(a,d){return!(a.startAt&&!function(y,c,M){const R=zT(y,c,M);return y.inclusive?R<=0:R<0}(a.startAt,Xy(a),d)||a.endAt&&!function(y,c,M){const R=zT(y,c,M);return y.inclusive?R>=0:R>0}(a.endAt,Xy(a),d))}(r,e)}function j3(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function SC(r){return(e,t)=>{let a=!1;for(const d of Xy(r)){const m=U3(d,e,t);if(m!==0)return m;a=a||d.field.isKeyField()}return 0}}function U3(r,e,t){const a=r.field.isKeyField()?xn.comparator(e.key,t.key):function(m,y,c){const M=y.data.field(m),R=c.data.field(m);return M!==null&&R!==null?og(M,R):kn(42886)}(r.field,e,t);switch(r.dir){case"asc":return a;case"desc":return-1*a;default:return kn(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[d,m]of a)if(this.equalsFn(d,e))return m}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),d=this.inner[a];if(d===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let m=0;m<d.length;m++)if(this.equalsFn(d[m][0],e))return void(d[m]=[e,t]);d.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let d=0;d<a.length;d++)if(this.equalsFn(a[d][0],e))return a.length===1?delete this.inner[t]:a.splice(d,1),this.innerSize--,!0;return!1}forEach(e){Ef(this.inner,(t,a)=>{for(const[d,m]of a)e(d,m)})}isEmpty(){return oC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=new ta(xn.comparator);function id(){return q3}const EC=new ta(xn.comparator);function Uy(...r){let e=EC;for(const t of r)e=e.insert(t.key,t);return e}function AC(r){let e=EC;return r.forEach((t,a)=>e=e.insert(t,a.overlayedDocument)),e}function Ip(){return Yy()}function CC(){return Yy()}function Yy(){return new Kp(r=>r.toString(),(r,e)=>r.isEqual(e))}const $3=new ta(xn.comparator),G3=new Ka(xn.comparator);function ur(...r){let e=G3;for(const t of r)e=e.add(t);return e}const H3=new Ka(tr);function Z3(){return H3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:g0(e)?"-0":e}}function IC(r){return{integerValue:""+r}}function W3(r,e){return x3(e)?IC(e):ow(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(){this._=void 0}}function K3(r,e,t){return r instanceof b0?function(d,m){const y={fields:{[cC]:{stringValue:uC},[dC]:{timestampValue:{seconds:d.seconds,nanos:d.nanoseconds}}}};return m&&nw(m)&&(m=Z0(m)),m&&(y.fields[hC]=m),{mapValue:y}}(t,e):r instanceof p_?PC(r,e):r instanceof m_?RC(r,e):function(d,m){const y=MC(d,m),c=FT(y)+FT(d.Re);return Vx(y)&&Vx(d.Re)?IC(c):ow(d.serializer,c)}(r,e)}function X3(r,e,t){return r instanceof p_?PC(r,e):r instanceof m_?RC(r,e):t}function MC(r,e){return r instanceof x0?function(a){return Vx(a)||function(m){return!!m&&"doubleValue"in m}(a)}(e)?e:{integerValue:0}:null}class b0 extends X0{}class p_ extends X0{constructor(e){super(),this.elements=e}}function PC(r,e){const t=kC(e);for(const a of r.elements)t.some(d=>dh(d,a))||t.push(a);return{arrayValue:{values:t}}}class m_ extends X0{constructor(e){super(),this.elements=e}}function RC(r,e){let t=kC(e);for(const a of r.elements)t=t.filter(d=>!dh(d,a));return{arrayValue:{values:t}}}class x0 extends X0{constructor(e,t){super(),this.serializer=e,this.Re=t}}function FT(r){return ga(r.integerValue||r.doubleValue)}function kC(r){return rw(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function Y3(r,e){return r.field.isEqual(e.field)&&function(a,d){return a instanceof p_&&d instanceof p_||a instanceof m_&&d instanceof m_?sg(a.elements,d.elements,dh):a instanceof x0&&d instanceof x0?dh(a.Re,d.Re):a instanceof b0&&d instanceof b0}(r.transform,e.transform)}class Q3{constructor(e,t){this.version=e,this.transformResults=t}}class _u{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new _u}static exists(e){return new _u(void 0,e)}static updateTime(e){return new _u(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qv(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Y0{}function DC(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new lw(r.key,_u.none()):new N_(r.key,r.data,_u.none());{const t=r.data,a=nl.empty();let d=new Ka(Ps.comparator);for(let m of e.fields)if(!d.has(m)){let y=t.field(m);y===null&&m.length>1&&(m=m.popLast(),y=t.field(m)),y===null?a.delete(m):a.set(m,y),d=d.add(m)}return new Af(r.key,a,new Pl(d.toArray()),_u.none())}}function J3(r,e,t){r instanceof N_?function(d,m,y){const c=d.value.clone(),M=jT(d.fieldTransforms,m,y.transformResults);c.setAll(M),m.convertToFoundDocument(y.version,c).setHasCommittedMutations()}(r,e,t):r instanceof Af?function(d,m,y){if(!Qv(d.precondition,m))return void m.convertToUnknownDocument(y.version);const c=jT(d.fieldTransforms,m,y.transformResults),M=m.data;M.setAll(LC(d)),M.setAll(c),m.convertToFoundDocument(y.version,M).setHasCommittedMutations()}(r,e,t):function(d,m,y){m.convertToNoDocument(y.version).setHasCommittedMutations()}(0,e,t)}function Qy(r,e,t,a){return r instanceof N_?function(m,y,c,M){if(!Qv(m.precondition,y))return c;const R=m.value.clone(),B=UT(m.fieldTransforms,M,y);return R.setAll(B),y.convertToFoundDocument(y.version,R).setHasLocalMutations(),null}(r,e,t,a):r instanceof Af?function(m,y,c,M){if(!Qv(m.precondition,y))return c;const R=UT(m.fieldTransforms,M,y),B=y.data;return B.setAll(LC(m)),B.setAll(R),y.convertToFoundDocument(y.version,B).setHasLocalMutations(),c===null?null:c.unionWith(m.fieldMask.fields).unionWith(m.fieldTransforms.map(K=>K.field))}(r,e,t,a):function(m,y,c){return Qv(m.precondition,y)?(y.convertToNoDocument(y.version).setHasLocalMutations(),null):c}(r,e,t)}function ez(r,e){let t=null;for(const a of r.fieldTransforms){const d=e.data.field(a.field),m=MC(a.transform,d||null);m!=null&&(t===null&&(t=nl.empty()),t.set(a.field,m))}return t||null}function VT(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(a,d){return a===void 0&&d===void 0||!(!a||!d)&&sg(a,d,(m,y)=>Y3(m,y))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class N_ extends Y0{constructor(e,t,a,d=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=d,this.type=0}getFieldMask(){return null}}class Af extends Y0{constructor(e,t,a,d,m=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=d,this.fieldTransforms=m,this.type=1}getFieldMask(){return this.fieldMask}}function LC(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const a=r.data.field(t);e.set(t,a)}}),e}function jT(r,e,t){const a=new Map;Wr(r.length===t.length,32656,{Ve:t.length,me:r.length});for(let d=0;d<t.length;d++){const m=r[d],y=m.transform,c=e.data.field(m.field);a.set(m.field,X3(y,c,t[d]))}return a}function UT(r,e,t){const a=new Map;for(const d of r){const m=d.transform,y=t.data.field(d.field);a.set(d.field,K3(m,y,e))}return a}class lw extends Y0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tz extends Y0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e,t,a,d){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=d}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let d=0;d<this.mutations.length;d++){const m=this.mutations[d];m.key.isEqual(e.key)&&J3(m,e,a[d])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Qy(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Qy(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=CC();return this.mutations.forEach(d=>{const m=e.get(d.key),y=m.overlayedDocument;let c=this.applyToLocalView(y,m.mutatedFields);c=t.has(d.key)?null:c;const M=DC(y,c);M!==null&&a.set(d.key,M),y.isValidDocument()||y.convertToNoDocument(Vn.min())}),a}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ur())}isEqual(e){return this.batchId===e.batchId&&sg(this.mutations,e.mutations,(t,a)=>VT(t,a))&&sg(this.baseMutations,e.baseMutations,(t,a)=>VT(t,a))}}class uw{constructor(e,t,a,d){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=d}static from(e,t,a){Wr(e.mutations.length===a.length,58842,{fe:e.mutations.length,ge:a.length});let d=function(){return $3}();const m=e.mutations;for(let y=0;y<m.length;y++)d=d.insert(m[y].key,a[y].version);return new uw(e,t,a,d)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rz{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iz{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ka,br;function az(r){switch(r){case It.OK:return kn(64938);case It.CANCELLED:case It.UNKNOWN:case It.DEADLINE_EXCEEDED:case It.RESOURCE_EXHAUSTED:case It.INTERNAL:case It.UNAVAILABLE:case It.UNAUTHENTICATED:return!1;case It.INVALID_ARGUMENT:case It.NOT_FOUND:case It.ALREADY_EXISTS:case It.PERMISSION_DENIED:case It.FAILED_PRECONDITION:case It.ABORTED:case It.OUT_OF_RANGE:case It.UNIMPLEMENTED:case It.DATA_LOSS:return!0;default:return kn(15467,{code:r})}}function zC(r){if(r===void 0)return rd("GRPC error has no .code"),It.UNKNOWN;switch(r){case ka.OK:return It.OK;case ka.CANCELLED:return It.CANCELLED;case ka.UNKNOWN:return It.UNKNOWN;case ka.DEADLINE_EXCEEDED:return It.DEADLINE_EXCEEDED;case ka.RESOURCE_EXHAUSTED:return It.RESOURCE_EXHAUSTED;case ka.INTERNAL:return It.INTERNAL;case ka.UNAVAILABLE:return It.UNAVAILABLE;case ka.UNAUTHENTICATED:return It.UNAUTHENTICATED;case ka.INVALID_ARGUMENT:return It.INVALID_ARGUMENT;case ka.NOT_FOUND:return It.NOT_FOUND;case ka.ALREADY_EXISTS:return It.ALREADY_EXISTS;case ka.PERMISSION_DENIED:return It.PERMISSION_DENIED;case ka.FAILED_PRECONDITION:return It.FAILED_PRECONDITION;case ka.ABORTED:return It.ABORTED;case ka.OUT_OF_RANGE:return It.OUT_OF_RANGE;case ka.UNIMPLEMENTED:return It.UNIMPLEMENTED;case ka.DATA_LOSS:return It.DATA_LOSS;default:return kn(39323,{code:r})}}(br=ka||(ka={}))[br.OK=0]="OK",br[br.CANCELLED=1]="CANCELLED",br[br.UNKNOWN=2]="UNKNOWN",br[br.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",br[br.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",br[br.NOT_FOUND=5]="NOT_FOUND",br[br.ALREADY_EXISTS=6]="ALREADY_EXISTS",br[br.PERMISSION_DENIED=7]="PERMISSION_DENIED",br[br.UNAUTHENTICATED=16]="UNAUTHENTICATED",br[br.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",br[br.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",br[br.ABORTED=10]="ABORTED",br[br.OUT_OF_RANGE=11]="OUT_OF_RANGE",br[br.UNIMPLEMENTED=12]="UNIMPLEMENTED",br[br.INTERNAL=13]="INTERNAL",br[br.UNAVAILABLE=14]="UNAVAILABLE",br[br.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz=new df([4294967295,4294967295],0);function qT(r){const e=iC().encode(r),t=new XA;return t.update(e),new Uint8Array(t.digest())}function $T(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),d=e.getUint32(8,!0),m=e.getUint32(12,!0);return[new df([t,a],0),new df([d,m],0)]}class cw{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new qy(`Invalid padding: ${t}`);if(a<0)throw new qy(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new qy(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new qy(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=df.fromNumber(this.pe)}we(e,t,a){let d=e.add(t.multiply(df.fromNumber(a)));return d.compare(sz)===1&&(d=new df([d.getBits(0),d.getBits(1)],0)),d.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=qT(e),[a,d]=$T(t);for(let m=0;m<this.hashCount;m++){const y=this.we(a,d,m);if(!this.be(y))return!1}return!0}static create(e,t,a){const d=e%8==0?0:8-e%8,m=new Uint8Array(Math.ceil(e/8)),y=new cw(m,d,t);return a.forEach(c=>y.insert(c)),y}insert(e){if(this.pe===0)return;const t=qT(e),[a,d]=$T(t);for(let m=0;m<this.hashCount;m++){const y=this.we(a,d,m);this.Se(y)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class qy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e,t,a,d,m){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=d,this.resolvedLimboDocuments=m}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const d=new Map;return d.set(e,B_.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new Q0(Vn.min(),d,new ta(tr),id(),ur())}}class B_{constructor(e,t,a,d,m){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=d,this.removedDocuments=m}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new B_(a,t,ur(),ur(),ur())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(e,t,a,d){this.De=e,this.removedTargetIds=t,this.key=a,this.ve=d}}class OC{constructor(e,t){this.targetId=e,this.Ce=t}}class NC{constructor(e,t,a=ks.EMPTY_BYTE_STRING,d=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=d}}class GT{constructor(){this.Fe=0,this.Me=HT(),this.xe=ks.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=ur(),t=ur(),a=ur();return this.Me.forEach((d,m)=>{switch(m){case 0:e=e.add(d);break;case 2:t=t.add(d);break;case 1:a=a.add(d);break;default:kn(38017,{changeType:m})}}),new B_(this.xe,this.Oe,e,t,a)}Qe(){this.Ne=!1,this.Me=HT()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Wr(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class oz{constructor(e){this.ze=e,this.je=new Map,this.He=id(),this.Je=Dv(),this.Ye=Dv(),this.Ze=new ta(tr)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const a=this.rt(t);switch(e.state){case 0:this.it(t)&&a.ke(e.resumeToken);break;case 1:a.We(),a.Be||a.Qe(),a.ke(e.resumeToken);break;case 2:a.We(),a.Be||this.removeTarget(t);break;case 3:this.it(t)&&(a.Ge(),a.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),a.ke(e.resumeToken));break;default:kn(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((a,d)=>{this.it(d)&&t(d)})}ot(e){const t=e.targetId,a=e.Ce.count,d=this._t(t);if(d){const m=d.target;if(Ux(m))if(a===0){const y=new xn(m.path);this.tt(t,y,no.newNoDocument(y,Vn.min()))}else Wr(a===1,20013,{expectedCount:a});else{const y=this.ut(t);if(y!==a){const c=this.ct(e),M=c?this.lt(c,e,y):1;if(M!==0){this.st(t);const R=M===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,R)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:d=0},hashCount:m=0}=t;let y,c;try{y=gf(a).toUint8Array()}catch(M){if(M instanceof lC)return ag("Decoding the base64 bloom filter in existence filter failed ("+M.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw M}try{c=new cw(y,d,m)}catch(M){return ag(M instanceof qy?"BloomFilter error: ":"Applying bloom filter failed: ",M),null}return c.pe===0?null:c}lt(e,t,a){return t.Ce.count===a-this.Tt(e,t.targetId)?0:2}Tt(e,t){const a=this.ze.getRemoteKeysForTarget(t);let d=0;return a.forEach(m=>{const y=this.ze.Pt(),c=`projects/${y.projectId}/databases/${y.database}/documents/${m.path.canonicalString()}`;e.mightContain(c)||(this.tt(t,m,null),d++)}),d}It(e){const t=new Map;this.je.forEach((m,y)=>{const c=this._t(y);if(c){if(m.current&&Ux(c.target)){const M=new xn(c.target.path);this.Et(M).has(y)||this.dt(y,M)||this.tt(y,M,no.newNoDocument(M,e))}m.Le&&(t.set(y,m.qe()),m.Qe())}});let a=ur();this.Ye.forEach((m,y)=>{let c=!0;y.forEachWhile(M=>{const R=this._t(M);return!R||R.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(a=a.add(m))}),this.He.forEach((m,y)=>y.setReadTime(e));const d=new Q0(e,t,this.Ze,this.He,a);return this.He=id(),this.Je=Dv(),this.Ye=Dv(),this.Ze=new ta(tr),d}et(e,t){if(!this.it(e))return;const a=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,a),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,a){if(!this.it(e))return;const d=this.rt(e);this.dt(e,t)?d.$e(t,1):d.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),a&&(this.He=this.He.insert(t,a))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new GT,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Ka(tr),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Ka(tr),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||en("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new GT),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Dv(){return new ta(xn.comparator)}function HT(){return new ta(xn.comparator)}const lz={asc:"ASCENDING",desc:"DESCENDING"},uz={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cz={and:"AND",or:"OR"};class hz{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gx(r,e){return r.useProto3Json||H0(e)?e:{value:e}}function w0(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BC(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function dz(r,e){return w0(r,e.toTimestamp())}function oh(r){return Wr(!!r,49232),Vn.fromTimestamp(function(t){const a=mf(t);return new Wa(a.seconds,a.nanos)}(r))}function hw(r,e){return Hx(r,e).canonicalString()}function Hx(r,e){const t=function(d){return new Mi(["projects",d.projectId,"databases",d.database])}(r).child("documents");return e===void 0?t:t.child(e)}function FC(r){const e=Mi.fromString(r);return Wr($C(e),10190,{key:e.toString()}),e}function Zx(r,e){return hw(r.databaseId,e.path)}function nx(r,e){const t=FC(e);if(t.get(1)!==r.databaseId.projectId)throw new tn(It.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new tn(It.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new xn(jC(t))}function VC(r,e){return hw(r.databaseId,e)}function fz(r){const e=FC(r);return e.length===4?Mi.emptyPath():jC(e)}function Wx(r){return new Mi(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function jC(r){return Wr(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function ZT(r,e,t){return{name:Zx(r,e),fields:t.value.mapValue.fields}}function pz(r,e){let t;if("targetChange"in e){e.targetChange;const a=function(R){return R==="NO_CHANGE"?0:R==="ADD"?1:R==="REMOVE"?2:R==="CURRENT"?3:R==="RESET"?4:kn(39313,{state:R})}(e.targetChange.targetChangeType||"NO_CHANGE"),d=e.targetChange.targetIds||[],m=function(R,B){return R.useProto3Json?(Wr(B===void 0||typeof B=="string",58123),ks.fromBase64String(B||"")):(Wr(B===void 0||B instanceof Buffer||B instanceof Uint8Array,16193),ks.fromUint8Array(B||new Uint8Array))}(r,e.targetChange.resumeToken),y=e.targetChange.cause,c=y&&function(R){const B=R.code===void 0?It.UNKNOWN:zC(R.code);return new tn(B,R.message||"")}(y);t=new NC(a,d,m,c||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const d=nx(r,a.document.name),m=oh(a.document.updateTime),y=a.document.createTime?oh(a.document.createTime):Vn.min(),c=new nl({mapValue:{fields:a.document.fields}}),M=no.newFoundDocument(d,m,y,c),R=a.targetIds||[],B=a.removedTargetIds||[];t=new Jv(R,B,M.key,M)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const d=nx(r,a.document),m=a.readTime?oh(a.readTime):Vn.min(),y=no.newNoDocument(d,m),c=a.removedTargetIds||[];t=new Jv([],c,y.key,y)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const d=nx(r,a.document),m=a.removedTargetIds||[];t=new Jv([],m,d,null)}else{if(!("filter"in e))return kn(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:d=0,unchangedNames:m}=a,y=new iz(d,m),c=a.targetId;t=new OC(c,y)}}return t}function mz(r,e){let t;if(e instanceof N_)t={update:ZT(r,e.key,e.value)};else if(e instanceof lw)t={delete:Zx(r,e.key)};else if(e instanceof Af)t={update:ZT(r,e.key,e.data),updateMask:Sz(e.fieldMask)};else{if(!(e instanceof tz))return kn(16599,{ft:e.type});t={verify:Zx(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(a=>function(m,y){const c=y.transform;if(c instanceof b0)return{fieldPath:y.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof p_)return{fieldPath:y.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof m_)return{fieldPath:y.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof x0)return{fieldPath:y.field.canonicalString(),increment:c.Re};throw kn(20930,{transform:y.transform})}(0,a))),e.precondition.isNone||(t.currentDocument=function(d,m){return m.updateTime!==void 0?{updateTime:dz(d,m.updateTime)}:m.exists!==void 0?{exists:m.exists}:kn(27497)}(r,e.precondition)),t}function gz(r,e){return r&&r.length>0?(Wr(e!==void 0,14353),r.map(t=>function(d,m){let y=d.updateTime?oh(d.updateTime):oh(m);return y.isEqual(Vn.min())&&(y=oh(m)),new Q3(y,d.transformResults||[])}(t,e))):[]}function yz(r,e){return{documents:[VC(r,e.path)]}}function _z(r,e){const t={structuredQuery:{}},a=e.path;let d;e.collectionGroup!==null?(d=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(d=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=VC(r,d);const m=function(R){if(R.length!==0)return qC(gc.create(R,"and"))}(e.filters);m&&(t.structuredQuery.where=m);const y=function(R){if(R.length!==0)return R.map(B=>function($){return{field:Vm($.field),direction:xz($.dir)}}(B))}(e.orderBy);y&&(t.structuredQuery.orderBy=y);const c=Gx(r,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(R){return{before:R.inclusive,values:R.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(R){return{before:!R.inclusive,values:R.position}}(e.endAt)),{gt:t,parent:d}}function vz(r){let e=fz(r.parent);const t=r.structuredQuery,a=t.from?t.from.length:0;let d=null;if(a>0){Wr(a===1,65062);const B=t.from[0];B.allDescendants?d=B.collectionId:e=e.child(B.collectionId)}let m=[];t.where&&(m=function(K){const $=UC(K);return $ instanceof gc&&_C($)?$.getFilters():[$]}(t.where));let y=[];t.orderBy&&(y=function(K){return K.map($=>function(re){return new f_(jm(re.field),function(Ce){switch(Ce){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(re.direction))}($))}(t.orderBy));let c=null;t.limit&&(c=function(K){let $;return $=typeof K=="object"?K.value:K,H0($)?null:$}(t.limit));let M=null;t.startAt&&(M=function(K){const $=!!K.before,W=K.values||[];return new v0(W,$)}(t.startAt));let R=null;return t.endAt&&(R=function(K){const $=!K.before,W=K.values||[];return new v0(W,$)}(t.endAt)),F3(e,d,y,m,c,"F",M,R)}function bz(r,e){const t=function(d){switch(d){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return kn(28987,{purpose:d})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function UC(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=jm(t.unaryFilter.field);return Da.create(a,"==",{doubleValue:NaN});case"IS_NULL":const d=jm(t.unaryFilter.field);return Da.create(d,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const m=jm(t.unaryFilter.field);return Da.create(m,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const y=jm(t.unaryFilter.field);return Da.create(y,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return kn(61313);default:return kn(60726)}}(r):r.fieldFilter!==void 0?function(t){return Da.create(jm(t.fieldFilter.field),function(d){switch(d){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return kn(58110);default:return kn(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return gc.create(t.compositeFilter.filters.map(a=>UC(a)),function(d){switch(d){case"AND":return"and";case"OR":return"or";default:return kn(1026)}}(t.compositeFilter.op))}(r):kn(30097,{filter:r})}function xz(r){return lz[r]}function wz(r){return uz[r]}function Tz(r){return cz[r]}function Vm(r){return{fieldPath:r.canonicalString()}}function jm(r){return Ps.fromServerFormat(r.fieldPath)}function qC(r){return r instanceof Da?function(t){if(t.op==="=="){if(LT(t.value))return{unaryFilter:{field:Vm(t.field),op:"IS_NAN"}};if(DT(t.value))return{unaryFilter:{field:Vm(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(LT(t.value))return{unaryFilter:{field:Vm(t.field),op:"IS_NOT_NAN"}};if(DT(t.value))return{unaryFilter:{field:Vm(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vm(t.field),op:wz(t.op),value:t.value}}}(r):r instanceof gc?function(t){const a=t.getFilters().map(d=>qC(d));return a.length===1?a[0]:{compositeFilter:{op:Tz(t.op),filters:a}}}(r):kn(54877,{filter:r})}function Sz(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function $C(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,t,a,d,m=Vn.min(),y=Vn.min(),c=ks.EMPTY_BYTE_STRING,M=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=d,this.snapshotVersion=m,this.lastLimboFreeSnapshotVersion=y,this.resumeToken=c,this.expectedCount=M}withSequenceNumber(e){return new of(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new of(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new of(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new of(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ez{constructor(e){this.wt=e}}function Az(r){const e=vz({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?$x(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cz{constructor(){this.Cn=new Iz}addToCollectionParentIndex(e,t){return this.Cn.add(t),Pt.resolve()}getCollectionParents(e,t){return Pt.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Pt.resolve()}deleteFieldIndex(e,t){return Pt.resolve()}deleteAllFieldIndexes(e){return Pt.resolve()}createTargetIndexes(e,t){return Pt.resolve()}getDocumentsMatchingTarget(e,t){return Pt.resolve(null)}getIndexType(e,t){return Pt.resolve(0)}getFieldIndexes(e,t){return Pt.resolve([])}getNextCollectionGroupToUpdate(e){return Pt.resolve(null)}getMinOffset(e,t){return Pt.resolve(pf.min())}getMinOffsetFromCollectionGroup(e,t){return Pt.resolve(pf.min())}updateCollectionGroup(e,t,a){return Pt.resolve()}updateIndexEntries(e,t){return Pt.resolve()}}class Iz{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),d=this.index[t]||new Ka(Mi.comparator),m=!d.has(a);return this.index[t]=d.add(a),m}has(e){const t=e.lastSegment(),a=e.popLast(),d=this.index[t];return d&&d.has(a)}getEntries(e){return(this.index[e]||new Ka(Mi.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},GC=41943040;class tl{static withCacheSize(e){return new tl(e,tl.DEFAULT_COLLECTION_PERCENTILE,tl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tl.DEFAULT_COLLECTION_PERCENTILE=10,tl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,tl.DEFAULT=new tl(GC,tl.DEFAULT_COLLECTION_PERCENTILE,tl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),tl.DISABLED=new tl(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new ug(0)}static lr(){return new ug(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT="LruGarbageCollector",Mz=1048576;function XT([r,e],[t,a]){const d=tr(r,t);return d===0?tr(e,a):d}class Pz{constructor(e){this.Er=e,this.buffer=new Ka(XT),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();XT(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Rz{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){en(KT,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){bg(t)?en(KT,"Ignoring IndexedDB error during garbage collection: ",t):await vg(t)}await this.mr(3e5)})}}class kz{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(a=>Math.floor(t/100*a))}nthSequenceNumber(e,t){if(t===0)return Pt.resolve(G0.le);const a=new Pz(t);return this.gr.forEachTarget(e,d=>a.Rr(d.sequenceNumber)).next(()=>this.gr.yr(e,d=>a.Rr(d))).next(()=>a.maxValue)}removeTargets(e,t,a){return this.gr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(en("LruGarbageCollector","Garbage collection skipped; disabled"),Pt.resolve(WT)):this.getCacheSize(e).next(a=>a<this.params.cacheSizeCollectionThreshold?(en("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),WT):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let a,d,m,y,c,M,R;const B=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(K=>(K>this.params.maximumSequenceNumbersToCollect?(en("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${K}`),d=this.params.maximumSequenceNumbersToCollect):d=K,y=Date.now(),this.nthSequenceNumber(e,d))).next(K=>(a=K,c=Date.now(),this.removeTargets(e,a,t))).next(K=>(m=K,M=Date.now(),this.removeOrphanedDocuments(e,a))).next(K=>(R=Date.now(),Bm()<=lr.DEBUG&&en("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${y-B}ms
	Determined least recently used ${d} in `+(c-y)+`ms
	Removed ${m} targets in `+(M-c)+`ms
	Removed ${K} documents in `+(R-M)+`ms
Total Duration: ${R-B}ms`),Pt.resolve({didRun:!0,sequenceNumbersCollected:d,targetsRemoved:m,documentsRemoved:K})))}}function Dz(r,e){return new kz(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lz{constructor(){this.changes=new Kp(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,no.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?Pt.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zz{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oz{constructor(e,t,a,d){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=d}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next(d=>(a=d,this.remoteDocumentCache.getEntry(e,t))).next(d=>(a!==null&&Qy(a.mutation,d,Pl.empty(),Wa.now()),d))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.getLocalViewOfDocuments(e,a,ur()).next(()=>a))}getLocalViewOfDocuments(e,t,a=ur()){const d=Ip();return this.populateOverlays(e,d,t).next(()=>this.computeViews(e,t,d,a).next(m=>{let y=Uy();return m.forEach((c,M)=>{y=y.insert(c,M.overlayedDocument)}),y}))}getOverlayedDocuments(e,t){const a=Ip();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,ur()))}populateOverlays(e,t,a){const d=[];return a.forEach(m=>{t.has(m)||d.push(m)}),this.documentOverlayCache.getOverlays(e,d).next(m=>{m.forEach((y,c)=>{t.set(y,c)})})}computeViews(e,t,a,d){let m=id();const y=Yy(),c=function(){return Yy()}();return t.forEach((M,R)=>{const B=a.get(R.key);d.has(R.key)&&(B===void 0||B.mutation instanceof Af)?m=m.insert(R.key,R):B!==void 0?(y.set(R.key,B.mutation.getFieldMask()),Qy(B.mutation,R,B.mutation.getFieldMask(),Wa.now())):y.set(R.key,Pl.empty())}),this.recalculateAndSaveOverlays(e,m).next(M=>(M.forEach((R,B)=>y.set(R,B)),t.forEach((R,B)=>{var K;return c.set(R,new zz(B,(K=y.get(R))!==null&&K!==void 0?K:null))}),c))}recalculateAndSaveOverlays(e,t){const a=Yy();let d=new ta((y,c)=>y-c),m=ur();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(y=>{for(const c of y)c.keys().forEach(M=>{const R=t.get(M);if(R===null)return;let B=a.get(M)||Pl.empty();B=c.applyToLocalView(R,B),a.set(M,B);const K=(d.get(c.batchId)||ur()).add(M);d=d.insert(c.batchId,K)})}).next(()=>{const y=[],c=d.getReverseIterator();for(;c.hasNext();){const M=c.getNext(),R=M.key,B=M.value,K=CC();B.forEach($=>{if(!m.has($)){const W=DC(t.get($),a.get($));W!==null&&K.set($,W),m=m.add($)}}),y.push(this.documentOverlayCache.saveOverlays(e,R,K))}return Pt.waitFor(y)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.recalculateAndSaveOverlays(e,a))}getDocumentsMatchingQuery(e,t,a,d){return function(y){return xn.isDocumentKey(y.path)&&y.collectionGroup===null&&y.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):wC(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,d):this.getDocumentsMatchingCollectionQuery(e,t,a,d)}getNextDocuments(e,t,a,d){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,d).next(m=>{const y=d-m.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,d-m.size):Pt.resolve(Ip());let c=u_,M=m;return y.next(R=>Pt.forEach(R,(B,K)=>(c<K.largestBatchId&&(c=K.largestBatchId),m.get(B)?Pt.resolve():this.remoteDocumentCache.getEntry(e,B).next($=>{M=M.insert(B,$)}))).next(()=>this.populateOverlays(e,R,m)).next(()=>this.computeViews(e,M,R,ur())).next(B=>({batchId:c,changes:AC(B)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new xn(t)).next(a=>{let d=Uy();return a.isFoundDocument()&&(d=d.insert(a.key,a)),d})}getDocumentsMatchingCollectionGroupQuery(e,t,a,d){const m=t.collectionGroup;let y=Uy();return this.indexManager.getCollectionParents(e,m).next(c=>Pt.forEach(c,M=>{const R=function(K,$){return new xg($,null,K.explicitOrderBy.slice(),K.filters.slice(),K.limit,K.limitType,K.startAt,K.endAt)}(t,M.child(m));return this.getDocumentsMatchingCollectionQuery(e,R,a,d).next(B=>{B.forEach((K,$)=>{y=y.insert(K,$)})})}).next(()=>y))}getDocumentsMatchingCollectionQuery(e,t,a,d){let m;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next(y=>(m=y,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,m,d))).next(y=>{m.forEach((M,R)=>{const B=R.getKey();y.get(B)===null&&(y=y.insert(B,no.newInvalidDocument(B)))});let c=Uy();return y.forEach((M,R)=>{const B=m.get(M);B!==void 0&&Qy(B.mutation,R,Pl.empty(),Wa.now()),K0(t,R)&&(c=c.insert(M,R))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nz{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return Pt.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(d){return{id:d.id,version:d.version,createTime:oh(d.createTime)}}(t)),Pt.resolve()}getNamedQuery(e,t){return Pt.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(d){return{name:d.name,query:Az(d.bundledQuery),readTime:oh(d.readTime)}}(t)),Pt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(){this.overlays=new ta(xn.comparator),this.Qr=new Map}getOverlay(e,t){return Pt.resolve(this.overlays.get(t))}getOverlays(e,t){const a=Ip();return Pt.forEach(t,d=>this.getOverlay(e,d).next(m=>{m!==null&&a.set(d,m)})).next(()=>a)}saveOverlays(e,t,a){return a.forEach((d,m)=>{this.St(e,t,m)}),Pt.resolve()}removeOverlaysForBatchId(e,t,a){const d=this.Qr.get(a);return d!==void 0&&(d.forEach(m=>this.overlays=this.overlays.remove(m)),this.Qr.delete(a)),Pt.resolve()}getOverlaysForCollection(e,t,a){const d=Ip(),m=t.length+1,y=new xn(t.child("")),c=this.overlays.getIteratorFrom(y);for(;c.hasNext();){const M=c.getNext().value,R=M.getKey();if(!t.isPrefixOf(R.path))break;R.path.length===m&&M.largestBatchId>a&&d.set(M.getKey(),M)}return Pt.resolve(d)}getOverlaysForCollectionGroup(e,t,a,d){let m=new ta((R,B)=>R-B);const y=this.overlays.getIterator();for(;y.hasNext();){const R=y.getNext().value;if(R.getKey().getCollectionGroup()===t&&R.largestBatchId>a){let B=m.get(R.largestBatchId);B===null&&(B=Ip(),m=m.insert(R.largestBatchId,B)),B.set(R.getKey(),R)}}const c=Ip(),M=m.getIterator();for(;M.hasNext()&&(M.getNext().value.forEach((R,B)=>c.set(R,B)),!(c.size()>=d)););return Pt.resolve(c)}St(e,t,a){const d=this.overlays.get(a.key);if(d!==null){const y=this.Qr.get(d.largestBatchId).delete(a.key);this.Qr.set(d.largestBatchId,y)}this.overlays=this.overlays.insert(a.key,new rz(t,a));let m=this.Qr.get(t);m===void 0&&(m=ur(),this.Qr.set(t,m)),this.Qr.set(t,m.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fz{constructor(){this.sessionToken=ks.EMPTY_BYTE_STRING}getSessionToken(e){return Pt.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Pt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(){this.$r=new Ka(os.Ur),this.Kr=new Ka(os.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const a=new os(e,t);this.$r=this.$r.add(a),this.Kr=this.Kr.add(a)}Gr(e,t){e.forEach(a=>this.addReference(a,t))}removeReference(e,t){this.zr(new os(e,t))}jr(e,t){e.forEach(a=>this.removeReference(a,t))}Hr(e){const t=new xn(new Mi([])),a=new os(t,e),d=new os(t,e+1),m=[];return this.Kr.forEachInRange([a,d],y=>{this.zr(y),m.push(y.key)}),m}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new xn(new Mi([])),a=new os(t,e),d=new os(t,e+1);let m=ur();return this.Kr.forEachInRange([a,d],y=>{m=m.add(y.key)}),m}containsKey(e){const t=new os(e,0),a=this.$r.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class os{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return xn.comparator(e.key,t.key)||tr(e.Zr,t.Zr)}static Wr(e,t){return tr(e.Zr,t.Zr)||xn.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vz{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Ka(os.Ur)}checkEmpty(e){return Pt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,d){const m=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const y=new nz(m,t,a,d);this.mutationQueue.push(y);for(const c of d)this.Xr=this.Xr.add(new os(c.key,m)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Pt.resolve(y)}lookupMutationBatch(e,t){return Pt.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,d=this.ti(a),m=d<0?0:d;return Pt.resolve(this.mutationQueue.length>m?this.mutationQueue[m]:null)}getHighestUnacknowledgedBatchId(){return Pt.resolve(this.mutationQueue.length===0?tw:this.nr-1)}getAllMutationBatches(e){return Pt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new os(t,0),d=new os(t,Number.POSITIVE_INFINITY),m=[];return this.Xr.forEachInRange([a,d],y=>{const c=this.ei(y.Zr);m.push(c)}),Pt.resolve(m)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Ka(tr);return t.forEach(d=>{const m=new os(d,0),y=new os(d,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([m,y],c=>{a=a.add(c.Zr)})}),Pt.resolve(this.ni(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,d=a.length+1;let m=a;xn.isDocumentKey(m)||(m=m.child(""));const y=new os(new xn(m),0);let c=new Ka(tr);return this.Xr.forEachWhile(M=>{const R=M.key.path;return!!a.isPrefixOf(R)&&(R.length===d&&(c=c.add(M.Zr)),!0)},y),Pt.resolve(this.ni(c))}ni(e){const t=[];return e.forEach(a=>{const d=this.ei(a);d!==null&&t.push(d)}),t}removeMutationBatch(e,t){Wr(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Xr;return Pt.forEach(t.mutations,d=>{const m=new os(d.key,t.batchId);return a=a.delete(m),this.referenceDelegate.markPotentiallyOrphaned(e,d.key)}).next(()=>{this.Xr=a})}sr(e){}containsKey(e,t){const a=new os(t,0),d=this.Xr.firstAfterOrEqual(a);return Pt.resolve(t.isEqual(d&&d.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pt.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jz{constructor(e){this.ii=e,this.docs=function(){return new ta(xn.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,d=this.docs.get(a),m=d?d.size:0,y=this.ii(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:y}),this.size+=y-m,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return Pt.resolve(a?a.document.mutableCopy():no.newInvalidDocument(t))}getEntries(e,t){let a=id();return t.forEach(d=>{const m=this.docs.get(d);a=a.insert(d,m?m.document.mutableCopy():no.newInvalidDocument(d))}),Pt.resolve(a)}getDocumentsMatchingQuery(e,t,a,d){let m=id();const y=t.path,c=new xn(y.child("__id-9223372036854775808__")),M=this.docs.getIteratorFrom(c);for(;M.hasNext();){const{key:R,value:{document:B}}=M.getNext();if(!y.isPrefixOf(R.path))break;R.path.length>y.length+1||y3(g3(B),a)<=0||(d.has(B.key)||K0(t,B))&&(m=m.insert(B.key,B.mutableCopy()))}return Pt.resolve(m)}getAllFromCollectionGroup(e,t,a,d){kn(9500)}si(e,t){return Pt.forEach(this.docs,a=>t(a))}newChangeBuffer(e){return new Uz(this)}getSize(e){return Pt.resolve(this.size)}}class Uz extends Lz{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((a,d)=>{d.isValidDocument()?t.push(this.Br.addEntry(e,d)):this.Br.removeEntry(a)}),Pt.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qz{constructor(e){this.persistence=e,this.oi=new Kp(t=>iw(t),aw),this.lastRemoteSnapshotVersion=Vn.min(),this.highestTargetId=0,this._i=0,this.ai=new dw,this.targetCount=0,this.ui=ug.cr()}forEachTarget(e,t){return this.oi.forEach((a,d)=>t(d)),Pt.resolve()}getLastRemoteSnapshotVersion(e){return Pt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pt.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),Pt.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this._i&&(this._i=t),Pt.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new ug(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,Pt.resolve()}updateTargetData(e,t){return this.Tr(t),Pt.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,Pt.resolve()}removeTargets(e,t,a){let d=0;const m=[];return this.oi.forEach((y,c)=>{c.sequenceNumber<=t&&a.get(c.targetId)===null&&(this.oi.delete(y),m.push(this.removeMatchingKeysForTargetId(e,c.targetId)),d++)}),Pt.waitFor(m).next(()=>d)}getTargetCount(e){return Pt.resolve(this.targetCount)}getTargetData(e,t){const a=this.oi.get(t)||null;return Pt.resolve(a)}addMatchingKeys(e,t,a){return this.ai.Gr(t,a),Pt.resolve()}removeMatchingKeys(e,t,a){this.ai.jr(t,a);const d=this.persistence.referenceDelegate,m=[];return d&&t.forEach(y=>{m.push(d.markPotentiallyOrphaned(e,y))}),Pt.waitFor(m)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),Pt.resolve()}getMatchingKeysForTargetId(e,t){const a=this.ai.Yr(t);return Pt.resolve(a)}containsKey(e,t){return Pt.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,t){this.ci={},this.overlays={},this.li=new G0(0),this.hi=!1,this.hi=!0,this.Pi=new Fz,this.referenceDelegate=e(this),this.Ti=new qz(this),this.indexManager=new Cz,this.remoteDocumentCache=function(d){return new jz(d)}(a=>this.referenceDelegate.Ii(a)),this.serializer=new Ez(t),this.Ei=new Nz(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Bz,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ci[e.toKey()];return a||(a=new Vz(t,this.referenceDelegate),this.ci[e.toKey()]=a),a}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,a){en("MemoryPersistence","Starting transaction:",e);const d=new $z(this.li.next());return this.referenceDelegate.di(),a(d).next(m=>this.referenceDelegate.Ai(d).next(()=>m)).toPromise().then(m=>(d.raiseOnCommittedEvent(),m))}Ri(e,t){return Pt.or(Object.values(this.ci).map(a=>()=>a.containsKey(e,t)))}}class $z extends v3{constructor(e){super(),this.currentSequenceNumber=e}}class fw{constructor(e){this.persistence=e,this.Vi=new dw,this.mi=null}static fi(e){return new fw(e)}get gi(){if(this.mi)return this.mi;throw kn(60996)}addReference(e,t,a){return this.Vi.addReference(a,t),this.gi.delete(a.toString()),Pt.resolve()}removeReference(e,t,a){return this.Vi.removeReference(a,t),this.gi.add(a.toString()),Pt.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),Pt.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(d=>this.gi.add(d.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next(d=>{d.forEach(m=>this.gi.add(m.toString()))}).next(()=>a.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pt.forEach(this.gi,a=>{const d=xn.fromPath(a);return this.pi(e,d).next(m=>{m||t.removeEntry(d,Vn.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(a=>{a?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return Pt.or([()=>Pt.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class T0{constructor(e,t){this.persistence=e,this.yi=new Kp(a=>w3(a.path),(a,d)=>a.isEqual(d)),this.garbageCollector=Dz(this,t)}static fi(e,t){return new T0(e,t)}di(){}Ai(e){return Pt.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(a=>t.next(d=>a+d))}br(e){let t=0;return this.yr(e,a=>{t++}).next(()=>t)}yr(e,t){return Pt.forEach(this.yi,(a,d)=>this.Dr(e,a,d).next(m=>m?Pt.resolve():t(d)))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const d=this.persistence.getRemoteDocumentCache(),m=d.newChangeBuffer();return d.si(e,y=>this.Dr(e,y,t).next(c=>{c||(a++,m.removeEntry(y,Vn.min()))})).next(()=>m.apply(e)).next(()=>a)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),Pt.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),Pt.resolve()}removeReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),Pt.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),Pt.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Xv(e.data.value)),t}Dr(e,t,a){return Pt.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const d=this.yi.get(t);return Pt.resolve(d!==void 0&&d>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,t,a,d){this.targetId=e,this.fromCache=t,this.ds=a,this.As=d}static Rs(e,t){let a=ur(),d=ur();for(const m of t.docChanges)switch(m.type){case 0:a=a.add(m.doc.key);break;case 1:d=d.add(m.doc.key)}return new pw(e,t.fromCache,a,d)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gz{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return Ck()?8:b3(ro())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,a,d){const m={result:null};return this.ws(e,t).next(y=>{m.result=y}).next(()=>{if(!m.result)return this.bs(e,t,d,a).next(y=>{m.result=y})}).next(()=>{if(m.result)return;const y=new Gz;return this.Ss(e,t,y).next(c=>{if(m.result=c,this.fs)return this.Ds(e,t,y,c.size)})}).next(()=>m.result)}Ds(e,t,a,d){return a.documentReadCount<this.gs?(Bm()<=lr.DEBUG&&en("QueryEngine","SDK will not create cache indexes for query:",Fm(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),Pt.resolve()):(Bm()<=lr.DEBUG&&en("QueryEngine","Query:",Fm(t),"scans",a.documentReadCount,"local documents and returns",d,"documents as results."),a.documentReadCount>this.ps*d?(Bm()<=lr.DEBUG&&en("QueryEngine","The SDK decides to create cache indexes for query:",Fm(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,sh(t))):Pt.resolve())}ws(e,t){if(BT(t))return Pt.resolve(null);let a=sh(t);return this.indexManager.getIndexType(e,a).next(d=>d===0?null:(t.limit!==null&&d===1&&(t=$x(t,null,"F"),a=sh(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next(m=>{const y=ur(...m);return this.ys.getDocuments(e,y).next(c=>this.indexManager.getMinOffset(e,a).next(M=>{const R=this.vs(t,c);return this.Cs(t,R,y,M.readTime)?this.ws(e,$x(t,null,"F")):this.Fs(e,R,t,M)}))})))}bs(e,t,a,d){return BT(t)||d.isEqual(Vn.min())?Pt.resolve(null):this.ys.getDocuments(e,a).next(m=>{const y=this.vs(t,m);return this.Cs(t,y,a,d)?Pt.resolve(null):(Bm()<=lr.DEBUG&&en("QueryEngine","Re-using previous result from %s to execute query: %s",d.toString(),Fm(t)),this.Fs(e,y,t,m3(d,u_)).next(c=>c))})}vs(e,t){let a=new Ka(SC(e));return t.forEach((d,m)=>{K0(e,m)&&(a=a.add(m))}),a}Cs(e,t,a,d){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const m=e.limitType==="F"?t.last():t.first();return!!m&&(m.hasPendingWrites||m.version.compareTo(d)>0)}Ss(e,t,a){return Bm()<=lr.DEBUG&&en("QueryEngine","Using full collection scan to execute query:",Fm(t)),this.ys.getDocumentsMatchingQuery(e,t,pf.min(),a)}Fs(e,t,a,d){return this.ys.getDocumentsMatchingQuery(e,a,d).next(m=>(t.forEach(y=>{m=m.insert(y.key,y)}),m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw="LocalStore",Zz=3e8;class Wz{constructor(e,t,a,d){this.persistence=e,this.Ms=t,this.serializer=d,this.xs=new ta(tr),this.Os=new Kp(m=>iw(m),aw),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(a)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Oz(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function Kz(r,e,t,a){return new Wz(r,e,t,a)}async function ZC(r,e){const t=Un(r);return await t.persistence.runTransaction("Handle user change","readonly",a=>{let d;return t.mutationQueue.getAllMutationBatches(a).next(m=>(d=m,t.Ls(e),t.mutationQueue.getAllMutationBatches(a))).next(m=>{const y=[],c=[];let M=ur();for(const R of d){y.push(R.batchId);for(const B of R.mutations)M=M.add(B.key)}for(const R of m){c.push(R.batchId);for(const B of R.mutations)M=M.add(B.key)}return t.localDocuments.getDocuments(a,M).next(R=>({ks:R,removedBatchIds:y,addedBatchIds:c}))})})}function Xz(r,e){const t=Un(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const d=e.batch.keys(),m=t.Bs.newChangeBuffer({trackRemovals:!0});return function(c,M,R,B){const K=R.batch,$=K.keys();let W=Pt.resolve();return $.forEach(re=>{W=W.next(()=>B.getEntry(M,re)).next(Me=>{const Ce=R.docVersions.get(re);Wr(Ce!==null,48541),Me.version.compareTo(Ce)<0&&(K.applyToRemoteDocument(Me,R),Me.isValidDocument()&&(Me.setReadTime(R.commitVersion),B.addEntry(Me)))})}),W.next(()=>c.mutationQueue.removeMutationBatch(M,K))}(t,a,e,m).next(()=>m.apply(a)).next(()=>t.mutationQueue.performConsistencyCheck(a)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(a,d,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(c){let M=ur();for(let R=0;R<c.mutationResults.length;++R)c.mutationResults[R].transformResults.length>0&&(M=M.add(c.batch.mutations[R].key));return M}(e))).next(()=>t.localDocuments.getDocuments(a,d))})}function WC(r){const e=Un(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function Yz(r,e){const t=Un(r),a=e.snapshotVersion;let d=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",m=>{const y=t.Bs.newChangeBuffer({trackRemovals:!0});d=t.xs;const c=[];e.targetChanges.forEach((B,K)=>{const $=d.get(K);if(!$)return;c.push(t.Ti.removeMatchingKeys(m,B.removedDocuments,K).next(()=>t.Ti.addMatchingKeys(m,B.addedDocuments,K)));let W=$.withSequenceNumber(m.currentSequenceNumber);e.targetMismatches.get(K)!==null?W=W.withResumeToken(ks.EMPTY_BYTE_STRING,Vn.min()).withLastLimboFreeSnapshotVersion(Vn.min()):B.resumeToken.approximateByteSize()>0&&(W=W.withResumeToken(B.resumeToken,a)),d=d.insert(K,W),function(Me,Ce,Be){return Me.resumeToken.approximateByteSize()===0||Ce.snapshotVersion.toMicroseconds()-Me.snapshotVersion.toMicroseconds()>=Zz?!0:Be.addedDocuments.size+Be.modifiedDocuments.size+Be.removedDocuments.size>0}($,W,B)&&c.push(t.Ti.updateTargetData(m,W))});let M=id(),R=ur();if(e.documentUpdates.forEach(B=>{e.resolvedLimboDocuments.has(B)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(m,B))}),c.push(Qz(m,y,e.documentUpdates).next(B=>{M=B.qs,R=B.Qs})),!a.isEqual(Vn.min())){const B=t.Ti.getLastRemoteSnapshotVersion(m).next(K=>t.Ti.setTargetsMetadata(m,m.currentSequenceNumber,a));c.push(B)}return Pt.waitFor(c).next(()=>y.apply(m)).next(()=>t.localDocuments.getLocalViewOfDocuments(m,M,R)).next(()=>M)}).then(m=>(t.xs=d,m))}function Qz(r,e,t){let a=ur(),d=ur();return t.forEach(m=>a=a.add(m)),e.getEntries(r,a).next(m=>{let y=id();return t.forEach((c,M)=>{const R=m.get(c);M.isFoundDocument()!==R.isFoundDocument()&&(d=d.add(c)),M.isNoDocument()&&M.version.isEqual(Vn.min())?(e.removeEntry(c,M.readTime),y=y.insert(c,M)):!R.isValidDocument()||M.version.compareTo(R.version)>0||M.version.compareTo(R.version)===0&&R.hasPendingWrites?(e.addEntry(M),y=y.insert(c,M)):en(mw,"Ignoring outdated watch update for ",c,". Current version:",R.version," Watch version:",M.version)}),{qs:y,Qs:d}})}function Jz(r,e){const t=Un(r);return t.persistence.runTransaction("Get next mutation batch","readonly",a=>(e===void 0&&(e=tw),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e)))}function eO(r,e){const t=Un(r);return t.persistence.runTransaction("Allocate target","readwrite",a=>{let d;return t.Ti.getTargetData(a,e).next(m=>m?(d=m,Pt.resolve(d)):t.Ti.allocateTargetId(a).next(y=>(d=new of(e,y,"TargetPurposeListen",a.currentSequenceNumber),t.Ti.addTargetData(a,d).next(()=>d))))}).then(a=>{const d=t.xs.get(a.targetId);return(d===null||a.snapshotVersion.compareTo(d.snapshotVersion)>0)&&(t.xs=t.xs.insert(a.targetId,a),t.Os.set(e,a.targetId)),a})}async function Kx(r,e,t){const a=Un(r),d=a.xs.get(e),m=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",m,y=>a.persistence.referenceDelegate.removeTarget(y,d))}catch(y){if(!bg(y))throw y;en(mw,`Failed to update sequence numbers for target ${e}: ${y}`)}a.xs=a.xs.remove(e),a.Os.delete(d.target)}function YT(r,e,t){const a=Un(r);let d=Vn.min(),m=ur();return a.persistence.runTransaction("Execute query","readwrite",y=>function(M,R,B){const K=Un(M),$=K.Os.get(B);return $!==void 0?Pt.resolve(K.xs.get($)):K.Ti.getTargetData(R,B)}(a,y,sh(e)).next(c=>{if(c)return d=c.lastLimboFreeSnapshotVersion,a.Ti.getMatchingKeysForTargetId(y,c.targetId).next(M=>{m=M})}).next(()=>a.Ms.getDocumentsMatchingQuery(y,e,t?d:Vn.min(),t?m:ur())).next(c=>(tO(a,j3(e),c),{documents:c,$s:m})))}function tO(r,e,t){let a=r.Ns.get(e)||Vn.min();t.forEach((d,m)=>{m.readTime.compareTo(a)>0&&(a=m.readTime)}),r.Ns.set(e,a)}class QT{constructor(){this.activeTargetIds=Z3()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class nO{constructor(){this.xo=new QT,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,a){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new QT,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JT="ConnectivityMonitor";class eS{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){en(JT,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){en(JT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lv=null;function Xx(){return Lv===null?Lv=function(){return 268435456+Math.round(2147483648*Math.random())}():Lv++,"0x"+Lv.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx="RestConnection",iO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aO{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),d=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${a}/databases/${d}`,this.Go=this.databaseId.database===y0?`project_id=${a}`:`project_id=${a}&database_id=${d}`}zo(e,t,a,d,m){const y=Xx(),c=this.jo(e,t.toUriEncodedString());en(rx,`Sending RPC '${e}' ${y}:`,c,a);const M={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(M,d,m);const{host:R}=new URL(c),B=P_(R);return this.Jo(e,c,M,a,B).then(K=>(en(rx,`Received RPC '${e}' ${y}: `,K),K),K=>{throw ag(rx,`RPC '${e}' ${y} failed with error: `,K,"url: ",c,"request:",a),K})}Yo(e,t,a,d,m,y){return this.zo(e,t,a,d,m)}Ho(e,t,a){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+_g}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((d,m)=>e[m]=d),a&&a.headers.forEach((d,m)=>e[m]=d)}jo(e,t){const a=iO[e];return`${this.Ko}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js="WebChannelConnection";class oO extends aO{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,d,m){const y=Xx();return new Promise((c,M)=>{const R=new YA;R.setWithCredentials(!0),R.listenOnce(QA.COMPLETE,()=>{try{switch(R.getLastErrorCode()){case Kv.NO_ERROR:const K=R.getResponseJson();en(Js,`XHR for RPC '${e}' ${y} received:`,JSON.stringify(K)),c(K);break;case Kv.TIMEOUT:en(Js,`RPC '${e}' ${y} timed out`),M(new tn(It.DEADLINE_EXCEEDED,"Request time out"));break;case Kv.HTTP_ERROR:const $=R.getStatus();if(en(Js,`RPC '${e}' ${y} failed with status:`,$,"response text:",R.getResponseText()),$>0){let W=R.getResponseJson();Array.isArray(W)&&(W=W[0]);const re=W==null?void 0:W.error;if(re&&re.status&&re.message){const Me=function(Be){const He=Be.toLowerCase().replace(/_/g,"-");return Object.values(It).indexOf(He)>=0?He:It.UNKNOWN}(re.status);M(new tn(Me,re.message))}else M(new tn(It.UNKNOWN,"Server responded with status "+R.getStatus()))}else M(new tn(It.UNAVAILABLE,"Connection failed."));break;default:kn(9055,{h_:e,streamId:y,P_:R.getLastErrorCode(),T_:R.getLastError()})}}finally{en(Js,`RPC '${e}' ${y} completed.`)}});const B=JSON.stringify(d);en(Js,`RPC '${e}' ${y} sending request:`,d),R.send(t,"POST",B,a,15)})}I_(e,t,a){const d=Xx(),m=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],y=tC(),c=eC(),M={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},R=this.longPollingOptions.timeoutSeconds;R!==void 0&&(M.longPollingTimeout=Math.round(1e3*R)),this.useFetchStreams&&(M.useFetchStreams=!0),this.Ho(M.initMessageHeaders,t,a),M.encodeInitMessageHeaders=!0;const B=m.join("");en(Js,`Creating RPC '${e}' stream ${d}: ${B}`,M);const K=y.createWebChannel(B,M);this.E_(K);let $=!1,W=!1;const re=new sO({Zo:Ce=>{W?en(Js,`Not sending because RPC '${e}' stream ${d} is closed:`,Ce):($||(en(Js,`Opening RPC '${e}' stream ${d} transport.`),K.open(),$=!0),en(Js,`RPC '${e}' stream ${d} sending:`,Ce),K.send(Ce))},Xo:()=>K.close()}),Me=(Ce,Be,He)=>{Ce.listen(Be,ut=>{try{He(ut)}catch(Ue){setTimeout(()=>{throw Ue},0)}})};return Me(K,jy.EventType.OPEN,()=>{W||(en(Js,`RPC '${e}' stream ${d} transport opened.`),re.__())}),Me(K,jy.EventType.CLOSE,()=>{W||(W=!0,en(Js,`RPC '${e}' stream ${d} transport closed`),re.u_(),this.d_(K))}),Me(K,jy.EventType.ERROR,Ce=>{W||(W=!0,ag(Js,`RPC '${e}' stream ${d} transport errored. Name:`,Ce.name,"Message:",Ce.message),re.u_(new tn(It.UNAVAILABLE,"The operation could not be completed")))}),Me(K,jy.EventType.MESSAGE,Ce=>{var Be;if(!W){const He=Ce.data[0];Wr(!!He,16349);const ut=He,Ue=(ut==null?void 0:ut.error)||((Be=ut[0])===null||Be===void 0?void 0:Be.error);if(Ue){en(Js,`RPC '${e}' stream ${d} received error:`,Ue);const Fe=Ue.status;let Ze=function(ye){const we=ka[ye];if(we!==void 0)return zC(we)}(Fe),me=Ue.message;Ze===void 0&&(Ze=It.INTERNAL,me="Unknown error status: "+Fe+" with message "+Ue.message),W=!0,re.u_(new tn(Ze,me)),K.close()}else en(Js,`RPC '${e}' stream ${d} received:`,He),re.c_(He)}}),Me(c,JA.STAT_EVENT,Ce=>{Ce.stat===Nx.PROXY?en(Js,`RPC '${e}' stream ${d} detected buffering proxy`):Ce.stat===Nx.NOPROXY&&en(Js,`RPC '${e}' stream ${d} detected no buffering proxy`)}),setTimeout(()=>{re.a_()},0),re}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function ix(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(r){return new hz(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,t,a=1e3,d=1.5,m=6e4){this.xi=e,this.timerId=t,this.A_=a,this.R_=d,this.V_=m,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),a=Math.max(0,Date.now()-this.g_),d=Math.max(0,t-a);d>0&&en("ExponentialBackoff",`Backing off for ${d} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,d,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS="PersistentStream";class XC{constructor(e,t,a,d,m,y,c,M){this.xi=e,this.S_=a,this.D_=d,this.connection=m,this.authCredentialsProvider=y,this.appCheckCredentialsProvider=c,this.listener=M,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new KC(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===It.RESOURCE_EXHAUSTED?(rd(t.toString()),rd("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===It.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,d])=>{this.v_===t&&this.z_(a,d)},a=>{e(()=>{const d=new tn(It.UNKNOWN,"Fetching auth token failed: "+a.message);return this.j_(d)})})}z_(e,t){const a=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{a(()=>this.listener.e_())}),this.stream.n_(()=>{a(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(d=>{a(()=>this.j_(d))}),this.stream.onMessage(d=>{a(()=>++this.M_==1?this.J_(d):this.onNext(d))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return en(tS,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(en(tS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lO extends XC{constructor(e,t,a,d,m,y){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,d,y),this.serializer=m}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=pz(this.serializer,e),a=function(m){if(!("targetChange"in m))return Vn.min();const y=m.targetChange;return y.targetIds&&y.targetIds.length?Vn.min():y.readTime?oh(y.readTime):Vn.min()}(e);return this.listener.Y_(t,a)}Z_(e){const t={};t.database=Wx(this.serializer),t.addTarget=function(m,y){let c;const M=y.target;if(c=Ux(M)?{documents:yz(m,M)}:{query:_z(m,M).gt},c.targetId=y.targetId,y.resumeToken.approximateByteSize()>0){c.resumeToken=BC(m,y.resumeToken);const R=Gx(m,y.expectedCount);R!==null&&(c.expectedCount=R)}else if(y.snapshotVersion.compareTo(Vn.min())>0){c.readTime=w0(m,y.snapshotVersion.toTimestamp());const R=Gx(m,y.expectedCount);R!==null&&(c.expectedCount=R)}return c}(this.serializer,e);const a=bz(this.serializer,e);a&&(t.labels=a),this.Q_(t)}X_(e){const t={};t.database=Wx(this.serializer),t.removeTarget=e,this.Q_(t)}}class uO extends XC{constructor(e,t,a,d,m,y){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,d,y),this.serializer=m}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Wr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Wr(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Wr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=gz(e.writeResults,e.commitTime),a=oh(e.commitTime);return this.listener.ra(a,t)}ia(){const e={};e.database=Wx(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(a=>mz(this.serializer,a))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{}class hO extends cO{constructor(e,t,a,d){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=d,this.sa=!1}oa(){if(this.sa)throw new tn(It.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,a,d){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([m,y])=>this.connection.zo(e,Hx(t,a),d,m,y)).catch(m=>{throw m.name==="FirebaseError"?(m.code===It.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),m):new tn(It.UNKNOWN,m.toString())})}Yo(e,t,a,d,m){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([y,c])=>this.connection.Yo(e,Hx(t,a),d,y,c,m)).catch(y=>{throw y.name==="FirebaseError"?(y.code===It.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),y):new tn(It.UNKNOWN,y.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class dO{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(rd(t),this.ua=!1):en("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp="RemoteStore";class fO{constructor(e,t,a,d,m){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=m,this.Ra.No(y=>{a.enqueueAndForget(async()=>{Xp(this)&&(en(jp,"Restarting streams for network reachability change."),await async function(M){const R=Un(M);R.da.add(4),await F_(R),R.Va.set("Unknown"),R.da.delete(4),await eb(R)}(this))})}),this.Va=new dO(a,d)}}async function eb(r){if(Xp(r))for(const e of r.Aa)await e(!0)}async function F_(r){for(const e of r.Aa)await e(!1)}function YC(r,e){const t=Un(r);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),vw(t)?_w(t):wg(t).N_()&&yw(t,e))}function gw(r,e){const t=Un(r),a=wg(t);t.Ea.delete(e),a.N_()&&QC(t,e),t.Ea.size===0&&(a.N_()?a.k_():Xp(t)&&t.Va.set("Unknown"))}function yw(r,e){if(r.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Vn.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}wg(r).Z_(e)}function QC(r,e){r.ma.Ke(e),wg(r).X_(e)}function _w(r){r.ma=new oz({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>r.Ea.get(e)||null,Pt:()=>r.datastore.serializer.databaseId}),wg(r).start(),r.Va.ca()}function vw(r){return Xp(r)&&!wg(r).O_()&&r.Ea.size>0}function Xp(r){return Un(r).da.size===0}function JC(r){r.ma=void 0}async function pO(r){r.Va.set("Online")}async function mO(r){r.Ea.forEach((e,t)=>{yw(r,e)})}async function gO(r,e){JC(r),vw(r)?(r.Va.Pa(e),_w(r)):r.Va.set("Unknown")}async function yO(r,e,t){if(r.Va.set("Online"),e instanceof NC&&e.state===2&&e.cause)try{await async function(d,m){const y=m.cause;for(const c of m.targetIds)d.Ea.has(c)&&(await d.remoteSyncer.rejectListen(c,y),d.Ea.delete(c),d.ma.removeTarget(c))}(r,e)}catch(a){en(jp,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await S0(r,a)}else if(e instanceof Jv?r.ma.Xe(e):e instanceof OC?r.ma.ot(e):r.ma.nt(e),!t.isEqual(Vn.min()))try{const a=await WC(r.localStore);t.compareTo(a)>=0&&await function(m,y){const c=m.ma.It(y);return c.targetChanges.forEach((M,R)=>{if(M.resumeToken.approximateByteSize()>0){const B=m.Ea.get(R);B&&m.Ea.set(R,B.withResumeToken(M.resumeToken,y))}}),c.targetMismatches.forEach((M,R)=>{const B=m.Ea.get(M);if(!B)return;m.Ea.set(M,B.withResumeToken(ks.EMPTY_BYTE_STRING,B.snapshotVersion)),QC(m,M);const K=new of(B.target,M,R,B.sequenceNumber);yw(m,K)}),m.remoteSyncer.applyRemoteEvent(c)}(r,t)}catch(a){en(jp,"Failed to raise snapshot:",a),await S0(r,a)}}async function S0(r,e,t){if(!bg(e))throw e;r.da.add(1),await F_(r),r.Va.set("Offline"),t||(t=()=>WC(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{en(jp,"Retrying IndexedDB access"),await t(),r.da.delete(1),await eb(r)})}function eI(r,e){return e().catch(t=>S0(r,t,e))}async function tb(r){const e=Un(r),t=_f(e);let a=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:tw;for(;_O(e);)try{const d=await Jz(e.localStore,a);if(d===null){e.Ia.length===0&&t.k_();break}a=d.batchId,vO(e,d)}catch(d){await S0(e,d)}tI(e)&&nI(e)}function _O(r){return Xp(r)&&r.Ia.length<10}function vO(r,e){r.Ia.push(e);const t=_f(r);t.N_()&&t.ea&&t.ta(e.mutations)}function tI(r){return Xp(r)&&!_f(r).O_()&&r.Ia.length>0}function nI(r){_f(r).start()}async function bO(r){_f(r).ia()}async function xO(r){const e=_f(r);for(const t of r.Ia)e.ta(t.mutations)}async function wO(r,e,t){const a=r.Ia.shift(),d=uw.from(a,e,t);await eI(r,()=>r.remoteSyncer.applySuccessfulWrite(d)),await tb(r)}async function TO(r,e){e&&_f(r).ea&&await async function(a,d){if(function(y){return az(y)&&y!==It.ABORTED}(d.code)){const m=a.Ia.shift();_f(a).L_(),await eI(a,()=>a.remoteSyncer.rejectFailedWrite(m.batchId,d)),await tb(a)}}(r,e),tI(r)&&nI(r)}async function nS(r,e){const t=Un(r);t.asyncQueue.verifyOperationInProgress(),en(jp,"RemoteStore received new credentials");const a=Xp(t);t.da.add(3),await F_(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await eb(t)}async function SO(r,e){const t=Un(r);e?(t.da.delete(2),await eb(t)):e||(t.da.add(2),await F_(t),t.Va.set("Unknown"))}function wg(r){return r.fa||(r.fa=function(t,a,d){const m=Un(t);return m.oa(),new lO(a,m.connection,m.authCredentials,m.appCheckCredentials,m.serializer,d)}(r.datastore,r.asyncQueue,{e_:pO.bind(null,r),n_:mO.bind(null,r),i_:gO.bind(null,r),Y_:yO.bind(null,r)}),r.Aa.push(async e=>{e?(r.fa.L_(),vw(r)?_w(r):r.Va.set("Unknown")):(await r.fa.stop(),JC(r))})),r.fa}function _f(r){return r.ga||(r.ga=function(t,a,d){const m=Un(t);return m.oa(),new uO(a,m.connection,m.authCredentials,m.appCheckCredentials,m.serializer,d)}(r.datastore,r.asyncQueue,{e_:()=>Promise.resolve(),n_:bO.bind(null,r),i_:TO.bind(null,r),na:xO.bind(null,r),ra:wO.bind(null,r)}),r.Aa.push(async e=>{e?(r.ga.L_(),await tb(r)):(await r.ga.stop(),r.Ia.length>0&&(en(jp,`Stopping write stream with ${r.Ia.length} pending writes`),r.Ia=[]))})),r.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e,t,a,d,m){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=d,this.removalCallback=m,this.deferred=new Yh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(y=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,d,m){const y=Date.now()+a,c=new bw(e,t,y,d,m);return c.start(a),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new tn(It.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xw(r,e){if(rd("AsyncQueue",`${e}: ${r}`),bg(r))return new tn(It.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{static emptySet(e){return new Jm(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||xn.comparator(t.key,a.key):(t,a)=>xn.comparator(t.key,a.key),this.keyedMap=Uy(),this.sortedSet=new ta(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,a)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Jm)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const d=t.getNext().key,m=a.getNext().key;if(!d.isEqual(m))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new Jm;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(){this.pa=new ta(xn.comparator)}track(e){const t=e.doc.key,a=this.pa.get(t);a?e.type!==0&&a.type===3?this.pa=this.pa.insert(t,e):e.type===3&&a.type!==1?this.pa=this.pa.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.pa=this.pa.remove(t):e.type===1&&a.type===2?this.pa=this.pa.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):kn(63341,{Vt:e,ya:a}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,a)=>{e.push(a)}),e}}class cg{constructor(e,t,a,d,m,y,c,M,R){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=d,this.mutatedKeys=m,this.fromCache=y,this.syncStateChanged=c,this.excludesMetadataChanges=M,this.hasCachedResults=R}static fromInitialDocuments(e,t,a,d,m){const y=[];return t.forEach(c=>{y.push({type:0,doc:c})}),new cg(e,t,Jm.emptySet(t),y,a,d,!0,!1,m)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&W0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let d=0;d<t.length;d++)if(t[d].type!==a[d].type||!t[d].doc.isEqual(a[d].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class AO{constructor(){this.queries=iS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const d=Un(t),m=d.queries;d.queries=iS(),m.forEach((y,c)=>{for(const M of c.Sa)M.onError(a)})})(this,new tn(It.ABORTED,"Firestore shutting down"))}}function iS(){return new Kp(r=>TC(r),W0)}async function rI(r,e){const t=Un(r);let a=3;const d=e.query;let m=t.queries.get(d);m?!m.Da()&&e.va()&&(a=2):(m=new EO,a=e.va()?0:1);try{switch(a){case 0:m.ba=await t.onListen(d,!0);break;case 1:m.ba=await t.onListen(d,!1);break;case 2:await t.onFirstRemoteStoreListen(d)}}catch(y){const c=xw(y,`Initialization of query '${Fm(e.query)}' failed`);return void e.onError(c)}t.queries.set(d,m),m.Sa.push(e),e.Fa(t.onlineState),m.ba&&e.Ma(m.ba)&&ww(t)}async function iI(r,e){const t=Un(r),a=e.query;let d=3;const m=t.queries.get(a);if(m){const y=m.Sa.indexOf(e);y>=0&&(m.Sa.splice(y,1),m.Sa.length===0?d=e.va()?0:1:!m.Da()&&e.va()&&(d=2))}switch(d){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function CO(r,e){const t=Un(r);let a=!1;for(const d of e){const m=d.query,y=t.queries.get(m);if(y){for(const c of y.Sa)c.Ma(d)&&(a=!0);y.ba=d}}a&&ww(t)}function IO(r,e,t){const a=Un(r),d=a.queries.get(e);if(d)for(const m of d.Sa)m.onError(t);a.queries.delete(e)}function ww(r){r.Ca.forEach(e=>{e.next()})}var Yx,aS;(aS=Yx||(Yx={})).xa="default",aS.Cache="cache";class aI{constructor(e,t,a){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=a||{}}Ma(e){if(!this.options.includeMetadataChanges){const a=[];for(const d of e.docChanges)d.type!==3&&a.push(d);e=new cg(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const a=t!=="Offline";return(!this.options.Qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=cg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Yx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e){this.key=e}}class oI{constructor(e){this.key=e}}class MO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ur(),this.mutatedKeys=ur(),this.Za=SC(e),this.Xa=new Jm(this.Za)}get eu(){return this.Ha}tu(e,t){const a=t?t.nu:new rS,d=t?t.Xa:this.Xa;let m=t?t.mutatedKeys:this.mutatedKeys,y=d,c=!1;const M=this.query.limitType==="F"&&d.size===this.query.limit?d.last():null,R=this.query.limitType==="L"&&d.size===this.query.limit?d.first():null;if(e.inorderTraversal((B,K)=>{const $=d.get(B),W=K0(this.query,K)?K:null,re=!!$&&this.mutatedKeys.has($.key),Me=!!W&&(W.hasLocalMutations||this.mutatedKeys.has(W.key)&&W.hasCommittedMutations);let Ce=!1;$&&W?$.data.isEqual(W.data)?re!==Me&&(a.track({type:3,doc:W}),Ce=!0):this.ru($,W)||(a.track({type:2,doc:W}),Ce=!0,(M&&this.Za(W,M)>0||R&&this.Za(W,R)<0)&&(c=!0)):!$&&W?(a.track({type:0,doc:W}),Ce=!0):$&&!W&&(a.track({type:1,doc:$}),Ce=!0,(M||R)&&(c=!0)),Ce&&(W?(y=y.add(W),m=Me?m.add(B):m.delete(B)):(y=y.delete(B),m=m.delete(B)))}),this.query.limit!==null)for(;y.size>this.query.limit;){const B=this.query.limitType==="F"?y.last():y.first();y=y.delete(B.key),m=m.delete(B.key),a.track({type:1,doc:B})}return{Xa:y,nu:a,Cs:c,mutatedKeys:m}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,d){const m=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const y=e.nu.wa();y.sort((B,K)=>function(W,re){const Me=Ce=>{switch(Ce){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kn(20277,{Vt:Ce})}};return Me(W)-Me(re)}(B.type,K.type)||this.Za(B.doc,K.doc)),this.iu(a),d=d!=null&&d;const c=t&&!d?this.su():[],M=this.Ya.size===0&&this.current&&!d?1:0,R=M!==this.Ja;return this.Ja=M,y.length!==0||R?{snapshot:new cg(this.query,e.Xa,m,y,e.mutatedKeys,M===0,R,!1,!!a&&a.resumeToken.approximateByteSize()>0),ou:c}:{ou:c}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new rS,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=ur(),this.Xa.forEach(a=>{this._u(a.key)&&(this.Ya=this.Ya.add(a.key))});const t=[];return e.forEach(a=>{this.Ya.has(a)||t.push(new oI(a))}),this.Ya.forEach(a=>{e.has(a)||t.push(new sI(a))}),t}au(e){this.Ha=e.$s,this.Ya=ur();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return cg.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Tw="SyncEngine";class PO{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class RO{constructor(e){this.key=e,this.cu=!1}}class kO{constructor(e,t,a,d,m,y){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=d,this.currentUser=m,this.maxConcurrentLimboResolutions=y,this.lu={},this.hu=new Kp(c=>TC(c),W0),this.Pu=new Map,this.Tu=new Set,this.Iu=new ta(xn.comparator),this.Eu=new Map,this.du=new dw,this.Au={},this.Ru=new Map,this.Vu=ug.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function DO(r,e,t=!0){const a=fI(r);let d;const m=a.hu.get(e);return m?(a.sharedClientState.addLocalQueryTarget(m.targetId),d=m.view.uu()):d=await lI(a,e,t,!0),d}async function LO(r,e){const t=fI(r);await lI(t,e,!0,!1)}async function lI(r,e,t,a){const d=await eO(r.localStore,sh(e)),m=d.targetId,y=r.sharedClientState.addLocalQueryTarget(m,t);let c;return a&&(c=await zO(r,e,m,y==="current",d.resumeToken)),r.isPrimaryClient&&t&&YC(r.remoteStore,d),c}async function zO(r,e,t,a,d){r.fu=(K,$,W)=>async function(Me,Ce,Be,He){let ut=Ce.view.tu(Be);ut.Cs&&(ut=await YT(Me.localStore,Ce.query,!1).then(({documents:me})=>Ce.view.tu(me,ut)));const Ue=He&&He.targetChanges.get(Ce.targetId),Fe=He&&He.targetMismatches.get(Ce.targetId)!=null,Ze=Ce.view.applyChanges(ut,Me.isPrimaryClient,Ue,Fe);return oS(Me,Ce.targetId,Ze.ou),Ze.snapshot}(r,K,$,W);const m=await YT(r.localStore,e,!0),y=new MO(e,m.$s),c=y.tu(m.documents),M=B_.createSynthesizedTargetChangeForCurrentChange(t,a&&r.onlineState!=="Offline",d),R=y.applyChanges(c,r.isPrimaryClient,M);oS(r,t,R.ou);const B=new PO(e,t,y);return r.hu.set(e,B),r.Pu.has(t)?r.Pu.get(t).push(e):r.Pu.set(t,[e]),R.snapshot}async function OO(r,e,t){const a=Un(r),d=a.hu.get(e),m=a.Pu.get(d.targetId);if(m.length>1)return a.Pu.set(d.targetId,m.filter(y=>!W0(y,e))),void a.hu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(d.targetId),a.sharedClientState.isActiveQueryTarget(d.targetId)||await Kx(a.localStore,d.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(d.targetId),t&&gw(a.remoteStore,d.targetId),Qx(a,d.targetId)}).catch(vg)):(Qx(a,d.targetId),await Kx(a.localStore,d.targetId,!0))}async function NO(r,e){const t=Un(r),a=t.hu.get(e),d=t.Pu.get(a.targetId);t.isPrimaryClient&&d.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),gw(t.remoteStore,a.targetId))}async function BO(r,e,t){const a=GO(r);try{const d=await function(y,c){const M=Un(y),R=Wa.now(),B=c.reduce((W,re)=>W.add(re.key),ur());let K,$;return M.persistence.runTransaction("Locally write mutations","readwrite",W=>{let re=id(),Me=ur();return M.Bs.getEntries(W,B).next(Ce=>{re=Ce,re.forEach((Be,He)=>{He.isValidDocument()||(Me=Me.add(Be))})}).next(()=>M.localDocuments.getOverlayedDocuments(W,re)).next(Ce=>{K=Ce;const Be=[];for(const He of c){const ut=ez(He,K.get(He.key).overlayedDocument);ut!=null&&Be.push(new Af(He.key,ut,mC(ut.value.mapValue),_u.exists(!0)))}return M.mutationQueue.addMutationBatch(W,R,Be,c)}).next(Ce=>{$=Ce;const Be=Ce.applyToLocalDocumentSet(K,Me);return M.documentOverlayCache.saveOverlays(W,Ce.batchId,Be)})}).then(()=>({batchId:$.batchId,changes:AC(K)}))}(a.localStore,e);a.sharedClientState.addPendingMutation(d.batchId),function(y,c,M){let R=y.Au[y.currentUser.toKey()];R||(R=new ta(tr)),R=R.insert(c,M),y.Au[y.currentUser.toKey()]=R}(a,d.batchId,t),await V_(a,d.changes),await tb(a.remoteStore)}catch(d){const m=xw(d,"Failed to persist write");t.reject(m)}}async function uI(r,e){const t=Un(r);try{const a=await Yz(t.localStore,e);e.targetChanges.forEach((d,m)=>{const y=t.Eu.get(m);y&&(Wr(d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size<=1,22616),d.addedDocuments.size>0?y.cu=!0:d.modifiedDocuments.size>0?Wr(y.cu,14607):d.removedDocuments.size>0&&(Wr(y.cu,42227),y.cu=!1))}),await V_(t,a,e)}catch(a){await vg(a)}}function sS(r,e,t){const a=Un(r);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const d=[];a.hu.forEach((m,y)=>{const c=y.view.Fa(e);c.snapshot&&d.push(c.snapshot)}),function(y,c){const M=Un(y);M.onlineState=c;let R=!1;M.queries.forEach((B,K)=>{for(const $ of K.Sa)$.Fa(c)&&(R=!0)}),R&&ww(M)}(a.eventManager,e),d.length&&a.lu.Y_(d),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function FO(r,e,t){const a=Un(r);a.sharedClientState.updateQueryState(e,"rejected",t);const d=a.Eu.get(e),m=d&&d.key;if(m){let y=new ta(xn.comparator);y=y.insert(m,no.newNoDocument(m,Vn.min()));const c=ur().add(m),M=new Q0(Vn.min(),new Map,new ta(tr),y,c);await uI(a,M),a.Iu=a.Iu.remove(m),a.Eu.delete(e),Sw(a)}else await Kx(a.localStore,e,!1).then(()=>Qx(a,e,t)).catch(vg)}async function VO(r,e){const t=Un(r),a=e.batch.batchId;try{const d=await Xz(t.localStore,e);hI(t,a,null),cI(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await V_(t,d)}catch(d){await vg(d)}}async function jO(r,e,t){const a=Un(r);try{const d=await function(y,c){const M=Un(y);return M.persistence.runTransaction("Reject batch","readwrite-primary",R=>{let B;return M.mutationQueue.lookupMutationBatch(R,c).next(K=>(Wr(K!==null,37113),B=K.keys(),M.mutationQueue.removeMutationBatch(R,K))).next(()=>M.mutationQueue.performConsistencyCheck(R)).next(()=>M.documentOverlayCache.removeOverlaysForBatchId(R,B,c)).next(()=>M.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(R,B)).next(()=>M.localDocuments.getDocuments(R,B))})}(a.localStore,e);hI(a,e,t),cI(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await V_(a,d)}catch(d){await vg(d)}}function cI(r,e){(r.Ru.get(e)||[]).forEach(t=>{t.resolve()}),r.Ru.delete(e)}function hI(r,e,t){const a=Un(r);let d=a.Au[a.currentUser.toKey()];if(d){const m=d.get(e);m&&(t?m.reject(t):m.resolve(),d=d.remove(e)),a.Au[a.currentUser.toKey()]=d}}function Qx(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const a of r.Pu.get(e))r.hu.delete(a),t&&r.lu.gu(a,t);r.Pu.delete(e),r.isPrimaryClient&&r.du.Hr(e).forEach(a=>{r.du.containsKey(a)||dI(r,a)})}function dI(r,e){r.Tu.delete(e.path.canonicalString());const t=r.Iu.get(e);t!==null&&(gw(r.remoteStore,t),r.Iu=r.Iu.remove(e),r.Eu.delete(t),Sw(r))}function oS(r,e,t){for(const a of t)a instanceof sI?(r.du.addReference(a.key,e),UO(r,a)):a instanceof oI?(en(Tw,"Document no longer in limbo: "+a.key),r.du.removeReference(a.key,e),r.du.containsKey(a.key)||dI(r,a.key)):kn(19791,{pu:a})}function UO(r,e){const t=e.key,a=t.path.canonicalString();r.Iu.get(t)||r.Tu.has(a)||(en(Tw,"New document in limbo: "+t),r.Tu.add(a),Sw(r))}function Sw(r){for(;r.Tu.size>0&&r.Iu.size<r.maxConcurrentLimboResolutions;){const e=r.Tu.values().next().value;r.Tu.delete(e);const t=new xn(Mi.fromString(e)),a=r.Vu.next();r.Eu.set(a,new RO(t)),r.Iu=r.Iu.insert(t,a),YC(r.remoteStore,new of(sh(sw(t.path)),a,"TargetPurposeLimboResolution",G0.le))}}async function V_(r,e,t){const a=Un(r),d=[],m=[],y=[];a.hu.isEmpty()||(a.hu.forEach((c,M)=>{y.push(a.fu(M,e,t).then(R=>{var B;if((R||t)&&a.isPrimaryClient){const K=R?!R.fromCache:(B=t==null?void 0:t.targetChanges.get(M.targetId))===null||B===void 0?void 0:B.current;a.sharedClientState.updateQueryState(M.targetId,K?"current":"not-current")}if(R){d.push(R);const K=pw.Rs(M.targetId,R);m.push(K)}}))}),await Promise.all(y),a.lu.Y_(d),await async function(M,R){const B=Un(M);try{await B.persistence.runTransaction("notifyLocalViewChanges","readwrite",K=>Pt.forEach(R,$=>Pt.forEach($.ds,W=>B.persistence.referenceDelegate.addReference(K,$.targetId,W)).next(()=>Pt.forEach($.As,W=>B.persistence.referenceDelegate.removeReference(K,$.targetId,W)))))}catch(K){if(!bg(K))throw K;en(mw,"Failed to update sequence numbers: "+K)}for(const K of R){const $=K.targetId;if(!K.fromCache){const W=B.xs.get($),re=W.snapshotVersion,Me=W.withLastLimboFreeSnapshotVersion(re);B.xs=B.xs.insert($,Me)}}}(a.localStore,m))}async function qO(r,e){const t=Un(r);if(!t.currentUser.isEqual(e)){en(Tw,"User change. New user:",e.toKey());const a=await ZC(t.localStore,e);t.currentUser=e,function(m,y){m.Ru.forEach(c=>{c.forEach(M=>{M.reject(new tn(It.CANCELLED,y))})}),m.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await V_(t,a.ks)}}function $O(r,e){const t=Un(r),a=t.Eu.get(e);if(a&&a.cu)return ur().add(a.key);{let d=ur();const m=t.Pu.get(e);if(!m)return d;for(const y of m){const c=t.hu.get(y);d=d.unionWith(c.view.eu)}return d}}function fI(r){const e=Un(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=uI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$O.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FO.bind(null,e),e.lu.Y_=CO.bind(null,e.eventManager),e.lu.gu=IO.bind(null,e.eventManager),e}function GO(r){const e=Un(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=jO.bind(null,e),e}class E0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=J0(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return Kz(this.persistence,new Hz,e.initialUser,this.serializer)}Su(e){return new HC(fw.fi,this.serializer)}bu(e){return new nO}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}E0.provider={build:()=>new E0};class HO extends E0{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Wr(this.persistence.referenceDelegate instanceof T0,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new Rz(a,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?tl.withCacheSize(this.cacheSizeBytes):tl.DEFAULT;return new HC(a=>T0.fi(a,t),this.serializer)}}class Jx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>sS(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=qO.bind(null,this.syncEngine),await SO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new AO}()}createDatastore(e){const t=J0(e.databaseInfo.databaseId),a=function(m){return new oO(m)}(e.databaseInfo);return function(m,y,c,M){return new hO(m,y,c,M)}(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return function(a,d,m,y,c){return new fO(a,d,m,y,c)}(this.localStore,this.datastore,e.asyncQueue,t=>sS(this.syncEngine,t,0),function(){return eS.C()?new eS:new rO}())}createSyncEngine(e,t){return function(d,m,y,c,M,R,B){const K=new kO(d,m,y,c,M,R);return B&&(K.mu=!0),K}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(d){const m=Un(d);en(jp,"RemoteStore shutting down."),m.da.add(5),await F_(m),m.Ra.shutdown(),m.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Jx.provider={build:()=>new Jx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):rd("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf="FirestoreClient";class ZO{constructor(e,t,a,d,m){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=d,this.user=to.UNAUTHENTICATED,this.clientId=aC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=m,this.authCredentials.start(a,async y=>{en(vf,"Received user=",y.uid),await this.authCredentialListener(y),this.user=y}),this.appCheckCredentials.start(a,y=>(en(vf,"Received new app check token=",y),this.appCheckCredentialListener(y,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=xw(t,"Failed to shutdown persistence");e.reject(a)}}),e.promise}}async function ax(r,e){r.asyncQueue.verifyOperationInProgress(),en(vf,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let a=t.initialUser;r.setCredentialChangeListener(async d=>{a.isEqual(d)||(await ZC(e.localStore,d),a=d)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function lS(r,e){r.asyncQueue.verifyOperationInProgress();const t=await WO(r);en(vf,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(a=>nS(e.remoteStore,a)),r.setAppCheckTokenChangeListener((a,d)=>nS(e.remoteStore,d)),r._onlineComponents=e}async function WO(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){en(vf,"Using user provided OfflineComponentProvider");try{await ax(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(d){return d.name==="FirebaseError"?d.code===It.FAILED_PRECONDITION||d.code===It.UNIMPLEMENTED:!(typeof DOMException<"u"&&d instanceof DOMException)||d.code===22||d.code===20||d.code===11}(t))throw t;ag("Error using user provided cache. Falling back to memory cache: "+t),await ax(r,new E0)}}else en(vf,"Using default OfflineComponentProvider"),await ax(r,new HO(void 0));return r._offlineComponents}async function mI(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(en(vf,"Using user provided OnlineComponentProvider"),await lS(r,r._uninitializedComponentsProvider._online)):(en(vf,"Using default OnlineComponentProvider"),await lS(r,new Jx))),r._onlineComponents}function KO(r){return mI(r).then(e=>e.syncEngine)}async function gI(r){const e=await mI(r),t=e.eventManager;return t.onListen=DO.bind(null,e.syncEngine),t.onUnlisten=OO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=LO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=NO.bind(null,e.syncEngine),t}function XO(r,e,t={}){const a=new Yh;return r.asyncQueue.enqueueAndForget(async()=>function(m,y,c,M,R){const B=new pI({next:$=>{B.xu(),y.enqueueAndForget(()=>iI(m,K));const W=$.docs.has(c);!W&&$.fromCache?R.reject(new tn(It.UNAVAILABLE,"Failed to get document because the client is offline.")):W&&$.fromCache&&M&&M.source==="server"?R.reject(new tn(It.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):R.resolve($)},error:$=>R.reject($)}),K=new aI(sw(c.path),B,{includeMetadataChanges:!0,Qa:!0});return rI(m,K)}(await gI(r),r.asyncQueue,e,t,a)),a.promise}function YO(r,e,t={}){const a=new Yh;return r.asyncQueue.enqueueAndForget(async()=>function(m,y,c,M,R){const B=new pI({next:$=>{B.xu(),y.enqueueAndForget(()=>iI(m,K)),$.fromCache&&M.source==="server"?R.reject(new tn(It.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):R.resolve($)},error:$=>R.reject($)}),K=new aI(c,B,{includeMetadataChanges:!0,Qa:!0});return rI(m,K)}(await gI(r),r.asyncQueue,e,t,a)),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yI(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(r,e,t){if(!t)throw new tn(It.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function QO(r,e,t,a){if(e===!0&&a===!0)throw new tn(It.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function cS(r){if(!xn.isDocumentKey(r))throw new tn(It.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function hS(r){if(xn.isDocumentKey(r))throw new tn(It.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function nb(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(a){return a.constructor?a.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":kn(12329,{type:typeof r})}function yc(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new tn(It.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=nb(r);throw new tn(It.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI="firestore.googleapis.com",dS=!0;class fS{constructor(e){var t,a;if(e.host===void 0){if(e.ssl!==void 0)throw new tn(It.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=vI,this.ssl=dS}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:dS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=GC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Mz)throw new tn(It.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yI((a=e.experimentalLongPollingOptions)!==null&&a!==void 0?a:{}),function(m){if(m.timeoutSeconds!==void 0){if(isNaN(m.timeoutSeconds))throw new tn(It.INVALID_ARGUMENT,`invalid long polling timeout: ${m.timeoutSeconds} (must not be NaN)`);if(m.timeoutSeconds<5)throw new tn(It.INVALID_ARGUMENT,`invalid long polling timeout: ${m.timeoutSeconds} (minimum allowed value is 5)`);if(m.timeoutSeconds>30)throw new tn(It.INVALID_ARGUMENT,`invalid long polling timeout: ${m.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(a,d){return a.timeoutSeconds===d.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rb{constructor(e,t,a,d){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new tn(It.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new tn(It.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(a){if(!a)return new s3;switch(a.type){case"firstParty":return new c3(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new tn(It.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const a=uS.get(t);a&&(en("ComponentProvider","Removing Datastore"),uS.delete(t),a.terminate())}(this),Promise.resolve()}}function JO(r,e,t,a={}){var d;r=yc(r,rb);const m=P_(e),y=r._getSettings(),c=Object.assign(Object.assign({},y),{emulatorOptions:r._getEmulatorOptions()}),M=`${e}:${t}`;m&&(oA(`https://${M}`),lA("Firestore",!0)),y.host!==vI&&y.host!==M&&ag("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const R=Object.assign(Object.assign({},y),{host:M,ssl:m,emulatorOptions:a});if(!Op(R,c)&&(r._setSettings(R),a.mockUserToken)){let B,K;if(typeof a.mockUserToken=="string")B=a.mockUserToken,K=to.MOCK_USER;else{B=_k(a.mockUserToken,(d=r._app)===null||d===void 0?void 0:d.options.projectId);const $=a.mockUserToken.sub||a.mockUserToken.user_id;if(!$)throw new tn(It.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");K=new to($)}r._authCredentials=new o3(new rC(B,K))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Yp(this.firestore,e,this._query)}}class Ro{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ff(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ro(this.firestore,e,this._key)}}class ff extends Yp{constructor(e,t,a){super(e,t,sw(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ro(this.firestore,null,new xn(e))}withConverter(e){return new ff(this.firestore,e,this._path)}}function ad(r,e,...t){if(r=Rs(r),_I("collection","path",e),r instanceof rb){const a=Mi.fromString(e,...t);return hS(a),new ff(r,null,a)}{if(!(r instanceof Ro||r instanceof ff))throw new tn(It.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=r._path.child(Mi.fromString(e,...t));return hS(a),new ff(r.firestore,null,a)}}function vu(r,e,...t){if(r=Rs(r),arguments.length===1&&(e=aC.newId()),_I("doc","path",e),r instanceof rb){const a=Mi.fromString(e,...t);return cS(a),new Ro(r,null,new xn(a))}{if(!(r instanceof Ro||r instanceof ff))throw new tn(It.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=r._path.child(Mi.fromString(e,...t));return cS(a),new Ro(r.firestore,r instanceof ff?r.converter:null,new xn(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS="AsyncQueue";class mS{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new KC(this,"async_queue_retry"),this.rc=()=>{const a=ix();a&&en(pS,"Visibility state changed to "+a.visibilityState),this.x_.b_()},this.sc=e;const t=ix();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=ix();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Yh;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!bg(e))throw e;en(pS,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(a=>{throw this.Xu=a,this.ec=!1,rd("INTERNAL UNHANDLED ERROR: ",gS(a)),a}).then(a=>(this.ec=!1,a))));return this.sc=t,t}enqueueAfterDelay(e,t,a){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const d=bw.createAndSchedule(this,e,t,a,m=>this.uc(m));return this.Zu.push(d),d}oc(){this.Xu&&kn(47125,{cc:gS(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,a)=>t.targetTimeMs-a.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function gS(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}class Qp extends rb{constructor(e,t,a,d){super(e,t,a,d),this.type="firestore",this._queue=new mS,this._persistenceKey=(d==null?void 0:d.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mS(e),this._firestoreClient=void 0,await e}}}function e4(r,e){const t=typeof r=="object"?r:dA(),a=typeof r=="string"?r:y0,d=$1(t,"firestore").getImmediate({identifier:a});if(!d._initialized){const m=gk("firestore");m&&JO(d,...m)}return d}function Ew(r){if(r._terminated)throw new tn(It.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||t4(r),r._firestoreClient}function t4(r){var e,t,a;const d=r._freezeSettings(),m=function(c,M,R,B){return new E3(c,M,R,B.host,B.ssl,B.experimentalForceLongPolling,B.experimentalAutoDetectLongPolling,yI(B.experimentalLongPollingOptions),B.useFetchStreams,B.isUsingEmulator)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,d);r._componentsProvider||!((t=d.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((a=d.localCache)===null||a===void 0)&&a._onlineComponentProvider)&&(r._componentsProvider={_offline:d.localCache._offlineComponentProvider,_online:d.localCache._onlineComponentProvider}),r._firestoreClient=new ZO(r._authCredentials,r._appCheckCredentials,r._queue,m,r._componentsProvider&&function(c){const M=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(M),_online:M}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e){this._byteString=e}static fromBase64String(e){try{return new hg(ks.fromBase64String(e))}catch(t){throw new tn(It.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new hg(ks.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new tn(It.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ps(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new tn(It.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new tn(It.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return tr(this._lat,e._lat)||tr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(a,d){if(a.length!==d.length)return!1;for(let m=0;m<a.length;++m)if(a[m]!==d[m])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=/^__.*__$/;class r4{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Af(e,this.data,this.fieldMask,t,this.fieldTransforms):new N_(e,this.data,t,this.fieldTransforms)}}class bI{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new Af(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function xI(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw kn(40011,{Ic:r})}}class Mw{constructor(e,t,a,d,m,y){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=d,m===void 0&&this.Ec(),this.fieldTransforms=m||[],this.fieldMask=y||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Mw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),d=this.dc({path:a,Rc:!1});return d.Vc(e),d}mc(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),d=this.dc({path:a,Rc:!1});return d.Ec(),d}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return A0(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(xI(this.Ic)&&n4.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class i4{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||J0(e)}bc(e,t,a,d=!1){return new Mw({Ic:e,methodName:t,wc:a,path:Ps.emptyPath(),Rc:!1,yc:d},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ab(r){const e=r._freezeSettings(),t=J0(r._databaseId);return new i4(r._databaseId,!!e.ignoreUndefinedProperties,t)}function wI(r,e,t,a,d,m={}){const y=r.bc(m.merge||m.mergeFields?2:0,e,t,d);Pw("Data must be an object, but it was:",y,a);const c=TI(a,y);let M,R;if(m.merge)M=new Pl(y.fieldMask),R=y.fieldTransforms;else if(m.mergeFields){const B=[];for(const K of m.mergeFields){const $=e1(e,K,t);if(!y.contains($))throw new tn(It.INVALID_ARGUMENT,`Field '${$}' is specified in your field mask but missing from your input data.`);EI(B,$)||B.push($)}M=new Pl(B),R=y.fieldTransforms.filter(K=>M.covers(K.field))}else M=null,R=y.fieldTransforms;return new r4(new nl(c),M,R)}class sb extends Aw{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sb}}function a4(r,e,t,a){const d=r.bc(1,e,t);Pw("Data must be an object, but it was:",d,a);const m=[],y=nl.empty();Ef(a,(M,R)=>{const B=Rw(e,M,t);R=Rs(R);const K=d.mc(B);if(R instanceof sb)m.push(B);else{const $=j_(R,K);$!=null&&(m.push(B),y.set(B,$))}});const c=new Pl(m);return new bI(y,c,d.fieldTransforms)}function s4(r,e,t,a,d,m){const y=r.bc(1,e,t),c=[e1(e,a,t)],M=[d];if(m.length%2!=0)throw new tn(It.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let $=0;$<m.length;$+=2)c.push(e1(e,m[$])),M.push(m[$+1]);const R=[],B=nl.empty();for(let $=c.length-1;$>=0;--$)if(!EI(R,c[$])){const W=c[$];let re=M[$];re=Rs(re);const Me=y.mc(W);if(re instanceof sb)R.push(W);else{const Ce=j_(re,Me);Ce!=null&&(R.push(W),B.set(W,Ce))}}const K=new Pl(R);return new bI(B,K,y.fieldTransforms)}function o4(r,e,t,a=!1){return j_(t,r.bc(a?4:3,e))}function j_(r,e){if(SI(r=Rs(r)))return Pw("Unsupported field value:",e,r),TI(r,e);if(r instanceof Aw)return function(a,d){if(!xI(d.Ic))throw d.gc(`${a._methodName}() can only be used with update() and set()`);if(!d.path)throw d.gc(`${a._methodName}() is not currently supported inside arrays`);const m=a._toFieldTransform(d);m&&d.fieldTransforms.push(m)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(a,d){const m=[];let y=0;for(const c of a){let M=j_(c,d.fc(y));M==null&&(M={nullValue:"NULL_VALUE"}),m.push(M),y++}return{arrayValue:{values:m}}}(r,e)}return function(a,d){if((a=Rs(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return W3(d.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const m=Wa.fromDate(a);return{timestampValue:w0(d.serializer,m)}}if(a instanceof Wa){const m=new Wa(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:w0(d.serializer,m)}}if(a instanceof Cw)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof hg)return{bytesValue:BC(d.serializer,a._byteString)};if(a instanceof Ro){const m=d.databaseId,y=a.firestore._databaseId;if(!y.isEqual(m))throw d.gc(`Document reference is for database ${y.projectId}/${y.database} but should be for database ${m.projectId}/${m.database}`);return{referenceValue:hw(a.firestore._databaseId||d.databaseId,a._key.path)}}if(a instanceof Iw)return function(y,c){return{mapValue:{fields:{[fC]:{stringValue:pC},[_0]:{arrayValue:{values:y.toArray().map(R=>{if(typeof R!="number")throw c.gc("VectorValues must only contain numeric values.");return ow(c.serializer,R)})}}}}}}(a,d);throw d.gc(`Unsupported field value: ${nb(a)}`)}(r,e)}function TI(r,e){const t={};return oC(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ef(r,(a,d)=>{const m=j_(d,e.Ac(a));m!=null&&(t[a]=m)}),{mapValue:{fields:t}}}function SI(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Wa||r instanceof Cw||r instanceof hg||r instanceof Ro||r instanceof Aw||r instanceof Iw)}function Pw(r,e,t){if(!SI(t)||!function(d){return typeof d=="object"&&d!==null&&(Object.getPrototypeOf(d)===Object.prototype||Object.getPrototypeOf(d)===null)}(t)){const a=nb(t);throw a==="an object"?e.gc(r+" a custom object"):e.gc(r+" "+a)}}function e1(r,e,t){if((e=Rs(e))instanceof ib)return e._internalPath;if(typeof e=="string")return Rw(r,e);throw A0("Field path arguments must be of type string or ",r,!1,void 0,t)}const l4=new RegExp("[~\\*/\\[\\]]");function Rw(r,e,t){if(e.search(l4)>=0)throw A0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new ib(...e.split("."))._internalPath}catch{throw A0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function A0(r,e,t,a,d){const m=a&&!a.isEmpty(),y=d!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let M="";return(m||y)&&(M+=" (found",m&&(M+=` in field ${a}`),y&&(M+=` in document ${d}`),M+=")"),new tn(It.INVALID_ARGUMENT,c+r+M)}function EI(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(e,t,a,d,m){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=d,this._converter=m}get id(){return this._key.path.lastSegment()}get ref(){return new Ro(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new u4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(kw("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class u4 extends AI{data(){return super.data()}}function kw(r,e){return typeof e=="string"?Rw(r,e):e instanceof ib?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new tn(It.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Dw{}class CI extends Dw{}function Lw(r,e,...t){let a=[];e instanceof Dw&&a.push(e),a=a.concat(t),function(m){const y=m.filter(M=>M instanceof Ow).length,c=m.filter(M=>M instanceof zw).length;if(y>1||y>0&&c>0)throw new tn(It.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const d of a)r=d._apply(r);return r}class zw extends CI{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new zw(e,t,a)}_apply(e){const t=this._parse(e);return II(e._query,t),new Yp(e.firestore,e.converter,qx(e._query,t))}_parse(e){const t=ab(e.firestore);return function(m,y,c,M,R,B,K){let $;if(R.isKeyField()){if(B==="array-contains"||B==="array-contains-any")throw new tn(It.INVALID_ARGUMENT,`Invalid Query. You can't perform '${B}' queries on documentId().`);if(B==="in"||B==="not-in"){_S(K,B);const re=[];for(const Me of K)re.push(yS(M,m,Me));$={arrayValue:{values:re}}}else $=yS(M,m,K)}else B!=="in"&&B!=="not-in"&&B!=="array-contains-any"||_S(K,B),$=o4(c,y,K,B==="in"||B==="not-in");return Da.create(R,B,$)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Ow extends Dw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ow(e,t)}_parse(e){const t=this._queryConstraints.map(a=>a._parse(e)).filter(a=>a.getFilters().length>0);return t.length===1?t[0]:gc.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(d,m){let y=d;const c=m.getFlattenedFilters();for(const M of c)II(y,M),y=qx(y,M)}(e._query,t),new Yp(e.firestore,e.converter,qx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Nw extends CI{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Nw(e,t)}_apply(e){const t=function(d,m,y){if(d.startAt!==null)throw new tn(It.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(d.endAt!==null)throw new tn(It.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new f_(m,y)}(e._query,this._field,this._direction);return new Yp(e.firestore,e.converter,function(d,m){const y=d.explicitOrderBy.concat([m]);return new xg(d.path,d.collectionGroup,y,d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(e._query,t))}}function Bw(r,e="asc"){const t=e,a=kw("orderBy",r);return Nw._create(a,t)}function yS(r,e,t){if(typeof(t=Rs(t))=="string"){if(t==="")throw new tn(It.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wC(e)&&t.indexOf("/")!==-1)throw new tn(It.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(Mi.fromString(t));if(!xn.isDocumentKey(a))throw new tn(It.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return kT(r,new xn(a))}if(t instanceof Ro)return kT(r,t._key);throw new tn(It.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${nb(t)}.`)}function _S(r,e){if(!Array.isArray(r)||r.length===0)throw new tn(It.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function II(r,e){const t=function(d,m){for(const y of d)for(const c of y.getFlattenedFilters())if(m.indexOf(c.op)>=0)return c.op;return null}(r.filters,function(d){switch(d){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new tn(It.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new tn(It.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class h4{convertValue(e,t="none"){switch(yf(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ga(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gf(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw kn(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return Ef(e,(d,m)=>{a[d]=this.convertValue(m,t)}),a}convertVectorValue(e){var t,a,d;const m=(d=(a=(t=e.fields)===null||t===void 0?void 0:t[_0].arrayValue)===null||a===void 0?void 0:a.values)===null||d===void 0?void 0:d.map(y=>ga(y.doubleValue));return new Iw(m)}convertGeoPoint(e){return new Cw(ga(e.latitude),ga(e.longitude))}convertArray(e,t){return(e.values||[]).map(a=>this.convertValue(a,t))}convertServerTimestamp(e,t){switch(t){case"previous":const a=Z0(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(c_(e));default:return null}}convertTimestamp(e){const t=mf(e);return new Wa(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=Mi.fromString(e);Wr($C(a),9688,{name:e});const d=new h_(a.get(1),a.get(3)),m=new xn(a.popFirst(5));return d.isEqual(t)||rd(`Document ${m} contains a document reference within a different database (${d.projectId}/${d.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MI(r,e,t){let a;return a=r?r.toFirestore(e):e,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class PI extends AI{constructor(e,t,a,d,m,y){super(e,t,a,d,y),this._firestore=e,this._firestoreImpl=e,this.metadata=m}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new e0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(kw("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}}class e0 extends PI{data(e={}){return super.data(e)}}class d4{constructor(e,t,a,d){this._firestore=e,this._userDataWriter=t,this._snapshot=d,this.metadata=new $y(d.hasPendingWrites,d.fromCache),this.query=a}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(a=>{e.call(t,new e0(this._firestore,this._userDataWriter,a.key,a,new $y(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new tn(It.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(d,m){if(d._snapshot.oldDocs.isEmpty()){let y=0;return d._snapshot.docChanges.map(c=>{const M=new e0(d._firestore,d._userDataWriter,c.doc.key,c.doc,new $y(d._snapshot.mutatedKeys.has(c.doc.key),d._snapshot.fromCache),d.query.converter);return c.doc,{type:"added",doc:M,oldIndex:-1,newIndex:y++}})}{let y=d._snapshot.oldDocs;return d._snapshot.docChanges.filter(c=>m||c.type!==3).map(c=>{const M=new e0(d._firestore,d._userDataWriter,c.doc.key,c.doc,new $y(d._snapshot.mutatedKeys.has(c.doc.key),d._snapshot.fromCache),d.query.converter);let R=-1,B=-1;return c.type!==0&&(R=y.indexOf(c.doc.key),y=y.delete(c.doc.key)),c.type!==1&&(y=y.add(c.doc),B=y.indexOf(c.doc.key)),{type:f4(c.type),doc:M,oldIndex:R,newIndex:B}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function f4(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kn(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ob(r){r=yc(r,Ro);const e=yc(r.firestore,Qp);return XO(Ew(e),r._key).then(t=>m4(e,r,t))}class RI extends h4{constructor(e){super(),this.firestore=e}convertBytes(e){return new hg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ro(this.firestore,null,t)}}function Tg(r){r=yc(r,Yp);const e=yc(r.firestore,Qp),t=Ew(e),a=new RI(e);return c4(r._query),YO(t,r._query).then(d=>new d4(e,a,r,d))}function p4(r,e,t){r=yc(r,Ro);const a=yc(r.firestore,Qp),d=MI(r.converter,e);return lb(a,[wI(ab(a),"setDoc",r._key,d,r.converter!==null,t).toMutation(r._key,_u.none())])}function Fw(r,e,t,...a){r=yc(r,Ro);const d=yc(r.firestore,Qp),m=ab(d);let y;return y=typeof(e=Rs(e))=="string"||e instanceof ib?s4(m,"updateDoc",r._key,e,t,a):a4(m,"updateDoc",r._key,e),lb(d,[y.toMutation(r._key,_u.exists(!0))])}function Vw(r){return lb(yc(r.firestore,Qp),[new lw(r._key,_u.none())])}function jw(r,e){const t=yc(r.firestore,Qp),a=vu(r),d=MI(r.converter,e);return lb(t,[wI(ab(r.firestore),"addDoc",a._key,d,r.converter!==null,{}).toMutation(a._key,_u.exists(!1))]).then(()=>a)}function lb(r,e){return function(a,d){const m=new Yh;return a.asyncQueue.enqueueAndForget(async()=>BO(await KO(a),d,m)),m.promise}(Ew(r),e)}function m4(r,e,t){const a=t.docs.get(e._key),d=new RI(r);return new PI(r,d,e._key,a,new $y(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(d){_g=d})(gg),ig(new Np("firestore",(a,{instanceIdentifier:d,options:m})=>{const y=a.getProvider("app").getImmediate(),c=new Qp(new l3(a.getProvider("auth-internal")),new h3(y,a.getProvider("app-check-internal")),function(R,B){if(!Object.prototype.hasOwnProperty.apply(R.options,["projectId"]))throw new tn(It.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new h_(R.options.projectId,B)}(y,d),y);return m=Object.assign({useFetchStreams:t},m),c._setSettings(m),c},"PUBLIC").setMultipleInstances(!0)),hf(bT,xT,e),hf(bT,xT,"esm2017")})();const g4={apiKey:"AIzaSyBvXlBW9BHh89QvY-LdJp9cy5CSPa6-3GU",authDomain:"atco-training-d1552.firebaseapp.com",projectId:"atco-training-d1552",storageBucket:"atco-training-d1552.firebasestorage.app",messagingSenderId:"233580419344",appId:"1:233580419344:web:f8c7d77607c7cf26642d95"},kI=hA(g4),Hh=i3(kI),La=e4(kI);var t0={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.0/LICENSE.txt
 */var y4=t0.exports,vS;function _4(){return vS||(vS=1,function(r,e){(function(t,a){r.exports=a()})(y4,function(){var t={},a={};function d(y,c,M){if(a[y]=M,y==="index"){var R="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",B={};return a.shared(B),a.index(t,B),typeof window<"u"&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([R],{type:"text/javascript"}))),t}}d("shared",["exports"],function(y){function c(u,i,o,f){return new(o||(o=Promise))(function(v,T){function S(z){try{k(f.next(z))}catch(N){T(N)}}function C(z){try{k(f.throw(z))}catch(N){T(N)}}function k(z){var N;z.done?v(z.value):(N=z.value,N instanceof o?N:new o(function(j){j(N)})).then(S,C)}k((f=f.apply(u,i||[])).next())})}function M(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var R,B;function K(){if(B)return R;function u(i,o){this.x=i,this.y=o}return B=1,R=u,u.prototype={clone:function(){return new u(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,o){return this.clone()._rotateAround(i,o)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var o=i.x-this.x,f=i.y-this.y;return o*o+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,o){return Math.atan2(this.x*o-this.y*i,this.x*i+this.y*o)},_matMult:function(i){var o=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=o,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var o=Math.cos(i),f=Math.sin(i),v=f*this.x+o*this.y;return this.x=o*this.x-f*this.y,this.y=v,this},_rotateAround:function(i,o){var f=Math.cos(i),v=Math.sin(i),T=o.y+v*(this.x-o.x)+f*(this.y-o.y);return this.x=o.x+f*(this.x-o.x)-v*(this.y-o.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(i){return i instanceof u?i:Array.isArray(i)?new u(i[0],i[1]):i},R}typeof SuppressedError=="function"&&SuppressedError;var $,W,re=M(K()),Me=function(){if(W)return $;function u(i,o,f,v){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(v-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=f,this.p2y=v}return W=1,$=u,u.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,v=0;v<8;v++){var T=this.sampleCurveX(f)-i;if(Math.abs(T)<o)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=T/S}var C=0,k=1;for(f=i,v=0;v<20&&(T=this.sampleCurveX(f),!(Math.abs(T-i)<o));v++)i>T?C=f:k=f,f=.5*(k-C)+C;return f},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},$}(),Ce=M(Me);let Be,He;function ut(){return Be==null&&(Be=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Be}function Ue(){if(He==null&&(He=!1,ut())){const i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let f=0;f<5*5;f++){const v=4*f;i.fillStyle=`rgb(${v},${v+1},${v+2})`,i.fillRect(f%5,Math.floor(f/5),1,1)}const o=i.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&o[f]!==f){He=!0;break}}}return He||!1}var Fe=1e-6,Ze=typeof Float32Array<"u"?Float32Array:Array;function me(){var u=new Ze(9);return Ze!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function se(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function ye(){var u=new Ze(3);return Ze!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function we(u){return Math.hypot(u[0],u[1],u[2])}function Ee(u,i,o){var f=new Ze(3);return f[0]=u,f[1]=i,f[2]=o,f}function ke(u,i,o){return u[0]=i[0]+o[0],u[1]=i[1]+o[1],u[2]=i[2]+o[2],u}function ve(u,i,o){return u[0]=i[0]*o,u[1]=i[1]*o,u[2]=i[2]*o,u}function Bt(u,i,o){var f=i[0],v=i[1],T=i[2],S=o[0],C=o[1],k=o[2];return u[0]=v*k-T*C,u[1]=T*S-f*k,u[2]=f*C-v*S,u}Math.hypot||(Math.hypot=function(){for(var u=0,i=arguments.length;i--;)u+=arguments[i]*arguments[i];return Math.sqrt(u)});var Kt,et=we;function Mt(u,i,o){var f=i[0],v=i[1],T=i[2],S=i[3];return u[0]=o[0]*f+o[4]*v+o[8]*T+o[12]*S,u[1]=o[1]*f+o[5]*v+o[9]*T+o[13]*S,u[2]=o[2]*f+o[6]*v+o[10]*T+o[14]*S,u[3]=o[3]*f+o[7]*v+o[11]*T+o[15]*S,u}function Tt(){var u=new Ze(4);return Ze!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function Gt(u,i,o,f){var v=.5*Math.PI/180;i*=v,o*=v,f*=v;var T=Math.sin(i),S=Math.cos(i),C=Math.sin(o),k=Math.cos(o),z=Math.sin(f),N=Math.cos(f);return u[0]=T*k*N-S*C*z,u[1]=S*C*N+T*k*z,u[2]=S*k*z-T*C*N,u[3]=S*k*N+T*C*z,u}function Re(){var u=new Ze(2);return Ze!=Float32Array&&(u[0]=0,u[1]=0),u}function _t(u,i){var o=new Ze(2);return o[0]=u,o[1]=i,o}ye(),Kt=new Ze(4),Ze!=Float32Array&&(Kt[0]=0,Kt[1]=0,Kt[2]=0,Kt[3]=0),ye(),Ee(1,0,0),Ee(0,1,0),Tt(),Tt(),me(),Re();const At=8192;function St(u,i,o){return i*(At/(u.tileSize*Math.pow(2,o-u.tileID.overscaledZ)))}function Qt(u,i){return(u%i+i)%i}function En(u,i,o){return u*(1-o)+i*o}function gn(u){if(u<=0)return 0;if(u>=1)return 1;const i=u*u,o=i*u;return 4*(u<.5?o:3*(u-i)+o-.75)}function ii(u,i,o,f){const v=new Ce(u,i,o,f);return T=>v.solve(T)}const wr=ii(.25,.1,.25,1);function Cr(u,i,o){return Math.min(o,Math.max(i,u))}function Ds(u,i,o){const f=o-i,v=((u-i)%f+f)%f+i;return v===i?o:v}function gi(u,...i){for(const o of i)for(const f in o)u[f]=o[f];return u}let ao=1;function Tr(u,i,o){const f={};for(const v in u)f[v]=i.call(this,u[v],v,u);return f}function ya(u,i,o){const f={};for(const v in u)i.call(this,u[v],v,u)&&(f[v]=u[v]);return f}function _a(u){return Array.isArray(u)?u.map(_a):typeof u=="object"&&u?Tr(u,_a):u}const rl={};function Ir(u){rl[u]||(typeof console<"u"&&console.warn(u),rl[u]=!0)}function Oa(u,i,o){return(o.y-u.y)*(i.x-u.x)>(i.y-u.y)*(o.x-u.x)}function na(u){return typeof WorkerGlobalScope<"u"&&u!==void 0&&u instanceof WorkerGlobalScope}let Ls=null;function Xa(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const bu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function zs(u,i,o,f,v){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const T=new VideoFrame(u,{timestamp:0});try{const S=T==null?void 0:T.format;if(!S||!S.startsWith("BGR")&&!S.startsWith("RGB"))throw new Error(`Unrecognized format ${S}`);const C=S.startsWith("BGR"),k=new Uint8ClampedArray(f*v*4);if(yield T.copyTo(k,function(z,N,j,G,Y){const J=4*Math.max(1,0),te=(Math.max(0,j)-j)*G*4+J,le=4*G,ge=Math.max(0,N),Ne=Math.max(0,j);return{rect:{x:ge,y:Ne,width:Math.min(z.width,N+G)-ge,height:Math.min(z.height,j+Y)-Ne},layout:[{offset:te,stride:le}]}}(u,i,o,f,v)),C)for(let z=0;z<k.length;z+=4){const N=k[z];k[z]=k[z+2],k[z+2]=N}return k}finally{T.close()}})}let ls,ko;function fr(u,i,o,f){return u.addEventListener(i,o,f),{unsubscribe:()=>{u.removeEventListener(i,o,f)}}}function Bn(u){return u*Math.PI/180}function di(u){return u/Math.PI*180}const Ri={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},xu={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},so="AbortError";function Ge(){return new Error(so)}const ne={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ie(u){return ne.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))]}const ue="global-dispatcher";class Te extends Error{constructor(i,o,f,v){super(`AJAXError: ${o} (${i}): ${f}`),this.status=i,this.statusText=o,this.url=f,this.body=v}}const Oe=()=>na(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,$e=function(u,i){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){const f=ie(u.url);if(f)return f(u,i);if(na(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,targetMapId:ue},i)}if(!(/^file:/.test(o=u.url)||/^file:/.test(Oe())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,v){return c(this,void 0,void 0,function*(){const T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:Oe(),signal:v.signal});let S,C;f.type!=="json"||T.headers.has("Accept")||T.headers.set("Accept","application/json");try{S=yield fetch(T)}catch(z){throw new Te(0,z.message,f.url,new Blob)}if(!S.ok){const z=yield S.blob();throw new Te(S.status,S.statusText,f.url,z)}C=f.type==="arrayBuffer"||f.type==="image"?S.arrayBuffer():f.type==="json"?S.json():S.text();const k=yield C;if(v.signal.aborted)throw Ge();return{data:k,cacheControl:S.headers.get("Cache-Control"),expires:S.headers.get("Expires")}})}(u,i);if(na(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,mustQueue:!0,targetMapId:ue},i)}var o;return function(f,v){return new Promise((T,S)=>{var C;const k=new XMLHttpRequest;k.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(k.responseType="arraybuffer");for(const z in f.headers)k.setRequestHeader(z,f.headers[z]);f.type==="json"&&(k.responseType="text",!((C=f.headers)===null||C===void 0)&&C.Accept||k.setRequestHeader("Accept","application/json")),k.withCredentials=f.credentials==="include",k.onerror=()=>{S(new Error(k.statusText))},k.onload=()=>{if(!v.signal.aborted)if((k.status>=200&&k.status<300||k.status===0)&&k.response!==null){let z=k.response;if(f.type==="json")try{z=JSON.parse(k.response)}catch(N){return void S(N)}T({data:z,cacheControl:k.getResponseHeader("Cache-Control"),expires:k.getResponseHeader("Expires")})}else{const z=new Blob([k.response],{type:k.getResponseHeader("Content-Type")});S(new Te(k.status,k.statusText,f.url,z))}},v.signal.addEventListener("abort",()=>{k.abort(),S(Ge())}),k.send(f.body)})}(u,i)};function tt(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;const i=new URL(u),o=window.location;return i.protocol===o.protocol&&i.host===o.host}function je(u,i,o){o[u]&&o[u].indexOf(i)!==-1||(o[u]=o[u]||[],o[u].push(i))}function ht(u,i,o){if(o&&o[u]){const f=o[u].indexOf(i);f!==-1&&o[u].splice(f,1)}}class st{constructor(i,o={}){gi(this,o),this.type=i}}class Ke extends st{constructor(i,o={}){super("error",gi({error:i},o))}}class mt{on(i,o){return this._listeners=this._listeners||{},je(i,o,this._listeners),{unsubscribe:()=>{this.off(i,o)}}}off(i,o){return ht(i,o,this._listeners),ht(i,o,this._oneTimeListeners),this}once(i,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},je(i,o,this._oneTimeListeners),this):new Promise(f=>this.once(i,f))}fire(i,o){typeof i=="string"&&(i=new st(i,o||{}));const f=i.type;if(this.listens(f)){i.target=this;const v=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const C of v)C.call(this,i);const T=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const C of T)ht(f,C,this._oneTimeListeners),C.call(this,i);const S=this._eventedParent;S&&(gi(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(i))}else i instanceof Ke&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,o){return this._eventedParent=i,this._eventedParentData=o,this}}var ze={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ot=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function on(u,i){const o={};for(const f in u)f!=="ref"&&(o[f]=u[f]);return Ot.forEach(f=>{f in i&&(o[f]=i[f])}),o}function jt(u,i){if(Array.isArray(u)){if(!Array.isArray(i)||u.length!==i.length)return!1;for(let o=0;o<u.length;o++)if(!jt(u[o],i[o]))return!1;return!0}if(typeof u=="object"&&u!==null&&i!==null){if(typeof i!="object"||Object.keys(u).length!==Object.keys(i).length)return!1;for(const o in u)if(!jt(u[o],i[o]))return!1;return!0}return u===i}function Jt(u,i){u.push(i)}function Xt(u,i,o){Jt(o,{command:"addSource",args:[u,i[u]]})}function An(u,i,o){Jt(i,{command:"removeSource",args:[u]}),o[u]=!0}function vn(u,i,o,f){An(u,o,f),Xt(u,i,o)}function Cn(u,i,o){let f;for(f in u[o])if(Object.prototype.hasOwnProperty.call(u[o],f)&&f!=="data"&&!jt(u[o][f],i[o][f]))return!1;for(f in i[o])if(Object.prototype.hasOwnProperty.call(i[o],f)&&f!=="data"&&!jt(u[o][f],i[o][f]))return!1;return!0}function cn(u,i,o,f,v,T){u=u||{},i=i||{};for(const S in u)Object.prototype.hasOwnProperty.call(u,S)&&(jt(u[S],i[S])||o.push({command:T,args:[f,S,i[S],v]}));for(const S in i)Object.prototype.hasOwnProperty.call(i,S)&&!Object.prototype.hasOwnProperty.call(u,S)&&(jt(u[S],i[S])||o.push({command:T,args:[f,S,i[S],v]}))}function jn(u){return u.id}function Kr(u,i){return u[i.id]=i,u}class kt{constructor(i,o,f,v){this.message=(i?`${i}: `:"")+f,v&&(this.identifier=v),o!=null&&o.__line__&&(this.line=o.__line__)}}function ai(u,...i){for(const o of i)for(const f in o)u[f]=o[f];return u}class cr extends Error{constructor(i,o){super(o),this.message=o,this.key=i}}class va{constructor(i,o=[]){this.parent=i,this.bindings={};for(const[f,v]of o)this.bindings[f]=v}concat(i){return new va(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const ba={kind:"null"},Dt={kind:"number"},hn={kind:"string"},nn={kind:"boolean"},ha={kind:"color"},il={kind:"projectionDefinition"},ki={kind:"object"},yn={kind:"value"},Os={kind:"collator"},Do={kind:"formatted"},kr={kind:"padding"},Ll={kind:"colorArray"},Ns={kind:"numberArray"},ra={kind:"resolvedImage"},yi={kind:"variableAnchorOffsetCollection"};function Gi(u,i){return{kind:"array",itemType:u,N:i}}function Dr(u){if(u.kind==="array"){const i=Dr(u.itemType);return typeof u.N=="number"?`array<${i}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${i}>`}return u.kind}const Lo=[ba,Dt,hn,nn,ha,il,Do,ki,Gi(yn),kr,Ns,Ll,ra,yi];function zo(u,i){if(i.kind==="error")return null;if(u.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!zo(u.itemType,i.itemType))&&(typeof u.N!="number"||u.N===i.N))return null}else{if(u.kind===i.kind)return null;if(u.kind==="value"){for(const o of Lo)if(!zo(o,i))return null}}return`Expected ${Dr(u)} but found ${Dr(i)} instead.`}function al(u,i){return i.some(o=>o.kind===u.kind)}function oo(u,i){return i.some(o=>o==="null"?u===null:o==="array"?Array.isArray(u):o==="object"?u&&!Array.isArray(u)&&typeof u=="object":o===typeof u)}function us(u,i){return u.kind==="array"&&i.kind==="array"?u.itemType.kind===i.itemType.kind&&typeof u.N=="number":u.kind===i.kind}const xa=.96422,bc=.82521,dd=4/29,lo=6/29,xc=3*lo*lo,zl=lo*lo*lo,wu=Math.PI/180,Di=180/Math.PI;function Ya(u){return(u%=360)<0&&(u+=360),u}function Bs([u,i,o,f]){let v,T;const S=uo((.2225045*(u=Oo(u))+.7168786*(i=Oo(i))+.0606169*(o=Oo(o)))/1);u===i&&i===o?v=T=S:(v=uo((.4360747*u+.3850649*i+.1430804*o)/xa),T=uo((.0139322*u+.0971045*i+.7141733*o)/bc));const C=116*S-16;return[C<0?0:C,500*(v-S),200*(S-T),f]}function Oo(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function uo(u){return u>zl?Math.pow(u,1/3):u/xc+dd}function Sr([u,i,o,f]){let v=(u+16)/116,T=isNaN(i)?v:v+i/500,S=isNaN(o)?v:v-o/200;return v=1*Na(v),T=xa*Na(T),S=bc*Na(S),[No(3.1338561*T-1.6168667*v-.4906146*S),No(-.9787684*T+1.9161415*v+.033454*S),No(.0719453*T-.2289914*v+1.4052427*S),f]}function No(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function Na(u){return u>lo?u*u*u:xc*(u-dd)}const wa=Object.hasOwn||function(u,i){return Object.prototype.hasOwnProperty.call(u,i)};function Ln(u,i){return wa(u,i)?u[i]:void 0}function cs(u){return parseInt(u.padEnd(2,u),16)/255}function hs(u,i){return sl(i?u/100:u,0,1)}function sl(u,i,o){return Math.min(Math.max(i,u),o)}function mh(u){return!u.some(Number.isNaN)}const Ol={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Li(u,i,o){return u+o*(i-u)}function zi(u,i,o){return u.map((f,v)=>Li(f,i[v],o))}class wn{constructor(i,o,f,v=1,T=!0){this.r=i,this.g=o,this.b=f,this.a=v,T||(this.r*=v,this.g*=v,this.b*=v,v||this.overwriteGetter("rgb",[i,o,f,v]))}static parse(i){if(i instanceof wn)return i;if(typeof i!="string")return;const o=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const v=Ln(Ol,f);if(v){const[S,C,k]=v;return[S/255,C/255,k/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const S=f.length<6?1:2;let C=1;return[cs(f.slice(C,C+=S)),cs(f.slice(C,C+=S)),cs(f.slice(C,C+=S)),cs(f.slice(C,C+S)||"ff")]}if(f.startsWith("rgb")){const S=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[C,k,z,N,j,G,Y,J,te,le,ge,Ne]=S,Se=[N||" ",Y||" ",le].join("");if(Se==="  "||Se==="  /"||Se===",,"||Se===",,,"){const X=[z,G,te].join(""),oe=X==="%%%"?100:X===""?255:0;if(oe){const Ie=[sl(+k/oe,0,1),sl(+j/oe,0,1),sl(+J/oe,0,1),ge?hs(+ge,Ne):1];if(mh(Ie))return Ie}}return}}const T=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[S,C,k,z,N,j,G,Y,J]=T,te=[k||" ",N||" ",G].join("");if(te==="  "||te==="  /"||te===",,"||te===",,,"){const le=[+C,sl(+z,0,100),sl(+j,0,100),Y?hs(+Y,J):1];if(mh(le))return function([ge,Ne,Se,X]){function oe(Ie){const nt=(Ie+ge/30)%12,yt=Ne*Math.min(Se,1-Se);return Se-yt*Math.max(-1,Math.min(nt-3,9-nt,1))}return ge=Ya(ge),Ne/=100,Se/=100,[oe(0),oe(8),oe(4),X]}(le)}}}(i);return o?new wn(...o,!1):void 0}get rgb(){const{r:i,g:o,b:f,a:v}=this,T=v||1/0;return this.overwriteGetter("rgb",[i/T,o/T,f/T,v])}get hcl(){return this.overwriteGetter("hcl",function(i){const[o,f,v,T]=Bs(i),S=Math.sqrt(f*f+v*v);return[Math.round(1e4*S)?Ya(Math.atan2(v,f)*Di):NaN,S,o,T]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Bs(this.rgb))}overwriteGetter(i,o){return Object.defineProperty(this,i,{value:o}),o}toString(){const[i,o,f,v]=this.rgb;return`rgba(${[i,o,f].map(T=>Math.round(255*T)).join(",")},${v})`}static interpolate(i,o,f,v="rgb"){switch(v){case"rgb":{const[T,S,C,k]=zi(i.rgb,o.rgb,f);return new wn(T,S,C,k,!1)}case"hcl":{const[T,S,C,k]=i.hcl,[z,N,j,G]=o.hcl;let Y,J;if(isNaN(T)||isNaN(z))isNaN(T)?isNaN(z)?Y=NaN:(Y=z,C!==1&&C!==0||(J=N)):(Y=T,j!==1&&j!==0||(J=S));else{let Se=z-T;z>T&&Se>180?Se-=360:z<T&&T-z>180&&(Se+=360),Y=T+f*Se}const[te,le,ge,Ne]=function([Se,X,oe,Ie]){return Se=isNaN(Se)?0:Se*wu,Sr([oe,Math.cos(Se)*X,Math.sin(Se)*X,Ie])}([Y,J??Li(S,N,f),Li(C,j,f),Li(k,G,f)]);return new wn(te,le,ge,Ne,!1)}case"lab":{const[T,S,C,k]=Sr(zi(i.lab,o.lab,f));return new wn(T,S,C,k,!1)}}}}wn.black=new wn(0,0,0,1),wn.white=new wn(1,1,1,1),wn.transparent=new wn(0,0,0,0),wn.red=new wn(1,0,0,1);class ds{constructor(i,o,f){this.sensitivity=i?o?"variant":"case":o?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,o){return this.collator.compare(i,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Nl=["bottom","center","top"];class Fs{constructor(i,o,f,v,T,S){this.text=i,this.image=o,this.scale=f,this.fontStack=v,this.textColor=T,this.verticalAlign=S}}class Hi{constructor(i){this.sections=i}static fromString(i){return new Hi([new Fs(i,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof Hi?i:Hi.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class Ur{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Ur)return i;if(typeof i=="number")return new Ur([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const o of i)if(typeof o!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new Ur(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){return new Ur(zi(i.values,o.values,f))}}class qr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof qr)return i;if(typeof i=="number")return new qr([i]);if(Array.isArray(i)){for(const o of i)if(typeof o!="number")return;return new qr(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){return new qr(zi(i.values,o.values,f))}}class Er{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Er)return i;if(typeof i=="string"){const f=wn.parse(i);return f?new Er([f]):void 0}if(!Array.isArray(i))return;const o=[];for(const f of i){if(typeof f!="string")return;const v=wn.parse(f);if(!v)return;o.push(v)}return new Er(o)}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f,v="rgb"){const T=[];if(i.values.length!=o.values.length)throw new Error(`colorArray: Arrays have mismatched length (${i.values.length} vs. ${o.values.length}), cannot interpolate.`);for(let S=0;S<i.values.length;S++)T.push(wn.interpolate(i.values[S],o.values[S],f,v));return new Er(T)}}class pr extends Error{constructor(i){super(i),this.name="RuntimeError"}toJSON(){return this.message}}const fs=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class In{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof In)return i;if(Array.isArray(i)&&!(i.length<1)&&i.length%2==0){for(let o=0;o<i.length;o+=2){const f=i[o],v=i[o+1];if(typeof f!="string"||!fs.has(f)||!Array.isArray(v)||v.length!==2||typeof v[0]!="number"||typeof v[1]!="number")return}return new In(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){const v=i.values,T=o.values;if(v.length!==T.length)throw new pr(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${o.toString()}`);const S=[];for(let C=0;C<v.length;C+=2){if(v[C]!==T[C])throw new pr(`Cannot interpolate values containing mismatched anchors. from[${C}]: ${v[C]}, to[${C}]: ${T[C]}`);S.push(v[C]);const[k,z]=v[C+1],[N,j]=T[C+1];S.push([Li(k,N,f),Li(z,j,f)])}return new In(S)}}class fi{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new fi({name:i,available:!1}):null}}class _n{constructor(i,o,f){this.from=i,this.to=o,this.transition=f}static interpolate(i,o,f){return new _n(i,o,f)}static parse(i){return i instanceof _n?i:Array.isArray(i)&&i.length===3&&typeof i[0]=="string"&&typeof i[1]=="string"&&typeof i[2]=="number"?new _n(i[0],i[1],i[2]):typeof i=="object"&&typeof i.from=="string"&&typeof i.to=="string"&&typeof i.transition=="number"?new _n(i.from,i.to,i.transition):typeof i=="string"?new _n(i,i,1):void 0}}function mn(u,i,o,f){return typeof u=="number"&&u>=0&&u<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof o=="number"&&o>=0&&o<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[u,i,o,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[u,i,o,f]:[u,i,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ta(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof _n||u instanceof wn||u instanceof ds||u instanceof Hi||u instanceof Ur||u instanceof qr||u instanceof Er||u instanceof In||u instanceof fi)return!0;if(Array.isArray(u)){for(const i of u)if(!Ta(i))return!1;return!0}if(typeof u=="object"){for(const i in u)if(!Ta(u[i]))return!1;return!0}return!1}function ln(u){if(u===null)return ba;if(typeof u=="string")return hn;if(typeof u=="boolean")return nn;if(typeof u=="number")return Dt;if(u instanceof wn)return ha;if(u instanceof _n)return il;if(u instanceof ds)return Os;if(u instanceof Hi)return Do;if(u instanceof Ur)return kr;if(u instanceof qr)return Ns;if(u instanceof Er)return Ll;if(u instanceof In)return yi;if(u instanceof fi)return ra;if(Array.isArray(u)){const i=u.length;let o;for(const f of u){const v=ln(f);if(o){if(o===v)continue;o=yn;break}o=v}return Gi(o||yn,i)}return ki}function Jr(u){const i=typeof u;return u===null?"":i==="string"||i==="number"||i==="boolean"?String(u):u instanceof wn||u instanceof _n||u instanceof Hi||u instanceof Ur||u instanceof qr||u instanceof Er||u instanceof In||u instanceof fi?u.toString():JSON.stringify(u)}class Dn{constructor(i,o){this.type=i,this.value=o}static parse(i,o){if(i.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Ta(i[1]))return o.error("invalid value");const f=i[1];let v=ln(f);const T=o.expectedType;return v.kind!=="array"||v.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(v=T),new Dn(v,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const co={string:hn,number:Dt,boolean:nn,object:ki};class ia{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let f,v=1;const T=i[0];if(T==="array"){let C,k;if(i.length>2){const z=i[1];if(typeof z!="string"||!(z in co)||z==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);C=co[z],v++}else C=yn;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return o.error('The length argument to "array" must be a positive integer literal',2);k=i[2],v++}f=Gi(C,k)}else{if(!co[T])throw new Error(`Types doesn't contain name = ${T}`);f=co[T]}const S=[];for(;v<i.length;v++){const C=o.parse(i[v],v,yn);if(!C)return null;S.push(C)}return new ia(f,S)}evaluate(i){for(let o=0;o<this.args.length;o++){const f=this.args[o].evaluate(i);if(!zo(this.type,ln(f)))return f;if(o===this.args.length-1)throw new pr(`Expected value to be of type ${Dr(this.type)}, but found ${Dr(ln(f))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const wc={"to-boolean":nn,"to-color":ha,"to-number":Dt,"to-string":hn};class Ba{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const f=i[0];if(!wc[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&i.length!==2)return o.error("Expected one argument.");const v=wc[f],T=[];for(let S=1;S<i.length;S++){const C=o.parse(i[S],S,yn);if(!C)return null;T.push(C)}return new Ba(v,T)}evaluate(i){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(i);case"color":{let o,f;for(const v of this.args){if(o=v.evaluate(i),f=null,o instanceof wn)return o;if(typeof o=="string"){const T=i.parseColor(o);if(T)return T}else if(Array.isArray(o)&&(f=o.length<3||o.length>4?`Invalid rgba value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:mn(o[0],o[1],o[2],o[3]),!f))return new wn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new pr(f||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const f of this.args){o=f.evaluate(i);const v=Ur.parse(o);if(v)return v}throw new pr(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"numberArray":{let o;for(const f of this.args){o=f.evaluate(i);const v=qr.parse(o);if(v)return v}throw new pr(`Could not parse numberArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"colorArray":{let o;for(const f of this.args){o=f.evaluate(i);const v=Er.parse(o);if(v)return v}throw new pr(`Could not parse colorArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const f of this.args){o=f.evaluate(i);const v=In.parse(o);if(v)return v}throw new pr(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const f of this.args){if(o=f.evaluate(i),o===null)return 0;const v=Number(o);if(!isNaN(v))return v}throw new pr(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return Hi.fromString(Jr(this.args[0].evaluate(i)));case"resolvedImage":return fi.fromString(Jr(this.args[0].evaluate(i)));case"projectionDefinition":return this.args[0].evaluate(i);default:return Jr(this.args[0].evaluate(i))}}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const Tu=["Unknown","Point","LineString","Polygon"];class ho{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Tu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let o=this._parseColorCache.get(i);return o||(o=wn.parse(i),this._parseColorCache.set(i,o)),o}}class fo{constructor(i,o,f=[],v,T=new va,S=[]){this.registry=i,this.path=f,this.key=f.map(C=>`[${C}]`).join(""),this.scope=T,this.errors=S,this.expectedType=v,this._isConstant=o}parse(i,o,f,v,T={}){return o?this.concat(o,f,v)._parse(i,T):this._parse(i,T)}_parse(i,o){function f(v,T,S){return S==="assert"?new ia(T,[v]):S==="coerce"?new Ba(T,[v]):v}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=i[0];if(typeof v!="string")return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[v];if(T){let S=T.parse(i,this);if(!S)return null;if(this.expectedType){const C=this.expectedType,k=S.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||k.kind!=="value"){if(C.kind==="projectionDefinition"&&["string","array"].includes(k.kind)||["color","formatted","resolvedImage"].includes(C.kind)&&["value","string"].includes(k.kind)||["padding","numberArray"].includes(C.kind)&&["value","number","array"].includes(k.kind)||C.kind==="colorArray"&&["value","string","array"].includes(k.kind)||C.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(k.kind))S=f(S,C,o.typeAnnotation||"coerce");else if(this.checkSubtype(C,k))return null}else S=f(S,C,o.typeAnnotation||"assert")}if(!(S instanceof Dn)&&S.type.kind!=="resolvedImage"&&this._isConstant(S)){const C=new ho;try{S=new Dn(S.type,S.evaluate(C))}catch(k){return this.error(k.message),null}}return S}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,o,f){const v=typeof i=="number"?this.path.concat(i):this.path,T=f?this.scope.concat(f):this.scope;return new fo(this.registry,this._isConstant,v,o||null,T,this.errors)}error(i,...o){const f=`${this.key}${o.map(v=>`[${v}]`).join("")}`;this.errors.push(new cr(f,i))}checkSubtype(i,o){const f=zo(i,o);return f&&this.error(f),f}}class Sa{constructor(i,o){this.type=o.type,this.bindings=[].concat(i),this.result=o}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const o of this.bindings)i(o[1]);i(this.result)}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const f=[];for(let T=1;T<i.length-1;T+=2){const S=i[T];if(typeof S!="string")return o.error(`Expected string, but found ${typeof S} instead.`,T);if(/[^a-zA-Z0-9_]/.test(S))return o.error("Variable names must contain only alphanumeric characters or '_'.",T);const C=o.parse(i[T+1],T+1);if(!C)return null;f.push([S,C])}const v=o.parse(i[i.length-1],i.length-1,o.expectedType,f);return v?new Sa(f,v):null}outputDefined(){return this.result.outputDefined()}}class Qa{constructor(i,o){this.type=o.type,this.name=i,this.boundExpression=o}static parse(i,o){if(i.length!==2||typeof i[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const f=i[1];return o.scope.has(f)?new Qa(f,o.scope.get(f)):o.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class Oi{constructor(i,o,f){this.type=i,this.index=o,this.input=f}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,Dt),v=o.parse(i[2],2,Gi(o.expectedType||yn));return f&&v?new Oi(v.type.itemType,f,v):null}evaluate(i){const o=this.index.evaluate(i),f=this.input.evaluate(i);if(o<0)throw new pr(`Array index out of bounds: ${o} < 0.`);if(o>=f.length)throw new pr(`Array index out of bounds: ${o} > ${f.length-1}.`);if(o!==Math.floor(o))throw new pr(`Array index must be an integer, but found ${o} instead.`);return f[o]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class Vs{constructor(i,o){this.type=nn,this.needle=i,this.haystack=o}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,yn),v=o.parse(i[2],2,yn);return f&&v?al(f.type,[nn,hn,Dt,ba,yn])?new Vs(f,v):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(f.type)} instead`):null}evaluate(i){const o=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!f)return!1;if(!oo(o,["boolean","string","number","null"]))throw new pr(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(ln(o))} instead.`);if(!oo(f,["string","array"]))throw new pr(`Expected second argument to be of type array or string, but found ${Dr(ln(f))} instead.`);return f.indexOf(o)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class Bo{constructor(i,o,f){this.type=Dt,this.needle=i,this.haystack=o,this.fromIndex=f}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,yn),v=o.parse(i[2],2,yn);if(!f||!v)return null;if(!al(f.type,[nn,hn,Dt,ba,yn]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(f.type)} instead`);if(i.length===4){const T=o.parse(i[3],3,Dt);return T?new Bo(f,v,T):null}return new Bo(f,v)}evaluate(i){const o=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!oo(o,["boolean","string","number","null"]))throw new pr(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(ln(o))} instead.`);let v;if(this.fromIndex&&(v=this.fromIndex.evaluate(i)),oo(f,["string"])){const T=f.indexOf(o,v);return T===-1?-1:[...f.slice(0,T)].length}if(oo(f,["array"]))return f.indexOf(o,v);throw new pr(`Expected second argument to be of type array or string, but found ${Dr(ln(f))} instead.`)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class Fo{constructor(i,o,f,v,T,S){this.inputType=i,this.type=o,this.input=f,this.cases=v,this.outputs=T,this.otherwise=S}static parse(i,o){if(i.length<5)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return o.error("Expected an even number of arguments.");let f,v;o.expectedType&&o.expectedType.kind!=="value"&&(v=o.expectedType);const T={},S=[];for(let z=2;z<i.length-1;z+=2){let N=i[z];const j=i[z+1];Array.isArray(N)||(N=[N]);const G=o.concat(z);if(N.length===0)return G.error("Expected at least one branch label.");for(const J of N){if(typeof J!="number"&&typeof J!="string")return G.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return G.error("Numeric branch labels must be integer values.");if(f){if(G.checkSubtype(f,ln(J)))return null}else f=ln(J);if(T[String(J)]!==void 0)return G.error("Branch labels must be unique.");T[String(J)]=S.length}const Y=o.parse(j,z,v);if(!Y)return null;v=v||Y.type,S.push(Y)}const C=o.parse(i[1],1,yn);if(!C)return null;const k=o.parse(i[i.length-1],i.length-1,v);return k?C.type.kind!=="value"&&o.concat(1).checkSubtype(f,C.type)?null:new Fo(f,v,C,T,S,k):null}evaluate(i){const o=this.input.evaluate(i);return(ln(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class Xr{constructor(i,o,f){this.type=i,this.branches=o,this.otherwise=f}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return o.error("Expected an odd number of arguments.");let f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const v=[];for(let S=1;S<i.length-1;S+=2){const C=o.parse(i[S],S,nn);if(!C)return null;const k=o.parse(i[S+1],S+1,f);if(!k)return null;v.push([C,k]),f=f||k.type}const T=o.parse(i[i.length-1],i.length-1,f);if(!T)return null;if(!f)throw new Error("Can't infer output type");return new Xr(f,v,T)}evaluate(i){for(const[o,f]of this.branches)if(o.evaluate(i))return f.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[o,f]of this.branches)i(o),i(f);i(this.otherwise)}outputDefined(){return this.branches.every(([i,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Bl{constructor(i,o,f,v){this.type=i,this.input=o,this.beginIndex=f,this.endIndex=v}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,yn),v=o.parse(i[2],2,Dt);if(!f||!v)return null;if(!al(f.type,[Gi(yn),hn,yn]))return o.error(`Expected first argument to be of type array or string, but found ${Dr(f.type)} instead`);if(i.length===4){const T=o.parse(i[3],3,Dt);return T?new Bl(f.type,f,v,T):null}return new Bl(f.type,f,v)}evaluate(i){const o=this.input.evaluate(i),f=this.beginIndex.evaluate(i);let v;if(this.endIndex&&(v=this.endIndex.evaluate(i)),oo(o,["string"]))return[...o].slice(f,v).join("");if(oo(o,["array"]))return o.slice(f,v);throw new pr(`Expected first argument to be of type array or string, but found ${Dr(ln(o))} instead.`)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function po(u,i){const o=u.length-1;let f,v,T=0,S=o,C=0;for(;T<=S;)if(C=Math.floor((T+S)/2),f=u[C],v=u[C+1],f<=i){if(C===o||i<v)return C;T=C+1}else{if(!(f>i))throw new pr("Input is not a number.");S=C-1}return 0}class Fl{constructor(i,o,f){this.type=i,this.input=o,this.labels=[],this.outputs=[];for(const[v,T]of f)this.labels.push(v),this.outputs.push(T)}static parse(i,o){if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");const f=o.parse(i[1],1,Dt);if(!f)return null;const v=[];let T=null;o.expectedType&&o.expectedType.kind!=="value"&&(T=o.expectedType);for(let S=1;S<i.length;S+=2){const C=S===1?-1/0:i[S],k=i[S+1],z=S,N=S+1;if(typeof C!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(v.length&&v[v.length-1][0]>=C)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const j=o.parse(k,N,T);if(!j)return null;T=T||j.type,v.push([C,j])}return new Fl(T,f,v)}evaluate(i){const o=this.labels,f=this.outputs;if(o.length===1)return f[0].evaluate(i);const v=this.input.evaluate(i);if(v<=o[0])return f[0].evaluate(i);const T=o.length;return v>=o[T-1]?f[T-1].evaluate(i):f[po(o,v)].evaluate(i)}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function gh(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Ja,Vl,Tc=function(){if(Vl)return Ja;function u(i,o,f,v){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(v-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=f,this.p2y=v}return Vl=1,Ja=u,u.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,v=0;v<8;v++){var T=this.sampleCurveX(f)-i;if(Math.abs(T)<o)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=T/S}var C=0,k=1;for(f=i,v=0;v<20&&(T=this.sampleCurveX(f),!(Math.abs(T-i)<o));v++)i>T?C=f:k=f,f=.5*(k-C)+C;return f},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},Ja}(),yh=gh(Tc);class _i{constructor(i,o,f,v,T){this.type=i,this.operator=o,this.interpolation=f,this.input=v,this.labels=[],this.outputs=[];for(const[S,C]of T)this.labels.push(S),this.outputs.push(C)}static interpolationFactor(i,o,f,v){let T=0;if(i.name==="exponential")T=ol(o,i.base,f,v);else if(i.name==="linear")T=ol(o,1,f,v);else if(i.name==="cubic-bezier"){const S=i.controlPoints;T=new yh(S[0],S[1],S[2],S[3]).solve(ol(o,1,f,v))}return T}static parse(i,o){let[f,v,T,...S]=i;if(!Array.isArray(v)||v.length===0)return o.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const z=v[1];if(typeof z!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:z}}else{if(v[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const z=v.slice(1);if(z.length!==4||z.some(N=>typeof N!="number"||N<0||N>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:z}}}if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(T=o.parse(T,2,Dt),!T)return null;const C=[];let k=null;f!=="interpolate-hcl"&&f!=="interpolate-lab"||o.expectedType==Ll?o.expectedType&&o.expectedType.kind!=="value"&&(k=o.expectedType):k=ha;for(let z=0;z<S.length;z+=2){const N=S[z],j=S[z+1],G=z+3,Y=z+4;if(typeof N!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(C.length&&C[C.length-1][0]>=N)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const J=o.parse(j,Y,k);if(!J)return null;k=k||J.type,C.push([N,J])}return us(k,Dt)||us(k,il)||us(k,ha)||us(k,kr)||us(k,Ns)||us(k,Ll)||us(k,yi)||us(k,Gi(Dt))?new _i(k,f,v,T,C):o.error(`Type ${Dr(k)} is not interpolatable.`)}evaluate(i){const o=this.labels,f=this.outputs;if(o.length===1)return f[0].evaluate(i);const v=this.input.evaluate(i);if(v<=o[0])return f[0].evaluate(i);const T=o.length;if(v>=o[T-1])return f[T-1].evaluate(i);const S=po(o,v),C=_i.interpolationFactor(this.interpolation,v,o[S],o[S+1]),k=f[S].evaluate(i),z=f[S+1].evaluate(i);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Li(k,z,C);case"color":return wn.interpolate(k,z,C);case"padding":return Ur.interpolate(k,z,C);case"colorArray":return Er.interpolate(k,z,C);case"numberArray":return qr.interpolate(k,z,C);case"variableAnchorOffsetCollection":return In.interpolate(k,z,C);case"array":return zi(k,z,C);case"projectionDefinition":return _n.interpolate(k,z,C)}case"interpolate-hcl":switch(this.type.kind){case"color":return wn.interpolate(k,z,C,"hcl");case"colorArray":return Er.interpolate(k,z,C,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return wn.interpolate(k,z,C,"lab");case"colorArray":return Er.interpolate(k,z,C,"lab")}}}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function ol(u,i,o,f){const v=f-o,T=u-o;return v===0?0:i===1?T/v:(Math.pow(i,T)-1)/(Math.pow(i,v)-1)}const aa={color:wn.interpolate,number:Li,padding:Ur.interpolate,numberArray:qr.interpolate,colorArray:Er.interpolate,variableAnchorOffsetCollection:In.interpolate,array:zi};class da{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let f=null;const v=o.expectedType;v&&v.kind!=="value"&&(f=v);const T=[];for(const C of i.slice(1)){const k=o.parse(C,1+T.length,f,void 0,{typeAnnotation:"omit"});if(!k)return null;f=f||k.type,T.push(k)}if(!f)throw new Error("No output type");const S=v&&T.some(C=>zo(v,C.type));return new da(S?yn:f,T)}evaluate(i){let o,f=null,v=0;for(const T of this.args)if(v++,f=T.evaluate(i),f&&f instanceof fi&&!f.available&&(o||(o=f.name),f=null,v===this.args.length&&(f=o)),f!==null)break;return f}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}function Su(u,i){return u==="=="||u==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function ps(u,i,o,f){return f.compare(i,o)===0}function ll(u,i,o){const f=u!=="=="&&u!=="!=";return class DI{constructor(T,S,C){this.type=nn,this.lhs=T,this.rhs=S,this.collator=C,this.hasUntypedArgument=T.type.kind==="value"||S.type.kind==="value"}static parse(T,S){if(T.length!==3&&T.length!==4)return S.error("Expected two or three arguments.");const C=T[0];let k=S.parse(T[1],1,yn);if(!k)return null;if(!Su(C,k.type))return S.concat(1).error(`"${C}" comparisons are not supported for type '${Dr(k.type)}'.`);let z=S.parse(T[2],2,yn);if(!z)return null;if(!Su(C,z.type))return S.concat(2).error(`"${C}" comparisons are not supported for type '${Dr(z.type)}'.`);if(k.type.kind!==z.type.kind&&k.type.kind!=="value"&&z.type.kind!=="value")return S.error(`Cannot compare types '${Dr(k.type)}' and '${Dr(z.type)}'.`);f&&(k.type.kind==="value"&&z.type.kind!=="value"?k=new ia(z.type,[k]):k.type.kind!=="value"&&z.type.kind==="value"&&(z=new ia(k.type,[z])));let N=null;if(T.length===4){if(k.type.kind!=="string"&&z.type.kind!=="string"&&k.type.kind!=="value"&&z.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(N=S.parse(T[3],3,Os),!N)return null}return new DI(k,z,N)}evaluate(T){const S=this.lhs.evaluate(T),C=this.rhs.evaluate(T);if(f&&this.hasUntypedArgument){const k=ln(S),z=ln(C);if(k.kind!==z.kind||k.kind!=="string"&&k.kind!=="number")throw new pr(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${k.kind}, ${z.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const k=ln(S),z=ln(C);if(k.kind!=="string"||z.kind!=="string")return i(T,S,C)}return this.collator?o(T,S,C,this.collator.evaluate(T)):i(T,S,C)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const Sc=ll("==",function(u,i,o){return i===o},ps),fd=ll("!=",function(u,i,o){return i!==o},function(u,i,o,f){return!ps(0,i,o,f)}),pd=ll("<",function(u,i,o){return i<o},function(u,i,o,f){return f.compare(i,o)<0}),Ec=ll(">",function(u,i,o){return i>o},function(u,i,o,f){return f.compare(i,o)>0}),Fa=ll("<=",function(u,i,o){return i<=o},function(u,i,o,f){return f.compare(i,o)<=0}),Eu=ll(">=",function(u,i,o){return i>=o},function(u,i,o,f){return f.compare(i,o)>=0});class Au{constructor(i,o,f){this.type=Os,this.locale=f,this.caseSensitive=i,this.diacriticSensitive=o}static parse(i,o){if(i.length!==2)return o.error("Expected one argument.");const f=i[1];if(typeof f!="object"||Array.isArray(f))return o.error("Collator options argument must be an object.");const v=o.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,nn);if(!v)return null;const T=o.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,nn);if(!T)return null;let S=null;return f.locale&&(S=o.parse(f.locale,1,hn),!S)?null:new Au(v,T,S)}evaluate(i){return new ds(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}class ms{constructor(i,o,f,v,T){this.type=hn,this.number=i,this.locale=o,this.currency=f,this.minFractionDigits=v,this.maxFractionDigits=T}static parse(i,o){if(i.length!==3)return o.error("Expected two arguments.");const f=o.parse(i[1],1,Dt);if(!f)return null;const v=i[2];if(typeof v!="object"||Array.isArray(v))return o.error("NumberFormat options argument must be an object.");let T=null;if(v.locale&&(T=o.parse(v.locale,1,hn),!T))return null;let S=null;if(v.currency&&(S=o.parse(v.currency,1,hn),!S))return null;let C=null;if(v["min-fraction-digits"]&&(C=o.parse(v["min-fraction-digits"],1,Dt),!C))return null;let k=null;return v["max-fraction-digits"]&&(k=o.parse(v["max-fraction-digits"],1,Dt),!k)?null:new ms(f,T,S,C,k)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class A{constructor(i){this.type=Do,this.sections=i}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const f=i[1];if(!Array.isArray(f)&&typeof f=="object")return o.error("First argument must be an image or text section.");const v=[];let T=!1;for(let S=1;S<=i.length-1;++S){const C=i[S];if(T&&typeof C=="object"&&!Array.isArray(C)){T=!1;let k=null;if(C["font-scale"]&&(k=o.parse(C["font-scale"],1,Dt),!k))return null;let z=null;if(C["text-font"]&&(z=o.parse(C["text-font"],1,Gi(hn)),!z))return null;let N=null;if(C["text-color"]&&(N=o.parse(C["text-color"],1,ha),!N))return null;let j=null;if(C["vertical-align"]){if(typeof C["vertical-align"]=="string"&&!Nl.includes(C["vertical-align"]))return o.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${C["vertical-align"]}' instead.`);if(j=o.parse(C["vertical-align"],1,hn),!j)return null}const G=v[v.length-1];G.scale=k,G.font=z,G.textColor=N,G.verticalAlign=j}else{const k=o.parse(i[S],1,yn);if(!k)return null;const z=k.type.kind;if(z!=="string"&&z!=="value"&&z!=="null"&&z!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,v.push({content:k,scale:null,font:null,textColor:null,verticalAlign:null})}}return new A(v)}evaluate(i){return new Hi(this.sections.map(o=>{const f=o.content.evaluate(i);return ln(f)===ra?new Fs("",f,null,null,null,o.verticalAlign?o.verticalAlign.evaluate(i):null):new Fs(Jr(f),null,o.scale?o.scale.evaluate(i):null,o.font?o.font.evaluate(i).join(","):null,o.textColor?o.textColor.evaluate(i):null,o.verticalAlign?o.verticalAlign.evaluate(i):null)}))}eachChild(i){for(const o of this.sections)i(o.content),o.scale&&i(o.scale),o.font&&i(o.font),o.textColor&&i(o.textColor),o.verticalAlign&&i(o.verticalAlign)}outputDefined(){return!1}}class V{constructor(i){this.type=ra,this.input=i}static parse(i,o){if(i.length!==2)return o.error("Expected two arguments.");const f=o.parse(i[1],1,hn);return f?new V(f):o.error("No image name provided.")}evaluate(i){const o=this.input.evaluate(i),f=fi.fromString(o);return f&&i.availableImages&&(f.available=i.availableImages.indexOf(o)>-1),f}eachChild(i){i(this.input)}outputDefined(){return!1}}class Z{constructor(i){this.type=Dt,this.input=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=o.parse(i[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${Dr(f.type)} instead.`):new Z(f):null}evaluate(i){const o=this.input.evaluate(i);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new pr(`Expected value to be of type string or array, but found ${Dr(ln(o))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const ce=8192;function Je(u,i){const o=(180+u[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,v=Math.pow(2,i.z);return[Math.round(o*v*ce),Math.round(f*v*ce)]}function pt(u,i){const o=Math.pow(2,i.z);return[(v=(u[0]/ce+i.x)/o,360*v-180),(f=(u[1]/ce+i.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90)];var f,v}function Vt(u,i){u[0]=Math.min(u[0],i[0]),u[1]=Math.min(u[1],i[1]),u[2]=Math.max(u[2],i[0]),u[3]=Math.max(u[3],i[1])}function Gn(u,i){return!(u[0]<=i[0]||u[2]>=i[2]||u[1]<=i[1]||u[3]>=i[3])}function Ni(u,i,o){const f=u[0]-i[0],v=u[1]-i[1],T=u[0]-o[0],S=u[1]-o[1];return f*S-T*v==0&&f*T<=0&&v*S<=0}function Hn(u,i,o,f){return(v=[f[0]-o[0],f[1]-o[1]])[0]*(T=[i[0]-u[0],i[1]-u[1]])[1]-v[1]*T[0]!=0&&!(!jl(u,i,o,f)||!jl(o,f,u,i));var v,T}function Zi(u,i,o){for(const f of o)for(let v=0;v<f.length-1;++v)if(Hn(u,i,f[v],f[v+1]))return!0;return!1}function ei(u,i,o=!1){let f=!1;for(const C of i)for(let k=0;k<C.length-1;k++){if(Ni(u,C[k],C[k+1]))return o;(T=C[k])[1]>(v=u)[1]!=(S=C[k+1])[1]>v[1]&&v[0]<(S[0]-T[0])*(v[1]-T[1])/(S[1]-T[1])+T[0]&&(f=!f)}var v,T,S;return f}function ul(u,i){for(const o of i)if(ei(u,o))return!0;return!1}function sa(u,i){for(const o of u)if(!ei(o,i))return!1;for(let o=0;o<u.length-1;++o)if(Zi(u[o],u[o+1],i))return!1;return!0}function Vo(u,i){for(const o of i)if(sa(u,o))return!0;return!1}function jl(u,i,o,f){const v=f[0]-o[0],T=f[1]-o[1],S=(u[0]-o[0])*T-v*(u[1]-o[1]),C=(i[0]-o[0])*T-v*(i[1]-o[1]);return S>0&&C<0||S<0&&C>0}function Ac(u,i,o){const f=[];for(let v=0;v<u.length;v++){const T=[];for(let S=0;S<u[v].length;S++){const C=Je(u[v][S],o);Vt(i,C),T.push(C)}f.push(T)}return f}function If(u,i,o){const f=[];for(let v=0;v<u.length;v++){const T=Ac(u[v],i,o);f.push(T)}return f}function Mf(u,i,o,f){if(u[0]<o[0]||u[0]>o[2]){const v=.5*f;let T=u[0]-o[0]>v?-f:o[0]-u[0]>v?f:0;T===0&&(T=u[0]-o[2]>v?-f:o[2]-u[0]>v?f:0),u[0]+=T}Vt(i,u)}function _h(u,i,o,f){const v=Math.pow(2,f.z)*ce,T=[f.x*ce,f.y*ce],S=[];for(const C of u)for(const k of C){const z=[k.x+T[0],k.y+T[1]];Mf(z,i,o,v),S.push(z)}return S}function vh(u,i,o,f){const v=Math.pow(2,f.z)*ce,T=[f.x*ce,f.y*ce],S=[];for(const k of u){const z=[];for(const N of k){const j=[N.x+T[0],N.y+T[1]];Vt(i,j),z.push(j)}S.push(z)}if(i[2]-i[0]<=v/2){(C=i)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const k of S)for(const z of k)Mf(z,i,o,v)}var C;return S}class Ul{constructor(i,o){this.type=nn,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Ta(i[1])){const f=i[1];if(f.type==="FeatureCollection"){const v=[];for(const T of f.features){const{type:S,coordinates:C}=T.geometry;S==="Polygon"&&v.push(C),S==="MultiPolygon"&&v.push(...C)}if(v.length)return new Ul(f,{type:"MultiPolygon",coordinates:v})}else if(f.type==="Feature"){const v=f.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Ul(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Ul(f,f)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,f){const v=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(f.type==="Polygon"){const C=Ac(f.coordinates,T,S),k=_h(o.geometry(),v,T,S);if(!Gn(v,T))return!1;for(const z of k)if(!ei(z,C))return!1}if(f.type==="MultiPolygon"){const C=If(f.coordinates,T,S),k=_h(o.geometry(),v,T,S);if(!Gn(v,T))return!1;for(const z of k)if(!ul(z,C))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,f){const v=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(f.type==="Polygon"){const C=Ac(f.coordinates,T,S),k=vh(o.geometry(),v,T,S);if(!Gn(v,T))return!1;for(const z of k)if(!sa(z,C))return!1}if(f.type==="MultiPolygon"){const C=If(f.coordinates,T,S),k=vh(o.geometry(),v,T,S);if(!Gn(v,T))return!1;for(const z of k)if(!Vo(z,C))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Pf=class{constructor(u=[],i=(o,f)=>o<f?-1:o>f?1:0){if(this.data=u,this.length=this.data.length,this.compare=i,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(u){this.data.push(u),this._up(this.length++)}pop(){if(this.length===0)return;const u=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:i,compare:o}=this,f=i[u];for(;u>0;){const v=u-1>>1,T=i[v];if(o(f,T)>=0)break;i[u]=T,u=v}i[u]=f}_down(u){const{data:i,compare:o}=this,f=this.length>>1,v=i[u];for(;u<f;){let T=1+(u<<1);const S=T+1;if(S<this.length&&o(i[S],i[T])<0&&(T=S),o(i[T],v)>=0)break;i[u]=i[T],u=T}i[u]=v}};function md(u,i,o=0,f=u.length-1,v=Ig){for(;f>o;){if(f-o>600){const k=f-o+1,z=i-o+1,N=Math.log(k),j=.5*Math.exp(2*N/3),G=.5*Math.sqrt(N*j*(k-j)/k)*(z-k/2<0?-1:1);md(u,i,Math.max(o,Math.floor(i-z*j/k+G)),Math.min(f,Math.floor(i+(k-z)*j/k+G)),v)}const T=u[i];let S=o,C=f;for(Cc(u,o,i),v(u[f],T)>0&&Cc(u,o,f);S<C;){for(Cc(u,S,C),S++,C--;v(u[S],T)<0;)S++;for(;v(u[C],T)>0;)C--}v(u[o],T)===0?Cc(u,o,C):(C++,Cc(u,C,f)),C<=i&&(o=C+1),i<=C&&(f=C-1)}}function Cc(u,i,o){const f=u[i];u[i]=u[o],u[o]=f}function Ig(u,i){return u<i?-1:u>i?1:0}function gd(u,i){if(u.length<=1)return[u];const o=[];let f,v;for(const T of u){const S=Jp(T);S!==0&&(T.area=Math.abs(S),v===void 0&&(v=S<0),v===S<0?(f&&o.push(f),f=[T]):f.push(T))}if(f&&o.push(f),i>1)for(let T=0;T<o.length;T++)o[T].length<=i||(md(o[T],i,1,o[T].length-1,Mg),o[T]=o[T].slice(0,i));return o}function Mg(u,i){return i.area-u.area}function Jp(u){let i=0;for(let o,f,v=0,T=u.length,S=T-1;v<T;S=v++)o=u[v],f=u[S],i+=(f.x-o.x)*(o.y+f.y);return i}const es=1/298.257223563,Ic=es*(2-es),Rf=Math.PI/180;class yd{constructor(i){const o=6378.137*Rf*1e3,f=Math.cos(i*Rf),v=1/(1-Ic*(1-f*f)),T=Math.sqrt(v);this.kx=o*T*f,this.ky=o*T*v*(1-Ic)}distance(i,o){const f=this.wrap(i[0]-o[0])*this.kx,v=(i[1]-o[1])*this.ky;return Math.sqrt(f*f+v*v)}pointOnLine(i,o){let f,v,T,S,C=1/0;for(let k=0;k<i.length-1;k++){let z=i[k][0],N=i[k][1],j=this.wrap(i[k+1][0]-z)*this.kx,G=(i[k+1][1]-N)*this.ky,Y=0;j===0&&G===0||(Y=(this.wrap(o[0]-z)*this.kx*j+(o[1]-N)*this.ky*G)/(j*j+G*G),Y>1?(z=i[k+1][0],N=i[k+1][1]):Y>0&&(z+=j/this.kx*Y,N+=G/this.ky*Y)),j=this.wrap(o[0]-z)*this.kx,G=(o[1]-N)*this.ky;const J=j*j+G*G;J<C&&(C=J,f=z,v=N,T=k,S=Y)}return{point:[f,v],index:T,t:Math.max(0,Math.min(1,S))}}wrap(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}}function nr(u,i){return i[0]-u[0]}function bh(u){return u[1]-u[0]+1}function mo(u,i){return u[1]>=u[0]&&u[1]<i}function kf(u,i){if(u[0]>u[1])return[null,null];const o=bh(u);if(i){if(o===2)return[u,null];const v=Math.floor(o/2);return[[u[0],u[0]+v],[u[0]+v,u[1]]]}if(o===1)return[u,null];const f=Math.floor(o/2)-1;return[[u[0],u[0]+f],[u[0]+f+1,u[1]]]}function ql(u,i){if(!mo(i,u.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let f=i[0];f<=i[1];++f)Vt(o,u[f]);return o}function xh(u){const i=[1/0,1/0,-1/0,-1/0];for(const o of u)for(const f of o)Vt(i,f);return i}function Mc(u){return u[0]!==-1/0&&u[1]!==-1/0&&u[2]!==1/0&&u[3]!==1/0}function wh(u,i,o){if(!Mc(u)||!Mc(i))return NaN;let f=0,v=0;return u[2]<i[0]&&(f=i[0]-u[2]),u[0]>i[2]&&(f=u[0]-i[2]),u[1]>i[3]&&(v=u[1]-i[3]),u[3]<i[1]&&(v=i[1]-u[3]),o.distance([0,0],[f,v])}function $l(u,i,o){const f=o.pointOnLine(i,u);return o.distance(u,f.point)}function cl(u,i,o,f,v){const T=Math.min($l(u,[o,f],v),$l(i,[o,f],v)),S=Math.min($l(o,[u,i],v),$l(f,[u,i],v));return Math.min(T,S)}function Pc(u,i,o,f,v){if(!mo(i,u.length)||!mo(f,o.length))return 1/0;let T=1/0;for(let S=i[0];S<i[1];++S){const C=u[S],k=u[S+1];for(let z=f[0];z<f[1];++z){const N=o[z],j=o[z+1];if(Hn(C,k,N,j))return 0;T=Math.min(T,cl(C,k,N,j,v))}}return T}function Df(u,i,o,f,v){if(!mo(i,u.length)||!mo(f,o.length))return NaN;let T=1/0;for(let S=i[0];S<=i[1];++S)for(let C=f[0];C<=f[1];++C)if(T=Math.min(T,v.distance(u[S],o[C])),T===0)return T;return T}function em(u,i,o){if(ei(u,i,!0))return 0;let f=1/0;for(const v of i){const T=v[0],S=v[v.length-1];if(T!==S&&(f=Math.min(f,$l(u,[S,T],o)),f===0))return f;const C=o.pointOnLine(v,u);if(f=Math.min(f,o.distance(u,C.point)),f===0)return f}return f}function Cu(u,i,o,f){if(!mo(i,u.length))return NaN;for(let T=i[0];T<=i[1];++T)if(ei(u[T],o,!0))return 0;let v=1/0;for(let T=i[0];T<i[1];++T){const S=u[T],C=u[T+1];for(const k of o)for(let z=0,N=k.length,j=N-1;z<N;j=z++){const G=k[j],Y=k[z];if(Hn(S,C,G,Y))return 0;v=Math.min(v,cl(S,C,G,Y,f))}}return v}function Lf(u,i){for(const o of u)for(const f of o)if(ei(f,i,!0))return!0;return!1}function tm(u,i,o,f=1/0){const v=xh(u),T=xh(i);if(f!==1/0&&wh(v,T,o)>=f)return f;if(Gn(v,T)){if(Lf(u,i))return 0}else if(Lf(i,u))return 0;let S=1/0;for(const C of u)for(let k=0,z=C.length,N=z-1;k<z;N=k++){const j=C[N],G=C[k];for(const Y of i)for(let J=0,te=Y.length,le=te-1;J<te;le=J++){const ge=Y[le],Ne=Y[J];if(Hn(j,G,ge,Ne))return 0;S=Math.min(S,cl(j,G,ge,Ne,o))}}return S}function zf(u,i,o,f,v,T){if(!T)return;const S=wh(ql(f,T),v,o);S<i&&u.push([S,T,[0,0]])}function _d(u,i,o,f,v,T,S){if(!T||!S)return;const C=wh(ql(f,T),ql(v,S),o);C<i&&u.push([C,T,S])}function vd(u,i,o,f,v=1/0){let T=Math.min(f.distance(u[0],o[0][0]),v);if(T===0)return T;const S=new Pf([[0,[0,u.length-1],[0,0]]],nr),C=xh(o);for(;S.length>0;){const k=S.pop();if(k[0]>=T)continue;const z=k[1],N=i?50:100;if(bh(z)<=N){if(!mo(z,u.length))return NaN;if(i){const j=Cu(u,z,o,f);if(isNaN(j)||j===0)return j;T=Math.min(T,j)}else for(let j=z[0];j<=z[1];++j){const G=em(u[j],o,f);if(T=Math.min(T,G),T===0)return 0}}else{const j=kf(z,i);zf(S,T,f,u,C,j[0]),zf(S,T,f,u,C,j[1])}}return T}function bd(u,i,o,f,v,T=1/0){let S=Math.min(T,v.distance(u[0],o[0]));if(S===0)return S;const C=new Pf([[0,[0,u.length-1],[0,o.length-1]]],nr);for(;C.length>0;){const k=C.pop();if(k[0]>=S)continue;const z=k[1],N=k[2],j=i?50:100,G=f?50:100;if(bh(z)<=j&&bh(N)<=G){if(!mo(z,u.length)&&mo(N,o.length))return NaN;let Y;if(i&&f)Y=Pc(u,z,o,N,v),S=Math.min(S,Y);else if(i&&!f){const J=u.slice(z[0],z[1]+1);for(let te=N[0];te<=N[1];++te)if(Y=$l(o[te],J,v),S=Math.min(S,Y),S===0)return S}else if(!i&&f){const J=o.slice(N[0],N[1]+1);for(let te=z[0];te<=z[1];++te)if(Y=$l(u[te],J,v),S=Math.min(S,Y),S===0)return S}else Y=Df(u,z,o,N,v),S=Math.min(S,Y)}else{const Y=kf(z,i),J=kf(N,f);_d(C,S,v,u,o,Y[0],J[0]),_d(C,S,v,u,o,Y[0],J[1]),_d(C,S,v,u,o,Y[1],J[0]),_d(C,S,v,u,o,Y[1],J[1])}}return S}function xd(u){return u.type==="MultiPolygon"?u.coordinates.map(i=>({type:"Polygon",coordinates:i})):u.type==="MultiLineString"?u.coordinates.map(i=>({type:"LineString",coordinates:i})):u.type==="MultiPoint"?u.coordinates.map(i=>({type:"Point",coordinates:i})):[u]}class Gl{constructor(i,o){this.type=Dt,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Ta(i[1])){const f=i[1];if(f.type==="FeatureCollection")return new Gl(f,f.features.map(v=>xd(v.geometry)).flat());if(f.type==="Feature")return new Gl(f,xd(f.geometry));if("type"in f&&"coordinates"in f)return new Gl(f,xd(f))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,f){const v=o.geometry(),T=v.flat().map(k=>pt([k.x,k.y],o.canonical));if(v.length===0)return NaN;const S=new yd(T[0][1]);let C=1/0;for(const k of f){switch(k.type){case"Point":C=Math.min(C,bd(T,!1,[k.coordinates],!1,S,C));break;case"LineString":C=Math.min(C,bd(T,!1,k.coordinates,!0,S,C));break;case"Polygon":C=Math.min(C,vd(T,!1,k.coordinates,S,C))}if(C===0)return C}return C}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,f){const v=o.geometry(),T=v.flat().map(k=>pt([k.x,k.y],o.canonical));if(v.length===0)return NaN;const S=new yd(T[0][1]);let C=1/0;for(const k of f){switch(k.type){case"Point":C=Math.min(C,bd(T,!0,[k.coordinates],!1,S,C));break;case"LineString":C=Math.min(C,bd(T,!0,k.coordinates,!0,S,C));break;case"Polygon":C=Math.min(C,vd(T,!0,k.coordinates,S,C))}if(C===0)return C}return C}(i,this.geometries);if(i.geometryType()==="Polygon")return function(o,f){const v=o.geometry();if(v.length===0||v[0].length===0)return NaN;const T=gd(v,0).map(k=>k.map(z=>z.map(N=>pt([N.x,N.y],o.canonical)))),S=new yd(T[0][0][0][1]);let C=1/0;for(const k of f)for(const z of T){switch(k.type){case"Point":C=Math.min(C,vd([k.coordinates],!1,z,S,C));break;case"LineString":C=Math.min(C,vd(k.coordinates,!0,z,S,C));break;case"Polygon":C=Math.min(C,tm(z,k.coordinates,S,C))}if(C===0)return C}return C}(i,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Iu{constructor(i){this.type=yn,this.key=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=i[1];return f==null?o.error("Global state property must be defined."):typeof f!="string"?o.error(`Global state property must be string, but found ${typeof i[1]} instead.`):new Iu(f)}evaluate(i){var o;const f=(o=i.globals)===null||o===void 0?void 0:o.globalState;return f&&Object.keys(f).length!==0?Ln(f,this.key):null}eachChild(){}outputDefined(){return!1}}const Ea={"==":Sc,"!=":fd,">":Ec,"<":pd,">=":Eu,"<=":Fa,array:ia,at:Oi,boolean:ia,case:Xr,coalesce:da,collator:Au,format:A,image:V,in:Vs,"index-of":Bo,interpolate:_i,"interpolate-hcl":_i,"interpolate-lab":_i,length:Z,let:Sa,literal:Dn,match:Fo,number:ia,"number-format":ms,object:ia,slice:Bl,step:Fl,string:ia,"to-boolean":Ba,"to-color":Ba,"to-number":Ba,"to-string":Ba,var:Qa,within:Ul,distance:Gl,"global-state":Iu};class gs{constructor(i,o,f,v){this.name=i,this.type=o,this._evaluate=f,this.args=v}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,o){const f=i[0],v=gs.definitions[f];if(!v)return o.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(v)?v[0]:v.type,S=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,C=S.filter(([z])=>!Array.isArray(z)||z.length===i.length-1);let k=null;for(const[z,N]of C){k=new fo(o.registry,Mu,o.path,null,o.scope);const j=[];let G=!1;for(let Y=1;Y<i.length;Y++){const J=i[Y],te=Array.isArray(z)?z[Y-1]:z.type,le=k.parse(J,1+j.length,te);if(!le){G=!0;break}j.push(le)}if(!G)if(Array.isArray(z)&&z.length!==j.length)k.error(`Expected ${z.length} arguments, but found ${j.length} instead.`);else{for(let Y=0;Y<j.length;Y++){const J=Array.isArray(z)?z[Y]:z.type,te=j[Y];k.concat(Y+1).checkSubtype(J,te.type)}if(k.errors.length===0)return new gs(f,T,N,j)}}if(C.length===1)o.errors.push(...k.errors);else{const z=(C.length?C:S).map(([j])=>{return G=j,Array.isArray(G)?`(${G.map(Dr).join(", ")})`:`(${Dr(G.type)}...)`;var G}).join(" | "),N=[];for(let j=1;j<i.length;j++){const G=o.parse(i[j],1+N.length);if(!G)return null;N.push(Dr(G.type))}o.error(`Expected arguments of type ${z}, but found (${N.join(", ")}) instead.`)}return null}static register(i,o){gs.definitions=o;for(const f in o)i[f]=gs}}function ys(u,[i,o,f,v]){i=i.evaluate(u),o=o.evaluate(u),f=f.evaluate(u);const T=v?v.evaluate(u):1,S=mn(i,o,f,T);if(S)throw new pr(S);return new wn(i/255,o/255,f/255,T,!1)}function _s(u,i){return u in i}function Hl(u,i){const o=i[u];return o===void 0?null:o}function hl(u){return{type:u}}function Mu(u){if(u instanceof Qa)return Mu(u.boundExpression);if(u instanceof gs&&u.name==="error"||u instanceof Au||u instanceof Ul||u instanceof Gl||u instanceof Iu)return!1;const i=u instanceof Ba||u instanceof ia;let o=!0;return u.eachChild(f=>{o=i?o&&Mu(f):o&&f instanceof Dn}),!!o&&Pu(u)&&go(u,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Pu(u){if(u instanceof gs&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Ul||u instanceof Gl)return!1;let i=!0;return u.eachChild(o=>{i&&!Pu(o)&&(i=!1)}),i}function Ru(u){if(u instanceof gs&&u.name==="feature-state")return!1;let i=!0;return u.eachChild(o=>{i&&!Ru(o)&&(i=!1)}),i}function go(u,i){if(u instanceof gs&&i.indexOf(u.name)>=0)return!1;let o=!0;return u.eachChild(f=>{o&&!go(f,i)&&(o=!1)}),o}function Of(u){return{result:"success",value:u}}function dl(u){return{result:"error",value:u}}function yo(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function Nf(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function Va(u){return!!u.expression&&u.expression.interpolated}function zn(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function ja(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)&&ln(u)===ki}function Bf(u){return u}function Th(u,i){const o=u.stops&&typeof u.stops[0][0]=="object",f=o||!(o||u.property!==void 0),v=u.type||(Va(i)?"exponential":"interval"),T=function(N){switch(N.type){case"color":return wn.parse;case"padding":return Ur.parse;case"numberArray":return qr.parse;case"colorArray":return Er.parse;default:return null}}(i);if(T&&((u=ai({},u)).stops&&(u.stops=u.stops.map(N=>[N[0],T(N[1])])),u.default=T(u.default?u.default:i.default)),u.colorSpace&&(S=u.colorSpace)!=="rgb"&&S!=="hcl"&&S!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var S;const C=function(N){switch(N){case"exponential":return ku;case"interval":return Vf;case"categorical":return Ff;case"identity":return Du;default:throw new Error(`Unknown function type "${N}"`)}}(v);let k,z;if(v==="categorical"){k=Object.create(null);for(const N of u.stops)k[N[0]]=N[1];z=typeof u.stops[0][0]}if(o){const N={},j=[];for(let J=0;J<u.stops.length;J++){const te=u.stops[J],le=te[0].zoom;N[le]===void 0&&(N[le]={zoom:le,type:u.type,property:u.property,default:u.default,stops:[]},j.push(le)),N[le].stops.push([te[0].value,te[1]])}const G=[];for(const J of j)G.push([N[J].zoom,Th(N[J],i)]);const Y={name:"linear"};return{kind:"composite",interpolationType:Y,interpolationFactor:_i.interpolationFactor.bind(void 0,Y),zoomStops:G.map(J=>J[0]),evaluate:({zoom:J},te)=>ku({stops:G,base:u.base},i,J).evaluate(J,te)}}if(f){const N=v==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:_i.interpolationFactor.bind(void 0,N),zoomStops:u.stops.map(j=>j[0]),evaluate:({zoom:j})=>C(u,i,j,k,z)}}return{kind:"source",evaluate(N,j){const G=j&&j.properties?j.properties[u.property]:void 0;return G===void 0?_o(u.default,i.default):C(u,i,G,k,z)}}}function _o(u,i,o){return u!==void 0?u:i!==void 0?i:o!==void 0?o:void 0}function Ff(u,i,o,f,v){return _o(typeof o===v?f[o]:void 0,u.default,i.default)}function Vf(u,i,o){if(zn(o)!=="number")return _o(u.default,i.default);const f=u.stops.length;if(f===1||o<=u.stops[0][0])return u.stops[0][1];if(o>=u.stops[f-1][0])return u.stops[f-1][1];const v=po(u.stops.map(T=>T[0]),o);return u.stops[v][1]}function ku(u,i,o){const f=u.base!==void 0?u.base:1;if(zn(o)!=="number")return _o(u.default,i.default);const v=u.stops.length;if(v===1||o<=u.stops[0][0])return u.stops[0][1];if(o>=u.stops[v-1][0])return u.stops[v-1][1];const T=po(u.stops.map(N=>N[0]),o),S=function(N,j,G,Y){const J=Y-G,te=N-G;return J===0?0:j===1?te/J:(Math.pow(j,te)-1)/(Math.pow(j,J)-1)}(o,f,u.stops[T][0],u.stops[T+1][0]),C=u.stops[T][1],k=u.stops[T+1][1],z=aa[i.type]||Bf;return typeof C.evaluate=="function"?{evaluate(...N){const j=C.evaluate.apply(void 0,N),G=k.evaluate.apply(void 0,N);if(j!==void 0&&G!==void 0)return z(j,G,S,u.colorSpace)}}:z(C,k,S,u.colorSpace)}function Du(u,i,o){switch(i.type){case"color":o=wn.parse(o);break;case"formatted":o=Hi.fromString(o.toString());break;case"resolvedImage":o=fi.fromString(o.toString());break;case"padding":o=Ur.parse(o);break;case"colorArray":o=Er.parse(o);break;case"numberArray":o=qr.parse(o);break;default:zn(o)===i.type||i.type==="enum"&&i.values[o]||(o=void 0)}return _o(o,u.default,i.default)}gs.register(Ea,{error:[{kind:"error"},[hn],(u,[i])=>{throw new pr(i.evaluate(u))}],typeof:[hn,[yn],(u,[i])=>Dr(ln(i.evaluate(u)))],"to-rgba":[Gi(Dt,4),[ha],(u,[i])=>{const[o,f,v,T]=i.evaluate(u).rgb;return[255*o,255*f,255*v,T]}],rgb:[ha,[Dt,Dt,Dt],ys],rgba:[ha,[Dt,Dt,Dt,Dt],ys],has:{type:nn,overloads:[[[hn],(u,[i])=>_s(i.evaluate(u),u.properties())],[[hn,ki],(u,[i,o])=>_s(i.evaluate(u),o.evaluate(u))]]},get:{type:yn,overloads:[[[hn],(u,[i])=>Hl(i.evaluate(u),u.properties())],[[hn,ki],(u,[i,o])=>Hl(i.evaluate(u),o.evaluate(u))]]},"feature-state":[yn,[hn],(u,[i])=>Hl(i.evaluate(u),u.featureState||{})],properties:[ki,[],u=>u.properties()],"geometry-type":[hn,[],u=>u.geometryType()],id:[yn,[],u=>u.id()],zoom:[Dt,[],u=>u.globals.zoom],"heatmap-density":[Dt,[],u=>u.globals.heatmapDensity||0],elevation:[Dt,[],u=>u.globals.elevation||0],"line-progress":[Dt,[],u=>u.globals.lineProgress||0],accumulated:[yn,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Dt,hl(Dt),(u,i)=>{let o=0;for(const f of i)o+=f.evaluate(u);return o}],"*":[Dt,hl(Dt),(u,i)=>{let o=1;for(const f of i)o*=f.evaluate(u);return o}],"-":{type:Dt,overloads:[[[Dt,Dt],(u,[i,o])=>i.evaluate(u)-o.evaluate(u)],[[Dt],(u,[i])=>-i.evaluate(u)]]},"/":[Dt,[Dt,Dt],(u,[i,o])=>i.evaluate(u)/o.evaluate(u)],"%":[Dt,[Dt,Dt],(u,[i,o])=>i.evaluate(u)%o.evaluate(u)],ln2:[Dt,[],()=>Math.LN2],pi:[Dt,[],()=>Math.PI],e:[Dt,[],()=>Math.E],"^":[Dt,[Dt,Dt],(u,[i,o])=>Math.pow(i.evaluate(u),o.evaluate(u))],sqrt:[Dt,[Dt],(u,[i])=>Math.sqrt(i.evaluate(u))],log10:[Dt,[Dt],(u,[i])=>Math.log(i.evaluate(u))/Math.LN10],ln:[Dt,[Dt],(u,[i])=>Math.log(i.evaluate(u))],log2:[Dt,[Dt],(u,[i])=>Math.log(i.evaluate(u))/Math.LN2],sin:[Dt,[Dt],(u,[i])=>Math.sin(i.evaluate(u))],cos:[Dt,[Dt],(u,[i])=>Math.cos(i.evaluate(u))],tan:[Dt,[Dt],(u,[i])=>Math.tan(i.evaluate(u))],asin:[Dt,[Dt],(u,[i])=>Math.asin(i.evaluate(u))],acos:[Dt,[Dt],(u,[i])=>Math.acos(i.evaluate(u))],atan:[Dt,[Dt],(u,[i])=>Math.atan(i.evaluate(u))],min:[Dt,hl(Dt),(u,i)=>Math.min(...i.map(o=>o.evaluate(u)))],max:[Dt,hl(Dt),(u,i)=>Math.max(...i.map(o=>o.evaluate(u)))],abs:[Dt,[Dt],(u,[i])=>Math.abs(i.evaluate(u))],round:[Dt,[Dt],(u,[i])=>{const o=i.evaluate(u);return o<0?-Math.round(-o):Math.round(o)}],floor:[Dt,[Dt],(u,[i])=>Math.floor(i.evaluate(u))],ceil:[Dt,[Dt],(u,[i])=>Math.ceil(i.evaluate(u))],"filter-==":[nn,[hn,yn],(u,[i,o])=>u.properties()[i.value]===o.value],"filter-id-==":[nn,[yn],(u,[i])=>u.id()===i.value],"filter-type-==":[nn,[hn],(u,[i])=>u.geometryType()===i.value],"filter-<":[nn,[hn,yn],(u,[i,o])=>{const f=u.properties()[i.value],v=o.value;return typeof f==typeof v&&f<v}],"filter-id-<":[nn,[yn],(u,[i])=>{const o=u.id(),f=i.value;return typeof o==typeof f&&o<f}],"filter->":[nn,[hn,yn],(u,[i,o])=>{const f=u.properties()[i.value],v=o.value;return typeof f==typeof v&&f>v}],"filter-id->":[nn,[yn],(u,[i])=>{const o=u.id(),f=i.value;return typeof o==typeof f&&o>f}],"filter-<=":[nn,[hn,yn],(u,[i,o])=>{const f=u.properties()[i.value],v=o.value;return typeof f==typeof v&&f<=v}],"filter-id-<=":[nn,[yn],(u,[i])=>{const o=u.id(),f=i.value;return typeof o==typeof f&&o<=f}],"filter->=":[nn,[hn,yn],(u,[i,o])=>{const f=u.properties()[i.value],v=o.value;return typeof f==typeof v&&f>=v}],"filter-id->=":[nn,[yn],(u,[i])=>{const o=u.id(),f=i.value;return typeof o==typeof f&&o>=f}],"filter-has":[nn,[yn],(u,[i])=>i.value in u.properties()],"filter-has-id":[nn,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[nn,[Gi(hn)],(u,[i])=>i.value.indexOf(u.geometryType())>=0],"filter-id-in":[nn,[Gi(yn)],(u,[i])=>i.value.indexOf(u.id())>=0],"filter-in-small":[nn,[hn,Gi(yn)],(u,[i,o])=>o.value.indexOf(u.properties()[i.value])>=0],"filter-in-large":[nn,[hn,Gi(yn)],(u,[i,o])=>function(f,v,T,S){for(;T<=S;){const C=T+S>>1;if(v[C]===f)return!0;v[C]>f?S=C-1:T=C+1}return!1}(u.properties()[i.value],o.value,0,o.value.length-1)],all:{type:nn,overloads:[[[nn,nn],(u,[i,o])=>i.evaluate(u)&&o.evaluate(u)],[hl(nn),(u,i)=>{for(const o of i)if(!o.evaluate(u))return!1;return!0}]]},any:{type:nn,overloads:[[[nn,nn],(u,[i,o])=>i.evaluate(u)||o.evaluate(u)],[hl(nn),(u,i)=>{for(const o of i)if(o.evaluate(u))return!0;return!1}]]},"!":[nn,[nn],(u,[i])=>!i.evaluate(u)],"is-supported-script":[nn,[hn],(u,[i])=>{const o=u.globals&&u.globals.isSupportedScript;return!o||o(i.evaluate(u))}],upcase:[hn,[hn],(u,[i])=>i.evaluate(u).toUpperCase()],downcase:[hn,[hn],(u,[i])=>i.evaluate(u).toLowerCase()],concat:[hn,hl(yn),(u,i)=>i.map(o=>Jr(o.evaluate(u))).join("")],"resolved-locale":[hn,[Os],(u,[i])=>i.evaluate(u).resolvedLocale()]});class Lu{constructor(i,o){this.expression=i,this._warningHistory={},this._evaluator=new ho,this._defaultValue=o?function(f){if(f.type==="color"&&ja(f.default))return new wn(0,0,0,0);switch(f.type){case"color":return wn.parse(f.default)||null;case"padding":return Ur.parse(f.default)||null;case"numberArray":return qr.parse(f.default)||null;case"colorArray":return Er.parse(f.default)||null;case"variableAnchorOffsetCollection":return In.parse(f.default)||null;case"projectionDefinition":return _n.parse(f.default)||null;default:return f.default===void 0?null:f.default}}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(i,o,f,v,T,S){return this._evaluator.globals=i,this._evaluator.feature=o,this._evaluator.featureState=f,this._evaluator.canonical=v,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(i,o,f,v,T,S){this._evaluator.globals=i,this._evaluator.feature=o||null,this._evaluator.featureState=f||null,this._evaluator.canonical=v,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new pr(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function zu(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in Ea}function Ua(u,i){const o=new fo(Ea,Mu,[],i?function(v){const T={color:ha,string:hn,number:Dt,enum:hn,boolean:nn,formatted:Do,padding:kr,numberArray:Ns,colorArray:Ll,projectionDefinition:il,resolvedImage:ra,variableAnchorOffsetCollection:yi};return v.type==="array"?Gi(T[v.value]||yn,v.length):T[v.type]}(i):void 0),f=o.parse(u,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Of(new Lu(f,i)):dl(o.errors)}class Aa{constructor(i,o){this.kind=i,this._styleExpression=o,this.isStateDependent=i!=="constant"&&!Ru(o.expression),this.globalStateRefs=Ou(o.expression)}evaluateWithoutErrorHandling(i,o,f,v,T,S){return this._styleExpression.evaluateWithoutErrorHandling(i,o,f,v,T,S)}evaluate(i,o,f,v,T,S){return this._styleExpression.evaluate(i,o,f,v,T,S)}}class jo{constructor(i,o,f,v){this.kind=i,this.zoomStops=f,this._styleExpression=o,this.isStateDependent=i!=="camera"&&!Ru(o.expression),this.globalStateRefs=Ou(o.expression),this.interpolationType=v}evaluateWithoutErrorHandling(i,o,f,v,T,S){return this._styleExpression.evaluateWithoutErrorHandling(i,o,f,v,T,S)}evaluate(i,o,f,v,T,S){return this._styleExpression.evaluate(i,o,f,v,T,S)}interpolationFactor(i,o,f){return this.interpolationType?_i.interpolationFactor(this.interpolationType,i,o,f):0}}function vo(u,i){const o=Ua(u,i);if(o.result==="error")return o;const f=o.value.expression,v=Pu(f);if(!v&&!yo(i))return dl([new cr("","data expressions not supported")]);const T=go(f,["zoom"]);if(!T&&!Nf(i))return dl([new cr("","zoom expressions not supported")]);const S=js(f);return S||T?S instanceof cr?dl([S]):S instanceof _i&&!Va(i)?dl([new cr("",'"interpolate" expressions cannot be used with this property')]):Of(S?new jo(v?"camera":"composite",o.value,S.labels,S instanceof _i?S.interpolation:void 0):new Aa(v?"constant":"source",o.value)):dl([new cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class vs{constructor(i,o){this._parameters=i,this._specification=o,ai(this,Th(this._parameters,this._specification))}static deserialize(i){return new vs(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function js(u){let i=null;if(u instanceof Sa)i=js(u.result);else if(u instanceof da){for(const o of u.args)if(i=js(o),i)break}else(u instanceof Fl||u instanceof _i)&&u.input instanceof gs&&u.input.name==="zoom"&&(i=u);return i instanceof cr||u.eachChild(o=>{const f=js(o);f instanceof cr?i=f:!i&&f?i=new cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&f&&i!==f&&(i=new cr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function Ou(u,i=new Set){return u instanceof Iu&&i.add(u.key),u.eachChild(o=>{Ou(o,i)}),i}function Nu(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const i of u.slice(1))if(!Nu(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const Sh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function pi(u){if(u==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Nu(u)||(u=Uo(u));const i=Ua(u,Sh);if(i.result==="error")throw new Error(i.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,f,v)=>i.value.evaluate(o,f,{},v),needGeometry:or(u),getGlobalStateRefs:()=>Ou(i.value.expression)}}function mi(u,i){return u<i?-1:u>i?1:0}function or(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let i=1;i<u.length;i++)if(or(u[i]))return!0;return!1}function Uo(u){if(!u)return!0;const i=u[0];return u.length<=1?i!=="any":i==="=="?Us(u[1],u[2],"=="):i==="!="?Rc(Us(u[1],u[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Us(u[1],u[2],i):i==="any"?(o=u.slice(1),["any"].concat(o.map(Uo))):i==="all"?["all"].concat(u.slice(1).map(Uo)):i==="none"?["all"].concat(u.slice(1).map(Uo).map(Rc)):i==="in"?wd(u[1],u.slice(2)):i==="!in"?Rc(wd(u[1],u.slice(2))):i==="has"?Zl(u[1]):i!=="!has"||Rc(Zl(u[1]));var o}function Us(u,i,o){switch(u){case"$type":return[`filter-type-${o}`,i];case"$id":return[`filter-id-${o}`,i];default:return[`filter-${o}`,u,i]}}function wd(u,i){if(i.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(o=>typeof o!=typeof i[0])?["filter-in-large",u,["literal",i.sort(mi)]]:["filter-in-small",u,["literal",i]]}}function Zl(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Rc(u){return["!",u]}function Eh(u){const i=typeof u;if(i==="number"||i==="boolean"||i==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let v="[";for(const T of u)v+=`${Eh(T)},`;return`${v}]`}const o=Object.keys(u).sort();let f="{";for(let v=0;v<o.length;v++)f+=`${JSON.stringify(o[v])}:${Eh(u[o[v]])},`;return`${f}}`}function Wl(u){let i="";for(const o of Ot)i+=`/${Eh(u[o])}`;return i}function kc(u){const i=u.value;return i?[new kt(u.key,i,"constants have been deprecated as of v8")]:[]}function ti(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function qs(u){if(Array.isArray(u))return u.map(qs);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const i={};for(const o in u)i[o]=qs(u[o]);return i}return ti(u)}function ts(u){const i=u.key,o=u.value,f=u.valueSpec||{},v=u.objectElementValidators||{},T=u.style,S=u.styleSpec,C=u.validateSpec;let k=[];const z=zn(o);if(z!=="object")return[new kt(i,o,`object expected, ${z} found`)];for(const N in o){const j=N.split(".")[0],G=Ln(f,j)||f["*"];let Y;if(Ln(v,j))Y=v[j];else if(Ln(f,j))Y=C;else if(v["*"])Y=v["*"];else{if(!f["*"]){k.push(new kt(i,o[N],`unknown property "${N}"`));continue}Y=C}k=k.concat(Y({key:(i&&`${i}.`)+N,value:o[N],valueSpec:G,style:T,styleSpec:S,object:o,objectKey:N,validateSpec:C},o))}for(const N in f)v[N]||f[N].required&&f[N].default===void 0&&o[N]===void 0&&k.push(new kt(i,o,`missing required property "${N}"`));return k}function qo(u){const i=u.value,o=u.valueSpec,f=u.style,v=u.styleSpec,T=u.key,S=u.arrayElementValidator||u.validateSpec;if(zn(i)!=="array")return[new kt(T,i,`array expected, ${zn(i)} found`)];if(o.length&&i.length!==o.length)return[new kt(T,i,`array length ${o.length} expected, length ${i.length} found`)];if(o["min-length"]&&i.length<o["min-length"])return[new kt(T,i,`array length at least ${o["min-length"]} expected, length ${i.length} found`)];let C={type:o.value,values:o.values};v.$version<7&&(C.function=o.function),zn(o.value)==="object"&&(C=o.value);let k=[];for(let z=0;z<i.length;z++)k=k.concat(S({array:i,arrayIndex:z,value:i[z],valueSpec:C,validateSpec:u.validateSpec,style:f,styleSpec:v,key:`${T}[${z}]`}));return k}function bs(u){const i=u.key,o=u.value,f=u.valueSpec;let v=zn(o);return v==="number"&&o!=o&&(v="NaN"),v!=="number"?[new kt(i,o,`number expected, ${v} found`)]:"minimum"in f&&o<f.minimum?[new kt(i,o,`${o} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&o>f.maximum?[new kt(i,o,`${o} is greater than the maximum value ${f.maximum}`)]:[]}function xs(u){const i=u.valueSpec,o=ti(u.value.type);let f,v,T,S={};const C=o!=="categorical"&&u.value.property===void 0,k=!C,z=zn(u.value.stops)==="array"&&zn(u.value.stops[0])==="array"&&zn(u.value.stops[0][0])==="object",N=ts({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(Y){if(o==="identity")return[new kt(Y.key,Y.value,'identity function may not have a "stops" property')];let J=[];const te=Y.value;return J=J.concat(qo({key:Y.key,value:te,valueSpec:Y.valueSpec,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:j})),zn(te)==="array"&&te.length===0&&J.push(new kt(Y.key,te,"array must have at least one stop")),J},default:function(Y){return Y.validateSpec({key:Y.key,value:Y.value,valueSpec:i,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec})}}});return o==="identity"&&C&&N.push(new kt(u.key,u.value,'missing required property "property"')),o==="identity"||u.value.stops||N.push(new kt(u.key,u.value,'missing required property "stops"')),o==="exponential"&&u.valueSpec.expression&&!Va(u.valueSpec)&&N.push(new kt(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(k&&!yo(u.valueSpec)?N.push(new kt(u.key,u.value,"property functions not supported")):C&&!Nf(u.valueSpec)&&N.push(new kt(u.key,u.value,"zoom functions not supported"))),o!=="categorical"&&!z||u.value.property!==void 0||N.push(new kt(u.key,u.value,'"property" property is required')),N;function j(Y){let J=[];const te=Y.value,le=Y.key;if(zn(te)!=="array")return[new kt(le,te,`array expected, ${zn(te)} found`)];if(te.length!==2)return[new kt(le,te,`array length 2 expected, length ${te.length} found`)];if(z){if(zn(te[0])!=="object")return[new kt(le,te,`object expected, ${zn(te[0])} found`)];if(te[0].zoom===void 0)return[new kt(le,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new kt(le,te,"object stop key must have value")];if(T&&T>ti(te[0].zoom))return[new kt(le,te[0].zoom,"stop zoom values must appear in ascending order")];ti(te[0].zoom)!==T&&(T=ti(te[0].zoom),v=void 0,S={}),J=J.concat(ts({key:`${le}[0]`,value:te[0],valueSpec:{zoom:{}},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:bs,value:G}}))}else J=J.concat(G({key:`${le}[0]`,value:te[0],validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec},te));return zu(qs(te[1]))?J.concat([new kt(`${le}[1]`,te[1],"expressions are not allowed in function stops.")]):J.concat(Y.validateSpec({key:`${le}[1]`,value:te[1],valueSpec:i,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec}))}function G(Y,J){const te=zn(Y.value),le=ti(Y.value),ge=Y.value!==null?Y.value:J;if(f){if(te!==f)return[new kt(Y.key,ge,`${te} stop domain type must match previous stop domain type ${f}`)]}else f=te;if(te!=="number"&&te!=="string"&&te!=="boolean")return[new kt(Y.key,ge,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&o!=="categorical"){let Ne=`number expected, ${te} found`;return yo(i)&&o===void 0&&(Ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new kt(Y.key,ge,Ne)]}return o!=="categorical"||te!=="number"||isFinite(le)&&Math.floor(le)===le?o!=="categorical"&&te==="number"&&v!==void 0&&le<v?[new kt(Y.key,ge,"stop domain values must appear in ascending order")]:(v=le,o==="categorical"&&le in S?[new kt(Y.key,ge,"stop domain values must be unique")]:(S[le]=!0,[])):[new kt(Y.key,ge,`integer expected, found ${le}`)]}}function ns(u){const i=(u.expressionContext==="property"?vo:Ua)(qs(u.value),u.valueSpec);if(i.result==="error")return i.value.map(f=>new kt(`${u.key}${f.key}`,u.value,f.message));const o=i.value.expression||i.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!o.outputDefined())return[new kt(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!Ru(o))return[new kt(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!Ru(o))return[new kt(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!go(o,["zoom","feature-state"]))return[new kt(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!Pu(o))return[new kt(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ah(u){const i=u.key,o=u.value,f=zn(o);return f!=="string"?[new kt(i,o,`color expected, ${f} found`)]:wn.parse(String(o))?[]:[new kt(i,o,`color expected, "${o}" found`)]}function Bu(u){const i=u.key,o=u.value,f=u.valueSpec,v=[];return Array.isArray(f.values)?f.values.indexOf(ti(o))===-1&&v.push(new kt(i,o,`expected one of [${f.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(f.values).indexOf(ti(o))===-1&&v.push(new kt(i,o,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(o)} found`)),v}function Fu(u){return Nu(qs(u.value))?ns(ai({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ch(u)}function Ch(u){const i=u.value,o=u.key;if(zn(i)!=="array")return[new kt(o,i,`array expected, ${zn(i)} found`)];const f=u.styleSpec;let v,T=[];if(i.length<1)return[new kt(o,i,"filter array must have at least 1 element")];switch(T=T.concat(Bu({key:`${o}[0]`,value:i[0],valueSpec:f.filter_operator,style:u.style,styleSpec:u.styleSpec})),ti(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&ti(i[1])==="$type"&&T.push(new kt(o,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&T.push(new kt(o,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(v=zn(i[1]),v!=="string"&&T.push(new kt(`${o}[1]`,i[1],`string expected, ${v} found`)));for(let S=2;S<i.length;S++)v=zn(i[S]),ti(i[1])==="$type"?T=T.concat(Bu({key:`${o}[${S}]`,value:i[S],valueSpec:f.geometry_type,style:u.style,styleSpec:u.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&T.push(new kt(`${o}[${S}]`,i[S],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let S=1;S<i.length;S++)T=T.concat(Ch({key:`${o}[${S}]`,value:i[S],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":v=zn(i[1]),i.length!==2?T.push(new kt(o,i,`filter array for "${i[0]}" operator must have 2 elements`)):v!=="string"&&T.push(new kt(`${o}[1]`,i[1],`string expected, ${v} found`))}return T}function Kl(u,i){const o=u.key,f=u.validateSpec,v=u.style,T=u.styleSpec,S=u.value,C=u.objectKey,k=T[`${i}_${u.layerType}`];if(!k)return[];const z=C.match(/^(.*)-transition$/);if(i==="paint"&&z&&k[z[1]]&&k[z[1]].transition)return f({key:o,value:S,valueSpec:T.transition,style:v,styleSpec:T});const N=u.valueSpec||k[C];if(!N)return[new kt(o,S,`unknown property "${C}"`)];let j;if(zn(S)==="string"&&yo(N)&&!N.tokens&&(j=/^{([^}]+)}$/.exec(S)))return[new kt(o,S,`"${C}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(j[1])} }\`.`)];const G=[];return u.layerType==="symbol"&&(C==="text-field"&&v&&!v.glyphs&&G.push(new kt(o,S,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&ja(qs(S))&&ti(S.type)==="identity"&&G.push(new kt(o,S,'"text-font" does not support identity functions'))),G.concat(f({key:u.key,value:S,valueSpec:N,style:v,styleSpec:T,expressionContext:"property",propertyType:i,propertyKey:C}))}function vi(u){return Kl(u,"paint")}function fl(u){return Kl(u,"layout")}function qa(u){let i=[];const o=u.value,f=u.key,v=u.style,T=u.styleSpec;if(zn(o)!=="object")return[new kt(f,o,`object expected, ${zn(o)} found`)];o.type||o.ref||i.push(new kt(f,o,'either "type" or "ref" is required'));let S=ti(o.type);const C=ti(o.ref);if(o.id){const k=ti(o.id);for(let z=0;z<u.arrayIndex;z++){const N=v.layers[z];ti(N.id)===k&&i.push(new kt(f,o.id,`duplicate layer id "${o.id}", previously used at line ${N.id.__line__}`))}}if("ref"in o){let k;["type","source","source-layer","filter","layout"].forEach(z=>{z in o&&i.push(new kt(f,o[z],`"${z}" is prohibited for ref layers`))}),v.layers.forEach(z=>{ti(z.id)===C&&(k=z)}),k?k.ref?i.push(new kt(f,o.ref,"ref cannot reference another ref layer")):S=ti(k.type):i.push(new kt(f,o.ref,`ref layer "${C}" not found`))}else if(S!=="background")if(o.source){const k=v.sources&&v.sources[o.source],z=k&&ti(k.type);k?z==="vector"&&S==="raster"?i.push(new kt(f,o.source,`layer "${o.id}" requires a raster source`)):z!=="raster-dem"&&S==="hillshade"||z!=="raster-dem"&&S==="color-relief"?i.push(new kt(f,o.source,`layer "${o.id}" requires a raster-dem source`)):z==="raster"&&S!=="raster"?i.push(new kt(f,o.source,`layer "${o.id}" requires a vector source`)):z!=="vector"||o["source-layer"]?z==="raster-dem"&&S!=="hillshade"&&S!=="color-relief"?i.push(new kt(f,o.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):S!=="line"||!o.paint||!o.paint["line-gradient"]||z==="geojson"&&k.lineMetrics||i.push(new kt(f,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new kt(f,o,`layer "${o.id}" must specify a "source-layer"`)):i.push(new kt(f,o.source,`source "${o.source}" not found`))}else i.push(new kt(f,o,'missing required property "source"'));return i=i.concat(ts({key:f,value:o,valueSpec:T.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${f}.type`,value:o.type,valueSpec:T.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:o,objectKey:"type"}),filter:Fu,layout:k=>ts({layer:o,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":z=>fl(ai({layerType:S},z))}}),paint:k=>ts({layer:o,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":z=>vi(ai({layerType:S},z))}})}})),i}function bo(u){const i=u.value,o=u.key,f=zn(i);return f!=="string"?[new kt(o,i,`string expected, ${f} found`)]:[]}const jf={promoteId:function({key:u,value:i}){if(zn(i)==="string")return bo({key:u,value:i});{const o=[];for(const f in i)o.push(...bo({key:`${u}.${f}`,value:i[f]}));return o}}};function nm(u){const i=u.value,o=u.key,f=u.styleSpec,v=u.style,T=u.validateSpec;if(!i.type)return[new kt(o,i,'"type" is required')];const S=ti(i.type);let C;switch(S){case"vector":case"raster":return C=ts({key:o,value:i,valueSpec:f[`source_${S.replace("-","_")}`],style:u.style,styleSpec:f,objectElementValidators:jf,validateSpec:T}),C;case"raster-dem":return C=function(k){var z;const N=(z=k.sourceName)!==null&&z!==void 0?z:"",j=k.value,G=k.styleSpec,Y=G.source_raster_dem,J=k.style;let te=[];const le=zn(j);if(j===void 0)return te;if(le!=="object")return te.push(new kt("source_raster_dem",j,`object expected, ${le} found`)),te;const ge=ti(j.encoding)==="custom",Ne=["redFactor","greenFactor","blueFactor","baseShift"],Se=k.value.encoding?`"${k.value.encoding}"`:"Default";for(const X in j)!ge&&Ne.includes(X)?te.push(new kt(X,j[X],`In "${N}": "${X}" is only valid when "encoding" is set to "custom". ${Se} encoding found`)):Y[X]?te=te.concat(k.validateSpec({key:X,value:j[X],valueSpec:Y[X],validateSpec:k.validateSpec,style:J,styleSpec:G})):te.push(new kt(X,j[X],`unknown property "${X}"`));return te}({sourceName:o,value:i,style:u.style,styleSpec:f,validateSpec:T}),C;case"geojson":if(C=ts({key:o,value:i,valueSpec:f.source_geojson,style:v,styleSpec:f,validateSpec:T,objectElementValidators:jf}),i.cluster)for(const k in i.clusterProperties){const[z,N]=i.clusterProperties[k],j=typeof z=="string"?[z,["accumulated"],["get",k]]:z;C.push(...ns({key:`${o}.${k}.map`,value:N,expressionContext:"cluster-map"})),C.push(...ns({key:`${o}.${k}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return C;case"video":return ts({key:o,value:i,valueSpec:f.source_video,style:v,validateSpec:T,styleSpec:f});case"image":return ts({key:o,value:i,valueSpec:f.source_image,style:v,validateSpec:T,styleSpec:f});case"canvas":return[new kt(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bu({key:`${o}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Bi(u){const i=u.value,o=u.styleSpec,f=o.light,v=u.style;let T=[];const S=zn(i);if(i===void 0)return T;if(S!=="object")return T=T.concat([new kt("light",i,`object expected, ${S} found`)]),T;for(const C in i){const k=C.match(/^(.*)-transition$/);T=T.concat(k&&f[k[1]]&&f[k[1]].transition?u.validateSpec({key:C,value:i[C],valueSpec:o.transition,validateSpec:u.validateSpec,style:v,styleSpec:o}):f[C]?u.validateSpec({key:C,value:i[C],valueSpec:f[C],validateSpec:u.validateSpec,style:v,styleSpec:o}):[new kt(C,i[C],`unknown property "${C}"`)])}return T}function Xl(u){const i=u.value,o=u.styleSpec,f=o.sky,v=u.style,T=zn(i);if(i===void 0)return[];if(T!=="object")return[new kt("sky",i,`object expected, ${T} found`)];let S=[];for(const C in i)S=S.concat(f[C]?u.validateSpec({key:C,value:i[C],valueSpec:f[C],style:v,styleSpec:o}):[new kt(C,i[C],`unknown property "${C}"`)]);return S}function Vu(u){const i=u.value,o=u.styleSpec,f=o.terrain,v=u.style;let T=[];const S=zn(i);if(i===void 0)return T;if(S!=="object")return T=T.concat([new kt("terrain",i,`object expected, ${S} found`)]),T;for(const C in i)T=T.concat(f[C]?u.validateSpec({key:C,value:i[C],valueSpec:f[C],validateSpec:u.validateSpec,style:v,styleSpec:o}):[new kt(C,i[C],`unknown property "${C}"`)]);return T}function Yl(u){let i=[];const o=u.value,f=u.key;if(Array.isArray(o)){const v=[],T=[];for(const S in o)o[S].id&&v.includes(o[S].id)&&i.push(new kt(f,o,`all the sprites' ids must be unique, but ${o[S].id} is duplicated`)),v.push(o[S].id),o[S].url&&T.includes(o[S].url)&&i.push(new kt(f,o,`all the sprites' URLs must be unique, but ${o[S].url} is duplicated`)),T.push(o[S].url),i=i.concat(ts({key:`${f}[${S}]`,value:o[S],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return i}return bo({key:f,value:o})}function Td(u){return i=u.value,i&&i.constructor===Object?[]:[new kt(u.key,u.value,`object expected, ${zn(u.value)} found`)];var i}const pl={"*":()=>[],array:qo,boolean:function(u){const i=u.value,o=u.key,f=zn(i);return f!=="boolean"?[new kt(o,i,`boolean expected, ${f} found`)]:[]},number:bs,color:Ah,constants:kc,enum:Bu,filter:Fu,function:xs,layer:qa,object:ts,source:nm,light:Bi,sky:Xl,terrain:Vu,projection:function(u){const i=u.value,o=u.styleSpec,f=o.projection,v=u.style,T=zn(i);if(i===void 0)return[];if(T!=="object")return[new kt("projection",i,`object expected, ${T} found`)];let S=[];for(const C in i)S=S.concat(f[C]?u.validateSpec({key:C,value:i[C],valueSpec:f[C],style:v,styleSpec:o}):[new kt(C,i[C],`unknown property "${C}"`)]);return S},projectionDefinition:function(u){const i=u.key;let o=u.value;o=o instanceof String?o.valueOf():o;const f=zn(o);return f!=="array"||function(v){return Array.isArray(v)&&v.length===3&&typeof v[0]=="string"&&typeof v[1]=="string"&&typeof v[2]=="number"}(o)||function(v){return!!["interpolate","step","literal"].includes(v[0])}(o)?["array","string"].includes(f)?[]:[new kt(i,o,`projection expected, invalid type "${f}" found`)]:[new kt(i,o,`projection expected, invalid array ${JSON.stringify(o)} found`)]},string:bo,formatted:function(u){return bo(u).length===0?[]:ns(u)},resolvedImage:function(u){return bo(u).length===0?[]:ns(u)},padding:function(u){const i=u.key,o=u.value;if(zn(o)==="array"){if(o.length<1||o.length>4)return[new kt(i,o,`padding requires 1 to 4 values; ${o.length} values found`)];const f={type:"number"};let v=[];for(let T=0;T<o.length;T++)v=v.concat(u.validateSpec({key:`${i}[${T}]`,value:o[T],validateSpec:u.validateSpec,valueSpec:f}));return v}return bs({key:i,value:o,valueSpec:{}})},numberArray:function(u){const i=u.key,o=u.value;if(zn(o)==="array"){const f={type:"number"};if(o.length<1)return[new kt(i,o,"array length at least 1 expected, length 0 found")];let v=[];for(let T=0;T<o.length;T++)v=v.concat(u.validateSpec({key:`${i}[${T}]`,value:o[T],validateSpec:u.validateSpec,valueSpec:f}));return v}return bs({key:i,value:o,valueSpec:{}})},colorArray:function(u){const i=u.key,o=u.value;if(zn(o)==="array"){if(o.length<1)return[new kt(i,o,"array length at least 1 expected, length 0 found")];let f=[];for(let v=0;v<o.length;v++)f=f.concat(Ah({key:`${i}[${v}]`,value:o[v]}));return f}return Ah({key:i,value:o})},variableAnchorOffsetCollection:function(u){const i=u.key,o=u.value,f=zn(o),v=u.styleSpec;if(f!=="array"||o.length<1||o.length%2!=0)return[new kt(i,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let T=[];for(let S=0;S<o.length;S+=2)T=T.concat(Bu({key:`${i}[${S}]`,value:o[S],valueSpec:v.layout_symbol["text-anchor"]})),T=T.concat(qo({key:`${i}[${S+1}]`,value:o[S+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:v}));return T},sprite:Yl,state:Td};function ml(u){const i=u.value,o=u.valueSpec,f=u.styleSpec;return u.validateSpec=ml,o.expression&&ja(ti(i))?xs(u):o.expression&&zu(qs(i))?ns(u):o.type&&pl[o.type]?pl[o.type](u):ts(ai({},u,{valueSpec:o.type?f[o.type]:o}))}function Dc(u){const i=u.value,o=u.key,f=bo(u);return f.length||(i.indexOf("{fontstack}")===-1&&f.push(new kt(o,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&f.push(new kt(o,i,'"glyphs" url must include a "{range}" token'))),f}function ws(u,i=ze){let o=[];return o=o.concat(ml({key:"",value:u,valueSpec:i.$root,styleSpec:i,style:u,validateSpec:ml,objectElementValidators:{glyphs:Dc,"*":()=>[]}})),u.constants&&(o=o.concat(kc({key:"constants",value:u.constants}))),Uf(o)}function xo(u){return function(i){return u({...i,validateSpec:ml})}}function Uf(u){return[].concat(u).sort((i,o)=>i.line-o.line)}function bi(u){return function(...i){return Uf(u.apply(this,i))}}ws.source=bi(xo(nm)),ws.sprite=bi(xo(Yl)),ws.glyphs=bi(xo(Dc)),ws.light=bi(xo(Bi)),ws.sky=bi(xo(Xl)),ws.terrain=bi(xo(Vu)),ws.state=bi(xo(Td)),ws.layer=bi(xo(qa)),ws.filter=bi(xo(Fu)),ws.paintProperty=bi(xo(vi)),ws.layoutProperty=bi(xo(fl));const Ql=ws,Sd=Ql.light,Ih=Ql.sky,Mh=Ql.paintProperty,Ed=Ql.layoutProperty;function Jl(u,i){let o=!1;if(i&&i.length)for(const f of i)u.fire(new Ke(new Error(f.message))),o=!0;return o}class eu{constructor(i,o,f){const v=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const S=new Int32Array(this.arrayBuffer);i=S[0],this.d=(o=S[1])+2*(f=S[2]);for(let k=0;k<this.d*this.d;k++){const z=S[3+k],N=S[3+k+1];v.push(z===N?null:S.subarray(z,N))}const C=S[3+v.length+1];this.keys=S.subarray(S[3+v.length],C),this.bboxes=S.subarray(C),this.insert=this._insertReadonly}else{this.d=o+2*f;for(let S=0;S<this.d*this.d;S++)v.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=i,this.padding=f,this.scale=o/i,this.uid=0;const T=f/o*i;this.min=-T,this.max=i+T}insert(i,o,f,v,T){this._forEachCell(o,f,v,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(o),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,o,f,v,T,S){this.cells[T].push(S)}query(i,o,f,v,T){const S=this.min,C=this.max;if(i<=S&&o<=S&&C<=f&&C<=v&&!T)return Array.prototype.slice.call(this.keys);{const k=[];return this._forEachCell(i,o,f,v,this._queryCell,k,{},T),k}}_queryCell(i,o,f,v,T,S,C,k){const z=this.cells[T];if(z!==null){const N=this.keys,j=this.bboxes;for(let G=0;G<z.length;G++){const Y=z[G];if(C[Y]===void 0){const J=4*Y;(k?k(j[J+0],j[J+1],j[J+2],j[J+3]):i<=j[J+2]&&o<=j[J+3]&&f>=j[J+0]&&v>=j[J+1])?(C[Y]=!0,S.push(N[Y])):C[Y]=!1}}}}_forEachCell(i,o,f,v,T,S,C,k){const z=this._convertToCellCoord(i),N=this._convertToCellCoord(o),j=this._convertToCellCoord(f),G=this._convertToCellCoord(v);for(let Y=z;Y<=j;Y++)for(let J=N;J<=G;J++){const te=this.d*J+Y;if((!k||k(this._convertFromCellCoord(Y),this._convertFromCellCoord(J),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(J+1)))&&T.call(this,i,o,f,v,te,S,C,k))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,o=3+this.cells.length+1+1;let f=0;for(let S=0;S<this.cells.length;S++)f+=this.cells[S].length;const v=new Int32Array(o+f+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let T=o;for(let S=0;S<i.length;S++){const C=i[S];v[3+S]=T,v.set(C,T),T+=C.length}return v[3+i.length]=T,v.set(this.keys,T),T+=this.keys.length,v[3+i.length+1]=T,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer}static serialize(i,o){const f=i.toArrayBuffer();return o&&o.push(f),{buffer:f}}static deserialize(i){return new eu(i.buffer)}}const wo={};function Ut(u,i,o={}){if(wo[u])throw new Error(`${u} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:u,writeable:!1}),wo[u]={klass:i,omit:o.omit||[],shallow:o.shallow||[]}}Ut("Object",Object),Ut("Set",Set),Ut("TransferableGridIndex",eu),Ut("Color",wn),Ut("Error",Error),Ut("AJAXError",Te),Ut("ResolvedImage",fi),Ut("StylePropertyFunction",vs),Ut("StyleExpression",Lu,{omit:["_evaluator"]}),Ut("ZoomDependentExpression",jo),Ut("ZoomConstantExpression",Aa),Ut("CompoundExpression",gs,{omit:["_evaluate"]});for(const u in Ea)Ea[u]._classRegistryKey||Ut(`Expression_${u}`,Ea[u]);function Ad(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function gl(u){return u.$name||u.constructor._classRegistryKey}function Cd(u){return!function(i){if(i===null||typeof i!="object")return!1;const o=gl(i);return!(!o||o==="Object")}(u)&&(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error||Ad(u)||Xa(u)||ArrayBuffer.isView(u)||u instanceof ImageData)}function Lc(u,i){if(Cd(u))return(Ad(u)||Xa(u))&&i&&i.push(u),ArrayBuffer.isView(u)&&i&&i.push(u.buffer),u instanceof ImageData&&i&&i.push(u.data.buffer),u;if(Array.isArray(u)){const T=[];for(const S of u)T.push(Lc(S,i));return T}if(typeof u!="object")throw new Error("can't serialize object of type "+typeof u);const o=gl(u);if(!o)throw new Error(`can't serialize object of unregistered class ${u.constructor.name}`);if(!wo[o])throw new Error(`${o} is not registered.`);const{klass:f}=wo[o],v=f.serialize?f.serialize(u,i):{};if(f.serialize){if(i&&v===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in u){if(!u.hasOwnProperty(T)||wo[o].omit.indexOf(T)>=0)continue;const S=u[T];v[T]=wo[o].shallow.indexOf(T)>=0?S:Lc(S,i)}u instanceof Error&&(v.message=u.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(v.$name=o),v}function Ts(u){if(Cd(u))return u;if(Array.isArray(u))return u.map(Ts);if(typeof u!="object")throw new Error("can't deserialize object of type "+typeof u);const i=gl(u)||"Object";if(!wo[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:o}=wo[i];if(!o)throw new Error(`can't deserialize unregistered class ${i}`);if(o.deserialize)return o.deserialize(u);const f=Object.create(o.prototype);for(const v of Object.keys(u)){if(v==="$name")continue;const T=u[v];f[v]=wo[i].shallow.indexOf(v)>=0?T:Ts(T)}return f}class Ph{constructor(){this.first=!0}update(i,o){const f=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=o),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=f,!0))}}const On={"Latin-1 Supplement":u=>u>=128&&u<=255,"Hangul Jamo":u=>u>=4352&&u<=4607,Khmer:u=>u>=6016&&u<=6143,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Kanbun:u=>u>=12688&&u<=12703,"CJK Strokes":u=>u>=12736&&u<=12783,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Hangul Syllables":u=>u>=44032&&u<=55215,"Private Use Area":u=>u>=57344&&u<=63743,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function $o(u){for(const i of u)if(nu(i.charCodeAt(0)))return!0;return!1}function yl(u){for(const i of u)if(!$f(i.charCodeAt(0)))return!1;return!0}function tu(u){const i=u.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(i.join("|"),"u")}const qf=tu(["Arab","Dupl","Mong","Ougr","Syrc"]);function $f(u){return!qf.test(String.fromCodePoint(u))}const ju=tu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function nu(u){return!(u!==746&&u!==747&&(u<4352||!(On["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||On["CJK Compatibility"](u)||On["CJK Strokes"](u)||!(!On["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||On["Enclosed CJK Letters and Months"](u)||On["Ideographic Description Characters"](u)||On.Kanbun(u)||On.Katakana(u)&&u!==12540||!(!On["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!On["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||On["Vertical Forms"](u)||On["Yijing Hexagram Symbols"](u)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(u))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(u))||ju.test(String.fromCodePoint(u)))))}function Id(u){return!(nu(u)||function(i){return!!(On["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||On["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||On["Letterlike Symbols"](i)||On["Number Forms"](i)||On["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||On["Control Pictures"](i)&&i!==9251||On["Optical Character Recognition"](i)||On["Enclosed Alphanumerics"](i)||On["Geometric Shapes"](i)||On["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||On["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||On["CJK Symbols and Punctuation"](i)||On.Katakana(i)||On["Private Use Area"](i)||On["CJK Compatibility Forms"](i)||On["Small Form Variants"](i)||On["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(u))}const Gf=tu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Go(u){return Gf.test(String.fromCodePoint(u))}function Md(u,i){return!(!i&&Go(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||On.Khmer(u))}function Pd(u){for(const i of u)if(Go(i.charCodeAt(0)))return!0;return!1}const Ho=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(u){this.pluginStatus=u.pluginStatus,this.pluginURL=u.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(u){if(Ho.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=u.applyArabicShaping,this.processBidirectionalText=u.processBidirectionalText,this.processStyledBidirectionalText=u.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(u,i){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(u.pluginStatus!=="loading")return this.setState(u),u;const o=u.pluginURL,f=new Promise(T=>{this.loadScriptResolve=T});i(o);const v=new Promise(T=>setTimeout(()=>T(),this.TIMEOUT));if(yield Promise.race([f,v]),this.isParsed()){const T={pluginStatus:"loaded",pluginURL:o};return this.setState(T),T}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${o}`)})}};class Lr{constructor(i,o){this.zoom=i,o?(this.now=o.now||0,this.fadeDuration=o.fadeDuration||0,this.zoomHistory=o.zoomHistory||new Ph,this.transition=o.transition||{},this.globalState=o.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ph,this.transition={},this.globalState={})}isSupportedScript(i){return function(o,f){for(const v of o)if(!Md(v.charCodeAt(0),f))return!1;return!0}(i,Ho.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,o=i-Math.floor(i),f=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*o}}}class $s{constructor(i,o){this.property=i,this.value=o,this.expression=function(f,v){if(ja(f))return new vs(f,v);if(zu(f)){const T=vo(f,v);if(T.result==="error")throw new Error(T.value.map(S=>`${S.key}: ${S.message}`).join(", "));return T.value}{let T=f;return v.type==="color"&&typeof f=="string"?T=wn.parse(f):v.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?v.type!=="numberArray"||typeof f!="number"&&!Array.isArray(f)?v.type!=="colorArray"||typeof f!="string"&&!Array.isArray(f)?v.type==="variableAnchorOffsetCollection"&&Array.isArray(f)?T=In.parse(f):v.type==="projectionDefinition"&&typeof f=="string"&&(T=_n.parse(f)):T=Er.parse(f):T=qr.parse(f):T=Ur.parse(f),{globalStateRefs:new Set,kind:"constant",evaluate:()=>T}}}(o===void 0?i.specification.default:o,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(i,o,f){return this.property.possiblyEvaluate(this,i,o,f)}}class Nn{constructor(i){this.property=i,this.value=new $s(i,void 0)}transitioned(i,o){return new xi(this.property,this.value,o,gi({},i.transition,this.transition),i.now)}untransitioned(){return new xi(this.property,this.value,null,{},0)}}class mr{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return _a(this._values[i].value.value)}setValue(i,o){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Nn(this._values[i].property)),this._values[i].value=new $s(this._values[i].property,o===null?void 0:_a(o))}getTransition(i){return _a(this._values[i].transition)}setTransition(i,o){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Nn(this._values[i].property)),this._values[i].transition=_a(o)||void 0}serialize(){const i={};for(const o of Object.keys(this._values)){const f=this.getValue(o);f!==void 0&&(i[o]=f);const v=this.getTransition(o);v!==void 0&&(i[`${o}-transition`]=v)}return i}transitioned(i,o){const f=new Rh(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].transitioned(i,o._values[v]);return f}untransitioned(){const i=new Rh(this._properties);for(const o of Object.keys(this._values))i._values[o]=this._values[o].untransitioned();return i}}class xi{constructor(i,o,f,v,T){this.property=i,this.value=o,this.begin=T+v.delay||0,this.end=this.begin+v.duration||0,i.specification.transition&&(v.delay||v.duration)&&(this.prior=f)}possiblyEvaluate(i,o,f){const v=i.now||0,T=this.value.possiblyEvaluate(i,o,f),S=this.prior;if(S){if(v>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(v<this.begin)return S.possiblyEvaluate(i,o,f);{const C=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(i,o,f),T,gn(C))}}return T}}class Rh{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,o,f){const v=new Uu(this._properties);for(const T of Object.keys(this._values))v._values[T]=this._values[T].possiblyEvaluate(i,o,f);return v}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class zc{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}hasValue(i){return this._values[i].value!==void 0}getValue(i){return _a(this._values[i].value)}setValue(i,o){this._values[i]=new $s(this._values[i].property,o===null?void 0:_a(o))}serialize(){const i={};for(const o of Object.keys(this._values)){const f=this.getValue(o);f!==void 0&&(i[o]=f)}return i}possiblyEvaluate(i,o,f){const v=new Uu(this._properties);for(const T of Object.keys(this._values))v._values[T]=this._values[T].possiblyEvaluate(i,o,f);return v}}class Ca{constructor(i,o,f){this.property=i,this.value=o,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,o,f,v){return this.property.evaluate(this.value,this.parameters,i,o,f,v)}}class Uu{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class $t{constructor(i){this.specification=i}possiblyEvaluate(i,o){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(o)}interpolate(i,o,f){const v=aa[this.specification.type];return v?v(i,o,f):i}}class rn{constructor(i,o){this.specification=i,this.overrides=o}possiblyEvaluate(i,o,f,v){return new Ca(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(o,null,{},f,v)}:i.expression,o)}interpolate(i,o,f){if(i.value.kind!=="constant"||o.value.kind!=="constant")return i;if(i.value.value===void 0||o.value.value===void 0)return new Ca(this,{kind:"constant",value:void 0},i.parameters);const v=aa[this.specification.type];if(v){const T=v(i.value.value,o.value.value,f);return new Ca(this,{kind:"constant",value:T},i.parameters)}return i}evaluate(i,o,f,v,T,S){return i.kind==="constant"?i.value:i.evaluate(o,f,v,T,S)}}class Rd extends rn{possiblyEvaluate(i,o,f,v){if(i.value===void 0)return new Ca(this,{kind:"constant",value:void 0},o);if(i.expression.kind==="constant"){const T=i.expression.evaluate(o,null,{},f,v),S=i.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,C=this._calculate(S,S,S,o);return new Ca(this,{kind:"constant",value:C},o)}if(i.expression.kind==="camera"){const T=this._calculate(i.expression.evaluate({zoom:o.zoom-1}),i.expression.evaluate({zoom:o.zoom}),i.expression.evaluate({zoom:o.zoom+1}),o);return new Ca(this,{kind:"constant",value:T},o)}return new Ca(this,i.expression,o)}evaluate(i,o,f,v,T,S){if(i.kind==="source"){const C=i.evaluate(o,f,v,T,S);return this._calculate(C,C,C,o)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(o.zoom)-1},f,v),i.evaluate({zoom:Math.floor(o.zoom)},f,v),i.evaluate({zoom:Math.floor(o.zoom)+1},f,v),o):i.value}_calculate(i,o,f,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:i,to:o}:{from:f,to:o}}interpolate(i){return i}}class si{constructor(i){this.specification=i}possiblyEvaluate(i,o,f,v){if(i.value!==void 0){if(i.expression.kind==="constant"){const T=i.expression.evaluate(o,null,{},f,v);return this._calculate(T,T,T,o)}return this._calculate(i.expression.evaluate(new Lr(Math.floor(o.zoom-1),o)),i.expression.evaluate(new Lr(Math.floor(o.zoom),o)),i.expression.evaluate(new Lr(Math.floor(o.zoom+1),o)),o)}}_calculate(i,o,f,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:i,to:o}:{from:f,to:o}}interpolate(i){return i}}class qu{constructor(i){this.specification=i}possiblyEvaluate(i,o,f,v){return!!i.expression.evaluate(o,null,{},f,v)}interpolate(){return!1}}class fa{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in i){const f=i[o];f.specification.overridable&&this.overridableProperties.push(o);const v=this.defaultPropertyValues[o]=new $s(f,void 0),T=this.defaultTransitionablePropertyValues[o]=new Nn(f);this.defaultTransitioningPropertyValues[o]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=v.possiblyEvaluate({})}}}Ut("DataDrivenProperty",rn),Ut("DataConstantProperty",$t),Ut("CrossFadedDataDrivenProperty",Rd),Ut("CrossFadedProperty",si),Ut("ColorRampProperty",qu);const Hf="-transition";class oa extends mt{constructor(i,o){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter,this._featureFilter=pi(i.filter)),o.layout&&(this._unevaluatedLayout=new zc(o.layout)),o.paint)){this._transitionablePaint=new mr(o.paint);for(const f in i.paint)this.setPaintProperty(f,i.paint[f],{validate:!1});for(const f in i.layout)this.setLayoutProperty(f,i.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Uu(o.paint)}}setFilter(i){this.filter=i,this._featureFilter=pi(i)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}getLayoutAffectingGlobalStateRefs(){const i=new Set;if(this._unevaluatedLayout)for(const o in this._unevaluatedLayout._values){const f=this._unevaluatedLayout._values[o];for(const v of f.getGlobalStateRefs())i.add(v)}for(const o of this._featureFilter.getGlobalStateRefs())i.add(o);return i}setLayoutProperty(i,o,f={}){o!=null&&this._validate(Ed,`layers.${this.id}.layout.${i}`,i,o,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,o):this.visibility=o)}getPaintProperty(i){return i.endsWith(Hf)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,o,f={}){if(o!=null&&this._validate(Mh,`layers.${this.id}.paint.${i}`,i,o,f))return!1;if(i.endsWith(Hf))return this._transitionablePaint.setTransition(i.slice(0,-11),o||void 0),!1;{const v=this._transitionablePaint._values[i],T=v.property.specification["property-type"]==="cross-faded-data-driven",S=v.value.isDataDriven(),C=v.value;this._transitionablePaint.setValue(i,o),this._handleSpecialPaintPropertyUpdate(i);const k=this._transitionablePaint._values[i].value;return k.isDataDriven()||S||T||this._handleOverridablePaintPropertyUpdate(i,C,k)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,o,f){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,o){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,o)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),ya(i,(o,f)=>!(o===void 0||f==="layout"&&!Object.keys(o).length||f==="paint"&&!Object.keys(o).length))}_validate(i,o,f,v,T={}){return(!T||T.validate!==!1)&&Jl(this,i.call(Ql,{key:o,layerType:this.type,objectKey:f,value:v,styleSpec:ze,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const o=this.paint.get(i);if(o instanceof Ca&&yo(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const rm={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class _l{constructor(i,o){this._structArray=i,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class $r{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,o){return i._trim(),o&&(i.isTransferred=!0,o.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const o=Object.create(this.prototype);return o.arrayBuffer=i.arrayBuffer,o.length=i.length,o.capacity=i.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Yr(u,i=1){let o=0,f=0;return{members:u.map(v=>{const T=rm[v.type].BYTES_PER_ELEMENT,S=o=$a(o,Math.max(i,T)),C=v.components||1;return f=Math.max(f,T),o+=T*C,{name:v.name,type:v.type,components:C,offset:S}}),size:$a(o,Math.max(f,i)),alignment:i}}function $a(u,i){return Math.ceil(u/i)*i}class zr extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const v=2*i;return this.int16[v+0]=o,this.int16[v+1]=f,i}}zr.prototype.bytesPerElement=4,Ut("StructArrayLayout2i4",zr);class Zo extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=3*i;return this.int16[T+0]=o,this.int16[T+1]=f,this.int16[T+2]=v,i}}Zo.prototype.bytesPerElement=6,Ut("StructArrayLayout3i6",Zo);class $u extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,f,v)}emplace(i,o,f,v,T){const S=4*i;return this.int16[S+0]=o,this.int16[S+1]=f,this.int16[S+2]=v,this.int16[S+3]=T,i}}$u.prototype.bytesPerElement=8,Ut("StructArrayLayout4i8",$u);class Gu extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S){const C=this.length;return this.resize(C+1),this.emplace(C,i,o,f,v,T,S)}emplace(i,o,f,v,T,S,C){const k=6*i;return this.int16[k+0]=o,this.int16[k+1]=f,this.int16[k+2]=v,this.int16[k+3]=T,this.int16[k+4]=S,this.int16[k+5]=C,i}}Gu.prototype.bytesPerElement=12,Ut("StructArrayLayout2i4i12",Gu);class vl extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S){const C=this.length;return this.resize(C+1),this.emplace(C,i,o,f,v,T,S)}emplace(i,o,f,v,T,S,C){const k=4*i,z=8*i;return this.int16[k+0]=o,this.int16[k+1]=f,this.uint8[z+4]=v,this.uint8[z+5]=T,this.uint8[z+6]=S,this.uint8[z+7]=C,i}}vl.prototype.bytesPerElement=8,Ut("StructArrayLayout2i4ub8",vl);class Ss extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const v=2*i;return this.float32[v+0]=o,this.float32[v+1]=f,i}}Ss.prototype.bytesPerElement=8,Ut("StructArrayLayout2f8",Ss);class Oc extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,C,k,z,N){const j=this.length;return this.resize(j+1),this.emplace(j,i,o,f,v,T,S,C,k,z,N)}emplace(i,o,f,v,T,S,C,k,z,N,j){const G=10*i;return this.uint16[G+0]=o,this.uint16[G+1]=f,this.uint16[G+2]=v,this.uint16[G+3]=T,this.uint16[G+4]=S,this.uint16[G+5]=C,this.uint16[G+6]=k,this.uint16[G+7]=z,this.uint16[G+8]=N,this.uint16[G+9]=j,i}}Oc.prototype.bytesPerElement=20,Ut("StructArrayLayout10ui20",Oc);class Nc extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,C,k,z,N,j,G){const Y=this.length;return this.resize(Y+1),this.emplace(Y,i,o,f,v,T,S,C,k,z,N,j,G)}emplace(i,o,f,v,T,S,C,k,z,N,j,G,Y){const J=12*i;return this.int16[J+0]=o,this.int16[J+1]=f,this.int16[J+2]=v,this.int16[J+3]=T,this.uint16[J+4]=S,this.uint16[J+5]=C,this.uint16[J+6]=k,this.uint16[J+7]=z,this.int16[J+8]=N,this.int16[J+9]=j,this.int16[J+10]=G,this.int16[J+11]=Y,i}}Nc.prototype.bytesPerElement=24,Ut("StructArrayLayout4i4ui4i24",Nc);class kh extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=3*i;return this.float32[T+0]=o,this.float32[T+1]=f,this.float32[T+2]=v,i}}kh.prototype.bytesPerElement=12,Ut("StructArrayLayout3f12",kh);class b extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint32[1*i+0]=o,i}}b.prototype.bytesPerElement=4,Ut("StructArrayLayout1ul4",b);class n extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,C,k,z){const N=this.length;return this.resize(N+1),this.emplace(N,i,o,f,v,T,S,C,k,z)}emplace(i,o,f,v,T,S,C,k,z,N){const j=10*i,G=5*i;return this.int16[j+0]=o,this.int16[j+1]=f,this.int16[j+2]=v,this.int16[j+3]=T,this.int16[j+4]=S,this.int16[j+5]=C,this.uint32[G+3]=k,this.uint16[j+8]=z,this.uint16[j+9]=N,i}}n.prototype.bytesPerElement=20,Ut("StructArrayLayout6i1ul2ui20",n);class l extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S){const C=this.length;return this.resize(C+1),this.emplace(C,i,o,f,v,T,S)}emplace(i,o,f,v,T,S,C){const k=6*i;return this.int16[k+0]=o,this.int16[k+1]=f,this.int16[k+2]=v,this.int16[k+3]=T,this.int16[k+4]=S,this.int16[k+5]=C,i}}l.prototype.bytesPerElement=12,Ut("StructArrayLayout2i2i2i12",l);class p extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T){const S=this.length;return this.resize(S+1),this.emplace(S,i,o,f,v,T)}emplace(i,o,f,v,T,S){const C=4*i,k=8*i;return this.float32[C+0]=o,this.float32[C+1]=f,this.float32[C+2]=v,this.int16[k+6]=T,this.int16[k+7]=S,i}}p.prototype.bytesPerElement=16,Ut("StructArrayLayout2f1f2i16",p);class _ extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S){const C=this.length;return this.resize(C+1),this.emplace(C,i,o,f,v,T,S)}emplace(i,o,f,v,T,S,C){const k=16*i,z=4*i,N=8*i;return this.uint8[k+0]=o,this.uint8[k+1]=f,this.float32[z+1]=v,this.float32[z+2]=T,this.int16[N+6]=S,this.int16[N+7]=C,i}}_.prototype.bytesPerElement=16,Ut("StructArrayLayout2ub2f2i16",_);class w extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=3*i;return this.uint16[T+0]=o,this.uint16[T+1]=f,this.uint16[T+2]=v,i}}w.prototype.bytesPerElement=6,Ut("StructArrayLayout3ui6",w);class E extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,C,k,z,N,j,G,Y,J,te,le,ge){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,i,o,f,v,T,S,C,k,z,N,j,G,Y,J,te,le,ge)}emplace(i,o,f,v,T,S,C,k,z,N,j,G,Y,J,te,le,ge,Ne){const Se=24*i,X=12*i,oe=48*i;return this.int16[Se+0]=o,this.int16[Se+1]=f,this.uint16[Se+2]=v,this.uint16[Se+3]=T,this.uint32[X+2]=S,this.uint32[X+3]=C,this.uint32[X+4]=k,this.uint16[Se+10]=z,this.uint16[Se+11]=N,this.uint16[Se+12]=j,this.float32[X+7]=G,this.float32[X+8]=Y,this.uint8[oe+36]=J,this.uint8[oe+37]=te,this.uint8[oe+38]=le,this.uint32[X+10]=ge,this.int16[Se+22]=Ne,i}}E.prototype.bytesPerElement=48,Ut("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",E);class P extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,v,T,S,C,k,z,N,j,G,Y,J,te,le,ge,Ne,Se,X,oe,Ie,nt,yt,lt,ft,Ct,xt){const Rt=this.length;return this.resize(Rt+1),this.emplace(Rt,i,o,f,v,T,S,C,k,z,N,j,G,Y,J,te,le,ge,Ne,Se,X,oe,Ie,nt,yt,lt,ft,Ct,xt)}emplace(i,o,f,v,T,S,C,k,z,N,j,G,Y,J,te,le,ge,Ne,Se,X,oe,Ie,nt,yt,lt,ft,Ct,xt,Rt){const gt=32*i,Wt=16*i;return this.int16[gt+0]=o,this.int16[gt+1]=f,this.int16[gt+2]=v,this.int16[gt+3]=T,this.int16[gt+4]=S,this.int16[gt+5]=C,this.int16[gt+6]=k,this.int16[gt+7]=z,this.uint16[gt+8]=N,this.uint16[gt+9]=j,this.uint16[gt+10]=G,this.uint16[gt+11]=Y,this.uint16[gt+12]=J,this.uint16[gt+13]=te,this.uint16[gt+14]=le,this.uint16[gt+15]=ge,this.uint16[gt+16]=Ne,this.uint16[gt+17]=Se,this.uint16[gt+18]=X,this.uint16[gt+19]=oe,this.uint16[gt+20]=Ie,this.uint16[gt+21]=nt,this.uint16[gt+22]=yt,this.uint32[Wt+12]=lt,this.float32[Wt+13]=ft,this.float32[Wt+14]=Ct,this.uint16[gt+30]=xt,this.uint16[gt+31]=Rt,i}}P.prototype.bytesPerElement=64,Ut("StructArrayLayout8i15ui1ul2f2ui64",P);class D extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.float32[1*i+0]=o,i}}D.prototype.bytesPerElement=4,Ut("StructArrayLayout1f4",D);class O extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=3*i;return this.uint16[6*i+0]=o,this.float32[T+1]=f,this.float32[T+2]=v,i}}O.prototype.bytesPerElement=12,Ut("StructArrayLayout1ui2f12",O);class F extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,f)}emplace(i,o,f,v){const T=4*i;return this.uint32[2*i+0]=o,this.uint16[T+2]=f,this.uint16[T+3]=v,i}}F.prototype.bytesPerElement=8,Ut("StructArrayLayout1ul2ui8",F);class q extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const v=2*i;return this.uint16[v+0]=o,this.uint16[v+1]=f,i}}q.prototype.bytesPerElement=4,Ut("StructArrayLayout2ui4",q);class U extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint16[1*i+0]=o,i}}U.prototype.bytesPerElement=2,Ut("StructArrayLayout1ui2",U);class H extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,v){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,f,v)}emplace(i,o,f,v,T){const S=4*i;return this.float32[S+0]=o,this.float32[S+1]=f,this.float32[S+2]=v,this.float32[S+3]=T,i}}H.prototype.bytesPerElement=16,Ut("StructArrayLayout4f16",H);class ee extends _l{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new re(this.anchorPointX,this.anchorPointY)}}ee.prototype.size=20;class fe extends n{get(i){return new ee(this,i)}}Ut("CollisionBoxArray",fe);class he extends _l{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}he.prototype.size=48;class pe extends E{get(i){return new he(this,i)}}Ut("PlacedSymbolArray",pe);class _e extends _l{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}_e.prototype.size=64;class Ae extends P{get(i){return new _e(this,i)}}Ut("SymbolInstanceArray",Ae);class be extends D{getoffsetX(i){return this.float32[1*i+0]}}Ut("GlyphOffsetArray",be);class Pe extends Zo{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Ut("SymbolLineVertexArray",Pe);class Le extends _l{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Le.prototype.size=12;class xe extends O{get(i){return new Le(this,i)}}Ut("TextAnchorOffsetArray",xe);class Ve extends _l{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ve.prototype.size=8;class rt extends F{get(i){return new Ve(this,i)}}Ut("FeatureIndexArray",rt);class Ye extends zr{}class Qe extends zr{}class ot extends zr{}class zt extends Gu{}class Lt extends vl{}class bt extends Ss{}class Zt extends Oc{}class Mn extends Nc{}class Qn extends kh{}class Qr extends b{}class gr extends l{}class ni extends _{}class yr extends w{}class _r extends q{}const Ar=Yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Wi}=Ar;class Zn{constructor(i=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=i}prepareSegment(i,o,f,v){const T=this.segments[this.segments.length-1];return i>Zn.MAX_VERTEX_ARRAY_LENGTH&&Ir(`Max vertices per segment is ${Zn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Zn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!T||T.vertexLength+i>Zn.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==v?this.createNewSegment(o,f,v):T}createNewSegment(i,o,f){const v={vertexOffset:i.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0,vaos:{}};return f!==void 0&&(v.sortKey=f),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(v),v}getOrCreateLatestSegment(i,o,f){return this.prepareSegment(0,i,o,f)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const i of this.segments)for(const o in i.vaos)i.vaos[o].destroy()}static simpleSegment(i,o,f,v){return new Zn([{vertexOffset:i,primitiveOffset:o,vertexLength:f,primitiveLength:v,vaos:{},sortKey:0}])}}function Ki(u,i){return 256*(u=Cr(Math.floor(u),0,255))+Cr(Math.floor(i),0,255)}Zn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ut("SegmentVector",Zn);const pa=Yr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ru,bl,Gs,Hs={exports:{}},iu={exports:{}},Bc={exports:{}},Hu=function(){if(Gs)return Hs.exports;Gs=1;var u=(ru||(ru=1,iu.exports=function(o,f){var v,T,S,C,k,z,N,j;for(T=o.length-(v=3&o.length),S=f,k=3432918353,z=461845907,j=0;j<T;)N=255&o.charCodeAt(j)|(255&o.charCodeAt(++j))<<8|(255&o.charCodeAt(++j))<<16|(255&o.charCodeAt(++j))<<24,++j,S=27492+(65535&(C=5*(65535&(S=(S^=N=(65535&(N=(N=(65535&N)*k+(((N>>>16)*k&65535)<<16)&4294967295)<<15|N>>>17))*z+(((N>>>16)*z&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(N=0,v){case 3:N^=(255&o.charCodeAt(j+2))<<16;case 2:N^=(255&o.charCodeAt(j+1))<<8;case 1:S^=N=(65535&(N=(N=(65535&(N^=255&o.charCodeAt(j)))*k+(((N>>>16)*k&65535)<<16)&4294967295)<<15|N>>>17))*z+(((N>>>16)*z&65535)<<16)&4294967295}return S^=o.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),iu.exports),i=(bl||(bl=1,Bc.exports=function(o,f){for(var v,T=o.length,S=f^T,C=0;T>=4;)v=1540483477*(65535&(v=255&o.charCodeAt(C)|(255&o.charCodeAt(++C))<<8|(255&o.charCodeAt(++C))<<16|(255&o.charCodeAt(++C))<<24))+((1540483477*(v>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),T-=4,++C;switch(T){case 3:S^=(255&o.charCodeAt(C+2))<<16;case 2:S^=(255&o.charCodeAt(C+1))<<8;case 1:S=1540483477*(65535&(S^=255&o.charCodeAt(C)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),Bc.exports);return Hs.exports=u,Hs.exports.murmur3=u,Hs.exports.murmur2=i,Hs.exports}(),ma=M(Hu);class Zs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,o,f,v){this.ids.push(xl(i)),this.positions.push(o,f,v)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=xl(i);let f=0,v=this.ids.length-1;for(;f<v;){const S=f+v>>1;this.ids[S]>=o?v=S:f=S+1}const T=[];for(;this.ids[f]===o;)T.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return T}static serialize(i,o){const f=new Float64Array(i.ids),v=new Uint32Array(i.positions);return Zu(f,v,0,f.length-1),o&&o.push(f.buffer,v.buffer),{ids:f,positions:v}}static deserialize(i){const o=new Zs;return o.ids=i.ids,o.positions=i.positions,o.indexed=!0,o}}function xl(u){const i=+u;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:ma(String(u))}function Zu(u,i,o,f){for(;o<f;){const v=u[o+f>>1];let T=o-1,S=f+1;for(;;){do T++;while(u[T]<v);do S--;while(u[S]>v);if(T>=S)break;Or(u,T,S),Or(i,3*T,3*S),Or(i,3*T+1,3*S+1),Or(i,3*T+2,3*S+2)}S-o<f-S?(Zu(u,i,o,S),o=S+1):(Zu(u,i,S+1,f),f=S)}}function Or(u,i,o){const f=u[i];u[i]=u[o],u[o]=f}Ut("FeaturePositionMap",Zs);class vr{constructor(i,o){this.gl=i.gl,this.location=o}}class la extends vr{constructor(i,o){super(i,o),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class oi extends vr{constructor(i,o){super(i,o),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Dh extends vr{constructor(i,o){super(i,o),this.current=wn.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const im=new Float32Array(16);function kd(u){return[Ki(255*u.r,255*u.g),Ki(255*u.b,255*u.a)]}class Wo{constructor(i,o,f){this.value=i,this.uniformNames=o.map(v=>`u_${v}`),this.type=f}setUniform(i,o,f){i.set(f.constantOr(this.value))}getBinding(i,o,f){return this.type==="color"?new Dh(i,o):new la(i,o)}}class Wu{constructor(i,o){this.uniformNames=o.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=i.tlbr}setUniform(i,o,f,v){const T=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&i.set(T)}getBinding(i,o,f){return f.substr(0,9)==="u_pattern"?new oi(i,o):new la(i,o)}}class Fi{constructor(i,o,f,v){this.expression=i,this.type=f,this.maxValue=0,this.paintVertexAttributes=o.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(i,o,f,v,T){const S=this.paintVertexArray.length,C=this.expression.evaluate(new Lr(0),o,{},v,[],T);this.paintVertexArray.resize(i),this._setPaintValue(S,i,C)}updatePaintArray(i,o,f,v){const T=this.expression.evaluate({zoom:0},f,v);this._setPaintValue(i,o,T)}_setPaintValue(i,o,f){if(this.type==="color"){const v=kd(f);for(let T=i;T<o;T++)this.paintVertexArray.emplace(T,v[0],v[1])}else{for(let v=i;v<o;v++)this.paintVertexArray.emplace(v,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gr{constructor(i,o,f,v,T,S){this.expression=i,this.uniformNames=o.map(C=>`u_${C}_t`),this.type=f,this.useIntegerZoom=v,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=o.map(C=>({name:`a_${C}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(i,o,f,v,T){const S=this.expression.evaluate(new Lr(this.zoom),o,{},v,[],T),C=this.expression.evaluate(new Lr(this.zoom+1),o,{},v,[],T),k=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(k,i,S,C)}updatePaintArray(i,o,f,v){const T=this.expression.evaluate({zoom:this.zoom},f,v),S=this.expression.evaluate({zoom:this.zoom+1},f,v);this._setPaintValue(i,o,T,S)}_setPaintValue(i,o,f,v){if(this.type==="color"){const T=kd(f),S=kd(v);for(let C=i;C<o;C++)this.paintVertexArray.emplace(C,T[0],T[1],S[0],S[1])}else{for(let T=i;T<o;T++)this.paintVertexArray.emplace(T,f,v);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(v))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,o){const f=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,v=Cr(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);i.set(v)}getBinding(i,o,f){return new la(i,o)}}class Ia{constructor(i,o,f,v,T,S){this.expression=i,this.type=o,this.useIntegerZoom=f,this.zoom=v,this.layerId=S,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(i,o,f){const v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(v,i,o.patterns&&o.patterns[this.layerId],f)}updatePaintArray(i,o,f,v,T){this._setPaintValues(i,o,f.patterns&&f.patterns[this.layerId],T)}_setPaintValues(i,o,f,v){if(!v||!f)return;const{min:T,mid:S,max:C}=f,k=v[T],z=v[S],N=v[C];if(k&&z&&N)for(let j=i;j<o;j++)this.zoomInPaintVertexArray.emplace(j,z.tl[0],z.tl[1],z.br[0],z.br[1],k.tl[0],k.tl[1],k.br[0],k.br[1],z.pixelRatio,k.pixelRatio),this.zoomOutPaintVertexArray.emplace(j,z.tl[0],z.tl[1],z.br[0],z.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],z.pixelRatio,N.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,pa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,pa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Dd{constructor(i,o,f){this.binders={},this._buffers=[];const v=[];for(const T in i.paint._values){if(!f(T))continue;const S=i.paint.get(T);if(!(S instanceof Ca&&yo(S.property.specification)))continue;const C=To(T,i.type),k=S.value,z=S.property.specification.type,N=S.property.useIntegerZoom,j=S.property.specification["property-type"],G=j==="cross-faded"||j==="cross-faded-data-driven";if(k.kind==="constant")this.binders[T]=G?new Wu(k.value,C):new Wo(k.value,C,z),v.push(`/u_${T}`);else if(k.kind==="source"||G){const Y=wi(T,z,"source");this.binders[T]=G?new Ia(k,z,N,o,Y,i.id):new Fi(k,C,z,Y),v.push(`/a_${T}`)}else{const Y=wi(T,z,"composite");this.binders[T]=new Gr(k,C,z,N,o,Y),v.push(`/z_${T}`)}}this.cacheKey=v.sort().join("")}getMaxValue(i){const o=this.binders[i];return o instanceof Fi||o instanceof Gr?o.maxValue:0}populatePaintArrays(i,o,f,v,T){for(const S in this.binders){const C=this.binders[S];(C instanceof Fi||C instanceof Gr||C instanceof Ia)&&C.populatePaintArray(i,o,f,v,T)}}setConstantPatternPositions(i,o){for(const f in this.binders){const v=this.binders[f];v instanceof Wu&&v.setConstantPatternPositions(i,o)}}updatePaintArrays(i,o,f,v,T){let S=!1;for(const C in i){const k=o.getPositions(C);for(const z of k){const N=f.feature(z.index);for(const j in this.binders){const G=this.binders[j];if((G instanceof Fi||G instanceof Gr||G instanceof Ia)&&G.expression.isStateDependent===!0){const Y=v.paint.get(j);G.expression=Y.value,G.updatePaintArray(z.start,z.end,N,i[C],T),S=!0}}}}return S}defines(){const i=[];for(const o in this.binders){const f=this.binders[o];(f instanceof Wo||f instanceof Wu)&&i.push(...f.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return i}getBinderAttributes(){const i=[];for(const o in this.binders){const f=this.binders[o];if(f instanceof Fi||f instanceof Gr)for(let v=0;v<f.paintVertexAttributes.length;v++)i.push(f.paintVertexAttributes[v].name);else if(f instanceof Ia)for(let v=0;v<pa.members.length;v++)i.push(pa.members[v].name)}return i}getBinderUniforms(){const i=[];for(const o in this.binders){const f=this.binders[o];if(f instanceof Wo||f instanceof Wu||f instanceof Gr)for(const v of f.uniformNames)i.push(v)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,o){const f=[];for(const v in this.binders){const T=this.binders[v];if(T instanceof Wo||T instanceof Wu||T instanceof Gr){for(const S of T.uniformNames)if(o[S]){const C=T.getBinding(i,o[S],S);f.push({name:S,property:v,binding:C})}}}return f}setUniforms(i,o,f,v){for(const{name:T,property:S,binding:C}of o)this.binders[S].setUniform(C,v,f.get(S),T)}updatePaintBuffers(i){this._buffers=[];for(const o in this.binders){const f=this.binders[o];if(i&&f instanceof Ia){const v=i.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(f instanceof Fi||f instanceof Gr)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(i){for(const o in this.binders){const f=this.binders[o];(f instanceof Fi||f instanceof Gr||f instanceof Ia)&&f.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const o=this.binders[i];(o instanceof Fi||o instanceof Gr||o instanceof Ia)&&o.destroy()}}}class Ga{constructor(i,o,f=()=>!0){this.programConfigurations={};for(const v of i)this.programConfigurations[v.id]=new Dd(v,o,f);this.needsUpload=!1,this._featureMap=new Zs,this._bufferOffset=0}populatePaintArrays(i,o,f,v,T,S){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(i,o,v,T,S);o.id!==void 0&&this._featureMap.add(o.id,f,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,o,f,v){for(const T of f)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(i,this._featureMap,o,T,v)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function To(u,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${i}-`,"").replace(/-/g,"_")]}function wi(u,i,o){const f={color:{source:Ss,composite:H},number:{source:D,composite:Ss}},v=function(T){return{"line-pattern":{source:Zt,composite:Zt},"fill-pattern":{source:Zt,composite:Zt},"fill-extrusion-pattern":{source:Zt,composite:Zt}}[T]}(u);return v&&v[o]||f[i][o]}Ut("ConstantBinder",Wo),Ut("CrossFadedConstantBinder",Wu),Ut("SourceExpressionBinder",Fi),Ut("CrossFadedCompositeBinder",Ia),Ut("CompositeExpressionBinder",Gr),Ut("ProgramConfiguration",Dd,{omit:["_buffers"]}),Ut("ProgramConfigurationSet",Ga);const au=Math.pow(2,14)-1,am=-au-1;function Ku(u){const i=At/u.extent,o=u.loadGeometry();for(let f=0;f<o.length;f++){const v=o[f];for(let T=0;T<v.length;T++){const S=v[T],C=Math.round(S.x*i),k=Math.round(S.y*i);S.x=Cr(C,am,au),S.y=Cr(k,am,au),(C<S.x||C>S.x+1||k<S.y||k>S.y+1)&&Ir("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Fc(u,i){return{type:u.type,id:u.id,properties:u.properties,geometry:i?Ku(u):[]}}const Pg=-32768;function Lh(u,i,o,f,v){u.emplaceBack(Pg+8*i+f,Pg+8*o+v)}class Ld{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Qe,this.indexArray=new yr,this.segments=new Zn,this.programConfigurations=new Ga(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){const v=this.layers[0],T=[];let S=null,C=!1,k=v.type==="heatmap";if(v.type==="circle"){const N=v;S=N.layout.get("circle-sort-key"),C=!S.isConstant(),k=k||N.paint.get("circle-pitch-alignment")==="map"}const z=k?o.subdivisionGranularity.circle:1;for(const{feature:N,id:j,index:G,sourceLayerIndex:Y}of i){const J=this.layers[0]._featureFilter.needGeometry,te=Fc(N,J);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom,{globalState:this.globalState}),te,f))continue;const le=C?S.evaluate(te,{},f):void 0,ge={id:j,properties:N.properties,type:N.type,sourceLayerIndex:Y,index:G,geometry:J?te.geometry:Ku(N),patterns:{},sortKey:le};T.push(ge)}C&&T.sort((N,j)=>N.sortKey-j.sortKey);for(const N of T){const{geometry:j,index:G,sourceLayerIndex:Y}=N,J=i[G].feature;this.addFeature(N,j,G,f,z),o.featureIndex.insert(J,j,G,Y,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Wi),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,o,f,v,T=1){let S;switch(T){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${T}; valid values are 1, 3, 5, 7.`)}const C=S.length;for(const k of o)for(const z of k){const N=z.x,j=z.y;if(N<0||N>=At||j<0||j>=At)continue;const G=this.segments.prepareSegment(C*C,this.layoutVertexArray,this.indexArray,i.sortKey),Y=G.vertexLength;for(let J=0;J<C;J++)for(let te=0;te<C;te++)Lh(this.layoutVertexArray,N,j,S[te],S[J]);for(let J=0;J<C-1;J++)for(let te=0;te<C-1;te++){const le=Y+J*C+te,ge=Y+(J+1)*C+te;this.indexArray.emplaceBack(le,ge+1,le+1),this.indexArray.emplaceBack(le,ge,ge+1)}G.vertexLength+=C*C,G.primitiveLength+=(C-1)*(C-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{},v)}}function Rg(u,i){for(let o=0;o<u.length;o++)if(zh(i,u[o]))return!0;for(let o=0;o<i.length;o++)if(zh(u,i[o]))return!0;return!!om(u,i)}function W_(u,i,o){return!!zh(u,i)||!!lm(i,u,o)}function kg(u,i){if(u.length===1)return K_(i,u[0]);for(let o=0;o<i.length;o++){const f=i[o];for(let v=0;v<f.length;v++)if(zh(u,f[v]))return!0}for(let o=0;o<u.length;o++)if(K_(i,u[o]))return!0;for(let o=0;o<i.length;o++)if(om(u,i[o]))return!0;return!1}function sm(u,i,o){if(u.length>1){if(om(u,i))return!0;for(let f=0;f<i.length;f++)if(lm(i[f],u,o))return!0}for(let f=0;f<u.length;f++)if(lm(u[f],i,o))return!0;return!1}function om(u,i){if(u.length===0||i.length===0)return!1;for(let o=0;o<u.length-1;o++){const f=u[o],v=u[o+1];for(let T=0;T<i.length-1;T++)if(Dg(f,v,i[T],i[T+1]))return!0}return!1}function Dg(u,i,o,f){return Oa(u,o,f)!==Oa(i,o,f)&&Oa(u,i,o)!==Oa(u,i,f)}function lm(u,i,o){const f=o*o;if(i.length===1)return u.distSqr(i[0])<f;for(let v=1;v<i.length;v++)if(Lg(u,i[v-1],i[v])<f)return!0;return!1}function Lg(u,i,o){const f=i.distSqr(o);if(f===0)return u.distSqr(i);const v=((u.x-i.x)*(o.x-i.x)+(u.y-i.y)*(o.y-i.y))/f;return u.distSqr(v<0?i:v>1?o:o.sub(i)._mult(v)._add(i))}function K_(u,i){let o,f,v,T=!1;for(let S=0;S<u.length;S++){o=u[S];for(let C=0,k=o.length-1;C<o.length;k=C++)f=o[C],v=o[k],f.y>i.y!=v.y>i.y&&i.x<(v.x-f.x)*(i.y-f.y)/(v.y-f.y)+f.x&&(T=!T)}return T}function zh(u,i){let o=!1;for(let f=0,v=u.length-1;f<u.length;v=f++){const T=u[f],S=u[v];T.y>i.y!=S.y>i.y&&i.x<(S.x-T.x)*(i.y-T.y)/(S.y-T.y)+T.x&&(o=!o)}return o}function Ma(u,i,o){const f=o[0],v=o[2];if(u.x<f.x&&i.x<f.x||u.x>v.x&&i.x>v.x||u.y<f.y&&i.y<f.y||u.y>v.y&&i.y>v.y)return!1;const T=Oa(u,i,o[0]);return T!==Oa(u,i,o[1])||T!==Oa(u,i,o[2])||T!==Oa(u,i,o[3])}function Xi(u,i,o){const f=i.paint.get(u).value;return f.kind==="constant"?f.value:o.programConfigurations.get(i.id).getMaxValue(u)}function Zf(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function Wf(u,i,o,f,v){if(!i[0]&&!i[1])return u;const T=re.convert(i)._mult(v);o==="viewport"&&T._rotate(-f);const S=[];for(let C=0;C<u.length;C++)S.push(u[C].sub(T));return S}let zg,Og;Ut("CircleBucket",Ld,{omit:["layers"]});var X_={get paint(){return Og=Og||new fa({"circle-radius":new rn(ze.paint_circle["circle-radius"]),"circle-color":new rn(ze.paint_circle["circle-color"]),"circle-blur":new rn(ze.paint_circle["circle-blur"]),"circle-opacity":new rn(ze.paint_circle["circle-opacity"]),"circle-translate":new $t(ze.paint_circle["circle-translate"]),"circle-translate-anchor":new $t(ze.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new $t(ze.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new $t(ze.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new rn(ze.paint_circle["circle-stroke-width"]),"circle-stroke-color":new rn(ze.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new rn(ze.paint_circle["circle-stroke-opacity"])})},get layout(){return zg=zg||new fa({"circle-sort-key":new rn(ze.layout_circle["circle-sort-key"])})}};class um extends oa{constructor(i){super(i,X_)}createBucket(i){return new Ld(i)}queryRadius(i){const o=i;return Xi("circle-radius",this,o)+Xi("circle-stroke-width",this,o)+Zf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:v,transform:T,pixelsToTileUnits:S,unwrappedTileID:C,getElevation:k}){const z=Wf(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-T.bearingInRadians,S),N=this.paint.get("circle-radius").evaluate(o,f)+this.paint.get("circle-stroke-width").evaluate(o,f),j=this.paint.get("circle-pitch-alignment")==="map",G=j?z:function(J,te,le,ge){return J.map(Ne=>cm(Ne,te,le,ge))}(z,T,C,k),Y=j?N*S:N;for(const J of v)for(const te of J){const le=j?te:cm(te,T,C,k);let ge=Y;const Ne=T.projectTileCoordinates(te.x,te.y,C,k).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ge*=Ne/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ge*=T.cameraToCenterDistance/Ne),W_(G,le,ge))return!0}return!1}}function cm(u,i,o,f){const v=i.projectTileCoordinates(u.x,u.y,o,f).point;return new re((.5*v.x+.5)*i.width,(.5*-v.y+.5)*i.height)}class Ng extends Ld{}let Bg;Ut("HeatmapBucket",Ng,{omit:["layers"]});var Y_={get paint(){return Bg=Bg||new fa({"heatmap-radius":new rn(ze.paint_heatmap["heatmap-radius"]),"heatmap-weight":new rn(ze.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new $t(ze.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qu(ze.paint_heatmap["heatmap-color"]),"heatmap-opacity":new $t(ze.paint_heatmap["heatmap-opacity"])})}};function Kf(u,{width:i,height:o},f,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==i*o*f)throw new RangeError(`mismatched image size. expected: ${v.length} but got: ${i*o*f}`)}else v=new Uint8Array(i*o*f);return u.width=i,u.height=o,u.data=v,u}function hm(u,{width:i,height:o},f){if(i===u.width&&o===u.height)return;const v=Kf({},{width:i,height:o},f);Xf(u,v,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,i),height:Math.min(u.height,o)},f),u.width=i,u.height=o,u.data=v.data}function Xf(u,i,o,f,v,T){if(v.width===0||v.height===0)return i;if(v.width>u.width||v.height>u.height||o.x>u.width-v.width||o.y>u.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>i.width||v.height>i.height||f.x>i.width-v.width||f.y>i.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const S=u.data,C=i.data;if(S===C)throw new Error("srcData equals dstData, so image is already copied");for(let k=0;k<v.height;k++){const z=((o.y+k)*u.width+o.x)*T,N=((f.y+k)*i.width+f.x)*T;for(let j=0;j<v.width*T;j++)C[N+j]=S[z+j]}return i}class zd{constructor(i,o){Kf(this,i,1,o)}resize(i){hm(this,i,1)}clone(){return new zd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,f,v,T){Xf(i,o,f,v,T,1)}}class Ha{constructor(i,o){Kf(this,i,4,o)}resize(i){hm(this,i,4)}replace(i,o){o?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ha({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,f,v,T){Xf(i,o,f,v,T,4)}setPixel(i,o,f){const v=4*(i*this.width+o);this.data[v+0]=Math.round(255*f.r/f.a),this.data[v+1]=Math.round(255*f.g/f.a),this.data[v+2]=Math.round(255*f.b/f.a),this.data[v+3]=Math.round(255*f.a)}}function Yf(u){const i={},o=u.resolution||256,f=u.clips?u.clips.length:1,v=u.image||new Ha({width:o,height:f});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const T=(S,C,k)=>{i[u.evaluationKey]=k;const z=u.expression.evaluate(i);v.setPixel(S/4/o,C/4,z)};if(u.clips)for(let S=0,C=0;S<f;++S,C+=4*o)for(let k=0,z=0;k<o;k++,z+=4){const N=k/(o-1),{start:j,end:G}=u.clips[S];T(C,z,j*(1-N)+G*N)}else for(let S=0,C=0;S<o;S++,C+=4)T(0,C,S/(o-1));return v}Ut("AlphaImage",zd),Ut("RGBAImage",Ha);const Qf="big-fb";class Q_ extends oa{createBucket(i){return new Ng(i)}constructor(i){super(i,Y_),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Yf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Qf)&&this.heatmapFbos.delete(Qf)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let dm;var J_={get paint(){return dm=dm||new fa({"hillshade-illumination-direction":new $t(ze.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new $t(ze.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new $t(ze.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new $t(ze.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new $t(ze.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new $t(ze.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new $t(ze.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new $t(ze.paint_hillshade["hillshade-method"])})}};class Xu extends oa{constructor(i){super(i,J_),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let i=this.paint.get("hillshade-illumination-direction").values,o=this.paint.get("hillshade-illumination-altitude").values,f=this.paint.get("hillshade-highlight-color").values,v=this.paint.get("hillshade-shadow-color").values;const T=Math.max(i.length,o.length,f.length,v.length);i=i.concat(Array(T-i.length).fill(i.at(-1))),o=o.concat(Array(T-o.length).fill(o.at(-1))),f=f.concat(Array(T-f.length).fill(f.at(-1))),v=v.concat(Array(T-v.length).fill(v.at(-1)));const S=o.map(Bn);return{directionRadians:i.map(Bn),altitudeRadians:S,shadowColor:v,highlightColor:f}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let fm;var Pb={get paint(){return fm=fm||new fa({"color-relief-opacity":new $t(ze["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new qu(ze["paint_color-relief"]["color-relief-color"])})}};class pm{constructor(i,o,f,v){this.context=i,this.format=f,this.texture=i.gl.createTexture(),this.update(o,v)}update(i,o,f){const{width:v,height:T}=i,S=!(this.size&&this.size[0]===v&&this.size[1]===T||f),{context:C}=this,{gl:k}=C;if(this.useMipmap=!!(o&&o.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!o||o.premultiply!==!1)),S)this.size=[v,T],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Xa(i)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,i):k.texImage2D(k.TEXTURE_2D,0,this.format,v,T,0,this.format,k.UNSIGNED_BYTE,i.data);else{const{x:z,y:N}=f||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Xa(i)?k.texSubImage2D(k.TEXTURE_2D,0,z,N,k.RGBA,k.UNSIGNED_BYTE,i):k.texSubImage2D(k.TEXTURE_2D,0,z,N,v,T,k.RGBA,k.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D),C.pixelStoreUnpackFlipY.setDefault(),C.pixelStoreUnpack.setDefault(),C.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(i,o,f){const{context:v}=this,{gl:T}=v;T.bindTexture(T.TEXTURE_2D,this.texture),f!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=T.LINEAR),i!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,i),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,f||i),this.filter=i),o!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,o),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class su{constructor(i,o,f,v=1,T=1,S=1,C=0){if(this.uid=i,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Ir(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const k=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=v,this.greenFactor=T,this.blueFactor=S,this.baseShift=C;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let z=0;z<k;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(k,z)]=this.data[this._idx(k-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,k)]=this.data[this._idx(z,k-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(k,-1)]=this.data[this._idx(k-1,0)],this.data[this._idx(-1,k)]=this.data[this._idx(0,k-1)],this.data[this._idx(k,k)]=this.data[this._idx(k-1,k-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<k;z++)for(let N=0;N<k;N++){const j=this.get(z,N);j>this.max&&(this.max=j),j<this.min&&(this.min=j)}}get(i,o){const f=new Uint8Array(this.data.buffer),v=4*this._idx(i,o);return this.unpack(f[v],f[v+1],f[v+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(i,o){if(i<-1||i>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(i+1)}unpack(i,o,f){return i*this.redFactor+o*this.greenFactor+f*this.blueFactor-this.baseShift}pack(i){return Fg(i,this.getUnpackVector())}getPixels(){return new Ha({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,o,f){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let v=o*this.dim,T=o*this.dim+this.dim,S=f*this.dim,C=f*this.dim+this.dim;switch(o){case-1:v=T-1;break;case 1:T=v+1}switch(f){case-1:S=C-1;break;case 1:C=S+1}const k=-o*this.dim,z=-f*this.dim;for(let N=S;N<C;N++)for(let j=v;j<T;j++)this.data[this._idx(j,N)]=i.data[this._idx(j+k,N+z)]}}function Fg(u,i){const o=i[0],f=i[1],v=i[2],T=i[3],S=Math.min(o,f,v),C=Math.round((u+T)/S);return{r:Math.floor(C*S/o)%256,g:Math.floor(C*S/f)%256,b:Math.floor(C*S/v)%256}}Ut("DEMData",su);class mm extends oa{constructor(i){super(i,Pb)}_createColorRamp(i){const o={elevationStops:[],colorStops:[]},f=this._transitionablePaint._values["color-relief-color"].value.expression;if(f instanceof Aa&&f._styleExpression.expression instanceof _i){this.colorRampExpression=f;const S=f._styleExpression.expression;o.elevationStops=S.labels,o.colorStops=[];for(const C of o.elevationStops)o.colorStops.push(S.evaluate({globals:{elevation:C}}))}if(o.elevationStops.length<1&&(o.elevationStops=[0],o.colorStops=[wn.transparent]),o.elevationStops.length<2&&(o.elevationStops.push(o.elevationStops[0]+1),o.colorStops.push(o.colorStops[0])),o.elevationStops.length<=i)return o;const v={elevationStops:[],colorStops:[]},T=(o.elevationStops.length-1)/(i-1);for(let S=0;S<o.elevationStops.length-.5;S+=T)v.elevationStops.push(o.elevationStops[Math.round(S)]),v.colorStops.push(o.colorStops[Math.round(S)]);return Ir(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),v}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(i,o,f){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const v=this._createColorRamp(o),T=new Ha({width:v.colorStops.length,height:1}),S=new Ha({width:v.colorStops.length,height:1});for(let C=0;C<v.elevationStops.length;C++){const k=Fg(v.elevationStops[C],f);S.setPixel(0,C,new wn(k.r/255,k.g/255,k.b/255,1)),T.setPixel(0,C,v.colorStops[C])}return this.colorRampTextures={elevationTexture:new pm(i,S,i.gl.RGBA),colorTexture:new pm(i,T,i.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Jf=Yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ti}=Jf;function Vg(u,i,o){const f=o.patternDependencies;let v=!1;for(const T of i){const S=T.paint.get(`${u}-pattern`);S.isConstant()||(v=!0);const C=S.constantOr(null);C&&(v=!0,f[C.to]=!0,f[C.from]=!0)}return v}function jg(u,i,o,f,v){const T=v.patternDependencies;for(const S of i){const C=S.paint.get(`${u}-pattern`).value;if(C.kind!=="constant"){let k=C.evaluate({zoom:f-1},o,{},v.availableImages),z=C.evaluate({zoom:f},o,{},v.availableImages),N=C.evaluate({zoom:f+1},o,{},v.availableImages);k=k&&k.name?k.name:k,z=z&&z.name?z.name:z,N=N&&N.name?N.name:N,T[k]=!0,T[z]=!0,T[N]=!0,o.patterns[S.id]={min:k,mid:z,max:N}}}return o}function Ug(u,i,o,f,v){let T;if(v===function(S,C,k,z){let N=0;for(let j=C,G=k-z;j<k;j+=z)N+=(S[G]-S[j])*(S[j+1]+S[G+1]),G=j;return N}(u,i,o,f)>0)for(let S=i;S<o;S+=f)T=li(S/f|0,u[S],u[S+1],T);else for(let S=o-f;S>=i;S-=f)T=li(S/f|0,u[S],u[S+1],T);return T&&Vc(T,T.next)&&(Pa(T),T=T.next),T}function wl(u,i){if(!u)return u;i||(i=u);let o,f=u;do if(o=!1,f.steiner||!Vc(f,f.next)&&Fn(f.prev,f,f.next)!==0)f=f.next;else{if(Pa(f),f=i=f.prev,f===f.next)break;o=!0}while(o||f!==i);return i}function Ko(u,i,o,f,v,T,S){if(!u)return;!S&&T&&function(k,z,N,j){let G=k;do G.z===0&&(G.z=tp(G.x,G.y,z,N,j)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==k);G.prevZ.nextZ=null,G.prevZ=null,function(Y){let J,te=1;do{let le,ge=Y;Y=null;let Ne=null;for(J=0;ge;){J++;let Se=ge,X=0;for(let Ie=0;Ie<te&&(X++,Se=Se.nextZ,Se);Ie++);let oe=te;for(;X>0||oe>0&&Se;)X!==0&&(oe===0||!Se||ge.z<=Se.z)?(le=ge,ge=ge.nextZ,X--):(le=Se,Se=Se.nextZ,oe--),Ne?Ne.nextZ=le:Y=le,le.prevZ=Ne,Ne=le;ge=Se}Ne.nextZ=null,te*=2}while(J>1)}(G)}(u,f,v,T);let C=u;for(;u.prev!==u.next;){const k=u.prev,z=u.next;if(T?tv(u,f,v,T):ev(u))i.push(k.i,u.i,z.i),Pa(u),u=z.next,C=z.next;else if((u=z)===C){S?S===1?Ko(u=ep(wl(u),i),i,o,f,v,T,2):S===2&&ou(u,i,o,f,v,T):Ko(wl(u),i,o,f,v,T,1);break}}}function ev(u){const i=u.prev,o=u,f=u.next;if(Fn(i,o,f)>=0)return!1;const v=i.x,T=o.x,S=f.x,C=i.y,k=o.y,z=f.y,N=Math.min(v,T,S),j=Math.min(C,k,z),G=Math.max(v,T,S),Y=Math.max(C,k,z);let J=f.next;for(;J!==i;){if(J.x>=N&&J.x<=G&&J.y>=j&&J.y<=Y&&Od(v,C,T,k,S,z,J.x,J.y)&&Fn(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function tv(u,i,o,f){const v=u.prev,T=u,S=u.next;if(Fn(v,T,S)>=0)return!1;const C=v.x,k=T.x,z=S.x,N=v.y,j=T.y,G=S.y,Y=Math.min(C,k,z),J=Math.min(N,j,G),te=Math.max(C,k,z),le=Math.max(N,j,G),ge=tp(Y,J,i,o,f),Ne=tp(te,le,i,o,f);let Se=u.prevZ,X=u.nextZ;for(;Se&&Se.z>=ge&&X&&X.z<=Ne;){if(Se.x>=Y&&Se.x<=te&&Se.y>=J&&Se.y<=le&&Se!==v&&Se!==S&&Od(C,N,k,j,z,G,Se.x,Se.y)&&Fn(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,X.x>=Y&&X.x<=te&&X.y>=J&&X.y<=le&&X!==v&&X!==S&&Od(C,N,k,j,z,G,X.x,X.y)&&Fn(X.prev,X,X.next)>=0))return!1;X=X.nextZ}for(;Se&&Se.z>=ge;){if(Se.x>=Y&&Se.x<=te&&Se.y>=J&&Se.y<=le&&Se!==v&&Se!==S&&Od(C,N,k,j,z,G,Se.x,Se.y)&&Fn(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;X&&X.z<=Ne;){if(X.x>=Y&&X.x<=te&&X.y>=J&&X.y<=le&&X!==v&&X!==S&&Od(C,N,k,j,z,G,X.x,X.y)&&Fn(X.prev,X,X.next)>=0)return!1;X=X.nextZ}return!0}function ep(u,i){let o=u;do{const f=o.prev,v=o.next.next;!Vc(f,v)&&Gg(f,o,o.next,v)&&Nd(f,v)&&Nd(v,f)&&(i.push(f.i,o.i,v.i),Pa(o),Pa(o.next),o=u=v),o=o.next}while(o!==u);return wl(o)}function ou(u,i,o,f,v,T){let S=u;do{let C=S.next.next;for(;C!==S.prev;){if(S.i!==C.i&&Yu(S,C)){let k=Hg(S,C);return S=wl(S,S.next),k=wl(k,k.next),Ko(S,i,o,f,v,T,0),void Ko(k,i,o,f,v,T,0)}C=C.next}S=S.next}while(S!==u)}function nv(u,i){let o=u.x-i.x;return o===0&&(o=u.y-i.y,o===0)&&(o=(u.next.y-u.y)/(u.next.x-u.x)-(i.next.y-i.y)/(i.next.x-i.x)),o}function qg(u,i){const o=function(v,T){let S=T;const C=v.x,k=v.y;let z,N=-1/0;if(Vc(v,S))return S;do{if(Vc(v,S.next))return S.next;if(k<=S.y&&k>=S.next.y&&S.next.y!==S.y){const te=S.x+(k-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(te<=C&&te>N&&(N=te,z=S.x<S.next.x?S:S.next,te===C))return z}S=S.next}while(S!==T);if(!z)return null;const j=z,G=z.x,Y=z.y;let J=1/0;S=z;do{if(C>=S.x&&S.x>=G&&C!==S.x&&np(k<Y?C:N,k,G,Y,k<Y?N:C,k,S.x,S.y)){const te=Math.abs(k-S.y)/(C-S.x);Nd(S,v)&&(te<J||te===J&&(S.x>z.x||S.x===z.x&&rv(z,S)))&&(z=S,J=te)}S=S.next}while(S!==j);return z}(u,i);if(!o)return i;const f=Hg(o,u);return wl(f,f.next),wl(o,o.next)}function rv(u,i){return Fn(u.prev,u,i.prev)<0&&Fn(i.next,u,u.next)<0}function tp(u,i,o,f,v){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-o)*v|0)|u<<8))|u<<4))|u<<2))|u<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-f)*v|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function $g(u){let i=u,o=u;do(i.x<o.x||i.x===o.x&&i.y<o.y)&&(o=i),i=i.next;while(i!==u);return o}function np(u,i,o,f,v,T,S,C){return(v-S)*(i-C)>=(u-S)*(T-C)&&(u-S)*(f-C)>=(o-S)*(i-C)&&(o-S)*(T-C)>=(v-S)*(f-C)}function Od(u,i,o,f,v,T,S,C){return!(u===S&&i===C)&&np(u,i,o,f,v,T,S,C)}function Yu(u,i){return u.next.i!==i.i&&u.prev.i!==i.i&&!function(o,f){let v=o;do{if(v.i!==o.i&&v.next.i!==o.i&&v.i!==f.i&&v.next.i!==f.i&&Gg(v,v.next,o,f))return!0;v=v.next}while(v!==o);return!1}(u,i)&&(Nd(u,i)&&Nd(i,u)&&function(o,f){let v=o,T=!1;const S=(o.x+f.x)/2,C=(o.y+f.y)/2;do v.y>C!=v.next.y>C&&v.next.y!==v.y&&S<(v.next.x-v.x)*(C-v.y)/(v.next.y-v.y)+v.x&&(T=!T),v=v.next;while(v!==o);return T}(u,i)&&(Fn(u.prev,u,i.prev)||Fn(u,i.prev,i))||Vc(u,i)&&Fn(u.prev,u,u.next)>0&&Fn(i.prev,i,i.next)>0)}function Fn(u,i,o){return(i.y-u.y)*(o.x-i.x)-(i.x-u.x)*(o.y-i.y)}function Vc(u,i){return u.x===i.x&&u.y===i.y}function Gg(u,i,o,f){const v=gm(Fn(u,i,o)),T=gm(Fn(u,i,f)),S=gm(Fn(o,f,u)),C=gm(Fn(o,f,i));return v!==T&&S!==C||!(v!==0||!Yi(u,o,i))||!(T!==0||!Yi(u,f,i))||!(S!==0||!Yi(o,u,f))||!(C!==0||!Yi(o,i,f))}function Yi(u,i,o){return i.x<=Math.max(u.x,o.x)&&i.x>=Math.min(u.x,o.x)&&i.y<=Math.max(u.y,o.y)&&i.y>=Math.min(u.y,o.y)}function gm(u){return u>0?1:u<0?-1:0}function Nd(u,i){return Fn(u.prev,u,u.next)<0?Fn(u,i,u.next)>=0&&Fn(u,u.prev,i)>=0:Fn(u,i,u.prev)<0||Fn(u,u.next,i)<0}function Hg(u,i){const o=Tl(u.i,u.x,u.y),f=Tl(i.i,i.x,i.y),v=u.next,T=i.prev;return u.next=i,i.prev=u,o.next=v,v.prev=o,f.next=o,o.prev=f,T.next=f,f.prev=T,f}function li(u,i,o,f){const v=Tl(u,i,o);return f?(v.next=f.next,v.prev=f,f.next.prev=v,f.next=v):(v.prev=v,v.next=v),v}function Pa(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function Tl(u,i,o){return{i:u,x:i,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Oh{constructor(i,o){if(o>i)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=i,this._minGranularity=o}getGranularityForZoomLevel(i){return Math.max(Math.floor(this._baseZoomGranularity/(1<<i)),this._minGranularity,1)}}class rp{constructor(i){this.fill=i.fill,this.line=i.line,this.tile=i.tile,this.stencil=i.stencil,this.circle=i.circle}}rp.noSubdivision=new rp({fill:new Oh(0,0),line:new Oh(0,0),tile:new Oh(0,0),stencil:new Oh(0,0),circle:1}),Ut("SubdivisionGranularityExpression",Oh),Ut("SubdivisionGranularitySetting",rp);const Bd=-32768,Nh=32767;class So{constructor(i,o){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=i,this._granularityCellSize=At/i,this._canonical=o}_getKey(i,o){return(i+=32768)<<16|o+32768}_vertexToIndex(i,o){if(i<-32768||o<-32768||i>32767||o>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const f=0|Math.round(i),v=0|Math.round(o),T=this._getKey(f,v);if(this._vertexDictionary.has(T))return this._vertexDictionary.get(T);const S=this._vertexBuffer.length/2;return this._vertexDictionary.set(T,S),this._vertexBuffer.push(f,v),S}_subdivideTrianglesScanline(i){if(this._granularity<2)return function(v,T){const S=[];for(let C=0;C<T.length;C+=3){const k=T[C],z=T[C+1],N=T[C+2],j=v[2*k],G=v[2*k+1];(v[2*z]-j)*(v[2*N+1]-G)-(v[2*z+1]-G)*(v[2*N]-j)>0?(S.push(k),S.push(N),S.push(z)):(S.push(k),S.push(z),S.push(N))}return S}(this._vertexBuffer,i);const o=[],f=i.length;for(let v=0;v<f;v+=3){const T=[i[v+0],i[v+1],i[v+2]],S=[this._vertexBuffer[2*i[v+0]+0],this._vertexBuffer[2*i[v+0]+1],this._vertexBuffer[2*i[v+1]+0],this._vertexBuffer[2*i[v+1]+1],this._vertexBuffer[2*i[v+2]+0],this._vertexBuffer[2*i[v+2]+1]];let C=1/0,k=1/0,z=-1/0,N=-1/0;for(let te=0;te<3;te++){const le=S[2*te],ge=S[2*te+1];C=Math.min(C,le),z=Math.max(z,le),k=Math.min(k,ge),N=Math.max(N,ge)}if(C===z||k===N)continue;const j=Math.floor(C/this._granularityCellSize),G=Math.ceil(z/this._granularityCellSize),Y=Math.floor(k/this._granularityCellSize),J=Math.ceil(N/this._granularityCellSize);if(j!==G||Y!==J)for(let te=Y;te<J;te++){const le=this._scanlineGenerateVertexRingForCellRow(te,S,T);Eo(this._vertexBuffer,le,o)}else o.push(...T)}return o}_scanlineGenerateVertexRingForCellRow(i,o,f){const v=i*this._granularityCellSize,T=v+this._granularityCellSize,S=[];for(let C=0;C<3;C++){const k=o[2*C],z=o[2*C+1],N=o[2*(C+1)%6],j=o[(2*(C+1)+1)%6],G=o[2*(C+2)%6],Y=o[(2*(C+2)+1)%6],J=N-k,te=j-z,le=J===0,ge=te===0,Ne=(v-z)/te,Se=(T-z)/te,X=Math.min(Ne,Se),oe=Math.max(Ne,Se);if(!ge&&(X>=1||oe<=0)||ge&&(z<v||z>T)){j>=v&&j<=T&&S.push(f[(C+1)%3]);continue}!ge&&X>0&&S.push(this._vertexToIndex(k+J*X,z+te*X));const Ie=k+J*Math.max(X,0),nt=k+J*Math.min(oe,1);le||this._generateIntraEdgeVertices(S,k,z,N,j,Ie,nt),!ge&&oe<1&&S.push(this._vertexToIndex(k+J*oe,z+te*oe)),(ge||j>=v&&j<=T)&&S.push(f[(C+1)%3]),!ge&&(j<=v||j>=T)&&this._generateInterEdgeVertices(S,k,z,N,j,G,Y,nt,v,T)}return S}_generateIntraEdgeVertices(i,o,f,v,T,S,C){const k=v-o,z=T-f,N=z===0,j=N?Math.min(o,v):Math.min(S,C),G=N?Math.max(o,v):Math.max(S,C),Y=Math.floor(j/this._granularityCellSize)+1,J=Math.ceil(G/this._granularityCellSize)-1;if(N?o<v:S<C)for(let te=Y;te<=J;te++){const le=te*this._granularityCellSize;i.push(this._vertexToIndex(le,f+z*(le-o)/k))}else for(let te=J;te>=Y;te--){const le=te*this._granularityCellSize;i.push(this._vertexToIndex(le,f+z*(le-o)/k))}}_generateInterEdgeVertices(i,o,f,v,T,S,C,k,z,N){const j=T-f,G=S-v,Y=C-T,J=(z-T)/Y,te=(N-T)/Y,le=Math.min(J,te),ge=Math.max(J,te),Ne=v+G*le;let Se=Math.floor(Math.min(Ne,k)/this._granularityCellSize)+1,X=Math.ceil(Math.max(Ne,k)/this._granularityCellSize)-1,oe=k<Ne;const Ie=Y===0;if(Ie&&(C===z||C===N))return;if(Ie||le>=1||ge<=0){const yt=f-C,lt=S+(o-S)*Math.min((z-C)/yt,(N-C)/yt);Se=Math.floor(Math.min(lt,k)/this._granularityCellSize)+1,X=Math.ceil(Math.max(lt,k)/this._granularityCellSize)-1,oe=k<lt}const nt=j>0?N:z;if(oe)for(let yt=Se;yt<=X;yt++)i.push(this._vertexToIndex(yt*this._granularityCellSize,nt));else for(let yt=X;yt>=Se;yt--)i.push(this._vertexToIndex(yt*this._granularityCellSize,nt))}_generateOutline(i){const o=[];for(const f of i){const v=jc(f,this._granularity,!0),T=this._pointArrayToIndices(v),S=[];for(let C=1;C<T.length;C++)S.push(T[C-1]),S.push(T[C]);o.push(S)}return o}_handlePoles(i){let o=!1,f=!1;this._canonical&&(this._canonical.y===0&&(o=!0),this._canonical.y===(1<<this._canonical.z)-1&&(f=!0)),(o||f)&&this._fillPoles(i,o,f)}_ensureNoPoleVertices(){const i=this._vertexBuffer;for(let o=0;o<i.length;o+=2){const f=i[o+1];f===Bd&&(i[o+1]=-32767),f===Nh&&(i[o+1]=32766)}}_generatePoleQuad(i,o,f,v,T,S){v>T!=(S===Bd)?(i.push(o),i.push(f),i.push(this._vertexToIndex(v,S)),i.push(f),i.push(this._vertexToIndex(T,S)),i.push(this._vertexToIndex(v,S))):(i.push(f),i.push(o),i.push(this._vertexToIndex(v,S)),i.push(this._vertexToIndex(T,S)),i.push(f),i.push(this._vertexToIndex(v,S)))}_fillPoles(i,o,f){const v=this._vertexBuffer,T=At,S=i.length;for(let C=2;C<S;C+=3){const k=i[C-2],z=i[C-1],N=i[C],j=v[2*k],G=v[2*k+1],Y=v[2*z],J=v[2*z+1],te=v[2*N],le=v[2*N+1];o&&(G===0&&J===0&&this._generatePoleQuad(i,k,z,j,Y,Bd),J===0&&le===0&&this._generatePoleQuad(i,z,N,Y,te,Bd),le===0&&G===0&&this._generatePoleQuad(i,N,k,te,j,Bd)),f&&(G===T&&J===T&&this._generatePoleQuad(i,k,z,j,Y,Nh),J===T&&le===T&&this._generatePoleQuad(i,z,N,Y,te,Nh),le===T&&G===T&&this._generatePoleQuad(i,N,k,te,j,Nh))}}_initializeVertices(i){for(let o=0;o<i.length;o+=2)this._vertexToIndex(i[o],i[o+1])}subdividePolygonInternal(i,o){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:f,holeIndices:v}=function(C){const k=[],z=[];for(const N of C)if(N.length!==0){N!==C[0]&&k.push(z.length/2);for(let j=0;j<N.length;j++)z.push(N[j].x),z.push(N[j].y)}return{flattened:z,holeIndices:k}}(i);let T;this._initializeVertices(f);try{const C=function(z,N,j=2){const G=N&&N.length,Y=G?N[0]*j:z.length;let J=Ug(z,0,Y,j,!0);const te=[];if(!J||J.next===J.prev)return te;let le,ge,Ne;if(G&&(J=function(Se,X,oe,Ie){const nt=[];for(let yt=0,lt=X.length;yt<lt;yt++){const ft=Ug(Se,X[yt]*Ie,yt<lt-1?X[yt+1]*Ie:Se.length,Ie,!1);ft===ft.next&&(ft.steiner=!0),nt.push($g(ft))}nt.sort(nv);for(let yt=0;yt<nt.length;yt++)oe=qg(nt[yt],oe);return oe}(z,N,J,j)),z.length>80*j){le=1/0,ge=1/0;let Se=-1/0,X=-1/0;for(let oe=j;oe<Y;oe+=j){const Ie=z[oe],nt=z[oe+1];Ie<le&&(le=Ie),nt<ge&&(ge=nt),Ie>Se&&(Se=Ie),nt>X&&(X=nt)}Ne=Math.max(Se-le,X-ge),Ne=Ne!==0?32767/Ne:0}return Ko(J,te,j,le,ge,Ne,0),te}(f,v),k=this._convertIndices(f,C);T=this._subdivideTrianglesScanline(k)}catch(C){console.error(C)}let S=[];return o&&(S=this._generateOutline(i)),this._ensureNoPoleVertices(),this._handlePoles(T),{verticesFlattened:this._vertexBuffer,indicesTriangles:T,indicesLineList:S}}_convertIndices(i,o){const f=[];for(let v=0;v<o.length;v++)f.push(this._vertexToIndex(i[2*o[v]],i[2*o[v]+1]));return f}_pointArrayToIndices(i){const o=[];for(let f=0;f<i.length;f++){const v=i[f];o.push(this._vertexToIndex(v.x,v.y))}return o}}function Xo(u,i,o,f=!0){return new So(o,i).subdividePolygonInternal(u,f)}function jc(u,i,o=!1){if(!u||u.length<1)return[];if(u.length<2)return[];const f=u[0],v=u[u.length-1],T=o&&(f.x!==v.x||f.y!==v.y);if(i<2)return T?[...u,u[0]]:[...u];const S=Math.floor(At/i),C=[];C.push(new re(u[0].x,u[0].y));const k=u.length,z=T?k:k-1;for(let N=0;N<z;N++){const j=u[N],G=N<k-1?u[N+1]:u[0],Y=j.x,J=j.y,te=G.x,le=G.y,ge=Y!==te,Ne=J!==le;if(!ge&&!Ne)continue;const Se=te-Y,X=le-J,oe=Math.abs(Se),Ie=Math.abs(X);let nt=Y,yt=J;for(;;){const ft=Se>0?(Math.floor(nt/S)+1)*S:(Math.ceil(nt/S)-1)*S,Ct=X>0?(Math.floor(yt/S)+1)*S:(Math.ceil(yt/S)-1)*S,xt=Math.abs(nt-ft),Rt=Math.abs(yt-Ct),gt=Math.abs(nt-te),Wt=Math.abs(yt-le),sn=ge?xt/oe:Number.POSITIVE_INFINITY,Yt=Ne?Rt/Ie:Number.POSITIVE_INFINITY;if((gt<=xt||!ge)&&(Wt<=Rt||!Ne))break;if(sn<Yt&&ge||!Ne){nt=ft,yt+=X*sn;const Ht=new re(nt,Math.round(yt));C[C.length-1].x===Ht.x&&C[C.length-1].y===Ht.y||C.push(Ht)}else{nt+=Se*Yt,yt=Ct;const Ht=new re(Math.round(nt),yt);C[C.length-1].x===Ht.x&&C[C.length-1].y===Ht.y||C.push(Ht)}}const lt=new re(te,le);C[C.length-1].x===lt.x&&C[C.length-1].y===lt.y||C.push(lt)}return C}function Eo(u,i,o){if(i.length===0)throw new Error("Subdivision vertex ring is empty.");let f=0,v=u[2*i[0]];for(let k=1;k<i.length;k++){const z=u[2*i[k]];z<v&&(v=z,f=k)}const T=i.length;let S=f,C=(S+1)%T;for(;;){const k=S-1>=0?S-1:T-1,z=(C+1)%T,N=u[2*i[k]],j=u[2*i[z]],G=u[2*i[S]],Y=u[2*i[S]+1],J=u[2*i[C]+1];let te=!1;if(N<j)te=!0;else if(N>j)te=!1;else{const le=J-Y,ge=-(u[2*i[C]]-G),Ne=Y<J?1:-1;((N-G)*le+(u[2*i[k]+1]-Y)*ge)*Ne>((j-G)*le+(u[2*i[z]+1]-Y)*ge)*Ne&&(te=!0)}if(te){const le=i[k],ge=i[S],Ne=i[C];le!==ge&&le!==Ne&&ge!==Ne&&o.push(Ne,ge,le),S--,S<0&&(S=T-1)}else{const le=i[z],ge=i[S],Ne=i[C];le!==ge&&le!==Ne&&ge!==Ne&&o.push(Ne,ge,le),C++,C>=T&&(C=0)}if(k===z)break}}function Zg(u,i,o,f,v,T,S,C,k){const z=v.length/2,N=S&&C&&k;if(z<Zn.MAX_VERTEX_ARRAY_LENGTH){const j=i.prepareSegment(z,o,f),G=j.vertexLength;for(let te=0;te<T.length;te+=3)f.emplaceBack(G+T[te],G+T[te+1],G+T[te+2]);let Y,J;j.vertexLength+=z,j.primitiveLength+=T.length/3,N&&(J=S.prepareSegment(z,o,C),Y=J.vertexLength,J.vertexLength+=z);for(let te=0;te<v.length;te+=2)u(v[te],v[te+1]);if(N)for(let te=0;te<k.length;te++){const le=k[te];for(let ge=1;ge<le.length;ge+=2)C.emplaceBack(Y+le[ge-1],Y+le[ge]);J.primitiveLength+=le.length/2}}else(function(j,G,Y,J,te,le){const ge=[];for(let Ie=0;Ie<J.length/2;Ie++)ge.push(-1);const Ne={count:0};let Se=0,X=j.getOrCreateLatestSegment(G,Y),oe=X.vertexLength;for(let Ie=2;Ie<te.length;Ie+=3){const nt=te[Ie-2],yt=te[Ie-1],lt=te[Ie];let ft=ge[nt]<Se,Ct=ge[yt]<Se,xt=ge[lt]<Se;X.vertexLength+((ft?1:0)+(Ct?1:0)+(xt?1:0))>Zn.MAX_VERTEX_ARRAY_LENGTH&&(X=j.createNewSegment(G,Y),Se=Ne.count,ft=!0,Ct=!0,xt=!0,oe=0);const Rt=Yo(ge,J,le,Ne,nt,ft,X),gt=Yo(ge,J,le,Ne,yt,Ct,X),Wt=Yo(ge,J,le,Ne,lt,xt,X);Y.emplaceBack(oe+Rt-Se,oe+gt-Se,oe+Wt-Se),X.primitiveLength++}})(i,o,f,v,T,u),N&&function(j,G,Y,J,te,le){const ge=[];for(let Ie=0;Ie<J.length/2;Ie++)ge.push(-1);const Ne={count:0};let Se=0,X=j.getOrCreateLatestSegment(G,Y),oe=X.vertexLength;for(let Ie=0;Ie<te.length;Ie++){const nt=te[Ie];for(let yt=1;yt<te[Ie].length;yt+=2){const lt=nt[yt-1],ft=nt[yt];let Ct=ge[lt]<Se,xt=ge[ft]<Se;X.vertexLength+((Ct?1:0)+(xt?1:0))>Zn.MAX_VERTEX_ARRAY_LENGTH&&(X=j.createNewSegment(G,Y),Se=Ne.count,Ct=!0,xt=!0,oe=0);const Rt=Yo(ge,J,le,Ne,lt,Ct,X),gt=Yo(ge,J,le,Ne,ft,xt,X);Y.emplaceBack(oe+Rt-Se,oe+gt-Se),X.primitiveLength++}}}(S,o,C,v,k,u),i.forceNewSegmentOnNextPrepare(),S==null||S.forceNewSegmentOnNextPrepare()}function Yo(u,i,o,f,v,T,S){if(T){const C=f.count;return o(i[2*v],i[2*v+1]),u[v]=f.count,f.count++,S.vertexLength++,C}return u[v]}class Qu{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ot,this.indexArray=new yr,this.indexArray2=new _r,this.programConfigurations=new Ga(i.layers,i.zoom),this.segments=new Zn,this.segments2=new Zn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.hasPattern=Vg("fill",this.layers,o);const v=this.layers[0].layout.get("fill-sort-key"),T=!v.isConstant(),S=[];for(const{feature:C,id:k,index:z,sourceLayerIndex:N}of i){const j=this.layers[0]._featureFilter.needGeometry,G=Fc(C,j);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom,{globalState:this.globalState}),G,f))continue;const Y=T?v.evaluate(G,{},f,o.availableImages):void 0,J={id:k,properties:C.properties,type:C.type,sourceLayerIndex:N,index:z,geometry:j?G.geometry:Ku(C),patterns:{},sortKey:Y};S.push(J)}T&&S.sort((C,k)=>C.sortKey-k.sortKey);for(const C of S){const{geometry:k,index:z,sourceLayerIndex:N}=C;if(this.hasPattern){const j=jg("fill",this.layers,C,this.zoom,o);this.patternFeatures.push(j)}else this.addFeature(C,k,z,f,{},o.subdivisionGranularity);o.featureIndex.insert(i[z].feature,k,z,N,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,f)}addFeatures(i,o,f){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,f,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Ti),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,o,f,v,T,S){for(const C of gd(o,500)){const k=Xo(C,v,S.fill.getGranularityForZoomLevel(v.z)),z=this.layoutVertexArray;Zg((N,j)=>{z.emplaceBack(N,j)},this.segments,this.layoutVertexArray,this.indexArray,k.verticesFlattened,k.indicesTriangles,this.segments2,this.indexArray2,k.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,T,v)}}let Ju,ym;Ut("FillBucket",Qu,{omit:["layers","patternFeatures"]});var Wg={get paint(){return ym=ym||new fa({"fill-antialias":new $t(ze.paint_fill["fill-antialias"]),"fill-opacity":new rn(ze.paint_fill["fill-opacity"]),"fill-color":new rn(ze.paint_fill["fill-color"]),"fill-outline-color":new rn(ze.paint_fill["fill-outline-color"]),"fill-translate":new $t(ze.paint_fill["fill-translate"]),"fill-translate-anchor":new $t(ze.paint_fill["fill-translate-anchor"]),"fill-pattern":new Rd(ze.paint_fill["fill-pattern"])})},get layout(){return Ju=Ju||new fa({"fill-sort-key":new rn(ze.layout_fill["fill-sort-key"])})}};class lu extends oa{constructor(i){super(i,Wg)}recalculate(i,o){super.recalculate(i,o);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Qu(i)}queryRadius(){return Zf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:i,geometry:o,transform:f,pixelsToTileUnits:v}){return kg(Wf(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-f.bearingInRadians,v),o)}isTileClipped(){return!0}}const iv=Yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Fd=Yr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ip}=iv;var Bh,Fh,_m,Kg,Vh,Xg,ap,sp={};function av(){if(Fh)return Bh;Fh=1;var u=K();function i(v,T,S,C,k){this.properties={},this.extent=S,this.type=0,this._pbf=v,this._geometry=-1,this._keys=C,this._values=k,v.readFields(o,this,T)}function o(v,T,S){v==1?T.id=S.readVarint():v==2?function(C,k){for(var z=C.readVarint()+C.pos;C.pos<z;){var N=k._keys[C.readVarint()],j=k._values[C.readVarint()];k.properties[N]=j}}(S,T):v==3?T.type=S.readVarint():v==4&&(T._geometry=S.pos)}function f(v){for(var T,S,C=0,k=0,z=v.length,N=z-1;k<z;N=k++)C+=((S=v[N]).x-(T=v[k]).x)*(T.y+S.y);return C}return Bh=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var v=this._pbf;v.pos=this._geometry;for(var T,S=v.readVarint()+v.pos,C=1,k=0,z=0,N=0,j=[];v.pos<S;){if(k<=0){var G=v.readVarint();C=7&G,k=G>>3}if(k--,C===1||C===2)z+=v.readSVarint(),N+=v.readSVarint(),C===1&&(T&&j.push(T),T=[]),T.push(new u(z,N));else{if(C!==7)throw new Error("unknown command "+C);T&&T.push(T[0].clone())}}return T&&j.push(T),j},i.prototype.bbox=function(){var v=this._pbf;v.pos=this._geometry;for(var T=v.readVarint()+v.pos,S=1,C=0,k=0,z=0,N=1/0,j=-1/0,G=1/0,Y=-1/0;v.pos<T;){if(C<=0){var J=v.readVarint();S=7&J,C=J>>3}if(C--,S===1||S===2)(k+=v.readSVarint())<N&&(N=k),k>j&&(j=k),(z+=v.readSVarint())<G&&(G=z),z>Y&&(Y=z);else if(S!==7)throw new Error("unknown command "+S)}return[N,G,j,Y]},i.prototype.toGeoJSON=function(v,T,S){var C,k,z=this.extent*Math.pow(2,S),N=this.extent*v,j=this.extent*T,G=this.loadGeometry(),Y=i.types[this.type];function J(ge){for(var Ne=0;Ne<ge.length;Ne++){var Se=ge[Ne];ge[Ne]=[360*(Se.x+N)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(Se.y+j)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var te=[];for(C=0;C<G.length;C++)te[C]=G[C][0];J(G=te);break;case 2:for(C=0;C<G.length;C++)J(G[C]);break;case 3:for(G=function(ge){var Ne=ge.length;if(Ne<=1)return[ge];for(var Se,X,oe=[],Ie=0;Ie<Ne;Ie++){var nt=f(ge[Ie]);nt!==0&&(X===void 0&&(X=nt<0),X===nt<0?(Se&&oe.push(Se),Se=[ge[Ie]]):Se.push(ge[Ie]))}return Se&&oe.push(Se),oe}(G),C=0;C<G.length;C++)for(k=0;k<G[C].length;k++)J(G[C][k])}G.length===1?G=G[0]:Y="Multi"+Y;var le={type:"Feature",geometry:{type:Y,coordinates:G},properties:this.properties};return"id"in this&&(le.id=this.id),le},Bh}function sv(){if(Kg)return _m;Kg=1;var u=av();function i(f,v){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(o,this,v),this.length=this._features.length}function o(f,v,T){f===15?v.version=T.readVarint():f===1?v.name=T.readString():f===5?v.extent=T.readVarint():f===2?v._features.push(T.pos):f===3?v._keys.push(T.readString()):f===4&&v._values.push(function(S){for(var C=null,k=S.readVarint()+S.pos;S.pos<k;){var z=S.readVarint()>>3;C=z===1?S.readString():z===2?S.readFloat():z===3?S.readDouble():z===4?S.readVarint64():z===5?S.readVarint():z===6?S.readSVarint():z===7?S.readBoolean():null}return C}(T))}return _m=i,i.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var v=this._pbf.readVarint()+this._pbf.pos;return new u(this._pbf,v,this.extent,this._keys,this._values)},_m}function Mr(){return ap||(ap=1,sp.VectorTile=function(){if(Xg)return Vh;Xg=1;var u=sv();function i(o,f,v){if(o===3){var T=new u(v,v.readVarint()+v.pos);T.length&&(f[T.name]=T)}}return Vh=function(o,f){this.layers=o.readFields(i,{},f)},Vh}(),sp.VectorTileFeature=av(),sp.VectorTileLayer=sv()),sp}var Pr=M(Mr());const Jn=Pr.VectorTileFeature.types,rr=Math.pow(2,13);function hr(u,i,o,f,v,T,S,C){u.emplaceBack(i,o,2*Math.floor(f*rr)+S,v*rr*2,T*rr*2,Math.round(C))}class Es{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new zt,this.centroidVertexArray=new Ye,this.indexArray=new yr,this.programConfigurations=new Ga(i.layers,i.zoom),this.segments=new Zn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.features=[],this.hasPattern=Vg("fill-extrusion",this.layers,o);for(const{feature:v,id:T,index:S,sourceLayerIndex:C}of i){const k=this.layers[0]._featureFilter.needGeometry,z=Fc(v,k);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom,{globalState:this.globalState}),z,f))continue;const N={id:T,sourceLayerIndex:C,index:S,geometry:k?z.geometry:Ku(v),properties:v.properties,type:v.type,patterns:{}};this.hasPattern?this.features.push(jg("fill-extrusion",this.layers,N,this.zoom,o)):this.addFeature(N,N.geometry,S,f,{},o.subdivisionGranularity),o.featureIndex.insert(v,N.geometry,S,C,this.index,!0)}}addFeatures(i,o,f){for(const v of this.features){const{geometry:T}=v;this.addFeature(v,T,v.index,o,f,i.subdivisionGranularity)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ip),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,Fd.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,o,f,v,T,S){for(const C of gd(o,500)){const k={x:0,y:0,sampleCount:0},z=this.layoutVertexArray.length;this.processPolygon(k,v,i,C,S);const N=this.layoutVertexArray.length-z,j=Math.floor(k.x/k.sampleCount),G=Math.floor(k.y/k.sampleCount);for(let Y=0;Y<N;Y++)this.centroidVertexArray.emplaceBack(j,G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,T,v)}processPolygon(i,o,f,v,T){if(v.length<1||vm(v[0]))return;for(const j of v)j.length!==0&&Uc(i,j);const S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},C=T.fill.getGranularityForZoomLevel(o.z),k=Jn[f.type]==="Polygon";for(const j of v){if(j.length===0||vm(j))continue;const G=jc(j,C,k);this._generateSideFaces(G,S)}if(!k)return;const z=Xo(v,o,C,!1),N=this.layoutVertexArray;Zg((j,G)=>{hr(N,j,G,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,z.verticesFlattened,z.indicesTriangles)}_generateSideFaces(i,o){let f=0;for(let v=1;v<i.length;v++){const T=i[v],S=i[v-1];if(Vd(T,S))continue;o.segment.vertexLength+4>Zn.MAX_VERTEX_ARRAY_LENGTH&&(o.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const C=T.sub(S)._perp()._unit(),k=S.dist(T);f+k>32768&&(f=0),hr(this.layoutVertexArray,T.x,T.y,C.x,C.y,0,0,f),hr(this.layoutVertexArray,T.x,T.y,C.x,C.y,0,1,f),f+=k,hr(this.layoutVertexArray,S.x,S.y,C.x,C.y,0,0,f),hr(this.layoutVertexArray,S.x,S.y,C.x,C.y,0,1,f);const z=o.segment.vertexLength;this.indexArray.emplaceBack(z,z+2,z+1),this.indexArray.emplaceBack(z+1,z+2,z+3),o.segment.vertexLength+=4,o.segment.primitiveLength+=2}}}function Uc(u,i){for(let o=0;o<i.length;o++){const f=i[o];o===i.length-1&&i[0].x===f.x&&i[0].y===f.y||(u.x+=f.x,u.y+=f.y,u.sampleCount++)}}function Vd(u,i){return u.x===i.x&&(u.x<0||u.x>At)||u.y===i.y&&(u.y<0||u.y>At)}function vm(u){return u.every(i=>i.x<0)||u.every(i=>i.x>At)||u.every(i=>i.y<0)||u.every(i=>i.y>At)}let uu;Ut("FillExtrusionBucket",Es,{omit:["layers","features"]});var Vi={get paint(){return uu=uu||new fa({"fill-extrusion-opacity":new $t(ze["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new rn(ze["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new $t(ze["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new $t(ze["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Rd(ze["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new rn(ze["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new rn(ze["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new $t(ze["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class qc extends oa{constructor(i){super(i,Vi)}createBucket(i){return new Es(i)}queryRadius(){return Zf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:v,transform:T,pixelsToTileUnits:S,pixelPosMatrix:C}){const k=Wf(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-T.bearingInRadians,S),z=this.paint.get("fill-extrusion-height").evaluate(o,f),N=this.paint.get("fill-extrusion-base").evaluate(o,f),j=function(Y,J){const te=[];for(const le of Y){const ge=[le.x,le.y,0,1];Mt(ge,ge,J),te.push(new re(ge[0]/ge[3],ge[1]/ge[3]))}return te}(k,C),G=function(Y,J,te,le){const ge=[],Ne=[],Se=le[8]*J,X=le[9]*J,oe=le[10]*J,Ie=le[11]*J,nt=le[8]*te,yt=le[9]*te,lt=le[10]*te,ft=le[11]*te;for(const Ct of Y){const xt=[],Rt=[];for(const gt of Ct){const Wt=gt.x,sn=gt.y,Yt=le[0]*Wt+le[4]*sn+le[12],Ht=le[1]*Wt+le[5]*sn+le[13],Sn=le[2]*Wt+le[6]*sn+le[14],Vr=le[3]*Wt+le[7]*sn+le[15],ui=Sn+oe,ci=Vr+Ie,Co=Yt+nt,rs=Ht+yt,Ei=Sn+lt,ri=Vr+ft,Qi=new re((Yt+Se)/ci,(Ht+X)/ci);Qi.z=ui/ci,xt.push(Qi);const ji=new re(Co/ri,rs/ri);ji.z=Ei/ri,Rt.push(ji)}ge.push(xt),Ne.push(Rt)}return[ge,Ne]}(v,N,z,C);return function(Y,J,te){let le=1/0;kg(te,J)&&(le=bm(te,J[0]));for(let ge=0;ge<J.length;ge++){const Ne=J[ge],Se=Y[ge];for(let X=0;X<Ne.length-1;X++){const oe=Ne[X],Ie=[oe,Ne[X+1],Se[X+1],Se[X],oe];Rg(te,Ie)&&(le=Math.min(le,bm(te,Ie)))}}return le!==1/0&&le}(G[0],G[1],j)}}function Sl(u,i){return u.x*i.x+u.y*i.y}function bm(u,i){if(u.length===1){let o=0;const f=i[o++];let v;for(;!v||f.equals(v);)if(v=i[o++],!v)return 1/0;for(;o<i.length;o++){const T=i[o],S=u[0],C=v.sub(f),k=T.sub(f),z=S.sub(f),N=Sl(C,C),j=Sl(C,k),G=Sl(k,k),Y=Sl(z,C),J=Sl(z,k),te=N*G-j*j,le=(G*Y-j*J)/te,ge=(N*J-j*Y)/te,Ne=f.z*(1-le-ge)+v.z*le+T.z*ge;if(isFinite(Ne))return Ne}return 1/0}{let o=1/0;for(const f of i)o=Math.min(o,f.z);return o}}const Qo=Yr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:jd}=Qo,op=Yr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ws}=op,Yg=Pr.VectorTileFeature.types,Qg=Math.cos(Math.PI/180*37.5),lp=Math.pow(2,14)/.5;class Ud{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Lt,this.layoutVertexArray2=new bt,this.indexArray=new yr,this.programConfigurations=new Ga(i.layers,i.zoom),this.segments=new Zn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.hasPattern=Vg("line",this.layers,o);const v=this.layers[0].layout.get("line-sort-key"),T=!v.isConstant(),S=[];for(const{feature:C,id:k,index:z,sourceLayerIndex:N}of i){const j=this.layers[0]._featureFilter.needGeometry,G=Fc(C,j);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom,{globalState:this.globalState}),G,f))continue;const Y=T?v.evaluate(G,{},f):void 0,J={id:k,properties:C.properties,type:C.type,sourceLayerIndex:N,index:z,geometry:j?G.geometry:Ku(C),patterns:{},sortKey:Y};S.push(J)}T&&S.sort((C,k)=>C.sortKey-k.sortKey);for(const C of S){const{geometry:k,index:z,sourceLayerIndex:N}=C;if(this.hasPattern){const j=jg("line",this.layers,C,this.zoom,o);this.patternFeatures.push(j)}else this.addFeature(C,k,z,f,{},o.subdivisionGranularity);o.featureIndex.insert(i[z].feature,k,z,N,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,f)}addFeatures(i,o,f){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,f,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Ws)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,jd),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,o,f,v,T,S){const C=this.layers[0].layout,k=C.get("line-join").evaluate(i,{}),z=C.get("line-cap"),N=C.get("line-miter-limit"),j=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const G of o)this.addLine(G,i,k,z,N,j,v,S);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,T,v)}addLine(i,o,f,v,T,S,C,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,i=jc(i,C?k.line.getGranularityForZoomLevel(C.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Se=0;Se<i.length-1;Se++)this.totalDistance+=i[Se].dist(i[Se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const z=Yg[o.type]==="Polygon";let N=i.length;for(;N>=2&&i[N-1].equals(i[N-2]);)N--;let j=0;for(;j<N-1&&i[j].equals(i[j+1]);)j++;if(N<(z?3:2))return;f==="bevel"&&(T=1.05);const G=this.overscaling<=16?122880/(512*this.overscaling):0,Y=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let J,te,le,ge,Ne;this.e1=this.e2=-1,z&&(J=i[N-2],Ne=i[j].sub(J)._unit()._perp());for(let Se=j;Se<N;Se++){if(le=Se===N-1?z?i[j+1]:void 0:i[Se+1],le&&i[Se].equals(le))continue;Ne&&(ge=Ne),J&&(te=J),J=i[Se],Ne=le?le.sub(J)._unit()._perp():ge,ge=ge||Ne;let X=ge.add(Ne);X.x===0&&X.y===0||X._unit();const oe=ge.x*Ne.x+ge.y*Ne.y,Ie=X.x*Ne.x+X.y*Ne.y,nt=Ie!==0?1/Ie:1/0,yt=2*Math.sqrt(2-2*Ie),lt=Ie<Qg&&te&&le,ft=ge.x*Ne.y-ge.y*Ne.x>0;if(lt&&Se>j){const Rt=J.dist(te);if(Rt>2*G){const gt=J.sub(J.sub(te)._mult(G/Rt)._round());this.updateDistance(te,gt),this.addCurrentVertex(gt,ge,0,0,Y),te=gt}}const Ct=te&&le;let xt=Ct?f:z?"butt":v;if(Ct&&xt==="round"&&(nt<S?xt="miter":nt<=2&&(xt="fakeround")),xt==="miter"&&nt>T&&(xt="bevel"),xt==="bevel"&&(nt>2&&(xt="flipbevel"),nt<T&&(xt="miter")),te&&this.updateDistance(te,J),xt==="miter")X._mult(nt),this.addCurrentVertex(J,X,0,0,Y);else if(xt==="flipbevel"){if(nt>100)X=Ne.mult(-1);else{const Rt=nt*ge.add(Ne).mag()/ge.sub(Ne).mag();X._perp()._mult(Rt*(ft?-1:1))}this.addCurrentVertex(J,X,0,0,Y),this.addCurrentVertex(J,X.mult(-1),0,0,Y)}else if(xt==="bevel"||xt==="fakeround"){const Rt=-Math.sqrt(nt*nt-1),gt=ft?Rt:0,Wt=ft?0:Rt;if(te&&this.addCurrentVertex(J,ge,gt,Wt,Y),xt==="fakeround"){const sn=Math.round(180*yt/Math.PI/20);for(let Yt=1;Yt<sn;Yt++){let Ht=Yt/sn;if(Ht!==.5){const Vr=Ht-.5;Ht+=Ht*Vr*(Ht-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*Vr*Vr+(.848013+oe*(.215638*oe-1.06021)))}const Sn=Ne.sub(ge)._mult(Ht)._add(ge)._unit()._mult(ft?-1:1);this.addHalfVertex(J,Sn.x,Sn.y,!1,ft,0,Y)}}le&&this.addCurrentVertex(J,Ne,-gt,-Wt,Y)}else if(xt==="butt")this.addCurrentVertex(J,X,0,0,Y);else if(xt==="square"){const Rt=te?1:-1;this.addCurrentVertex(J,X,Rt,Rt,Y)}else xt==="round"&&(te&&(this.addCurrentVertex(J,ge,0,0,Y),this.addCurrentVertex(J,ge,1,1,Y,!0)),le&&(this.addCurrentVertex(J,Ne,-1,-1,Y,!0),this.addCurrentVertex(J,Ne,0,0,Y)));if(lt&&Se<N-1){const Rt=J.dist(le);if(Rt>2*G){const gt=J.add(le.sub(J)._mult(G/Rt)._round());this.updateDistance(J,gt),this.addCurrentVertex(gt,Ne,0,0,Y),J=gt}}}}addCurrentVertex(i,o,f,v,T,S=!1){const C=o.y*v-o.x,k=-o.y-o.x*v;this.addHalfVertex(i,o.x+o.y*f,o.y-o.x*f,S,!1,f,T),this.addHalfVertex(i,C,k,S,!0,-v,T),this.distance>lp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,o,f,v,T,S))}addHalfVertex({x:i,y:o},f,v,T,S,C,k){const z=.5*(this.lineClips?this.scaledDistance*(lp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(T?1:0),(o<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*v)+128,1+(C===0?0:C<0?-1:1)|(63&z)<<2,z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,N,this.e2),k.primitiveLength++),S?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,o){this.distance+=i.dist(o),this.updateScaledDistance()}}let ec,Ra;Ut("LineBucket",Ud,{omit:["layers","patternFeatures"]});var tc={get paint(){return Ra=Ra||new fa({"line-opacity":new rn(ze.paint_line["line-opacity"]),"line-color":new rn(ze.paint_line["line-color"]),"line-translate":new $t(ze.paint_line["line-translate"]),"line-translate-anchor":new $t(ze.paint_line["line-translate-anchor"]),"line-width":new rn(ze.paint_line["line-width"]),"line-gap-width":new rn(ze.paint_line["line-gap-width"]),"line-offset":new rn(ze.paint_line["line-offset"]),"line-blur":new rn(ze.paint_line["line-blur"]),"line-dasharray":new si(ze.paint_line["line-dasharray"]),"line-pattern":new Rd(ze.paint_line["line-pattern"]),"line-gradient":new qu(ze.paint_line["line-gradient"])})},get layout(){return ec=ec||new fa({"line-cap":new $t(ze.layout_line["line-cap"]),"line-join":new rn(ze.layout_line["line-join"]),"line-miter-limit":new $t(ze.layout_line["line-miter-limit"]),"line-round-limit":new $t(ze.layout_line["line-round-limit"]),"line-sort-key":new rn(ze.layout_line["line-sort-key"])})}};class qd extends rn{possiblyEvaluate(i,o){return o=new Lr(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(i,o)}evaluate(i,o,f,v){return o=gi({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(i,o,f,v)}}let nc;class Jg extends oa{constructor(i){super(i,tc),this.gradientVersion=0,nc||(nc=new qd(tc.paint.properties["line-width"].specification),nc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof Fl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,o){super.recalculate(i,o),this.paint._values["line-floorwidth"]=nc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Ud(i)}queryRadius(i){const o=i,f=xm(Xi("line-width",this,o),Xi("line-gap-width",this,o)),v=Xi("line-offset",this,o);return f/2+Math.abs(v)+Zf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:v,transform:T,pixelsToTileUnits:S}){const C=Wf(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-T.bearingInRadians,S),k=S/2*xm(this.paint.get("line-width").evaluate(o,f),this.paint.get("line-gap-width").evaluate(o,f)),z=this.paint.get("line-offset").evaluate(o,f);return z&&(v=function(N,j){const G=[];for(let Y=0;Y<N.length;Y++){const J=N[Y],te=[];for(let le=0;le<J.length;le++){const ge=J[le-1],Ne=J[le],Se=J[le+1],X=le===0?new re(0,0):Ne.sub(ge)._unit()._perp(),oe=le===J.length-1?new re(0,0):Se.sub(Ne)._unit()._perp(),Ie=X._add(oe)._unit(),nt=Ie.x*oe.x+Ie.y*oe.y;nt!==0&&Ie._mult(1/nt),te.push(Ie._mult(j)._add(Ne))}G.push(te)}return G}(v,z*S)),function(N,j,G){for(let Y=0;Y<j.length;Y++){const J=j[Y];if(N.length>=3){for(let te=0;te<J.length;te++)if(zh(N,J[te]))return!0}if(sm(N,J,G))return!0}return!1}(C,v,k)}isTileClipped(){return!0}}function xm(u,i){return i>0?i+2*u:u}const ov=Yr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),up=Yr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Yr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ey=Yr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Yr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ks=Yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),lv=Yr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ao(u,i,o){return u.sections.forEach(f=>{f.text=function(v,T,S){const C=T.layout.get("text-transform").evaluate(S,{});return C==="uppercase"?v=v.toLocaleUpperCase():C==="lowercase"&&(v=v.toLocaleLowerCase()),Ho.applyArabicShaping&&(v=Ho.applyArabicShaping(v)),v}(f.text,i,o)}),u}Yr([{name:"triangle",components:3,type:"Uint16"}]),Yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Yr([{type:"Float32",name:"offsetX"}]),Yr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Yr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const $d={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ty,ny,rc,Si=24,cp={};function Gd(){return ty||(ty=1,cp.read=function(u,i,o,f,v){var T,S,C=8*v-f-1,k=(1<<C)-1,z=k>>1,N=-7,j=o?v-1:0,G=o?-1:1,Y=u[i+j];for(j+=G,T=Y&(1<<-N)-1,Y>>=-N,N+=C;N>0;T=256*T+u[i+j],j+=G,N-=8);for(S=T&(1<<-N)-1,T>>=-N,N+=f;N>0;S=256*S+u[i+j],j+=G,N-=8);if(T===0)T=1-z;else{if(T===k)return S?NaN:1/0*(Y?-1:1);S+=Math.pow(2,f),T-=z}return(Y?-1:1)*S*Math.pow(2,T-f)},cp.write=function(u,i,o,f,v,T){var S,C,k,z=8*T-v-1,N=(1<<z)-1,j=N>>1,G=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:T-1,J=f?1:-1,te=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(C=isNaN(i)?1:0,S=N):(S=Math.floor(Math.log(i)/Math.LN2),i*(k=Math.pow(2,-S))<1&&(S--,k*=2),(i+=S+j>=1?G/k:G*Math.pow(2,1-j))*k>=2&&(S++,k/=2),S+j>=N?(C=0,S=N):S+j>=1?(C=(i*k-1)*Math.pow(2,v),S+=j):(C=i*Math.pow(2,j-1)*Math.pow(2,v),S=0));v>=8;u[o+Y]=255&C,Y+=J,C/=256,v-=8);for(S=S<<v|C,z+=v;z>0;u[o+Y]=255&S,Y+=J,S/=256,z-=8);u[o+Y-J]|=128*te}),cp}function ry(){if(rc)return ny;rc=1,ny=i;var u=Gd();function i(X){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(X)?X:new Uint8Array(X||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,f=1/o,v=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function T(X){return X.type===i.Bytes?X.readVarint()+X.pos:X.pos+1}function S(X,oe,Ie){return Ie?4294967296*oe+(X>>>0):4294967296*(oe>>>0)+(X>>>0)}function C(X,oe,Ie){var nt=oe<=16383?1:oe<=2097151?2:oe<=268435455?3:Math.floor(Math.log(oe)/(7*Math.LN2));Ie.realloc(nt);for(var yt=Ie.pos-1;yt>=X;yt--)Ie.buf[yt+nt]=Ie.buf[yt]}function k(X,oe){for(var Ie=0;Ie<X.length;Ie++)oe.writeVarint(X[Ie])}function z(X,oe){for(var Ie=0;Ie<X.length;Ie++)oe.writeSVarint(X[Ie])}function N(X,oe){for(var Ie=0;Ie<X.length;Ie++)oe.writeFloat(X[Ie])}function j(X,oe){for(var Ie=0;Ie<X.length;Ie++)oe.writeDouble(X[Ie])}function G(X,oe){for(var Ie=0;Ie<X.length;Ie++)oe.writeBoolean(X[Ie])}function Y(X,oe){for(var Ie=0;Ie<X.length;Ie++)oe.writeFixed32(X[Ie])}function J(X,oe){for(var Ie=0;Ie<X.length;Ie++)oe.writeSFixed32(X[Ie])}function te(X,oe){for(var Ie=0;Ie<X.length;Ie++)oe.writeFixed64(X[Ie])}function le(X,oe){for(var Ie=0;Ie<X.length;Ie++)oe.writeSFixed64(X[Ie])}function ge(X,oe){return(X[oe]|X[oe+1]<<8|X[oe+2]<<16)+16777216*X[oe+3]}function Ne(X,oe,Ie){X[Ie]=oe,X[Ie+1]=oe>>>8,X[Ie+2]=oe>>>16,X[Ie+3]=oe>>>24}function Se(X,oe){return(X[oe]|X[oe+1]<<8|X[oe+2]<<16)+(X[oe+3]<<24)}return i.prototype={destroy:function(){this.buf=null},readFields:function(X,oe,Ie){for(Ie=Ie||this.length;this.pos<Ie;){var nt=this.readVarint(),yt=nt>>3,lt=this.pos;this.type=7&nt,X(yt,oe,this),this.pos===lt&&this.skip(nt)}return oe},readMessage:function(X,oe){return this.readFields(X,oe,this.readVarint()+this.pos)},readFixed32:function(){var X=ge(this.buf,this.pos);return this.pos+=4,X},readSFixed32:function(){var X=Se(this.buf,this.pos);return this.pos+=4,X},readFixed64:function(){var X=ge(this.buf,this.pos)+ge(this.buf,this.pos+4)*o;return this.pos+=8,X},readSFixed64:function(){var X=ge(this.buf,this.pos)+Se(this.buf,this.pos+4)*o;return this.pos+=8,X},readFloat:function(){var X=u.read(this.buf,this.pos,!0,23,4);return this.pos+=4,X},readDouble:function(){var X=u.read(this.buf,this.pos,!0,52,8);return this.pos+=8,X},readVarint:function(X){var oe,Ie,nt=this.buf;return oe=127&(Ie=nt[this.pos++]),Ie<128?oe:(oe|=(127&(Ie=nt[this.pos++]))<<7,Ie<128?oe:(oe|=(127&(Ie=nt[this.pos++]))<<14,Ie<128?oe:(oe|=(127&(Ie=nt[this.pos++]))<<21,Ie<128?oe:function(yt,lt,ft){var Ct,xt,Rt=ft.buf;if(Ct=(112&(xt=Rt[ft.pos++]))>>4,xt<128||(Ct|=(127&(xt=Rt[ft.pos++]))<<3,xt<128)||(Ct|=(127&(xt=Rt[ft.pos++]))<<10,xt<128)||(Ct|=(127&(xt=Rt[ft.pos++]))<<17,xt<128)||(Ct|=(127&(xt=Rt[ft.pos++]))<<24,xt<128)||(Ct|=(1&(xt=Rt[ft.pos++]))<<31,xt<128))return S(yt,Ct,lt);throw new Error("Expected varint not more than 10 bytes")}(oe|=(15&(Ie=nt[this.pos]))<<28,X,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var X=this.readVarint();return X%2==1?(X+1)/-2:X/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var X=this.readVarint()+this.pos,oe=this.pos;return this.pos=X,X-oe>=12&&v?function(Ie,nt,yt){return v.decode(Ie.subarray(nt,yt))}(this.buf,oe,X):function(Ie,nt,yt){for(var lt="",ft=nt;ft<yt;){var Ct,xt,Rt,gt=Ie[ft],Wt=null,sn=gt>239?4:gt>223?3:gt>191?2:1;if(ft+sn>yt)break;sn===1?gt<128&&(Wt=gt):sn===2?(192&(Ct=Ie[ft+1]))==128&&(Wt=(31&gt)<<6|63&Ct)<=127&&(Wt=null):sn===3?(xt=Ie[ft+2],(192&(Ct=Ie[ft+1]))==128&&(192&xt)==128&&((Wt=(15&gt)<<12|(63&Ct)<<6|63&xt)<=2047||Wt>=55296&&Wt<=57343)&&(Wt=null)):sn===4&&(xt=Ie[ft+2],Rt=Ie[ft+3],(192&(Ct=Ie[ft+1]))==128&&(192&xt)==128&&(192&Rt)==128&&((Wt=(15&gt)<<18|(63&Ct)<<12|(63&xt)<<6|63&Rt)<=65535||Wt>=1114112)&&(Wt=null)),Wt===null?(Wt=65533,sn=1):Wt>65535&&(Wt-=65536,lt+=String.fromCharCode(Wt>>>10&1023|55296),Wt=56320|1023&Wt),lt+=String.fromCharCode(Wt),ft+=sn}return lt}(this.buf,oe,X)},readBytes:function(){var X=this.readVarint()+this.pos,oe=this.buf.subarray(this.pos,X);return this.pos=X,oe},readPackedVarint:function(X,oe){if(this.type!==i.Bytes)return X.push(this.readVarint(oe));var Ie=T(this);for(X=X||[];this.pos<Ie;)X.push(this.readVarint(oe));return X},readPackedSVarint:function(X){if(this.type!==i.Bytes)return X.push(this.readSVarint());var oe=T(this);for(X=X||[];this.pos<oe;)X.push(this.readSVarint());return X},readPackedBoolean:function(X){if(this.type!==i.Bytes)return X.push(this.readBoolean());var oe=T(this);for(X=X||[];this.pos<oe;)X.push(this.readBoolean());return X},readPackedFloat:function(X){if(this.type!==i.Bytes)return X.push(this.readFloat());var oe=T(this);for(X=X||[];this.pos<oe;)X.push(this.readFloat());return X},readPackedDouble:function(X){if(this.type!==i.Bytes)return X.push(this.readDouble());var oe=T(this);for(X=X||[];this.pos<oe;)X.push(this.readDouble());return X},readPackedFixed32:function(X){if(this.type!==i.Bytes)return X.push(this.readFixed32());var oe=T(this);for(X=X||[];this.pos<oe;)X.push(this.readFixed32());return X},readPackedSFixed32:function(X){if(this.type!==i.Bytes)return X.push(this.readSFixed32());var oe=T(this);for(X=X||[];this.pos<oe;)X.push(this.readSFixed32());return X},readPackedFixed64:function(X){if(this.type!==i.Bytes)return X.push(this.readFixed64());var oe=T(this);for(X=X||[];this.pos<oe;)X.push(this.readFixed64());return X},readPackedSFixed64:function(X){if(this.type!==i.Bytes)return X.push(this.readSFixed64());var oe=T(this);for(X=X||[];this.pos<oe;)X.push(this.readSFixed64());return X},skip:function(X){var oe=7&X;if(oe===i.Varint)for(;this.buf[this.pos++]>127;);else if(oe===i.Bytes)this.pos=this.readVarint()+this.pos;else if(oe===i.Fixed32)this.pos+=4;else{if(oe!==i.Fixed64)throw new Error("Unimplemented type: "+oe);this.pos+=8}},writeTag:function(X,oe){this.writeVarint(X<<3|oe)},realloc:function(X){for(var oe=this.length||16;oe<this.pos+X;)oe*=2;if(oe!==this.length){var Ie=new Uint8Array(oe);Ie.set(this.buf),this.buf=Ie,this.length=oe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(X){this.realloc(4),Ne(this.buf,X,this.pos),this.pos+=4},writeSFixed32:function(X){this.realloc(4),Ne(this.buf,X,this.pos),this.pos+=4},writeFixed64:function(X){this.realloc(8),Ne(this.buf,-1&X,this.pos),Ne(this.buf,Math.floor(X*f),this.pos+4),this.pos+=8},writeSFixed64:function(X){this.realloc(8),Ne(this.buf,-1&X,this.pos),Ne(this.buf,Math.floor(X*f),this.pos+4),this.pos+=8},writeVarint:function(X){(X=+X||0)>268435455||X<0?function(oe,Ie){var nt,yt;if(oe>=0?(nt=oe%4294967296|0,yt=oe/4294967296|0):(yt=~(-oe/4294967296),4294967295^(nt=~(-oe%4294967296))?nt=nt+1|0:(nt=0,yt=yt+1|0)),oe>=18446744073709552e3||oe<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Ie.realloc(10),function(lt,ft,Ct){Ct.buf[Ct.pos++]=127&lt|128,lt>>>=7,Ct.buf[Ct.pos++]=127&lt|128,lt>>>=7,Ct.buf[Ct.pos++]=127&lt|128,lt>>>=7,Ct.buf[Ct.pos++]=127&lt|128,Ct.buf[Ct.pos]=127&(lt>>>=7)}(nt,0,Ie),function(lt,ft){var Ct=(7&lt)<<4;ft.buf[ft.pos++]|=Ct|((lt>>>=3)?128:0),lt&&(ft.buf[ft.pos++]=127&lt|((lt>>>=7)?128:0),lt&&(ft.buf[ft.pos++]=127&lt|((lt>>>=7)?128:0),lt&&(ft.buf[ft.pos++]=127&lt|((lt>>>=7)?128:0),lt&&(ft.buf[ft.pos++]=127&lt|((lt>>>=7)?128:0),lt&&(ft.buf[ft.pos++]=127&lt)))))}(yt,Ie)}(X,this):(this.realloc(4),this.buf[this.pos++]=127&X|(X>127?128:0),X<=127||(this.buf[this.pos++]=127&(X>>>=7)|(X>127?128:0),X<=127||(this.buf[this.pos++]=127&(X>>>=7)|(X>127?128:0),X<=127||(this.buf[this.pos++]=X>>>7&127))))},writeSVarint:function(X){this.writeVarint(X<0?2*-X-1:2*X)},writeBoolean:function(X){this.writeVarint(!!X)},writeString:function(X){X=String(X),this.realloc(4*X.length),this.pos++;var oe=this.pos;this.pos=function(nt,yt,lt){for(var ft,Ct,xt=0;xt<yt.length;xt++){if((ft=yt.charCodeAt(xt))>55295&&ft<57344){if(!Ct){ft>56319||xt+1===yt.length?(nt[lt++]=239,nt[lt++]=191,nt[lt++]=189):Ct=ft;continue}if(ft<56320){nt[lt++]=239,nt[lt++]=191,nt[lt++]=189,Ct=ft;continue}ft=Ct-55296<<10|ft-56320|65536,Ct=null}else Ct&&(nt[lt++]=239,nt[lt++]=191,nt[lt++]=189,Ct=null);ft<128?nt[lt++]=ft:(ft<2048?nt[lt++]=ft>>6|192:(ft<65536?nt[lt++]=ft>>12|224:(nt[lt++]=ft>>18|240,nt[lt++]=ft>>12&63|128),nt[lt++]=ft>>6&63|128),nt[lt++]=63&ft|128)}return lt}(this.buf,X,this.pos);var Ie=this.pos-oe;Ie>=128&&C(oe,Ie,this),this.pos=oe-1,this.writeVarint(Ie),this.pos+=Ie},writeFloat:function(X){this.realloc(4),u.write(this.buf,X,this.pos,!0,23,4),this.pos+=4},writeDouble:function(X){this.realloc(8),u.write(this.buf,X,this.pos,!0,52,8),this.pos+=8},writeBytes:function(X){var oe=X.length;this.writeVarint(oe),this.realloc(oe);for(var Ie=0;Ie<oe;Ie++)this.buf[this.pos++]=X[Ie]},writeRawMessage:function(X,oe){this.pos++;var Ie=this.pos;X(oe,this);var nt=this.pos-Ie;nt>=128&&C(Ie,nt,this),this.pos=Ie-1,this.writeVarint(nt),this.pos+=nt},writeMessage:function(X,oe,Ie){this.writeTag(X,i.Bytes),this.writeRawMessage(oe,Ie)},writePackedVarint:function(X,oe){oe.length&&this.writeMessage(X,k,oe)},writePackedSVarint:function(X,oe){oe.length&&this.writeMessage(X,z,oe)},writePackedBoolean:function(X,oe){oe.length&&this.writeMessage(X,G,oe)},writePackedFloat:function(X,oe){oe.length&&this.writeMessage(X,N,oe)},writePackedDouble:function(X,oe){oe.length&&this.writeMessage(X,j,oe)},writePackedFixed32:function(X,oe){oe.length&&this.writeMessage(X,Y,oe)},writePackedSFixed32:function(X,oe){oe.length&&this.writeMessage(X,J,oe)},writePackedFixed64:function(X,oe){oe.length&&this.writeMessage(X,te,oe)},writePackedSFixed64:function(X,oe){oe.length&&this.writeMessage(X,le,oe)},writeBytesField:function(X,oe){this.writeTag(X,i.Bytes),this.writeBytes(oe)},writeFixed32Field:function(X,oe){this.writeTag(X,i.Fixed32),this.writeFixed32(oe)},writeSFixed32Field:function(X,oe){this.writeTag(X,i.Fixed32),this.writeSFixed32(oe)},writeFixed64Field:function(X,oe){this.writeTag(X,i.Fixed64),this.writeFixed64(oe)},writeSFixed64Field:function(X,oe){this.writeTag(X,i.Fixed64),this.writeSFixed64(oe)},writeVarintField:function(X,oe){this.writeTag(X,i.Varint),this.writeVarint(oe)},writeSVarintField:function(X,oe){this.writeTag(X,i.Varint),this.writeSVarint(oe)},writeStringField:function(X,oe){this.writeTag(X,i.Bytes),this.writeString(oe)},writeFloatField:function(X,oe){this.writeTag(X,i.Fixed32),this.writeFloat(oe)},writeDoubleField:function(X,oe){this.writeTag(X,i.Fixed64),this.writeDouble(oe)},writeBooleanField:function(X,oe){this.writeVarintField(X,!!oe)}},ny}var ic,wm=M(ry());function iy(u,i,o){u===1&&o.readMessage(ay,i)}function ay(u,i,o){if(u===3){const{id:f,bitmap:v,width:T,height:S,left:C,top:k,advance:z}=o.readMessage(Rb,{});i.push({id:f,bitmap:new zd({width:T+6,height:S+6},v),metrics:{width:T,height:S,left:C,top:k,advance:z}})}}function Rb(u,i,o){u===1?i.id=o.readVarint():u===2?i.bitmap=o.readBytes():u===3?i.width=o.readVarint():u===4?i.height=o.readVarint():u===5?i.left=o.readSVarint():u===6?i.top=o.readSVarint():u===7&&(i.advance=o.readVarint())}function uv(u){let i=0,o=0;for(const S of u)i+=S.w*S.h,o=Math.max(o,S.w);u.sort((S,C)=>C.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),o),h:1/0}];let v=0,T=0;for(const S of u)for(let C=f.length-1;C>=0;C--){const k=f[C];if(!(S.w>k.w||S.h>k.h)){if(S.x=k.x,S.y=k.y,T=Math.max(T,S.y+S.h),v=Math.max(v,S.x+S.w),S.w===k.w&&S.h===k.h){const z=f.pop();C<f.length&&(f[C]=z)}else S.h===k.h?(k.x+=S.w,k.w-=S.w):S.w===k.w?(k.y+=S.h,k.h-=S.h):(f.push({x:k.x+S.w,y:k.y,w:k.w-S.w,h:S.h}),k.y+=S.h,k.h-=S.h);break}}return{w:v,h:T,fill:i/(v*T)||0}}class sy{constructor(i,{pixelRatio:o,version:f,stretchX:v,stretchY:T,content:S,textFitWidth:C,textFitHeight:k}){this.paddedRect=i,this.pixelRatio=o,this.stretchX=v,this.stretchY=T,this.content=S,this.version=f,this.textFitWidth=C,this.textFitHeight=k}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class oy{constructor(i,o){const f={},v={};this.haveRenderCallbacks=[];const T=[];this.addImages(i,f,T),this.addImages(o,v,T);const{w:S,h:C}=uv(T),k=new Ha({width:S||1,height:C||1});for(const z in i){const N=i[z],j=f[z].paddedRect;Ha.copy(N.data,k,{x:0,y:0},{x:j.x+1,y:j.y+1},N.data)}for(const z in o){const N=o[z],j=v[z].paddedRect,G=j.x+1,Y=j.y+1,J=N.data.width,te=N.data.height;Ha.copy(N.data,k,{x:0,y:0},{x:G,y:Y},N.data),Ha.copy(N.data,k,{x:0,y:te-1},{x:G,y:Y-1},{width:J,height:1}),Ha.copy(N.data,k,{x:0,y:0},{x:G,y:Y+te},{width:J,height:1}),Ha.copy(N.data,k,{x:J-1,y:0},{x:G-1,y:Y},{width:1,height:te}),Ha.copy(N.data,k,{x:0,y:0},{x:G+J,y:Y},{width:1,height:te})}this.image=k,this.iconPositions=f,this.patternPositions=v}addImages(i,o,f){for(const v in i){const T=i[v],S={x:0,y:0,w:T.data.width+2,h:T.data.height+2};f.push(S),o[v]=new sy(S,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(i,o){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in i.updatedImages)this.patchUpdatedImage(this.iconPositions[f],i.getImage(f),o),this.patchUpdatedImage(this.patternPositions[f],i.getImage(f),o)}patchUpdatedImage(i,o,f){if(!i||!o||i.version===o.version)return;i.version=o.version;const[v,T]=i.tl;f.update(o.data,void 0,{x:v,y:T})}}Ut("ImagePosition",sy),Ut("ImageAtlas",oy),y.an=void 0,(ic=y.an||(y.an={}))[ic.none=0]="none",ic[ic.horizontal=1]="horizontal",ic[ic.vertical=2]="vertical",ic[ic.horizontalOnly=3]="horizontalOnly";class Hd{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(i,o,f){const v=new Hd;return v.scale=i||1,v.fontStack=o,v.verticalAlign=f||"bottom",v}static forImage(i,o){const f=new Hd;return f.imageName=i,f.verticalAlign=o||"bottom",f}}class El{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,o){const f=new El;for(let v=0;v<i.sections.length;v++){const T=i.sections[v];T.image?f.addImageSection(T):f.addTextSection(T,o)}return f}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let o="";for(let f=0;f<i.length;f++){const v=i.charCodeAt(f+1)||null,T=i.charCodeAt(f-1)||null;o+=v&&Id(v)&&!$d[i[f+1]]||T&&Id(T)&&!$d[i[f-1]]||!$d[i[f]]?i[f]:$d[i[f]]}return o}(this.text)}trim(){let i=0;for(let f=0;f<this.text.length&&hp[this.text.charCodeAt(f)];f++)i++;let o=this.text.length;for(let f=this.text.length-1;f>=0&&f>=i&&hp[this.text.charCodeAt(f)];f--)o--;this.text=this.text.substring(i,o),this.sectionIndex=this.sectionIndex.slice(i,o)}substring(i,o){const f=new El;return f.text=this.text.substring(i,o),f.sectionIndex=this.sectionIndex.slice(i,o),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,o)=>Math.max(i,this.sections[o].scale),0)}getMaxImageSize(i){let o=0,f=0;for(let v=0;v<this.length();v++){const T=this.getSection(v);if(T.imageName){const S=i[T.imageName];if(!S)continue;const C=S.displaySize;o=Math.max(o,C[0]),f=Math.max(f,C[1])}}return{maxImageWidth:o,maxImageHeight:f}}addTextSection(i,o){this.text+=i.text,this.sections.push(Hd.forText(i.scale,i.fontStack||o,i.verticalAlign));const f=this.sections.length-1;for(let v=0;v<i.text.length;++v)this.sectionIndex.push(f)}addImageSection(i){const o=i.image?i.image.name:"";if(o.length===0)return void Ir("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Hd.forImage(o,i.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Ir("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function jh(u,i,o,f,v,T,S,C,k,z,N,j,G,Y,J){const te=El.fromFeature(u,v);let le;j===y.an.vertical&&te.verticalizePunctuation();const{processBidirectionalText:ge,processStyledBidirectionalText:Ne}=Ho;if(ge&&te.sections.length===1){le=[];const oe=ge(te.toString(),Tm(te,z,T,i,f,Y));for(const Ie of oe){const nt=new El;nt.text=Ie,nt.sections=te.sections;for(let yt=0;yt<Ie.length;yt++)nt.sectionIndex.push(0);le.push(nt)}}else if(Ne){le=[];const oe=Ne(te.text,te.sectionIndex,Tm(te,z,T,i,f,Y));for(const Ie of oe){const nt=new El;nt.text=Ie[0],nt.sectionIndex=Ie[1],nt.sections=te.sections,le.push(nt)}}else le=function(oe,Ie){const nt=[],yt=oe.text;let lt=0;for(const ft of Ie)nt.push(oe.substring(lt,ft)),lt=ft;return lt<yt.length&&nt.push(oe.substring(lt,yt.length)),nt}(te,Tm(te,z,T,i,f,Y));const Se=[],X={positionedLines:Se,text:te.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:j,iconsInText:!1,verticalizable:!1};return function(oe,Ie,nt,yt,lt,ft,Ct,xt,Rt,gt,Wt,sn){let Yt=0,Ht=0,Sn=0,Vr=0;const ui=xt==="right"?1:xt==="left"?0:.5,ci=Si/sn;let Co=0;for(const ri of lt){ri.trim();const Qi=ri.getMaxScale(),ji={positionedGlyphs:[],lineOffset:0};oe.positionedLines[Co]=ji;const ua=ji.positionedGlyphs;let is=0;if(!ri.length()){Ht+=ft,++Co;continue}const as=hy(yt,ri,ci);for(let ss=0;ss<ri.length();ss++){const hi=ri.getSection(ss),Ui=ri.getSectionIndex(ss),Ci=ri.getCharCode(ss),Ii=pv(Rt,Wt,Ci);let Hr;if(hi.imageName){if(oe.iconsInText=!0,hi.scale=hi.scale*ci,Hr=Db(hi,Ii,Qi,as,yt),!Hr)continue;is=Math.max(is,Hr.imageOffset)}else if(Hr=kb(hi,Ci,Ii,as,Ie,nt),!Hr)continue;const{rect:Ys,metrics:s,baselineOffset:h}=Hr;ua.push({glyph:Ci,imageName:hi.imageName,x:Yt,y:Ht+h+-17,vertical:Ii,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:Ui,metrics:s,rect:Ys}),Ii?(oe.verticalizable=!0,Yt+=(hi.imageName?s.advance:Si)*hi.scale+gt):Yt+=s.advance*hi.scale+gt}ua.length!==0&&(Sn=Math.max(Yt-gt,Sn),Lb(ua,0,ua.length-1,ui)),Yt=0,ji.lineOffset=Math.max(is,(Qi-1)*Si);const Ai=ft*Qi+is;Ht+=Ai,Vr=Math.max(Ai,Vr),++Co}const{horizontalAlign:rs,verticalAlign:Ei}=Nr(Ct);(function(ri,Qi,ji,ua,is,as,Ai,ss,hi){const Ui=(Qi-ji)*is;let Ci=0;Ci=as!==Ai?-ss*ua- -17:-ua*hi*Ai+.5*Ai;for(const Ii of ri)for(const Hr of Ii.positionedGlyphs)Hr.x+=Ui,Hr.y+=Ci})(oe.positionedLines,ui,rs,Ei,Sn,Vr,ft,Ht,lt.length),oe.top+=-Ei*Ht,oe.bottom=oe.top+Ht,oe.left+=-rs*Sn,oe.right=oe.left+Sn}(X,i,o,f,le,S,C,k,j,z,G,J),!function(oe){for(const Ie of oe)if(Ie.positionedGlyphs.length!==0)return!1;return!0}(Se)&&X}const hp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},cv={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},hv={40:!0};function ly(u,i,o,f,v,T){if(i.imageName){const S=f[i.imageName];return S?S.displaySize[0]*i.scale*Si/T+v:0}{const S=o[i.fontStack],C=S&&S[u];return C?C.metrics.advance*i.scale+v:0}}function uy(u,i,o,f){const v=Math.pow(u-i,2);return f?u<i?v/2:2*v:v+Math.abs(o)*o}function dv(u,i,o){let f=0;return u===10&&(f-=1e4),o&&(f+=150),u!==40&&u!==65288||(f+=50),i!==41&&i!==65289||(f+=50),f}function dp(u,i,o,f,v,T){let S=null,C=uy(i,o,v,T);for(const k of f){const z=uy(i-k.x,o,v,T)+k.badness;z<=C&&(S=k,C=z)}return{index:u,x:i,priorBreak:S,badness:C}}function cy(u){return u?cy(u.priorBreak).concat(u.index):[]}function Tm(u,i,o,f,v,T){if(!u)return[];const S=[],C=function(j,G,Y,J,te,le){let ge=0;for(let Ne=0;Ne<j.length();Ne++){const Se=j.getSection(Ne);ge+=ly(j.getCharCode(Ne),Se,J,te,G,le)}return ge/Math.max(1,Math.ceil(ge/Y))}(u,i,o,f,v,T),k=u.text.indexOf("")>=0;let z=0;for(let j=0;j<u.length();j++){const G=u.getSection(j),Y=u.getCharCode(j);if(hp[Y]||(z+=ly(Y,G,f,v,i,T)),j<u.length()-1){const J=!((N=Y)<11904)&&(!!On["CJK Compatibility Forms"](N)||!!On["CJK Compatibility"](N)||!!On["CJK Strokes"](N)||!!On["CJK Symbols and Punctuation"](N)||!!On["Enclosed CJK Letters and Months"](N)||!!On["Halfwidth and Fullwidth Forms"](N)||!!On["Ideographic Description Characters"](N)||!!On["Vertical Forms"](N)||ju.test(String.fromCodePoint(N)));(cv[Y]||J||G.imageName||j!==u.length()-2&&hv[u.getCharCode(j+1)])&&S.push(dp(j+1,z,C,S,dv(Y,u.getCharCode(j+1),J&&k),!1))}}var N;return cy(dp(u.length(),z,C,S,0,!0))}function Nr(u){let i=.5,o=.5;switch(u){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:i,verticalAlign:o}}function hy(u,i,o){const f=i.getMaxScale()*Si,{maxImageWidth:v,maxImageHeight:T}=i.getMaxImageSize(u),S=Math.max(f,T*o);return{verticalLineContentWidth:Math.max(f,v*o),horizontalLineContentHeight:S}}function fv(u){switch(u){case"top":return 0;case"center":return .5;default:return 1}}function pv(u,i,o){return!(u===y.an.horizontal||!i&&!nu(o)||i&&(hp[o]||(f=o,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(f)))));var f}function kb(u,i,o,f,v,T){const S=T[u.fontStack],C=function(z,N,j,G){if(z&&z.rect)return z;const Y=N[j.fontStack],J=Y&&Y[G];return J?{rect:null,metrics:J.metrics}:null}(S&&S[i],v,u,i);if(C===null)return null;let k;if(o)k=f.verticalLineContentWidth-u.scale*Si;else{const z=fv(u.verticalAlign);k=(f.horizontalLineContentHeight-u.scale*Si)*z}return{rect:C.rect,metrics:C.metrics,baselineOffset:k}}function Db(u,i,o,f,v){const T=v[u.imageName];if(!T)return null;const S=T.paddedRect,C=T.displaySize,k={width:C[0],height:C[1],left:1,top:-3,advance:i?C[1]:C[0]};let z;if(i)z=f.verticalLineContentWidth-C[1]*u.scale;else{const N=fv(u.verticalAlign);z=(f.horizontalLineContentHeight-C[1]*u.scale)*N}return{rect:S,metrics:k,baselineOffset:z,imageOffset:(i?C[0]:C[1])*u.scale-Si*o}}function Lb(u,i,o,f){if(f===0)return;const v=u[o],T=(u[o].x+v.metrics.advance*v.scale)*f;for(let S=i;S<=o;S++)u[S].x-=T}function Sm(u,i,o){const{horizontalAlign:f,verticalAlign:v}=Nr(o),T=i[0]-u.displaySize[0]*f,S=i[1]-u.displaySize[1]*v;return{image:u,top:S,bottom:S+u.displaySize[1],left:T,right:T+u.displaySize[0]}}function Uh(u){var i,o;let f=u.left,v=u.top,T=u.right-f,S=u.bottom-v;const C=(i=u.image.textFitWidth)!==null&&i!==void 0?i:"stretchOrShrink",k=(o=u.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",z=(u.image.content[2]-u.image.content[0])/(u.image.content[3]-u.image.content[1]);if(k==="proportional"){if(C==="stretchOnly"&&T/S<z||C==="proportional"){const N=Math.ceil(S*z);f*=N/T,T=N}}else if(C==="proportional"&&k==="stretchOnly"&&z!==0&&T/S>z){const N=Math.ceil(T/z);v*=N/S,S=N}return{x1:f,y1:v,x2:f+T,y2:v+S}}function Em(u,i,o,f,v,T){const S=u.image;let C;if(S.content){const le=S.content,ge=S.pixelRatio||1;C=[le[0]/ge,le[1]/ge,S.displaySize[0]-le[2]/ge,S.displaySize[1]-le[3]/ge]}const k=i.left*T,z=i.right*T;let N,j,G,Y;o==="width"||o==="both"?(Y=v[0]+k-f[3],j=v[0]+z+f[1]):(Y=v[0]+(k+z-S.displaySize[0])/2,j=Y+S.displaySize[0]);const J=i.top*T,te=i.bottom*T;return o==="height"||o==="both"?(N=v[1]+J-f[0],G=v[1]+te+f[2]):(N=v[1]+(J+te-S.displaySize[1])/2,G=N+S.displaySize[1]),{image:S,top:N,right:j,bottom:G,left:Y,collisionPadding:C}}const Jo=128,cu=32640;function $c(u,i){const{expression:o}=i;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Lr(u+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:v}=o;let T=0;for(;T<f.length&&f[T]<=u;)T++;T=Math.max(0,T-1);let S=T;for(;S<f.length&&f[S]<u+1;)S++;S=Math.min(f.length-1,S);const C=f[T],k=f[S];return o.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:k,interpolationType:v}:{kind:"camera",minZoom:C,maxZoom:k,minSize:o.evaluate(new Lr(C)),maxSize:o.evaluate(new Lr(k)),interpolationType:v}}}function el(u,i,o){let f="never";const v=u.get(i);return v?f=v:u.get(o)&&(f="always"),f}const fp=Pr.VectorTileFeature.types,zb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function pp(u,i,o,f,v,T,S,C,k,z,N,j,G){const Y=C?Math.min(cu,Math.round(C[0])):0,J=C?Math.min(cu,Math.round(C[1])):0;u.emplaceBack(i,o,Math.round(32*f),Math.round(32*v),T,S,(Y<<1)+(k?1:0),J,16*z,16*N,256*j,256*G)}function Am(u,i,o){u.emplaceBack(i.x,i.y,o),u.emplaceBack(i.x,i.y,o),u.emplaceBack(i.x,i.y,o),u.emplaceBack(i.x,i.y,o)}function mv(u){for(const i of u.sections)if(Pd(i.text))return!0;return!1}class Cm{constructor(i){this.layoutVertexArray=new Mn,this.indexArray=new yr,this.programConfigurations=i,this.segments=new Zn,this.dynamicLayoutVertexArray=new Qn,this.opacityVertexArray=new Qr,this.hasVisibleVertices=!1,this.placedSymbolArray=new pe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,o,f,v){this.isEmpty()||(f&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ov.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,up.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,zb,!0),this.opacityVertexBuffer.itemSize=1),(f||v)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ut("SymbolBuffers",Cm);class dy{constructor(i,o,f){this.layoutVertexArray=new i,this.layoutAttributes=o,this.indexArray=new f,this.segments=new Zn,this.collisionVertexArray=new ni}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,ey.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ut("CollisionBuffers",dy);class Gc{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(S=>S.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$c(this.zoom,o["text-size"]),this.iconSizeData=$c(this.zoom,o["icon-size"]);const f=this.layers[0].layout,v=f.get("symbol-sort-key"),T=f.get("symbol-z-order");this.canOverlap=el(f,"text-overlap","text-allow-overlap")!=="never"||el(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!v.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(S=>y.an[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=i.sourceID}createArrays(){this.text=new Cm(new Ga(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new Cm(new Ga(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new be,this.lineVertexArray=new Pe,this.symbolInstances=new Ae,this.textAnchorOffsets=new xe}calculateGlyphDependencies(i,o,f,v,T){for(let S=0;S<i.length;S++)if(o[i.charCodeAt(S)]=!0,(f||v)&&T){const C=$d[i.charAt(S)];C&&(o[C.charCodeAt(0)]=!0)}}populate(i,o,f){const v=this.layers[0],T=v.layout,S=T.get("text-font"),C=T.get("text-field"),k=T.get("icon-image"),z=(C.value.kind!=="constant"||C.value.value instanceof Hi&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),N=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,j=T.get("symbol-sort-key");if(this.features=[],!z&&!N)return;const G=o.iconDependencies,Y=o.glyphDependencies,J=o.availableImages,te=new Lr(this.zoom,{globalState:this.globalState});for(const{feature:le,id:ge,index:Ne,sourceLayerIndex:Se}of i){const X=v._featureFilter.needGeometry,oe=Fc(le,X);if(!v._featureFilter.filter(te,oe,f))continue;let Ie,nt;if(X||(oe.geometry=Ku(le)),z){const lt=v.getValueAndResolveTokens("text-field",oe,f,J),ft=Hi.factory(lt),Ct=this.hasRTLText=this.hasRTLText||mv(ft);(!Ct||Ho.getRTLTextPluginStatus()==="unavailable"||Ct&&Ho.isParsed())&&(Ie=Ao(ft,v,oe))}if(N){const lt=v.getValueAndResolveTokens("icon-image",oe,f,J);nt=lt instanceof fi?lt:fi.fromString(lt)}if(!Ie&&!nt)continue;const yt=this.sortFeaturesByKey?j.evaluate(oe,{},f):void 0;if(this.features.push({id:ge,text:Ie,icon:nt,index:Ne,sourceLayerIndex:Se,geometry:oe.geometry,properties:le.properties,type:fp[le.type],sortKey:yt}),nt&&(G[nt.name]=!0),Ie){const lt=S.evaluate(oe,{},f).join(","),ft=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.an.vertical)>=0;for(const Ct of Ie.sections)if(Ct.image)G[Ct.image.name]=!0;else{const xt=$o(Ie.toString()),Rt=Ct.fontStack||lt,gt=Y[Rt]=Y[Rt]||{};this.calculateGlyphDependencies(Ct.text,gt,ft,this.allowVerticalPlacement,xt)}}}T.get("symbol-placement")==="line"&&(this.features=function(le){const ge={},Ne={},Se=[];let X=0;function oe(lt){Se.push(le[lt]),X++}function Ie(lt,ft,Ct){const xt=Ne[lt];return delete Ne[lt],Ne[ft]=xt,Se[xt].geometry[0].pop(),Se[xt].geometry[0]=Se[xt].geometry[0].concat(Ct[0]),xt}function nt(lt,ft,Ct){const xt=ge[ft];return delete ge[ft],ge[lt]=xt,Se[xt].geometry[0].shift(),Se[xt].geometry[0]=Ct[0].concat(Se[xt].geometry[0]),xt}function yt(lt,ft,Ct){const xt=Ct?ft[0][ft[0].length-1]:ft[0][0];return`${lt}:${xt.x}:${xt.y}`}for(let lt=0;lt<le.length;lt++){const ft=le[lt],Ct=ft.geometry,xt=ft.text?ft.text.toString():null;if(!xt){oe(lt);continue}const Rt=yt(xt,Ct),gt=yt(xt,Ct,!0);if(Rt in Ne&&gt in ge&&Ne[Rt]!==ge[gt]){const Wt=nt(Rt,gt,Ct),sn=Ie(Rt,gt,Se[Wt].geometry);delete ge[Rt],delete Ne[gt],Ne[yt(xt,Se[sn].geometry,!0)]=sn,Se[Wt].geometry=null}else Rt in Ne?Ie(Rt,gt,Ct):gt in ge?nt(Rt,gt,Ct):(oe(lt),ge[Rt]=X-1,Ne[gt]=X-1)}return Se.filter(lt=>lt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((le,ge)=>le.sortKey-ge.sortKey)}update(i,o,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,o,this.layers,f),this.icon.programConfigurations.updatePaintArrays(i,o,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,o){const f=this.lineVertexArray.length;if(i.segment!==void 0){let v=i.dist(o[i.segment+1]),T=i.dist(o[i.segment]);const S={};for(let C=i.segment+1;C<o.length;C++)S[C]={x:o[C].x,y:o[C].y,tileUnitDistanceFromAnchor:v},C<o.length-1&&(v+=o[C+1].dist(o[C]));for(let C=i.segment||0;C>=0;C--)S[C]={x:o[C].x,y:o[C].y,tileUnitDistanceFromAnchor:T},C>0&&(T+=o[C-1].dist(o[C]));for(let C=0;C<o.length;C++){const k=S[C];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(i,o,f,v,T,S,C,k,z,N,j,G){const Y=i.indexArray,J=i.layoutVertexArray,te=i.segments.prepareSegment(4*o.length,J,Y,this.canOverlap?S.sortKey:void 0),le=this.glyphOffsetArray.length,ge=te.vertexLength,Ne=this.allowVerticalPlacement&&C===y.an.vertical?Math.PI/2:0,Se=S.text&&S.text.sections;for(let X=0;X<o.length;X++){const{tl:oe,tr:Ie,bl:nt,br:yt,tex:lt,pixelOffsetTL:ft,pixelOffsetBR:Ct,minFontScaleX:xt,minFontScaleY:Rt,glyphOffset:gt,isSDF:Wt,sectionIndex:sn}=o[X],Yt=te.vertexLength,Ht=gt[1];pp(J,k.x,k.y,oe.x,Ht+oe.y,lt.x,lt.y,f,Wt,ft.x,ft.y,xt,Rt),pp(J,k.x,k.y,Ie.x,Ht+Ie.y,lt.x+lt.w,lt.y,f,Wt,Ct.x,ft.y,xt,Rt),pp(J,k.x,k.y,nt.x,Ht+nt.y,lt.x,lt.y+lt.h,f,Wt,ft.x,Ct.y,xt,Rt),pp(J,k.x,k.y,yt.x,Ht+yt.y,lt.x+lt.w,lt.y+lt.h,f,Wt,Ct.x,Ct.y,xt,Rt),Am(i.dynamicLayoutVertexArray,k,Ne),Y.emplaceBack(Yt,Yt+2,Yt+1),Y.emplaceBack(Yt+1,Yt+2,Yt+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(gt[0]),X!==o.length-1&&sn===o[X+1].sectionIndex||i.programConfigurations.populatePaintArrays(J.length,S,S.index,{},G,Se&&Se[sn])}i.placedSymbolArray.emplaceBack(k.x,k.y,le,this.glyphOffsetArray.length-le,ge,z,N,k.segment,f?f[0]:0,f?f[1]:0,v[0],v[1],C,0,!1,0,j)}_addCollisionDebugVertex(i,o,f,v,T,S){return o.emplaceBack(0,0),i.emplaceBack(f.x,f.y,v,T,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(i,o,f,v,T,S,C){const k=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),z=k.vertexLength,N=T.layoutVertexArray,j=T.collisionVertexArray,G=C.anchorX,Y=C.anchorY;this._addCollisionDebugVertex(N,j,S,G,Y,new re(i,o)),this._addCollisionDebugVertex(N,j,S,G,Y,new re(f,o)),this._addCollisionDebugVertex(N,j,S,G,Y,new re(f,v)),this._addCollisionDebugVertex(N,j,S,G,Y,new re(i,v)),k.vertexLength+=4;const J=T.indexArray;J.emplaceBack(z,z+1),J.emplaceBack(z+1,z+2),J.emplaceBack(z+2,z+3),J.emplaceBack(z+3,z),k.primitiveLength+=4}addDebugCollisionBoxes(i,o,f,v){for(let T=i;T<o;T++){const S=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,v?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new dy(gr,Ks.members,_r),this.iconCollisionBox=new dy(gr,Ks.members,_r);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(i,o,f,v,T,S,C,k,z){const N={};for(let j=o;j<f;j++){const G=i.get(j);N.textBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.textFeatureIndex=G.featureIndex;break}for(let j=v;j<T;j++){const G=i.get(j);N.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.verticalTextFeatureIndex=G.featureIndex;break}for(let j=S;j<C;j++){const G=i.get(j);N.iconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.iconFeatureIndex=G.featureIndex;break}for(let j=k;j<z;j++){const G=i.get(j);N.verticalIconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.verticalIconFeatureIndex=G.featureIndex;break}return N}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const f=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,o){const f=i.placedSymbolArray.get(o),v=f.vertexStartIndex+4*f.numGlyphs;for(let T=f.vertexStartIndex;T<v;T+=4)i.indexArray.emplaceBack(T,T+2,T+1),i.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(i),f=Math.cos(i),v=[],T=[],S=[];for(let C=0;C<this.symbolInstances.length;++C){S.push(C);const k=this.symbolInstances.get(C);v.push(0|Math.round(o*k.anchorX+f*k.anchorY)),T.push(k.featureIndex)}return S.sort((C,k)=>v[C]-v[k]||T[k]-T[C]),S}addToSortKeyRanges(i,o){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===o?f.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const f=this.symbolInstances.get(o);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((v,T,S)=>{v>=0&&S.indexOf(v)===T&&this.addIndicesForPlacedSymbol(this.text,v)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let fy,py;Ut("SymbolBucket",Gc,{omit:["layers","collisionBoxArray","features","compareText"]}),Gc.MAX_GLYPHS=65535,Gc.addDynamicAttributes=Am;var my={get paint(){return py=py||new fa({"icon-opacity":new rn(ze.paint_symbol["icon-opacity"]),"icon-color":new rn(ze.paint_symbol["icon-color"]),"icon-halo-color":new rn(ze.paint_symbol["icon-halo-color"]),"icon-halo-width":new rn(ze.paint_symbol["icon-halo-width"]),"icon-halo-blur":new rn(ze.paint_symbol["icon-halo-blur"]),"icon-translate":new $t(ze.paint_symbol["icon-translate"]),"icon-translate-anchor":new $t(ze.paint_symbol["icon-translate-anchor"]),"text-opacity":new rn(ze.paint_symbol["text-opacity"]),"text-color":new rn(ze.paint_symbol["text-color"],{runtimeType:ha,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new rn(ze.paint_symbol["text-halo-color"]),"text-halo-width":new rn(ze.paint_symbol["text-halo-width"]),"text-halo-blur":new rn(ze.paint_symbol["text-halo-blur"]),"text-translate":new $t(ze.paint_symbol["text-translate"]),"text-translate-anchor":new $t(ze.paint_symbol["text-translate-anchor"])})},get layout(){return fy=fy||new fa({"symbol-placement":new $t(ze.layout_symbol["symbol-placement"]),"symbol-spacing":new $t(ze.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new $t(ze.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new rn(ze.layout_symbol["symbol-sort-key"]),"symbol-z-order":new $t(ze.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new $t(ze.layout_symbol["icon-allow-overlap"]),"icon-overlap":new $t(ze.layout_symbol["icon-overlap"]),"icon-ignore-placement":new $t(ze.layout_symbol["icon-ignore-placement"]),"icon-optional":new $t(ze.layout_symbol["icon-optional"]),"icon-rotation-alignment":new $t(ze.layout_symbol["icon-rotation-alignment"]),"icon-size":new rn(ze.layout_symbol["icon-size"]),"icon-text-fit":new $t(ze.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new $t(ze.layout_symbol["icon-text-fit-padding"]),"icon-image":new rn(ze.layout_symbol["icon-image"]),"icon-rotate":new rn(ze.layout_symbol["icon-rotate"]),"icon-padding":new rn(ze.layout_symbol["icon-padding"]),"icon-keep-upright":new $t(ze.layout_symbol["icon-keep-upright"]),"icon-offset":new rn(ze.layout_symbol["icon-offset"]),"icon-anchor":new rn(ze.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new $t(ze.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new $t(ze.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new $t(ze.layout_symbol["text-rotation-alignment"]),"text-field":new rn(ze.layout_symbol["text-field"]),"text-font":new rn(ze.layout_symbol["text-font"]),"text-size":new rn(ze.layout_symbol["text-size"]),"text-max-width":new rn(ze.layout_symbol["text-max-width"]),"text-line-height":new $t(ze.layout_symbol["text-line-height"]),"text-letter-spacing":new rn(ze.layout_symbol["text-letter-spacing"]),"text-justify":new rn(ze.layout_symbol["text-justify"]),"text-radial-offset":new rn(ze.layout_symbol["text-radial-offset"]),"text-variable-anchor":new $t(ze.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new rn(ze.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new rn(ze.layout_symbol["text-anchor"]),"text-max-angle":new $t(ze.layout_symbol["text-max-angle"]),"text-writing-mode":new $t(ze.layout_symbol["text-writing-mode"]),"text-rotate":new rn(ze.layout_symbol["text-rotate"]),"text-padding":new $t(ze.layout_symbol["text-padding"]),"text-keep-upright":new $t(ze.layout_symbol["text-keep-upright"]),"text-transform":new rn(ze.layout_symbol["text-transform"]),"text-offset":new rn(ze.layout_symbol["text-offset"]),"text-allow-overlap":new $t(ze.layout_symbol["text-allow-overlap"]),"text-overlap":new $t(ze.layout_symbol["text-overlap"]),"text-ignore-placement":new $t(ze.layout_symbol["text-ignore-placement"]),"text-optional":new $t(ze.layout_symbol["text-optional"])})}};class Im{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:ba,this.defaultValue=i}evaluate(i){if(i.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(i.formattedSection))return o.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ut("FormatSectionOverride",Im,{omit:["defaultValue"]});class Zd extends oa{constructor(i){super(i,my)}recalculate(i,o){if(super.recalculate(i,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const v=[];for(const T of f)v.indexOf(T)<0&&v.push(T);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,o,f,v){const T=this.layout.get(i).evaluate(o,{},f,v),S=this._unevaluatedLayout._values[i];return S.isDataDriven()||zu(S.value)||!T?T:function(C,k){return k.replace(/{([^{}]+)}/g,(z,N)=>C&&N in C?String(C[N]):"")}(o.properties,T)}createBucket(i){return new Gc(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of my.paint.overridableProperties){if(!Zd.hasPaintOverride(this.layout,i))continue;const o=this.paint.get(i),f=new Im(o),v=new Lu(f,o.property.specification);let T=null;T=o.value.kind==="constant"||o.value.kind==="source"?new Aa("source",v):new jo("composite",v,o.value.zoomStops),this.paint._values[i]=new Ca(o.property,T,o.parameters)}}_handleOverridablePaintPropertyUpdate(i,o,f){return!(!this.layout||o.isDataDriven()||f.isDataDriven())&&Zd.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,o){const f=i.get("text-field"),v=my.paint.properties[o];let T=!1;const S=C=>{for(const k of C)if(v.overrides&&v.overrides.hasOverride(k))return void(T=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Hi)S(f.value.value.sections);else if(f.value.kind==="source"){const C=z=>{T||(z instanceof Dn&&ln(z.value)===Do?S(z.value.sections):z instanceof A?S(z.sections):z.eachChild(C))},k=f.value;k._styleExpression&&C(k._styleExpression.expression)}return T}}let gv;var Ob={get paint(){return gv=gv||new fa({"background-color":new $t(ze.paint_background["background-color"]),"background-pattern":new si(ze.paint_background["background-pattern"]),"background-opacity":new $t(ze.paint_background["background-opacity"])})}};class mp extends oa{constructor(i){super(i,Ob)}}let yv;var _v={get paint(){return yv=yv||new fa({"raster-opacity":new $t(ze.paint_raster["raster-opacity"]),"raster-hue-rotate":new $t(ze.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new $t(ze.paint_raster["raster-brightness-min"]),"raster-brightness-max":new $t(ze.paint_raster["raster-brightness-max"]),"raster-saturation":new $t(ze.paint_raster["raster-saturation"]),"raster-contrast":new $t(ze.paint_raster["raster-contrast"]),"raster-resampling":new $t(ze.paint_raster["raster-resampling"]),"raster-fade-duration":new $t(ze.paint_raster["raster-fade-duration"])})}};class er extends oa{constructor(i){super(i,_v)}}class gy extends oa{constructor(i){super(i,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Mm{constructor(i){this._methodToThrottle=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const yy={once:!0},Pm=63710088e-1;class hu{constructor(i,o){if(isNaN(i)||isNaN(o))throw new Error(`Invalid LngLat object: (${i}, ${o})`);if(this.lng=+i,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new hu(Ds(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const o=Math.PI/180,f=this.lat*o,v=i.lat*o,T=Math.sin(f)*Math.sin(v)+Math.cos(f)*Math.cos(v)*Math.cos((i.lng-this.lng)*o);return Pm*Math.acos(Math.min(T,1))}static convert(i){if(i instanceof hu)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new hu(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new hu(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Wd=2*Math.PI*Pm;function gp(u){return Wd*Math.cos(u*Math.PI/180)}function qh(u){return(180+u)/360}function _y(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function vv(u,i){return u/gp(i)}function vy(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function by(u,i){return u*gp(vy(i))}class Kd{constructor(i,o,f=0){this.x=+i,this.y=+o,this.z=+f}static fromLngLat(i,o=0){const f=hu.convert(i);return new Kd(qh(f.lng),_y(f.lat),vv(o,f.lat))}toLngLat(){return new hu(360*this.x-180,vy(this.y))}toAltitude(){return by(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Wd*(i=vy(this.y),1/Math.cos(i*Math.PI/180));var i}}function yp(u,i,o){var f=2*Math.PI*6378137/256/Math.pow(2,o);return[u*f-2*Math.PI*6378137/2,i*f-2*Math.PI*6378137/2]}class Rr{constructor(i,o,f){if(!function(v,T,S){return!(v<0||v>25||S<0||S>=Math.pow(2,v)||T<0||T>=Math.pow(2,v))}(i,o,f))throw new Error(`x=${o}, y=${f}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=o,this.y=f,this.key=Xd(0,i,i,o,f)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,o,f){const v=(S=this.y,C=this.z,k=yp(256*(T=this.x),256*(S=Math.pow(2,C)-S-1),C),z=yp(256*(T+1),256*(S+1),C),k[0]+","+k[1]+","+z[0]+","+z[1]);var T,S,C,k,z;const N=function(j,G,Y){let J,te="";for(let le=j;le>0;le--)J=1<<le-1,te+=(G&J?1:0)+(Y&J?2:0);return te}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,N).replace(/{bbox-epsg-3857}/g,v)}isChildOf(i){const o=this.z-i.z;return o>0&&i.x===this.x>>o&&i.y===this.y>>o}getTilePoint(i){const o=Math.pow(2,this.z);return new re((i.x*o-this.x)*At,(i.y*o-this.y)*At)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Rm{constructor(i,o){this.wrap=i,this.canonical=o,this.key=Xd(i,o.z,o.z,o.x,o.y)}}class Br{constructor(i,o,f,v,T){if(this.terrainRttPosMatrix32f=null,i<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${f}`);this.overscaledZ=i,this.wrap=o,this.canonical=new Rr(f,+v,+T),this.key=Xd(o,i,f,v,T)}clone(){return new Br(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-i;return i>this.canonical.z?new Br(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Br(i,this.wrap,i,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(i,o){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-i;return i>this.canonical.z?Xd(this.wrap*+o,i,this.canonical.z,this.canonical.x,this.canonical.y):Xd(this.wrap*+o,i,i,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const o=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>o&&i.canonical.y===this.canonical.y>>o}children(i){if(this.overscaledZ>=i)return[new Br(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,f=2*this.canonical.x,v=2*this.canonical.y;return[new Br(o,this.wrap,o,f,v),new Br(o,this.wrap,o,f+1,v),new Br(o,this.wrap,o,f,v+1),new Br(o,this.wrap,o,f+1,v+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Br(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Br(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Rm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new Kd(i.x-this.wrap,i.y))}}function Xd(u,i,o,f,v){(u*=2)<0&&(u=-1*u-1);const T=1<<o;return(T*T*u+T*v+f).toString(36)+o.toString(36)+i.toString(36)}Ut("CanonicalTileID",Rr),Ut("OverscaledTileID",Br,{omit:["terrainRttPosMatrix32f"]});class ac{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(i){return this.minX=Math.min(this.minX,i.x),this.minY=Math.min(this.minY,i.y),this.maxX=Math.max(this.maxX,i.x),this.maxY=Math.max(this.maxY,i.y),this}expandBy(i){return this.minX-=i,this.minY-=i,this.maxX+=i,this.maxY+=i,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(i){return this.expandBy(-i)}map(i){const o=new ac;return o.extend(i(new re(this.minX,this.minY))),o.extend(i(new re(this.maxX,this.minY))),o.extend(i(new re(this.minX,this.maxY))),o.extend(i(new re(this.maxX,this.maxY))),o}static fromPoints(i){const o=new ac;for(const f of i)o.extend(f);return o}contains(i){return i.x>=this.minX&&i.x<=this.maxX&&i.y>=this.minY&&i.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(i){return!this.empty()&&!i.empty()&&i.minX>=this.minX&&i.maxX<=this.maxX&&i.minY>=this.minY&&i.maxY<=this.maxY}intersects(i){return!this.empty()&&!i.empty()&&i.minX<=this.maxX&&i.maxX>=this.minX&&i.minY<=this.maxY&&i.maxY>=this.minY}}class km{constructor(i){this._stringToNumber={},this._numberToString=[];for(let o=0;o<i.length;o++){const f=i[o];this._stringToNumber[f]=o,this._numberToString[o]=f}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class _p{constructor(i,o,f,v,T){this.type="Feature",this._vectorTileFeature=i,i._z=o,i._x=f,i._y=v,this.properties=i.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(i[o]=this[o]);return i}}class xy{constructor(i,o){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new eu(At,16,0),this.grid3D=new eu(At,16,0),this.featureIndexArray=new rt,this.promoteId=o}insert(i,o,f,v,T,S){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,v,T);const k=S?this.grid3D:this.grid;for(let z=0;z<o.length;z++){const N=o[z],j=[1/0,1/0,-1/0,-1/0];for(let G=0;G<N.length;G++){const Y=N[G];j[0]=Math.min(j[0],Y.x),j[1]=Math.min(j[1],Y.y),j[2]=Math.max(j[2],Y.x),j[3]=Math.max(j[3],Y.y)}j[0]<At&&j[1]<At&&j[2]>=0&&j[3]>=0&&k.insert(C,j[0],j[1],j[2],j[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Pr.VectorTile(new wm(this.rawTileData)).layers,this.sourceLayerCoder=new km(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,o,f,v){this.loadVTLayers();const T=i.params,S=At/i.tileSize/i.scale,C=pi(T.filter),k=i.queryGeometry,z=i.queryPadding*S,N=ac.fromPoints(k),j=this.grid.query(N.minX-z,N.minY-z,N.maxX+z,N.maxY+z),G=ac.fromPoints(i.cameraQueryGeometry).expandBy(z),Y=this.grid3D.query(G.minX,G.minY,G.maxX,G.maxY,(le,ge,Ne,Se)=>function(X,oe,Ie,nt,yt){for(const ft of X)if(oe<=ft.x&&Ie<=ft.y&&nt>=ft.x&&yt>=ft.y)return!0;const lt=[new re(oe,Ie),new re(oe,yt),new re(nt,yt),new re(nt,Ie)];if(X.length>2){for(const ft of lt)if(zh(X,ft))return!0}for(let ft=0;ft<X.length-1;ft++)if(Ma(X[ft],X[ft+1],lt))return!0;return!1}(i.cameraQueryGeometry,le-z,ge-z,Ne+z,Se+z));for(const le of Y)j.push(le);j.sort(Ty);const J={};let te;for(let le=0;le<j.length;le++){const ge=j[le];if(ge===te)continue;te=ge;const Ne=this.featureIndexArray.get(ge);let Se=null;this.loadMatchingFeature(J,Ne.bucketIndex,Ne.sourceLayerIndex,Ne.featureIndex,C,T.layers,T.availableImages,o,f,v,(X,oe,Ie)=>(Se||(Se=Ku(X)),oe.queryIntersectsFeature({queryGeometry:k,feature:X,featureState:Ie,geometry:Se,zoom:this.z,transform:i.transform,pixelsToTileUnits:S,pixelPosMatrix:i.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:i.getElevation})))}return J}loadMatchingFeature(i,o,f,v,T,S,C,k,z,N,j){const G=this.bucketLayerIDs[o];if(S&&!G.some(le=>S.has(le)))return;const Y=this.sourceLayerCoder.decode(f),J=this.vtLayers[Y].feature(v);if(T.needGeometry){const le=Fc(J,!0);if(!T.filter(new Lr(this.tileID.overscaledZ),le,this.tileID.canonical))return}else if(!T.filter(new Lr(this.tileID.overscaledZ),J))return;const te=this.getId(J,Y);for(let le=0;le<G.length;le++){const ge=G[le];if(S&&!S.has(ge))continue;const Ne=k[ge];if(!Ne)continue;let Se={};te&&N&&(Se=N.getState(Ne.sourceLayer||"_geojsonTileLayer",te));const X=gi({},z[ge]);X.paint=wy(X.paint,Ne.paint,J,Se,C),X.layout=wy(X.layout,Ne.layout,J,Se,C);const oe=!j||j(J,Ne,Se);if(!oe)continue;const Ie=new _p(J,this.z,this.x,this.y,te);Ie.layer=X;let nt=i[ge];nt===void 0&&(nt=i[ge]=[]),nt.push({featureIndex:v,feature:Ie,intersectionZ:oe})}}lookupSymbolFeatures(i,o,f,v,T,S,C,k){const z={};this.loadVTLayers();const N=pi(T);for(const j of i)this.loadMatchingFeature(z,f,v,j,N,S,C,k,o);return z}hasLayer(i){for(const o of this.bucketLayerIDs)for(const f of o)if(i===f)return!0;return!1}getId(i,o){var f;let v=i.id;return this.promoteId&&(v=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof v=="boolean"&&(v=Number(v)),v===void 0&&(!((f=i.properties)===null||f===void 0)&&f.cluster)&&this.promoteId&&(v=Number(i.properties.cluster_id))),v}}function wy(u,i,o,f,v){return Tr(u,(T,S)=>{const C=i instanceof Uu?i.get(S):null;return C&&C.evaluate?C.evaluate(o,f,v):C})}function Ty(u,i){return i-u}function Dm(u,i,o,f,v){const T=[];for(let S=0;S<u.length;S++){const C=u[S];let k;for(let z=0;z<C.length-1;z++){let N=C[z],j=C[z+1];N.x<i&&j.x<i||(N.x<i?N=new re(i,N.y+(i-N.x)/(j.x-N.x)*(j.y-N.y))._round():j.x<i&&(j=new re(i,N.y+(i-N.x)/(j.x-N.x)*(j.y-N.y))._round()),N.y<o&&j.y<o||(N.y<o?N=new re(N.x+(o-N.y)/(j.y-N.y)*(j.x-N.x),o)._round():j.y<o&&(j=new re(N.x+(o-N.y)/(j.y-N.y)*(j.x-N.x),o)._round()),N.x>=f&&j.x>=f||(N.x>=f?N=new re(f,N.y+(f-N.x)/(j.x-N.x)*(j.y-N.y))._round():j.x>=f&&(j=new re(f,N.y+(f-N.x)/(j.x-N.x)*(j.y-N.y))._round()),N.y>=v&&j.y>=v||(N.y>=v?N=new re(N.x+(v-N.y)/(j.y-N.y)*(j.x-N.x),v)._round():j.y>=v&&(j=new re(N.x+(v-N.y)/(j.y-N.y)*(j.x-N.x),v)._round()),k&&N.equals(k[k.length-1])||(k=[N],T.push(k)),k.push(j)))))}}return T}Ut("FeatureIndex",xy,{omit:["rawTileData","sourceLayerCoder"]});class Hc extends re{constructor(i,o,f,v){super(i,o),this.angle=f,v!==void 0&&(this.segment=v)}clone(){return new Hc(this.x,this.y,this.angle,this.segment)}}function Sy(u,i,o,f,v){if(i.segment===void 0||o===0)return!0;let T=i,S=i.segment+1,C=0;for(;C>-o/2;){if(S--,S<0)return!1;C-=u[S].dist(T),T=u[S]}C+=u[S].dist(u[S+1]),S++;const k=[];let z=0;for(;C<o/2;){const N=u[S],j=u[S+1];if(!j)return!1;let G=u[S-1].angleTo(N)-N.angleTo(j);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:C,angleDelta:G}),z+=G;C-k[0].distance>f;)z-=k.shift().angleDelta;if(z>v)return!1;S++,C+=N.dist(j)}return!0}function bv(u){let i=0;for(let o=0;o<u.length-1;o++)i+=u[o].dist(u[o+1]);return i}function Ey(u,i,o){return u?.6*i*o:0}function xv(u,i){return Math.max(u?u.right-u.left:0,i?i.right-i.left:0)}function Nb(u,i,o,f,v,T){const S=Ey(o,v,T),C=xv(o,f)*T;let k=0;const z=bv(u)/2;for(let N=0;N<u.length-1;N++){const j=u[N],G=u[N+1],Y=j.dist(G);if(k+Y>z){const J=(z-k)/Y,te=aa.number(j.x,G.x,J),le=aa.number(j.y,G.y,J),ge=new Hc(te,le,G.angleTo(j),N);return ge._round(),!S||Sy(u,ge,C,S,i)?ge:void 0}k+=Y}}function Zc(u,i,o,f,v,T,S,C,k){const z=Ey(f,T,S),N=xv(f,v),j=N*S,G=u[0].x===0||u[0].x===k||u[0].y===0||u[0].y===k;return i-j<i/4&&(i=j+i/4),Ay(u,G?i/2*C%i:(N/2+2*T)*S*C%i,i,z,o,j,G,!1,k)}function Ay(u,i,o,f,v,T,S,C,k){const z=T/2,N=bv(u);let j=0,G=i-o,Y=[];for(let J=0;J<u.length-1;J++){const te=u[J],le=u[J+1],ge=te.dist(le),Ne=le.angleTo(te);for(;G+o<j+ge;){G+=o;const Se=(G-j)/ge,X=aa.number(te.x,le.x,Se),oe=aa.number(te.y,le.y,Se);if(X>=0&&X<k&&oe>=0&&oe<k&&G-z>=0&&G+z<=N){const Ie=new Hc(X,oe,Ne,J);Ie._round(),f&&!Sy(u,Ie,T,f,v)||Y.push(Ie)}}j+=ge}return C||Y.length||S||(Y=Ay(u,j/2,o,f,v,T,S,!0,k)),Y}function Lm(u,i,o,f){const v=[],T=u.image,S=T.pixelRatio,C=T.paddedRect.w-2,k=T.paddedRect.h-2;let z={x1:u.left,y1:u.top,x2:u.right,y2:u.bottom};const N=T.stretchX||[[0,C]],j=T.stretchY||[[0,k]],G=(gt,Wt)=>gt+Wt[1]-Wt[0],Y=N.reduce(G,0),J=j.reduce(G,0),te=C-Y,le=k-J;let ge=0,Ne=Y,Se=0,X=J,oe=0,Ie=te,nt=0,yt=le;if(T.content&&f){const gt=T.content,Wt=gt[2]-gt[0],sn=gt[3]-gt[1];(T.textFitWidth||T.textFitHeight)&&(z=Uh(u)),ge=zm(N,0,gt[0]),Se=zm(j,0,gt[1]),Ne=zm(N,gt[0],gt[2]),X=zm(j,gt[1],gt[3]),oe=gt[0]-ge,nt=gt[1]-Se,Ie=Wt-Ne,yt=sn-X}const lt=z.x1,ft=z.y1,Ct=z.x2-lt,xt=z.y2-ft,Rt=(gt,Wt,sn,Yt)=>{const Ht=Yd(gt.stretch-ge,Ne,Ct,lt),Sn=Om(gt.fixed-oe,Ie,gt.stretch,Y),Vr=Yd(Wt.stretch-Se,X,xt,ft),ui=Om(Wt.fixed-nt,yt,Wt.stretch,J),ci=Yd(sn.stretch-ge,Ne,Ct,lt),Co=Om(sn.fixed-oe,Ie,sn.stretch,Y),rs=Yd(Yt.stretch-Se,X,xt,ft),Ei=Om(Yt.fixed-nt,yt,Yt.stretch,J),ri=new re(Ht,Vr),Qi=new re(ci,Vr),ji=new re(ci,rs),ua=new re(Ht,rs),is=new re(Sn/S,ui/S),as=new re(Co/S,Ei/S),Ai=i*Math.PI/180;if(Ai){const Ui=Math.sin(Ai),Ci=Math.cos(Ai),Ii=[Ci,-Ui,Ui,Ci];ri._matMult(Ii),Qi._matMult(Ii),ua._matMult(Ii),ji._matMult(Ii)}const ss=gt.stretch+gt.fixed,hi=Wt.stretch+Wt.fixed;return{tl:ri,tr:Qi,bl:ua,br:ji,tex:{x:T.paddedRect.x+1+ss,y:T.paddedRect.y+1+hi,w:sn.stretch+sn.fixed-ss,h:Yt.stretch+Yt.fixed-hi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:is,pixelOffsetBR:as,minFontScaleX:Ie/S/Ct,minFontScaleY:yt/S/xt,isSDF:o}};if(f&&(T.stretchX||T.stretchY)){const gt=wv(N,te,Y),Wt=wv(j,le,J);for(let sn=0;sn<gt.length-1;sn++){const Yt=gt[sn],Ht=gt[sn+1];for(let Sn=0;Sn<Wt.length-1;Sn++)v.push(Rt(Yt,Wt[Sn],Ht,Wt[Sn+1]))}}else v.push(Rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:k+1}));return v}function zm(u,i,o){let f=0;for(const v of u)f+=Math.max(i,Math.min(o,v[1]))-Math.max(i,Math.min(o,v[0]));return f}function wv(u,i,o){const f=[{fixed:-1,stretch:0}];for(const[v,T]of u){const S=f[f.length-1];f.push({fixed:v-S.stretch,stretch:S.stretch}),f.push({fixed:v-S.stretch,stretch:S.stretch+(T-v)})}return f.push({fixed:i+1,stretch:o}),f}function Yd(u,i,o,f){return u/i*o+f}function Om(u,i,o,f){return u-i*o/f}Ut("Anchor",Hc);class Xs{constructor(i,o,f,v,T,S,C,k,z,N){var j;if(this.boxStartIndex=i.length,z){let G=S.top,Y=S.bottom;const J=S.collisionPadding;J&&(G-=J[1],Y+=J[3]);let te=Y-G;te>0&&(te=Math.max(10,te),this.circleDiameter=te)}else{const G=!((j=S.image)===null||j===void 0)&&j.content&&(S.image.textFitWidth||S.image.textFitHeight)?Uh(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};G.y1=G.y1*C-k[0],G.y2=G.y2*C+k[2],G.x1=G.x1*C-k[3],G.x2=G.x2*C+k[1];const Y=S.collisionPadding;if(Y&&(G.x1-=Y[0]*C,G.y1-=Y[1]*C,G.x2+=Y[2]*C,G.y2+=Y[3]*C),N){const J=new re(G.x1,G.y1),te=new re(G.x2,G.y1),le=new re(G.x1,G.y2),ge=new re(G.x2,G.y2),Ne=N*Math.PI/180;J._rotate(Ne),te._rotate(Ne),le._rotate(Ne),ge._rotate(Ne),G.x1=Math.min(J.x,te.x,le.x,ge.x),G.x2=Math.max(J.x,te.x,le.x,ge.x),G.y1=Math.min(J.y,te.y,le.y,ge.y),G.y2=Math.max(J.y,te.y,le.y,ge.y)}i.emplaceBack(o.x,o.y,G.x1,G.y1,G.x2,G.y2,f,v,T)}this.boxEndIndex=i.length}}class Cy{constructor(i=[],o=(f,v)=>f<v?-1:f>v?1:0){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:f}=this,v=o[i];for(;i>0;){const T=i-1>>1,S=o[T];if(f(v,S)>=0)break;o[i]=S,i=T}o[i]=v}_down(i){const{data:o,compare:f}=this,v=this.length>>1,T=o[i];for(;i<v;){let S=1+(i<<1);const C=S+1;if(C<this.length&&f(o[C],o[S])<0&&(S=C),f(o[S],T)>=0)break;o[i]=o[S],i=S}o[i]=T}}function Tv(u,i=1,o=!1){const f=ac.fromPoints(u[0]),v=Math.min(f.width(),f.height());let T=v/2;const S=new Cy([],Sv),{minX:C,minY:k,maxX:z,maxY:N}=f;if(v===0)return new re(C,k);for(let Y=C;Y<z;Y+=v)for(let J=k;J<N;J+=v)S.push(new du(Y+T,J+T,T,u));let j=function(Y){let J=0,te=0,le=0;const ge=Y[0];for(let Ne=0,Se=ge.length,X=Se-1;Ne<Se;X=Ne++){const oe=ge[Ne],Ie=ge[X],nt=oe.x*Ie.y-Ie.x*oe.y;te+=(oe.x+Ie.x)*nt,le+=(oe.y+Ie.y)*nt,J+=3*nt}return new du(te/J,le/J,0,Y)}(u),G=S.length;for(;S.length;){const Y=S.pop();(Y.d>j.d||!j.d)&&(j=Y,o&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,G)),Y.max-j.d<=i||(T=Y.h/2,S.push(new du(Y.p.x-T,Y.p.y-T,T,u)),S.push(new du(Y.p.x+T,Y.p.y-T,T,u)),S.push(new du(Y.p.x-T,Y.p.y+T,T,u)),S.push(new du(Y.p.x+T,Y.p.y+T,T,u)),G+=4)}return o&&(console.log(`num probes: ${G}`),console.log(`best distance: ${j.d}`)),j.p}function Sv(u,i){return i.max-u.max}function du(u,i,o,f){this.p=new re(u,i),this.h=o,this.d=function(v,T){let S=!1,C=1/0;for(let k=0;k<T.length;k++){const z=T[k];for(let N=0,j=z.length,G=j-1;N<j;G=N++){const Y=z[N],J=z[G];Y.y>v.y!=J.y>v.y&&v.x<(J.x-Y.x)*(v.y-Y.y)/(J.y-Y.y)+Y.x&&(S=!S),C=Math.min(C,Lg(v,Y,J))}}return(S?1:-1)*Math.sqrt(C)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Fr;y.aD=void 0,(Fr=y.aD||(y.aD={}))[Fr.center=1]="center",Fr[Fr.left=2]="left",Fr[Fr.right=3]="right",Fr[Fr.top=4]="top",Fr[Fr.bottom=5]="bottom",Fr[Fr["top-left"]=6]="top-left",Fr[Fr["top-right"]=7]="top-right",Fr[Fr["bottom-left"]=8]="bottom-left",Fr[Fr["bottom-right"]=9]="bottom-right";const Nm=Number.POSITIVE_INFINITY;function vp(u,i){return i[1]!==Nm?function(o,f,v){let T=0,S=0;switch(f=Math.abs(f),v=Math.abs(v),o){case"top-right":case"top-left":case"top":S=v-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-v}switch(o){case"top-right":case"bottom-right":case"right":T=-f;break;case"top-left":case"bottom-left":case"left":T=f}return[T,S]}(u,i[0],i[1]):function(o,f){let v=0,T=0;f<0&&(f=0);const S=f/Math.SQRT2;switch(o){case"top-right":case"top-left":T=S-7;break;case"bottom-right":case"bottom-left":T=7-S;break;case"bottom":T=7-f;break;case"top":T=f-7}switch(o){case"top-right":case"bottom-right":v=-S;break;case"top-left":case"bottom-left":v=S;break;case"left":v=f;break;case"right":v=-f}return[v,T]}(u,i[0])}function fu(u,i,o){var f;const v=u.layout,T=(f=v.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(i,{},o);if(T){const C=T.values,k=[];for(let z=0;z<C.length;z+=2){const N=k[z]=C[z],j=C[z+1].map(G=>G*Si);N.startsWith("top")?j[1]-=7:N.startsWith("bottom")&&(j[1]+=7),k[z+1]=j}return new In(k)}const S=v.get("text-variable-anchor");if(S){let C;C=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[v.get("text-radial-offset").evaluate(i,{},o)*Si,Nm]:v.get("text-offset").evaluate(i,{},o).map(z=>z*Si);const k=[];for(const z of S)k.push(z,vp(z,C));return new In(k)}return null}function Iy(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Bb(u,i,o,f,v,T,S,C,k,z,N,j){let G=T.textMaxSize.evaluate(i,{});G===void 0&&(G=S);const Y=u.layers[0].layout,J=Y.get("icon-offset").evaluate(i,{},N),te=My(o.horizontal),le=S/24,ge=u.tilePixelRatio*le,Ne=u.tilePixelRatio*G/24,Se=u.tilePixelRatio*C,X=u.tilePixelRatio*Y.get("symbol-spacing"),oe=Y.get("text-padding")*u.tilePixelRatio,Ie=function(sn,Yt,Ht,Sn=1){const Vr=sn.get("icon-padding").evaluate(Yt,{},Ht),ui=Vr&&Vr.values;return[ui[0]*Sn,ui[1]*Sn,ui[2]*Sn,ui[3]*Sn]}(Y,i,N,u.tilePixelRatio),nt=Y.get("text-max-angle")/180*Math.PI,yt=Y.get("text-rotation-alignment")!=="viewport"&&Y.get("symbol-placement")!=="point",lt=Y.get("icon-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",ft=Y.get("symbol-placement"),Ct=X/2,xt=Y.get("icon-text-fit");let Rt;f&&xt!=="none"&&(u.allowVerticalPlacement&&o.vertical&&(Rt=Em(f,o.vertical,xt,Y.get("icon-text-fit-padding"),J,le)),te&&(f=Em(f,te,xt,Y.get("icon-text-fit-padding"),J,le)));const gt=N?j.line.getGranularityForZoomLevel(N.z):1,Wt=(sn,Yt)=>{Yt.x<0||Yt.x>=At||Yt.y<0||Yt.y>=At||function(Ht,Sn,Vr,ui,ci,Co,rs,Ei,ri,Qi,ji,ua,is,as,Ai,ss,hi,Ui,Ci,Ii,Hr,Ys,s,h,g){const x=Ht.addToLineVertexArray(Sn,Vr);let I,L,Q,ae,De=0,at=0,vt=0,Et=0,ct=-1,dt=-1;const fn={};let bn=ma("");if(Ht.allowVerticalPlacement&&ui.vertical){const As=Ei.layout.get("text-rotate").evaluate(Hr,{},h)+90;Q=new Xs(ri,Sn,Qi,ji,ua,ui.vertical,is,as,Ai,As),rs&&(ae=new Xs(ri,Sn,Qi,ji,ua,rs,hi,Ui,Ai,As))}if(ci){const As=Ei.layout.get("icon-rotate").evaluate(Hr,{}),Al=Ei.layout.get("icon-text-fit")!=="none",xp=Lm(ci,As,s,Al),oc=rs?Lm(rs,As,s,Al):void 0;L=new Xs(ri,Sn,Qi,ji,ua,ci,hi,Ui,!1,As),De=4*xp.length;const wp=Ht.iconSizeData;let Yc=null;wp.kind==="source"?(Yc=[Jo*Ei.layout.get("icon-size").evaluate(Hr,{})],Yc[0]>cu&&Ir(`${Ht.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):wp.kind==="composite"&&(Yc=[Jo*Ys.compositeIconSizes[0].evaluate(Hr,{},h),Jo*Ys.compositeIconSizes[1].evaluate(Hr,{},h)],(Yc[0]>cu||Yc[1]>cu)&&Ir(`${Ht.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ht.addSymbols(Ht.icon,xp,Yc,Ii,Ci,Hr,y.an.none,Sn,x.lineStartIndex,x.lineLength,-1,h),ct=Ht.icon.placedSymbolArray.length-1,oc&&(at=4*oc.length,Ht.addSymbols(Ht.icon,oc,Yc,Ii,Ci,Hr,y.an.vertical,Sn,x.lineStartIndex,x.lineLength,-1,h),dt=Ht.icon.placedSymbolArray.length-1)}const jr=Object.keys(ui.horizontal);for(const As of jr){const Al=ui.horizontal[As];if(!I){bn=ma(Al.text);const oc=Ei.layout.get("text-rotate").evaluate(Hr,{},h);I=new Xs(ri,Sn,Qi,ji,ua,Al,is,as,Ai,oc)}const xp=Al.positionedLines.length===1;if(vt+=$h(Ht,Sn,Al,Co,Ei,Ai,Hr,ss,x,ui.vertical?y.an.horizontal:y.an.horizontalOnly,xp?jr:[As],fn,ct,Ys,h),xp)break}ui.vertical&&(Et+=$h(Ht,Sn,ui.vertical,Co,Ei,Ai,Hr,ss,x,y.an.vertical,["vertical"],fn,dt,Ys,h));const Xe=I?I.boxStartIndex:Ht.collisionBoxArray.length,qe=I?I.boxEndIndex:Ht.collisionBoxArray.length,it=Q?Q.boxStartIndex:Ht.collisionBoxArray.length,wt=Q?Q.boxEndIndex:Ht.collisionBoxArray.length,an=L?L.boxStartIndex:Ht.collisionBoxArray.length,Xn=L?L.boxEndIndex:Ht.collisionBoxArray.length,dn=ae?ae.boxStartIndex:Ht.collisionBoxArray.length,Tn=ae?ae.boxEndIndex:Ht.collisionBoxArray.length;let Zr=-1;const ir=(As,Al)=>As&&As.circleDiameter?Math.max(As.circleDiameter,Al):Al;Zr=ir(I,Zr),Zr=ir(Q,Zr),Zr=ir(L,Zr),Zr=ir(ae,Zr);const sc=Zr>-1?1:0;sc&&(Zr*=g/Si),Ht.glyphOffsetArray.length>=Gc.MAX_GLYPHS&&Ir("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Hr.sortKey!==void 0&&Ht.addToSortKeyRanges(Ht.symbolInstances.length,Hr.sortKey);const Vb=fu(Ei,Hr,h),[SP,EP]=function(As,Al){const xp=As.length,oc=Al==null?void 0:Al.values;if((oc==null?void 0:oc.length)>0)for(let wp=0;wp<oc.length;wp+=2){const Yc=oc[wp+1];As.emplaceBack(y.aD[oc[wp]],Yc[0],Yc[1])}return[xp,As.length]}(Ht.textAnchorOffsets,Vb);Ht.symbolInstances.emplaceBack(Sn.x,Sn.y,fn.right>=0?fn.right:-1,fn.center>=0?fn.center:-1,fn.left>=0?fn.left:-1,fn.vertical||-1,ct,dt,bn,Xe,qe,it,wt,an,Xn,dn,Tn,Qi,vt,Et,De,at,sc,0,is,Zr,SP,EP)}(u,Yt,sn,o,f,v,Rt,u.layers[0],u.collisionBoxArray,i.index,i.sourceLayerIndex,u.index,ge,[oe,oe,oe,oe],yt,k,Se,Ie,lt,J,i,T,z,N,S)};if(ft==="line")for(const sn of Dm(i.geometry,0,0,At,At)){const Yt=jc(sn,gt),Ht=Zc(Yt,X,nt,o.vertical||te,f,24,Ne,u.overscaling,At);for(const Sn of Ht)te&&Fb(u,te.text,Ct,Sn)||Wt(Yt,Sn)}else if(ft==="line-center"){for(const sn of i.geometry)if(sn.length>1){const Yt=jc(sn,gt),Ht=Nb(Yt,nt,o.vertical||te,f,24,Ne);Ht&&Wt(Yt,Ht)}}else if(i.type==="Polygon")for(const sn of gd(i.geometry,0)){const Yt=Tv(sn,16);Wt(jc(sn[0],gt,!0),new Hc(Yt.x,Yt.y,0))}else if(i.type==="LineString")for(const sn of i.geometry){const Yt=jc(sn,gt);Wt(Yt,new Hc(Yt[0].x,Yt[0].y,0))}else if(i.type==="Point")for(const sn of i.geometry)for(const Yt of sn)Wt([Yt],new Hc(Yt.x,Yt.y,0))}function $h(u,i,o,f,v,T,S,C,k,z,N,j,G,Y,J){const te=function(Ne,Se,X,oe,Ie,nt,yt,lt){const ft=oe.layout.get("text-rotate").evaluate(nt,{})*Math.PI/180,Ct=[];for(const xt of Se.positionedLines)for(const Rt of xt.positionedGlyphs){if(!Rt.rect)continue;const gt=Rt.rect||{};let Wt=4,sn=!0,Yt=1,Ht=0;const Sn=(Ie||lt)&&Rt.vertical,Vr=Rt.metrics.advance*Rt.scale/2;if(lt&&Se.verticalizable&&(Ht=xt.lineOffset/2-(Rt.imageName?-(Si-Rt.metrics.width*Rt.scale)/2:(Rt.scale-1)*Si)),Rt.imageName){const Ui=yt[Rt.imageName];sn=Ui.sdf,Yt=Ui.pixelRatio,Wt=1/Yt}const ui=Ie?[Rt.x+Vr,Rt.y]:[0,0];let ci=Ie?[0,0]:[Rt.x+Vr+X[0],Rt.y+X[1]-Ht],Co=[0,0];Sn&&(Co=ci,ci=[0,0]);const rs=Rt.metrics.isDoubleResolution?2:1,Ei=(Rt.metrics.left-Wt)*Rt.scale-Vr+ci[0],ri=(-Rt.metrics.top-Wt)*Rt.scale+ci[1],Qi=Ei+gt.w/rs*Rt.scale/Yt,ji=ri+gt.h/rs*Rt.scale/Yt,ua=new re(Ei,ri),is=new re(Qi,ri),as=new re(Ei,ji),Ai=new re(Qi,ji);if(Sn){const Ui=new re(-Vr,Vr- -17),Ci=-Math.PI/2,Ii=12-Vr,Hr=new re(22-Ii,-(Rt.imageName?Ii:0)),Ys=new re(...Co);ua._rotateAround(Ci,Ui)._add(Hr)._add(Ys),is._rotateAround(Ci,Ui)._add(Hr)._add(Ys),as._rotateAround(Ci,Ui)._add(Hr)._add(Ys),Ai._rotateAround(Ci,Ui)._add(Hr)._add(Ys)}if(ft){const Ui=Math.sin(ft),Ci=Math.cos(ft),Ii=[Ci,-Ui,Ui,Ci];ua._matMult(Ii),is._matMult(Ii),as._matMult(Ii),Ai._matMult(Ii)}const ss=new re(0,0),hi=new re(0,0);Ct.push({tl:ua,tr:is,bl:as,br:Ai,tex:gt,writingMode:Se.writingMode,glyphOffset:ui,sectionIndex:Rt.sectionIndex,isSDF:sn,pixelOffsetTL:ss,pixelOffsetBR:hi,minFontScaleX:0,minFontScaleY:0})}return Ct}(0,o,C,v,T,S,f,u.allowVerticalPlacement),le=u.textSizeData;let ge=null;le.kind==="source"?(ge=[Jo*v.layout.get("text-size").evaluate(S,{})],ge[0]>cu&&Ir(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):le.kind==="composite"&&(ge=[Jo*Y.compositeTextSizes[0].evaluate(S,{},J),Jo*Y.compositeTextSizes[1].evaluate(S,{},J)],(ge[0]>cu||ge[1]>cu)&&Ir(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),u.addSymbols(u.text,te,ge,C,T,S,z,i,k.lineStartIndex,k.lineLength,G,J);for(const Ne of N)j[Ne]=u.text.placedSymbolArray.length-1;return 4*te.length}function My(u){for(const i in u)return u[i];return null}function Fb(u,i,o,f){const v=u.compareText;if(i in v){const T=v[i];for(let S=T.length-1;S>=0;S--)if(f.dist(T[S])<o)return!0}else v[i]=[];return v[i].push(f),!1}const Ev=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Py{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,f]=new Uint8Array(i,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=f>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const T=Ev[15&f];if(!T)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(i,2,1),[C]=new Uint32Array(i,4,1);return new Py(C,S,T,i)}constructor(i,o=64,f=Float64Array,v){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=f,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const T=Ev.indexOf(this.ArrayType),S=2*i*this.ArrayType.BYTES_PER_ELEMENT,C=i*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-C%8)%8;if(T<0)throw new Error(`Unexpected typed array class: ${f}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+C+k,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+S+C+k),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+C+k,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+T]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=i)}add(i,o){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=i,this.coords[this._pos++]=o,f}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return Ry(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,o,f,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:S,nodeSize:C}=this,k=[0,T.length-1,0],z=[];for(;k.length;){const N=k.pop()||0,j=k.pop()||0,G=k.pop()||0;if(j-G<=C){for(let le=G;le<=j;le++){const ge=S[2*le],Ne=S[2*le+1];ge>=i&&ge<=f&&Ne>=o&&Ne<=v&&z.push(T[le])}continue}const Y=G+j>>1,J=S[2*Y],te=S[2*Y+1];J>=i&&J<=f&&te>=o&&te<=v&&z.push(T[Y]),(N===0?i<=J:o<=te)&&(k.push(G),k.push(Y-1),k.push(1-N)),(N===0?f>=J:v>=te)&&(k.push(Y+1),k.push(j),k.push(1-N))}return z}within(i,o,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:T,nodeSize:S}=this,C=[0,v.length-1,0],k=[],z=f*f;for(;C.length;){const N=C.pop()||0,j=C.pop()||0,G=C.pop()||0;if(j-G<=S){for(let le=G;le<=j;le++)Dy(T[2*le],T[2*le+1],i,o)<=z&&k.push(v[le]);continue}const Y=G+j>>1,J=T[2*Y],te=T[2*Y+1];Dy(J,te,i,o)<=z&&k.push(v[Y]),(N===0?i-f<=J:o-f<=te)&&(C.push(G),C.push(Y-1),C.push(1-N)),(N===0?i+f>=J:o+f>=te)&&(C.push(Y+1),C.push(j),C.push(1-N))}return k}}function Ry(u,i,o,f,v,T){if(v-f<=o)return;const S=f+v>>1;Av(u,i,S,f,v,T),Ry(u,i,o,f,S-1,1-T),Ry(u,i,o,S+1,v,1-T)}function Av(u,i,o,f,v,T){for(;v>f;){if(v-f>600){const z=v-f+1,N=o-f+1,j=Math.log(z),G=.5*Math.exp(2*j/3),Y=.5*Math.sqrt(j*G*(z-G)/z)*(N-z/2<0?-1:1);Av(u,i,o,Math.max(f,Math.floor(o-N*G/z+Y)),Math.min(v,Math.floor(o+(z-N)*G/z+Y)),T)}const S=i[2*o+T];let C=f,k=v;for(bp(u,i,f,o),i[2*v+T]>S&&bp(u,i,f,v);C<k;){for(bp(u,i,C,k),C++,k--;i[2*C+T]<S;)C++;for(;i[2*k+T]>S;)k--}i[2*f+T]===S?bp(u,i,f,k):(k++,bp(u,i,k,v)),k<=o&&(f=k+1),o<=k&&(v=k-1)}}function bp(u,i,o,f){ky(u,o,f),ky(i,2*o,2*f),ky(i,2*o+1,2*f+1)}function ky(u,i,o){const f=u[i];u[i]=u[o],u[o]=f}function Dy(u,i,o,f){const v=u-o,T=i-f;return v*v+T*T}var Wc;y.cw=void 0,(Wc=y.cw||(y.cw={})).create="create",Wc.load="load",Wc.fullLoad="fullLoad";let Kc=null,Qd=[];const Ly=1e3/60,Xc="loadTime",Gh="fullLoadTime",Cv={mark(u){performance.mark(u)},frame(u){const i=u;Kc!=null&&Qd.push(i-Kc),Kc=i},clearMetrics(){Kc=null,Qd=[],performance.clearMeasures(Xc),performance.clearMeasures(Gh);for(const u in y.cw)performance.clearMarks(y.cw[u])},getPerformanceMetrics(){performance.measure(Xc,y.cw.create,y.cw.load),performance.measure(Gh,y.cw.create,y.cw.fullLoad);const u=performance.getEntriesByName(Xc)[0].duration,i=performance.getEntriesByName(Gh)[0].duration,o=Qd.length,f=1/(Qd.reduce((T,S)=>T+S,0)/o/1e3),v=Qd.filter(T=>T>Ly).reduce((T,S)=>T+(S-Ly)/Ly,0);return{loadTime:u,fullLoadTime:i,fps:f,percentDroppedFrames:v/(o+v)*100,totalFrames:o}}};y.$=At,y.A=Ze,y.B=function([u,i,o]){return i+=90,i*=Math.PI/180,o*=Math.PI/180,{x:u*Math.cos(i)*Math.sin(o),y:u*Math.sin(i)*Math.sin(o),z:u*Math.cos(o)}},y.C=aa,y.D=$t,y.E=mt,y.F=Lr,y.G=Ih,y.H=function(u){if(Ls==null){const i=u.navigator?u.navigator.userAgent:null;Ls=!!u.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return Ls},y.I=sy,y.J=class{constructor(u,i){this.target=u,this.mapId=i,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Mm(()=>this.process()),this.subscription=fr(this.target,"message",o=>this.receive(o),!1),this.globalScope=na(self)?u:window}registerMessageHandler(u,i){this.messageHandlers[u]=i}sendAsync(u,i){return new Promise((o,f)=>{const v=Math.round(1e18*Math.random()).toString(36).substring(0,10),T=i?fr(i.signal,"abort",()=>{T==null||T.unsubscribe(),delete this.resolveRejects[v];const k={id:v,type:"<cancel>",origin:location.origin,targetMapId:u.targetMapId,sourceMapId:this.mapId};this.target.postMessage(k)},yy):null;this.resolveRejects[v]={resolve:k=>{T==null||T.unsubscribe(),o(k)},reject:k=>{T==null||T.unsubscribe(),f(k)}};const S=[],C=Object.assign(Object.assign({},u),{id:v,sourceMapId:this.mapId,origin:location.origin,data:Lc(u.data,S)});this.target.postMessage(C,{transfer:S})})}receive(u){const i=u.data,o=i.id;if(!(i.origin!=="file://"&&location.origin!=="file://"&&i.origin!=="resource://android"&&location.origin!=="resource://android"&&i.origin!==location.origin||i.targetMapId&&this.mapId!==i.targetMapId)){if(i.type==="<cancel>"){delete this.tasks[o];const f=this.abortControllers[o];return delete this.abortControllers[o],void(f&&f.abort())}if(na(self)||i.mustQueue)return this.tasks[o]=i,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,i)}}process(){if(this.taskQueue.length===0)return;const u=this.taskQueue.shift(),i=this.tasks[u];delete this.tasks[u],this.taskQueue.length>0&&this.invoker.trigger(),i&&this.processTask(u,i)}processTask(u,i){return c(this,void 0,void 0,function*(){if(i.type==="<response>"){const v=this.resolveRejects[u];return delete this.resolveRejects[u],v?void(i.error?v.reject(Ts(i.error)):v.resolve(Ts(i.data))):void 0}if(!this.messageHandlers[i.type])return void this.completeTask(u,new Error(`Could not find a registered handler for ${i.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=Ts(i.data),f=new AbortController;this.abortControllers[u]=f;try{const v=yield this.messageHandlers[i.type](i.sourceMapId,o,f);this.completeTask(u,null,v)}catch(v){this.completeTask(u,v)}})}completeTask(u,i,o){const f=[];delete this.abortControllers[u];const v={id:u,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:i?Lc(i):null,data:Lc(o,f)};this.target.postMessage(v,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},y.K=ue,y.L=function(){var u=new Ze(16);return Ze!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},y.M=function(u,i,o){var f,v,T,S,C,k,z,N,j,G,Y,J,te=o[0],le=o[1],ge=o[2];return i===u?(u[12]=i[0]*te+i[4]*le+i[8]*ge+i[12],u[13]=i[1]*te+i[5]*le+i[9]*ge+i[13],u[14]=i[2]*te+i[6]*le+i[10]*ge+i[14],u[15]=i[3]*te+i[7]*le+i[11]*ge+i[15]):(v=i[1],T=i[2],S=i[3],C=i[4],k=i[5],z=i[6],N=i[7],j=i[8],G=i[9],Y=i[10],J=i[11],u[0]=f=i[0],u[1]=v,u[2]=T,u[3]=S,u[4]=C,u[5]=k,u[6]=z,u[7]=N,u[8]=j,u[9]=G,u[10]=Y,u[11]=J,u[12]=f*te+C*le+j*ge+i[12],u[13]=v*te+k*le+G*ge+i[13],u[14]=T*te+z*le+Y*ge+i[14],u[15]=S*te+N*le+J*ge+i[15]),u},y.N=function(u,i,o){var f=o[0],v=o[1],T=o[2];return u[0]=i[0]*f,u[1]=i[1]*f,u[2]=i[2]*f,u[3]=i[3]*f,u[4]=i[4]*v,u[5]=i[5]*v,u[6]=i[6]*v,u[7]=i[7]*v,u[8]=i[8]*T,u[9]=i[9]*T,u[10]=i[10]*T,u[11]=i[11]*T,u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15],u},y.O=function(u,i,o){var f=i[0],v=i[1],T=i[2],S=i[3],C=i[4],k=i[5],z=i[6],N=i[7],j=i[8],G=i[9],Y=i[10],J=i[11],te=i[12],le=i[13],ge=i[14],Ne=i[15],Se=o[0],X=o[1],oe=o[2],Ie=o[3];return u[0]=Se*f+X*C+oe*j+Ie*te,u[1]=Se*v+X*k+oe*G+Ie*le,u[2]=Se*T+X*z+oe*Y+Ie*ge,u[3]=Se*S+X*N+oe*J+Ie*Ne,u[4]=(Se=o[4])*f+(X=o[5])*C+(oe=o[6])*j+(Ie=o[7])*te,u[5]=Se*v+X*k+oe*G+Ie*le,u[6]=Se*T+X*z+oe*Y+Ie*ge,u[7]=Se*S+X*N+oe*J+Ie*Ne,u[8]=(Se=o[8])*f+(X=o[9])*C+(oe=o[10])*j+(Ie=o[11])*te,u[9]=Se*v+X*k+oe*G+Ie*le,u[10]=Se*T+X*z+oe*Y+Ie*ge,u[11]=Se*S+X*N+oe*J+Ie*Ne,u[12]=(Se=o[12])*f+(X=o[13])*C+(oe=o[14])*j+(Ie=o[15])*te,u[13]=Se*v+X*k+oe*G+Ie*le,u[14]=Se*T+X*z+oe*Y+Ie*ge,u[15]=Se*S+X*N+oe*J+Ie*Ne,u},y.P=re,y.Q=function(u,i){const o={};for(let f=0;f<i.length;f++){const v=i[f];v in u&&(o[v]=u[v])}return o},y.R=Ha,y.S=hu,y.T=pm,y.U=_y,y.V=qh,y.W=ut,y.X=Ue,y.Y=zs,y.Z=Br,y._=c,y.a=ne,y.a$=function(u,i,o){return u[0]=i[0]*o,u[1]=i[1]*o,u[2]=i[2]*o,u[3]=i[3]*o,u},y.a0=Kd,y.a1=ac,y.a2=25,y.a3=Rr,y.a4=u=>{const i=window.document.createElement("video");return i.muted=!0,new Promise(o=>{i.onloadstart=()=>{o(i)};for(const f of u){const v=window.document.createElement("source");tt(f)||(i.crossOrigin="Anonymous"),v.src=f,i.appendChild(v)}})},y.a5=kt,y.a6=function(){return ao++},y.a7=fe,y.a8=Gc,y.a9=pi,y.aA=Si,y.aB=St,y.aC=function(u,i,o,f,v=!1){if(!o[0]&&!o[1])return[0,0];const T=v?f==="map"?-u.bearingInRadians:0:f==="viewport"?u.bearingInRadians:0;if(T){const S=Math.sin(T),C=Math.cos(T);o=[o[0]*C-o[1]*S,o[0]*S+o[1]*C]}return[v?o[0]:St(i,o[0],u.zoom),v?o[1]:St(i,o[1],u.zoom)]},y.aE=el,y.aF=Iy,y.aG=Nr,y.aH=Py,y.aI=Yr,y.aJ=rp,y.aK=Ye,y.aL=Zn,y.aM=yr,y.aN=Ds,y.aO=di,y.aP=by,y.aQ=ve,y.aR=ke,y.aS=function(u){var i=new Ze(3);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i},y.aT=function(u,i,o){return u[0]=i[0]-o[0],u[1]=i[1]-o[1],u[2]=i[2]-o[2],u},y.aU=function(u,i){var o=i[0],f=i[1],v=i[2],T=o*o+f*f+v*v;return T>0&&(T=1/Math.sqrt(T)),u[0]=i[0]*T,u[1]=i[1]*T,u[2]=i[2]*T,u},y.aV=Bt,y.aW=function(u,i){return u[0]*i[0]+u[1]*i[1]+u[2]*i[2]},y.aX=function(u,i,o){return u[0]=i[0]*o[0],u[1]=i[1]*o[1],u[2]=i[2]*o[2],u[3]=i[3]*o[3],u},y.aY=we,y.aZ=function(u,i,o){const f=i[0]*o[0]+i[1]*o[1]+i[2]*o[2];return f===0?null:(-(u[0]*o[0]+u[1]*o[1]+u[2]*o[2])-o[3])/f},y.a_=et,y.aa=Fc,y.ab=_p,y.ac=function(u){const i={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,f,v,T)=>{const S=v||T;return i[f]=!S||S.toLowerCase(),""}),i["max-age"]){const o=parseInt(i["max-age"],10);isNaN(o)?delete i["max-age"]:i["max-age"]=o}return i},y.ad=Bn,y.ae=function(u){return Math.pow(2,u)},y.af=se,y.ag=Cr,y.ah=85.051129,y.ai=vv,y.aj=function(u){return Math.log(u)/Math.LN2},y.ak=function(u){var i=u[0],o=u[1];return i*i+o*o},y.al=function(u,i){const o=[];for(const f in u)f in i||o.push(f);return o},y.am=function(u,i){let o=0,f=0;if(u.kind==="constant")f=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:v,minZoom:T,maxZoom:S}=u,C=v?Cr(_i.interpolationFactor(v,i,T,S),0,1):0;u.kind==="camera"?f=aa.number(u.minSize,u.maxSize,C):o=C}return{uSizeT:o,uSize:f}},y.ao=function(u,{uSize:i,uSizeT:o},{lowerSize:f,upperSize:v}){return u.kind==="source"?f/Jo:u.kind==="composite"?aa.number(f/Jo,v/Jo,o):i},y.ap=function(u,i){var o=i[0],f=i[1],v=i[2],T=i[3],S=i[4],C=i[5],k=i[6],z=i[7],N=i[8],j=i[9],G=i[10],Y=i[11],J=i[12],te=i[13],le=i[14],ge=i[15],Ne=o*C-f*S,Se=o*k-v*S,X=o*z-T*S,oe=f*k-v*C,Ie=f*z-T*C,nt=v*z-T*k,yt=N*te-j*J,lt=N*le-G*J,ft=N*ge-Y*J,Ct=j*le-G*te,xt=j*ge-Y*te,Rt=G*ge-Y*le,gt=Ne*Rt-Se*xt+X*Ct+oe*ft-Ie*lt+nt*yt;return gt?(u[0]=(C*Rt-k*xt+z*Ct)*(gt=1/gt),u[1]=(v*xt-f*Rt-T*Ct)*gt,u[2]=(te*nt-le*Ie+ge*oe)*gt,u[3]=(G*Ie-j*nt-Y*oe)*gt,u[4]=(k*ft-S*Rt-z*lt)*gt,u[5]=(o*Rt-v*ft+T*lt)*gt,u[6]=(le*X-J*nt-ge*Se)*gt,u[7]=(N*nt-G*X+Y*Se)*gt,u[8]=(S*xt-C*ft+z*yt)*gt,u[9]=(f*ft-o*xt-T*yt)*gt,u[10]=(J*Ie-te*X+ge*Ne)*gt,u[11]=(j*X-N*Ie-Y*Ne)*gt,u[12]=(C*lt-S*Ct-k*yt)*gt,u[13]=(o*Ct-f*lt+v*yt)*gt,u[14]=(te*Se-J*oe-le*Ne)*gt,u[15]=(N*oe-j*Se+G*Ne)*gt,u):null},y.aq=Re,y.ar=function(u){return Math.hypot(u[0],u[1])},y.as=function(u){return u[0]=0,u[1]=0,u},y.at=function(u,i,o){return u[0]=i[0]*o,u[1]=i[1]*o,u},y.au=Am,y.av=Mt,y.aw=function(u,i,o,f){const v=i.y-u.y,T=i.x-u.x,S=f.y-o.y,C=f.x-o.x,k=S*T-C*v;if(k===0)return null;const z=(C*(u.y-o.y)-S*(u.x-o.x))/k;return new re(u.x+z*T,u.y+z*v)},y.ax=Dm,y.ay=Rg,y.az=function(u){let i=1/0,o=1/0,f=-1/0,v=-1/0;for(const T of u)i=Math.min(i,T.x),o=Math.min(o,T.y),f=Math.max(f,T.x),v=Math.max(v,T.y);return[i,o,f,v]},y.b=Xa,y.b$=lv,y.b0=function(u,i){return u[0]*i[0]+u[1]*i[1]+u[2]*i[2]+u[3]},y.b1=Rm,y.b2=Xd,y.b3=function(u,i,o,f,v){var T,S=1/Math.tan(i/2);return u[0]=S/o,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=S,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,v!=null&&v!==1/0?(u[10]=(v+f)*(T=1/(f-v)),u[14]=2*v*f*T):(u[10]=-1,u[14]=-2*f),u},y.b4=function(u){var i=new Ze(16);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i[3]=u[3],i[4]=u[4],i[5]=u[5],i[6]=u[6],i[7]=u[7],i[8]=u[8],i[9]=u[9],i[10]=u[10],i[11]=u[11],i[12]=u[12],i[13]=u[13],i[14]=u[14],i[15]=u[15],i},y.b5=function(u,i,o){var f=Math.sin(o),v=Math.cos(o),T=i[0],S=i[1],C=i[2],k=i[3],z=i[4],N=i[5],j=i[6],G=i[7];return i!==u&&(u[8]=i[8],u[9]=i[9],u[10]=i[10],u[11]=i[11],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[0]=T*v+z*f,u[1]=S*v+N*f,u[2]=C*v+j*f,u[3]=k*v+G*f,u[4]=z*v-T*f,u[5]=N*v-S*f,u[6]=j*v-C*f,u[7]=G*v-k*f,u},y.b6=function(u,i,o){var f=Math.sin(o),v=Math.cos(o),T=i[4],S=i[5],C=i[6],k=i[7],z=i[8],N=i[9],j=i[10],G=i[11];return i!==u&&(u[0]=i[0],u[1]=i[1],u[2]=i[2],u[3]=i[3],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[4]=T*v+z*f,u[5]=S*v+N*f,u[6]=C*v+j*f,u[7]=k*v+G*f,u[8]=z*v-T*f,u[9]=N*v-S*f,u[10]=j*v-C*f,u[11]=G*v-k*f,u},y.b7=function(){const u=new Float32Array(16);return se(u),u},y.b8=function(){const u=new Float64Array(16);return se(u),u},y.b9=function(){return new Float64Array(16)},y.bA=function(u){return u[0]=0,u[1]=0,u[2]=0,u},y.bB=function(u,i,o,f){const v=Math.sqrt(u*u+i*i),T=Math.sqrt(o*o+f*f);u/=v,i/=v,o/=T,f/=T;const S=Math.acos(u*o+i*f);return-i*o+u*f>0?S:-S},y.bC=function(u,i){const o=Qt(u,2*Math.PI),f=Qt(i,2*Math.PI);return Math.min(Math.abs(o-f),Math.abs(o-f+2*Math.PI),Math.abs(o-f-2*Math.PI))},y.bD=function(){const u={},i=ze.$version;for(const o in ze.$root){const f=ze.$root[o];if(f.required){let v=null;v=o==="version"?i:f.type==="array"?[]:{},v!=null&&(u[o]=v)}}return u},y.bE=Ph,y.bF=Oe,y.bG=function u(i,o){if(Array.isArray(i)){if(!Array.isArray(o)||i.length!==o.length)return!1;for(let f=0;f<i.length;f++)if(!u(i[f],o[f]))return!1;return!0}if(typeof i=="object"&&i!==null&&o!==null){if(typeof o!="object"||Object.keys(i).length!==Object.keys(o).length)return!1;for(const f in i)if(!u(i[f],o[f]))return!1;return!0}return i===o},y.bH=function(u){u=u.slice();const i=Object.create(null);for(let o=0;o<u.length;o++)i[u[o].id]=u[o];for(let o=0;o<u.length;o++)"ref"in u[o]&&(u[o]=on(u[o],i[u[o].ref]));return u},y.bI=function(u){if(u.type==="custom")return new gy(u);switch(u.type){case"background":return new mp(u);case"circle":return new um(u);case"color-relief":return new mm(u);case"fill":return new lu(u);case"fill-extrusion":return new qc(u);case"heatmap":return new Q_(u);case"hillshade":return new Xu(u);case"line":return new Jg(u);case"raster":return new er(u);case"symbol":return new Zd(u)}},y.bJ=_a,y.bK=function(u,i){if(!u)return[{command:"setStyle",args:[i]}];let o=[];try{if(!jt(u.version,i.version))return[{command:"setStyle",args:[i]}];jt(u.center,i.center)||o.push({command:"setCenter",args:[i.center]}),jt(u.state,i.state)||o.push({command:"setGlobalState",args:[i.state]}),jt(u.centerAltitude,i.centerAltitude)||o.push({command:"setCenterAltitude",args:[i.centerAltitude]}),jt(u.zoom,i.zoom)||o.push({command:"setZoom",args:[i.zoom]}),jt(u.bearing,i.bearing)||o.push({command:"setBearing",args:[i.bearing]}),jt(u.pitch,i.pitch)||o.push({command:"setPitch",args:[i.pitch]}),jt(u.roll,i.roll)||o.push({command:"setRoll",args:[i.roll]}),jt(u.sprite,i.sprite)||o.push({command:"setSprite",args:[i.sprite]}),jt(u.glyphs,i.glyphs)||o.push({command:"setGlyphs",args:[i.glyphs]}),jt(u.transition,i.transition)||o.push({command:"setTransition",args:[i.transition]}),jt(u.light,i.light)||o.push({command:"setLight",args:[i.light]}),jt(u.terrain,i.terrain)||o.push({command:"setTerrain",args:[i.terrain]}),jt(u.sky,i.sky)||o.push({command:"setSky",args:[i.sky]}),jt(u.projection,i.projection)||o.push({command:"setProjection",args:[i.projection]});const f={},v=[];(function(S,C,k,z){let N;for(N in C=C||{},S=S||{})Object.prototype.hasOwnProperty.call(S,N)&&(Object.prototype.hasOwnProperty.call(C,N)||An(N,k,z));for(N in C)Object.prototype.hasOwnProperty.call(C,N)&&(Object.prototype.hasOwnProperty.call(S,N)?jt(S[N],C[N])||(S[N].type==="geojson"&&C[N].type==="geojson"&&Cn(S,C,N)?Jt(k,{command:"setGeoJSONSourceData",args:[N,C[N].data]}):vn(N,C,k,z)):Xt(N,C,k))})(u.sources,i.sources,v,f);const T=[];u.layers&&u.layers.forEach(S=>{"source"in S&&f[S.source]?o.push({command:"removeLayer",args:[S.id]}):T.push(S)}),o=o.concat(v),function(S,C,k){C=C||[];const z=(S=S||[]).map(jn),N=C.map(jn),j=S.reduce(Kr,{}),G=C.reduce(Kr,{}),Y=z.slice(),J=Object.create(null);let te,le,ge,Ne,Se;for(let X=0,oe=0;X<z.length;X++)te=z[X],Object.prototype.hasOwnProperty.call(G,te)?oe++:(Jt(k,{command:"removeLayer",args:[te]}),Y.splice(Y.indexOf(te,oe),1));for(let X=0,oe=0;X<N.length;X++)te=N[N.length-1-X],Y[Y.length-1-X]!==te&&(Object.prototype.hasOwnProperty.call(j,te)?(Jt(k,{command:"removeLayer",args:[te]}),Y.splice(Y.lastIndexOf(te,Y.length-oe),1)):oe++,Ne=Y[Y.length-X],Jt(k,{command:"addLayer",args:[G[te],Ne]}),Y.splice(Y.length-X,0,te),J[te]=!0);for(let X=0;X<N.length;X++)if(te=N[X],le=j[te],ge=G[te],!J[te]&&!jt(le,ge))if(jt(le.source,ge.source)&&jt(le["source-layer"],ge["source-layer"])&&jt(le.type,ge.type)){for(Se in cn(le.layout,ge.layout,k,te,null,"setLayoutProperty"),cn(le.paint,ge.paint,k,te,null,"setPaintProperty"),jt(le.filter,ge.filter)||Jt(k,{command:"setFilter",args:[te,ge.filter]}),jt(le.minzoom,ge.minzoom)&&jt(le.maxzoom,ge.maxzoom)||Jt(k,{command:"setLayerZoomRange",args:[te,ge.minzoom,ge.maxzoom]}),le)Object.prototype.hasOwnProperty.call(le,Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?cn(le[Se],ge[Se],k,te,Se.slice(6),"setPaintProperty"):jt(le[Se],ge[Se])||Jt(k,{command:"setLayerProperty",args:[te,Se,ge[Se]]}));for(Se in ge)Object.prototype.hasOwnProperty.call(ge,Se)&&!Object.prototype.hasOwnProperty.call(le,Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?cn(le[Se],ge[Se],k,te,Se.slice(6),"setPaintProperty"):jt(le[Se],ge[Se])||Jt(k,{command:"setLayerProperty",args:[te,Se,ge[Se]]}))}else Jt(k,{command:"removeLayer",args:[te]}),Ne=Y[Y.lastIndexOf(te)+1],Jt(k,{command:"addLayer",args:[ge,Ne]})}(T,i.layers,o)}catch(f){console.warn("Unable to compute style diff:",f),o=[{command:"setStyle",args:[i]}]}return o},y.bL=function(u){const i=[],o=u.id;return o===void 0&&i.push({message:`layers.${o}: missing required property "id"`}),u.render===void 0&&i.push({message:`layers.${o}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&i.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),i},y.bM=Tr,y.bN=ya,y.bO=class extends vr{constructor(u,i){super(u,i),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},y.bP=Dh,y.bQ=class extends vr{constructor(u,i){super(u,i),this.current=im}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let i=1;i<16;i++)if(u[i]!==this.current[i]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},y.bR=oi,y.bS=class extends vr{constructor(u,i){super(u,i),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},y.bT=class extends vr{constructor(u,i){super(u,i),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},y.bU=me,y.bV=function(u,i){var o=Math.sin(i),f=Math.cos(i);return u[0]=f,u[1]=o,u[2]=0,u[3]=-o,u[4]=f,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},y.bW=function(u,i,o){var f=i[0],v=i[1],T=i[2];return u[0]=f*o[0]+v*o[3]+T*o[6],u[1]=f*o[1]+v*o[4]+T*o[7],u[2]=f*o[2]+v*o[5]+T*o[8],u},y.bX=function(u,i,o,f,v,T,S){var C=1/(i-o),k=1/(f-v),z=1/(T-S);return u[0]=-2*C,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*k,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*z,u[11]=0,u[12]=(i+o)*C,u[13]=(v+f)*k,u[14]=(S+T)*z,u[15]=1,u},y.bY=class extends vr{constructor(u,i){super(u,i),this.current=new Array}set(u){if(u!=this.current){this.current=u;const i=new Float32Array(4*u.length);for(let o=0;o<u.length;o++)i[4*o]=u[o].r,i[4*o+1]=u[o].g,i[4*o+2]=u[o].b,i[4*o+3]=u[o].a;this.gl.uniform4fv(this.location,i)}}},y.bZ=class extends vr{constructor(u,i){super(u,i),this.current=new Array}set(u){if(u!=this.current){this.current=u;const i=new Float32Array(u);this.gl.uniform1fv(this.location,i)}}},y.b_=class extends p{},y.ba=function(u,i,o){const f=new Float64Array(4);return Gt(f,u,i-90,o),f},y.bb=function(u,i,o,f){var v,T,S,C,k,z=i[0],N=i[1],j=i[2],G=i[3],Y=o[0],J=o[1],te=o[2],le=o[3];return(T=z*Y+N*J+j*te+G*le)<0&&(T=-T,Y=-Y,J=-J,te=-te,le=-le),1-T>Fe?(v=Math.acos(T),S=Math.sin(v),C=Math.sin((1-f)*v)/S,k=Math.sin(f*v)/S):(C=1-f,k=f),u[0]=C*z+k*Y,u[1]=C*N+k*J,u[2]=C*j+k*te,u[3]=C*G+k*le,u},y.bc=function(u){const i=new Float64Array(9);var o,f,v,T,S,C,k,z,N,j,G,Y,J,te,le,ge,Ne,Se;j=(v=(f=u)[0])*(k=v+v),G=(T=f[1])*k,J=(S=f[2])*k,te=S*(z=T+T),ge=(C=f[3])*k,Ne=C*z,Se=C*(N=S+S),(o=i)[0]=1-(Y=T*z)-(le=S*N),o[3]=G-Se,o[6]=J+Ne,o[1]=G+Se,o[4]=1-j-le,o[7]=te-ge,o[2]=J-Ne,o[5]=te+ge,o[8]=1-j-Y;const X=di(-Math.asin(Cr(i[2],-1,1)));let oe,Ie;return Math.hypot(i[5],i[8])<.001?(oe=0,Ie=-di(Math.atan2(i[3],i[4]))):(oe=di(i[5]===0&&i[8]===0?0:Math.atan2(i[5],i[8])),Ie=di(i[1]===0&&i[0]===0?0:Math.atan2(i[1],i[0]))),{roll:oe,pitch:X+90,bearing:Ie}},y.bd=function(u,i){return u.roll==i.roll&&u.pitch==i.pitch&&u.bearing==i.bearing},y.be=wn,y.bf=la,y.bg=Bd,y.bh=Nh,y.bi=Oh,y.bj=En,y.bk=gn,y.bl=_n,y.bm=function(u,i,o,f,v){return En(f,v,Cr((u-i)/(o-i),0,1))},y.bn=Qt,y.bo=function(){return new Float64Array(3)},y.bp=function(u,i,o,f){return u[0]=i[0]+o[0]*f,u[1]=i[1]+o[1]*f,u[2]=i[2]+o[2]*f,u},y.bq=Gt,y.br=function(u,i,o){var f=o[0],v=o[1],T=o[2],S=i[0],C=i[1],k=i[2],z=v*k-T*C,N=T*S-f*k,j=f*C-v*S,G=v*j-T*N,Y=T*z-f*j,J=f*N-v*z,te=2*o[3];return N*=te,j*=te,Y*=2,J*=2,u[0]=S+(z*=te)+(G*=2),u[1]=C+N+Y,u[2]=k+j+J,u},y.bs=function(u,i,o){const f=(v=[u[0],u[1],u[2],i[0],i[1],i[2],o[0],o[1],o[2]])[0]*((N=v[8])*(S=v[4])-(C=v[5])*(z=v[7]))+v[1]*(-N*(T=v[3])+C*(k=v[6]))+v[2]*(z*T-S*k);var v,T,S,C,k,z,N;if(f===0)return null;const j=Bt([],[i[0],i[1],i[2]],[o[0],o[1],o[2]]),G=Bt([],[o[0],o[1],o[2]],[u[0],u[1],u[2]]),Y=Bt([],[u[0],u[1],u[2]],[i[0],i[1],i[2]]),J=ve([],j,-u[3]);return ke(J,J,ve([],G,-i[3])),ke(J,J,ve([],Y,-o[3])),ve(J,J,1/f),J},y.bt=Pm,y.bu=function(){return new Float64Array(4)},y.bv=function(u,i,o,f){var v=[],T=[];return v[0]=i[0]-o[0],v[1]=i[1]-o[1],v[2]=i[2]-o[2],T[0]=v[0]*Math.cos(f)-v[1]*Math.sin(f),T[1]=v[0]*Math.sin(f)+v[1]*Math.cos(f),T[2]=v[2],u[0]=T[0]+o[0],u[1]=T[1]+o[1],u[2]=T[2]+o[2],u},y.bw=function(u,i,o,f){var v=[],T=[];return v[0]=i[0]-o[0],v[1]=i[1]-o[1],v[2]=i[2]-o[2],T[0]=v[0],T[1]=v[1]*Math.cos(f)-v[2]*Math.sin(f),T[2]=v[1]*Math.sin(f)+v[2]*Math.cos(f),u[0]=T[0]+o[0],u[1]=T[1]+o[1],u[2]=T[2]+o[2],u},y.bx=function(u,i,o,f){var v=[],T=[];return v[0]=i[0]-o[0],v[1]=i[1]-o[1],v[2]=i[2]-o[2],T[0]=v[2]*Math.sin(f)+v[0]*Math.cos(f),T[1]=v[1],T[2]=v[2]*Math.cos(f)-v[0]*Math.sin(f),u[0]=T[0]+o[0],u[1]=T[1]+o[1],u[2]=T[2]+o[2],u},y.by=function(u,i,o){var f=Math.sin(o),v=Math.cos(o),T=i[0],S=i[1],C=i[2],k=i[3],z=i[8],N=i[9],j=i[10],G=i[11];return i!==u&&(u[4]=i[4],u[5]=i[5],u[6]=i[6],u[7]=i[7],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[0]=T*v-z*f,u[1]=S*v-N*f,u[2]=C*v-j*f,u[3]=k*v-G*f,u[8]=T*f+z*v,u[9]=S*f+N*v,u[10]=C*f+j*v,u[11]=k*f+G*v,u},y.bz=function(u,i){const o=Qt(u,360),f=Qt(i,360),v=f-o,T=f>o?v-360:v+360;return Math.abs(v)<Math.abs(T)?v:T},y.c=Ge,y.c0=class extends w{},y.c1=Qf,y.c2=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},y.c3=Yf,y.c4=function(u,i,o){var f=i[0],v=i[1],T=i[2],S=o[3]*f+o[7]*v+o[11]*T+o[15];return u[0]=(o[0]*f+o[4]*v+o[8]*T+o[12])/(S=S||1),u[1]=(o[1]*f+o[5]*v+o[9]*T+o[13])/S,u[2]=(o[2]*f+o[6]*v+o[10]*T+o[14])/S,u},y.c5=class extends $u{},y.c6=class extends U{},y.c7=function(u,i){return u[0]===i[0]&&u[1]===i[1]&&u[2]===i[2]&&u[3]===i[3]&&u[4]===i[4]&&u[5]===i[5]&&u[6]===i[6]&&u[7]===i[7]&&u[8]===i[8]&&u[9]===i[9]&&u[10]===i[10]&&u[11]===i[11]&&u[12]===i[12]&&u[13]===i[13]&&u[14]===i[14]&&u[15]===i[15]},y.c8=function(u,i){var o=u[0],f=u[1],v=u[2],T=u[3],S=u[4],C=u[5],k=u[6],z=u[7],N=u[8],j=u[9],G=u[10],Y=u[11],J=u[12],te=u[13],le=u[14],ge=u[15],Ne=i[0],Se=i[1],X=i[2],oe=i[3],Ie=i[4],nt=i[5],yt=i[6],lt=i[7],ft=i[8],Ct=i[9],xt=i[10],Rt=i[11],gt=i[12],Wt=i[13],sn=i[14],Yt=i[15];return Math.abs(o-Ne)<=Fe*Math.max(1,Math.abs(o),Math.abs(Ne))&&Math.abs(f-Se)<=Fe*Math.max(1,Math.abs(f),Math.abs(Se))&&Math.abs(v-X)<=Fe*Math.max(1,Math.abs(v),Math.abs(X))&&Math.abs(T-oe)<=Fe*Math.max(1,Math.abs(T),Math.abs(oe))&&Math.abs(S-Ie)<=Fe*Math.max(1,Math.abs(S),Math.abs(Ie))&&Math.abs(C-nt)<=Fe*Math.max(1,Math.abs(C),Math.abs(nt))&&Math.abs(k-yt)<=Fe*Math.max(1,Math.abs(k),Math.abs(yt))&&Math.abs(z-lt)<=Fe*Math.max(1,Math.abs(z),Math.abs(lt))&&Math.abs(N-ft)<=Fe*Math.max(1,Math.abs(N),Math.abs(ft))&&Math.abs(j-Ct)<=Fe*Math.max(1,Math.abs(j),Math.abs(Ct))&&Math.abs(G-xt)<=Fe*Math.max(1,Math.abs(G),Math.abs(xt))&&Math.abs(Y-Rt)<=Fe*Math.max(1,Math.abs(Y),Math.abs(Rt))&&Math.abs(J-gt)<=Fe*Math.max(1,Math.abs(J),Math.abs(gt))&&Math.abs(te-Wt)<=Fe*Math.max(1,Math.abs(te),Math.abs(Wt))&&Math.abs(le-sn)<=Fe*Math.max(1,Math.abs(le),Math.abs(sn))&&Math.abs(ge-Yt)<=Fe*Math.max(1,Math.abs(ge),Math.abs(Yt))},y.c9=function(u,i){return u[0]=i[0],u[1]=i[1],u[2]=i[2],u[3]=i[3],u[4]=i[4],u[5]=i[5],u[6]=i[6],u[7]=i[7],u[8]=i[8],u[9]=i[9],u[10]=i[10],u[11]=i[11],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15],u},y.cA=function(u){delete ne.REGISTERED_PROTOCOLS[u]},y.cB=function(u,i){const o={};for(let v=0;v<u.length;v++){const T=i&&i[u[v].id]||Wl(u[v]);i&&(i[u[v].id]=T);let S=o[T];S||(S=o[T]=[]),S.push(u[v])}const f=[];for(const v in o)f.push(o[v]);return f},y.cC=Ut,y.cD=km,y.cE=xy,y.cF=oy,y.cG=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=At/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const i=u.bucket.layers[0],o=i.layout,f=i._unevaluatedLayout._values,v={layoutIconSize:f["icon-size"].possiblyEvaluate(new Lr(u.bucket.zoom+1),u.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new Lr(u.bucket.zoom+1),u.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new Lr(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:z,maxZoom:N}=u.bucket.textSizeData;v.compositeTextSizes=[f["text-size"].possiblyEvaluate(new Lr(z),u.canonical),f["text-size"].possiblyEvaluate(new Lr(N),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:z,maxZoom:N}=u.bucket.iconSizeData;v.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new Lr(z),u.canonical),f["icon-size"].possiblyEvaluate(new Lr(N),u.canonical)]}const T=o.get("text-line-height")*Si,S=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",C=o.get("text-keep-upright"),k=o.get("text-size");for(const z of u.bucket.features){const N=o.get("text-font").evaluate(z,{},u.canonical).join(","),j=k.evaluate(z,{},u.canonical),G=v.layoutTextSize.evaluate(z,{},u.canonical),Y=v.layoutIconSize.evaluate(z,{},u.canonical),J={horizontal:{},vertical:void 0},te=z.text;let le,ge=[0,0];if(te){const X=te.toString(),oe=o.get("text-letter-spacing").evaluate(z,{},u.canonical)*Si,Ie=yl(X)?oe:0,nt=o.get("text-anchor").evaluate(z,{},u.canonical),yt=fu(i,z,u.canonical);if(!yt){const xt=o.get("text-radial-offset").evaluate(z,{},u.canonical);ge=xt?vp(nt,[xt*Si,Nm]):o.get("text-offset").evaluate(z,{},u.canonical).map(Rt=>Rt*Si)}let lt=S?"center":o.get("text-justify").evaluate(z,{},u.canonical);const ft=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(z,{},u.canonical)*Si:1/0,Ct=()=>{u.bucket.allowVerticalPlacement&&$o(X)&&(J.vertical=jh(te,u.glyphMap,u.glyphPositions,u.imagePositions,N,ft,T,nt,"left",Ie,ge,y.an.vertical,!0,G,j))};if(!S&&yt){const xt=new Set;if(lt==="auto")for(let gt=0;gt<yt.values.length;gt+=2)xt.add(Iy(yt.values[gt]));else xt.add(lt);let Rt=!1;for(const gt of xt)if(!J.horizontal[gt])if(Rt)J.horizontal[gt]=J.horizontal[0];else{const Wt=jh(te,u.glyphMap,u.glyphPositions,u.imagePositions,N,ft,T,"center",gt,Ie,ge,y.an.horizontal,!1,G,j);Wt&&(J.horizontal[gt]=Wt,Rt=Wt.positionedLines.length===1)}Ct()}else{lt==="auto"&&(lt=Iy(nt));const xt=jh(te,u.glyphMap,u.glyphPositions,u.imagePositions,N,ft,T,nt,lt,Ie,ge,y.an.horizontal,!1,G,j);xt&&(J.horizontal[lt]=xt),Ct(),$o(X)&&S&&C&&(J.vertical=jh(te,u.glyphMap,u.glyphPositions,u.imagePositions,N,ft,T,nt,lt,Ie,ge,y.an.vertical,!1,G,j))}}let Ne=!1;if(z.icon&&z.icon.name){const X=u.imageMap[z.icon.name];X&&(le=Sm(u.imagePositions[z.icon.name],o.get("icon-offset").evaluate(z,{},u.canonical),o.get("icon-anchor").evaluate(z,{},u.canonical)),Ne=!!X.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=Ne:u.bucket.sdfIcons!==Ne&&Ir("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(X.pixelRatio!==u.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const Se=My(J.horizontal)||J.vertical;u.bucket.iconsInText=!!Se&&Se.iconsInText,(Se||le)&&Bb(u.bucket,z,J,le,u.imageMap,v,G,Y,ge,Ne,u.canonical,u.subdivisionGranularity)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},y.cH=Ud,y.cI=Qu,y.cJ=Es,y.cK=Pr,y.cL=wm,y.cM=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},y.cN=function(u,i,o,f,v){return c(this,void 0,void 0,function*(){if(Ue())try{return yield zs(u,i,o,f,v)}catch{}return function(T,S,C,k,z){const N=T.width,j=T.height;ls&&ko||(ls=new OffscreenCanvas(N,j),ko=ls.getContext("2d",{willReadFrequently:!0})),ls.width=N,ls.height=j,ko.drawImage(T,0,0,N,j);const G=ko.getImageData(S,C,k,z);return ko.clearRect(0,0,N,j),G.data}(u,i,o,f,v)})},y.cO=su,y.cP=M,y.cQ=K,y.cR=Mr,y.cS=ry,y.cT=Ua,y.cU=Ho,y.ca=u=>u.type==="symbol",y.cb=u=>u.type==="circle",y.cc=u=>u.type==="heatmap",y.cd=u=>u.type==="line",y.ce=u=>u.type==="fill",y.cf=u=>u.type==="fill-extrusion",y.cg=u=>u.type==="hillshade",y.ch=u=>u.type==="color-relief",y.ci=u=>u.type==="raster",y.cj=u=>u.type==="background",y.ck=u=>u.type==="custom",y.cl=ii,y.cm=function(u,i,o){const f=_t(i.x-o.x,i.y-o.y),v=_t(u.x-o.x,u.y-o.y);var T,S;return di(Math.atan2(f[0]*v[1]-f[1]*v[0],(T=f)[0]*(S=v)[0]+T[1]*S[1]))},y.cn=wr,y.co=function(u,i){return xu[i]&&(u instanceof MouseEvent||u instanceof WheelEvent)},y.cp=function(u,i){return Ri[i]&&"touches"in u},y.cq=function(u){return Ri[u]||xu[u]},y.cr=function(u,i,o){var f=i[0],v=i[1];return u[0]=o[0]*f+o[4]*v+o[12],u[1]=o[1]*f+o[5]*v+o[13],u},y.cs=function(u,i){const{x:o,y:f}=Kd.fromLngLat(i);return!(u<0||u>25||f<0||f>=1||o<0||o>=1)},y.ct=function(u,i){return u[0]=i[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=i[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=i[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},y.cu=class extends Zo{},y.cv=Cv,y.cx=function(u){return u.message===so},y.cy=Te,y.cz=function(u,i){ne.REGISTERED_PROTOCOLS[u]=i},y.d=tt,y.e=gi,y.f=u=>c(void 0,void 0,void 0,function*(){if(u.byteLength===0)return createImageBitmap(new ImageData(1,1));const i=new Blob([new Uint8Array(u)],{type:"image/png"});try{return createImageBitmap(i)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),y.g=ie,y.h=u=>new Promise((i,o)=>{const f=new Image;f.onload=()=>{i(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=bu})},f.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const v=new Blob([new Uint8Array(u)],{type:"image/png"});f.src=u.byteLength?URL.createObjectURL(v):bu}),y.i=na,y.j=(u,i)=>$e(gi(u,{type:"json"}),i),y.k=Ke,y.l=st,y.m=$e,y.n=(u,i)=>$e(gi(u,{type:"arrayBuffer"}),i),y.o=function(u){return new wm(u).readFields(iy,[])},y.p=uv,y.q=zd,y.r=fa,y.s=fr,y.t=mr,y.u=On,y.v=ze,y.w=Ir,y.x=Sd,y.y=Jl,y.z=Ql}),d("worker",["./shared"],function(y){class c{constructor(ne){this.keyCache={},ne&&this.replace(ne)}replace(ne){this._layerConfigs={},this._layers={},this.update(ne,[])}update(ne,ie){for(const Te of ne){this._layerConfigs[Te.id]=Te;const Oe=this._layers[Te.id]=y.bI(Te);Oe._featureFilter=y.a9(Oe.filter),this.keyCache[Te.id]&&delete this.keyCache[Te.id]}for(const Te of ie)delete this.keyCache[Te],delete this._layerConfigs[Te],delete this._layers[Te];this.familiesBySource={};const ue=y.cB(Object.values(this._layerConfigs),this.keyCache);for(const Te of ue){const Oe=Te.map(Ke=>this._layers[Ke.id]),$e=Oe[0];if($e.visibility==="none")continue;const tt=$e.source||"";let je=this.familiesBySource[tt];je||(je=this.familiesBySource[tt]={});const ht=$e.sourceLayer||"_geojsonTileLayer";let st=je[ht];st||(st=je[ht]=[]),st.push(Oe)}}}class M{constructor(ne){const ie={},ue=[];for(const tt in ne){const je=ne[tt],ht=ie[tt]={};for(const st in je){const Ke=je[+st];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const mt={x:0,y:0,w:Ke.bitmap.width+2,h:Ke.bitmap.height+2};ue.push(mt),ht[st]={rect:mt,metrics:Ke.metrics}}}const{w:Te,h:Oe}=y.p(ue),$e=new y.q({width:Te||1,height:Oe||1});for(const tt in ne){const je=ne[tt];for(const ht in je){const st=je[+ht];if(!st||st.bitmap.width===0||st.bitmap.height===0)continue;const Ke=ie[tt][ht].rect;y.q.copy(st.bitmap,$e,{x:0,y:0},{x:Ke.x+1,y:Ke.y+1},st.bitmap)}}this.image=$e,this.positions=ie}}y.cC("GlyphAtlas",M);class R{constructor(ne){this.tileID=new y.Z(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.uid=ne.uid,this.zoom=ne.zoom,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ne.showCollisionBoxes,this.collectResourceTiming=!!ne.collectResourceTiming,this.returnDependencies=!!ne.returnDependencies,this.promoteId=ne.promoteId,this.inFlightDependencies=[],this.globalState=ne.globalState}parse(ne,ie,ue,Te,Oe){return y._(this,void 0,void 0,function*(){this.status="parsing",this.data=ne,this.collisionBoxArray=new y.a7;const $e=new y.cD(Object.keys(ne.layers).sort()),tt=new y.cE(this.tileID,this.promoteId);tt.bucketLayerIDs=[];const je={},ht={featureIndex:tt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ue,subdivisionGranularity:Oe},st=ie.familiesBySource[this.source];for(const cn in st){const jn=ne.layers[cn];if(!jn)continue;jn.version===1&&y.w(`Vector tile source "${this.source}" layer "${cn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Kr=$e.encode(cn),kt=[];for(let ai=0;ai<jn.length;ai++){const cr=jn.feature(ai),va=tt.getId(cr,cn);kt.push({feature:cr,id:va,index:ai,sourceLayerIndex:Kr})}for(const ai of st[cn]){const cr=ai[0];cr.source!==this.source&&y.w(`layer.source = ${cr.source} does not equal this.source = ${this.source}`),cr.minzoom&&this.zoom<Math.floor(cr.minzoom)||cr.maxzoom&&this.zoom>=cr.maxzoom||cr.visibility!=="none"&&(B(ai,this.zoom,ue),(je[cr.id]=cr.createBucket({index:tt.bucketLayerIDs.length,layers:ai,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kr,sourceID:this.source,globalState:this.globalState})).populate(kt,ht,this.tileID.canonical),tt.bucketLayerIDs.push(ai.map(va=>va.id)))}}const Ke=y.bM(ht.glyphDependencies,cn=>Object.keys(cn).map(Number));this.inFlightDependencies.forEach(cn=>cn==null?void 0:cn.abort()),this.inFlightDependencies=[];let mt=Promise.resolve({});if(Object.keys(Ke).length){const cn=new AbortController;this.inFlightDependencies.push(cn),mt=Te.sendAsync({type:"GG",data:{stacks:Ke,source:this.source,tileID:this.tileID,type:"glyphs"}},cn)}const ze=Object.keys(ht.iconDependencies);let Ot=Promise.resolve({});if(ze.length){const cn=new AbortController;this.inFlightDependencies.push(cn),Ot=Te.sendAsync({type:"GI",data:{icons:ze,source:this.source,tileID:this.tileID,type:"icons"}},cn)}const on=Object.keys(ht.patternDependencies);let jt=Promise.resolve({});if(on.length){const cn=new AbortController;this.inFlightDependencies.push(cn),jt=Te.sendAsync({type:"GI",data:{icons:on,source:this.source,tileID:this.tileID,type:"patterns"}},cn)}const[Jt,Xt,An]=yield Promise.all([mt,Ot,jt]),vn=new M(Jt),Cn=new y.cF(Xt,An);for(const cn in je){const jn=je[cn];jn instanceof y.a8?(B(jn.layers,this.zoom,ue),y.cG({bucket:jn,glyphMap:Jt,glyphPositions:vn.positions,imageMap:Xt,imagePositions:Cn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ht.subdivisionGranularity})):jn.hasPattern&&(jn instanceof y.cH||jn instanceof y.cI||jn instanceof y.cJ)&&(B(jn.layers,this.zoom,ue),jn.addFeatures(ht,this.tileID.canonical,Cn.patternPositions))}return this.status="done",{buckets:Object.values(je).filter(cn=>!cn.isEmpty()),featureIndex:tt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vn.image,imageAtlas:Cn,glyphMap:this.returnDependencies?Jt:null,iconMap:this.returnDependencies?Xt:null,glyphPositions:this.returnDependencies?vn.positions:null}})}}function B(Ge,ne,ie){const ue=new y.F(ne);for(const Te of Ge)Te.recalculate(ue,ie)}class K{constructor(ne,ie,ue){this.actor=ne,this.layerIndex=ie,this.availableImages=ue,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ne,ie){return y._(this,void 0,void 0,function*(){const ue=yield y.n(ne.request,ie);try{return{vectorTile:new y.cK.VectorTile(new y.cL(ue.data)),rawData:ue.data,cacheControl:ue.cacheControl,expires:ue.expires}}catch(Te){const Oe=new Uint8Array(ue.data);let $e=`Unable to parse the tile at ${ne.request.url}, `;throw $e+=Oe[0]===31&&Oe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Te.message}`,new Error($e)}})}loadTile(ne){return y._(this,void 0,void 0,function*(){const ie=ne.uid,ue=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new y.cM(ne.request),Te=new R(ne);this.loading[ie]=Te;const Oe=new AbortController;Te.abort=Oe;try{const $e=yield this.loadVectorTile(ne,Oe);if(delete this.loading[ie],!$e)return null;const tt=$e.rawData,je={};$e.expires&&(je.expires=$e.expires),$e.cacheControl&&(je.cacheControl=$e.cacheControl);const ht={};if(ue){const Ke=ue.finish();Ke&&(ht.resourceTiming=JSON.parse(JSON.stringify(Ke)))}Te.vectorTile=$e.vectorTile;const st=Te.parse($e.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);this.loaded[ie]=Te,this.fetching[ie]={rawTileData:tt,cacheControl:je,resourceTiming:ht};try{const Ke=yield st;return y.e({rawTileData:tt.slice(0)},Ke,je,ht)}finally{delete this.fetching[ie]}}catch($e){throw delete this.loading[ie],Te.status="done",this.loaded[ie]=Te,$e}})}reloadTile(ne){return y._(this,void 0,void 0,function*(){const ie=ne.uid;if(!this.loaded||!this.loaded[ie])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ue=this.loaded[ie];if(ue.showCollisionBoxes=ne.showCollisionBoxes,ue.globalState=ne.globalState,ue.status==="parsing"){const Te=yield ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);let Oe;if(this.fetching[ie]){const{rawTileData:$e,cacheControl:tt,resourceTiming:je}=this.fetching[ie];delete this.fetching[ie],Oe=y.e({rawTileData:$e.slice(0)},Te,tt,je)}else Oe=Te;return Oe}if(ue.status==="done"&&ue.vectorTile)return ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity)})}abortTile(ne){return y._(this,void 0,void 0,function*(){const ie=this.loading,ue=ne.uid;ie&&ie[ue]&&ie[ue].abort&&(ie[ue].abort.abort(),delete ie[ue])})}removeTile(ne){return y._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ne.uid]&&delete this.loaded[ne.uid]})}}class ${constructor(){this.loaded={}}loadTile(ne){return y._(this,void 0,void 0,function*(){const{uid:ie,encoding:ue,rawImageData:Te,redFactor:Oe,greenFactor:$e,blueFactor:tt,baseShift:je}=ne,ht=Te.width+2,st=Te.height+2,Ke=y.b(Te)?new y.R({width:ht,height:st},yield y.cN(Te,-1,-1,ht,st)):Te,mt=new y.cO(ie,Ke,ue,Oe,$e,tt,je);return this.loaded=this.loaded||{},this.loaded[ie]=mt,mt})}removeTile(ne){const ie=this.loaded,ue=ne.uid;ie&&ie[ue]&&delete ie[ue]}}var W,re,Me=function(){if(re)return W;function Ge(ie,ue){if(ie.length!==0){ne(ie[0],ue);for(var Te=1;Te<ie.length;Te++)ne(ie[Te],!ue)}}function ne(ie,ue){for(var Te=0,Oe=0,$e=0,tt=ie.length,je=tt-1;$e<tt;je=$e++){var ht=(ie[$e][0]-ie[je][0])*(ie[je][1]+ie[$e][1]),st=Te+ht;Oe+=Math.abs(Te)>=Math.abs(ht)?Te-st+ht:ht-st+Te,Te=st}Te+Oe>=0!=!!ue&&ie.reverse()}return re=1,W=function ie(ue,Te){var Oe,$e=ue&&ue.type;if($e==="FeatureCollection")for(Oe=0;Oe<ue.features.length;Oe++)ie(ue.features[Oe],Te);else if($e==="GeometryCollection")for(Oe=0;Oe<ue.geometries.length;Oe++)ie(ue.geometries[Oe],Te);else if($e==="Feature")ie(ue.geometry,Te);else if($e==="Polygon")Ge(ue.coordinates,Te);else if($e==="MultiPolygon")for(Oe=0;Oe<ue.coordinates.length;Oe++)Ge(ue.coordinates[Oe],Te);return ue}}(),Ce=y.cP(Me);const Be=y.cK.VectorTileFeature.prototype.toGeoJSON;class He{constructor(ne){this._feature=ne,this.extent=y.$,this.type=ne.type,this.properties=ne.tags,"id"in ne&&!isNaN(ne.id)&&(this.id=parseInt(ne.id,10))}loadGeometry(){if(this._feature.type===1){const ne=[];for(const ie of this._feature.geometry)ne.push([new y.P(ie[0],ie[1])]);return ne}{const ne=[];for(const ie of this._feature.geometry){const ue=[];for(const Te of ie)ue.push(new y.P(Te[0],Te[1]));ne.push(ue)}return ne}}toGeoJSON(ne,ie,ue){return Be.call(this,ne,ie,ue)}}class ut{constructor(ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.$,this.length=ne.length,this._features=ne}feature(ne){return new He(this._features[ne])}}var Ue,Fe,Ze,me={exports:{}},se=function(){if(Ze)return me.exports;Ze=1;var Ge=y.cS(),ne=function(){if(Fe)return Ue;Fe=1;var st=y.cQ(),Ke=y.cR().VectorTileFeature;function mt(Ot,on){this.options=on||{},this.features=Ot,this.length=Ot.length}function ze(Ot,on){this.id=typeof Ot.id=="number"?Ot.id:void 0,this.type=Ot.type,this.rawGeometry=Ot.type===1?[Ot.geometry]:Ot.geometry,this.properties=Ot.tags,this.extent=on||4096}return Ue=mt,mt.prototype.feature=function(Ot){return new ze(this.features[Ot],this.options.extent)},ze.prototype.loadGeometry=function(){var Ot=this.rawGeometry;this.geometry=[];for(var on=0;on<Ot.length;on++){for(var jt=Ot[on],Jt=[],Xt=0;Xt<jt.length;Xt++)Jt.push(new st(jt[Xt][0],jt[Xt][1]));this.geometry.push(Jt)}return this.geometry},ze.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ot=this.geometry,on=1/0,jt=-1/0,Jt=1/0,Xt=-1/0,An=0;An<Ot.length;An++)for(var vn=Ot[An],Cn=0;Cn<vn.length;Cn++){var cn=vn[Cn];on=Math.min(on,cn.x),jt=Math.max(jt,cn.x),Jt=Math.min(Jt,cn.y),Xt=Math.max(Xt,cn.y)}return[on,Jt,jt,Xt]},ze.prototype.toGeoJSON=Ke.prototype.toGeoJSON,Ue}();function ie(st){var Ke=new Ge;return function(mt,ze){for(var Ot in mt.layers)ze.writeMessage(3,ue,mt.layers[Ot])}(st,Ke),Ke.finish()}function ue(st,Ke){var mt;Ke.writeVarintField(15,st.version||1),Ke.writeStringField(1,st.name||""),Ke.writeVarintField(5,st.extent||4096);var ze={keys:[],values:[],keycache:{},valuecache:{}};for(mt=0;mt<st.length;mt++)ze.feature=st.feature(mt),Ke.writeMessage(2,Te,ze);var Ot=ze.keys;for(mt=0;mt<Ot.length;mt++)Ke.writeStringField(3,Ot[mt]);var on=ze.values;for(mt=0;mt<on.length;mt++)Ke.writeMessage(4,ht,on[mt])}function Te(st,Ke){var mt=st.feature;mt.id!==void 0&&Ke.writeVarintField(1,mt.id),Ke.writeMessage(2,Oe,st),Ke.writeVarintField(3,mt.type),Ke.writeMessage(4,je,mt)}function Oe(st,Ke){var mt=st.feature,ze=st.keys,Ot=st.values,on=st.keycache,jt=st.valuecache;for(var Jt in mt.properties){var Xt=mt.properties[Jt],An=on[Jt];if(Xt!==null){An===void 0&&(ze.push(Jt),on[Jt]=An=ze.length-1),Ke.writeVarint(An);var vn=typeof Xt;vn!=="string"&&vn!=="boolean"&&vn!=="number"&&(Xt=JSON.stringify(Xt));var Cn=vn+":"+Xt,cn=jt[Cn];cn===void 0&&(Ot.push(Xt),jt[Cn]=cn=Ot.length-1),Ke.writeVarint(cn)}}}function $e(st,Ke){return(Ke<<3)+(7&st)}function tt(st){return st<<1^st>>31}function je(st,Ke){for(var mt=st.loadGeometry(),ze=st.type,Ot=0,on=0,jt=mt.length,Jt=0;Jt<jt;Jt++){var Xt=mt[Jt],An=1;ze===1&&(An=Xt.length),Ke.writeVarint($e(1,An));for(var vn=ze===3?Xt.length-1:Xt.length,Cn=0;Cn<vn;Cn++){Cn===1&&ze!==1&&Ke.writeVarint($e(2,vn-1));var cn=Xt[Cn].x-Ot,jn=Xt[Cn].y-on;Ke.writeVarint(tt(cn)),Ke.writeVarint(tt(jn)),Ot+=cn,on+=jn}ze===3&&Ke.writeVarint($e(7,1))}}function ht(st,Ke){var mt=typeof st;mt==="string"?Ke.writeStringField(1,st):mt==="boolean"?Ke.writeBooleanField(7,st):mt==="number"&&(st%1!=0?Ke.writeDoubleField(3,st):st<0?Ke.writeSVarintField(6,st):Ke.writeVarintField(5,st))}return me.exports=ie,me.exports.fromVectorTileJs=ie,me.exports.fromGeojsonVt=function(st,Ke){Ke=Ke||{};var mt={};for(var ze in st)mt[ze]=new ne(st[ze].features,Ke),mt[ze].name=ze,mt[ze].version=Ke.version,mt[ze].extent=Ke.extent;return ie({layers:mt})},me.exports.GeoJSONWrapper=ne,me.exports}(),ye=y.cP(se);const we={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ge=>Ge},Ee=Math.fround||(ke=new Float32Array(1),Ge=>(ke[0]=+Ge,ke[0]));var ke;class ve{constructor(ne){this.options=Object.assign(Object.create(we),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:ie,minZoom:ue,maxZoom:Te}=this.options;ie&&console.time("total time");const Oe=`prepare ${ne.length} points`;ie&&console.time(Oe),this.points=ne;const $e=[];for(let je=0;je<ne.length;je++){const ht=ne[je];if(!ht.geometry)continue;const[st,Ke]=ht.geometry.coordinates,mt=Ee(et(st)),ze=Ee(Mt(Ke));$e.push(mt,ze,1/0,je,-1,1),this.options.reduce&&$e.push(0)}let tt=this.trees[Te+1]=this._createTree($e);ie&&console.timeEnd(Oe);for(let je=Te;je>=ue;je--){const ht=+Date.now();tt=this.trees[je]=this._createTree(this._cluster(tt,je)),ie&&console.log("z%d: %d clusters in %dms",je,tt.numItems,+Date.now()-ht)}return ie&&console.timeEnd("total time"),this}getClusters(ne,ie){let ue=((ne[0]+180)%360+360)%360-180;const Te=Math.max(-90,Math.min(90,ne[1]));let Oe=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const $e=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)ue=-180,Oe=180;else if(ue>Oe){const Ke=this.getClusters([ue,Te,180,$e],ie),mt=this.getClusters([-180,Te,Oe,$e],ie);return Ke.concat(mt)}const tt=this.trees[this._limitZoom(ie)],je=tt.range(et(ue),Mt($e),et(Oe),Mt(Te)),ht=tt.data,st=[];for(const Ke of je){const mt=this.stride*Ke;st.push(ht[mt+5]>1?Bt(ht,mt,this.clusterProps):this.points[ht[mt+3]])}return st}getChildren(ne){const ie=this._getOriginId(ne),ue=this._getOriginZoom(ne),Te="No cluster with the specified id.",Oe=this.trees[ue];if(!Oe)throw new Error(Te);const $e=Oe.data;if(ie*this.stride>=$e.length)throw new Error(Te);const tt=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),je=Oe.within($e[ie*this.stride],$e[ie*this.stride+1],tt),ht=[];for(const st of je){const Ke=st*this.stride;$e[Ke+4]===ne&&ht.push($e[Ke+5]>1?Bt($e,Ke,this.clusterProps):this.points[$e[Ke+3]])}if(ht.length===0)throw new Error(Te);return ht}getLeaves(ne,ie,ue){const Te=[];return this._appendLeaves(Te,ne,ie=ie||10,ue=ue||0,0),Te}getTile(ne,ie,ue){const Te=this.trees[this._limitZoom(ne)],Oe=Math.pow(2,ne),{extent:$e,radius:tt}=this.options,je=tt/$e,ht=(ue-je)/Oe,st=(ue+1+je)/Oe,Ke={features:[]};return this._addTileFeatures(Te.range((ie-je)/Oe,ht,(ie+1+je)/Oe,st),Te.data,ie,ue,Oe,Ke),ie===0&&this._addTileFeatures(Te.range(1-je/Oe,ht,1,st),Te.data,Oe,ue,Oe,Ke),ie===Oe-1&&this._addTileFeatures(Te.range(0,ht,je/Oe,st),Te.data,-1,ue,Oe,Ke),Ke.features.length?Ke:null}getClusterExpansionZoom(ne){let ie=this._getOriginZoom(ne)-1;for(;ie<=this.options.maxZoom;){const ue=this.getChildren(ne);if(ie++,ue.length!==1)break;ne=ue[0].properties.cluster_id}return ie}_appendLeaves(ne,ie,ue,Te,Oe){const $e=this.getChildren(ie);for(const tt of $e){const je=tt.properties;if(je&&je.cluster?Oe+je.point_count<=Te?Oe+=je.point_count:Oe=this._appendLeaves(ne,je.cluster_id,ue,Te,Oe):Oe<Te?Oe++:ne.push(tt),ne.length===ue)break}return Oe}_createTree(ne){const ie=new y.aH(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ue=0;ue<ne.length;ue+=this.stride)ie.add(ne[ue],ne[ue+1]);return ie.finish(),ie.data=ne,ie}_addTileFeatures(ne,ie,ue,Te,Oe,$e){for(const tt of ne){const je=tt*this.stride,ht=ie[je+5]>1;let st,Ke,mt;if(ht)st=Kt(ie,je,this.clusterProps),Ke=ie[je],mt=ie[je+1];else{const on=this.points[ie[je+3]];st=on.properties;const[jt,Jt]=on.geometry.coordinates;Ke=et(jt),mt=Mt(Jt)}const ze={type:1,geometry:[[Math.round(this.options.extent*(Ke*Oe-ue)),Math.round(this.options.extent*(mt*Oe-Te))]],tags:st};let Ot;Ot=ht||this.options.generateId?ie[je+3]:this.points[ie[je+3]].id,Ot!==void 0&&(ze.id=Ot),$e.features.push(ze)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,ie){const{radius:ue,extent:Te,reduce:Oe,minPoints:$e}=this.options,tt=ue/(Te*Math.pow(2,ie)),je=ne.data,ht=[],st=this.stride;for(let Ke=0;Ke<je.length;Ke+=st){if(je[Ke+2]<=ie)continue;je[Ke+2]=ie;const mt=je[Ke],ze=je[Ke+1],Ot=ne.within(je[Ke],je[Ke+1],tt),on=je[Ke+5];let jt=on;for(const Jt of Ot){const Xt=Jt*st;je[Xt+2]>ie&&(jt+=je[Xt+5])}if(jt>on&&jt>=$e){let Jt,Xt=mt*on,An=ze*on,vn=-1;const Cn=(Ke/st<<5)+(ie+1)+this.points.length;for(const cn of Ot){const jn=cn*st;if(je[jn+2]<=ie)continue;je[jn+2]=ie;const Kr=je[jn+5];Xt+=je[jn]*Kr,An+=je[jn+1]*Kr,je[jn+4]=Cn,Oe&&(Jt||(Jt=this._map(je,Ke,!0),vn=this.clusterProps.length,this.clusterProps.push(Jt)),Oe(Jt,this._map(je,jn)))}je[Ke+4]=Cn,ht.push(Xt/jt,An/jt,1/0,Cn,-1,jt),Oe&&ht.push(vn)}else{for(let Jt=0;Jt<st;Jt++)ht.push(je[Ke+Jt]);if(jt>1)for(const Jt of Ot){const Xt=Jt*st;if(!(je[Xt+2]<=ie)){je[Xt+2]=ie;for(let An=0;An<st;An++)ht.push(je[Xt+An])}}}}return ht}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,ie,ue){if(ne[ie+5]>1){const $e=this.clusterProps[ne[ie+6]];return ue?Object.assign({},$e):$e}const Te=this.points[ne[ie+3]].properties,Oe=this.options.map(Te);return ue&&Oe===Te?Object.assign({},Oe):Oe}}function Bt(Ge,ne,ie){return{type:"Feature",id:Ge[ne+3],properties:Kt(Ge,ne,ie),geometry:{type:"Point",coordinates:[(ue=Ge[ne],360*(ue-.5)),Tt(Ge[ne+1])]}};var ue}function Kt(Ge,ne,ie){const ue=Ge[ne+5],Te=ue>=1e4?`${Math.round(ue/1e3)}k`:ue>=1e3?Math.round(ue/100)/10+"k":ue,Oe=Ge[ne+6],$e=Oe===-1?{}:Object.assign({},ie[Oe]);return Object.assign($e,{cluster:!0,cluster_id:Ge[ne+3],point_count:ue,point_count_abbreviated:Te})}function et(Ge){return Ge/360+.5}function Mt(Ge){const ne=Math.sin(Ge*Math.PI/180),ie=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return ie<0?0:ie>1?1:ie}function Tt(Ge){const ne=(180-360*Ge)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function Gt(Ge,ne,ie,ue){let Te=ue;const Oe=ne+(ie-ne>>1);let $e,tt=ie-ne;const je=Ge[ne],ht=Ge[ne+1],st=Ge[ie],Ke=Ge[ie+1];for(let mt=ne+3;mt<ie;mt+=3){const ze=Re(Ge[mt],Ge[mt+1],je,ht,st,Ke);if(ze>Te)$e=mt,Te=ze;else if(ze===Te){const Ot=Math.abs(mt-Oe);Ot<tt&&($e=mt,tt=Ot)}}Te>ue&&($e-ne>3&&Gt(Ge,ne,$e,ue),Ge[$e+2]=Te,ie-$e>3&&Gt(Ge,$e,ie,ue))}function Re(Ge,ne,ie,ue,Te,Oe){let $e=Te-ie,tt=Oe-ue;if($e!==0||tt!==0){const je=((Ge-ie)*$e+(ne-ue)*tt)/($e*$e+tt*tt);je>1?(ie=Te,ue=Oe):je>0&&(ie+=$e*je,ue+=tt*je)}return $e=Ge-ie,tt=ne-ue,$e*$e+tt*tt}function _t(Ge,ne,ie,ue){const Te={id:Ge??null,type:ne,geometry:ie,tags:ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")At(Te,ie);else if(ne==="Polygon")At(Te,ie[0]);else if(ne==="MultiLineString")for(const Oe of ie)At(Te,Oe);else if(ne==="MultiPolygon")for(const Oe of ie)At(Te,Oe[0]);return Te}function At(Ge,ne){for(let ie=0;ie<ne.length;ie+=3)Ge.minX=Math.min(Ge.minX,ne[ie]),Ge.minY=Math.min(Ge.minY,ne[ie+1]),Ge.maxX=Math.max(Ge.maxX,ne[ie]),Ge.maxY=Math.max(Ge.maxY,ne[ie+1])}function St(Ge,ne,ie,ue){if(!ne.geometry)return;const Te=ne.geometry.coordinates;if(Te&&Te.length===0)return;const Oe=ne.geometry.type,$e=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2);let tt=[],je=ne.id;if(ie.promoteId?je=ne.properties[ie.promoteId]:ie.generateId&&(je=ue||0),Oe==="Point")Qt(Te,tt);else if(Oe==="MultiPoint")for(const ht of Te)Qt(ht,tt);else if(Oe==="LineString")En(Te,tt,$e,!1);else if(Oe==="MultiLineString"){if(ie.lineMetrics){for(const ht of Te)tt=[],En(ht,tt,$e,!1),Ge.push(_t(je,"LineString",tt,ne.properties));return}gn(Te,tt,$e,!1)}else if(Oe==="Polygon")gn(Te,tt,$e,!0);else{if(Oe!=="MultiPolygon"){if(Oe==="GeometryCollection"){for(const ht of ne.geometry.geometries)St(Ge,{id:je,geometry:ht,properties:ne.properties},ie,ue);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ht of Te){const st=[];gn(ht,st,$e,!0),tt.push(st)}}Ge.push(_t(je,Oe,tt,ne.properties))}function Qt(Ge,ne){ne.push(ii(Ge[0]),wr(Ge[1]),0)}function En(Ge,ne,ie,ue){let Te,Oe,$e=0;for(let je=0;je<Ge.length;je++){const ht=ii(Ge[je][0]),st=wr(Ge[je][1]);ne.push(ht,st,0),je>0&&($e+=ue?(Te*st-ht*Oe)/2:Math.sqrt(Math.pow(ht-Te,2)+Math.pow(st-Oe,2))),Te=ht,Oe=st}const tt=ne.length-3;ne[2]=1,Gt(ne,0,tt,ie),ne[tt+2]=1,ne.size=Math.abs($e),ne.start=0,ne.end=ne.size}function gn(Ge,ne,ie,ue){for(let Te=0;Te<Ge.length;Te++){const Oe=[];En(Ge[Te],Oe,ie,ue),ne.push(Oe)}}function ii(Ge){return Ge/360+.5}function wr(Ge){const ne=Math.sin(Ge*Math.PI/180),ie=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return ie<0?0:ie>1?1:ie}function Cr(Ge,ne,ie,ue,Te,Oe,$e,tt){if(ue/=ne,Oe>=(ie/=ne)&&$e<ue)return Ge;if($e<ie||Oe>=ue)return null;const je=[];for(const ht of Ge){const st=ht.geometry;let Ke=ht.type;const mt=Te===0?ht.minX:ht.minY,ze=Te===0?ht.maxX:ht.maxY;if(mt>=ie&&ze<ue){je.push(ht);continue}if(ze<ie||mt>=ue)continue;let Ot=[];if(Ke==="Point"||Ke==="MultiPoint")Ds(st,Ot,ie,ue,Te);else if(Ke==="LineString")gi(st,Ot,ie,ue,Te,!1,tt.lineMetrics);else if(Ke==="MultiLineString")Tr(st,Ot,ie,ue,Te,!1);else if(Ke==="Polygon")Tr(st,Ot,ie,ue,Te,!0);else if(Ke==="MultiPolygon")for(const on of st){const jt=[];Tr(on,jt,ie,ue,Te,!0),jt.length&&Ot.push(jt)}if(Ot.length){if(tt.lineMetrics&&Ke==="LineString"){for(const on of Ot)je.push(_t(ht.id,Ke,on,ht.tags));continue}Ke!=="LineString"&&Ke!=="MultiLineString"||(Ot.length===1?(Ke="LineString",Ot=Ot[0]):Ke="MultiLineString"),Ke!=="Point"&&Ke!=="MultiPoint"||(Ke=Ot.length===3?"Point":"MultiPoint"),je.push(_t(ht.id,Ke,Ot,ht.tags))}}return je.length?je:null}function Ds(Ge,ne,ie,ue,Te){for(let Oe=0;Oe<Ge.length;Oe+=3){const $e=Ge[Oe+Te];$e>=ie&&$e<=ue&&ya(ne,Ge[Oe],Ge[Oe+1],Ge[Oe+2])}}function gi(Ge,ne,ie,ue,Te,Oe,$e){let tt=ao(Ge);const je=Te===0?_a:rl;let ht,st,Ke=Ge.start;for(let jt=0;jt<Ge.length-3;jt+=3){const Jt=Ge[jt],Xt=Ge[jt+1],An=Ge[jt+2],vn=Ge[jt+3],Cn=Ge[jt+4],cn=Te===0?Jt:Xt,jn=Te===0?vn:Cn;let Kr=!1;$e&&(ht=Math.sqrt(Math.pow(Jt-vn,2)+Math.pow(Xt-Cn,2))),cn<ie?jn>ie&&(st=je(tt,Jt,Xt,vn,Cn,ie),$e&&(tt.start=Ke+ht*st)):cn>ue?jn<ue&&(st=je(tt,Jt,Xt,vn,Cn,ue),$e&&(tt.start=Ke+ht*st)):ya(tt,Jt,Xt,An),jn<ie&&cn>=ie&&(st=je(tt,Jt,Xt,vn,Cn,ie),Kr=!0),jn>ue&&cn<=ue&&(st=je(tt,Jt,Xt,vn,Cn,ue),Kr=!0),!Oe&&Kr&&($e&&(tt.end=Ke+ht*st),ne.push(tt),tt=ao(Ge)),$e&&(Ke+=ht)}let mt=Ge.length-3;const ze=Ge[mt],Ot=Ge[mt+1],on=Te===0?ze:Ot;on>=ie&&on<=ue&&ya(tt,ze,Ot,Ge[mt+2]),mt=tt.length-3,Oe&&mt>=3&&(tt[mt]!==tt[0]||tt[mt+1]!==tt[1])&&ya(tt,tt[0],tt[1],tt[2]),tt.length&&ne.push(tt)}function ao(Ge){const ne=[];return ne.size=Ge.size,ne.start=Ge.start,ne.end=Ge.end,ne}function Tr(Ge,ne,ie,ue,Te,Oe){for(const $e of Ge)gi($e,ne,ie,ue,Te,Oe,!1)}function ya(Ge,ne,ie,ue){Ge.push(ne,ie,ue)}function _a(Ge,ne,ie,ue,Te,Oe){const $e=(Oe-ne)/(ue-ne);return ya(Ge,Oe,ie+(Te-ie)*$e,1),$e}function rl(Ge,ne,ie,ue,Te,Oe){const $e=(Oe-ie)/(Te-ie);return ya(Ge,ne+(ue-ne)*$e,Oe,1),$e}function Ir(Ge,ne){const ie=[];for(let ue=0;ue<Ge.length;ue++){const Te=Ge[ue],Oe=Te.type;let $e;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")$e=Oa(Te.geometry,ne);else if(Oe==="MultiLineString"||Oe==="Polygon"){$e=[];for(const tt of Te.geometry)$e.push(Oa(tt,ne))}else if(Oe==="MultiPolygon"){$e=[];for(const tt of Te.geometry){const je=[];for(const ht of tt)je.push(Oa(ht,ne));$e.push(je)}}ie.push(_t(Te.id,Oe,$e,Te.tags))}return ie}function Oa(Ge,ne){const ie=[];ie.size=Ge.size,Ge.start!==void 0&&(ie.start=Ge.start,ie.end=Ge.end);for(let ue=0;ue<Ge.length;ue+=3)ie.push(Ge[ue]+ne,Ge[ue+1],Ge[ue+2]);return ie}function na(Ge,ne){if(Ge.transformed)return Ge;const ie=1<<Ge.z,ue=Ge.x,Te=Ge.y;for(const Oe of Ge.features){const $e=Oe.geometry,tt=Oe.type;if(Oe.geometry=[],tt===1)for(let je=0;je<$e.length;je+=2)Oe.geometry.push(Ls($e[je],$e[je+1],ne,ie,ue,Te));else for(let je=0;je<$e.length;je++){const ht=[];for(let st=0;st<$e[je].length;st+=2)ht.push(Ls($e[je][st],$e[je][st+1],ne,ie,ue,Te));Oe.geometry.push(ht)}}return Ge.transformed=!0,Ge}function Ls(Ge,ne,ie,ue,Te,Oe){return[Math.round(ie*(Ge*ue-Te)),Math.round(ie*(ne*ue-Oe))]}function Xa(Ge,ne,ie,ue,Te){const Oe=ne===Te.maxZoom?0:Te.tolerance/((1<<ne)*Te.extent),$e={features:[],numPoints:0,numSimplified:0,numFeatures:Ge.length,source:null,x:ie,y:ue,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const tt of Ge)bu($e,tt,Oe,Te);return $e}function bu(Ge,ne,ie,ue){const Te=ne.geometry,Oe=ne.type,$e=[];if(Ge.minX=Math.min(Ge.minX,ne.minX),Ge.minY=Math.min(Ge.minY,ne.minY),Ge.maxX=Math.max(Ge.maxX,ne.maxX),Ge.maxY=Math.max(Ge.maxY,ne.maxY),Oe==="Point"||Oe==="MultiPoint")for(let tt=0;tt<Te.length;tt+=3)$e.push(Te[tt],Te[tt+1]),Ge.numPoints++,Ge.numSimplified++;else if(Oe==="LineString")zs($e,Te,Ge,ie,!1,!1);else if(Oe==="MultiLineString"||Oe==="Polygon")for(let tt=0;tt<Te.length;tt++)zs($e,Te[tt],Ge,ie,Oe==="Polygon",tt===0);else if(Oe==="MultiPolygon")for(let tt=0;tt<Te.length;tt++){const je=Te[tt];for(let ht=0;ht<je.length;ht++)zs($e,je[ht],Ge,ie,!0,ht===0)}if($e.length){let tt=ne.tags||null;if(Oe==="LineString"&&ue.lineMetrics){tt={};for(const ht in ne.tags)tt[ht]=ne.tags[ht];tt.mapbox_clip_start=Te.start/Te.size,tt.mapbox_clip_end=Te.end/Te.size}const je={geometry:$e,type:Oe==="Polygon"||Oe==="MultiPolygon"?3:Oe==="LineString"||Oe==="MultiLineString"?2:1,tags:tt};ne.id!==null&&(je.id=ne.id),Ge.features.push(je)}}function zs(Ge,ne,ie,ue,Te,Oe){const $e=ue*ue;if(ue>0&&ne.size<(Te?$e:ue))return void(ie.numPoints+=ne.length/3);const tt=[];for(let je=0;je<ne.length;je+=3)(ue===0||ne[je+2]>$e)&&(ie.numSimplified++,tt.push(ne[je],ne[je+1])),ie.numPoints++;Te&&function(je,ht){let st=0;for(let Ke=0,mt=je.length,ze=mt-2;Ke<mt;ze=Ke,Ke+=2)st+=(je[Ke]-je[ze])*(je[Ke+1]+je[ze+1]);if(st>0===ht)for(let Ke=0,mt=je.length;Ke<mt/2;Ke+=2){const ze=je[Ke],Ot=je[Ke+1];je[Ke]=je[mt-2-Ke],je[Ke+1]=je[mt-1-Ke],je[mt-2-Ke]=ze,je[mt-1-Ke]=Ot}}(tt,Oe),Ge.push(tt)}const ls={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ko{constructor(ne,ie){const ue=(ie=this.options=function(Oe,$e){for(const tt in $e)Oe[tt]=$e[tt];return Oe}(Object.create(ls),ie)).debug;if(ue&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");let Te=function(Oe,$e){const tt=[];if(Oe.type==="FeatureCollection")for(let je=0;je<Oe.features.length;je++)St(tt,Oe.features[je],$e,je);else St(tt,Oe.type==="Feature"?Oe:{geometry:Oe},$e);return tt}(ne,ie);this.tiles={},this.tileCoords=[],ue&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Te=function(Oe,$e){const tt=$e.buffer/$e.extent;let je=Oe;const ht=Cr(Oe,1,-1-tt,tt,0,-1,2,$e),st=Cr(Oe,1,1-tt,2+tt,0,-1,2,$e);return(ht||st)&&(je=Cr(Oe,1,-tt,1+tt,0,-1,2,$e)||[],ht&&(je=Ir(ht,1).concat(je)),st&&(je=je.concat(Ir(st,-1)))),je}(Te,ie),Te.length&&this.splitTile(Te,0,0,0),ue&&(Te.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ne,ie,ue,Te,Oe,$e,tt){const je=[ne,ie,ue,Te],ht=this.options,st=ht.debug;for(;je.length;){Te=je.pop(),ue=je.pop(),ie=je.pop(),ne=je.pop();const Ke=1<<ie,mt=fr(ie,ue,Te);let ze=this.tiles[mt];if(!ze&&(st>1&&console.time("creation"),ze=this.tiles[mt]=Xa(ne,ie,ue,Te,ht),this.tileCoords.push({z:ie,x:ue,y:Te}),st)){st>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,ue,Te,ze.numFeatures,ze.numPoints,ze.numSimplified),console.timeEnd("creation"));const Kr=`z${ie}`;this.stats[Kr]=(this.stats[Kr]||0)+1,this.total++}if(ze.source=ne,Oe==null){if(ie===ht.indexMaxZoom||ze.numPoints<=ht.indexMaxPoints)continue}else{if(ie===ht.maxZoom||ie===Oe)continue;if(Oe!=null){const Kr=Oe-ie;if(ue!==$e>>Kr||Te!==tt>>Kr)continue}}if(ze.source=null,ne.length===0)continue;st>1&&console.time("clipping");const Ot=.5*ht.buffer/ht.extent,on=.5-Ot,jt=.5+Ot,Jt=1+Ot;let Xt=null,An=null,vn=null,Cn=null,cn=Cr(ne,Ke,ue-Ot,ue+jt,0,ze.minX,ze.maxX,ht),jn=Cr(ne,Ke,ue+on,ue+Jt,0,ze.minX,ze.maxX,ht);ne=null,cn&&(Xt=Cr(cn,Ke,Te-Ot,Te+jt,1,ze.minY,ze.maxY,ht),An=Cr(cn,Ke,Te+on,Te+Jt,1,ze.minY,ze.maxY,ht),cn=null),jn&&(vn=Cr(jn,Ke,Te-Ot,Te+jt,1,ze.minY,ze.maxY,ht),Cn=Cr(jn,Ke,Te+on,Te+Jt,1,ze.minY,ze.maxY,ht),jn=null),st>1&&console.timeEnd("clipping"),je.push(Xt||[],ie+1,2*ue,2*Te),je.push(An||[],ie+1,2*ue,2*Te+1),je.push(vn||[],ie+1,2*ue+1,2*Te),je.push(Cn||[],ie+1,2*ue+1,2*Te+1)}}getTile(ne,ie,ue){ne=+ne,ie=+ie,ue=+ue;const Te=this.options,{extent:Oe,debug:$e}=Te;if(ne<0||ne>24)return null;const tt=1<<ne,je=fr(ne,ie=ie+tt&tt-1,ue);if(this.tiles[je])return na(this.tiles[je],Oe);$e>1&&console.log("drilling down to z%d-%d-%d",ne,ie,ue);let ht,st=ne,Ke=ie,mt=ue;for(;!ht&&st>0;)st--,Ke>>=1,mt>>=1,ht=this.tiles[fr(st,Ke,mt)];return ht&&ht.source?($e>1&&(console.log("found parent tile z%d-%d-%d",st,Ke,mt),console.time("drilling down")),this.splitTile(ht.source,st,Ke,mt,ne,ie,ue),$e>1&&console.timeEnd("drilling down"),this.tiles[je]?na(this.tiles[je],Oe):null):null}}function fr(Ge,ne,ie){return 32*((1<<Ge)*ie+ne)+Ge}function Bn(Ge,ne){return ne?Ge.properties[ne]:Ge.id}function di(Ge,ne){if(Ge==null)return!0;if(Ge.type==="Feature")return Bn(Ge,ne)!=null;if(Ge.type==="FeatureCollection"){const ie=new Set;for(const ue of Ge.features){const Te=Bn(ue,ne);if(Te==null||ie.has(Te))return!1;ie.add(Te)}return!0}return!1}function Ri(Ge,ne){const ie=new Map;if(Ge!=null)if(Ge.type==="Feature")ie.set(Bn(Ge,ne),Ge);else for(const ue of Ge.features)ie.set(Bn(ue,ne),ue);return ie}class xu extends K{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ne,ie){return y._(this,void 0,void 0,function*(){const ue=ne.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Te=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!Te)return null;const Oe=new ut(Te.features);let $e=ye(Oe);return $e.byteOffset===0&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),{vectorTile:Oe,rawData:$e.buffer}})}loadData(ne){return y._(this,void 0,void 0,function*(){var ie;(ie=this._pendingRequest)===null||ie===void 0||ie.abort();const ue=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new y.cM(ne.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ne,this._pendingRequest),this._geoJSONIndex=ne.cluster?new ve(function({superclusterOptions:$e,clusterProperties:tt}){if(!tt||!$e)return $e;const je={},ht={},st={accumulated:null,zoom:0},Ke={properties:null},mt=Object.keys(tt);for(const ze of mt){const[Ot,on]=tt[ze],jt=y.cT(on),Jt=y.cT(typeof Ot=="string"?[Ot,["accumulated"],["get",ze]]:Ot);je[ze]=jt.value,ht[ze]=Jt.value}return $e.map=ze=>{Ke.properties=ze;const Ot={};for(const on of mt)Ot[on]=je[on].evaluate(st,Ke);return Ot},$e.reduce=(ze,Ot)=>{Ke.properties=Ot;for(const on of mt)st.accumulated=ze[on],ze[on]=ht[on].evaluate(st,Ke)},$e}(ne)).load((yield this._pendingData).features):(Te=yield this._pendingData,new ko(Te,ne.geojsonVtOptions)),this.loaded={};const Oe={};if(ue){const $e=ue.finish();$e&&(Oe.resourceTiming={},Oe.resourceTiming[ne.source]=JSON.parse(JSON.stringify($e)))}return Oe}catch(Oe){if(delete this._pendingRequest,y.cx(Oe))return{abandoned:!0};throw Oe}var Te})}getData(){return y._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ne){const ie=this.loaded;return ie&&ie[ne.uid]?super.reloadTile(ne):this.loadTile(ne)}loadAndProcessGeoJSON(ne,ie){return y._(this,void 0,void 0,function*(){let ue=yield this.loadGeoJSON(ne,ie);if(delete this._pendingRequest,typeof ue!="object")throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`);if(Ce(ue,!0),ne.filter){const Te=y.cT(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Te.result==="error")throw new Error(Te.value.map($e=>`${$e.key}: ${$e.message}`).join(", "));ue={type:"FeatureCollection",features:ue.features.filter($e=>Te.value.evaluate({zoom:0},$e))}}return ue})}loadGeoJSON(ne,ie){return y._(this,void 0,void 0,function*(){const{promoteId:ue}=ne;if(ne.request){const Te=yield y.j(ne.request,ie);return this._dataUpdateable=di(Te.data,ue)?Ri(Te.data,ue):void 0,Te.data}if(typeof ne.data=="string")try{const Te=JSON.parse(ne.data);return this._dataUpdateable=di(Te,ue)?Ri(Te,ue):void 0,Te}catch{throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`)}if(!ne.dataDiff)throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ne.source}`);return function(Te,Oe,$e){var tt,je,ht,st;if(Oe.removeAll&&Te.clear(),Oe.remove)for(const Ke of Oe.remove)Te.delete(Ke);if(Oe.add)for(const Ke of Oe.add){const mt=Bn(Ke,$e);mt!=null&&Te.set(mt,Ke)}if(Oe.update)for(const Ke of Oe.update){let mt=Te.get(Ke.id);if(mt==null)continue;const ze=!Ke.removeAllProperties&&(((tt=Ke.removeProperties)===null||tt===void 0?void 0:tt.length)>0||((je=Ke.addOrUpdateProperties)===null||je===void 0?void 0:je.length)>0);if((Ke.newGeometry||Ke.removeAllProperties||ze)&&(mt=Object.assign({},mt),Te.set(Ke.id,mt),ze&&(mt.properties=Object.assign({},mt.properties))),Ke.newGeometry&&(mt.geometry=Ke.newGeometry),Ke.removeAllProperties)mt.properties={};else if(((ht=Ke.removeProperties)===null||ht===void 0?void 0:ht.length)>0)for(const Ot of Ke.removeProperties)Object.prototype.hasOwnProperty.call(mt.properties,Ot)&&delete mt.properties[Ot];if(((st=Ke.addOrUpdateProperties)===null||st===void 0?void 0:st.length)>0)for(const{key:Ot,value:on}of Ke.addOrUpdateProperties)mt.properties[Ot]=on}}(this._dataUpdateable,ne.dataDiff,ue),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ne){return y._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ne){return this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId)}getClusterChildren(ne){return this._geoJSONIndex.getChildren(ne.clusterId)}getClusterLeaves(ne){return this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset)}}class so{constructor(ne){this.self=ne,this.actor=new y.J(ne),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ie,ue)=>{if(this.externalWorkerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.externalWorkerSourceTypes[ie]=ue},this.self.addProtocol=y.cz,this.self.removeProtocol=y.cA,this.self.registerRTLTextPlugin=ie=>{y.cU.setMethods(ie)},this.actor.registerMessageHandler("LDT",(ie,ue)=>this._getDEMWorkerSource(ie,ue.source).loadTile(ue)),this.actor.registerMessageHandler("RDT",(ie,ue)=>y._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ie,ue.source).removeTile(ue)})),this.actor.registerMessageHandler("GCEZ",(ie,ue)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(ie,ue.type,ue.source).getClusterExpansionZoom(ue)})),this.actor.registerMessageHandler("GCC",(ie,ue)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(ie,ue.type,ue.source).getClusterChildren(ue)})),this.actor.registerMessageHandler("GCL",(ie,ue)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(ie,ue.type,ue.source).getClusterLeaves(ue)})),this.actor.registerMessageHandler("LD",(ie,ue)=>this._getWorkerSource(ie,ue.type,ue.source).loadData(ue)),this.actor.registerMessageHandler("GD",(ie,ue)=>this._getWorkerSource(ie,ue.type,ue.source).getData()),this.actor.registerMessageHandler("LT",(ie,ue)=>this._getWorkerSource(ie,ue.type,ue.source).loadTile(ue)),this.actor.registerMessageHandler("RT",(ie,ue)=>this._getWorkerSource(ie,ue.type,ue.source).reloadTile(ue)),this.actor.registerMessageHandler("AT",(ie,ue)=>this._getWorkerSource(ie,ue.type,ue.source).abortTile(ue)),this.actor.registerMessageHandler("RMT",(ie,ue)=>this._getWorkerSource(ie,ue.type,ue.source).removeTile(ue)),this.actor.registerMessageHandler("RS",(ie,ue)=>y._(this,void 0,void 0,function*(){if(!this.workerSources[ie]||!this.workerSources[ie][ue.type]||!this.workerSources[ie][ue.type][ue.source])return;const Te=this.workerSources[ie][ue.type][ue.source];delete this.workerSources[ie][ue.type][ue.source],Te.removeSource!==void 0&&Te.removeSource(ue)})),this.actor.registerMessageHandler("RM",ie=>y._(this,void 0,void 0,function*(){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.workerSources[ie],delete this.demWorkerSources[ie]})),this.actor.registerMessageHandler("SR",(ie,ue)=>y._(this,void 0,void 0,function*(){this.referrer=ue})),this.actor.registerMessageHandler("SRPS",(ie,ue)=>this._syncRTLPluginState(ie,ue)),this.actor.registerMessageHandler("IS",(ie,ue)=>y._(this,void 0,void 0,function*(){this.self.importScripts(ue)})),this.actor.registerMessageHandler("SI",(ie,ue)=>this._setImages(ie,ue)),this.actor.registerMessageHandler("UL",(ie,ue)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(ie).update(ue.layers,ue.removedIds)})),this.actor.registerMessageHandler("SL",(ie,ue)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(ie).replace(ue)}))}_setImages(ne,ie){return y._(this,void 0,void 0,function*(){this.availableImages[ne]=ie;for(const ue in this.workerSources[ne]){const Te=this.workerSources[ne][ue];for(const Oe in Te)Te[Oe].availableImages=ie}})}_syncRTLPluginState(ne,ie){return y._(this,void 0,void 0,function*(){return yield y.cU.syncState(ie,this.self.importScripts)})}_getAvailableImages(ne){let ie=this.availableImages[ne];return ie||(ie=[]),ie}_getLayerIndex(ne){let ie=this.layerIndexes[ne];return ie||(ie=this.layerIndexes[ne]=new c),ie}_getWorkerSource(ne,ie,ue){if(this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][ie]||(this.workerSources[ne][ie]={}),!this.workerSources[ne][ie][ue]){const Te={sendAsync:(Oe,$e)=>(Oe.targetMapId=ne,this.actor.sendAsync(Oe,$e))};switch(ie){case"vector":this.workerSources[ne][ie][ue]=new K(Te,this._getLayerIndex(ne),this._getAvailableImages(ne));break;case"geojson":this.workerSources[ne][ie][ue]=new xu(Te,this._getLayerIndex(ne),this._getAvailableImages(ne));break;default:this.workerSources[ne][ie][ue]=new this.externalWorkerSourceTypes[ie](Te,this._getLayerIndex(ne),this._getAvailableImages(ne))}}return this.workerSources[ne][ie][ue]}_getDEMWorkerSource(ne,ie){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][ie]||(this.demWorkerSources[ne][ie]=new $),this.demWorkerSources[ne][ie]}}return y.i(self)&&(self.worker=new so(self)),so}),d("index",["exports","./shared"],function(y,c){var M="5.6.0";function R(){var b=new c.A(4);return c.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let B,K;const $={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,n,l){const p=requestAnimationFrame(w=>{_(),n(w)}),{unsubscribe:_}=c.s(b.signal,"abort",()=>{_(),cancelAnimationFrame(p),l(c.c())},!1)},frameAsync(b){return new Promise((n,l)=>{this.frame(b,n,l)})},getImageData(b,n=0){return this.getImageCanvasContext(b).getImageData(-n,-n,b.width+2*n,b.height+2*n)},getImageCanvasContext(b){const n=window.document.createElement("canvas"),l=n.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return n.width=b.width,n.height=b.height,l.drawImage(b,0,0,b.width,b.height),l},resolveURL:b=>(B||(B=document.createElement("a")),B.href=b,B.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(K==null&&(K=matchMedia("(prefers-reduced-motion: reduce)")),K.matches)}};class W{static testProp(n){if(!W.docStyle)return n[0];for(let l=0;l<n.length;l++)if(n[l]in W.docStyle)return n[l];return n[0]}static create(n,l,p){const _=window.document.createElement(n);return l!==void 0&&(_.className=l),p&&p.appendChild(_),_}static createNS(n,l){return window.document.createElementNS(n,l)}static disableDrag(){W.docStyle&&W.selectProp&&(W.userSelect=W.docStyle[W.selectProp],W.docStyle[W.selectProp]="none")}static enableDrag(){W.docStyle&&W.selectProp&&(W.docStyle[W.selectProp]=W.userSelect)}static setTransform(n,l){n.style[W.transformProp]=l}static addEventListener(n,l,p,_={}){n.addEventListener(l,p,"passive"in _?_:_.capture)}static removeEventListener(n,l,p,_={}){n.removeEventListener(l,p,"passive"in _?_:_.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",W.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",W.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",W.suppressClickInternal,!0)},0)}static getScale(n){const l=n.getBoundingClientRect();return{x:l.width/n.offsetWidth||1,y:l.height/n.offsetHeight||1,boundingClientRect:l}}static getPoint(n,l,p){const _=l.boundingClientRect;return new c.P((p.clientX-_.left)/l.x-n.clientLeft,(p.clientY-_.top)/l.y-n.clientTop)}static mousePos(n,l){const p=W.getScale(n);return W.getPoint(n,p,l)}static touchPos(n,l){const p=[],_=W.getScale(n);for(let w=0;w<l.length;w++)p.push(W.getPoint(n,_,l[w]));return p}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}static sanitize(n){const l=new DOMParser().parseFromString(n,"text/html").body||document.createElement("body"),p=l.querySelectorAll("script");for(const _ of p)_.remove();return W.clean(l),l.innerHTML}static isPossiblyDangerous(n,l){const p=l.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(n)||!p.includes("javascript:")&&!p.includes("data:"))||!!n.startsWith("on")||void 0}static clean(n){const l=n.children;for(const p of l)W.removeAttributes(p),W.clean(p)}static removeAttributes(n){for(const{name:l,value:p}of n.attributes)W.isPossiblyDangerous(l,p)&&n.removeAttribute(l)}}W.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,W.selectProp=W.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),W.transformProp=W.testProp(["transform","WebkitTransform"]);const re={supported:!1,testSupport:function(b){!Be&&Ce&&(He?ut(b):Me=b)}};let Me,Ce,Be=!1,He=!1;function ut(b){const n=b.createTexture();b.bindTexture(b.TEXTURE_2D,n);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,Ce),b.isContextLost())return;re.supported=!0}catch{}b.deleteTexture(n),Be=!0}var Ue;typeof document<"u"&&(Ce=document.createElement("img"),Ce.onload=()=>{Me&&ut(Me),Me=null,He=!0},Ce.onerror=()=>{Be=!0,Me=null},Ce.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let n,l,p,_;b.resetRequestQueue=()=>{n=[],l=0,p=0,_={}},b.addThrottleControl=D=>{const O=p++;return _[O]=D,O},b.removeThrottleControl=D=>{delete _[D],E()},b.getImage=(D,O,F=!0)=>new Promise((q,U)=>{re.supported&&(D.headers||(D.headers={}),D.headers.accept="image/webp,*/*"),c.e(D,{type:"image"}),n.push({abortController:O,requestParameters:D,supportImageRefresh:F,state:"queued",onError:H=>{U(H)},onSuccess:H=>{q(H)}}),E()});const w=D=>c._(this,void 0,void 0,function*(){D.state="running";const{requestParameters:O,supportImageRefresh:F,onError:q,onSuccess:U,abortController:H}=D,ee=F===!1&&!c.i(self)&&!c.g(O.url)&&(!O.headers||Object.keys(O.headers).reduce((pe,_e)=>pe&&_e==="accept",!0));l++;const fe=ee?P(O,H):c.m(O,H);try{const pe=yield fe;delete D.abortController,D.state="completed",pe.data instanceof HTMLImageElement||c.b(pe.data)?U(pe):pe.data&&U({data:yield(he=pe.data,typeof createImageBitmap=="function"?c.f(he):c.h(he)),cacheControl:pe.cacheControl,expires:pe.expires})}catch(pe){delete D.abortController,q(pe)}finally{l--,E()}var he}),E=()=>{const D=(()=>{for(const O of Object.keys(_))if(_[O]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let O=l;O<D&&n.length>0;O++){const F=n.shift();F.abortController.signal.aborted?O--:w(F)}},P=(D,O)=>new Promise((F,q)=>{const U=new Image,H=D.url,ee=D.credentials;ee&&ee==="include"?U.crossOrigin="use-credentials":(ee&&ee==="same-origin"||!c.d(H))&&(U.crossOrigin="anonymous"),O.signal.addEventListener("abort",()=>{U.src="",q(c.c())}),U.fetchPriority="high",U.onload=()=>{U.onerror=U.onload=null,F({data:U})},U.onerror=()=>{U.onerror=U.onload=null,O.signal.aborted||q(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},U.src=H})}(Ue||(Ue={})),Ue.resetRequestQueue();class Fe{constructor(n){this._transformRequestFn=n}transformRequest(n,l){return this._transformRequestFn&&this._transformRequestFn(n,l)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function Ze(b){const n=[];if(typeof b=="string")n.push({id:"default",url:b});else if(b&&b.length>0){const l=[];for(const{id:p,url:_}of b){const w=`${p}${_}`;l.indexOf(w)===-1&&(l.push(w),n.push({id:p,url:_}))}}return n}function me(b,n,l){try{const p=new URL(b);return p.pathname+=`${n}${l}`,p.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function se(b){const{userImage:n}=b;return!!(n&&n.render&&n.render())&&(b.data.replace(new Uint8Array(n.data.buffer)),!0)}class ye extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:l,promiseResolve:p}of this.requestors)p(this._getImagesForIds(l));this.requestors=[]}}getImage(n){const l=this.images[n];if(l&&!l.data&&l.spriteData){const p=l.spriteData;l.data=new c.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),l.spriteData=null}return l}addImage(n,l){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,l)&&(this.images[n]=l)}_validate(n,l){let p=!0;const _=l.data||l.spriteData;return this._validateStretch(l.stretchX,_&&_.width)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,_&&_.height)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "content" value`))),p=!1),p}_validateStretch(n,l){if(!n)return!0;let p=0;for(const _ of n){if(_[0]<p||_[1]<_[0]||l<_[1])return!1;p=_[1]}return!0}_validateContent(n,l){if(!n)return!0;if(n.length!==4)return!1;const p=l.spriteData,_=p&&p.width||l.data.width,w=p&&p.height||l.data.height;return!(n[0]<0||_<n[0]||n[1]<0||w<n[1]||n[2]<0||_<n[2]||n[3]<0||w<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,l,p=!0){const _=this.getImage(n);if(p&&(_.data.width!==l.data.width||_.data.height!==l.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${l.data.width}x${l.data.height}).`);l.version=_.version+1,this.images[n]=l,this.updatedImages[n]=!0}removeImage(n){const l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((l,p)=>{let _=!0;if(!this.isLoaded())for(const w of n)this.images[w]||(_=!1);this.isLoaded()||_?l(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:l})})}_getImagesForIds(n){const l={};for(const p of n){let _=this.getImage(p);_||(this.fire(new c.l("styleimagemissing",{id:p})),_=this.getImage(p)),_?l[p]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,textFitWidth:_.textFitWidth,textFitHeight:_.textFitHeight,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:c.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return l}getPixelSize(){const{width:n,height:l}=this.atlasImage;return{width:n,height:l}}getPattern(n){const l=this.patterns[n],p=this.getImage(n);if(!p)return null;if(l&&l.position.version===p.version)return l.position;if(l)l.position.version=p.version;else{const _={w:p.data.width+2,h:p.data.height+2,x:0,y:0},w=new c.I(_,p);this.patterns[n]={bin:_,position:w}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const w in this.patterns)n.push(this.patterns[w].bin);const{w:l,h:p}=c.p(n),_=this.atlasImage;_.resize({width:l||1,height:p||1});for(const w in this.patterns){const{bin:E}=this.patterns[w],P=E.x+1,D=E.y+1,O=this.getImage(w).data,F=O.width,q=O.height;c.R.copy(O,_,{x:0,y:0},{x:P,y:D},{width:F,height:q}),c.R.copy(O,_,{x:0,y:q-1},{x:P,y:D-1},{width:F,height:1}),c.R.copy(O,_,{x:0,y:0},{x:P,y:D+q},{width:F,height:1}),c.R.copy(O,_,{x:F-1,y:0},{x:P-1,y:D},{width:1,height:q}),c.R.copy(O,_,{x:0,y:0},{x:P+F,y:D},{width:1,height:q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const l of n){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const p=this.getImage(l);p||c.w(`Image with ID: "${l}" was not found`),se(p)&&this.updateImage(l,p)}}}const we=1e20;function Ee(b,n,l,p,_,w,E,P,D){for(let O=n;O<n+p;O++)ke(b,l*w+O,w,_,E,P,D);for(let O=l;O<l+_;O++)ke(b,O*w+n,1,p,E,P,D)}function ke(b,n,l,p,_,w,E){w[0]=0,E[0]=-1e20,E[1]=we,_[0]=b[n];for(let P=1,D=0,O=0;P<p;P++){_[P]=b[n+P*l];const F=P*P;do{const q=w[D];O=(_[P]-_[q]+F-q*q)/(P-q)/2}while(O<=E[D]&&--D>-1);D++,w[D]=P,E[D]=O,E[D+1]=we}for(let P=0,D=0;P<p;P++){for(;E[D+1]<P;)D++;const O=w[D],F=P-O;b[n+P*l]=_[O]+F*F}}class ve{constructor(n,l){this.requestManager=n,this.localIdeographFontFamily=l,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return c._(this,void 0,void 0,function*(){const l=[];for(const w in n)for(const E of n[w])l.push(this._getAndCacheGlyphsPromise(w,E));const p=yield Promise.all(l),_={};for(const{stack:w,id:E,glyph:P}of p)_[w]||(_[w]={}),_[w][E]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};return _})}_getAndCacheGlyphsPromise(n,l){return c._(this,void 0,void 0,function*(){let p=this.entries[n];p||(p=this.entries[n]={glyphs:{},requests:{},ranges:{}});let _=p.glyphs[l];if(_!==void 0)return{stack:n,id:l,glyph:_};if(_=this._tinySDF(p,n,l),_)return p.glyphs[l]=_,{stack:n,id:l,glyph:_};const w=Math.floor(l/256);if(256*w>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[w])return{stack:n,id:l,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[w]){const P=ve.loadGlyphRange(n,w,this.url,this.requestManager);p.requests[w]=P}const E=yield p.requests[w];for(const P in E)this._doesCharSupportLocalGlyph(+P)||(p.glyphs[+P]=E[+P]);return p.ranges[w]=!0,{stack:n,id:l,glyph:E[l]||null}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))||c.u["CJK Unified Ideographs"](n)||c.u["Hangul Syllables"](n)||c.u.Hiragana(n)||c.u.Katakana(n)||c.u["CJK Symbols and Punctuation"](n)||c.u["Halfwidth and Fullwidth Forms"](n))}_tinySDF(n,l,p){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(p))return;let w=n.tinySDF;if(!w){let P="400";/bold/i.test(l)?P="900":/medium/i.test(l)?P="500":/light/i.test(l)&&(P="200"),w=n.tinySDF=new ve.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:_,fontWeight:P})}const E=w.draw(String.fromCharCode(p));return{id:p,bitmap:new c.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}ve.loadGlyphRange=function(b,n,l,p){return c._(this,void 0,void 0,function*(){const _=256*n,w=_+255,E=p.transformRequest(l.replace("{fontstack}",b).replace("{range}",`${_}-${w}`),"Glyphs"),P=yield c.n(E,new AbortController);if(!P||!P.data)throw new Error(`Could not load glyph range. range: ${n}, ${_}-${w}`);const D={};for(const O of c.o(P.data))D[O.id]=O;return D})},ve.TinySDF=class{constructor({fontSize:b=24,buffer:n=3,radius:l=8,cutoff:p=.25,fontFamily:_="sans-serif",fontWeight:w="normal",fontStyle:E="normal"}={}){this.buffer=n,this.cutoff=p,this.radius=l;const P=this.size=b+4*n,D=this._createCanvas(P),O=this.ctx=D.getContext("2d",{willReadFrequently:!0});O.font=`${E} ${w} ${b}px ${_}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(b){const n=document.createElement("canvas");return n.width=n.height=b,n}draw(b){const{width:n,actualBoundingBoxAscent:l,actualBoundingBoxDescent:p,actualBoundingBoxLeft:_,actualBoundingBoxRight:w}=this.ctx.measureText(b),E=Math.ceil(l),P=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-_))),D=Math.min(this.size-this.buffer,E+Math.ceil(p)),O=P+2*this.buffer,F=D+2*this.buffer,q=Math.max(O*F,0),U=new Uint8ClampedArray(q),H={data:U,width:O,height:F,glyphWidth:P,glyphHeight:D,glyphTop:E,glyphLeft:0,glyphAdvance:n};if(P===0||D===0)return H;const{ctx:ee,buffer:fe,gridInner:he,gridOuter:pe}=this;ee.clearRect(fe,fe,P,D),ee.fillText(b,fe,fe+E);const _e=ee.getImageData(fe,fe,P,D);pe.fill(we,0,q),he.fill(0,0,q);for(let Ae=0;Ae<D;Ae++)for(let be=0;be<P;be++){const Pe=_e.data[4*(Ae*P+be)+3]/255;if(Pe===0)continue;const Le=(Ae+fe)*O+be+fe;if(Pe===1)pe[Le]=0,he[Le]=we;else{const xe=.5-Pe;pe[Le]=xe>0?xe*xe:0,he[Le]=xe<0?xe*xe:0}}Ee(pe,0,0,O,F,O,this.f,this.v,this.z),Ee(he,fe,fe,P,D,O,this.f,this.v,this.z);for(let Ae=0;Ae<q;Ae++){const be=Math.sqrt(pe[Ae])-Math.sqrt(he[Ae]);U[Ae]=Math.round(255-255*(be/this.radius+this.cutoff))}return H}};class Bt{constructor(){this.specification=c.v.light.position}possiblyEvaluate(n,l){return c.B(n.expression.evaluate(l))}interpolate(n,l,p){return{x:c.C.number(n.x,l.x,p),y:c.C.number(n.y,l.y,p),z:c.C.number(n.z,l.z,p)}}}let Kt;class et extends c.E{constructor(n){super(),Kt=Kt||new c.r({anchor:new c.D(c.v.light.anchor),position:new Bt,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(Kt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,l={}){if(!this._validate(c.x,n,l))for(const p in n){const _=n[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,p){return(!p||p.validate!==!1)&&c.y(this,n.call(c.z,{value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const Mt=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Tt extends c.E{constructor(n){super(),this._transitionable=new c.t(Mt),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(n,l={}){if(!this._validate(c.G,n,l)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const p in n){const _=n[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,p={}){return(p==null?void 0:p.validate)!==!1&&c.y(this,n.call(c.z,c.e({value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class Gt{constructor(n,l){this.width=n,this.height=l,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,l){const p=n.join(",")+String(l);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(n,l)),this.dashEntry[p]}getDashRanges(n,l,p){const _=[];let w=n.length%2==1?-n[n.length-1]*p:0,E=n[0]*p,P=!0;_.push({left:w,right:E,isDash:P,zeroLength:n[0]===0});let D=n[0];for(let O=1;O<n.length;O++){P=!P;const F=n[O];w=D*p,D+=F,E=D*p,_.push({left:w,right:E,isDash:P,zeroLength:F===0})}return _}addRoundDash(n,l,p){const _=l/2;for(let w=-p;w<=p;w++){const E=this.width*(this.nextRow+p+w);let P=0,D=n[P];for(let O=0;O<this.width;O++){O/D.right>1&&(D=n[++P]);const F=Math.abs(O-D.left),q=Math.abs(O-D.right),U=Math.min(F,q);let H;const ee=w/p*(_+1);if(D.isDash){const fe=_-Math.abs(ee);H=Math.sqrt(U*U+fe*fe)}else H=_-Math.sqrt(U*U+ee*ee);this.data[E+O]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(n){for(let P=n.length-1;P>=0;--P){const D=n[P],O=n[P+1];D.zeroLength?n.splice(P,1):O&&O.isDash===D.isDash&&(O.left=D.left,n.splice(P,1))}const l=n[0],p=n[n.length-1];l.isDash===p.isDash&&(l.left=p.left-this.width,p.right=l.right+this.width);const _=this.width*this.nextRow;let w=0,E=n[w];for(let P=0;P<this.width;P++){P/E.right>1&&(E=n[++w]);const D=Math.abs(P-E.left),O=Math.abs(P-E.right),F=Math.min(D,O);this.data[_+P]=Math.max(0,Math.min(255,(E.isDash?F:-F)+128))}}addDash(n,l){const p=l?7:0,_=2*p+1;if(this.nextRow+_>this.height)return c.w("LineAtlas out of space"),null;let w=0;for(let P=0;P<n.length;P++)w+=n[P];if(w!==0){const P=this.width/w,D=this.getDashRanges(n,this.width,P);l?this.addRoundDash(D,P,p):this.addRegularDash(D)}const E={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:w};return this.nextRow+=_,this.dirty=!0,E}bind(n){const l=n.gl;this.texture?(l.bindTexture(l.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,l.texSubImage2D(l.TEXTURE_2D,0,0,0,this.width,this.height,l.ALPHA,l.UNSIGNED_BYTE,this.data))):(this.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_2D,0,l.ALPHA,this.width,this.height,0,l.ALPHA,l.UNSIGNED_BYTE,this.data))}}const Re="maplibre_preloaded_worker_pool";class _t{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<_t.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Re]}numActive(){return Object.keys(this.active).length}}const At=Math.floor($.hardwareConcurrency/2);let St,Qt;function En(){return St||(St=new _t),St}_t.workerCount=c.H(globalThis)?Math.max(Math.min(At,3),1):1;class gn{constructor(n,l){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=l;const p=this.workerPool.acquire(l);for(let _=0;_<p.length;_++){const w=new c.J(p[_],l);w.name=`Worker ${_}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,l){const p=[];for(const _ of this.actors)p.push(_.sendAsync({type:n,data:l}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(l=>{l.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,l){for(const p of this.actors)p.registerMessageHandler(n,l)}}function ii(){return Qt||(Qt=new gn(En(),c.K),Qt.registerMessageHandler("GR",(b,n,l)=>c.m(n,l))),Qt}function wr(b,n){const l=c.L();return c.M(l,l,[1,1,0]),c.N(l,l,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?c.O(l,l,b.calculatePosMatrix(n.toUnwrapped())):l}function Cr(b,n,l,p,_,w,E){var P;const D=function(U,H,ee){if(U)for(const fe of U){const he=H[fe];if(he&&he.source===ee&&he.type==="fill-extrusion")return!0}else for(const fe in H){const he=H[fe];if(he.source===ee&&he.type==="fill-extrusion")return!0}return!1}((P=_==null?void 0:_.layers)!==null&&P!==void 0?P:null,n,b.id),O=w.maxPitchScaleFactor(),F=b.tilesIn(p,O,D);F.sort(Ds);const q=[];for(const U of F)q.push({wrappedTileID:U.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(n,l,b._state,U.queryGeometry,U.cameraQueryGeometry,U.scale,_,w,O,wr(b.transform,U.tileID),E?(H,ee)=>E(U.tileID,H,ee):void 0)});return function(U,H){for(const ee in U)for(const fe of U[ee])gi(fe,H);return U}(function(U){const H={},ee={};for(const fe of U){const he=fe.queryResults,pe=fe.wrappedTileID,_e=ee[pe]=ee[pe]||{};for(const Ae in he){const be=he[Ae],Pe=_e[Ae]=_e[Ae]||{},Le=H[Ae]=H[Ae]||[];for(const xe of be)Pe[xe.featureIndex]||(Pe[xe.featureIndex]=!0,Le.push(xe))}}return H}(q),b)}function Ds(b,n){const l=b.tileID,p=n.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function gi(b,n){const l=b.feature,p=n.getFeatureState(l.layer["source-layer"],l.id);l.source=l.layer.source,l.layer["source-layer"]&&(l.sourceLayer=l.layer["source-layer"]),l.state=p}function ao(b,n,l){return c._(this,void 0,void 0,function*(){let p=b;if(b.url?p=(yield c.j(n.transformRequest(b.url,"Source"),l)).data:yield $.frameAsync(l),!p)return null;const _=c.Q(c.e(p,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(_.vectorLayerIds=p.vector_layers.map(w=>w.id)),_})}class Tr{constructor(n,l){n&&(l?this.setSouthWest(n).setNorthEast(l):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof c.S?new c.S(n.lng,n.lat):c.S.convert(n),this}setSouthWest(n){return this._sw=n instanceof c.S?new c.S(n.lng,n.lat):c.S.convert(n),this}extend(n){const l=this._sw,p=this._ne;let _,w;if(n instanceof c.S)_=n,w=n;else{if(!(n instanceof Tr))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Tr.convert(n)):this.extend(c.S.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(c.S.convert(n)):this;if(_=n._sw,w=n._ne,!_||!w)return this}return l||p?(l.lng=Math.min(_.lng,l.lng),l.lat=Math.min(_.lat,l.lat),p.lng=Math.max(w.lng,p.lng),p.lat=Math.max(w.lat,p.lat)):(this._sw=new c.S(_.lng,_.lat),this._ne=new c.S(w.lng,w.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:l,lat:p}=c.S.convert(n);let _=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(n){return n instanceof Tr?n:n&&new Tr(n)}static fromLngLat(n,l=0){const p=360*l/40075017,_=p/Math.cos(Math.PI/180*n.lat);return new Tr(new c.S(n.lng-_,n.lat-p),new c.S(n.lng+_,n.lat+p))}adjustAntiMeridian(){const n=new c.S(this._sw.lng,this._sw.lat),l=new c.S(this._ne.lng,this._ne.lat);return new Tr(n,n.lng>l.lng?new c.S(l.lng+360,l.lat):l)}}class ya{constructor(n,l,p){this.bounds=Tr.convert(this.validateBounds(n)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const l=Math.pow(2,n.z),p=Math.floor(c.V(this.bounds.getWest())*l),_=Math.floor(c.U(this.bounds.getNorth())*l),w=Math.ceil(c.V(this.bounds.getEast())*l),E=Math.ceil(c.U(this.bounds.getSouth())*l);return n.x>=p&&n.x<w&&n.y>=_&&n.y<E}}class _a extends c.E{constructor(n,l,p,_){if(super(),this.id=n,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(l,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield ao(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(c.e(this,n),n.bounds&&(this.tileBounds=new ya(n.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new c.k(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(l,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};p.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((w,E)=>{n.reloadPromise={resolve:w,reject:E}})}else n.actor=this.dispatcher.getActor(),_="LT";n.abortController=new AbortController;try{const w=yield n.actor.sendAsync({type:_,data:p},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,w)}catch(w){if(delete n.abortController,n.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(n,null)}})}_afterTileLoadWorkerResponse(n,l){if(l&&l.resourceTiming&&(n.resourceTiming=l.resourceTiming),l&&this.map._refreshExpiredTiles&&n.setExpiryData(l),n.loadVectorData(l,this.map.painter),n.reloadPromise){const p=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(p.resolve).catch(p.reject)}}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class rl extends c.E{constructor(n,l,p,_){super(),this.id=n,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},l),c.e(this,c.Q(l,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(n=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield ao(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,l&&(c.e(this,l),l.bounds&&(this.tileBounds=new ya(l.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:n})))}catch(l){this._tileJSONRequest=null,this.fire(new c.k(l))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load(!0)}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return c.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const p=yield Ue.getImage(this.map._requestManager.transformRequest(l,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&n.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const _=this.map.painter.context,w=_.gl,E=p.data;n.texture=this.map.painter.getTileTexture(E.width),n.texture?n.texture.update(E,{useMipmap:!0}):(n.texture=new c.T(_,E,w.RGBA,{useMipmap:!0}),n.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(p){if(delete n.abortController,n.aborted)n.state="unloaded";else if(p)throw n.state="errored",p}})}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class Ir extends rl{constructor(n,l,p,_){super(n,l,p,_),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox",this.redFactor=l.redFactor,this.greenFactor=l.greenFactor,this.blueFactor=l.blueFactor,this.baseShift=l.baseShift}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(l,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const _=yield Ue.getImage(p,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(_&&_.data){const w=_.data;this.map._refreshExpiredTiles&&(_.cacheControl||_.expires)&&n.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const E=c.b(w)&&c.W()?w:yield this.readImageNow(w),P={type:this.type,uid:n.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const D=yield n.actor.sendAsync({type:"LDT",data:P});n.dem=D,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(_){if(delete n.abortController,n.aborted)n.state="unloaded";else if(_)throw n.state="errored",_}})}readImageNow(n){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.X()){const l=n.width+2,p=n.height+2;try{return new c.R({width:l,height:p},yield c.Y(n,-1,-1,l,p))}catch{}}return $.getImageData(n,1)})}_getNeighboringTiles(n){const l=n.canonical,p=Math.pow(2,l.z),_=(l.x-1+p)%p,w=l.x===0?n.wrap-1:n.wrap,E=(l.x+1+p)%p,P=l.x+1===p?n.wrap+1:n.wrap,D={};return D[new c.Z(n.overscaledZ,w,l.z,_,l.y).key]={backfilled:!1},D[new c.Z(n.overscaledZ,P,l.z,E,l.y).key]={backfilled:!1},l.y>0&&(D[new c.Z(n.overscaledZ,w,l.z,_,l.y-1).key]={backfilled:!1},D[new c.Z(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},D[new c.Z(n.overscaledZ,P,l.z,E,l.y-1).key]={backfilled:!1}),l.y+1<p&&(D[new c.Z(n.overscaledZ,w,l.z,_,l.y+1).key]={backfilled:!1},D[new c.Z(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},D[new c.Z(n.overscaledZ,P,l.z,E,l.y+1).key]={backfilled:!1}),D}unloadTile(n){return c._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))})}}class Oa extends c.E{constructor(n,l,p,_){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(_),this._data=l.data,this._options=c.e({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId,l.clusterMaxZoom!==void 0&&this.maxzoom<=l.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${l.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(l.buffer!==void 0?l.buffer:128),tolerance:this._pixelsToTileUnits(l.tolerance!==void 0?l.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(l.clusterMaxZoom),minPoints:Math.max(2,l.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(l.clusterRadius||50),log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(n){return n*(c.$/this.tileSize)}_getClusterMaxZoom(n){const l=n?Math.round(n):this.maxzoom-1;return Number.isInteger(n)||n===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${n}" rounded to "${l}"`),l}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}getData(){return c._(this,void 0,void 0,function*(){const n=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})})}getCoordinatesFromGeometry(n){return n.type==="GeometryCollection"?n.geometries.map(l=>l.coordinates).flat(1/0):n.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,function*(){const n=new Tr,l=yield this.getData();let p;switch(l.type){case"FeatureCollection":p=l.features.map(_=>this.getCoordinatesFromGeometry(_.geometry)).flat(1/0);break;case"Feature":p=this.getCoordinatesFromGeometry(l.geometry);break;default:p=this.getCoordinatesFromGeometry(l)}if(p.length==0)return n;for(let _=0;_<p.length-1;_+=2)n.extend([p[_],p[_+1]]);return n})}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(n.clusterRadius)),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(n.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,l,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:l,offset:p}})}_updateWorkerData(n){return c._(this,void 0,void 0,function*(){const l=c.e({type:this.type},this.workerOptions);n?l.dataDiff=n:typeof this._data=="string"?(l.request=this.map._requestManager.transformRequest($.resolveURL(this._data),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.l("dataloading",{dataType:"source"}));try{const p=yield this.actor.sendAsync({type:"LD",data:l});if(this._pendingLoads--,this._removed||p.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));let _=null;p.resourceTiming&&p.resourceTiming[this.id]&&(_=p.resourceTiming[this.id].slice(0));const w={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&c.e(w,{resourceTiming:_}),this.fire(new c.l("data",Object.assign(Object.assign({},w),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},w),{sourceDataType:"content"})))}catch(p){if(this._pendingLoads--,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(p))}})}loaded(){return this._pendingLoads===0}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.actor?"RT":"LT";n.actor=this.actor;const p={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};n.abortController=new AbortController;const _=yield this.actor.sendAsync({type:l,data:p},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(_,this.map.painter,l==="RT")})}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class na extends c.E{constructor(n,l,p,_){super(),this.flippedWindingOrder=!1,this.id=n,this.dispatcher=p,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=l}load(n){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const l=yield Ue.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,l&&l.data&&(this.image=l.data,n&&(this.coordinates=n),this._finishLoading())}catch(l){this._request=null,this._loaded=!0,this.fire(new c.k(l))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const l=n.map(c.a0.fromLngLat);var p;return this.tileID=function(_){const w=c.a1.fromPoints(_),E=w.width(),P=w.height(),D=Math.max(E,P),O=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),F=Math.pow(2,O);return new c.a3(O,Math.floor((w.minX+w.maxX)/2*F),Math.floor((w.minY+w.maxY)/2*F))}(l),this.terrainTileRanges=this._getOverlappingTileRanges(l),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=l.map(_=>this.tileID.getTilePoint(_)._round()),this.flippedWindingOrder=((p=this.tileCoords)[1].x-p[0].x)*(p[2].y-p[0].y)-(p[1].y-p[0].y)*(p[2].x-p[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,l=n.gl;this.texture||(this.texture=new c.T(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(n){const{minX:l,minY:p,maxX:_,maxY:w}=c.a1.fromPoints(n),E={};for(let P=0;P<=c.a2;P++){const D=Math.pow(2,P),O=Math.floor(l*D),F=Math.floor(p*D),q=Math.floor(_*D),U=Math.floor(w*D);E[P]={minTileX:O,minTileY:F,maxTileX:q,maxTileY:U}}return E}}class Ls extends na{constructor(n,l,p,_){super(n,l,p,_),this.roundZoom=!0,this.type="video",this.options=l}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const l of n.urls)this.urls.push(this.map._requestManager.transformRequest(l,"Source").url);try{const l=yield c.a4(this.urls);if(this._loaded=!0,!l)return;this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(l){this.fire(new c.k(l))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new c.k(new c.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,l=n.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Xa extends na{constructor(n,l,p,_){super(n,l,p,_),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(E=>typeof E!="number"))||this.fire(new c.k(new c.a5(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a5(`sources.${n}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new c.k(new c.a5(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a5(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a5(`sources.${n}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context,p=l.gl;this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(l,this.canvas,p.RGBA,{premultiply:!0});let _=!1;for(const w in this.tiles){const E=this.tiles[w];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,_=!0)}_&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const bu={},zs=b=>{switch(b){case"geojson":return Oa;case"image":return na;case"raster":return rl;case"raster-dem":return Ir;case"vector":return _a;case"video":return Ls;case"canvas":return Xa}return bu[b]},ls="RTLPluginLoaded";class ko extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ii()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch(l=>{throw this.status="error",l})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return c._(this,arguments,void 0,function*(l,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=$.resolveURL(l),!this.url)throw new Error(`requested url ${l} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(ls))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let fr=null;function Bn(){return fr||(fr=new ko),fr}class di{constructor(n,l){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=c.a6(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const l=n+this.timeAdded;l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,l,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(_,w){const E={};if(!w)return E;for(const P of _){const D=P.layerIds.map(O=>w.getLayer(O)).filter(Boolean);if(D.length!==0){P.layers=D,P.stateDependentLayerIds&&(P.stateDependentLayers=P.stateDependentLayerIds.map(O=>D.filter(F=>F.id===O)[0]));for(const O of D)E[O.id]=P}}return E}(n.buckets,l==null?void 0:l.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof c.a8){if(this.hasSymbolBuckets=!0,!p)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof c.a8&&w.hasRTLText){this.hasRTLText=!0,Bn().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const w=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(_).queryRadius(w))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new c.a7}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const p in this.buckets){const _=this.buckets[p];_.uploadPending()&&_.upload(n)}const l=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(n,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(n,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,l,p,_,w,E,P,D,O,F,q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:w,scale:E,tileSize:this.tileSize,pixelPosMatrix:F,transform:D,params:P,queryPadding:this.queryPadding*O,getElevation:q},n,l,p):{}}querySourceFeatures(n,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const _=p.loadVTLayers(),w=l&&l.sourceLayer?l.sourceLayer:"",E=_._geojsonTileLayer||_[w];if(!E)return;const P=c.a9(l&&l.filter),{z:D,x:O,y:F}=this.tileID.canonical,q={z:D,x:O,y:F};for(let U=0;U<E.length;U++){const H=E.feature(U);if(P.needGeometry){const he=c.aa(H,!0);if(!P.filter(new c.F(this.tileID.overscaledZ),he,this.tileID.canonical))continue}else if(!P.filter(new c.F(this.tileID.overscaledZ),H))continue;const ee=p.getId(H,w),fe=new c.ab(H,D,O,F,ee);fe.tile=q,n.push(fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const l=this.expirationTime;if(n.cacheControl){const p=c.ac(n.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const p=Date.now();let _=!1;if(this.expirationTime>p)_=!1;else if(l)if(this.expirationTime<l)_=!0;else{const w=this.expirationTime-l;w?this.expirationTime=p+Math.max(w,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!l.style.hasLayer(_))continue;const w=this.buckets[_],E=w.layers[0].sourceLayer||"_geojsonTileLayer",P=p[E],D=n[E];if(!P||!D||Object.keys(D).length===0)continue;w.update(D,P,this.imageAtlas&&this.imageAtlas.patternPositions||{});const O=l&&l.style&&l.style.getLayer(_);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<$.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=$.now()+n}setDependencies(n,l){const p={};for(const _ of l)p[_]=!0;this.dependencies[n]=p}hasDependency(n,l){for(const p of n){const _=this.dependencies[p];if(_){for(const w of l)if(_[w])return!0}}return!1}}class Ri{constructor(n,l){this.max=n,this.onRemove=l,this.reset()}reset(){for(const n in this.data)for(const l of this.data[n])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(n,l,p){const _=n.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const w={value:l,timeout:void 0};if(p!==void 0&&(w.timeout=setTimeout(()=>{this.remove(n,w)},p)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const l=this.data[n].shift();return l.timeout&&clearTimeout(l.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),l.value}getByKey(n){const l=this.data[n];return l?l[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,l){if(!this.has(n))return this;const p=n.wrapped().key,_=l===void 0?0:this.data[p].indexOf(l),w=this.data[p][_];return this.data[p].splice(_,1),w.timeout&&clearTimeout(w.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(w.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(n){const l=[];for(const p in this.data)for(const _ of this.data[p])n(_.value)||l.push(_);for(const p of l)this.remove(p.value.tileID,p)}}class xu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,l,p){const _=String(l);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][_]=this.stateChanges[n][_]||{},c.e(this.stateChanges[n][_],p),this.deletedStates[n]===null){this.deletedStates[n]={};for(const w in this.state[n])w!==_&&(this.deletedStates[n][w]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][_]===null){this.deletedStates[n][_]={};for(const w in this.state[n][_])p[w]||(this.deletedStates[n][_][w]=null)}else for(const w in p)this.deletedStates[n]&&this.deletedStates[n][_]&&this.deletedStates[n][_][w]===null&&delete this.deletedStates[n][_][w]}removeFeatureState(n,l,p){if(this.deletedStates[n]===null)return;const _=String(l);if(this.deletedStates[n]=this.deletedStates[n]||{},p&&l!==void 0)this.deletedStates[n][_]!==null&&(this.deletedStates[n][_]=this.deletedStates[n][_]||{},this.deletedStates[n][_][p]=null);else if(l!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][_])for(p in this.deletedStates[n][_]={},this.stateChanges[n][_])this.deletedStates[n][_][p]=null;else this.deletedStates[n][_]=null;else this.deletedStates[n]=null}getState(n,l){const p=String(l),_=c.e({},(this.state[n]||{})[p],(this.stateChanges[n]||{})[p]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const w=this.deletedStates[n][l];if(w===null)return{};for(const E in w)delete _[E]}return _}initializeTileState(n,l){n.setFeatureState(this.state,l)}coalesceChanges(n,l){const p={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const w={};for(const E in this.stateChanges[_])this.state[_][E]||(this.state[_][E]={}),c.e(this.state[_][E],this.stateChanges[_][E]),w[E]=this.state[_][E];p[_]=w}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const w={};if(this.deletedStates[_]===null)for(const E in this.state[_])w[E]={},this.state[_][E]={};else for(const E in this.deletedStates[_]){if(this.deletedStates[_][E]===null)this.state[_][E]={};else for(const P of Object.keys(this.deletedStates[_][E]))delete this.state[_][E][P];w[E]=this.state[_][E]}p[_]=p[_]||{},c.e(p[_],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const _ in n)n[_].setFeatureState(p,l)}}const so=89.25;function Ge(b,n){const l=c.ag(n.lat,-85.051129,c.ah);return new c.P(c.V(n.lng)*b,c.U(l)*b)}function ne(b,n){return new c.a0(n.x/b,n.y/b).toLngLat()}function ie(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(c.ad(90-b.pitch)),Math.tan(c.ad(so-b.pitch)))}function ue(b,n){const l=b.canonical,p=n/c.ae(l.z),_=l.x+Math.pow(2,l.z)*b.wrap,w=c.af(new Float64Array(16));return c.M(w,w,[_*p,l.y*p,0]),c.N(w,w,[p/c.$,p/c.$,1]),w}function Te(b,n,l,p,_){const w=c.a0.fromLngLat(b,n),E=_*c.ai(1,b.lat),P=E*Math.cos(c.ad(l)),D=Math.sqrt(E*E-P*P),O=D*Math.sin(c.ad(-p)),F=D*Math.cos(c.ad(-p));return new c.a0(w.x+O,w.y+F,w.z+P)}function Oe(b,n,l){const p=n.intersectsFrustum(b);if(!l||p===0)return p;const _=n.intersectsPlane(l);return _===0?0:p===2&&_===2?2:1}function $e(b,n,l){let p=0;const _=(l-n)/10;for(let w=0;w<10;w++)p+=_*Math.pow(Math.cos(n+(w+.5)/10*(l-n)),b);return p}function tt(b,n){return function(l,p,_,w,E){const P=2*((b-1)/c.aj(Math.cos(c.ad(so-E))/Math.cos(c.ad(so)))-1),D=Math.acos(_/w),O=2*$e(P-1,0,c.ad(E/2)),F=Math.min(c.ad(so),D+c.ad(E/2)),q=$e(P-1,Math.min(F,D-c.ad(E/2)),F),U=Math.atan(p/_),H=Math.hypot(p,_);let ee=l;return ee+=c.aj(w/H/Math.max(.5,Math.cos(c.ad(E/2)))),ee+=P*c.aj(Math.cos(U))/2,ee-=c.aj(Math.max(1,q/O/n))/2,ee}}const je=tt(9.314,3);function ht(b,n){const l=(n.roundZoom?Math.round:Math.floor)(b.zoom+c.aj(b.tileSize/n.tileSize));return Math.max(0,l)}function st(b,n){const l=b.getCameraFrustum(),p=b.getClippingPlane(),_=b.screenPointToMercatorCoordinate(b.getCameraPoint()),w=c.a0.fromLngLat(b.center,b.elevation);_.z=w.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const E=b.getCoveringTilesDetailsProvider(),P=E.allowVariableZoom(b,n),D=ht(b,n),O=n.minzoom||0,F=n.maxzoom!==void 0?n.maxzoom:b.maxZoom,q=Math.min(Math.max(0,D),F),U=Math.pow(2,q),H=[U*_.x,U*_.y,0],ee=[U*w.x,U*w.y,0],fe=Math.hypot(w.x-_.x,w.y-_.y),he=Math.abs(w.z-_.z),pe=Math.hypot(fe,he),_e=Pe=>({zoom:0,x:0,y:0,wrap:Pe,fullyVisible:!1}),Ae=[],be=[];if(b.renderWorldCopies&&E.allowWorldCopies())for(let Pe=1;Pe<=3;Pe++)Ae.push(_e(-Pe)),Ae.push(_e(Pe));for(Ae.push(_e(0));Ae.length>0;){const Pe=Ae.pop(),Le=Pe.x,xe=Pe.y;let Ve=Pe.fullyVisible;const rt={x:Le,y:xe,z:Pe.zoom},Ye=E.getTileBoundingVolume(rt,Pe.wrap,b.elevation,n);if(!Ve){const Lt=Oe(l,Ye,p);if(Lt===0)continue;Ve=Lt===2}const Qe=E.distanceToTile2d(_.x,_.y,rt,Ye);let ot=D;P&&(ot=(n.calculateTileZoom||je)(b.zoom+c.aj(b.tileSize/n.tileSize),Qe,he,pe,b.fov)),ot=(n.roundZoom?Math.round:Math.floor)(ot),ot=Math.max(0,ot);const zt=Math.min(ot,F);if(Pe.wrap=E.getWrap(w,rt,Pe.wrap),Pe.zoom>=zt){if(Pe.zoom<O)continue;const Lt=q-Pe.zoom,bt=H[0]-.5-(Le<<Lt),Zt=H[1]-.5-(xe<<Lt),Mn=n.reparseOverscaled?Math.max(Pe.zoom,ot):Pe.zoom;be.push({tileID:new c.Z(Pe.zoom===F?Mn:Pe.zoom,Pe.wrap,Pe.zoom,Le,xe),distanceSq:c.ak([ee[0]-.5-Le,ee[1]-.5-xe]),tileDistanceToCamera:Math.sqrt(bt*bt+Zt*Zt)})}else for(let Lt=0;Lt<4;Lt++)Ae.push({zoom:Pe.zoom+1,x:(Le<<1)+Lt%2,y:(xe<<1)+(Lt>>1),wrap:Pe.wrap,fullyVisible:Ve})}return be.sort((Pe,Le)=>Pe.distanceSq-Le.distanceSq).map(Pe=>Pe.tileID)}const Ke=c.a1.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class mt extends c.E{constructor(n,l,p){super(),this.id=n,this.dispatcher=p,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,w,E,P)=>{const D=new(zs(w.type))(_,w,E,P);if(D.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${D.id}`);return D})(n,l,p,this),this._tiles={},this._cache=new Ri(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new xu,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,l,p){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,l,p)}catch(_){n.state="errored",_.status!==404?this._source.fire(new c.k(_,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new c.l("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(n),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(ze).map(n=>n.key)}getRenderableIds(n){const l=[];for(const p in this._tiles)this._isIdRenderable(p,n)&&l.push(this._tiles[p]);return n?l.sort((p,_)=>{const w=p.tileID,E=_.tileID,P=new c.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians),D=new c.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return w.overscaledZ-E.overscaledZ||D.y-P.y||D.x-P.x}).map(p=>p.tileID.key):l.map(p=>p.tileID).sort(ze).map(p=>p.key)}hasRenderableParent(n){const l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())}reload(n){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)n?this._reloadTile(l,"expired"):this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(n,l){return c._(this,void 0,void 0,function*(){const p=this._tiles[n];p&&(p.state!=="loading"&&(p.state=l),yield this._loadTile(p,n,l))})}_tileLoaded(n,l,p){n.timeAdded=$.now(),p==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const l=this.getRenderableIds();for(let _=0;_<l.length;_++){const w=l[_];if(n.neighboringTiles&&n.neighboringTiles[w]){const E=this.getTileByID(w);p(n,E),p(E,n)}}function p(_,w){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let E=w.tileID.canonical.x-_.tileID.canonical.x;const P=w.tileID.canonical.y-_.tileID.canonical.y,D=Math.pow(2,_.tileID.canonical.z),O=w.tileID.key;E===0&&P===0||Math.abs(P)>1||(Math.abs(E)>1&&(Math.abs(E+D)===1?E+=D:Math.abs(E-D)===1&&(E-=D)),w.dem&&_.dem&&(_.dem.backfillBorder(w.dem,E,P),_.neighboringTiles&&_.neighboringTiles[O]&&(_.neighboringTiles[O].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,l,p,_){for(const w in this._tiles){let E=this._tiles[w];if(_[w]||!E.hasData()||E.tileID.overscaledZ<=l||E.tileID.overscaledZ>p)continue;let P=E.tileID;for(;E&&E.tileID.overscaledZ>l+1;){const O=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[O.key],E&&E.hasData()&&(P=O)}let D=P;for(;D.overscaledZ>l;)if(D=D.scaledTo(D.overscaledZ-1),n[D.key]||n[D.canonical.key]){_[P.key]=P;break}}}findLoadedParent(n,l){if(n.key in this._loadedParentTiles){const p=this._loadedParentTiles[n.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=n.overscaledZ-1;p>=l;p--){const _=n.scaledTo(p),w=this._getLoadedTile(_);if(w)return w}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const l=Math.ceil(n.width/this._source.tileSize)+1,p=Math.ceil(n.height/this._source.tileSize)+1,_=Math.floor(l*p*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(w)}handleWrapJump(n){const l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){const p={};for(const _ in this._tiles){const w=this._tiles[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),p[w.tileID.key]=w}this._tiles=p;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}_updateCoveredAndRetainedTiles(n,l,p,_,w,E){const P={},D={},O=Object.keys(n),F=$.now();for(const q of O){const U=n[q],H=this._tiles[q];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=F)continue;const ee=this.findLoadedParent(U,l),fe=this.findLoadedSibling(U),he=ee||fe||null;he&&(this._addTile(he.tileID),P[he.tileID.key]=he.tileID),D[q]=U}this._retainLoadedChildren(D,_,p,n);for(const q in P)n[q]||(this._coveredTiles[q]=!0,n[q]=P[q]);if(E){const q={},U={};for(const H of w)this._tiles[H.key].hasData()?q[H.key]=H:U[H.key]=H;for(const H in U){const ee=U[H].children(this._source.maxzoom);this._tiles[ee[0].key]&&this._tiles[ee[1].key]&&this._tiles[ee[2].key]&&this._tiles[ee[3].key]&&(q[ee[0].key]=n[ee[0].key]=ee[0],q[ee[1].key]=n[ee[1].key]=ee[1],q[ee[2].key]=n[ee[2].key]=ee[2],q[ee[3].key]=n[ee[3].key]=ee[3],delete U[H])}for(const H in U){const ee=U[H],fe=this.findLoadedParent(ee,this._source.minzoom),he=this.findLoadedSibling(ee),pe=fe||he||null;if(pe){q[pe.tileID.key]=n[pe.tileID.key]=pe.tileID;for(const _e in q)q[_e].isChildOf(pe.tileID)&&delete q[_e]}}for(const H in this._tiles)q[H]||(this._coveredTiles[H]=!0)}}update(n,l){if(!this._sourceLoaded||this._paused)return;let p;this.transform=n,this.terrain=l,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(F=>new c.Z(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y)):(p=st(n,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:l,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(p=p.filter(F=>this._source.hasTile(F)))):p=[];const _=ht(n,this._source),w=Math.max(_-mt.maxOverzooming,this._source.minzoom),E=Math.max(_+mt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const F={};for(const q of p)if(q.canonical.z>this._source.minzoom){const U=q.scaledTo(q.canonical.z-1);F[U.key]=U;const H=q.scaledTo(Math.max(this._source.minzoom,Math.min(q.canonical.z,5)));F[H.key]=H}p=p.concat(Object.values(F))}const P=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,P&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const D=this._updateRetainedTiles(p,_);Ot(this._source.type)&&this._updateCoveredAndRetainedTiles(D,w,E,_,p,l);for(const F in D)this._tiles[F].clearFadeHold();const O=c.al(this._tiles,D);for(const F of O){const q=this._tiles[F];q.hasSymbolBuckets&&!q.holdingForFade()?q.setHoldDuration(this.map._fadeDuration):q.hasSymbolBuckets&&!q.symbolFadeFinished()||this._removeTile(F)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,l){var p;const _={},w={},E=Math.max(l-mt.maxOverzooming,this._source.minzoom),P=Math.max(l+mt.maxUnderzooming,this._source.minzoom),D={};for(const O of n){const F=this._addTile(O);_[O.key]=O,F.hasData()||l<this._source.maxzoom&&(D[O.key]=O)}this._retainLoadedChildren(D,l,P,_);for(const O of n){let F=this._tiles[O.key];if(F.hasData())continue;if(l+1>this._source.maxzoom){const U=O.children(this._source.maxzoom)[0],H=this.getTile(U);if(H&&H.hasData()){_[U.key]=U;continue}}else{const U=O.children(this._source.maxzoom);if(_[U[0].key]&&_[U[1].key]&&_[U[2].key]&&_[U[3].key])continue}let q=F.wasRequested();for(let U=O.overscaledZ-1;U>=E;--U){const H=O.scaledTo(U);if(w[H.key])break;if(w[H.key]=!0,F=this.getTile(H),!F&&q&&(F=this._addTile(H)),F){const ee=F.hasData();if((ee||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||q)&&(_[H.key]=H),q=F.wasRequested(),ee)break}}}return _}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const l=[];let p,_=this._tiles[n].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){p=this._loadedParentTiles[_.key];break}l.push(_.key);const w=_.scaledTo(_.overscaledZ-1);if(p=this._getLoadedTile(w),p)break;_=w}for(const w of l)this._loadedParentTiles[w]=p}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const l=this._tiles[n].tileID,p=this._getLoadedTile(l);this._loadedSiblingTiles[l.key]=p}}_addTile(n){let l=this._tiles[n.key];if(l)return l;l=this._cache.getAndRemove(n),l&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));const p=l;return l||(l=new di(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,n.key,l.state)),l.uses++,this._tiles[n.key]=l,p||this._source.fire(new c.l("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l}_setTileReloadTimer(n,l){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const p=l.getExpiryTimeout();p&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},p))}refreshTiles(n){for(const l in this._tiles)(this._isIdRenderable(l)||this._tiles[l].state=="errored")&&n.some(p=>p.equals(this._tiles[l].tileID.canonical))&&this._reloadTile(l,"expired")}_removeTile(n){const l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}_dataHandler(n){const l=n.sourceDataType;n.dataType==="source"&&l==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&l==="content"&&(this.reload(n.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,l,p){const _=[],w=this.transform;if(!w)return _;const E=w.getCoveringTilesDetailsProvider().allowWorldCopies(),P=p?w.getCameraQueryGeometry(n):n,D=H=>w.screenPointToMercatorCoordinate(H,this.terrain),O=this.transformBbox(n,D,!E),F=this.transformBbox(P,D,!E),q=this.getIds(),U=c.a1.fromPoints(F);for(let H=0;H<q.length;H++){const ee=this._tiles[q[H]];if(ee.holdingForFade())continue;const fe=E?[ee.tileID]:[ee.tileID.unwrapTo(-1),ee.tileID.unwrapTo(0)],he=Math.pow(2,w.zoom-ee.tileID.overscaledZ),pe=l*ee.queryPadding*c.$/ee.tileSize/he;for(const _e of fe){const Ae=U.map(be=>_e.getTilePoint(new c.a0(be.x,be.y)));if(Ae.expandBy(pe),Ae.intersects(Ke)){const be=O.map(Le=>_e.getTilePoint(Le)),Pe=F.map(Le=>_e.getTilePoint(Le));_.push({tile:ee,tileID:E?_e:_e.unwrapTo(0),queryGeometry:be,cameraQueryGeometry:Pe,scale:he})}}}return _}transformBbox(n,l,p){let _=n.map(l);if(p){const w=c.a1.fromPoints(n);w.shrinkBy(.001*Math.min(w.width(),w.height()));const E=w.map(l);c.a1.fromPoints(_).covers(E)||(_=_.map(P=>P.x>.5?new c.a0(P.x-1,P.y,P.z):P))}return _}getVisibleCoordinates(n){const l=this.getRenderableIds(n).map(p=>this._tiles[p].tileID);return this.transform&&this.transform.populateCache(l),l}hasTransition(){if(this._source.hasTransition())return!0;if(Ot(this._source.type)){const n=$.now();for(const l in this._tiles)if(this._tiles[l].fadeEndTime>=n)return!0}return!1}setFeatureState(n,l,p){this._state.updateState(n=n||"_geojsonTileLayer",l,p)}removeFeatureState(n,l,p){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,p)}getFeatureState(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)}setDependencies(n,l,p){const _=this._tiles[n];_&&_.setDependencies(l,p)}reloadTilesForDependencies(n,l){for(const p in this._tiles)this._tiles[p].hasDependency(n,l)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(n,l))}}function ze(b,n){const l=Math.abs(2*b.wrap)-+(b.wrap<0),p=Math.abs(2*n.wrap)-+(n.wrap<0);return b.overscaledZ-n.overscaledZ||p-l||n.canonical.y-b.canonical.y||n.canonical.x-b.canonical.x}function Ot(b){return b==="raster"||b==="image"||b==="video"}mt.maxOverzooming=10,mt.maxUnderzooming=3;class on{constructor(n,l){this.reset(n,l)}reset(n,l){this.points=n||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=c.ag(n,0,1);let l=1,p=this._distances[l];const _=n*this.paddedLength+this.padding;for(;p<_&&l<this._distances.length;)p=this._distances[++l];const w=l-1,E=this._distances[w],P=p-E,D=P>0?(_-E)/P:0;return this.points[w].mult(1-D).add(this.points[l].mult(D))}}function jt(b,n){let l=!0;return b==="always"||b!=="never"&&n!=="never"||(l=!1),l}class Jt{constructor(n,l,p){const _=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(n/p),this.yCellCount=Math.ceil(l/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)_.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=l,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,l,p,_,w){this._forEachCell(l,p,_,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(w)}insertCircle(n,l,p,_){this._forEachCell(l-_,p-_,l+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(l),this.circles.push(p),this.circles.push(_)}_insertBoxCell(n,l,p,_,w,E){this.boxCells[w].push(E)}_insertCircleCell(n,l,p,_,w,E){this.circleCells[w].push(E)}_query(n,l,p,_,w,E,P){if(p<0||n>this.width||_<0||l>this.height)return[];const D=[];if(n<=0&&l<=0&&this.width<=p&&this.height<=_){if(w)return[{key:null,x1:n,y1:l,x2:p,y2:_}];for(let O=0;O<this.boxKeys.length;O++)D.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const F=this.circles[3*O],q=this.circles[3*O+1],U=this.circles[3*O+2];D.push({key:this.circleKeys[O],x1:F-U,y1:q-U,x2:F+U,y2:q+U})}}else this._forEachCell(n,l,p,_,this._queryCell,D,{hitTest:w,overlapMode:E,seenUids:{box:{},circle:{}}},P);return D}query(n,l,p,_){return this._query(n,l,p,_,!1,null)}hitTest(n,l,p,_,w,E){return this._query(n,l,p,_,!0,w,E).length>0}hitTestCircle(n,l,p,_,w){const E=n-p,P=n+p,D=l-p,O=l+p;if(P<0||E>this.width||O<0||D>this.height)return!1;const F=[];return this._forEachCell(E,D,P,O,this._queryCellCircle,F,{hitTest:!0,overlapMode:_,circle:{x:n,y:l,radius:p},seenUids:{box:{},circle:{}}},w),F.length>0}_queryCell(n,l,p,_,w,E,P,D){const{seenUids:O,hitTest:F,overlapMode:q}=P,U=this.boxCells[w];if(U!==null){const ee=this.bboxes;for(const fe of U)if(!O.box[fe]){O.box[fe]=!0;const he=4*fe,pe=this.boxKeys[fe];if(n<=ee[he+2]&&l<=ee[he+3]&&p>=ee[he+0]&&_>=ee[he+1]&&(!D||D(pe))&&(!F||!jt(q,pe.overlapMode))&&(E.push({key:pe,x1:ee[he],y1:ee[he+1],x2:ee[he+2],y2:ee[he+3]}),F))return!0}}const H=this.circleCells[w];if(H!==null){const ee=this.circles;for(const fe of H)if(!O.circle[fe]){O.circle[fe]=!0;const he=3*fe,pe=this.circleKeys[fe];if(this._circleAndRectCollide(ee[he],ee[he+1],ee[he+2],n,l,p,_)&&(!D||D(pe))&&(!F||!jt(q,pe.overlapMode))){const _e=ee[he],Ae=ee[he+1],be=ee[he+2];if(E.push({key:pe,x1:_e-be,y1:Ae-be,x2:_e+be,y2:Ae+be}),F)return!0}}}return!1}_queryCellCircle(n,l,p,_,w,E,P,D){const{circle:O,seenUids:F,overlapMode:q}=P,U=this.boxCells[w];if(U!==null){const ee=this.bboxes;for(const fe of U)if(!F.box[fe]){F.box[fe]=!0;const he=4*fe,pe=this.boxKeys[fe];if(this._circleAndRectCollide(O.x,O.y,O.radius,ee[he+0],ee[he+1],ee[he+2],ee[he+3])&&(!D||D(pe))&&!jt(q,pe.overlapMode))return E.push(!0),!0}}const H=this.circleCells[w];if(H!==null){const ee=this.circles;for(const fe of H)if(!F.circle[fe]){F.circle[fe]=!0;const he=3*fe,pe=this.circleKeys[fe];if(this._circlesCollide(ee[he],ee[he+1],ee[he+2],O.x,O.y,O.radius)&&(!D||D(pe))&&!jt(q,pe.overlapMode))return E.push(!0),!0}}}_forEachCell(n,l,p,_,w,E,P,D){const O=this._convertToXCellCoord(n),F=this._convertToYCellCoord(l),q=this._convertToXCellCoord(p),U=this._convertToYCellCoord(_);for(let H=O;H<=q;H++)for(let ee=F;ee<=U;ee++)if(w.call(this,n,l,p,_,this.xCellCount*ee+H,E,P,D))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,l,p,_,w,E){const P=_-n,D=w-l,O=p+E;return O*O>P*P+D*D}_circleAndRectCollide(n,l,p,_,w,E,P){const D=(E-_)/2,O=Math.abs(n-(_+D));if(O>D+p)return!1;const F=(P-w)/2,q=Math.abs(l-(w+F));if(q>F+p)return!1;if(O<=D||q<=F)return!0;const U=O-D,H=q-F;return U*U+H*H<=p*p}}function Xt(b,n,l){const p=c.L();if(!b){const{vecSouth:q,vecEast:U}=vn(n),H=R();H[0]=U[0],H[1]=U[1],H[2]=q[0],H[3]=q[1],_=H,(F=(E=(w=H)[0])*(O=w[3])-(D=w[2])*(P=w[1]))&&(_[0]=O*(F=1/F),_[1]=-P*F,_[2]=-D*F,_[3]=E*F),p[0]=H[0],p[1]=H[1],p[4]=H[2],p[5]=H[3]}var _,w,E,P,D,O,F;return c.N(p,p,[1/l,1/l,1]),p}function An(b,n,l,p){if(b){const _=c.L();if(!n){const{vecSouth:w,vecEast:E}=vn(l);_[0]=E[0],_[1]=E[1],_[4]=w[0],_[5]=w[1]}return c.N(_,_,[p,p,1]),_}return l.pixelsToClipSpaceMatrix}function vn(b){const n=Math.cos(b.rollInRadians),l=Math.sin(b.rollInRadians),p=Math.cos(b.pitchInRadians),_=Math.cos(b.bearingInRadians),w=Math.sin(b.bearingInRadians),E=c.aq();E[0]=-_*p*l-w*n,E[1]=-w*p*l+_*n;const P=c.ar(E);P<1e-9?c.as(E):c.at(E,E,1/P);const D=c.aq();D[0]=_*p*n-w*l,D[1]=w*p*n+_*l;const O=c.ar(D);return O<1e-9?c.as(D):c.at(D,D,1/O),{vecEast:D,vecSouth:E}}function Cn(b,n,l,p){let _;p?(_=[b,n,p(b,n),1],c.av(_,_,l)):(_=[b,n,0,1],Do(_,_,l));const w=_[3];return{point:new c.P(_[0]/w,_[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function cn(b,n){return .5+b/n*.5}function jn(b,n){return b.x>=-n[0]&&b.x<=n[0]&&b.y>=-n[1]&&b.y<=n[1]}function Kr(b,n,l,p,_,w,E,P,D,O,F,q,U){const H=l?b.textSizeData:b.iconSizeData,ee=c.am(H,n.transform.zoom),fe=[256/n.width*2+1,256/n.height*2+1],he=l?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;he.clear();const pe=b.lineVertexArray,_e=l?b.text.placedSymbolArray:b.icon.placedSymbolArray,Ae=n.transform.width/n.transform.height;let be=!1;for(let Pe=0;Pe<_e.length;Pe++){const Le=_e.get(Pe);if(Le.hidden||Le.writingMode===c.an.vertical&&!be){Os(Le.numGlyphs,he);continue}be=!1;const xe=new c.P(Le.anchorX,Le.anchorY),Ve={getElevation:U,pitchedLabelPlaneMatrix:p,lineVertexArray:pe,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:n.transform,tileAnchorPoint:xe,unwrappedTileID:D,width:O,height:F,translation:q},rt=nn(Le.anchorX,Le.anchorY,Ve);if(!jn(rt.point,fe)){Os(Le.numGlyphs,he);continue}const Ye=cn(n.transform.cameraToCenterDistance,rt.signedDistanceFromCamera),Qe=c.ao(H,ee,Le),ot=w?Qe*n.transform.getPitchedTextCorrection(Le.anchorX,Le.anchorY,D)/Ye:Qe*Ye,zt=cr({projectionContext:Ve,pitchedLabelPlaneMatrixInverse:_,symbol:Le,fontSize:ot,flip:!1,keepUpright:E,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:he,aspectRatio:Ae,rotateToLine:P});be=zt.useVertical,(zt.notEnoughRoom||be||zt.needsFlipping&&cr({projectionContext:Ve,pitchedLabelPlaneMatrixInverse:_,symbol:Le,fontSize:ot,flip:!0,keepUpright:E,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:he,aspectRatio:Ae,rotateToLine:P}).notEnoughRoom)&&Os(Le.numGlyphs,he)}l?b.text.dynamicLayoutVertexBuffer.updateData(he):b.icon.dynamicLayoutVertexBuffer.updateData(he)}function kt(b,n,l,p,_,w,E,P){const D=w.glyphStartIndex+w.numGlyphs,O=w.lineStartIndex,F=w.lineStartIndex+w.lineLength,q=n.getoffsetX(w.glyphStartIndex),U=n.getoffsetX(D-1),H=ki(b*q,l,p,_,w.segment,O,F,P,E);if(!H)return null;const ee=ki(b*U,l,p,_,w.segment,O,F,P,E);return ee?P.projectionCache.anyProjectionOccluded?null:{first:H,last:ee}:null}function ai(b,n,l,p){return b===c.an.horizontal&&Math.abs(l.y-n.y)>Math.abs(l.x-n.x)*p?{useVertical:!0}:(b===c.an.vertical?n.y<l.y:n.x>l.x)?{needsFlipping:!0}:null}function cr(b){const{projectionContext:n,pitchedLabelPlaneMatrixInverse:l,symbol:p,fontSize:_,flip:w,keepUpright:E,glyphOffsetArray:P,dynamicLayoutVertexArray:D,aspectRatio:O,rotateToLine:F}=b,q=_/24,U=p.lineOffsetX*q,H=p.lineOffsetY*q;let ee;if(p.numGlyphs>1){const fe=p.glyphStartIndex+p.numGlyphs,he=p.lineStartIndex,pe=p.lineStartIndex+p.lineLength,_e=kt(q,P,U,H,w,p,F,n);if(!_e)return{notEnoughRoom:!0};const Ae=hn(_e.first.point.x,_e.first.point.y,n,l),be=hn(_e.last.point.x,_e.last.point.y,n,l);if(E&&!w){const Pe=ai(p.writingMode,Ae,be,O);if(Pe)return Pe}ee=[_e.first];for(let Pe=p.glyphStartIndex+1;Pe<fe-1;Pe++){const Le=ki(q*P.getoffsetX(Pe),U,H,w,p.segment,he,pe,n,F);if(!Le)return{notEnoughRoom:!0};ee.push(Le)}ee.push(_e.last)}else{if(E&&!w){const he=Dt(n.tileAnchorPoint.x,n.tileAnchorPoint.y,n).point,pe=p.lineStartIndex+p.segment+1,_e=new c.P(n.lineVertexArray.getx(pe),n.lineVertexArray.gety(pe)),Ae=Dt(_e.x,_e.y,n),be=Ae.signedDistanceFromCamera>0?Ae.point:va(n.tileAnchorPoint,_e,he,1,n),Pe=hn(he.x,he.y,n,l),Le=hn(be.x,be.y,n,l),xe=ai(p.writingMode,Pe,Le,O);if(xe)return xe}const fe=ki(q*P.getoffsetX(p.glyphStartIndex),U,H,w,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,n,F);if(!fe||n.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ee=[fe]}for(const fe of ee)c.au(D,fe.point,fe.angle);return{}}function va(b,n,l,p,_){const w=b.add(b.sub(n)._unit()),E=Dt(w.x,w.y,_).point,P=l.sub(E);return l.add(P._mult(p/P.mag()))}function ba(b,n,l){const p=n.projectionCache;if(p.projections[b])return p.projections[b];const _=new c.P(n.lineVertexArray.getx(b),n.lineVertexArray.gety(b)),w=Dt(_.x,_.y,n);if(w.signedDistanceFromCamera>0)return p.projections[b]=w.point,p.anyProjectionOccluded=p.anyProjectionOccluded||w.isOccluded,w.point;const E=b-l.direction;return va(l.distanceFromAnchor===0?n.tileAnchorPoint:new c.P(n.lineVertexArray.getx(E),n.lineVertexArray.gety(E)),_,l.previousVertex,l.absOffsetX-l.distanceFromAnchor+1,n)}function Dt(b,n,l){const p=b+l.translation[0],_=n+l.translation[1];let w;return l.pitchWithMap?(w=Cn(p,_,l.pitchedLabelPlaneMatrix,l.getElevation),w.isOccluded=!1):(w=l.transform.projectTileCoordinates(p,_,l.unwrappedTileID,l.getElevation),w.point.x=(.5*w.point.x+.5)*l.width,w.point.y=(.5*-w.point.y+.5)*l.height),w}function hn(b,n,l,p){if(l.pitchWithMap){const _=[b,n,0,1];return c.av(_,_,p),l.transform.projectTileCoordinates(_[0]/_[3],_[1]/_[3],l.unwrappedTileID,l.getElevation).point}return{x:b/l.width*2-1,y:n/l.height*2-1}}function nn(b,n,l){return l.transform.projectTileCoordinates(b,n,l.unwrappedTileID,l.getElevation)}function ha(b,n,l){return b._unit()._perp()._mult(n*l)}function il(b,n,l,p,_,w,E,P,D){if(P.projectionCache.offsets[b])return P.projectionCache.offsets[b];const O=l.add(n);if(b+D.direction<p||b+D.direction>=_)return P.projectionCache.offsets[b]=O,O;const F=ba(b+D.direction,P,D),q=ha(F.sub(l),E,D.direction),U=l.add(q),H=F.add(q);return P.projectionCache.offsets[b]=c.aw(w,O,U,H)||O,P.projectionCache.offsets[b]}function ki(b,n,l,p,_,w,E,P,D){const O=p?b-n:b+n;let F=O>0?1:-1,q=0;p&&(F*=-1,q=Math.PI),F<0&&(q+=Math.PI);let U,H=F>0?w+_:w+_+1;P.projectionCache.cachedAnchorPoint?U=P.projectionCache.cachedAnchorPoint:(U=Dt(P.tileAnchorPoint.x,P.tileAnchorPoint.y,P).point,P.projectionCache.cachedAnchorPoint=U);let ee,fe,he=U,pe=U,_e=0,Ae=0;const be=Math.abs(O),Pe=[];let Le;for(;_e+Ae<=be;){if(H+=F,H<w||H>=E)return null;_e+=Ae,pe=he,fe=ee;const rt={absOffsetX:be,direction:F,distanceFromAnchor:_e,previousVertex:pe};if(he=ba(H,P,rt),l===0)Pe.push(pe),Le=he.sub(pe);else{let Ye;const Qe=he.sub(pe);Ye=Qe.mag()===0?ha(ba(H+F,P,rt).sub(he),l,F):ha(Qe,l,F),fe||(fe=pe.add(Ye)),ee=il(H,Ye,he,w,E,fe,l,P,rt),Pe.push(fe),Le=ee.sub(fe)}Ae=Le.mag()}const xe=Le._mult((be-_e)/Ae)._add(fe||pe),Ve=q+Math.atan2(he.y-pe.y,he.x-pe.x);return Pe.push(xe),{point:xe,angle:D?Ve:0,path:Pe}}const yn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Os(b,n){for(let l=0;l<b;l++){const p=n.length;n.resize(p+4),n.float32.set(yn,3*p)}}function Do(b,n,l){const p=n[0],_=n[1];return b[0]=l[0]*p+l[4]*_+l[12],b[1]=l[1]*p+l[5]*_+l[13],b[3]=l[3]*p+l[7]*_+l[15],b}const kr=100;class Ll{constructor(n,l=new Jt(n.width+200,n.height+200,25),p=new Jt(n.width+200,n.height+200,25)){this.transform=n,this.grid=l,this.ignoredGrid=p,this.pitchFactor=Math.cos(n.pitch*Math.PI/180)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+kr,this.screenBottomBoundary=n.height+kr,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,l,p,_,w,E,P,D,O,F,q,U){const H=this.projectAndGetPerspectiveRatio(n.anchorPointX+D[0],n.anchorPointY+D[1],w,F,U),ee=p*H.perspectiveRatio;let fe;if(E||P)fe=this._projectCollisionBox(n,ee,_,w,E,P,D,H,F,q,U);else{const Le=H.x+(q?q.x*ee:0),xe=H.y+(q?q.y*ee:0);fe={allPointsOccluded:!1,box:[Le+n.x1*ee,xe+n.y1*ee,Le+n.x2*ee,xe+n.y2*ee]}}const[he,pe,_e,Ae]=fe.box,be=E?fe.allPointsOccluded:H.isOccluded;let Pe=be;return Pe||(Pe=H.perspectiveRatio<this.perspectiveRatioCutoff),Pe||(Pe=!this.isInsideGrid(he,pe,_e,Ae)),Pe||l!=="always"&&this.grid.hitTest(he,pe,_e,Ae,l,O)?{box:[he,pe,_e,Ae],placeable:!1,offscreen:!1,occluded:be}:{box:[he,pe,_e,Ae],placeable:!0,offscreen:this.isOffscreen(he,pe,_e,Ae),occluded:be}}placeCollisionCircles(n,l,p,_,w,E,P,D,O,F,q,U,H,ee){const fe=[],he=new c.P(l.anchorX,l.anchorY),pe=this.getPerspectiveRatio(he.x,he.y,E,ee),_e=(O?w*this.transform.getPitchedTextCorrection(l.anchorX,l.anchorY,E)/pe:w*pe)/c.aA,Ae={getElevation:ee,pitchedLabelPlaneMatrix:P,lineVertexArray:p,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:he,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:H},be=kt(_e,_,l.lineOffsetX*_e,l.lineOffsetY*_e,!1,l,!1,Ae);let Pe=!1,Le=!1,xe=!0;if(be){const Ve=.5*q*pe+U,rt=new c.P(-100,-100),Ye=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Qe=new on,ot=be.first,zt=be.last;let Lt=[];for(let Mn=ot.path.length-1;Mn>=1;Mn--)Lt.push(ot.path[Mn]);for(let Mn=1;Mn<zt.path.length;Mn++)Lt.push(zt.path[Mn]);const bt=2.5*Ve;if(O){const Mn=this.projectPathToScreenSpace(Lt,Ae);Lt=Mn.some(Qn=>Qn.signedDistanceFromCamera<=0)?[]:Mn.map(Qn=>Qn.point)}let Zt=[];if(Lt.length>0){const Mn=Lt[0].clone(),Qn=Lt[0].clone();for(let Qr=1;Qr<Lt.length;Qr++)Mn.x=Math.min(Mn.x,Lt[Qr].x),Mn.y=Math.min(Mn.y,Lt[Qr].y),Qn.x=Math.max(Qn.x,Lt[Qr].x),Qn.y=Math.max(Qn.y,Lt[Qr].y);Zt=Mn.x>=rt.x&&Qn.x<=Ye.x&&Mn.y>=rt.y&&Qn.y<=Ye.y?[Lt]:Qn.x<rt.x||Mn.x>Ye.x||Qn.y<rt.y||Mn.y>Ye.y?[]:c.ax([Lt],rt.x,rt.y,Ye.x,Ye.y)}for(const Mn of Zt){Qe.reset(Mn,.25*Ve);let Qn=0;Qn=Qe.length<=.5*Ve?1:Math.ceil(Qe.paddedLength/bt)+1;for(let Qr=0;Qr<Qn;Qr++){const gr=Qr/Math.max(Qn-1,1),ni=Qe.lerp(gr),yr=ni.x+kr,_r=ni.y+kr;fe.push(yr,_r,Ve,0);const Ar=yr-Ve,Wi=_r-Ve,Zn=yr+Ve,Ki=_r+Ve;if(xe=xe&&this.isOffscreen(Ar,Wi,Zn,Ki),Le=Le||this.isInsideGrid(Ar,Wi,Zn,Ki),n!=="always"&&this.grid.hitTestCircle(yr,_r,Ve,n,F)&&(Pe=!0,!D))return{circles:[],offscreen:!1,collisionDetected:Pe}}}}return{circles:!D&&Pe||!Le||pe<this.perspectiveRatioCutoff?[]:fe,offscreen:xe,collisionDetected:Pe}}projectPathToScreenSpace(n,l){const p=function(_,w){const E=c.L();return c.ap(E,w.pitchedLabelPlaneMatrix),_.map(P=>{const D=Cn(P.x,P.y,E,w.getElevation),O=w.transform.projectTileCoordinates(D.point.x,D.point.y,w.unwrappedTileID,w.getElevation);return O.point.x=(.5*O.point.x+.5)*w.width,O.point.y=(.5*-O.point.y+.5)*w.height,O})}(n,l);return function(_){let w=0,E=0,P=0,D=0;for(let O=0;O<_.length;O++)_[O].isOccluded?(P=O+1,D=0):(D++,D>E&&(E=D,w=P));return _.slice(w,w+E)}(p)}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[],p=new c.a1;for(const q of n){const U=new c.P(q.x+kr,q.y+kr);p.extend(U),l.push(U)}const{minX:_,minY:w,maxX:E,maxY:P}=p,D=this.grid.query(_,w,E,P).concat(this.ignoredGrid.query(_,w,E,P)),O={},F={};for(const q of D){const U=q.key;if(O[U.bucketInstanceId]===void 0&&(O[U.bucketInstanceId]={}),O[U.bucketInstanceId][U.featureIndex])continue;const H=[new c.P(q.x1,q.y1),new c.P(q.x2,q.y1),new c.P(q.x2,q.y2),new c.P(q.x1,q.y2)];c.ay(l,H)&&(O[U.bucketInstanceId][U.featureIndex]=!0,F[U.bucketInstanceId]===void 0&&(F[U.bucketInstanceId]=[]),F[U.bucketInstanceId].push(U.featureIndex))}return F}insertCollisionBox(n,l,p,_,w,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:w,collisionGroupID:E,overlapMode:l},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,l,p,_,w,E){const P=p?this.ignoredGrid:this.grid,D={bucketInstanceId:_,featureIndex:w,collisionGroupID:E,overlapMode:l};for(let O=0;O<n.length;O+=4)P.insertCircle(D,n[O],n[O+1],n[O+2])}projectAndGetPerspectiveRatio(n,l,p,_,w){if(w){let E;_?(E=[n,l,_(n,l),1],c.av(E,E,w)):(E=[n,l,0,1],Do(E,E,w));const P=E[3];return{x:(E[0]/P+1)/2*this.transform.width+kr,y:(-E[1]/P+1)/2*this.transform.height+kr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/P*.5,isOccluded:!1,signedDistanceFromCamera:P}}{const E=this.transform.projectTileCoordinates(n,l,p,_);return{x:(E.point.x+1)/2*this.transform.width+kr,y:(1-E.point.y)/2*this.transform.height+kr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(n,l,p,_){const w=this.transform.projectTileCoordinates(n,l,p,_);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(n,l,p,_){return p<kr||n>=this.screenRightBoundary||_<kr||l>this.screenBottomBoundary}isInsideGrid(n,l,p,_){return p>=0&&n<this.gridRightBoundary&&_>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const n=c.af([]);return c.M(n,n,[-100,-100,0]),n}_projectCollisionBox(n,l,p,_,w,E,P,D,O,F,q){let U=1,H=0,ee=0,fe=1;const he=n.anchorPointX+P[0],pe=n.anchorPointY+P[1];if(E&&!w){const Lt=this.projectAndGetPerspectiveRatio(he+1,pe,_,O,q),bt=Lt.x-D.x,Zt=Math.atan((Lt.y-D.y)/bt)+(bt<0?Math.PI:0),Mn=Math.sin(Zt),Qn=Math.cos(Zt);U=Qn,H=Mn,ee=-Mn,fe=Qn}else if(!E&&w){const Lt=vn(this.transform);U=Lt.vecEast[0],H=Lt.vecEast[1],ee=Lt.vecSouth[0],fe=Lt.vecSouth[1]}let _e=D.x,Ae=D.y,be=l;w&&(_e=he,Ae=pe,be=Math.pow(2,-(this.transform.zoom-p.overscaledZ)),be*=this.transform.getPitchedTextCorrection(he,pe,_),F||(be*=c.ag(.5+D.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),F&&(_e+=U*F.x*be+ee*F.y*be,Ae+=H*F.x*be+fe*F.y*be);const Pe=n.x1*be,Le=n.x2*be,xe=(Pe+Le)/2,Ve=n.y1*be,rt=n.y2*be,Ye=(Ve+rt)/2,Qe=[{offsetX:Pe,offsetY:Ve},{offsetX:xe,offsetY:Ve},{offsetX:Le,offsetY:Ve},{offsetX:Le,offsetY:Ye},{offsetX:Le,offsetY:rt},{offsetX:xe,offsetY:rt},{offsetX:Pe,offsetY:rt},{offsetX:Pe,offsetY:Ye}];let ot=[];for(const{offsetX:Lt,offsetY:bt}of Qe)ot.push(new c.P(_e+U*Lt+ee*bt,Ae+H*Lt+fe*bt));let zt=!1;if(w){const Lt=ot.map(bt=>this.projectAndGetPerspectiveRatio(bt.x,bt.y,_,O,q));zt=Lt.some(bt=>!bt.isOccluded),ot=Lt.map(bt=>new c.P(bt.x,bt.y))}else zt=!0;return{box:c.az(ot),allPointsOccluded:!zt}}}class Ns{constructor(n,l,p,_){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?l:-l))):_&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ra{constructor(n,l,p,_,w){this.text=new Ns(n?n.text:null,l,p,w),this.icon=new Ns(n?n.icon:null,l,_,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class yi{constructor(n,l,p){this.text=n,this.icon=l,this.skipFade=p}}class Gi{constructor(n,l,p,_,w){this.bucketInstanceId=n,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=w}}class Dr{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const l=++this.maxGroupID;this.collisionGroups[n]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[n]}}function Lo(b,n,l,p,_){const{horizontalAlign:w,verticalAlign:E}=c.aG(b);return new c.P(-(w-.5)*n+p[0]*_,-(E-.5)*l+p[1]*_)}class zo{constructor(n,l,p,_,w){this.transform=n.clone(),this.terrain=l,this.collisionIndex=new Ll(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Dr(_),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const l=this.terrain;return l?(p,_)=>l.getElevation(n,p,_):null}getBucketParts(n,l,p,_){const w=p.getBucket(l),E=p.latestFeatureIndex;if(!w||!E||l.id!==w.layerIds[0])return;const P=p.collisionBoxArray,D=w.layers[0].layout,O=w.layers[0].paint,F=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),q=p.tileSize/c.$,U=p.tileID.toUnwrapped(),H=D.get("text-rotation-alignment")==="map",ee=c.aB(p,1,this.transform.zoom),fe=c.aC(this.collisionIndex.transform,p,O.get("text-translate"),O.get("text-translate-anchor")),he=c.aC(this.collisionIndex.transform,p,O.get("icon-translate"),O.get("icon-translate-anchor")),pe=Xt(H,this.transform,ee);this.retainedQueryData[w.bucketInstanceId]=new Gi(w.bucketInstanceId,E,w.sourceLayerIndex,w.index,p.tileID);const _e={bucket:w,layout:D,translationText:fe,translationIcon:he,unwrappedTileID:U,pitchedLabelPlaneMatrix:pe,scale:F,textPixelRatio:q,holdingForFade:p.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:c.am(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(_)for(const Ae of w.sortKeyRanges){const{sortKey:be,symbolInstanceStart:Pe,symbolInstanceEnd:Le}=Ae;n.push({sortKey:be,symbolInstanceStart:Pe,symbolInstanceEnd:Le,parameters:_e})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:_e})}attemptAnchorPlacement(n,l,p,_,w,E,P,D,O,F,q,U,H,ee,fe,he,pe,_e,Ae,be){const Pe=c.aD[n.textAnchor],Le=[n.textOffset0,n.textOffset1],xe=Lo(Pe,p,_,Le,w),Ve=this.collisionIndex.placeCollisionBox(l,U,D,O,F,P,E,he,q.predicate,Ae,xe,be);if((!_e||this.collisionIndex.placeCollisionBox(_e,U,D,O,F,P,E,pe,q.predicate,Ae,xe,be).placeable)&&Ve.placeable){let rt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(rt=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:Le,width:p,height:_,anchor:Pe,textBoxScale:w,prevAnchor:rt},this.markUsedJustification(ee,Pe,H,fe),ee.allowVerticalPlacement&&(this.markUsedOrientation(ee,fe,H),this.placedOrientations[H.crossTileID]=fe),{shift:xe,placedGlyphBoxes:Ve}}}placeLayerBucketPart(n,l,p){const{bucket:_,layout:w,translationText:E,translationIcon:P,unwrappedTileID:D,pitchedLabelPlaneMatrix:O,textPixelRatio:F,holdingForFade:q,collisionBoxArray:U,partiallyEvaluatedTextSize:H,collisionGroup:ee}=n.parameters,fe=w.get("text-optional"),he=w.get("icon-optional"),pe=c.aE(w,"text-overlap","text-allow-overlap"),_e=pe==="always",Ae=c.aE(w,"icon-overlap","icon-allow-overlap"),be=Ae==="always",Pe=w.get("text-rotation-alignment")==="map",Le=w.get("text-pitch-alignment")==="map",xe=w.get("icon-text-fit")!=="none",Ve=w.get("symbol-z-order")==="viewport-y",rt=_e&&(be||!_.hasIconData()||he),Ye=be&&(_e||!_.hasTextData()||fe);!_.collisionArrays&&U&&_.deserializeCollisionBoxes(U);const Qe=this.retainedQueryData[_.bucketInstanceId].tileID,ot=this._getTerrainElevationFunc(Qe),zt=this.transform.getFastPathSimpleProjectionMatrix(Qe),Lt=(bt,Zt,Mn)=>{var Qn,Qr;if(l[bt.crossTileID])return;if(q)return void(this.placements[bt.crossTileID]=new yi(!1,!1,!1));let gr=!1,ni=!1,yr=!0,_r=null,Ar={box:null,placeable:!1,offscreen:null,occluded:!1},Wi={placeable:!1},Zn=null,Ki=null,pa=null,ru=0,bl=0,Gs=0;Zt.textFeatureIndex?ru=Zt.textFeatureIndex:bt.useRuntimeCollisionCircles&&(ru=bt.featureIndex),Zt.verticalTextFeatureIndex&&(bl=Zt.verticalTextFeatureIndex);const Hs=Zt.textBox;if(Hs){const ma=Or=>{let vr=c.an.horizontal;if(_.allowVerticalPlacement&&!Or&&this.prevPlacement){const la=this.prevPlacement.placedOrientations[bt.crossTileID];la&&(this.placedOrientations[bt.crossTileID]=la,vr=la,this.markUsedOrientation(_,vr,bt))}return vr},Zs=(Or,vr)=>{if(_.allowVerticalPlacement&&bt.numVerticalGlyphVertices>0&&Zt.verticalTextBox){for(const la of _.writingModes)if(la===c.an.vertical?(Ar=vr(),Wi=Ar):Ar=Or(),Ar&&Ar.placeable)break}else Ar=Or()},xl=bt.textAnchorOffsetStartIndex,Zu=bt.textAnchorOffsetEndIndex;if(Zu===xl){const Or=(vr,la)=>{const oi=this.collisionIndex.placeCollisionBox(vr,pe,F,Qe,D,Le,Pe,E,ee.predicate,ot,void 0,zt);return oi&&oi.placeable&&(this.markUsedOrientation(_,la,bt),this.placedOrientations[bt.crossTileID]=la),oi};Zs(()=>Or(Hs,c.an.horizontal),()=>{const vr=Zt.verticalTextBox;return _.allowVerticalPlacement&&bt.numVerticalGlyphVertices>0&&vr?Or(vr,c.an.vertical):{box:null,offscreen:null}}),ma(Ar&&Ar.placeable)}else{let Or=c.aD[(Qr=(Qn=this.prevPlacement)===null||Qn===void 0?void 0:Qn.variableOffsets[bt.crossTileID])===null||Qr===void 0?void 0:Qr.anchor];const vr=(oi,Dh,im)=>{const kd=oi.x2-oi.x1,Wo=oi.y2-oi.y1,Wu=bt.textBoxScale,Fi=xe&&Ae==="never"?Dh:null;let Gr=null,Ia=pe==="never"?1:2,Dd="never";Or&&Ia++;for(let Ga=0;Ga<Ia;Ga++){for(let To=xl;To<Zu;To++){const wi=_.textAnchorOffsets.get(To);if(Or&&wi.textAnchor!==Or)continue;const au=this.attemptAnchorPlacement(wi,oi,kd,Wo,Wu,Pe,Le,F,Qe,D,ee,Dd,bt,_,im,E,P,Fi,ot);if(au&&(Gr=au.placedGlyphBoxes,Gr&&Gr.placeable))return gr=!0,_r=au.shift,Gr}Or?Or=null:Dd=pe}return p&&!Gr&&(Gr={box:this.collisionIndex.placeCollisionBox(Hs,"always",F,Qe,D,Le,Pe,E,ee.predicate,ot,void 0,zt).box,offscreen:!1,placeable:!1,occluded:!1}),Gr};Zs(()=>vr(Hs,Zt.iconBox,c.an.horizontal),()=>{const oi=Zt.verticalTextBox;return _.allowVerticalPlacement&&(!Ar||!Ar.placeable)&&bt.numVerticalGlyphVertices>0&&oi?vr(oi,Zt.verticalIconBox,c.an.vertical):{box:null,occluded:!0,offscreen:null}}),Ar&&(gr=Ar.placeable,yr=Ar.offscreen);const la=ma(Ar&&Ar.placeable);if(!gr&&this.prevPlacement){const oi=this.prevPlacement.variableOffsets[bt.crossTileID];oi&&(this.variableOffsets[bt.crossTileID]=oi,this.markUsedJustification(_,oi.anchor,bt,la))}}}if(Zn=Ar,gr=Zn&&Zn.placeable,yr=Zn&&Zn.offscreen,bt.useRuntimeCollisionCircles){const ma=_.text.placedSymbolArray.get(bt.centerJustifiedTextSymbolIndex),Zs=c.ao(_.textSizeData,H,ma),xl=w.get("text-padding");Ki=this.collisionIndex.placeCollisionCircles(pe,ma,_.lineVertexArray,_.glyphOffsetArray,Zs,D,O,p,Le,ee.predicate,bt.collisionCircleDiameter,xl,E,ot),Ki.circles.length&&Ki.collisionDetected&&!p&&c.w("Collisions detected, but collision boxes are not shown"),gr=_e||Ki.circles.length>0&&!Ki.collisionDetected,yr=yr&&Ki.offscreen}if(Zt.iconFeatureIndex&&(Gs=Zt.iconFeatureIndex),Zt.iconBox){const ma=Zs=>this.collisionIndex.placeCollisionBox(Zs,Ae,F,Qe,D,Le,Pe,P,ee.predicate,ot,xe&&_r?_r:void 0,zt);Wi&&Wi.placeable&&Zt.verticalIconBox?(pa=ma(Zt.verticalIconBox),ni=pa.placeable):(pa=ma(Zt.iconBox),ni=pa.placeable),yr=yr&&pa.offscreen}const iu=fe||bt.numHorizontalGlyphVertices===0&&bt.numVerticalGlyphVertices===0,Bc=he||bt.numIconVertices===0;iu||Bc?Bc?iu||(ni=ni&&gr):gr=ni&&gr:ni=gr=ni&&gr;const Hu=ni&&pa.placeable;if(gr&&Zn.placeable&&this.collisionIndex.insertCollisionBox(Zn.box,pe,w.get("text-ignore-placement"),_.bucketInstanceId,Wi&&Wi.placeable&&bl?bl:ru,ee.ID),Hu&&this.collisionIndex.insertCollisionBox(pa.box,Ae,w.get("icon-ignore-placement"),_.bucketInstanceId,Gs,ee.ID),Ki&&gr&&this.collisionIndex.insertCollisionCircles(Ki.circles,pe,w.get("text-ignore-placement"),_.bucketInstanceId,ru,ee.ID),p&&this.storeCollisionData(_.bucketInstanceId,Mn,Zt,Zn,pa,Ki),bt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[bt.crossTileID]=new yi((gr||rt)&&!(Zn!=null&&Zn.occluded),(ni||Ye)&&!(pa!=null&&pa.occluded),yr||_.justReloaded),l[bt.crossTileID]=!0};if(Ve){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const bt=_.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Zt=bt.length-1;Zt>=0;--Zt){const Mn=bt[Zt];Lt(_.symbolInstances.get(Mn),_.collisionArrays[Mn],Mn)}}else for(let bt=n.symbolInstanceStart;bt<n.symbolInstanceEnd;bt++)Lt(_.symbolInstances.get(bt),_.collisionArrays[bt],bt);_.justReloaded=!1}storeCollisionData(n,l,p,_,w,E){if(p.textBox||p.iconBox){let P,D;this.collisionBoxArrays.has(n)?P=this.collisionBoxArrays.get(n):(P=new Map,this.collisionBoxArrays.set(n,P)),P.has(l)?D=P.get(l):(D={text:null,icon:null},P.set(l,D)),p.textBox&&(D.text=_.box),p.iconBox&&(D.icon=w.box)}if(E){let P=this.collisionCircleArrays[n];P===void 0&&(P=this.collisionCircleArrays[n]=[]);for(let D=0;D<E.circles.length;D+=4)P.push(E.circles[D+0]-kr),P.push(E.circles[D+1]-kr),P.push(E.circles[D+2]),P.push(E.collisionDetected?1:0)}}markUsedJustification(n,l,p,_){let w;w=_===c.an.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[c.aF(l)];const E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const P of E)P>=0&&(n.text.placedSymbolArray.get(P).crossTileID=w>=0&&P!==w?0:p.crossTileID)}markUsedOrientation(n,l,p){const _=l===c.an.horizontal||l===c.an.horizontalOnly?l:0,w=l===c.an.vertical?l:0,E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const P of E)n.text.placedSymbolArray.get(P).placedOrientation=_;p.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const _=l?l.symbolFadeChange(n):1,w=l?l.opacities:{},E=l?l.variableOffsets:{},P=l?l.placedOrientations:{};for(const D in this.placements){const O=this.placements[D],F=w[D];F?(this.opacities[D]=new ra(F,_,O.text,O.icon),p=p||O.text!==F.text.placed||O.icon!==F.icon.placed):(this.opacities[D]=new ra(null,_,O.text,O.icon,O.skipFade),p=p||O.text||O.icon)}for(const D in w){const O=w[D];if(!this.opacities[D]){const F=new ra(O,_,!1,!1);F.isHidden()||(this.opacities[D]=F,p=p||O.text.placed||O.icon.placed)}}for(const D in E)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=E[D]);for(const D in P)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=P[D]);if(l&&l.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:n)}updateLayerOpacities(n,l){const p={};for(const _ of l){const w=_.getBucket(n);w&&_.latestFeatureIndex&&n.id===w.layerIds[0]&&this.updateBucketOpacities(w,_.tileID,p,_.collisionBoxArray)}}updateBucketOpacities(n,l,p,_){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const w=n.layers[0],E=w.layout,P=new ra(null,0,!1,!1,!0),D=E.get("text-allow-overlap"),O=E.get("icon-allow-overlap"),F=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),q=E.get("text-rotation-alignment")==="map",U=E.get("text-pitch-alignment")==="map",H=E.get("icon-text-fit")!=="none",ee=new ra(null,0,D&&(O||!n.hasIconData()||E.get("icon-optional")),O&&(D||!n.hasTextData()||E.get("text-optional")),!0);!n.collisionArrays&&_&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(_);const fe=(pe,_e,Ae)=>{for(let be=0;be<_e/4;be++)pe.opacityVertexArray.emplaceBack(Ae);pe.hasVisibleVertices=pe.hasVisibleVertices||Ae!==wu},he=this.collisionBoxArrays.get(n.bucketInstanceId);for(let pe=0;pe<n.symbolInstances.length;pe++){const _e=n.symbolInstances.get(pe),{numHorizontalGlyphVertices:Ae,numVerticalGlyphVertices:be,crossTileID:Pe}=_e;let Le=this.opacities[Pe];p[Pe]?Le=P:Le||(Le=ee,this.opacities[Pe]=Le),p[Pe]=!0;const xe=_e.numIconVertices>0,Ve=this.placedOrientations[_e.crossTileID],rt=Ve===c.an.vertical,Ye=Ve===c.an.horizontal||Ve===c.an.horizontalOnly;if(Ae>0||be>0){const ot=zl(Le.text);fe(n.text,Ae,rt?wu:ot),fe(n.text,be,Ye?wu:ot);const zt=Le.text.isHidden();[_e.rightJustifiedTextSymbolIndex,_e.centerJustifiedTextSymbolIndex,_e.leftJustifiedTextSymbolIndex].forEach(Zt=>{Zt>=0&&(n.text.placedSymbolArray.get(Zt).hidden=zt||rt?1:0)}),_e.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(_e.verticalPlacedTextSymbolIndex).hidden=zt||Ye?1:0);const Lt=this.variableOffsets[_e.crossTileID];Lt&&this.markUsedJustification(n,Lt.anchor,_e,Ve);const bt=this.placedOrientations[_e.crossTileID];bt&&(this.markUsedJustification(n,"left",_e,bt),this.markUsedOrientation(n,bt,_e))}if(xe){const ot=zl(Le.icon),zt=!(H&&_e.verticalPlacedIconSymbolIndex&&rt);_e.placedIconSymbolIndex>=0&&(fe(n.icon,_e.numIconVertices,zt?ot:wu),n.icon.placedSymbolArray.get(_e.placedIconSymbolIndex).hidden=Le.icon.isHidden()),_e.verticalPlacedIconSymbolIndex>=0&&(fe(n.icon,_e.numVerticalIconVertices,zt?wu:ot),n.icon.placedSymbolArray.get(_e.verticalPlacedIconSymbolIndex).hidden=Le.icon.isHidden())}const Qe=he&&he.has(pe)?he.get(pe):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const ot=n.collisionArrays[pe];if(ot){let zt=new c.P(0,0);if(ot.textBox||ot.verticalTextBox){let Lt=!0;if(F){const bt=this.variableOffsets[Pe];bt?(zt=Lo(bt.anchor,bt.width,bt.height,bt.textOffset,bt.textBoxScale),q&&zt._rotate(U?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Lt=!1}if(ot.textBox||ot.verticalTextBox){let bt;ot.textBox&&(bt=rt),ot.verticalTextBox&&(bt=Ye),al(n.textCollisionBox.collisionVertexArray,Le.text.placed,!Lt||bt,Qe.text,zt.x,zt.y)}}if(ot.iconBox||ot.verticalIconBox){const Lt=!!(!Ye&&ot.verticalIconBox);let bt;ot.iconBox&&(bt=Lt),ot.verticalIconBox&&(bt=!Lt),al(n.iconCollisionBox.collisionVertexArray,Le.icon.placed,bt,Qe.icon,H?zt.x:0,H?zt.y:0)}}}}if(n.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);n.bucketInstanceId in this.collisionCircleArrays&&(n.collisionCircleArray=this.collisionCircleArrays[n.bucketInstanceId],delete this.collisionCircleArrays[n.bucketInstanceId])}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>n}setStale(){this.stale=!0}}function al(b,n,l,p,_,w){p&&p.length!==0||(p=[0,0,0,0]);const E=p[0]-kr,P=p[1]-kr,D=p[2]-kr,O=p[3]-kr;b.emplaceBack(n?1:0,l?1:0,_||0,w||0,E,P),b.emplaceBack(n?1:0,l?1:0,_||0,w||0,D,P),b.emplaceBack(n?1:0,l?1:0,_||0,w||0,D,O),b.emplaceBack(n?1:0,l?1:0,_||0,w||0,E,O)}const oo=Math.pow(2,25),us=Math.pow(2,24),xa=Math.pow(2,17),bc=Math.pow(2,16),dd=Math.pow(2,9),lo=Math.pow(2,8),xc=Math.pow(2,1);function zl(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const n=b.placed?1:0,l=Math.floor(127*b.opacity);return l*oo+n*us+l*xa+n*bc+l*dd+n*lo+l*xc+n}const wu=0;class Di{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,l,p,_,w){const E=this._bucketParts;for(;this._currentTileIndex<n.length;)if(l.getBucketParts(E,_,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((P,D)=>P.sortKey-D.sortKey));this._currentPartIndex<E.length;)if(l.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,w())return!0;return!1}}class Ya{constructor(n,l,p,_,w,E,P,D){this.placement=new zo(n,l,E,P,D),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(n,l,p){const _=$.now(),w=()=>!this._forceFullPlacement&&$.now()-_>2;for(;this._currentPlacementIndex>=0;){const E=l[n[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=P)&&(!E.maxzoom||E.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new Di(E)),this._inProgressLayer.continuePlacement(p[E.source],this.placement,this._showCollisionBoxes,E,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Bs=512/c.$/2;class Oo{constructor(n,l,p){this.tileID=n,this.bucketInstanceId=p,this._symbolsByKey={};const _=new Map;for(let w=0;w<l.length;w++){const E=l.get(w),P=E.key,D=_.get(P);D?D.push(E):_.set(P,[E])}for(const[w,E]of _){const P={positions:E.map(D=>({x:Math.floor(D.anchorX*Bs),y:Math.floor(D.anchorY*Bs)})),crossTileIDs:E.map(D=>D.crossTileID)};if(P.positions.length>128){const D=new c.aH(P.positions.length,16,Uint16Array);for(const{x:O,y:F}of P.positions)D.add(O,F);D.finish(),delete P.positions,P.index=D}this._symbolsByKey[w]=P}}getScaledCoordinates(n,l){const{x:p,y:_,z:w}=this.tileID.canonical,{x:E,y:P,z:D}=l.canonical,O=Bs/Math.pow(2,D-w),F=(P*c.$+n.anchorY)*O,q=_*c.$*Bs;return{x:Math.floor((E*c.$+n.anchorX)*O-p*c.$*Bs),y:Math.floor(F-q)}}findMatches(n,l,p){const _=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let w=0;w<n.length;w++){const E=n.get(w);if(E.crossTileID)continue;const P=this._symbolsByKey[E.key];if(!P)continue;const D=this.getScaledCoordinates(E,l);if(P.index){const O=P.index.range(D.x-_,D.y-_,D.x+_,D.y+_).sort();for(const F of O){const q=P.crossTileIDs[F];if(!p[q]){p[q]=!0,E.crossTileID=q;break}}}else if(P.positions)for(let O=0;O<P.positions.length;O++){const F=P.positions[O],q=P.crossTileIDs[O];if(Math.abs(F.x-D.x)<=_&&Math.abs(F.y-D.y)<=_&&!p[q]){p[q]=!0,E.crossTileID=q;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class uo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Sr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const l=Math.round((n-this.lng)/360);if(l!==0)for(const p in this.indexes){const _=this.indexes[p],w={};for(const E in _){const P=_[E];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+l),w[P.tileID.key]=P}this.indexes[p]=w}this.lng=n}addBucket(n,l,p){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let w=0;w<l.symbolInstances.length;w++)l.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const _=this.usedCrossTileIDs[n.overscaledZ];for(const w in this.indexes){const E=this.indexes[w];if(Number(w)>n.overscaledZ)for(const P in E){const D=E[P];D.tileID.isChildOf(n)&&D.findMatches(l.symbolInstances,n,_)}else{const P=E[n.scaledTo(Number(w)).key];P&&P.findMatches(l.symbolInstances,n,_)}}for(let w=0;w<l.symbolInstances.length;w++){const E=l.symbolInstances.get(w);E.crossTileID||(E.crossTileID=p.generate(),_[E.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Oo(n,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(n,l){for(const p of l.getCrossTileIDsLists())for(const _ of p)delete this.usedCrossTileIDs[n][_]}removeStaleBuckets(n){let l=!1;for(const p in this.indexes){const _=this.indexes[p];for(const w in _)n[_[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[w]),delete _[w],l=!0)}return l}}class No{constructor(){this.layerIndexes={},this.crossTileIDs=new uo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,l,p){let _=this.layerIndexes[n.id];_===void 0&&(_=this.layerIndexes[n.id]=new Sr);let w=!1;const E={};_.handleWrapJump(p);for(const P of l){const D=P.getBucket(n);D&&n.id===D.layerIds[0]&&(D.bucketInstanceId||(D.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(P.tileID,D,this.crossTileIDs)&&(w=!0),E[D.bucketInstanceId]=!0)}return _.removeStaleBuckets(E)&&(w=!0),w}pruneUnusedLayers(n){const l={};n.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}var Na="void main() {fragColor=vec4(1.0);}";const wa={prelude:Ln(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Ln("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Ln("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Ln(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Ln(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ln(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ln(Na,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Ln(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Ln(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ln("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ln("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Ln(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(textureSize(u_elevation_stops,0)[0]);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int num_elevation_stops=textureSize(u_elevation_stops,0)[0];int r=(num_elevation_stops-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(textureSize(u_color_stops,0)[0]);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Ln("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Ln(Na,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Ln(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Ln(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Ln(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Ln(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ln(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ln(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ln(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ln(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Ln(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ln(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ln(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ln(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ln(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Ln(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ln(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ln(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ln("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ln("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ln("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Ln("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Ln(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Ln("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ln(b,n){const l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=n.match(/in ([\w]+) ([\w]+)/g),_=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=w?w.concat(_):_,P={};return{fragmentSource:b=b.replace(l,(D,O,F,q,U)=>(P[U]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
in ${F} ${q} ${U};
#else
uniform ${F} ${q} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${F} ${q} ${U} = u_${U};
#endif
`)),vertexSource:n=n.replace(l,(D,O,F,q,U)=>{const H=q==="float"?"vec2":"vec4",ee=U.match(/color/)?"color":H;return P[U]?O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${F} ${H} a_${U};
out ${F} ${q} ${U};
#else
uniform ${F} ${q} u_${U};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${F} ${q} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${ee}(a_${U}, u_${U}_t);
#else
    ${F} ${q} ${U} = u_${U};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${F} ${H} a_${U};
#else
uniform ${F} ${q} u_${U};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${F} ${q} ${U} = a_${U};
#else
    ${F} ${q} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${F} ${q} ${U} = unpack_mix_${ee}(a_${U}, u_${U}_t);
#else
    ${F} ${q} ${U} = u_${U};
#endif
`}),staticAttributes:p,staticUniforms:E}}class cs{constructor(n,l,p){this.vertexBuffer=n,this.indexBuffer=l,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var hs=c.aI([{name:"a_pos",type:"Int16",components:2}]);const sl="#define PROJECTION_MERCATOR",mh="mercator";class Ol{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return mh}get shaderDefine(){return sl}get shaderPreludeCode(){return wa.projectionMercator}get vertexShaderPreludeCode(){return wa.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(n){}getMeshFromTileID(n,l,p,_,w){if(this._cachedMesh)return this._cachedMesh;const E=new c.aK;E.emplaceBack(0,0),E.emplaceBack(c.$,0),E.emplaceBack(0,c.$),E.emplaceBack(c.$,c.$);const P=n.createVertexBuffer(E,hs.members),D=c.aL.simpleSegment(0,0,4,2),O=new c.aM;O.emplaceBack(1,0,2),O.emplaceBack(1,2,3);const F=n.createIndexBuffer(O);return this._cachedMesh=new cs(P,F,D),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(n){}}class Li{constructor(n=0,l=0,p=0,_=0){if(isNaN(n)||n<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=l,this.left=p,this.right=_}interpolate(n,l,p){return l.top!=null&&n.top!=null&&(this.top=c.C.number(n.top,l.top,p)),l.bottom!=null&&n.bottom!=null&&(this.bottom=c.C.number(n.bottom,l.bottom,p)),l.left!=null&&n.left!=null&&(this.left=c.C.number(n.left,l.left,p)),l.right!=null&&n.right!=null&&(this.right=c.C.number(n.right,l.right,p)),this}getCenter(n,l){const p=c.ag((this.left+n-this.right)/2,0,n),_=c.ag((this.top+l-this.bottom)/2,0,l);return new c.P(p,_)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Li(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function zi(b,n){if(!b.renderWorldCopies||b.lngRange)return;const l=n.lng-b.center.lng;n.lng+=l>180?-360:l<-180?360:0}function wn(b){return Math.max(0,Math.floor(b))}class ds{constructor(n,l,p,_,w,E){this._callbacks=n,this._tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=l||0,this._maxZoom=p||22,this._minPitch=_??0,this._maxPitch=w??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=wn(this._zoom),this._scale=c.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Li,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(n,l,p){this._latRange=n.latRange,this._lngRange=n.lngRange,this._width=n.width,this._height=n.height,this._center=n.center,this._elevation=n.elevation,this._minElevationForCurrentTile=n.minElevationForCurrentTile,this._zoom=n.zoom,this._tileZoom=wn(this._zoom),this._scale=c.ae(this._zoom),this._bearingInRadians=n.bearingInRadians,this._fovInRadians=n.fovInRadians,this._pitchInRadians=n.pitchInRadians,this._rollInRadians=n.rollInRadians,this._unmodified=n.unmodified,this._edgeInsets=new Li(n.padding.top,n.padding.bottom,n.padding.left,n.padding.right),this._minZoom=n.minZoom,this._maxZoom=n.maxZoom,this._minPitch=n.minPitch,this._maxPitch=n.maxPitch,this._renderWorldCopies=n.renderWorldCopies,this._cameraToCenterDistance=n.cameraToCenterDistance,this._nearZ=n.nearZ,this._farZ=n.farZ,this._autoCalculateNearFarZ=!p&&n.autoCalculateNearFarZ,l&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(n){this._minElevationForCurrentTile=n}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(n){this._minZoom!==n&&(this._minZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(n){this._minPitch!==n&&(this._minPitch=n,this.setPitch(Math.max(this.pitch,n)))}get maxPitch(){return this._maxPitch}setMaxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.setPitch(Math.min(this.pitch,n)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(n){const l=c.aN(n,-180,180)*Math.PI/180;var p,_,w,E,P,D,O,F,q;this._bearingInRadians!==l&&(this._unmodified=!1,this._bearingInRadians=l,this._calcMatrices(),this._rotationMatrix=R(),p=this._rotationMatrix,w=-this._bearingInRadians,E=(_=this._rotationMatrix)[0],P=_[1],D=_[2],O=_[3],F=Math.sin(w),q=Math.cos(w),p[0]=E*q+D*F,p[1]=P*q+O*F,p[2]=E*-F+D*q,p[3]=P*-F+O*q)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(n){const l=c.ag(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==l&&(this._unmodified=!1,this._pitchInRadians=l,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(n){const l=n/180*Math.PI;this._rollInRadians!==l&&(this._unmodified=!1,this._rollInRadians=l,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aO(this._fovInRadians)}setFov(n){n=c.ag(n,.1,150),this.fov!==n&&(this._unmodified=!1,this._fovInRadians=c.ad(n),this._calcMatrices())}get zoom(){return this._zoom}setZoom(n){const l=this.getConstrained(this._center,n).zoom;this._zoom!==l&&(this._unmodified=!1,this._zoom=l,this._tileZoom=Math.max(0,Math.floor(l)),this._scale=c.ae(l),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(n,l){this._autoCalculateNearFarZ=!1,this._nearZ=n,this._farZ=l,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,l,p){this._unmodified=!1,this._edgeInsets.interpolate(n,l,p),this._constrain(),this._calcMatrices()}resize(n,l,p=!0){this._width=n,this._height=l,p&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Tr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(n){n?(this._lngRange=[n.getWest(),n.getEast()],this._latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,c.ah])}getConstrained(n,l){return this._callbacks.getConstrained(n,l)}getCameraQueryGeometry(n,l){if(l.length===1)return[l[0],n];{const{minX:p,minY:_,maxX:w,maxY:E}=c.a1.fromPoints(l).extend(n);return[new c.P(p,_),new c.P(w,_),new c.P(w,E),new c.P(p,E),new c.P(p,_)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:l,zoom:p}=this.getConstrained(this.center,this.zoom);this.setCenter(l),this.setZoom(p),this._unmodified=n,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let n=c.af(new Float64Array(16));c.N(n,n,[this._width/2,-this._height/2,1]),c.M(n,n,[1,-1,0]),this._clipSpaceToPixelsMatrix=n,n=c.af(new Float64Array(16)),c.N(n,n,[1,-1,1]),c.M(n,n,[-1,-1,0]),c.N(n,n,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=n,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(n,l,p,_){const w=p!==void 0?p:this.bearing,E=_=_!==void 0?_:this.pitch,P=c.a0.fromLngLat(n,l),D=-Math.cos(c.ad(E)),O=Math.sin(c.ad(E)),F=O*Math.sin(c.ad(w)),q=-O*Math.cos(c.ad(w));let U=this.elevation;const H=l-U;let ee;D*H>=0||Math.abs(D)<.1?(ee=1e4,U=l+ee*D):ee=-H/D;let fe,he,pe=c.aP(1,P.y),_e=0;do{if(_e+=1,_e>10)break;he=ee/pe,fe=new c.a0(P.x+F*he,P.y+q*he),pe=1/fe.meterInMercatorCoordinateUnits()}while(Math.abs(ee-he*pe)>1e-12);return{center:fe.toLngLat(),elevation:U,zoom:c.aj(this.height/2/Math.tan(this.fovInRadians/2)/he/this.tileSize)}}recalculateZoomAndCenter(n){if(this.elevation-n==0)return;const l=c.ai(1,this.center.lat)*this.worldSize,p=this.cameraToCenterDistance/l,_=c.a0.fromLngLat(this.center,this.elevation),w=Te(this.center,this.elevation,this.pitch,this.bearing,p);this._elevation=n;const E=this.calculateCenterFromCameraLngLatAlt(w.toLngLat(),c.aP(w.z,_.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const n=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(n*Math.sin(this.rollInRadians),n*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const n=c.ai(1,this.center.lat)*this.worldSize;return Te(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/n).toLngLat()}getMercatorTileCoordinates(n){if(!n)return[0,0,1,1];const l=n.canonical.z>=0?1<<n.canonical.z:Math.pow(2,n.canonical.z);return[n.canonical.x/l,n.canonical.y/l,1/l/c.$,1/l/c.$]}}class Nl{constructor(n,l){this.min=n,this.max=l,this.center=c.aQ([],c.aR([],this.min,this.max),.5)}quadrant(n){const l=[n%2==0,n<2],p=c.aS(this.min),_=c.aS(this.max);for(let w=0;w<l.length;w++)p[w]=l[w]?this.min[w]:this.center[w],_[w]=l[w]?this.center[w]:this.max[w];return _[2]=this.max[2],new Nl(p,_)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersectsFrustum(n){let l=!0;for(let p=0;p<n.planes.length;p++){const _=this.intersectsPlane(n.planes[p]);if(_===0)return 0;_===1&&(l=!1)}return l?2:n.aabb.min[0]>this.max[0]||n.aabb.min[1]>this.max[1]||n.aabb.min[2]>this.max[2]||n.aabb.max[0]<this.min[0]||n.aabb.max[1]<this.min[1]||n.aabb.max[2]<this.min[2]?0:1}intersectsPlane(n){let l=n[3],p=n[3];for(let _=0;_<3;_++)n[_]>0?(l+=n[_]*this.min[_],p+=n[_]*this.max[_]):(p+=n[_]*this.min[_],l+=n[_]*this.max[_]);return l>=0?2:p<0?0:1}}class Fs{distanceToTile2d(n,l,p,_){const w=_.distanceX([n,l]),E=_.distanceY([n,l]);return Math.hypot(w,E)}getWrap(n,l,p){return p}getTileBoundingVolume(n,l,p,_){var w,E;let P=p,D=p;if(_!=null&&_.terrain){const F=new c.Z(n.z,l,n.z,n.x,n.y),q=_.terrain.getMinMaxElevation(F);P=(w=q.minElevation)!==null&&w!==void 0?w:p,D=(E=q.maxElevation)!==null&&E!==void 0?E:p}const O=1<<n.z;return new Nl([l+n.x/O,n.y/O,P],[l+(n.x+1)/O,(n.y+1)/O,D])}allowVariableZoom(n,l){const p=n.fov*(Math.abs(Math.cos(n.rollInRadians))*n.height+Math.abs(Math.sin(n.rollInRadians))*n.width)/n.height,_=c.ag(78.5-p/2,0,60);return!!l.terrain||n.pitch>_}allowWorldCopies(){return!0}prepareNextFrame(){}}class Hi{constructor(n,l,p){this.points=n,this.planes=l,this.aabb=p}static fromInvProjectionMatrix(n,l=1,p=0,_,w){const E=w?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],P=Math.pow(2,p),D=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(U=>function(H,ee,fe,he){const pe=c.av([],H,ee),_e=1/pe[3]/fe*he;return c.aX(pe,pe,[_e,_e,1/pe[3],_e])}(U,n,l,P));_&&function(U,H,ee,fe){const he=fe?4:0,pe=fe?0:4;let _e=0;const Ae=[],be=[];for(let xe=0;xe<4;xe++){const Ve=c.aT([],U[xe+pe],U[xe+he]),rt=c.aY(Ve);c.aQ(Ve,Ve,1/rt),Ae.push(rt),be.push(Ve)}for(let xe=0;xe<4;xe++){const Ve=c.aZ(U[xe+he],be[xe],ee);_e=Ve!==null&&Ve>=0?Math.max(_e,Ve):Math.max(_e,Ae[xe])}const Pe=function(xe,Ve){const rt=c.aT([],xe[Ve[0]],xe[Ve[1]]),Ye=c.aT([],xe[Ve[2]],xe[Ve[1]]),Qe=[0,0,0,0];return c.aU(Qe,c.aV([],rt,Ye)),Qe[3]=-c.aW(Qe,xe[Ve[0]]),Qe}(U,H),Le=function(xe,Ve){const rt=c.a_(xe),Ye=c.a$([],xe,1/rt),Qe=c.aT([],Ve,c.aQ([],Ye,c.aW(Ve,Ye))),ot=c.a_(Qe);if(ot>0){const zt=Math.sqrt(1-Ye[3]*Ye[3]),Lt=c.aQ([],Ye,-Ye[3]),bt=c.aR([],Lt,c.aQ([],Qe,zt/ot));return c.b0(Ve,bt)}return null}(ee,Pe);if(Le!==null){const xe=Le/c.aW(be[0],Pe);_e=Math.min(_e,xe)}for(let xe=0;xe<4;xe++){const Ve=Math.min(_e,Ae[xe]);U[xe+pe]=[U[xe+he][0]+be[xe][0]*Ve,U[xe+he][1]+be[xe][1]*Ve,U[xe+he][2]+be[xe][2]*Ve,1]}}(D,E[0],_,w);const O=E.map(U=>{const H=c.aT([],D[U[0]],D[U[1]]),ee=c.aT([],D[U[2]],D[U[1]]),fe=c.aU([],c.aV([],H,ee)),he=-c.aW(fe,D[U[1]]);return fe.concat(he)}),F=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],q=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const U of D)for(let H=0;H<3;H++)F[H]=Math.min(F[H],U[H]),q[H]=Math.max(q[H],U[H]);return new Hi(D,O,new Nl(F,q))}}class Ur{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,l,p){return this._helper.interpolatePadding(n,l,p)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,l,p=!0){this._helper.resize(n,l,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,l){this._helper.overrideNearFarZ(n,l)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n,l){}constructor(n,l,p,_,w){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new ds({calcMatrices:()=>{this._calcMatrices()},getConstrained:(E,P)=>this.getConstrained(E,P)},n,l,p,_,w),this._coveringTilesDetailsProvider=new Fs}clone(){const n=new Ur;return n.apply(this),n}apply(n,l,p){this._helper.apply(n,l,p)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(n){const l=[new c.b1(0,n)];if(this._helper._renderWorldCopies){const p=this.screenPointToMercatorCoordinate(new c.P(0,0)),_=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),P=Math.floor(Math.min(p.x,_.x,w.x,E.x)),D=Math.floor(Math.max(p.x,_.x,w.x,E.x)),O=1;for(let F=P-O;F<=D+O;F++)F!==0&&l.push(new c.b1(F,n))}return l}getCameraFrustum(){return Hi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){const l=this.screenPointToLocation(this.centerPoint,n),p=n?n.getElevationForLngLatZoom(l,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(p)}setLocationAtPoint(n,l){const p=c.ai(this.elevation,this.center.lat),_=this.screenPointToMercatorCoordinateAtZ(l,p),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,p),E=c.a0.fromLngLat(n),P=new c.a0(E.x-(_.x-w.x),E.y-(_.y-w.y));this.setCenter(P==null?void 0:P.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(n,l){return l?this.coordinatePoint(c.a0.fromLngLat(n),l.getElevationForLngLatZoom(n,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a0.fromLngLat(n))}screenPointToLocation(n,l){var p;return(p=this.screenPointToMercatorCoordinate(n,l))===null||p===void 0?void 0:p.toLngLat()}screenPointToMercatorCoordinate(n,l){if(l){const p=l.pointCoordinate(n);if(p!=null)return p}return this.screenPointToMercatorCoordinateAtZ(n)}screenPointToMercatorCoordinateAtZ(n,l){const p=l||0,_=[n.x,n.y,0,1],w=[n.x,n.y,1,1];c.av(_,_,this._pixelMatrixInverse),c.av(w,w,this._pixelMatrixInverse);const E=_[3],P=w[3],D=_[1]/E,O=w[1]/P,F=_[2]/E,q=w[2]/P,U=F===q?0:(p-F)/(q-F);return new c.a0(c.C.number(_[0]/E,w[0]/P,U)/this.worldSize,c.C.number(D,O,U)/this.worldSize,p)}coordinatePoint(n,l=0,p=this._pixelMatrix){const _=[n.x*this.worldSize,n.y*this.worldSize,l,1];return c.av(_,_,p),new c.P(_[0]/_[3],_[1]/_[3])}getBounds(){const n=Math.max(0,this._helper._height/2-ie(this));return new Tr().extend(this.screenPointToLocation(new c.P(0,n))).extend(this.screenPointToLocation(new c.P(this._helper._width,n))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(n,l){return l?l.pointCoordinate(n)!=null:n.y>this.height/2-ie(this)}calculatePosMatrix(n,l=!1,p){var _;const w=(_=n.key)!==null&&_!==void 0?_:c.b2(n.wrap,n.canonical.z,n.canonical.z,n.canonical.x,n.canonical.y),E=l?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(w)){const O=E.get(w);return p?O.f32:O.f64}const P=ue(n,this.worldSize);c.O(P,l?this._alignedProjMatrix:this._viewProjMatrix,P);const D={f64:P,f32:new Float32Array(P)};return E.set(w,D),p?D.f32:D.f64}calculateFogMatrix(n){const l=n.key,p=this._fogMatrixCacheF32;if(p.has(l))return p.get(l);const _=ue(n,this.worldSize);return c.O(_,this._fogMatrix,_),p.set(l,new Float32Array(_)),p.get(l)}getConstrained(n,l){l=c.ag(+l,this.minZoom,this.maxZoom);const p={center:new c.S(n.lng,n.lat),zoom:l};let _=this._helper._lngRange;this._helper._renderWorldCopies||_!==null||(_=[-179.9999999999,180-1e-10]);const w=this.tileSize*c.ae(p.zoom);let E=0,P=w,D=0,O=w,F=0,q=0;const{x:U,y:H}=this.size;if(this._helper._latRange){const Ae=this._helper._latRange;E=c.U(Ae[1])*w,P=c.U(Ae[0])*w,P-E<H&&(F=H/(P-E))}_&&(D=c.aN(c.V(_[0])*w,0,w),O=c.aN(c.V(_[1])*w,0,w),O<D&&(O+=w),O-D<U&&(q=U/(O-D)));const{x:ee,y:fe}=Ge(w,n);let he,pe;const _e=Math.max(q||0,F||0);if(_e){const Ae=new c.P(q?(O+D)/2:ee,F?(P+E)/2:fe);return p.center=ne(w,Ae).wrap(),p.zoom+=c.aj(_e),p}if(this._helper._latRange){const Ae=H/2;fe-Ae<E&&(pe=E+Ae),fe+Ae>P&&(pe=P-Ae)}if(_){const Ae=(D+O)/2;let be=ee;this._helper._renderWorldCopies&&(be=c.aN(ee,Ae-w/2,Ae+w/2));const Pe=U/2;be-Pe<D&&(he=D+Pe),be+Pe>O&&(he=O-Pe)}if(he!==void 0||pe!==void 0){const Ae=new c.P(he??ee,pe??fe);p.center=ne(w,Ae).wrap()}return p}calculateCenterFromCameraLngLatAlt(n,l,p,_){return this._helper.calculateCenterFromCameraLngLatAlt(n,l,p,_)}_calculateNearFarZIfNeeded(n,l,p){if(!this._helper.autoCalculateNearFarZ)return;const _=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=n-_*this._helper._pixelPerMeter/Math.cos(l),E=_<0?w:n,P=Math.PI/2+this.pitchInRadians,D=c.ad(this.fov)*(Math.abs(Math.cos(c.ad(this.roll)))*this.height+Math.abs(Math.sin(c.ad(this.roll)))*this.width)/this.height*(.5+p.y/this.height),O=Math.sin(D)*E/Math.sin(c.ag(Math.PI-P-D,.01,Math.PI-.01)),F=ie(this),q=Math.atan(F/this._helper.cameraToCenterDistance),U=c.ad(.75),H=q>U?2*q*(.5+p.y/(2*F)):U,ee=Math.sin(H)*E/Math.sin(c.ag(Math.PI-P-H,.01,Math.PI-.01)),fe=Math.min(O,ee);this._helper._farZ=1.01*(Math.cos(Math.PI/2-l)*fe+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const n=this.centerOffset,l=Ge(this.worldSize,this.center),p=l.x,_=l.y;this._helper._pixelPerMeter=c.ai(1,this.center.lat)*this.worldSize;const w=c.ad(Math.min(this.pitch,so)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let P;this._calculateNearFarZIfNeeded(E,w,n),P=new Float64Array(16),c.b3(P,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.ap(this._invProjMatrix,P),P[8]=2*-n.x/this._helper._width,P[9]=2*n.y/this._helper._height,this._projectionMatrix=c.b4(P),c.N(P,P,[1,-1,1]),c.M(P,P,[0,0,-this._helper.cameraToCenterDistance]),c.b5(P,P,-this.rollInRadians),c.b6(P,P,this.pitchInRadians),c.b5(P,P,-this.bearingInRadians),c.M(P,P,[-p,-_,0]),this._mercatorMatrix=c.N([],P,[this.worldSize,this.worldSize,this.worldSize]),c.N(P,P,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,P),c.M(P,P,[0,0,-this.elevation]),this._viewProjMatrix=P,this._invViewProjMatrix=c.ap([],P);const D=[0,0,-1,1];c.av(D,D,this._invViewProjMatrix),this._cameraPosition=[D[0]/D[3],D[1]/D[3],D[2]/D[3]],this._fogMatrix=new Float64Array(16),c.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-n.x/this.width,this._fogMatrix[9]=2*n.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-p,-_,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,P);const O=this._helper._width%2/2,F=this._helper._height%2/2,q=Math.cos(this.bearingInRadians),U=Math.sin(-this.bearingInRadians),H=p-Math.round(p)+q*O+U*F,ee=_-Math.round(_)+q*F+U*O,fe=new Float64Array(P);if(c.M(fe,fe,[H>.5?H-1:H,ee>.5?ee-1:ee,0]),this._alignedProjMatrix=fe,P=c.ap(new Float64Array(16),this._pixelMatrix),!P)throw new Error("failed to invert matrix");this._pixelMatrixInverse=P,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const n=this.screenPointToMercatorCoordinate(new c.P(0,0)),l=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.av(l,l,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const n=c.ai(1,this.center.lat)*this.worldSize;return Te(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/n).toLngLat()}lngLatToCameraDepth(n,l){const p=c.a0.fromLngLat(n),_=[p.x*this.worldSize,p.y*this.worldSize,l,1];return c.av(_,_,this._viewProjMatrix),_[2]/_[3]}getProjectionData(n){const{overscaledTileID:l,aligned:p,applyTerrainMatrix:_}=n,w=this._helper.getMercatorTileCoordinates(l),E=l?this.calculatePosMatrix(l,p,!0):null;let P;return P=l&&l.terrainRttPosMatrix32f&&_?l.terrainRttPosMatrix32f:E||c.b7(),{mainMatrix:P,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:P}}isLocationOccluded(n){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(n,l,p){return 1}transformLightDirection(n){return c.aS(n)}getRayDirectionFromPixel(n){throw new Error("Not implemented.")}projectTileCoordinates(n,l,p,_){const w=this.calculatePosMatrix(p);let E;_?(E=[n,l,_(n,l),1],c.av(E,E,w)):(E=[n,l,0,1],Do(E,E,w));const P=E[3];return{point:new c.P(E[0]/P,E[1]/P),signedDistanceFromCamera:P,isOccluded:!1}}populateCache(n){for(const l of n)this.calculatePosMatrix(l)}getMatrixForModel(n,l){const p=c.a0.fromLngLat(n,l),_=p.meterInMercatorCoordinateUnits(),w=c.b8();return c.M(w,w,[p.x,p.y,p.z]),c.b5(w,w,Math.PI),c.b6(w,w,Math.PI/2),c.N(w,w,[-_,_,_]),w}getProjectionDataForCustomLayer(n=!0){const l=new c.Z(0,0,0,0,0),p=this.getProjectionData({overscaledTileID:l,applyGlobeMatrix:n}),_=ue(l,this.worldSize);c.O(_,this._viewProjMatrix,_),p.tileMercatorCoords=[0,0,1,1];const w=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],E=c.b9();return c.N(E,_,w),p.fallbackMatrix=E,p.mainMatrix=E,p}getFastPathSimpleProjectionMatrix(n){return this.calculatePosMatrix(n)}}function qr(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Er(b){if(b.useSlerp)if(b.k<1){const n=c.ba(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),l=c.ba(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),p=new Float64Array(4);c.bb(p,n,l,b.k);const _=c.bc(p);b.tr.setRoll(_.roll),b.tr.setPitch(_.pitch),b.tr.setBearing(_.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(c.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(c.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(c.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function pr(b,n,l,p,_){const w=_.padding,E=Ge(_.worldSize,l.getNorthWest()),P=Ge(_.worldSize,l.getNorthEast()),D=Ge(_.worldSize,l.getSouthEast()),O=Ge(_.worldSize,l.getSouthWest()),F=c.ad(-p),q=E.rotate(F),U=P.rotate(F),H=D.rotate(F),ee=O.rotate(F),fe=new c.P(Math.max(q.x,U.x,ee.x,H.x),Math.max(q.y,U.y,ee.y,H.y)),he=new c.P(Math.min(q.x,U.x,ee.x,H.x),Math.min(q.y,U.y,ee.y,H.y)),pe=fe.sub(he),_e=(_.width-(w.left+w.right+n.left+n.right))/pe.x,Ae=(_.height-(w.top+w.bottom+n.top+n.bottom))/pe.y;if(Ae<0||_e<0)return void qr();const be=Math.min(c.aj(_.scale*Math.min(_e,Ae)),b.maxZoom),Pe=c.P.convert(b.offset),Le=new c.P((n.left-n.right)/2,(n.top-n.bottom)/2).rotate(c.ad(p)),xe=Pe.add(Le).mult(_.scale/c.ae(be));return{center:ne(_.worldSize,E.add(D).div(2).sub(xe)),zoom:be,bearing:p}}class fs{get useGlobeControls(){return!1}handlePanInertia(n,l){return{easingOffset:n,easingCenter:l.center}}handleMapControlsRollPitchBearingZoom(n,l){n.bearingDelta&&l.setBearing(l.bearing+n.bearingDelta),n.pitchDelta&&l.setPitch(l.pitch+n.pitchDelta),n.rollDelta&&l.setRoll(l.roll+n.rollDelta),n.zoomDelta&&l.setZoom(l.zoom+n.zoomDelta)}handleMapControlsPan(n,l,p){n.around.distSqr(l.centerPoint)<.01||l.setLocationAtPoint(p,n.around)}cameraForBoxAndBearing(n,l,p,_,w){return pr(n,l,p,_,w)}handleJumpToCenterZoom(n,l){n.zoom!==(l.zoom!==void 0?+l.zoom:n.zoom)&&n.setZoom(+l.zoom),l.center!==void 0&&n.setCenter(c.S.convert(l.center))}handleEaseTo(n,l){const p=n.zoom,_=n.padding,w={roll:n.roll,pitch:n.pitch,bearing:n.bearing},E={roll:l.roll===void 0?n.roll:l.roll,pitch:l.pitch===void 0?n.pitch:l.pitch,bearing:l.bearing===void 0?n.bearing:l.bearing},P=l.zoom!==void 0,D=!n.isPaddingEqual(l.padding);let O=!1;const F=P?+l.zoom:n.zoom;let q=n.centerPoint.add(l.offsetAsPoint);const U=n.screenPointToLocation(q),{center:H,zoom:ee}=n.getConstrained(c.S.convert(l.center||U),F??p);zi(n,H);const fe=Ge(n.worldSize,U),he=Ge(n.worldSize,H).sub(fe),pe=c.ae(ee-p);return O=ee!==p,{easeFunc:_e=>{if(O&&n.setZoom(c.C.number(p,ee,_e)),c.bd(w,E)||Er({startEulerAngles:w,endEulerAngles:E,tr:n,k:_e,useSlerp:w.roll!=E.roll}),D&&(n.interpolatePadding(_,l.padding,_e),q=n.centerPoint.add(l.offsetAsPoint)),l.around)n.setLocationAtPoint(l.around,l.aroundPoint);else{const Ae=c.ae(n.zoom-p),be=ee>p?Math.min(2,pe):Math.max(.5,pe),Pe=Math.pow(be,1-_e),Le=ne(n.worldSize,fe.add(he.mult(_e*Pe)).mult(Ae));n.setLocationAtPoint(n.renderWorldCopies?Le.wrap():Le,q)}},isZooming:O,elevationCenter:H}}handleFlyTo(n,l){const p=l.zoom!==void 0,_=n.zoom,w=n.getConstrained(c.S.convert(l.center||l.locationAtOffset),p?+l.zoom:_),E=w.center,P=w.zoom;zi(n,E);const D=Ge(n.worldSize,l.locationAtOffset),O=Ge(n.worldSize,E).sub(D),F=O.mag(),q=c.ae(P-_);let U;if(l.minZoom!==void 0){const H=Math.min(+l.minZoom,_,P),ee=n.getConstrained(E,H).zoom;U=c.ae(ee-_)}return{easeFunc:(H,ee,fe,he)=>{n.setZoom(H===1?P:_+c.aj(ee));const pe=H===1?E:ne(n.worldSize,D.add(O.mult(fe)).mult(ee));n.setLocationAtPoint(n.renderWorldCopies?pe.wrap():pe,he)},scaleOfZoom:q,targetCenter:E,scaleOfMinZoom:U,pixelPathLength:F}}}class In{constructor(n,l,p){this.blendFunction=n,this.blendColor=l,this.mask=p}}In.Replace=[1,0],In.disabled=new In(In.Replace,c.be.transparent,[!1,!1,!1,!1]),In.unblended=new In(In.Replace,c.be.transparent,[!0,!0,!0,!0]),In.alphaBlended=new In([1,771],c.be.transparent,[!0,!0,!0,!0]);const fi=2305;class _n{constructor(n,l,p){this.enable=n,this.mode=l,this.frontFace=p}}_n.disabled=new _n(!1,1029,fi),_n.backCCW=new _n(!0,1029,fi),_n.frontCCW=new _n(!0,1028,fi);class mn{constructor(n,l,p){this.func=n,this.mask=l,this.range=p}}mn.ReadOnly=!1,mn.ReadWrite=!0,mn.disabled=new mn(519,mn.ReadOnly,[0,1]);const Ta=7680;class ln{constructor(n,l,p,_,w,E){this.test=n,this.ref=l,this.mask=p,this.fail=_,this.depthFail=w,this.pass=E}}ln.disabled=new ln({func:519,mask:0},0,0,Ta,Ta,Ta);const Jr=new WeakMap;function Dn(b){var n;if(Jr.has(b))return Jr.get(b);{const l=(n=b.getParameter(b.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return Jr.set(b,l),l}}class co{get awaitingQuery(){return!!this._readbackQueue}constructor(n){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=n;const l=n.context,p=l.gl;this._texFormat=p.RGBA,this._texType=p.UNSIGNED_BYTE;const _=new c.aK;_.emplaceBack(-1,-1),_.emplaceBack(2,-1),_.emplaceBack(-1,2);const w=new c.aM;w.emplaceBack(0,1,2),this._fullscreenTriangle=new cs(l.createVertexBuffer(_,hs.members),l.createIndexBuffer(w),c.aL.simpleSegment(0,0,_.length,w.length)),this._resultBuffer=new Uint8Array(4),l.activeTexture.set(p.TEXTURE1);const E=p.createTexture();p.bindTexture(p.TEXTURE_2D,E),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texImage2D(p.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=l.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),Dn(p)&&(this._pbo=p.createBuffer(),p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.bufferData(p.PIXEL_PACK_BUFFER,4,p.STREAM_READ),p.bindBuffer(p.PIXEL_PACK_BUFFER,null))}destroy(){const n=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),n.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(n,l){const p=this._updateCount;return this._readbackQueue?p>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():p>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(n,l),this._updateCount++,this._measuredError}_bindFramebuffer(){const n=this._cachedRenderContext.context,l=n.gl;n.activeTexture.set(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,this._fbo.colorAttachment.get()),n.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(n,l){const p=this._cachedRenderContext.context,_=p.gl;if(this._bindFramebuffer(),p.viewport.set([0,0,this._texWidth,this._texHeight]),p.clear({color:c.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(p,_.TRIANGLES,mn.disabled,ln.disabled,In.unblended,_n.disabled,((w,E)=>({u_input:w,u_output_expected:E}))(n,l),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Dn(_)){_.bindBuffer(_.PIXEL_PACK_BUFFER,this._pbo),_.readBuffer(_.COLOR_ATTACHMENT0),_.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),_.bindBuffer(_.PIXEL_PACK_BUFFER,null);const w=_.fenceSync(_.SYNC_GPU_COMMANDS_COMPLETE,0);_.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const n=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Dn(n)){const l=n.clientWaitSync(this._readbackQueue.sync,0,0);if(l===n.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(l===n.TIMEOUT_EXPIRED)return;n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),n.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=co._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(n){let l=0;return l+=n[0]/256,l+=n[1]/65536,l+=n[2]/16777216,n[3]<127&&(l=-l),l/128}}const ia=c.$/128;function wc(b,n){const l=b.granularity!==void 0?Math.max(b.granularity,1):1,p=l+(b.generateBorders?2:0),_=l+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),w=p+1,E=_+1,P=b.generateBorders?-1:0,D=b.generateBorders||b.extendToNorthPole?-1:0,O=l+(b.generateBorders?1:0),F=l+(b.generateBorders||b.extendToSouthPole?1:0),q=w*E,U=p*_*6,H=w*E>65536;if(H&&n==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ee=H||n==="32bit",fe=new Int16Array(2*q);let he=0;for(let Ae=D;Ae<=F;Ae++)for(let be=P;be<=O;be++){let Pe=be/l*c.$;be===-1&&(Pe=-64),be===l+1&&(Pe=c.$+ia);let Le=Ae/l*c.$;Ae===-1&&(Le=b.extendToNorthPole?c.bg:-64),Ae===l+1&&(Le=b.extendToSouthPole?c.bh:c.$+ia),fe[he++]=Pe,fe[he++]=Le}const pe=ee?new Uint32Array(U):new Uint16Array(U);let _e=0;for(let Ae=0;Ae<_;Ae++)for(let be=0;be<p;be++){const Pe=be+1+Ae*w,Le=be+(Ae+1)*w,xe=be+1+(Ae+1)*w;pe[_e++]=be+Ae*w,pe[_e++]=Le,pe[_e++]=Pe,pe[_e++]=Pe,pe[_e++]=Le,pe[_e++]=xe}return{vertices:fe.buffer.slice(0),indices:pe.buffer.slice(0),uses32bitIndices:ee}}const Ba=new c.aJ({fill:new c.bi(128,2),line:new c.bi(512,0),tile:new c.bi(128,32),stencil:new c.bi(128,1),circle:3});class Tu{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return wa.projectionGlobe}get vertexShaderPreludeCode(){return wa.projectionMercator.vertexSource}get subdivisionGranularity(){return Ba}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(n){this._errorMeasurement||(this._errorMeasurement=new co(n));const l=c.U(this._errorQueryLatitudeDegrees),p=2*Math.atan(Math.exp(Math.PI-l*Math.PI*2))-.5*Math.PI,_=this._errorMeasurement.updateErrorLoop(l,p),w=$.now();_!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=_,this._errorMeasurementLastChangeTime=w);const E=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bk(E))}_getMeshKey(n){return`${n.granularity.toString(36)}_${n.generateBorders?"b":""}${n.extendToNorthPole?"n":""}${n.extendToSouthPole?"s":""}`}getMeshFromTileID(n,l,p,_,w){const E=(w==="stencil"?Ba.stencil:Ba.tile).getGranularityForZoomLevel(l.z);return this._getMesh(n,{granularity:E,generateBorders:p,extendToNorthPole:l.y===0&&_,extendToSouthPole:l.y===(1<<l.z)-1&&_})}_getMesh(n,l){const p=this._getMeshKey(l);if(p in this._tileMeshCache)return this._tileMeshCache[p];const _=function(w,E){const P=wc(E,"16bit"),D=c.aK.deserialize({arrayBuffer:P.vertices,length:P.vertices.byteLength/2/2}),O=c.aM.deserialize({arrayBuffer:P.indices,length:P.indices.byteLength/2/3});return new cs(w.createVertexBuffer(D,hs.members),w.createIndexBuffer(O),c.aL.simpleSegment(0,0,D.length,O.length))}(n,l);return this._tileMeshCache[p]=_,_}recalculate(n){}hasTransition(){const n=$.now();let l=!1;return l=l||(n-this._errorMeasurementLastChangeTime)/1e3<.7,l=l||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,l}setErrorQueryLatitudeDegrees(n){this._errorQueryLatitudeDegrees=n}}const ho=new c.r({type:new c.D(c.v.projection.type)});class fo extends c.E{constructor(n){super(),this._transitionable=new c.t(ho),this.setProjection(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new Ol,this._verticalPerspectiveProjection=new Tu}get transitionState(){const n=this.properties.get("type");if(typeof n=="string"&&n==="mercator")return 0;if(typeof n=="string"&&n==="vertical-perspective")return 1;if(n instanceof c.bl){if(n.from==="vertical-perspective"&&n.to==="mercator")return 1-n.transition;if(n.from==="mercator"&&n.to==="vertical-perspective")return n.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(n){this._mercatorProjection.updateGPUdependent(n),this._verticalPerspectiveProjection.updateGPUdependent(n)}getMeshFromTileID(n,l,p,_,w){return this.currentProjection.getMeshFromTileID(n,l,p,_,w)}setProjection(n){this._transitionable.setValue("type",(n==null?void 0:n.type)||"mercator")}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}setErrorQueryLatitudeDegrees(n){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(n),this._mercatorProjection.setErrorQueryLatitudeDegrees(n)}}function Sa(b){const n=Vs(b.worldSize,b.center.lat);return 2*Math.PI*n}function Qa(b,n,l,p,_){const w=1/(1<<_),E=n/c.$*w+p*w,P=c.bn((b/c.$*w+l*w)*Math.PI*2+Math.PI,2*Math.PI),D=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,O=Math.cos(D),F=new Float64Array(3);return F[0]=Math.sin(P)*O,F[1]=Math.sin(D),F[2]=Math.cos(P)*O,F}function Oi(b){return function(n,l){const p=Math.cos(l),_=new Float64Array(3);return _[0]=Math.sin(n)*p,_[1]=Math.sin(l),_[2]=Math.cos(n)*p,_}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function Vs(b,n){return b/(2*Math.PI)/Math.cos(n*Math.PI/180)}function Bo(b){const n=Math.asin(b[1])/Math.PI*180,l=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(l>1e-6){const p=b[0]/l,_=Math.acos(b[2]/l),w=(p>0?_:-_)/Math.PI*180;return new c.S(c.aN(w,-180,180),n)}return new c.S(0,n)}function Fo(b){return Math.cos(b*Math.PI/180)}function Xr(b,n){const l=Fo(b),p=Fo(n);return c.aj(p/l)}function Bl(b,n){const l=b.rotate(n.bearingInRadians),p=n.zoom+Xr(n.center.lat,0),_=c.bj(1/Fo(n.center.lat),1/Fo(Math.min(Math.abs(n.center.lat),60)),c.bm(p,7,3,0,1)),w=360/Sa({worldSize:n.worldSize,center:{lat:n.center.lat}});return new c.S(n.center.lng-l.x*w*_,c.ag(n.center.lat+l.y*w,-85.051129,c.ah))}function po(b){const n=.5*b,l=Math.sin(n),p=Math.cos(n);return Math.log(l+p)-Math.log(p-l)}function Fl(b,n,l,p){const _=b.lat+l*p;if(Math.abs(l)>1){const w=(Math.sign(b.lat+l)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,E=Math.abs(b.lat+l)*Math.PI/180,P=po(w+p*(E-w)),D=po(w),O=po(E);return new c.S(b.lng+n*((P-D)/(O-D)),_)}return new c.S(b.lng+n*p,_)}class gh{constructor(n){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=n}swapBuffers(){if(!this._hadAnyChanges)return;const n=this._cachePrevious;this._cachePrevious=this._cache,this._cache=n,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(n,l,p,_){const w=`${n.z}_${n.x}_${n.y}_${_!=null&&_.terrain?"t":""}`,E=this._cache.get(w);if(E)return E;const P=this._cachePrevious.get(w);if(P)return this._cache.set(w,P),P;const D=this._boundingVolumeFactory(n,l,p,_);return this._cache.set(w,D),this._hadAnyChanges=!0,D}}class Ja{constructor(n,l,p,_){this.min=p,this.max=_,this.points=n,this.planes=l}static fromAabb(n,l){const p=[];for(let _=0;_<8;_++)p.push([1&~_?n[0]:l[0],(_>>1&1)==1?l[1]:n[1],(_>>2&1)==1?l[2]:n[2]]);return new Ja(p,[[-1,0,0,l[0]],[1,0,0,-n[0]],[0,-1,0,l[1]],[0,1,0,-n[1]],[0,0,-1,l[2]],[0,0,1,-n[2]]],n,l)}static fromCenterSizeAngles(n,l,p){const _=c.bq([],p[0],p[1],p[2]),w=c.br([],[l[0],0,0],_),E=c.br([],[0,l[1],0],_),P=c.br([],[0,0,l[2]],_),D=[...n],O=[...n];for(let q=0;q<8;q++)for(let U=0;U<3;U++){const H=n[U]+w[U]*(1&~q?-1:1)+E[U]*((q>>1&1)==1?1:-1)+P[U]*((q>>2&1)==1?1:-1);D[U]=Math.min(D[U],H),O[U]=Math.max(O[U],H)}const F=[];for(let q=0;q<8;q++){const U=[...n];c.aR(U,U,c.aQ([],w,1&~q?-1:1)),c.aR(U,U,c.aQ([],E,(q>>1&1)==1?1:-1)),c.aR(U,U,c.aQ([],P,(q>>2&1)==1?1:-1)),F.push(U)}return new Ja(F,[[...w,-c.aW(w,F[0])],[...E,-c.aW(E,F[0])],[...P,-c.aW(P,F[0])],[-w[0],-w[1],-w[2],-c.aW(w,F[7])],[-E[0],-E[1],-E[2],-c.aW(E,F[7])],[-P[0],-P[1],-P[2],-c.aW(P,F[7])]],D,O)}intersectsFrustum(n){let l=!0;const p=this.points.length,_=this.planes.length,w=n.planes.length,E=n.points.length;for(let P=0;P<w;P++){const D=n.planes[P];let O=0;for(let F=0;F<p;F++){const q=this.points[F];D[0]*q[0]+D[1]*q[1]+D[2]*q[2]+D[3]>=0&&O++}if(O===0)return 0;O<p&&(l=!1)}if(l)return 2;for(let P=0;P<_;P++){const D=this.planes[P];let O=0;for(let F=0;F<E;F++){const q=n.points[F];D[0]*q[0]+D[1]*q[1]+D[2]*q[2]+D[3]>=0&&O++}if(O===0)return 0}return 1}intersectsPlane(n){const l=this.points.length;let p=0;for(let _=0;_<l;_++){const w=this.points[_];n[0]*w[0]+n[1]*w[1]+n[2]*w[2]+n[3]>=0&&p++}return p===l?2:p===0?0:1}}function Vl(b,n,l){const p=b-n;return p<0?-p:Math.max(0,p-l)}function Tc(b,n,l,p,_){const w=b-l;let E;return E=w<0?Math.min(-w,1+w-_):w>1?Math.min(Math.max(w-_,0),1-w):0,Math.max(E,Vl(n,p,_))}class yh{constructor(){this._boundingVolumeCache=new gh(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(n,l,p,_){const w=1<<p.z,E=1/w,P=p.x/w,D=p.y/w;let O=2;return O=Math.min(O,Tc(n,l,P,D,E)),O=Math.min(O,Tc(n,l,P+.5,-D-E,E)),O=Math.min(O,Tc(n,l,P+.5,2-D-E,E)),O}getWrap(n,l,p){const _=1<<l.z,w=1/_,E=l.x/_,P=Vl(n.x,E,w),D=Vl(n.x,E-1,w),O=Vl(n.x,E+1,w),F=Math.min(P,D,O);return F===O?1:F===D?-1:0}allowVariableZoom(n,l){return ht(n,l)>4}allowWorldCopies(){return!1}getTileBoundingVolume(n,l,p,_){return this._boundingVolumeCache.getTileBoundingVolume(n,l,p,_)}_computeTileBoundingVolume(n,l,p,_){var w,E;let P=p,D=p;if(_!=null&&_.terrain){const O=new c.Z(n.z,l,n.z,n.x,n.y),F=_.terrain.getMinMaxElevation(O);P=(w=F.minElevation)!==null&&w!==void 0?w:p,D=(E=F.maxElevation)!==null&&E!==void 0?E:p}if(P/=c.bt,D/=c.bt,P+=1,D+=1,n.z<=0)return Ja.fromAabb([-D,-D,-D],[D,D,D]);if(n.z===1)return Ja.fromAabb([n.x===0?-D:0,n.y===0?0:-D,-D],[n.x===0?0:D,n.y===0?D:0,D]);{const O=[Qa(0,0,n.x,n.y,n.z),Qa(c.$,0,n.x,n.y,n.z),Qa(c.$,c.$,n.x,n.y,n.z),Qa(0,c.$,n.x,n.y,n.z)],F=[];for(const Qe of O)F.push(c.aQ([],Qe,D));if(D!==P)for(const Qe of O)F.push(c.aQ([],Qe,P));n.y===0&&F.push([0,1,0]),n.y===(1<<n.z)-1&&F.push([0,-1,0]);const q=[1,1,1],U=[-1,-1,-1];for(const Qe of F)for(let ot=0;ot<3;ot++)q[ot]=Math.min(q[ot],Qe[ot]),U[ot]=Math.max(U[ot],Qe[ot]);const H=Qa(c.$/2,c.$/2,n.x,n.y,n.z),ee=c.aV([],[0,1,0],H);c.aU(ee,ee);const fe=c.aV([],H,ee);c.aU(fe,fe);const he=c.aV([],O[2],O[1]);c.aU(he,he);const pe=c.aV([],O[0],O[3]);c.aU(pe,pe),F.push(c.aQ([],H,D)),n.y>=(1<<n.z)/2&&F.push(c.aQ([],Qa(c.$/2,0,n.x,n.y,n.z),D)),n.y<(1<<n.z)/2&&F.push(c.aQ([],Qa(c.$/2,c.$,n.x,n.y,n.z),D));const _e=_i(H,F),Ae=_i(fe,F),be=[-H[0],-H[1],-H[2],_e.max],Pe=[H[0],H[1],H[2],-_e.min],Le=[-fe[0],-fe[1],-fe[2],Ae.max],xe=[fe[0],fe[1],fe[2],-Ae.min],Ve=[...he,0],rt=[...pe,0],Ye=[];return n.y===0?Ye.push(c.bs(rt,Ve,be),c.bs(rt,Ve,Pe)):Ye.push(c.bs(Le,Ve,be),c.bs(Le,Ve,Pe),c.bs(Le,rt,be),c.bs(Le,rt,Pe)),n.y===(1<<n.z)-1?Ye.push(c.bs(rt,Ve,be),c.bs(rt,Ve,Pe)):Ye.push(c.bs(xe,Ve,be),c.bs(xe,Ve,Pe),c.bs(xe,rt,be),c.bs(xe,rt,Pe)),new Ja(Ye,[be,Pe,Le,xe,Ve,rt],q,U)}}}function _i(b,n){let l=1/0,p=-1/0;for(const _ of n){const w=c.aW(b,_);l=Math.min(l,w),p=Math.max(p,w)}return{min:l,max:p}}class ol{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,l,p){return this._helper.interpolatePadding(n,l,p)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,l){this._helper.resize(n,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,l){this._helper.overrideNearFarZ(n,l)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n){}constructor(){this._cachedClippingPlane=c.bu(),this._projectionMatrix=c.b8(),this._globeViewProjMatrix32f=c.b7(),this._globeViewProjMatrixNoCorrection=c.b8(),this._globeViewProjMatrixNoCorrectionInverted=c.b8(),this._globeProjMatrixInverted=c.b8(),this._cameraPosition=c.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new ds({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,l)=>this.getConstrained(n,l)}),this._coveringTilesDetailsProvider=new yh}clone(){const n=new ol;return n.apply(this),n}apply(n,l){this._globeLatitudeErrorCorrectionRadians=l||0,this._helper.apply(n)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const n=c.bo();return n[0]=this._cameraPosition[0],n[1]=this._cameraPosition[1],n[2]=this._cameraPosition[2],n}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(n){const{overscaledTileID:l,applyGlobeMatrix:p}=n,_=this._helper.getMercatorTileCoordinates(l);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:_,clippingPlane:this._cachedClippingPlane,projectionTransition:p?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(n){const l=this.pitchInRadians,p=this.cameraToCenterDistance/n,_=Math.sin(l)*p,w=Math.cos(l)*p+1,E=1/Math.sqrt(_*_+w*w)*1;let P=-_,D=w;const O=Math.sqrt(P*P+D*D);P/=O,D/=O;const F=[0,P,D];c.bv(F,F,[0,0,0],-this.bearingInRadians),c.bw(F,F,[0,0,0],-1*this.center.lat*Math.PI/180),c.bx(F,F,[0,0,0],this.center.lng*Math.PI/180);const q=1/c.aY(F);return c.aQ(F,F,q),[...F,-E*q]}isLocationOccluded(n){return!this.isSurfacePointVisible(Oi(n))}transformLightDirection(n){const l=this._helper._center.lng*Math.PI/180,p=this._helper._center.lat*Math.PI/180,_=Math.cos(p),w=[Math.sin(l)*_,Math.sin(p),Math.cos(l)*_],E=[w[2],0,-w[0]],P=[0,0,0];c.aV(P,E,w),c.aU(E,E),c.aU(P,P);const D=[0,0,0];return c.aU(D,[E[0]*n[0]+P[0]*n[1]+w[0]*n[2],E[1]*n[0]+P[1]*n[1]+w[1]*n[2],E[2]*n[0]+P[2]*n[1]+w[2]*n[2]]),D}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(n,l,p){const _=function(P,D,O){const F=1/(1<<O.z);return new c.a0(P/c.$*F+O.x*F,D/c.$*F+O.y*F)}(n,l,p.canonical),w=(E=_.y,[c.bn(_.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(n,l,p,_){const w=p.canonical,E=Qa(n,l,w.x,w.y,w.z),P=1+(_?_(n,l):0)/c.bt,D=[E[0]*P,E[1]*P,E[2]*P,1];c.av(D,D,this._globeViewProjMatrixNoCorrection);const O=this._cachedClippingPlane,F=O[0]*E[0]+O[1]*E[1]+O[2]*E[2]+O[3]<0;return{point:new c.P(D[0]/D[3],D[1]/D[3]),signedDistanceFromCamera:D[3],isOccluded:F}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const n=Vs(this.worldSize,this.center.lat),l=c.b9(),p=c.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*n),c.b3(l,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const _=this.centerOffset;l[8]=2*-_.x/this._helper._width,l[9]=2*_.y/this._helper._height,this._projectionMatrix=c.b4(l),this._globeProjMatrixInverted=c.b9(),c.ap(this._globeProjMatrixInverted,l),c.M(l,l,[0,0,-this.cameraToCenterDistance]),c.b5(l,l,this.rollInRadians),c.b6(l,l,-this.pitchInRadians),c.b5(l,l,this.bearingInRadians),c.M(l,l,[0,0,-n]);const w=c.bo();w[0]=n,w[1]=n,w[2]=n,c.b6(p,l,this.center.lat*Math.PI/180),c.by(p,p,-this.center.lng*Math.PI/180),c.N(p,p,w),this._globeViewProjMatrixNoCorrection=p,c.b6(l,l,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.by(l,l,-this.center.lng*Math.PI/180),c.N(l,l,w),this._globeViewProjMatrix32f=new Float32Array(l),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),c.ap(this._globeViewProjMatrixNoCorrectionInverted,p);const E=c.bo();this._cameraPosition=c.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/n,c.bv(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),c.bw(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),c.bv(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),c.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bw(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),c.bx(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(n);const P=c.b4(this._globeViewProjMatrixNoCorrectionInverted);c.N(P,P,[1,1,-1]),this._cachedFrustum=Hi.fromInvProjectionMatrix(P,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(n){c.w("calculateFogMatrix is not supported on globe projection.");const l=c.b9();return c.af(l),l}getVisibleUnwrappedCoordinates(n){return[new c.b1(0,n)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){n&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,l){if(!this._globeViewProjMatrixNoCorrection)return 1;const p=Oi(n);c.aQ(p,p,1+l/c.bt);const _=c.bu();return c.av(_,[p[0],p[1],p[2],1],this._globeViewProjMatrixNoCorrection),_[2]/_[3]}populateCache(n){}getBounds(){const n=.5*this.width,l=.5*this.height,p=[new c.P(0,0),new c.P(n,0),new c.P(this.width,0),new c.P(this.width,l),new c.P(this.width,this.height),new c.P(n,this.height),new c.P(0,this.height),new c.P(0,l)],_=[];for(const q of p)_.push(this.unprojectScreenPoint(q));let w=0,E=0,P=0,D=0;const O=this.center;for(const q of _){const U=c.bz(O.lng,q.lng),H=c.bz(O.lat,q.lat);U<E&&(E=U),U>w&&(w=U),H<D&&(D=H),H>P&&(P=H)}const F=[O.lng+E,O.lat+D,O.lng+w,O.lat+P];return this.isSurfacePointOnScreen([0,1,0])&&(F[3]=90,F[0]=-180,F[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(F[1]=-90,F[0]=-180,F[2]=180),new Tr(F)}getConstrained(n,l){const p=c.ag(n.lat,-85.051129,c.ah),_=c.ag(+l,this.minZoom+Xr(0,p),this.maxZoom);return{center:new c.S(n.lng,p),zoom:_}}calculateCenterFromCameraLngLatAlt(n,l,p,_){return this._helper.calculateCenterFromCameraLngLatAlt(n,l,p,_)}setLocationAtPoint(n,l){const p=Oi(this.unprojectScreenPoint(l)),_=Oi(n),w=c.bo();c.bA(w);const E=c.bo();c.bx(E,p,w,-this.center.lng*Math.PI/180),c.bw(E,E,w,this.center.lat*Math.PI/180);const P=_[0]*_[0]+_[2]*_[2],D=E[0]*E[0];if(P<D)return;const O=Math.sqrt(P-D),F=-O,q=c.bB(_[0],_[2],E[0],O),U=c.bB(_[0],_[2],E[0],F),H=c.bo();c.bx(H,_,w,-q);const ee=c.bB(H[1],H[2],E[1],E[2]),fe=c.bo();c.bx(fe,_,w,-U);const he=c.bB(fe[1],fe[2],E[1],E[2]),pe=.5*Math.PI,_e=ee>=-pe&&ee<=pe,Ae=he>=-pe&&he<=pe;let be,Pe;if(_e&&Ae){const rt=this.center.lng*Math.PI/180,Ye=this.center.lat*Math.PI/180;c.bC(q,rt)+c.bC(ee,Ye)<c.bC(U,rt)+c.bC(he,Ye)?(be=q,Pe=ee):(be=U,Pe=he)}else if(_e)be=q,Pe=ee;else{if(!Ae)return;be=U,Pe=he}const Le=be/Math.PI*180,xe=Pe/Math.PI*180,Ve=this.center.lat;this.setCenter(new c.S(Le,c.ag(xe,-90,90))),this.setZoom(this.zoom+Xr(Ve,this.center.lat))}locationToScreenPoint(n,l){const p=Oi(n);if(l){const _=l.getElevationForLngLatZoom(n,this._helper._tileZoom);c.aQ(p,p,1+_/c.bt)}return this._projectSurfacePointToScreen(p)}_projectSurfacePointToScreen(n){const l=c.bu();return c.av(l,[...n,1],this._globeViewProjMatrixNoCorrection),l[0]/=l[3],l[1]/=l[3],new c.P((.5*l[0]+.5)*this.width,(.5*-l[1]+.5)*this.height)}screenPointToMercatorCoordinate(n,l){if(l){const p=l.pointCoordinate(n);if(p)return p}return c.a0.fromLngLat(this.unprojectScreenPoint(n))}screenPointToLocation(n,l){var p;return(p=this.screenPointToMercatorCoordinate(n,l))===null||p===void 0?void 0:p.toLngLat()}isPointOnMapSurface(n,l){const p=this._cameraPosition,_=this.getRayDirectionFromPixel(n);return!!this.rayPlanetIntersection(p,_)}getRayDirectionFromPixel(n){const l=c.bu();l[0]=n.x/this.width*2-1,l[1]=-1*(n.y/this.height*2-1),l[2]=1,l[3]=1,c.av(l,l,this._globeViewProjMatrixNoCorrectionInverted),l[0]/=l[3],l[1]/=l[3],l[2]/=l[3];const p=c.bo();p[0]=l[0]-this._cameraPosition[0],p[1]=l[1]-this._cameraPosition[1],p[2]=l[2]-this._cameraPosition[2];const _=c.bo();return c.aU(_,p),_}isSurfacePointVisible(n){const l=this._cachedClippingPlane;return l[0]*n[0]+l[1]*n[1]+l[2]*n[2]+l[3]>=0}isSurfacePointOnScreen(n){if(!this.isSurfacePointVisible(n))return!1;const l=c.bu();return c.av(l,[...n,1],this._globeViewProjMatrixNoCorrection),l[0]/=l[3],l[1]/=l[3],l[2]/=l[3],l[0]>-1&&l[0]<1&&l[1]>-1&&l[1]<1&&l[2]>-1&&l[2]<1}rayPlanetIntersection(n,l){const p=c.aW(n,l),_=c.bo(),w=c.bo();c.aQ(w,l,p),c.aT(_,n,w);const E=1-c.aW(_,_);if(E<0)return null;const P=c.aW(n,n)-1,D=-p+(p<0?1:-1)*Math.sqrt(E),O=P/D,F=D;return{tMin:Math.min(O,F),tMax:Math.max(O,F)}}unprojectScreenPoint(n){const l=this._cameraPosition,p=this.getRayDirectionFromPixel(n),_=this.rayPlanetIntersection(l,p);if(_){const F=c.bo();c.aR(F,l,[p[0]*_.tMin,p[1]*_.tMin,p[2]*_.tMin]);const q=c.bo();return c.aU(q,F),Bo(q)}const w=this._cachedClippingPlane,E=w[0]*p[0]+w[1]*p[1]+w[2]*p[2],P=-c.b0(w,l)/E,D=c.bo();if(P>0)c.aR(D,l,[p[0]*P,p[1]*P,p[2]*P]);else{const F=c.bo();c.aR(F,l,[2*p[0],2*p[1],2*p[2]]);const q=c.b0(this._cachedClippingPlane,F);c.aT(D,F,[this._cachedClippingPlane[0]*q,this._cachedClippingPlane[1]*q,this._cachedClippingPlane[2]*q])}const O=function(F){const q=c.bo();return q[0]=F[0]*-F[3],q[1]=F[1]*-F[3],q[2]=F[2]*-F[3],{center:q,radius:Math.sqrt(1-F[3]*F[3])}}(w);return Bo(function(F,q,U){const H=c.bo();c.aT(H,U,F);const ee=c.bo();return c.bp(ee,F,H,q/c.a_(H)),ee}(O.center,O.radius,D))}getMatrixForModel(n,l){const p=c.S.convert(n),_=1/c.bt,w=c.b8();return c.by(w,w,p.lng/180*Math.PI),c.b6(w,w,-p.lat/180*Math.PI),c.M(w,w,[0,0,1+l/c.bt]),c.b6(w,w,.5*Math.PI),c.N(w,w,[_,_,_]),w}getProjectionDataForCustomLayer(n=!0){const l=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:n});return l.tileMercatorCoords=[0,0,1,1],l}getFastPathSimpleProjectionMatrix(n){}}class aa{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,l,p){return this._helper.interpolatePadding(n,l,p)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,l,p=!0){this._helper.resize(n,l,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,l){this._helper.overrideNearFarZ(n,l)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(n,l){this._globeness=n,this._globeLatitudeErrorCorrectionRadians=l,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new ds({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,l)=>this.getConstrained(n,l)}),this._globeness=1,this._mercatorTransform=new Ur,this._verticalPerspectiveTransform=new ol}clone(){const n=new aa;return n._globeness=this._globeness,n._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,n.apply(this),n}apply(n){this._helper.apply(n),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(n){const l=this._mercatorTransform.getProjectionData(n),p=this._verticalPerspectiveTransform.getProjectionData(n);return{mainMatrix:this.isGlobeRendering?p.mainMatrix:l.mainMatrix,clippingPlane:p.clippingPlane,tileMercatorCoords:p.tileMercatorCoords,projectionTransition:n.applyGlobeMatrix?this._globeness:0,fallbackMatrix:l.fallbackMatrix}}isLocationOccluded(n){return this.currentTransform.isLocationOccluded(n)}transformLightDirection(n){return this.currentTransform.transformLightDirection(n)}getPixelScale(){return c.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(n,l,p){const _=this._mercatorTransform.getPitchedTextCorrection(n,l,p),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(n,l,p);return c.bj(_,w,this._globeness)}projectTileCoordinates(n,l,p,_){return this.currentTransform.projectTileCoordinates(n,l,p,_)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(n){return this.currentTransform.calculateFogMatrix(n)}getVisibleUnwrappedCoordinates(n){return this.currentTransform.getVisibleUnwrappedCoordinates(n)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(n){this._mercatorTransform.recalculateZoomAndCenter(n),this._verticalPerspectiveTransform.recalculateZoomAndCenter(n)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,l){return this.currentTransform.lngLatToCameraDepth(n,l)}populateCache(n){this._mercatorTransform.populateCache(n),this._verticalPerspectiveTransform.populateCache(n)}getBounds(){return this.currentTransform.getBounds()}getConstrained(n,l){return this.currentTransform.getConstrained(n,l)}calculateCenterFromCameraLngLatAlt(n,l,p,_){return this._helper.calculateCenterFromCameraLngLatAlt(n,l,p,_)}setLocationAtPoint(n,l){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(n,l),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(n,l),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(n,l){return this.currentTransform.locationToScreenPoint(n,l)}screenPointToMercatorCoordinate(n,l){return this.currentTransform.screenPointToMercatorCoordinate(n,l)}screenPointToLocation(n,l){return this.currentTransform.screenPointToLocation(n,l)}isPointOnMapSurface(n,l){return this.currentTransform.isPointOnMapSurface(n,l)}getRayDirectionFromPixel(n){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(n)}getMatrixForModel(n,l){return this.currentTransform.getMatrixForModel(n,l)}getProjectionDataForCustomLayer(n=!0){const l=this._mercatorTransform.getProjectionDataForCustomLayer(n);if(!this.isGlobeRendering)return l;const p=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(n);return p.fallbackMatrix=l.mainMatrix,p}getFastPathSimpleProjectionMatrix(n){return this.currentTransform.getFastPathSimpleProjectionMatrix(n)}}class da{get useGlobeControls(){return!0}handlePanInertia(n,l){const p=Bl(n,l);return Math.abs(p.lng-l.center.lng)>180&&(p.lng=l.center.lng+179.5*Math.sign(p.lng-l.center.lng)),{easingCenter:p,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(n,l){const p=n.around,_=l.screenPointToLocation(p);n.bearingDelta&&l.setBearing(l.bearing+n.bearingDelta),n.pitchDelta&&l.setPitch(l.pitch+n.pitchDelta),n.rollDelta&&l.setRoll(l.roll+n.rollDelta);const w=l.zoom;n.zoomDelta&&l.setZoom(l.zoom+n.zoomDelta);const E=l.zoom-w;if(E===0)return;const P=c.bz(l.center.lng,_.lng),D=P/(Math.abs(P/180)+1),O=c.bz(l.center.lat,_.lat),F=l.getRayDirectionFromPixel(p),q=l.cameraPosition,U=-1*c.aW(q,F),H=c.bo();c.aR(H,q,[F[0]*U,F[1]*U,F[2]*U]);const ee=c.aY(H)-1,fe=Math.exp(.5*-Math.max(ee-.3,0)),he=Vs(l.worldSize,l.center.lat)/Math.min(l.width,l.height),pe=c.bm(he,.9,.5,1,.25),_e=(1-c.ae(-E))*Math.min(fe,pe),Ae=l.center.lat,be=l.zoom,Pe=new c.S(l.center.lng+D*_e,c.ag(l.center.lat+O*_e,-85.051129,c.ah));l.setLocationAtPoint(_,p);const Le=l.center,xe=c.bm(Math.abs(P),45,85,0,1),Ve=c.bm(he,.75,.35,0,1),rt=Math.pow(Math.max(xe,Ve),.25),Ye=c.bz(Le.lng,Pe.lng),Qe=c.bz(Le.lat,Pe.lat);l.setCenter(new c.S(Le.lng+Ye*rt,Le.lat+Qe*rt).wrap()),l.setZoom(be+Xr(Ae,l.center.lat))}handleMapControlsPan(n,l,p){if(!n.panDelta)return;const _=l.center.lat,w=l.zoom;l.setCenter(Bl(n.panDelta,l).wrap()),l.setZoom(w+Xr(_,l.center.lat))}cameraForBoxAndBearing(n,l,p,_,w){const E=pr(n,l,p,_,w),P=l.left/w.width*2-1,D=(w.width-l.right)/w.width*2-1,O=l.top/w.height*-2+1,F=(w.height-l.bottom)/w.height*-2+1,q=c.bz(p.getWest(),p.getEast())<0,U=q?p.getEast():p.getWest(),H=q?p.getWest():p.getEast(),ee=Math.max(p.getNorth(),p.getSouth()),fe=Math.min(p.getNorth(),p.getSouth()),he=U+.5*c.bz(U,H),pe=ee+.5*c.bz(ee,fe),_e=w.clone();_e.setCenter(E.center),_e.setBearing(E.bearing),_e.setPitch(0),_e.setRoll(0),_e.setZoom(E.zoom);const Ae=_e.modelViewProjectionMatrix,be=[Oi(p.getNorthWest()),Oi(p.getNorthEast()),Oi(p.getSouthWest()),Oi(p.getSouthEast()),Oi(new c.S(H,pe)),Oi(new c.S(U,pe)),Oi(new c.S(he,ee)),Oi(new c.S(he,fe))],Pe=Oi(E.center);let Le=Number.POSITIVE_INFINITY;for(const xe of be)P<0&&(Le=da.getLesserNonNegativeNonNull(Le,da.solveVectorScale(xe,Pe,Ae,"x",P))),D>0&&(Le=da.getLesserNonNegativeNonNull(Le,da.solveVectorScale(xe,Pe,Ae,"x",D))),O>0&&(Le=da.getLesserNonNegativeNonNull(Le,da.solveVectorScale(xe,Pe,Ae,"y",O))),F<0&&(Le=da.getLesserNonNegativeNonNull(Le,da.solveVectorScale(xe,Pe,Ae,"y",F)));if(Number.isFinite(Le)&&Le!==0)return E.zoom=_e.zoom+c.aj(Le),E;qr()}handleJumpToCenterZoom(n,l){const p=n.center.lat,_=n.getConstrained(l.center?c.S.convert(l.center):n.center,n.zoom).center;n.setCenter(_.wrap());const w=l.zoom!==void 0?+l.zoom:n.zoom+Xr(p,_.lat);n.zoom!==w&&n.setZoom(w)}handleEaseTo(n,l){const p=n.zoom,_=n.center,w=n.padding,E={roll:n.roll,pitch:n.pitch,bearing:n.bearing},P={roll:l.roll===void 0?n.roll:l.roll,pitch:l.pitch===void 0?n.pitch:l.pitch,bearing:l.bearing===void 0?n.bearing:l.bearing},D=l.zoom!==void 0,O=!n.isPaddingEqual(l.padding);let F=!1;const q=l.center?c.S.convert(l.center):_,U=n.getConstrained(q,p).center;zi(n,U);const H=n.clone();H.setCenter(U),H.setZoom(D?+l.zoom:p+Xr(_.lat,q.lat)),H.setBearing(l.bearing);const ee=new c.P(c.ag(n.centerPoint.x+l.offsetAsPoint.x,0,n.width),c.ag(n.centerPoint.y+l.offsetAsPoint.y,0,n.height));H.setLocationAtPoint(U,ee);const fe=(l.offset&&l.offsetAsPoint.mag())>0?H.center:U,he=D?+l.zoom:p+Xr(_.lat,fe.lat),pe=p+Xr(_.lat,0),_e=he+Xr(fe.lat,0),Ae=c.bz(_.lng,fe.lng),be=c.bz(_.lat,fe.lat),Pe=c.ae(_e-pe);return F=he!==p,{easeFunc:Le=>{if(c.bd(E,P)||Er({startEulerAngles:E,endEulerAngles:P,tr:n,k:Le,useSlerp:E.roll!=P.roll}),O&&n.interpolatePadding(w,l.padding,Le),l.around)c.w("Easing around a point is not supported under globe projection."),n.setLocationAtPoint(l.around,l.aroundPoint);else{const xe=_e>pe?Math.min(2,Pe):Math.max(.5,Pe),Ve=Math.pow(xe,1-Le),rt=Fl(_,Ae,be,Le*Ve);n.setCenter(rt.wrap())}if(F){const xe=c.C.number(pe,_e,Le)+Xr(0,n.center.lat);n.setZoom(xe)}},isZooming:F,elevationCenter:fe}}handleFlyTo(n,l){const p=l.zoom!==void 0,_=n.center,w=n.zoom,E=n.padding,P=!n.isPaddingEqual(l.padding),D=n.getConstrained(c.S.convert(l.center||l.locationAtOffset),w).center,O=p?+l.zoom:n.zoom+Xr(n.center.lat,D.lat),F=n.clone();F.setCenter(D),F.setZoom(O),F.setBearing(l.bearing);const q=new c.P(c.ag(n.centerPoint.x+l.offsetAsPoint.x,0,n.width),c.ag(n.centerPoint.y+l.offsetAsPoint.y,0,n.height));F.setLocationAtPoint(D,q);const U=F.center;zi(n,U);const H=function(be,Pe,Le){const xe=Oi(Pe),Ve=Oi(Le),rt=c.aW(xe,Ve),Ye=Math.acos(rt),Qe=Sa(be);return Ye/(2*Math.PI)*Qe}(n,_,U),ee=w+Xr(_.lat,0),fe=O+Xr(U.lat,0),he=c.ae(fe-ee);let pe;if(typeof l.minZoom=="number"){const be=+l.minZoom+Xr(U.lat,0),Pe=Math.min(be,ee,fe)+Xr(0,U.lat),Le=n.getConstrained(U,Pe).zoom+Xr(U.lat,0);pe=c.ae(Le-ee)}const _e=c.bz(_.lng,U.lng),Ae=c.bz(_.lat,U.lat);return{easeFunc:(be,Pe,Le,xe)=>{const Ve=Fl(_,_e,Ae,Le);P&&n.interpolatePadding(E,l.padding,be);const rt=be===1?U:Ve;n.setCenter(rt.wrap());const Ye=ee+c.aj(Pe);n.setZoom(be===1?O:Ye+Xr(0,rt.lat))},scaleOfZoom:he,targetCenter:U,scaleOfMinZoom:pe,pixelPathLength:H}}static solveVectorScale(n,l,p,_,w){const E=_==="x"?[p[0],p[4],p[8],p[12]]:[p[1],p[5],p[9],p[13]],P=[p[3],p[7],p[11],p[15]],D=n[0]*E[0]+n[1]*E[1]+n[2]*E[2],O=n[0]*P[0]+n[1]*P[1]+n[2]*P[2],F=l[0]*E[0]+l[1]*E[1]+l[2]*E[2],q=l[0]*P[0]+l[1]*P[1]+l[2]*P[2];return F+w*O===D+w*q||P[3]*(D-F)+E[3]*(q-O)+D*q==F*O?null:(F+E[3]-w*q-w*P[3])/(F-D-w*q+w*O)}static getLesserNonNegativeNonNull(n,l){return l!==null&&l>=0&&l<n?l:n}}class Su{constructor(n){this._globe=n,this._mercatorCameraHelper=new fs,this._verticalPerspectiveCameraHelper=new da}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(n,l){return this.currentHelper.handlePanInertia(n,l)}handleMapControlsRollPitchBearingZoom(n,l){return this.currentHelper.handleMapControlsRollPitchBearingZoom(n,l)}handleMapControlsPan(n,l,p){this.currentHelper.handleMapControlsPan(n,l,p)}cameraForBoxAndBearing(n,l,p,_,w){return this.currentHelper.cameraForBoxAndBearing(n,l,p,_,w)}handleJumpToCenterZoom(n,l){this.currentHelper.handleJumpToCenterZoom(n,l)}handleEaseTo(n,l){return this.currentHelper.handleEaseTo(n,l)}handleFlyTo(n,l){return this.currentHelper.handleFlyTo(n,l)}}const ps=(b,n)=>c.y(b,n&&n.filter(l=>l.identifier!=="source.canvas")),ll=c.bD();class Sc extends c.E{constructor(n,l={}){super(),this._rtlPluginLoaded=()=>{for(const p in this.sourceCaches){const _=this.sourceCaches[p].getSource().type;_!=="vector"&&_!=="geojson"||this.sourceCaches[p].reload()}},this.map=n,this.dispatcher=new gn(En(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",(p,_)=>this.getGlyphs(p,_)),this.dispatcher.registerMessageHandler("GI",(p,_)=>this.getImages(p,_)),this.imageManager=new ye,this.imageManager.setEventedParent(this),this.glyphManager=new ve(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Gt(256,512),this.crossTileSymbolIndex=new No,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bF()),Bn().on(ls,this._rtlPluginLoaded),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const _=this.sourceCaches[p.sourceId];if(!_)return;const w=_.getSource();if(w&&w.vectorLayerIds)for(const E in this._layers){const P=this._layers[E];P.source===w.id&&this._validateLayer(P)}})}setGlobalStateProperty(n,l){var p,_,w;this._checkLoaded();const E=l===null?(w=(_=(p=this.stylesheet.state)===null||p===void 0?void 0:p[n])===null||_===void 0?void 0:_.default)!==null&&w!==void 0?w:null:l;if(c.bG(E,this._globalState[n]))return this;this._globalState[n]=E;const P=this._findGlobalStateAffectedSources([n]);for(const D in this.sourceCaches)P.has(D)&&(this._reloadSource(D),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(n){this._checkLoaded();const l=[];for(const _ in n)!c.bG(this._globalState[_],n[_].default)&&(l.push(_),this._globalState[_]=n[_].default);const p=this._findGlobalStateAffectedSources(l);for(const _ in this.sourceCaches)p.has(_)&&(this._reloadSource(_),this._changed=!0)}_findGlobalStateAffectedSources(n){if(n.length===0)return new Set;const l=new Set;for(const p in this._layers){const _=this._layers[p],w=_.getLayoutAffectingGlobalStateRefs();for(const E of n)w.has(E)&&l.add(_.source)}return l}loadURL(n,l={},p){this.fire(new c.l("dataloading",{dataType:"style"})),l.validate=typeof l.validate!="boolean"||l.validate;const _=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;c.j(_,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,l,p)}).catch(E=>{this._loadStyleRequest=null,E&&!w.signal.aborted&&this.fire(new c.k(E))})}loadJSON(n,l={},p){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,$.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,l.validate=l.validate!==!1,this._load(n,l,p)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(ll,{validate:!1})}_load(n,l,p){var _,w,E;const P=l.transformStyle?l.transformStyle(p,n):n;if(!l.validate||!ps(this,c.z(P))){this._loaded=!0,this.stylesheet=P;for(const D in P.sources)this.addSource(D,P.sources[D],{validate:!1});P.sprite?this._loadSprite(P.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(P.glyphs),this._createLayers(),this.light=new et(this.stylesheet.light),this._setProjectionInternal(((_=this.stylesheet.projection)===null||_===void 0?void 0:_.type)||"mercator"),this.sky=new Tt(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.setGlobalState((E=this.stylesheet.state)!==null&&E!==void 0?E:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){const n=c.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",n),this._order=n.map(l=>l.id),this._layers={},this._serializedLayers=null;for(const l of n){const p=c.bI(l);p.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=p}}_loadSprite(n,l=!1,p=void 0){let _;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(w,E,P,D){return c._(this,void 0,void 0,function*(){const O=Ze(w),F=P>1?"@2x":"",q={},U={};for(const{id:H,url:ee}of O){const fe=E.transformRequest(me(ee,F,".json"),"SpriteJSON");q[H]=c.j(fe,D);const he=E.transformRequest(me(ee,F,".png"),"SpriteImage");U[H]=Ue.getImage(he,D)}return yield Promise.all([...Object.values(q),...Object.values(U)]),function(H,ee){return c._(this,void 0,void 0,function*(){const fe={};for(const he in H){fe[he]={};const pe=$.getImageCanvasContext((yield ee[he]).data),_e=(yield H[he]).data;for(const Ae in _e){const{width:be,height:Pe,x:Le,y:xe,sdf:Ve,pixelRatio:rt,stretchX:Ye,stretchY:Qe,content:ot,textFitWidth:zt,textFitHeight:Lt}=_e[Ae];fe[he][Ae]={data:null,pixelRatio:rt,sdf:Ve,stretchX:Ye,stretchY:Qe,content:ot,textFitWidth:zt,textFitHeight:Lt,spriteData:{width:be,height:Pe,x:Le,y:xe,context:pe}}}}return fe})}(q,U)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(w=>{if(this._spriteRequest=null,w)for(const E in w){this._spritesImagesIds[E]=[];const P=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(D=>!(D in w)):[];for(const D of P)this.imageManager.removeImage(D),this._changedImages[D]=!0;for(const D in w[E]){const O=E==="default"?D:`${E}:${D}`;this._spritesImagesIds[E].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,w[E][D],!1):this.imageManager.addImage(O,w[E][D]),l&&(this._changedImages[O]=!0)}}}).catch(w=>{this._spriteRequest=null,_=w,this.fire(new c.k(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),l&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),p&&p(_)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(n){const l=this.sourceCaches[n.source];if(!l)return;const p=n.sourceLayer;if(!p)return;const _=l.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(p)===-1)&&this.fire(new c.k(new Error(`Source layer "${p}" does not exist on source "${_.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,l=!1){const p=this._serializedAllLayers();if(!n||n.length===0)return Object.values(l?c.bJ(p):p);const _=[];for(const w of n)if(p[w]){const E=l?c.bJ(p[w]):p[w];_.push(E)}return _}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const l=Object.keys(this._layers);for(const p of l){const _=this._layers[p];_.type!=="custom"&&(n[p]=_.serialize())}return n}hasTransitions(){var n,l,p;if(!((n=this.light)===null||n===void 0)&&n.hasTransition()||!((l=this.sky)===null||l===void 0)&&l.hasTransition()||!((p=this.projection)===null||p===void 0)&&p.hasTransition())return!0;for(const _ in this.sourceCaches)if(this.sourceCaches[_].hasTransition())return!0;for(const _ in this._layers)if(this._layers[_].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const l=this._changed;if(l){const _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(_.length||w.length)&&this._updateWorkerLayers(_,w);for(const E in this._updatedSources){const P=this._updatedSources[E];if(P==="reload")this._reloadSource(E);else{if(P!=="clear")throw new Error(`Invalid action ${P}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const p={};for(const _ in this.sourceCaches){const w=this.sourceCaches[_];p[_]=w.used,w.used=!1}for(const _ of this._order){const w=this._layers[_];w.recalculate(n,this._availableImages),!w.isHidden(n.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const _ in p){const w=this.sourceCaches[_];!!p[_]!=!!w.used&&w.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(n),this.sky.recalculate(n),this.projection.recalculate(n),this.z=n.zoom,l&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,l){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,l={}){var p;this._checkLoaded();const _=this.serialize();if(n=l.transformStyle?l.transformStyle(_,n):n,((p=l.validate)===null||p===void 0||p)&&ps(this,c.z(n)))return!1;(n=c.bJ(n)).layers=c.bH(n.layers);const w=c.bK(_,n),E=this._getOperationsToPerform(w);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const P of E.operations)P();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const l=[],p=[];for(const _ of n)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":l.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":l.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":l.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":l.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":l.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":l.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":l.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":l.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":l.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":l.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":l.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":l.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":l.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setSky":l.push(()=>this.setSky.apply(this,_.args));break;case"setProjection":this.setProjection.apply(this,_.args);break;case"setGlobalState":l.push(()=>this.setGlobalState.apply(this,_.args));break;case"setTransition":l.push(()=>{});break;default:p.push(_.command)}return{operations:l,unimplemented:p}}addImage(n,l){if(this.getImage(n))return this.fire(new c.k(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,l),this._afterImageUpdated(n)}updateImage(n,l){this.imageManager.updateImage(n,l)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new c.k(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,l,p={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(c.z.source,`sources.${n}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const _=this.sourceCaches[n]=new mt(n,l,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:n})),_.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===n)return this.fire(new c.k(new Error(`Source "${n}" cannot be removed while layer "${p}" is using it.`)));const l=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],l.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),l.setEventedParent(null),l.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,l){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const p=this.sourceCaches[n].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(l),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,l,p={}){this._checkLoaded();const _=n.id;if(this.getLayer(_))return void this.fire(new c.k(new Error(`Layer "${_}" already exists on this map.`)));let w;if(n.type==="custom"){if(ps(this,c.bL(n)))return;w=c.bI(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(_,n.source),n=c.bJ(n),n=c.e(n,{source:_})),this._validate(c.z.layer,`layers.${_}`,n,{arrayIndex:-1},p))return;w=c.bI(n),this._validateLayer(w),w.setEventedParent(this,{layer:{id:_}})}const E=l?this._order.indexOf(l):this._order.length;if(l&&E===-1)this.fire(new c.k(new Error(`Cannot add layer "${_}" before non-existing layer "${l}".`)));else{if(this._order.splice(E,0,_),this._layerOrderChanged=!0,this._layers[_]=w,this._removedLayers[_]&&w.source&&w.type!=="custom"){const P=this._removedLayers[_];delete this._removedLayers[_],P.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(n,l){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new c.k(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===l)return;const p=this._order.indexOf(n);this._order.splice(p,1);const _=l?this._order.indexOf(l):this._order.length;l&&_===-1?this.fire(new c.k(new Error(`Cannot move layer "${n}" before non-existing layer "${l}".`))):(this._order.splice(_,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const l=this._layers[n];if(!l)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${n}".`)));l.setEventedParent(null);const p=this._order.indexOf(n);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,l,p){this._checkLoaded();const _=this.getLayer(n);_?_.minzoom===l&&_.maxzoom===p||(l!=null&&(_.minzoom=l),p!=null&&(_.maxzoom=p),this._updateLayer(_)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,l,p={}){this._checkLoaded();const _=this.getLayer(n);if(_){if(!c.bG(_.filter,l))return l==null?(_.setFilter(void 0),void this._updateLayer(_)):void(this._validate(c.z.filter,`layers.${_.id}.filter`,l,null,p)||(_.setFilter(c.bJ(l)),this._updateLayer(_)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return c.bJ(this.getLayer(n).filter)}setLayoutProperty(n,l,p,_={}){this._checkLoaded();const w=this.getLayer(n);w?c.bG(w.getLayoutProperty(l),p)||(w.setLayoutProperty(l,p,_),this._updateLayer(w)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,l){const p=this.getLayer(n);if(p)return p.getLayoutProperty(l);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,l,p,_={}){this._checkLoaded();const w=this.getLayer(n);w?c.bG(w.getPaintProperty(l),p)||(w.setPaintProperty(l,p,_)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[n]=!0,this._serializedLayers=null):this.fire(new c.k(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,l){return this.getLayer(n).getPaintProperty(l)}setFeatureState(n,l){this._checkLoaded();const p=n.source,_=n.sourceLayer,w=this.sourceCaches[p];if(w===void 0)return void this.fire(new c.k(new Error(`The source '${p}' does not exist in the map's style.`)));const E=w.getSource().type;E==="geojson"&&_?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||_?(n.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),w.setFeatureState(_,n.id,l)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,l){this._checkLoaded();const p=n.source,_=this.sourceCaches[p];if(_===void 0)return void this.fire(new c.k(new Error(`The source '${p}' does not exist in the map's style.`)));const w=_.getSource().type,E=w==="vector"?n.sourceLayer:void 0;w!=="vector"||E?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(E,n.id,l):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const l=n.source,p=n.sourceLayer,_=this.sourceCaches[l];if(_!==void 0)return _.getSource().type!=="vector"||p?(n.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),_.getFeatureState(p,n.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=c.bM(this.sourceCaches,w=>w.serialize()),l=this._serializeByIds(this._order,!0),p=this.map.getTerrain()||void 0,_=this.stylesheet;return c.bN({version:_.version,name:_.name,metadata:_.metadata,light:_.light,sky:_.sky,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,projection:_.projection,sources:n,layers:l,terrain:p},w=>w!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const l=E=>this._layers[E].type==="fill-extrusion",p={},_=[];for(let E=this._order.length-1;E>=0;E--){const P=this._order[E];if(l(P)){p[P]=E;for(const D of n){const O=D[P];if(O)for(const F of O)_.push(F)}}}_.sort((E,P)=>P.intersectionZ-E.intersectionZ);const w=[];for(let E=this._order.length-1;E>=0;E--){const P=this._order[E];if(l(P))for(let D=_.length-1;D>=0;D--){const O=_[D].feature;if(p[O.layer.id]<E)break;w.push(O),_.pop()}else for(const D of n){const O=D[P];if(O)for(const F of O)w.push(F.feature)}}return w}queryRenderedFeatures(n,l,p){l&&l.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",l.filter,null,l);const _={};if(l&&l.layers){if(!(Array.isArray(l.layers)||l.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const O of l.layers){const F=this._layers[O];if(!F)return this.fire(new c.k(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];_[F.source]=!0}}const w=[];l.availableImages=this._availableImages;const E=this._serializedAllLayers(),P=l.layers instanceof Set?l.layers:Array.isArray(l.layers)?new Set(l.layers):null,D=Object.assign(Object.assign({},l),{layers:P});for(const O in this.sourceCaches)l.layers&&!_[O]||w.push(Cr(this.sourceCaches[O],this._layers,E,n,D,p,this.map.terrain?(F,q,U)=>this.map.terrain.getElevation(F,q,U):void 0));return this.placement&&w.push(function(O,F,q,U,H,ee,fe){const he={},pe=ee.queryRenderedSymbols(U),_e=[];for(const Ae of Object.keys(pe).map(Number))_e.push(fe[Ae]);_e.sort(Ds);for(const Ae of _e){const be=Ae.featureIndex.lookupSymbolFeatures(pe[Ae.bucketInstanceId],F,Ae.bucketIndex,Ae.sourceLayerIndex,H.filter,H.layers,H.availableImages,O);for(const Pe in be){const Le=he[Pe]=he[Pe]||[],xe=be[Pe];xe.sort((Ve,rt)=>{const Ye=Ae.featureSortOrder;if(Ye){const Qe=Ye.indexOf(Ve.featureIndex);return Ye.indexOf(rt.featureIndex)-Qe}return rt.featureIndex-Ve.featureIndex});for(const Ve of xe)Le.push(Ve)}}return function(Ae,be,Pe){for(const Le in Ae)for(const xe of Ae[Le])gi(xe,Pe[be[Le].source]);return Ae}(he,O,q)}(this._layers,E,this.sourceCaches,n,D,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(n,l){l&&l.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",l.filter,null,l);const p=this.sourceCaches[n];return p?function(_,w){const E=_.getRenderableIds().map(O=>_.getTileByID(O)),P=[],D={};for(let O=0;O<E.length;O++){const F=E[O],q=F.tileID.canonical.key;D[q]||(D[q]=!0,F.querySourceFeatures(P,w))}return P}(p,l):[]}getLight(){return this.light.getLight()}setLight(n,l={}){this._checkLoaded();const p=this.light.getLight();let _=!1;for(const E in n)if(!c.bG(n[E],p[E])){_=!0;break}if(!_)return;const w={now:$.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(w)}getProjection(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.projection}setProjection(n){if(this._checkLoaded(),this.projection){if(this.projection.name===n.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=n,this._setProjectionInternal(n.type)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,l={}){this._checkLoaded();const p=this.getSky();let _=!1;if(!n&&!p)return;if(n&&!p)_=!0;else if(!n&&p)_=!0;else for(const E in n)if(!c.bG(n[E],p[E])){_=!0;break}if(!_)return;const w={now:$.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,l),this.sky.updateTransitions(w)}_setProjectionInternal(n){const l=function(p){if(Array.isArray(p)){const _=new fo({type:p});return{projection:_,transform:new aa,cameraHelper:new Su(_)}}switch(p){case"mercator":return{projection:new Ol,transform:new Ur,cameraHelper:new fs};case"globe":{const _=new fo({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:_,transform:new aa,cameraHelper:new Su(_)}}case"vertical-perspective":return{projection:new Tu,transform:new ol,cameraHelper:new da};default:return c.w(`Unknown projection name: ${p}. Falling back to mercator projection.`),{projection:new Ol,transform:new Ur,cameraHelper:new fs}}}(n);this.projection=l.projection,this.map.migrateProjection(l.transform,l.cameraHelper);for(const p in this.sourceCaches)this.sourceCaches[p].reload()}_validate(n,l,p,_,w={}){return(!w||w.validate!==!1)&&ps(this,n.call(c.z,c.e({key:l,style:this.serialize(),value:p,styleSpec:c.v},_)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Bn().off(ls,this._rtlPluginLoaded);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const p=this.sourceCaches[l];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const l in this.sourceCaches)this.sourceCaches[l].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,l,p,_,w=!1){let E=!1,P=!1;const D={};for(const O of this._order){const F=this._layers[O];if(F.type!=="symbol")continue;if(!D[F.source]){const U=this.sourceCaches[F.source];D[F.source]=U.getRenderableIds(!0).map(H=>U.getTileByID(H)).sort((H,ee)=>ee.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(ee.tileID)?-1:1))}const q=this.crossTileSymbolIndex.addLayer(F,D[F.source],n.center.lng);E=E||q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent($.now(),n.zoom))&&(this.pauseablePlacement=new Ya(n,this.map.terrain,this._order,w,l,p,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,D),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit($.now()),P=!0),E&&this.pauseablePlacement.placement.setStale()),P||E)for(const O of this._order){const F=this._layers[O];F.type==="symbol"&&this.placement.updateLayerOpacities(F,D[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions($.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,l){return c._(this,void 0,void 0,function*(){const p=yield this.imageManager.getImages(l.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[l.source];return _&&_.setDependencies(l.tileID.key,l.type,l.icons),p})}getGlyphs(n,l){return c._(this,void 0,void 0,function*(){const p=yield this.glyphManager.getGlyphs(l.stacks),_=this.sourceCaches[l.source];return _&&_.setDependencies(l.tileID.key,l.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,l={}){this._checkLoaded(),n&&this._validate(c.z.glyphs,"glyphs",n,null,l)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,l,p={},_){this._checkLoaded();const w=[{id:n,url:l}],E=[...Ze(this.stylesheet.sprite),...w];this._validate(c.z.sprite,"sprite",E,null,p)||(this.stylesheet.sprite=E,this._loadSprite(w,!0,_))}removeSprite(n){this._checkLoaded();const l=Ze(this.stylesheet.sprite);if(l.find(p=>p.id===n)){if(this._spritesImagesIds[n])for(const p of this._spritesImagesIds[n])this.imageManager.removeImage(p),this._changedImages[p]=!0;l.splice(l.findIndex(p=>p.id===n),1),this.stylesheet.sprite=l.length>0?l:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return Ze(this.stylesheet.sprite)}setSprite(n,l={},p){this._checkLoaded(),n&&this._validate(c.z.sprite,"sprite",n,null,l)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,p):(this._unloadSprite(),p&&p(null)))}}var fd=c.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class pd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,l,p,_,w,E,P,D,O){this.context=n;let F=this.boundPaintVertexBuffers.length!==_.length;for(let q=0;!F&&q<_.length;q++)this.boundPaintVertexBuffers[q]!==_[q]&&(F=!0);!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||F||this.boundIndexBuffer!==w||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==P||this.boundDynamicVertexBuffer2!==D||this.boundDynamicVertexBuffer3!==O?this.freshBind(l,p,_,w,E,P,D,O):(n.bindVertexArray.set(this.vao),P&&P.bind(),w&&w.dynamicDraw&&w.bind(),D&&D.bind(),O&&O.bind())}freshBind(n,l,p,_,w,E,P,D){const O=n.numAttributes,F=this.context,q=F.gl;this.vao&&this.destroy(),this.vao=F.createVertexArray(),F.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=P,this.boundDynamicVertexBuffer3=D,l.enableAttributes(q,n);for(const U of p)U.enableAttributes(q,n);E&&E.enableAttributes(q,n),P&&P.enableAttributes(q,n),D&&D.enableAttributes(q,n),l.bind(),l.setVertexAttribPointers(q,n,w);for(const U of p)U.bind(),U.setVertexAttribPointers(q,n,w);E&&(E.bind(),E.setVertexAttribPointers(q,n,w)),_&&_.bind(),P&&(P.bind(),P.setVertexAttribPointers(q,n,w)),D&&(D.bind(),D.setVertexAttribPointers(q,n,w)),F.currentNumAttributes=O}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Ec=(b,n,l,p,_)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:n,u_fog_color:l?l.properties.get("fog-color"):c.be.white,u_fog_ground_blend:l?l.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:_?0:l?l.calculateFogBlendOpacity(p):0,u_horizon_color:l?l.properties.get("horizon-color"):c.be.white,u_horizon_fog_blend:l?l.properties.get("horizon-fog-blend"):1,u_is_globe_mode:_?1:0}),Fa={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Eu(b){const n=[];for(let l=0;l<b.length;l++){if(b[l]===null)continue;const p=b[l].split(" ");n.push(p.pop())}return n}class Au{constructor(n,l,p,_,w,E,P,D,O=[]){const F=n.gl;this.program=F.createProgram();const q=Eu(l.staticAttributes),U=p?p.getBinderAttributes():[],H=q.concat(U),ee=wa.prelude.staticUniforms?Eu(wa.prelude.staticUniforms):[],fe=P.staticUniforms?Eu(P.staticUniforms):[],he=l.staticUniforms?Eu(l.staticUniforms):[],pe=p?p.getBinderUniforms():[],_e=ee.concat(fe).concat(he).concat(pe),Ae=[];for(const Ye of _e)Ae.indexOf(Ye)<0&&Ae.push(Ye);const be=p?p.defines():[];Dn(F)&&be.unshift("#version 300 es"),w&&be.push("#define OVERDRAW_INSPECTOR;"),E&&be.push("#define TERRAIN3D;"),D&&be.push(D),O&&be.push(...O);let Pe=be.concat(wa.prelude.fragmentSource,P.fragmentSource,l.fragmentSource).join(`
`),Le=be.concat(wa.prelude.vertexSource,P.vertexSource,l.vertexSource).join(`
`);Dn(F)||(Pe=function(Ye){return Ye.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Pe),Le=function(Ye){return Ye.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Le));const xe=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(xe,Pe),F.compileShader(xe),!F.getShaderParameter(xe,F.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${F.getShaderInfoLog(xe)}`);F.attachShader(this.program,xe);const Ve=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(Ve,Le),F.compileShader(Ve),!F.getShaderParameter(Ve,F.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${F.getShaderInfoLog(Ve)}`);F.attachShader(this.program,Ve),this.attributes={};const rt={};this.numAttributes=H.length;for(let Ye=0;Ye<this.numAttributes;Ye++)H[Ye]&&(F.bindAttribLocation(this.program,Ye,H[Ye]),this.attributes[H[Ye]]=Ye);if(F.linkProgram(this.program),!F.getProgramParameter(this.program,F.LINK_STATUS))throw new Error(`Program failed to link: ${F.getProgramInfoLog(this.program)}`);F.deleteShader(Ve),F.deleteShader(xe);for(let Ye=0;Ye<Ae.length;Ye++){const Qe=Ae[Ye];if(Qe&&!rt[Qe]){const ot=F.getUniformLocation(this.program,Qe);ot&&(rt[Qe]=ot)}}this.fixedUniforms=_(n,rt),this.terrainUniforms=((Ye,Qe)=>({u_depth:new c.bO(Ye,Qe.u_depth),u_terrain:new c.bO(Ye,Qe.u_terrain),u_terrain_dim:new c.bf(Ye,Qe.u_terrain_dim),u_terrain_matrix:new c.bQ(Ye,Qe.u_terrain_matrix),u_terrain_unpack:new c.bR(Ye,Qe.u_terrain_unpack),u_terrain_exaggeration:new c.bf(Ye,Qe.u_terrain_exaggeration)}))(n,rt),this.projectionUniforms=((Ye,Qe)=>({u_projection_matrix:new c.bQ(Ye,Qe.u_projection_matrix),u_projection_tile_mercator_coords:new c.bR(Ye,Qe.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bR(Ye,Qe.u_projection_clipping_plane),u_projection_transition:new c.bf(Ye,Qe.u_projection_transition),u_projection_fallback_matrix:new c.bQ(Ye,Qe.u_projection_fallback_matrix)}))(n,rt),this.binderUniforms=p?p.getUniforms(n,rt):[]}draw(n,l,p,_,w,E,P,D,O,F,q,U,H,ee,fe,he,pe,_e,Ae){const be=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(p),n.setStencilMode(_),n.setColorMode(w),n.setCullFace(E),D){n.activeTexture.set(be.TEXTURE2),be.bindTexture(be.TEXTURE_2D,D.depthTexture),n.activeTexture.set(be.TEXTURE3),be.bindTexture(be.TEXTURE_2D,D.texture);for(const Le in this.terrainUniforms)this.terrainUniforms[Le].set(D[Le])}if(O)for(const Le in O)this.projectionUniforms[Fa[Le]].set(O[Le]);if(P)for(const Le in this.fixedUniforms)this.fixedUniforms[Le].set(P[Le]);he&&he.setUniforms(n,this.binderUniforms,ee,{zoom:fe});let Pe=0;switch(l){case be.LINES:Pe=2;break;case be.TRIANGLES:Pe=3;break;case be.LINE_STRIP:Pe=1}for(const Le of H.get()){const xe=Le.vaos||(Le.vaos={});(xe[F]||(xe[F]=new pd)).bind(n,this,q,he?he.getPaintVertexBuffers():[],U,Le.vertexOffset,pe,_e,Ae),be.drawElements(l,Le.primitiveLength*Pe,be.UNSIGNED_SHORT,Le.primitiveOffset*Pe*2)}}}function ms(b,n,l){const p=1/c.aB(l,1,n.transform.tileZoom),_=Math.pow(2,l.tileID.overscaledZ),w=l.tileSize*Math.pow(2,n.transform.tileZoom)/_,E=w*(l.tileID.canonical.x+l.tileID.wrap*_),P=w*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[p,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[E>>16,P>>16],u_pixel_coord_lower:[65535&E,65535&P]}}const A=(b,n,l,p)=>{const _=b.style.light,w=_.properties.get("position"),E=[w.x,w.y,w.z],P=c.bU();_.properties.get("anchor")==="viewport"&&c.bV(P,b.transform.bearingInRadians),c.bW(E,E,P);const D=b.transform.transformLightDirection(E),O=_.properties.get("color");return{u_lightpos:E,u_lightpos_globe:D,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[O.r,O.g,O.b],u_vertical_gradient:+n,u_opacity:l,u_fill_translate:p}},V=(b,n,l,p,_,w,E)=>c.e(A(b,n,l,p),ms(w,b,E),{u_height_factor:-Math.pow(2,_.overscaledZ)/E.tileSize/8}),Z=(b,n,l,p)=>c.e(ms(n,b,l),{u_fill_translate:p}),ce=(b,n)=>({u_world:b,u_fill_translate:n}),Je=(b,n,l,p,_)=>c.e(Z(b,n,l,_),{u_world:p}),pt=(b,n,l,p,_)=>{const w=b.transform;let E,P,D=0;if(l.paint.get("circle-pitch-alignment")==="map"){const O=c.aB(n,1,w.zoom);E=!0,P=[O,O],D=O/(c.$*Math.pow(2,n.tileID.overscaledZ))*2*Math.PI*_}else E=!1,P=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:P,u_globe_extrude_scale:D,u_translate:p}},Vt=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),Gn=b=>({u_viewport_size:[b.width,b.height]}),Ni=(b,n=1)=>({u_color:b,u_overlay:0,u_overlay_scale:n}),Hn=(b,n,l,p)=>{const _=c.aB(b,1,n)/(c.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*p;return{u_extrude_scale:c.aB(b,1,n),u_intensity:l,u_globe_extrude_scale:_}},Zi=(b,n,l,p)=>{const _=c.L();c.bX(_,0,b.width,b.height,0,0,1);const w=b.context.gl;return{u_matrix:_,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:l,u_color_ramp:p,u_opacity:n.paint.get("heatmap-opacity")}},ei=(b,n,l)=>{const p=l.paint.get("hillshade-accent-color");let _;switch(l.paint.get("hillshade-method")){case"basic":_=4;break;case"combined":_=1;break;case"igor":_=2;break;case"multidirectional":_=3;break;default:_=0}const w=l.getIlluminationProperties();for(let E=0;E<w.directionRadians.length;E++)l.paint.get("hillshade-illumination-anchor")==="viewport"&&(w.directionRadians[E]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:sa(0,n.tileID),u_exaggeration:l.paint.get("hillshade-exaggeration"),u_altitudes:w.altitudeRadians,u_azimuths:w.directionRadians,u_accent:p,u_method:_,u_highlights:w.highlightColor,u_shadows:w.shadowColor}},ul=(b,n)=>{const l=n.stride,p=c.L();return c.bX(p,0,c.$,-8192,0,0,1),c.M(p,p,[0,-8192,0]),{u_matrix:p,u_image:1,u_dimension:[l,l],u_zoom:b.overscaledZ,u_unpack:n.getUnpackVector()}};function sa(b,n){const l=Math.pow(2,n.canonical.z),p=n.canonical.y;return[new c.a0(0,p/l).toLngLat().lat,new c.a0(0,(p+1)/l).toLngLat().lat]}const Vo=(b,n)=>({u_image:0,u_unpack:n.getUnpackVector(),u_dimension:[n.stride,n.stride],u_elevation_stops:1,u_color_stops:4,u_opacity:b.paint.get("color-relief-opacity")}),jl=(b,n,l,p)=>{const _=b.transform;return{u_translation:vh(b,n,l),u_ratio:p/c.aB(n,1,_.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Ac=(b,n,l,p,_)=>c.e(jl(b,n,l,p),{u_image:0,u_image_height:_}),If=(b,n,l,p,_)=>{const w=b.transform,E=_h(n,w);return{u_translation:vh(b,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:p/c.aB(n,1,w.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[E,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},Mf=(b,n,l,p,_,w)=>{const E=b.lineAtlas,P=_h(n,b.transform),D=l.layout.get("line-cap")==="round",O=E.getDash(_.from,D),F=E.getDash(_.to,D),q=O.width*w.fromScale,U=F.width*w.toScale;return c.e(jl(b,n,l,p),{u_patternscale_a:[P/q,-O.height/2],u_patternscale_b:[P/U,-F.height/2],u_sdfgamma:E.width/(256*Math.min(q,U)*b.pixelRatio)/2,u_image:0,u_tex_y_a:O.y,u_tex_y_b:F.y,u_mix:w.t})};function _h(b,n){return 1/c.aB(b,1,n.tileZoom)}function vh(b,n,l){return c.aC(b.transform,n,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const Ul=(b,n,l,p,_)=>{return{u_tl_parent:b,u_scale_parent:n,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(E=p.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(w=p.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Pf(p.paint.get("raster-hue-rotate")),u_coords_top:[_[0].x,_[0].y,_[1].x,_[1].y],u_coords_bottom:[_[3].x,_[3].y,_[2].x,_[2].y]};var w,E};function Pf(b){b*=Math.PI/180;const n=Math.sin(b),l=Math.cos(b);return[(2*l+1)/3,(-Math.sqrt(3)*n-l+1)/3,(Math.sqrt(3)*n-l+1)/3]}const md=(b,n,l,p,_,w,E,P,D,O,F,q,U)=>{const H=E.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:H.cameraToCenterDistance,u_pitch:H.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:H.width/H.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:P,u_coord_matrix:D,u_is_text:+F,u_pitch_with_map:+p,u_is_along_line:_,u_is_variable_anchor:w,u_texsize:q,u_texture:0,u_translation:O,u_pitched_scale:U}},Cc=(b,n,l,p,_,w,E,P,D,O,F,q,U,H)=>{const ee=E.transform;return c.e(md(b,n,l,p,_,w,E,P,D,O,F,q,H),{u_gamma_scale:p?Math.cos(ee.pitch*Math.PI/180)*ee.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},Ig=(b,n,l,p,_,w,E,P,D,O,F,q,U)=>c.e(Cc(b,n,l,p,_,w,E,P,D,O,!0,F,0,U),{u_texsize_icon:q,u_texture_icon:1}),gd=(b,n)=>({u_opacity:b,u_color:n}),Mg=(b,n,l,p,_)=>c.e(function(w,E,P,D){const O=P.imageManager.getPattern(w.from.toString()),F=P.imageManager.getPattern(w.to.toString()),{width:q,height:U}=P.imageManager.getPixelSize(),H=Math.pow(2,D.tileID.overscaledZ),ee=D.tileSize*Math.pow(2,P.transform.tileZoom)/H,fe=ee*(D.tileID.canonical.x+D.tileID.wrap*H),he=ee*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[q,U],u_mix:E.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/c.aB(D,1,P.transform.tileZoom),u_pixel_coord_upper:[fe>>16,he>>16],u_pixel_coord_lower:[65535&fe,65535&he]}}(l,_,n,p),{u_opacity:b}),Jp=(b,n)=>{},es={fillExtrusion:(b,n)=>({u_lightpos:new c.bS(b,n.u_lightpos),u_lightpos_globe:new c.bS(b,n.u_lightpos_globe),u_lightintensity:new c.bf(b,n.u_lightintensity),u_lightcolor:new c.bS(b,n.u_lightcolor),u_vertical_gradient:new c.bf(b,n.u_vertical_gradient),u_opacity:new c.bf(b,n.u_opacity),u_fill_translate:new c.bT(b,n.u_fill_translate)}),fillExtrusionPattern:(b,n)=>({u_lightpos:new c.bS(b,n.u_lightpos),u_lightpos_globe:new c.bS(b,n.u_lightpos_globe),u_lightintensity:new c.bf(b,n.u_lightintensity),u_lightcolor:new c.bS(b,n.u_lightcolor),u_vertical_gradient:new c.bf(b,n.u_vertical_gradient),u_height_factor:new c.bf(b,n.u_height_factor),u_opacity:new c.bf(b,n.u_opacity),u_fill_translate:new c.bT(b,n.u_fill_translate),u_image:new c.bO(b,n.u_image),u_texsize:new c.bT(b,n.u_texsize),u_pixel_coord_upper:new c.bT(b,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(b,n.u_pixel_coord_lower),u_scale:new c.bS(b,n.u_scale),u_fade:new c.bf(b,n.u_fade)}),fill:(b,n)=>({u_fill_translate:new c.bT(b,n.u_fill_translate)}),fillPattern:(b,n)=>({u_image:new c.bO(b,n.u_image),u_texsize:new c.bT(b,n.u_texsize),u_pixel_coord_upper:new c.bT(b,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(b,n.u_pixel_coord_lower),u_scale:new c.bS(b,n.u_scale),u_fade:new c.bf(b,n.u_fade),u_fill_translate:new c.bT(b,n.u_fill_translate)}),fillOutline:(b,n)=>({u_world:new c.bT(b,n.u_world),u_fill_translate:new c.bT(b,n.u_fill_translate)}),fillOutlinePattern:(b,n)=>({u_world:new c.bT(b,n.u_world),u_image:new c.bO(b,n.u_image),u_texsize:new c.bT(b,n.u_texsize),u_pixel_coord_upper:new c.bT(b,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(b,n.u_pixel_coord_lower),u_scale:new c.bS(b,n.u_scale),u_fade:new c.bf(b,n.u_fade),u_fill_translate:new c.bT(b,n.u_fill_translate)}),circle:(b,n)=>({u_camera_to_center_distance:new c.bf(b,n.u_camera_to_center_distance),u_scale_with_map:new c.bO(b,n.u_scale_with_map),u_pitch_with_map:new c.bO(b,n.u_pitch_with_map),u_extrude_scale:new c.bT(b,n.u_extrude_scale),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_globe_extrude_scale:new c.bf(b,n.u_globe_extrude_scale),u_translate:new c.bT(b,n.u_translate)}),collisionBox:(b,n)=>({u_pixel_extrude_scale:new c.bT(b,n.u_pixel_extrude_scale)}),collisionCircle:(b,n)=>({u_viewport_size:new c.bT(b,n.u_viewport_size)}),debug:(b,n)=>({u_color:new c.bP(b,n.u_color),u_overlay:new c.bO(b,n.u_overlay),u_overlay_scale:new c.bf(b,n.u_overlay_scale)}),depth:Jp,clippingMask:Jp,heatmap:(b,n)=>({u_extrude_scale:new c.bf(b,n.u_extrude_scale),u_intensity:new c.bf(b,n.u_intensity),u_globe_extrude_scale:new c.bf(b,n.u_globe_extrude_scale)}),heatmapTexture:(b,n)=>({u_matrix:new c.bQ(b,n.u_matrix),u_world:new c.bT(b,n.u_world),u_image:new c.bO(b,n.u_image),u_color_ramp:new c.bO(b,n.u_color_ramp),u_opacity:new c.bf(b,n.u_opacity)}),hillshade:(b,n)=>({u_image:new c.bO(b,n.u_image),u_latrange:new c.bT(b,n.u_latrange),u_exaggeration:new c.bf(b,n.u_exaggeration),u_altitudes:new c.bZ(b,n.u_altitudes),u_azimuths:new c.bZ(b,n.u_azimuths),u_accent:new c.bP(b,n.u_accent),u_method:new c.bO(b,n.u_method),u_shadows:new c.bY(b,n.u_shadows),u_highlights:new c.bY(b,n.u_highlights)}),hillshadePrepare:(b,n)=>({u_matrix:new c.bQ(b,n.u_matrix),u_image:new c.bO(b,n.u_image),u_dimension:new c.bT(b,n.u_dimension),u_zoom:new c.bf(b,n.u_zoom),u_unpack:new c.bR(b,n.u_unpack)}),colorRelief:(b,n)=>({u_image:new c.bO(b,n.u_image),u_unpack:new c.bR(b,n.u_unpack),u_dimension:new c.bT(b,n.u_dimension),u_elevation_stops:new c.bO(b,n.u_elevation_stops),u_color_stops:new c.bO(b,n.u_color_stops),u_opacity:new c.bf(b,n.u_opacity)}),line:(b,n)=>({u_translation:new c.bT(b,n.u_translation),u_ratio:new c.bf(b,n.u_ratio),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_units_to_pixels:new c.bT(b,n.u_units_to_pixels)}),lineGradient:(b,n)=>({u_translation:new c.bT(b,n.u_translation),u_ratio:new c.bf(b,n.u_ratio),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_units_to_pixels:new c.bT(b,n.u_units_to_pixels),u_image:new c.bO(b,n.u_image),u_image_height:new c.bf(b,n.u_image_height)}),linePattern:(b,n)=>({u_translation:new c.bT(b,n.u_translation),u_texsize:new c.bT(b,n.u_texsize),u_ratio:new c.bf(b,n.u_ratio),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_image:new c.bO(b,n.u_image),u_units_to_pixels:new c.bT(b,n.u_units_to_pixels),u_scale:new c.bS(b,n.u_scale),u_fade:new c.bf(b,n.u_fade)}),lineSDF:(b,n)=>({u_translation:new c.bT(b,n.u_translation),u_ratio:new c.bf(b,n.u_ratio),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_units_to_pixels:new c.bT(b,n.u_units_to_pixels),u_patternscale_a:new c.bT(b,n.u_patternscale_a),u_patternscale_b:new c.bT(b,n.u_patternscale_b),u_sdfgamma:new c.bf(b,n.u_sdfgamma),u_image:new c.bO(b,n.u_image),u_tex_y_a:new c.bf(b,n.u_tex_y_a),u_tex_y_b:new c.bf(b,n.u_tex_y_b),u_mix:new c.bf(b,n.u_mix)}),raster:(b,n)=>({u_tl_parent:new c.bT(b,n.u_tl_parent),u_scale_parent:new c.bf(b,n.u_scale_parent),u_buffer_scale:new c.bf(b,n.u_buffer_scale),u_fade_t:new c.bf(b,n.u_fade_t),u_opacity:new c.bf(b,n.u_opacity),u_image0:new c.bO(b,n.u_image0),u_image1:new c.bO(b,n.u_image1),u_brightness_low:new c.bf(b,n.u_brightness_low),u_brightness_high:new c.bf(b,n.u_brightness_high),u_saturation_factor:new c.bf(b,n.u_saturation_factor),u_contrast_factor:new c.bf(b,n.u_contrast_factor),u_spin_weights:new c.bS(b,n.u_spin_weights),u_coords_top:new c.bR(b,n.u_coords_top),u_coords_bottom:new c.bR(b,n.u_coords_bottom)}),symbolIcon:(b,n)=>({u_is_size_zoom_constant:new c.bO(b,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(b,n.u_is_size_feature_constant),u_size_t:new c.bf(b,n.u_size_t),u_size:new c.bf(b,n.u_size),u_camera_to_center_distance:new c.bf(b,n.u_camera_to_center_distance),u_pitch:new c.bf(b,n.u_pitch),u_rotate_symbol:new c.bO(b,n.u_rotate_symbol),u_aspect_ratio:new c.bf(b,n.u_aspect_ratio),u_fade_change:new c.bf(b,n.u_fade_change),u_label_plane_matrix:new c.bQ(b,n.u_label_plane_matrix),u_coord_matrix:new c.bQ(b,n.u_coord_matrix),u_is_text:new c.bO(b,n.u_is_text),u_pitch_with_map:new c.bO(b,n.u_pitch_with_map),u_is_along_line:new c.bO(b,n.u_is_along_line),u_is_variable_anchor:new c.bO(b,n.u_is_variable_anchor),u_texsize:new c.bT(b,n.u_texsize),u_texture:new c.bO(b,n.u_texture),u_translation:new c.bT(b,n.u_translation),u_pitched_scale:new c.bf(b,n.u_pitched_scale)}),symbolSDF:(b,n)=>({u_is_size_zoom_constant:new c.bO(b,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(b,n.u_is_size_feature_constant),u_size_t:new c.bf(b,n.u_size_t),u_size:new c.bf(b,n.u_size),u_camera_to_center_distance:new c.bf(b,n.u_camera_to_center_distance),u_pitch:new c.bf(b,n.u_pitch),u_rotate_symbol:new c.bO(b,n.u_rotate_symbol),u_aspect_ratio:new c.bf(b,n.u_aspect_ratio),u_fade_change:new c.bf(b,n.u_fade_change),u_label_plane_matrix:new c.bQ(b,n.u_label_plane_matrix),u_coord_matrix:new c.bQ(b,n.u_coord_matrix),u_is_text:new c.bO(b,n.u_is_text),u_pitch_with_map:new c.bO(b,n.u_pitch_with_map),u_is_along_line:new c.bO(b,n.u_is_along_line),u_is_variable_anchor:new c.bO(b,n.u_is_variable_anchor),u_texsize:new c.bT(b,n.u_texsize),u_texture:new c.bO(b,n.u_texture),u_gamma_scale:new c.bf(b,n.u_gamma_scale),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_is_halo:new c.bO(b,n.u_is_halo),u_translation:new c.bT(b,n.u_translation),u_pitched_scale:new c.bf(b,n.u_pitched_scale)}),symbolTextAndIcon:(b,n)=>({u_is_size_zoom_constant:new c.bO(b,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(b,n.u_is_size_feature_constant),u_size_t:new c.bf(b,n.u_size_t),u_size:new c.bf(b,n.u_size),u_camera_to_center_distance:new c.bf(b,n.u_camera_to_center_distance),u_pitch:new c.bf(b,n.u_pitch),u_rotate_symbol:new c.bO(b,n.u_rotate_symbol),u_aspect_ratio:new c.bf(b,n.u_aspect_ratio),u_fade_change:new c.bf(b,n.u_fade_change),u_label_plane_matrix:new c.bQ(b,n.u_label_plane_matrix),u_coord_matrix:new c.bQ(b,n.u_coord_matrix),u_is_text:new c.bO(b,n.u_is_text),u_pitch_with_map:new c.bO(b,n.u_pitch_with_map),u_is_along_line:new c.bO(b,n.u_is_along_line),u_is_variable_anchor:new c.bO(b,n.u_is_variable_anchor),u_texsize:new c.bT(b,n.u_texsize),u_texsize_icon:new c.bT(b,n.u_texsize_icon),u_texture:new c.bO(b,n.u_texture),u_texture_icon:new c.bO(b,n.u_texture_icon),u_gamma_scale:new c.bf(b,n.u_gamma_scale),u_device_pixel_ratio:new c.bf(b,n.u_device_pixel_ratio),u_is_halo:new c.bO(b,n.u_is_halo),u_translation:new c.bT(b,n.u_translation),u_pitched_scale:new c.bf(b,n.u_pitched_scale)}),background:(b,n)=>({u_opacity:new c.bf(b,n.u_opacity),u_color:new c.bP(b,n.u_color)}),backgroundPattern:(b,n)=>({u_opacity:new c.bf(b,n.u_opacity),u_image:new c.bO(b,n.u_image),u_pattern_tl_a:new c.bT(b,n.u_pattern_tl_a),u_pattern_br_a:new c.bT(b,n.u_pattern_br_a),u_pattern_tl_b:new c.bT(b,n.u_pattern_tl_b),u_pattern_br_b:new c.bT(b,n.u_pattern_br_b),u_texsize:new c.bT(b,n.u_texsize),u_mix:new c.bf(b,n.u_mix),u_pattern_size_a:new c.bT(b,n.u_pattern_size_a),u_pattern_size_b:new c.bT(b,n.u_pattern_size_b),u_scale_a:new c.bf(b,n.u_scale_a),u_scale_b:new c.bf(b,n.u_scale_b),u_pixel_coord_upper:new c.bT(b,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(b,n.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bf(b,n.u_tile_units_to_pixels)}),terrain:(b,n)=>({u_texture:new c.bO(b,n.u_texture),u_ele_delta:new c.bf(b,n.u_ele_delta),u_fog_matrix:new c.bQ(b,n.u_fog_matrix),u_fog_color:new c.bP(b,n.u_fog_color),u_fog_ground_blend:new c.bf(b,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bf(b,n.u_fog_ground_blend_opacity),u_horizon_color:new c.bP(b,n.u_horizon_color),u_horizon_fog_blend:new c.bf(b,n.u_horizon_fog_blend),u_is_globe_mode:new c.bf(b,n.u_is_globe_mode)}),terrainDepth:(b,n)=>({u_ele_delta:new c.bf(b,n.u_ele_delta)}),terrainCoords:(b,n)=>({u_texture:new c.bO(b,n.u_texture),u_terrain_coords_id:new c.bf(b,n.u_terrain_coords_id),u_ele_delta:new c.bf(b,n.u_ele_delta)}),projectionErrorMeasurement:(b,n)=>({u_input:new c.bf(b,n.u_input),u_output_expected:new c.bf(b,n.u_output_expected)}),atmosphere:(b,n)=>({u_sun_pos:new c.bS(b,n.u_sun_pos),u_atmosphere_blend:new c.bf(b,n.u_atmosphere_blend),u_globe_position:new c.bS(b,n.u_globe_position),u_globe_radius:new c.bf(b,n.u_globe_radius),u_inv_proj_matrix:new c.bQ(b,n.u_inv_proj_matrix)}),sky:(b,n)=>({u_sky_color:new c.bP(b,n.u_sky_color),u_horizon_color:new c.bP(b,n.u_horizon_color),u_horizon:new c.bT(b,n.u_horizon),u_horizon_normal:new c.bT(b,n.u_horizon_normal),u_sky_horizon_blend:new c.bf(b,n.u_sky_horizon_blend),u_sky_blend:new c.bf(b,n.u_sky_blend)})};class Ic{constructor(n,l,p){this.context=n;const _=n.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const l=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Rf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class yd{constructor(n,l,p,_){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=_,this.context=n;const w=n.gl;this.buffer=w.createBuffer(),n.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,l){for(let p=0;p<this.attributes.length;p++){const _=l.attributes[this.attributes[p].name];_!==void 0&&n.enableVertexAttribArray(_)}}setVertexAttribPointers(n,l,p){for(let _=0;_<this.attributes.length;_++){const w=this.attributes[_],E=l.attributes[w.name];E!==void 0&&n.vertexAttribPointer(E,w.components,n[Rf[w.type]],!1,this.itemSize,w.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class nr{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class bh extends nr{getDefault(){return c.be.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class mo extends nr{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class kf extends nr{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class ql extends nr{getDefault(){return[!0,!0,!0,!0]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class xh extends nr{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Mc extends nr{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class wh extends nr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class $l extends nr{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class cl extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}}class Pc extends nr{getDefault(){return[0,1]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Df extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}}class em extends nr{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Cu extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}}class Lf extends nr{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class tm extends nr{getDefault(){return c.be.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class zf extends nr{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class _d extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}}class vd extends nr{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class bd extends nr{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class xd extends nr{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Gl extends nr{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Iu extends nr{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ea extends nr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class gs extends nr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class ys extends nr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class _s extends nr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Hl extends nr{getDefault(){return null}set(n){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class hl extends nr{getDefault(){return null}set(n){var l;if(n===this.current&&!this.dirty)return;const p=this.gl;Dn(p)?p.bindVertexArray(n):(l=p.getExtension("OES_vertex_array_object"))===null||l===void 0||l.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class Mu extends nr{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Pu extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Ru extends nr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class go extends nr{constructor(n,l){super(n),this.context=n,this.parent=l}getDefault(){return null}}class Of extends go{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class dl extends go{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class yo extends go{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}const Nf="Framebuffer is not complete";class Va{constructor(n,l,p,_,w){this.context=n,this.width=l,this.height=p;const E=n.gl,P=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Of(n,P),_)this.depthAttachment=w?new yo(n,P):new dl(n,P);else if(w)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(Nf)}destroy(){const n=this.context.gl,l=this.colorAttachment.get();if(l&&n.deleteTexture(l),this.depthAttachment){const p=this.depthAttachment.get();p&&n.deleteRenderbuffer(p)}n.deleteFramebuffer(this.framebuffer)}}class zn{constructor(n){var l,p;if(this.gl=n,this.clearColor=new bh(this),this.clearDepth=new mo(this),this.clearStencil=new kf(this),this.colorMask=new ql(this),this.depthMask=new xh(this),this.stencilMask=new Mc(this),this.stencilFunc=new wh(this),this.stencilOp=new $l(this),this.stencilTest=new cl(this),this.depthRange=new Pc(this),this.depthTest=new Df(this),this.depthFunc=new em(this),this.blend=new Cu(this),this.blendFunc=new Lf(this),this.blendColor=new tm(this),this.blendEquation=new zf(this),this.cullFace=new _d(this),this.cullFaceSide=new vd(this),this.frontFace=new bd(this),this.program=new xd(this),this.activeTexture=new Gl(this),this.viewport=new Iu(this),this.bindFramebuffer=new Ea(this),this.bindRenderbuffer=new gs(this),this.bindTexture=new ys(this),this.bindVertexBuffer=new _s(this),this.bindElementBuffer=new Hl(this),this.bindVertexArray=new hl(this),this.pixelStoreUnpack=new Mu(this),this.pixelStoreUnpackPremultiplyAlpha=new Pu(this),this.pixelStoreUnpackFlipY=new Ru(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Dn(n)){this.HALF_FLOAT=n.HALF_FLOAT;const _=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(l=n.RGBA16F)!==null&&l!==void 0?l:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(p=n.RGB16F)!==null&&p!==void 0?p:_==null?void 0:_.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const _=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,l){return new Ic(this,n,l)}createVertexBuffer(n,l,p){return new yd(this,n,l,p)}createRenderbuffer(n,l,p){const _=this.gl,w=_.createRenderbuffer();return this.bindRenderbuffer.set(w),_.renderbufferStorage(_.RENDERBUFFER,n,l,p),this.bindRenderbuffer.set(null),w}createFramebuffer(n,l,p,_){return new Va(this,n,l,p,_)}clear({color:n,depth:l,stencil:p}){const _=this.gl;let w=0;n&&(w|=_.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(w|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(w|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),_.clear(w)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){c.bG(n.blendFunction,In.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Dn(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var l;return Dn(this.gl)?this.gl.deleteVertexArray(n):(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}let ja;function Bf(b,n,l,p,_){const w=b.context,E=b.transform,P=w.gl,D=b.useProgram("collisionBox"),O=[];let F=0,q=0;for(let pe=0;pe<p.length;pe++){const _e=p[pe],Ae=n.getTile(_e).getBucket(l);if(!Ae)continue;const be=_?Ae.textCollisionBox:Ae.iconCollisionBox,Pe=Ae.collisionCircleArray;Pe.length>0&&(O.push({circleArray:Pe,circleOffset:q,coord:_e}),F+=Pe.length/4,q=F),be&&D.draw(w,P.LINES,mn.disabled,ln.disabled,b.colorModeForRenderPass(),_n.disabled,Vt(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(_e),E.getProjectionData({overscaledTileID:_e,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),l.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,null,b.transform.zoom,null,null,be.collisionVertexBuffer)}if(!_||!O.length)return;const U=b.useProgram("collisionCircle"),H=new c.b_;H.resize(4*F),H._trim();let ee=0;for(const pe of O)for(let _e=0;_e<pe.circleArray.length/4;_e++){const Ae=4*_e,be=pe.circleArray[Ae+0],Pe=pe.circleArray[Ae+1],Le=pe.circleArray[Ae+2],xe=pe.circleArray[Ae+3];H.emplace(ee++,be,Pe,Le,xe,0),H.emplace(ee++,be,Pe,Le,xe,1),H.emplace(ee++,be,Pe,Le,xe,2),H.emplace(ee++,be,Pe,Le,xe,3)}(!ja||ja.length<2*F)&&(ja=function(pe){const _e=2*pe,Ae=new c.c0;Ae.resize(_e),Ae._trim();for(let be=0;be<_e;be++){const Pe=6*be;Ae.uint16[Pe+0]=4*be+0,Ae.uint16[Pe+1]=4*be+1,Ae.uint16[Pe+2]=4*be+2,Ae.uint16[Pe+3]=4*be+2,Ae.uint16[Pe+4]=4*be+3,Ae.uint16[Pe+5]=4*be+0}return Ae}(F));const fe=w.createIndexBuffer(ja,!0),he=w.createVertexBuffer(H,c.b$.members,!0);for(const pe of O){const _e=Gn(b.transform);U.draw(w,P.TRIANGLES,mn.disabled,ln.disabled,b.colorModeForRenderPass(),_n.disabled,_e,b.style.map.terrain&&b.style.map.terrain.getTerrainData(pe.coord),null,l.id,he,fe,c.aL.simpleSegment(0,2*pe.circleOffset,pe.circleArray.length,pe.circleArray.length/2),null,b.transform.zoom,null,null,null)}he.destroy(),fe.destroy()}const Th=c.af(new Float32Array(16));function _o(b,n,l,p,_,w){const{horizontalAlign:E,verticalAlign:P}=c.aG(b);return new c.P((-(E-.5)*n/_+p[0])*w,(-(P-.5)*l/_+p[1])*w)}function Ff(b,n,l,p,_,w){const E=n.tileAnchorPoint.add(new c.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let P=p.mult(w);l||(P=P.rotate(-_));const D=E.add(P);return Cn(D.x,D.y,n.pitchedLabelPlaneMatrix,n.getElevation).point}if(l){const P=Dt(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(b),D=Math.atan(P.y/P.x)+(P.x<0?Math.PI:0);return b.add(p.rotate(D))}return b.add(p)}function Vf(b,n,l,p,_,w,E,P,D,O,F,q){const U=b.text.placedSymbolArray,H=b.text.dynamicLayoutVertexArray,ee=b.icon.dynamicLayoutVertexArray,fe={};H.clear();for(let he=0;he<U.length;he++){const pe=U.get(he),_e=pe.hidden||!pe.crossTileID||b.allowVerticalPlacement&&!pe.placedOrientation?null:p[pe.crossTileID];if(_e){const Ae=new c.P(pe.anchorX,pe.anchorY),be={getElevation:q,width:_.width,height:_.height,pitchedLabelPlaneMatrix:w,pitchWithMap:l,transform:_,tileAnchorPoint:Ae,translation:O,unwrappedTileID:F},Pe=l?nn(Ae.x,Ae.y,be):Dt(Ae.x,Ae.y,be),Le=cn(_.cameraToCenterDistance,Pe.signedDistanceFromCamera);let xe=c.ao(b.textSizeData,P,pe)*Le/c.aA;l&&(xe*=b.tilePixelRatio/E);const{width:Ve,height:rt,anchor:Ye,textOffset:Qe,textBoxScale:ot}=_e,zt=_o(Ye,Ve,rt,Qe,ot,xe),Lt=_.getPitchedTextCorrection(Ae.x+O[0],Ae.y+O[1],F),bt=Ff(Pe.point,be,n,zt,-_.bearingInRadians,Lt),Zt=b.allowVerticalPlacement&&pe.placedOrientation===c.an.vertical?Math.PI/2:0;for(let Mn=0;Mn<pe.numGlyphs;Mn++)c.au(H,bt,Zt);D&&pe.associatedIconIndex>=0&&(fe[pe.associatedIconIndex]={shiftedAnchor:bt,angle:Zt})}else Os(pe.numGlyphs,H)}if(D){ee.clear();const he=b.icon.placedSymbolArray;for(let pe=0;pe<he.length;pe++){const _e=he.get(pe);if(_e.hidden)Os(_e.numGlyphs,ee);else{const Ae=fe[pe];if(Ae)for(let be=0;be<_e.numGlyphs;be++)c.au(ee,Ae.shiftedAnchor,Ae.angle);else Os(_e.numGlyphs,ee)}}b.icon.dynamicLayoutVertexBuffer.updateData(ee)}b.text.dynamicLayoutVertexBuffer.updateData(H)}function ku(b,n,l){return l.iconsInText&&n?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function Du(b,n,l,p,_,w,E,P,D,O,F,q,U){const H=b.context,ee=H.gl,fe=b.transform,he=P==="map",pe=D==="map",_e=P!=="viewport"&&l.layout.get("symbol-placement")!=="point",Ae=he&&!pe&&!_e,be=!l.layout.get("symbol-sort-key").isConstant();let Pe=!1;const Le=b.getDepthModeForSublayer(0,mn.ReadOnly),xe=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ve=[],rt=fe.getCircleRadiusCorrection();for(const Ye of p){const Qe=n.getTile(Ye),ot=Qe.getBucket(l);if(!ot)continue;const zt=_?ot.text:ot.icon;if(!zt||!zt.segments.get().length||!zt.hasVisibleVertices)continue;const Lt=zt.programConfigurations.get(l.id),bt=_||ot.sdfIcons,Zt=_?ot.textSizeData:ot.iconSizeData,Mn=pe||fe.pitch!==0,Qn=b.useProgram(ku(bt,_,ot),Lt),Qr=c.am(Zt,fe.zoom),gr=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ye);let ni,yr,_r,Ar,Wi=[0,0],Zn=null;if(_)yr=Qe.glyphAtlasTexture,_r=ee.LINEAR,ni=Qe.glyphAtlasTexture.size,ot.iconsInText&&(Wi=Qe.imageAtlasTexture.size,Zn=Qe.imageAtlasTexture,Ar=Mn||b.options.rotating||b.options.zooming||Zt.kind==="composite"||Zt.kind==="camera"?ee.LINEAR:ee.NEAREST);else{const Or=l.layout.get("icon-size").constantOr(0)!==1||ot.iconsNeedLinear;yr=Qe.imageAtlasTexture,_r=bt||b.options.rotating||b.options.zooming||Or||Mn?ee.LINEAR:ee.NEAREST,ni=Qe.imageAtlasTexture.size}const Ki=c.aB(Qe,1,b.transform.zoom),pa=Xt(he,b.transform,Ki),ru=c.L();c.ap(ru,pa);const bl=An(pe,he,b.transform,Ki),Gs=c.aC(fe,Qe,w,E),Hs=fe.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),iu=xe&&ot.hasTextData(),Bc=l.layout.get("icon-text-fit")!=="none"&&iu&&ot.hasIconData();if(_e){const Or=b.style.map.terrain?(la,oi)=>b.style.map.terrain.getElevation(Ye,la,oi):null,vr=l.layout.get("text-rotation-alignment")==="map";Kr(ot,b,_,pa,ru,pe,O,vr,Ye.toUnwrapped(),fe.width,fe.height,Gs,Or)}const Hu=_&&xe||Bc,ma=_e||Hu?Th:pe?pa:b.transform.clipSpaceToPixelsMatrix,Zs=bt&&l.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let xl;xl=bt?ot.iconsInText?Ig(Zt.kind,Qr,Ae,pe,_e,Hu,b,ma,bl,Gs,ni,Wi,rt):Cc(Zt.kind,Qr,Ae,pe,_e,Hu,b,ma,bl,Gs,_,ni,0,rt):md(Zt.kind,Qr,Ae,pe,_e,Hu,b,ma,bl,Gs,_,ni,rt);const Zu={program:Qn,buffers:zt,uniformValues:xl,projectionData:Hs,atlasTexture:yr,atlasTextureIcon:Zn,atlasInterpolation:_r,atlasInterpolationIcon:Ar,isSDF:bt,hasHalo:Zs};if(be&&ot.canOverlap){Pe=!0;const Or=zt.segments.get();for(const vr of Or)Ve.push({segments:new c.aL([vr]),sortKey:vr.sortKey,state:Zu,terrainData:gr})}else Ve.push({segments:zt.segments,sortKey:0,state:Zu,terrainData:gr})}Pe&&Ve.sort((Ye,Qe)=>Ye.sortKey-Qe.sortKey);for(const Ye of Ve){const Qe=Ye.state;if(H.activeTexture.set(ee.TEXTURE0),Qe.atlasTexture.bind(Qe.atlasInterpolation,ee.CLAMP_TO_EDGE),Qe.atlasTextureIcon&&(H.activeTexture.set(ee.TEXTURE1),Qe.atlasTextureIcon&&Qe.atlasTextureIcon.bind(Qe.atlasInterpolationIcon,ee.CLAMP_TO_EDGE)),Qe.isSDF){const ot=Qe.uniformValues;Qe.hasHalo&&(ot.u_is_halo=1,Lu(Qe.buffers,Ye.segments,l,b,Qe.program,Le,F,q,ot,Qe.projectionData,Ye.terrainData)),ot.u_is_halo=0}Lu(Qe.buffers,Ye.segments,l,b,Qe.program,Le,F,q,Qe.uniformValues,Qe.projectionData,Ye.terrainData)}}function Lu(b,n,l,p,_,w,E,P,D,O,F){const q=p.context;_.draw(q,q.gl.TRIANGLES,w,E,P,_n.backCCW,D,F,O,l.id,b.layoutVertexBuffer,b.indexBuffer,n,l.paint,p.transform.zoom,b.programConfigurations.get(l.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function zu(b,n,l,p,_){const w=b.context,E=w.gl,P=ln.disabled,D=new In([E.ONE,E.ONE],c.be.transparent,[!0,!0,!0,!0]),O=n.getBucket(l);if(!O)return;const F=p.key;let q=l.heatmapFbos.get(F);q||(q=Aa(w,n.tileSize,n.tileSize),l.heatmapFbos.set(F,q)),w.bindFramebuffer.set(q.framebuffer),w.viewport.set([0,0,n.tileSize,n.tileSize]),w.clear({color:c.be.transparent});const U=O.programConfigurations.get(l.id),H=b.useProgram("heatmap",U,!_),ee=b.transform.getProjectionData({overscaledTileID:n.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),fe=b.style.map.terrain.getTerrainData(p);H.draw(w,E.TRIANGLES,mn.disabled,P,D,_n.disabled,Hn(n,b.transform.zoom,l.paint.get("heatmap-intensity"),1),fe,ee,l.id,O.layoutVertexBuffer,O.indexBuffer,O.segments,l.paint,b.transform.zoom,U)}function Ua(b,n,l,p,_){const w=b.context,E=w.gl,P=b.transform;w.setColorMode(b.colorModeForRenderPass());const D=jo(w,n),O=l.key,F=n.heatmapFbos.get(O);if(!F)return;w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,F.colorAttachment.get()),w.activeTexture.set(E.TEXTURE1),D.bind(E.LINEAR,E.CLAMP_TO_EDGE);const q=P.getProjectionData({overscaledTileID:l,applyTerrainMatrix:_,applyGlobeMatrix:!p});b.useProgram("heatmapTexture").draw(w,E.TRIANGLES,mn.disabled,ln.disabled,b.colorModeForRenderPass(),_n.disabled,Zi(b,n,0,1),null,q,n.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,n.paint,P.zoom),F.destroy(),n.heatmapFbos.delete(O)}function Aa(b,n,l){var p,_;const w=b.gl,E=w.createTexture();w.bindTexture(w.TEXTURE_2D,E),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const P=(p=b.HALF_FLOAT)!==null&&p!==void 0?p:w.UNSIGNED_BYTE,D=(_=b.RGBA16F)!==null&&_!==void 0?_:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,D,n,l,0,w.RGBA,P,null);const O=b.createFramebuffer(n,l,!1,!1);return O.colorAttachment.set(E),O}function jo(b,n){return n.colorRampTexture||(n.colorRampTexture=new c.T(b,n.colorRamp,b.gl.RGBA)),n.colorRampTexture}function vo(b,n,l,p,_){if(!l||!p||!p.imageAtlas)return;const w=p.imageAtlas.patternPositions;let E=w[l.to.toString()],P=w[l.from.toString()];if(!E&&P&&(E=P),!P&&E&&(P=E),!E||!P){const D=_.getPaintProperty(n);E=w[D],P=w[D]}E&&P&&b.setConstantPatternPositions(E,P)}function vs(b,n,l,p,_,w,E,P){const D=b.context.gl,O="fill-pattern",F=l.paint.get(O),q=F&&F.constantOr(1),U=l.getCrossfadeParameters();let H,ee,fe,he,pe;const _e=b.transform,Ae=l.paint.get("fill-translate"),be=l.paint.get("fill-translate-anchor");E?(ee=q&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=D.LINES):(ee=q?"fillPattern":"fill",H=D.TRIANGLES);const Pe=F.constantOr(null);for(const Le of p){const xe=n.getTile(Le);if(q&&!xe.patternsLoaded())continue;const Ve=xe.getBucket(l);if(!Ve)continue;const rt=Ve.programConfigurations.get(l.id),Ye=b.useProgram(ee,rt),Qe=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Le);q&&(b.context.activeTexture.set(D.TEXTURE0),xe.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),rt.updatePaintBuffers(U)),vo(rt,O,Pe,xe,l);const ot=_e.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!P,applyTerrainMatrix:!0}),zt=c.aC(_e,xe,Ae,be);if(E){he=Ve.indexBuffer2,pe=Ve.segments2;const bt=[D.drawingBufferWidth,D.drawingBufferHeight];fe=ee==="fillOutlinePattern"&&q?Je(b,U,xe,bt,zt):ce(bt,zt)}else he=Ve.indexBuffer,pe=Ve.segments,fe=q?Z(b,U,xe,zt):{u_fill_translate:zt};const Lt=b.stencilModeForClipping(Le);Ye.draw(b.context,H,_,Lt,w,_n.backCCW,fe,Qe,ot,l.id,Ve.layoutVertexBuffer,he,pe,l.paint,b.transform.zoom,rt)}}function js(b,n,l,p,_,w,E,P){const D=b.context,O=D.gl,F="fill-extrusion-pattern",q=l.paint.get(F),U=q.constantOr(1),H=l.getCrossfadeParameters(),ee=l.paint.get("fill-extrusion-opacity"),fe=q.constantOr(null),he=b.transform;for(const pe of p){const _e=n.getTile(pe),Ae=_e.getBucket(l);if(!Ae)continue;const be=b.style.map.terrain&&b.style.map.terrain.getTerrainData(pe),Pe=Ae.programConfigurations.get(l.id),Le=b.useProgram(U?"fillExtrusionPattern":"fillExtrusion",Pe);U&&(b.context.activeTexture.set(O.TEXTURE0),_e.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Pe.updatePaintBuffers(H));const xe=he.getProjectionData({overscaledTileID:pe,applyGlobeMatrix:!P,applyTerrainMatrix:!0});vo(Pe,F,fe,_e,l);const Ve=c.aC(he,_e,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),rt=l.paint.get("fill-extrusion-vertical-gradient"),Ye=U?V(b,rt,ee,Ve,pe,H,_e):A(b,rt,ee,Ve);Le.draw(D,D.gl.TRIANGLES,_,w,E,_n.backCCW,Ye,be,xe,l.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,l.paint,b.transform.zoom,Pe,b.style.map.terrain&&Ae.centroidVertexBuffer)}}function Ou(b,n,l,p,_,w,E,P,D){var O;const F=b.style.projection,q=b.context,U=b.transform,H=q.gl,ee=[`#define NUM_ILLUMINATION_SOURCES ${l.paint.get("hillshade-highlight-color").values.length}`],fe=b.useProgram("hillshade",null,!1,ee),he=!b.options.moving;for(const pe of p){const _e=n.getTile(pe),Ae=_e.fbo;if(!Ae)continue;const be=F.getMeshFromTileID(q,pe.canonical,P,!0,"raster"),Pe=(O=b.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(pe);q.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,Ae.colorAttachment.get());const Le=U.getProjectionData({overscaledTileID:pe,aligned:he,applyGlobeMatrix:!D,applyTerrainMatrix:!0});fe.draw(q,H.TRIANGLES,w,_[pe.overscaledZ],E,_n.backCCW,ei(b,_e,l),Pe,Le,l.id,be.vertexBuffer,be.indexBuffer,be.segments)}}function Nu(b,n,l,p,_,w,E,P,D){var O;const F=b.style.projection,q=b.context,U=b.transform,H=q.gl,ee=b.useProgram("colorRelief"),fe=!b.options.moving;let he=!0;for(const pe of p){const _e=n.getTile(pe),Ae=_e.dem;if(he){const rt=H.getParameter(H.MAX_TEXTURE_SIZE),{elevationTexture:Ye,colorTexture:Qe}=l.getColorRampTextures(q,rt,Ae.getUnpackVector());q.activeTexture.set(H.TEXTURE1),Ye.bind(H.NEAREST,H.CLAMP_TO_EDGE),q.activeTexture.set(H.TEXTURE4),Qe.bind(H.LINEAR,H.CLAMP_TO_EDGE),he=!1}if(!Ae||!Ae.data)continue;const be=Ae.stride,Pe=Ae.getPixels();if(q.activeTexture.set(H.TEXTURE0),q.pixelStoreUnpackPremultiplyAlpha.set(!1),_e.demTexture=_e.demTexture||b.getTileTexture(be),_e.demTexture){const rt=_e.demTexture;rt.update(Pe,{premultiply:!1}),rt.bind(H.LINEAR,H.CLAMP_TO_EDGE)}else _e.demTexture=new c.T(q,Pe,H.RGBA,{premultiply:!1}),_e.demTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const Le=F.getMeshFromTileID(q,pe.canonical,P,!0,"raster"),xe=(O=b.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(pe),Ve=U.getProjectionData({overscaledTileID:pe,aligned:fe,applyGlobeMatrix:!D,applyTerrainMatrix:!0});ee.draw(q,H.TRIANGLES,w,_[pe.overscaledZ],E,_n.backCCW,Vo(l,_e.dem),xe,Ve,l.id,Le.vertexBuffer,Le.indexBuffer,Le.segments)}}const Sh=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function pi(b,n,l,p,_,w,E,P,D=!1,O=!1){const F=p[p.length-1].overscaledZ,q=b.context,U=q.gl,H=b.useProgram("raster"),ee=b.transform,fe=b.style.projection,he=b.colorModeForRenderPass(),pe=!b.options.moving;for(const _e of p){const Ae=b.getDepthModeForSublayer(_e.overscaledZ-F,l.paint.get("raster-opacity")===1?mn.ReadWrite:mn.ReadOnly,U.LESS),be=n.getTile(_e);be.registerFadeDuration(l.paint.get("raster-fade-duration"));const Pe=n.findLoadedParent(_e,0),Le=n.findLoadedSibling(_e),xe=mi(be,Pe||Le||null,n,l,b.transform,b.style.map.terrain);let Ve,rt;const Ye=l.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;q.activeTexture.set(U.TEXTURE0),be.texture.bind(Ye,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),q.activeTexture.set(U.TEXTURE1),Pe?(Pe.texture.bind(Ye,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Ve=Math.pow(2,Pe.tileID.overscaledZ-be.tileID.overscaledZ),rt=[be.tileID.canonical.x*Ve%1,be.tileID.canonical.y*Ve%1]):be.texture.bind(Ye,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),be.texture.useMipmap&&q.extTextureFilterAnisotropic&&b.transform.pitch>20&&U.texParameterf(U.TEXTURE_2D,q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,q.extTextureFilterAnisotropicMax);const Qe=b.style.map.terrain&&b.style.map.terrain.getTerrainData(_e),ot=ee.getProjectionData({overscaledTileID:_e,aligned:pe,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),zt=Ul(rt||[0,0],Ve||1,xe,l,P),Lt=fe.getMeshFromTileID(q,_e.canonical,w,E,"raster");H.draw(q,U.TRIANGLES,Ae,_?_[_e.overscaledZ]:ln.disabled,he,D?_n.frontCCW:_n.backCCW,zt,Qe,ot,l.id,Lt.vertexBuffer,Lt.indexBuffer,Lt.segments)}}function mi(b,n,l,p,_,w){const E=p.paint.get("raster-fade-duration");if(!w&&E>0){const P=$.now(),D=(P-b.timeAdded)/E,O=n?(P-n.timeAdded)/E:-1,F=l.getSource(),q=ht(_,{tileSize:F.tileSize,roundZoom:F.roundZoom}),U=!n||Math.abs(n.tileID.overscaledZ-q)>Math.abs(b.tileID.overscaledZ-q),H=U&&b.refreshedUponExpiration?1:c.ag(U?D:1-O,0,1);return b.refreshedUponExpiration&&D>=1&&(b.refreshedUponExpiration=!1),n?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const or=new c.be(1,0,0,1),Uo=new c.be(0,1,0,1),Us=new c.be(0,0,1,1),wd=new c.be(1,0,1,1),Zl=new c.be(0,1,1,1);function Rc(b,n,l,p){Wl(b,0,n+l/2,b.transform.width,l,p)}function Eh(b,n,l,p){Wl(b,n-l/2,0,l,b.transform.height,p)}function Wl(b,n,l,p,_,w){const E=b.context,P=E.gl;P.enable(P.SCISSOR_TEST),P.scissor(n*b.pixelRatio,l*b.pixelRatio,p*b.pixelRatio,_*b.pixelRatio),E.clear({color:w}),P.disable(P.SCISSOR_TEST)}function kc(b,n,l){const p=b.context,_=p.gl,w=b.useProgram("debug"),E=mn.disabled,P=ln.disabled,D=b.colorModeForRenderPass(),O="$debug",F=b.style.map.terrain&&b.style.map.terrain.getTerrainData(l);p.activeTexture.set(_.TEXTURE0);const q=n.getTileByID(l.key).latestRawTileData,U=Math.floor((q&&q.byteLength||0)/1024),H=n.getTile(l).tileSize,ee=512/Math.min(H,512)*(l.overscaledZ/b.transform.zoom)*.5;let fe=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(fe+=` => ${l.overscaledZ}`),function(pe,_e){pe.initDebugOverlayCanvas();const Ae=pe.debugOverlayCanvas,be=pe.context.gl,Pe=pe.debugOverlayCanvas.getContext("2d");Pe.clearRect(0,0,Ae.width,Ae.height),Pe.shadowColor="white",Pe.shadowBlur=2,Pe.lineWidth=1.5,Pe.strokeStyle="white",Pe.textBaseline="top",Pe.font="bold 36px Open Sans, sans-serif",Pe.fillText(_e,5,5),Pe.strokeText(_e,5,5),pe.debugOverlayTexture.update(Ae),pe.debugOverlayTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE)}(b,`${fe} ${U}kB`);const he=b.transform.getProjectionData({overscaledTileID:l,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(p,_.TRIANGLES,E,P,In.alphaBlended,_n.disabled,Ni(c.be.transparent,ee),null,he,O,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),w.draw(p,_.LINE_STRIP,E,P,D,_n.disabled,Ni(c.be.red),F,he,O,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function ti(b,n,l,p){const{isRenderingGlobe:_}=p,w=b.context,E=w.gl,P=b.transform,D=b.colorModeForRenderPass(),O=b.getDepthModeFor3D(),F=b.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,b.width,b.height]);for(const q of l){const U=n.getTerrainMesh(q.tileID),H=b.renderToTexture.getTexture(q),ee=n.getTerrainData(q.tileID);w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,H.texture);const fe=n.getMeshFrameDelta(P.zoom),he=P.calculateFogMatrix(q.tileID.toUnwrapped()),pe=Ec(fe,he,b.style.sky,P.pitch,_),_e=P.getProjectionData({overscaledTileID:q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});F.draw(w,E.TRIANGLES,O,ln.disabled,D,_n.backCCW,pe,ee,_e,"terrain",U.vertexBuffer,U.indexBuffer,U.segments)}}function qs(b,n){if(!n.mesh){const l=new c.aK;l.emplaceBack(-1,-1),l.emplaceBack(1,-1),l.emplaceBack(1,1),l.emplaceBack(-1,1);const p=new c.aM;p.emplaceBack(0,1,2),p.emplaceBack(0,2,3),n.mesh=new cs(b.createVertexBuffer(l,hs.members),b.createIndexBuffer(p),c.aL.simpleSegment(0,0,l.length,p.length))}return n.mesh}class ts{constructor(n,l){this.context=new zn(n),this.transform=l,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=mt.maxUnderzooming+mt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new No}resize(n,l,p){if(this.width=Math.floor(n*p),this.height=Math.floor(l*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const n=this.context,l=new c.aK;l.emplaceBack(0,0),l.emplaceBack(c.$,0),l.emplaceBack(0,c.$),l.emplaceBack(c.$,c.$),this.tileExtentBuffer=n.createVertexBuffer(l,hs.members),this.tileExtentSegments=c.aL.simpleSegment(0,0,4,2);const p=new c.aK;p.emplaceBack(0,0),p.emplaceBack(c.$,0),p.emplaceBack(0,c.$),p.emplaceBack(c.$,c.$),this.debugBuffer=n.createVertexBuffer(p,hs.members),this.debugSegments=c.aL.simpleSegment(0,0,4,5);const _=new c.c5;_.emplaceBack(0,0,0,0),_.emplaceBack(c.$,0,c.$,0),_.emplaceBack(0,c.$,0,c.$),_.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=n.createVertexBuffer(_,fd.members),this.rasterBoundsSegments=c.aL.simpleSegment(0,0,4,2);const w=new c.aK;w.emplaceBack(0,0),w.emplaceBack(c.$,0),w.emplaceBack(0,c.$),w.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=n.createVertexBuffer(w,hs.members),this.rasterBoundsSegmentsPosOnly=c.aL.simpleSegment(0,0,4,5);const E=new c.aK;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(E,hs.members),this.viewportSegments=c.aL.simpleSegment(0,0,4,2);const P=new c.c6;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(P);const D=new c.aM;D.emplaceBack(1,0,2),D.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(D);const O=this.context.gl;this.stencilClearMode=new ln({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.tileExtentMesh=new cs(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const n=this.context,l=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=c.L();c.bX(p,0,this.width,this.height,0,0,1),c.N(p,p,[l.drawingBufferWidth,l.drawingBufferHeight,0]);const _={mainMatrix:p,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:p};this.useProgram("clippingMask",null,!0).draw(n,l.TRIANGLES,mn.disabled,this.stencilClearMode,In.disabled,_n.disabled,null,null,_,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,l,p){if(this.currentStencilSource===n.source||!n.isTileClipped()||!l||!l.length)return;this.currentStencilSource=n.source,this.nextStencilID+l.length>256&&this.clearStencil();const _=this.context;_.setColorMode(In.disabled),_.setDepthMode(mn.disabled);const w={};for(const E of l)w[E.key]=this.nextStencilID++;this._renderTileMasks(w,l,p,!0),this._renderTileMasks(w,l,p,!1),this._tileClippingMaskIDs=w}_renderTileMasks(n,l,p,_){const w=this.context,E=w.gl,P=this.style.projection,D=this.transform,O=this.useProgram("clippingMask");for(const F of l){const q=n[F.key],U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),H=P.getMeshFromTileID(this.context,F.canonical,_,!0,"stencil"),ee=D.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!p,applyTerrainMatrix:!0});O.draw(w,E.TRIANGLES,mn.disabled,new ln({func:E.ALWAYS,mask:0},q,255,E.KEEP,E.KEEP,E.REPLACE),In.disabled,p?_n.disabled:_n.backCCW,null,U,ee,"$clipping",H.vertexBuffer,H.indexBuffer,H.segments)}}_renderTilesDepthBuffer(){const n=this.context,l=n.gl,p=this.style.projection,_=this.transform,w=this.useProgram("depth"),E=this.getDepthModeFor3D(),P=st(_,{tileSize:_.tileSize});for(const D of P){const O=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),F=p.getMeshFromTileID(this.context,D.canonical,!0,!0,"raster"),q=_.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(n,l.TRIANGLES,E,ln.disabled,In.disabled,_n.backCCW,null,O,q,"$clipping",F.vertexBuffer,F.indexBuffer,F.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,l=this.context.gl;return new ln({func:l.NOTEQUAL,mask:255},n,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(n){const l=this.context.gl;return new ln({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,l.KEEP,l.KEEP,l.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(n){const l=this.context.gl,p=n.sort((E,P)=>P.overscaledZ-E.overscaledZ),_=p[p.length-1].overscaledZ,w=p[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const E={};for(let P=0;P<w;P++)E[P+_]=new ln({func:l.GEQUAL,mask:255},P+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=w,[E,p]}return[{[_]:ln.disabled},p]}stencilConfigForOverlapTwoPass(n){const l=this.context.gl,p=n.sort((E,P)=>P.overscaledZ-E.overscaledZ),_=p[p.length-1].overscaledZ,w=p[0].overscaledZ-_+1;if(this.clearStencil(),w>1){const E={},P={};for(let D=0;D<w;D++)E[D+_]=new ln({func:l.GREATER,mask:255},w+1+D,255,l.KEEP,l.KEEP,l.REPLACE),P[D+_]=new ln({func:l.GREATER,mask:255},1+D,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID=2*w+1,[E,P,p]}return this.nextStencilID=3,[{[_]:new ln({func:l.GREATER,mask:255},2,255,l.KEEP,l.KEEP,l.REPLACE)},{[_]:new ln({func:l.GREATER,mask:255},1,255,l.KEEP,l.KEEP,l.REPLACE)},p]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new In([n.CONSTANT_COLOR,n.ONE],new c.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?In.unblended:In.alphaBlended}getDepthModeForSublayer(n,l,p){if(!this.opaquePassEnabledForLayer())return mn.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new mn(p||this.context.gl.LEQUAL,l,[_,_])}getDepthModeFor3D(){return new mn(this.context.gl.LEQUAL,mn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,l){var p,_;this.style=n,this.options=l,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange($.now()),this.imageManager.beginFrame();const w=this.style._order,E=this.style.sourceCaches,P={},D={},O={},F={isRenderingToTexture:!1,isRenderingGlobe:((p=n.projection)===null||p===void 0?void 0:p.transitionState)>0};for(const U in E){const H=E[U];H.used&&H.prepare(this.context),P[U]=H.getVisibleCoordinates(!1),D[U]=P[U].slice().reverse(),O[U]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<w.length;U++)if(this.style._layers[w[U]].is3D()){this.opaquePassCutoff=U;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const U of w){const H=this.style._layers[U];if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const ee=D[H.source];(H.type==="custom"||ee.length)&&this.renderLayer(this,E[H.source],H,ee,F)}if((_=this.style.projection)===null||_===void 0||_.updateGPUdependent({context:this.context,useProgram:U=>this.useProgram(U)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:l.showOverdrawInspector?c.be.black:c.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(U,H){const ee=U.context,fe=ee.gl,he=((Le,xe,Ve)=>{const rt=Math.cos(xe.rollInRadians),Ye=Math.sin(xe.rollInRadians),Qe=ie(xe),ot=xe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Le.properties.get("sky-color"),u_horizon_color:Le.properties.get("horizon-color"),u_horizon:[(xe.width/2-Qe*Ye)*Ve,(xe.height/2+Qe*rt)*Ve],u_horizon_normal:[-Ye,rt],u_sky_horizon_blend:Le.properties.get("sky-horizon-blend")*xe.height/2*Ve,u_sky_blend:ot}})(H,U.style.map.transform,U.pixelRatio),pe=new mn(fe.LEQUAL,mn.ReadWrite,[0,1]),_e=ln.disabled,Ae=U.colorModeForRenderPass(),be=U.useProgram("sky"),Pe=qs(ee,H);be.draw(ee,fe.TRIANGLES,pe,_e,Ae,_n.disabled,he,null,void 0,"sky",Pe.vertexBuffer,Pe.indexBuffer,Pe.segments)}(this,this.style.sky),this._showOverdrawInspector=l.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[w[this.currentLayer]],H=E[U.source],ee=P[U.source];this._renderTileClippingMasks(U,ee,!1),this.renderLayer(this,H,U,ee,F)}this.renderPass="translucent";let q=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const U=this.style._layers[w[this.currentLayer]],H=E[U.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(U,F))continue;this.opaquePassEnabledForLayer()||q||(q=!0,F.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ee=(U.type==="symbol"?O:D)[U.source];this._renderTileClippingMasks(U,P[U.source],!!this.renderToTexture),this.renderLayer(this,H,U,ee,F)}if(F.isRenderingGlobe&&function(U,H,ee){const fe=U.context,he=fe.gl,pe=U.useProgram("atmosphere"),_e=new mn(he.LEQUAL,mn.ReadOnly,[0,1]),Ae=U.transform,be=function(ot,zt){const Lt=ot.properties.get("position"),bt=[-Lt.x,-Lt.y,-Lt.z],Zt=c.af(new Float64Array(16));return ot.properties.get("anchor")==="map"&&(c.b5(Zt,Zt,zt.rollInRadians),c.b6(Zt,Zt,-zt.pitchInRadians),c.b5(Zt,Zt,zt.bearingInRadians),c.b6(Zt,Zt,zt.center.lat*Math.PI/180),c.by(Zt,Zt,-zt.center.lng*Math.PI/180)),c.c4(bt,bt,Zt),bt}(ee,U.transform),Pe=Ae.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Le=H.properties.get("atmosphere-blend")*Pe.projectionTransition;if(Le===0)return;const xe=Vs(Ae.worldSize,Ae.center.lat),Ve=Ae.inverseProjectionMatrix,rt=new Float64Array(4);rt[3]=1,c.av(rt,rt,Ae.modelViewProjectionMatrix),rt[0]/=rt[3],rt[1]/=rt[3],rt[2]/=rt[3],rt[3]=1,c.av(rt,rt,Ve),rt[0]/=rt[3],rt[1]/=rt[3],rt[2]/=rt[3],rt[3]=1;const Ye=((ot,zt,Lt,bt,Zt)=>({u_sun_pos:ot,u_atmosphere_blend:zt,u_globe_position:Lt,u_globe_radius:bt,u_inv_proj_matrix:Zt}))(be,Le,[rt[0],rt[1],rt[2]],xe,Ve),Qe=qs(fe,H);pe.draw(fe,he.TRIANGLES,_e,ln.disabled,In.alphaBlended,_n.disabled,Ye,null,null,"atmosphere",Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const U=function(H,ee){let fe=null;const he=Object.values(H._layers).flatMap(be=>be.source&&!be.isHidden(ee)?[H.sourceCaches[be.source]]:[]),pe=he.filter(be=>be.getSource().type==="vector"),_e=he.filter(be=>be.getSource().type!=="vector"),Ae=be=>{(!fe||fe.getSource().maxzoom<be.getSource().maxzoom)&&(fe=be)};return pe.forEach(be=>Ae(be)),fe||_e.forEach(be=>Ae(be)),fe}(this.style,this.transform.zoom);U&&function(H,ee,fe){for(let he=0;he<fe.length;he++)kc(H,ee,fe[he])}(this,U,U.getVisibleCoordinates())}this.options.showPadding&&function(U){const H=U.transform.padding;Rc(U,U.transform.height-(H.top||0),3,or),Rc(U,H.bottom||0,3,Uo),Eh(U,H.left||0,3,Us),Eh(U,U.transform.width-(H.right||0),3,wd);const ee=U.transform.centerPoint;(function(fe,he,pe,_e){Wl(fe,he-1,pe-10,2,20,_e),Wl(fe,he-10,pe-1,20,2,_e)})(U,ee.x,U.transform.height-ee.y,Zl)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const l=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix;let _=this.terrainFacilitator.dirty;_||(_=n?!c.c7(l,p):!c.c8(l,p)),_||(_=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),_&&(c.c9(l,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(w,E){const P=w.context,D=P.gl,O=w.transform,F=In.unblended,q=new mn(D.LEQUAL,mn.ReadWrite,[0,1]),U=E.sourceCache.getRenderableTiles(),H=w.useProgram("terrainDepth");P.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),P.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),P.clear({color:c.be.transparent,depth:1});for(const ee of U){const fe=E.getTerrainMesh(ee.tileID),he=E.getTerrainData(ee.tileID),pe=O.getProjectionData({overscaledTileID:ee.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),_e={u_ele_delta:E.getMeshFrameDelta(O.zoom)};H.draw(P,D.TRIANGLES,q,ln.disabled,F,_n.backCCW,_e,he,pe,"terrain",fe.vertexBuffer,fe.indexBuffer,fe.segments)}P.bindFramebuffer.set(null),P.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain),function(w,E){const P=w.context,D=P.gl,O=w.transform,F=In.unblended,q=new mn(D.LEQUAL,mn.ReadWrite,[0,1]),U=E.getCoordsTexture(),H=E.sourceCache.getRenderableTiles(),ee=w.useProgram("terrainCoords");P.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),P.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),P.clear({color:c.be.transparent,depth:1}),E.coordsIndex=[];for(const fe of H){const he=E.getTerrainMesh(fe.tileID),pe=E.getTerrainData(fe.tileID);P.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,U.texture);const _e={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(O.zoom)},Ae=O.getProjectionData({overscaledTileID:fe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ee.draw(P,D.TRIANGLES,q,ln.disabled,F,_n.backCCW,_e,pe,Ae,"terrain",he.vertexBuffer,he.indexBuffer,he.segments),E.coordsIndex.push(fe.tileID.key)}P.bindFramebuffer.set(null),P.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain))}renderLayer(n,l,p,_,w){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||(_||[]).length)&&(this.id=p.id,c.ca(p)?function(E,P,D,O,F,q){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:U}=q,H=ln.disabled,ee=E.colorModeForRenderPass();(D._unevaluatedLayout.hasValue("text-variable-anchor")||D._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(fe,he,pe,_e,Ae,be,Pe,Le,xe){const Ve=he.transform,rt=he.style.map.terrain,Ye=Ae==="map",Qe=be==="map";for(const ot of fe){const zt=_e.getTile(ot),Lt=zt.getBucket(pe);if(!Lt||!Lt.text||!Lt.text.segments.get().length)continue;const bt=c.am(Lt.textSizeData,Ve.zoom),Zt=c.aB(zt,1,he.transform.zoom),Mn=Xt(Ye,he.transform,Zt),Qn=pe.layout.get("icon-text-fit")!=="none"&&Lt.hasIconData();if(bt){const Qr=Math.pow(2,Ve.zoom-zt.tileID.overscaledZ),gr=rt?(ni,yr)=>rt.getElevation(ot,ni,yr):null;Vf(Lt,Ye,Qe,xe,Ve,Mn,Qr,bt,Qn,c.aC(Ve,zt,Pe,Le),ot.toUnwrapped(),gr)}}}(O,E,D,P,D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),F),D.paint.get("icon-opacity").constantOr(1)!==0&&Du(E,P,D,O,!1,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),D.layout.get("icon-rotation-alignment"),D.layout.get("icon-pitch-alignment"),D.layout.get("icon-keep-upright"),H,ee,U),D.paint.get("text-opacity").constantOr(1)!==0&&Du(E,P,D,O,!0,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.layout.get("text-keep-upright"),H,ee,U),P.map.showCollisionBoxes&&(Bf(E,P,D,O,!0),Bf(E,P,D,O,!1))}(n,l,p,_,this.style.placement.variableOffsets,w):c.cb(p)?function(E,P,D,O,F){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:q}=F,U=D.paint.get("circle-opacity"),H=D.paint.get("circle-stroke-width"),ee=D.paint.get("circle-stroke-opacity"),fe=!D.layout.get("circle-sort-key").isConstant();if(U.constantOr(1)===0&&(H.constantOr(1)===0||ee.constantOr(1)===0))return;const he=E.context,pe=he.gl,_e=E.transform,Ae=E.getDepthModeForSublayer(0,mn.ReadOnly),be=ln.disabled,Pe=E.colorModeForRenderPass(),Le=[],xe=_e.getCircleRadiusCorrection();for(let Ve=0;Ve<O.length;Ve++){const rt=O[Ve],Ye=P.getTile(rt),Qe=Ye.getBucket(D);if(!Qe)continue;const ot=D.paint.get("circle-translate"),zt=D.paint.get("circle-translate-anchor"),Lt=c.aC(_e,Ye,ot,zt),bt=Qe.programConfigurations.get(D.id),Zt=E.useProgram("circle",bt),Mn=Qe.layoutVertexBuffer,Qn=Qe.indexBuffer,Qr=E.style.map.terrain&&E.style.map.terrain.getTerrainData(rt),gr={programConfiguration:bt,program:Zt,layoutVertexBuffer:Mn,indexBuffer:Qn,uniformValues:pt(E,Ye,D,Lt,xe),terrainData:Qr,projectionData:_e.getProjectionData({overscaledTileID:rt,applyGlobeMatrix:!q,applyTerrainMatrix:!0})};if(fe){const ni=Qe.segments.get();for(const yr of ni)Le.push({segments:new c.aL([yr]),sortKey:yr.sortKey,state:gr})}else Le.push({segments:Qe.segments,sortKey:0,state:gr})}fe&&Le.sort((Ve,rt)=>Ve.sortKey-rt.sortKey);for(const Ve of Le){const{programConfiguration:rt,program:Ye,layoutVertexBuffer:Qe,indexBuffer:ot,uniformValues:zt,terrainData:Lt,projectionData:bt}=Ve.state;Ye.draw(he,pe.TRIANGLES,Ae,be,Pe,_n.backCCW,zt,Lt,bt,D.id,Qe,ot,Ve.segments,D.paint,E.transform.zoom,rt)}}(n,l,p,_,w):c.cc(p)?function(E,P,D,O,F){if(D.paint.get("heatmap-opacity")===0)return;const q=E.context,{isRenderingToTexture:U,isRenderingGlobe:H}=F;if(E.style.map.terrain){for(const ee of O){const fe=P.getTile(ee);P.hasRenderableParent(ee)||(E.renderPass==="offscreen"?zu(E,fe,D,ee,H):E.renderPass==="translucent"&&Ua(E,D,ee,U,H))}q.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?function(ee,fe,he,pe){const _e=ee.context,Ae=_e.gl,be=ee.transform,Pe=ln.disabled,Le=new In([Ae.ONE,Ae.ONE],c.be.transparent,[!0,!0,!0,!0]);(function(xe,Ve,rt){const Ye=xe.gl;xe.activeTexture.set(Ye.TEXTURE1),xe.viewport.set([0,0,Ve.width/4,Ve.height/4]);let Qe=rt.heatmapFbos.get(c.c1);Qe?(Ye.bindTexture(Ye.TEXTURE_2D,Qe.colorAttachment.get()),xe.bindFramebuffer.set(Qe.framebuffer)):(Qe=Aa(xe,Ve.width/4,Ve.height/4),rt.heatmapFbos.set(c.c1,Qe))})(_e,ee,he),_e.clear({color:c.be.transparent});for(let xe=0;xe<pe.length;xe++){const Ve=pe[xe];if(fe.hasRenderableParent(Ve))continue;const rt=fe.getTile(Ve),Ye=rt.getBucket(he);if(!Ye)continue;const Qe=Ye.programConfigurations.get(he.id),ot=ee.useProgram("heatmap",Qe),zt=be.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Lt=be.getCircleRadiusCorrection();ot.draw(_e,Ae.TRIANGLES,mn.disabled,Pe,Le,_n.backCCW,Hn(rt,be.zoom,he.paint.get("heatmap-intensity"),Lt),null,zt,he.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,he.paint,be.zoom,Qe)}_e.viewport.set([0,0,ee.width,ee.height])}(E,P,D,O):E.renderPass==="translucent"&&function(ee,fe){const he=ee.context,pe=he.gl;he.setColorMode(ee.colorModeForRenderPass());const _e=fe.heatmapFbos.get(c.c1);_e&&(he.activeTexture.set(pe.TEXTURE0),pe.bindTexture(pe.TEXTURE_2D,_e.colorAttachment.get()),he.activeTexture.set(pe.TEXTURE1),jo(he,fe).bind(pe.LINEAR,pe.CLAMP_TO_EDGE),ee.useProgram("heatmapTexture").draw(he,pe.TRIANGLES,mn.disabled,ln.disabled,ee.colorModeForRenderPass(),_n.disabled,Zi(ee,fe,0,1),null,null,fe.id,ee.viewportBuffer,ee.quadTriangleIndexBuffer,ee.viewportSegments,fe.paint,ee.transform.zoom))}(E,D)}(n,l,p,_,w):c.cd(p)?function(E,P,D,O,F){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:q}=F,U=D.paint.get("line-opacity"),H=D.paint.get("line-width");if(U.constantOr(1)===0||H.constantOr(1)===0)return;const ee=E.getDepthModeForSublayer(0,mn.ReadOnly),fe=E.colorModeForRenderPass(),he=D.paint.get("line-dasharray"),pe=D.paint.get("line-pattern"),_e=pe.constantOr(1),Ae=D.paint.get("line-gradient"),be=D.getCrossfadeParameters(),Pe=_e?"linePattern":he?"lineSDF":Ae?"lineGradient":"line",Le=E.context,xe=Le.gl,Ve=E.transform;let rt=!0;for(const Ye of O){const Qe=P.getTile(Ye);if(_e&&!Qe.patternsLoaded())continue;const ot=Qe.getBucket(D);if(!ot)continue;const zt=ot.programConfigurations.get(D.id),Lt=E.context.program.get(),bt=E.useProgram(Pe,zt),Zt=rt||bt.program!==Lt,Mn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ye),Qn=pe.constantOr(null);if(Qn&&Qe.imageAtlas){const _r=Qe.imageAtlas,Ar=_r.patternPositions[Qn.to.toString()],Wi=_r.patternPositions[Qn.from.toString()];Ar&&Wi&&zt.setConstantPatternPositions(Ar,Wi)}const Qr=Ve.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),gr=Ve.getPixelScale(),ni=_e?If(E,Qe,D,gr,be):he?Mf(E,Qe,D,gr,he,be):Ae?Ac(E,Qe,D,gr,ot.lineClipsArray.length):jl(E,Qe,D,gr);if(_e)Le.activeTexture.set(xe.TEXTURE0),Qe.imageAtlasTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),zt.updatePaintBuffers(be);else if(he&&(Zt||E.lineAtlas.dirty))Le.activeTexture.set(xe.TEXTURE0),E.lineAtlas.bind(Le);else if(Ae){const _r=ot.gradients[D.id];let Ar=_r.texture;if(D.gradientVersion!==_r.version){let Wi=256;if(D.stepInterpolant){const Zn=P.getSource().maxzoom,Ki=Ye.canonical.z===Zn?Math.ceil(1<<E.transform.maxZoom-Ye.canonical.z):1;Wi=c.ag(c.c2(ot.maxLineLength/c.$*1024*Ki),256,Le.maxTextureSize)}_r.gradient=c.c3({expression:D.gradientExpression(),evaluationKey:"lineProgress",resolution:Wi,image:_r.gradient||void 0,clips:ot.lineClipsArray}),_r.texture?_r.texture.update(_r.gradient):_r.texture=new c.T(Le,_r.gradient,xe.RGBA),_r.version=D.gradientVersion,Ar=_r.texture}Le.activeTexture.set(xe.TEXTURE0),Ar.bind(D.stepInterpolant?xe.NEAREST:xe.LINEAR,xe.CLAMP_TO_EDGE)}const yr=E.stencilModeForClipping(Ye);bt.draw(Le,xe.TRIANGLES,ee,yr,fe,_n.disabled,ni,Mn,Qr,D.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,D.paint,E.transform.zoom,zt,ot.layoutVertexBuffer2),rt=!1}}(n,l,p,_,w):c.ce(p)?function(E,P,D,O,F){const q=D.paint.get("fill-color"),U=D.paint.get("fill-opacity");if(U.constantOr(1)===0)return;const{isRenderingToTexture:H}=F,ee=E.colorModeForRenderPass(),fe=D.paint.get("fill-pattern"),he=E.opaquePassEnabledForLayer()&&!fe.constantOr(1)&&q.constantOr(c.be.transparent).a===1&&U.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===he){const pe=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?mn.ReadWrite:mn.ReadOnly);vs(E,P,D,O,pe,ee,!1,H)}if(E.renderPass==="translucent"&&D.paint.get("fill-antialias")){const pe=E.getDepthModeForSublayer(D.getPaintProperty("fill-outline-color")?2:0,mn.ReadOnly);vs(E,P,D,O,pe,ee,!0,H)}}(n,l,p,_,w):c.cf(p)?function(E,P,D,O,F){const q=D.paint.get("fill-extrusion-opacity");if(q===0)return;const{isRenderingToTexture:U}=F;if(E.renderPass==="translucent"){const H=new mn(E.context.gl.LEQUAL,mn.ReadWrite,E.depthRangeFor3D);if(q!==1||D.paint.get("fill-extrusion-pattern").constantOr(1))js(E,P,D,O,H,ln.disabled,In.disabled,U),js(E,P,D,O,H,E.stencilModeFor3D(),E.colorModeForRenderPass(),U);else{const ee=E.colorModeForRenderPass();js(E,P,D,O,H,ln.disabled,ee,U)}}}(n,l,p,_,w):c.cg(p)?function(E,P,D,O,F){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:q}=F,U=E.context,H=E.style.projection.useSubdivision,ee=E.getDepthModeForSublayer(0,mn.ReadOnly),fe=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(he,pe,_e,Ae,be,Pe,Le){const xe=he.context,Ve=xe.gl;for(const rt of _e){const Ye=pe.getTile(rt),Qe=Ye.dem;if(!Qe||!Qe.data||!Ye.needsHillshadePrepare)continue;const ot=Qe.dim,zt=Qe.stride,Lt=Qe.getPixels();if(xe.activeTexture.set(Ve.TEXTURE1),xe.pixelStoreUnpackPremultiplyAlpha.set(!1),Ye.demTexture=Ye.demTexture||he.getTileTexture(zt),Ye.demTexture){const Zt=Ye.demTexture;Zt.update(Lt,{premultiply:!1}),Zt.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE)}else Ye.demTexture=new c.T(xe,Lt,Ve.RGBA,{premultiply:!1}),Ye.demTexture.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE);xe.activeTexture.set(Ve.TEXTURE0);let bt=Ye.fbo;if(!bt){const Zt=new c.T(xe,{width:ot,height:ot,data:null},Ve.RGBA);Zt.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE),bt=Ye.fbo=xe.createFramebuffer(ot,ot,!0,!1),bt.colorAttachment.set(Zt.texture)}xe.bindFramebuffer.set(bt.framebuffer),xe.viewport.set([0,0,ot,ot]),he.useProgram("hillshadePrepare").draw(xe,Ve.TRIANGLES,be,Pe,Le,_n.disabled,ul(Ye.tileID,Qe),null,null,Ae.id,he.rasterBoundsBuffer,he.quadTriangleIndexBuffer,he.rasterBoundsSegments),Ye.needsHillshadePrepare=!1}})(E,P,O,D,ee,ln.disabled,fe),U.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(H){const[he,pe,_e]=E.stencilConfigForOverlapTwoPass(O);Ou(E,P,D,_e,he,ee,fe,!1,q),Ou(E,P,D,_e,pe,ee,fe,!0,q)}else{const[he,pe]=E.getStencilConfigForOverlapAndUpdateStencilID(O);Ou(E,P,D,pe,he,ee,fe,!1,q)}}(n,l,p,_,w):c.ch(p)?function(E,P,D,O,F){if(E.renderPass!=="translucent"||!O.length)return;const{isRenderingToTexture:q}=F,U=E.style.projection.useSubdivision,H=E.getDepthModeForSublayer(0,mn.ReadOnly),ee=E.colorModeForRenderPass();if(U){const[fe,he,pe]=E.stencilConfigForOverlapTwoPass(O);Nu(E,P,D,pe,fe,H,ee,!1,q),Nu(E,P,D,pe,he,H,ee,!0,q)}else{const[fe,he]=E.getStencilConfigForOverlapAndUpdateStencilID(O);Nu(E,P,D,he,fe,H,ee,!1,q)}}(n,l,p,_,w):c.ci(p)?function(E,P,D,O,F){if(E.renderPass!=="translucent"||D.paint.get("raster-opacity")===0||!O.length)return;const{isRenderingToTexture:q}=F,U=P.getSource(),H=E.style.projection.useSubdivision;if(U instanceof na)pi(E,P,D,O,null,!1,!1,U.tileCoords,U.flippedWindingOrder,q);else if(H){const[ee,fe,he]=E.stencilConfigForOverlapTwoPass(O);pi(E,P,D,he,ee,!1,!0,Sh,!1,q),pi(E,P,D,he,fe,!0,!0,Sh,!1,q)}else{const[ee,fe]=E.getStencilConfigForOverlapAndUpdateStencilID(O);pi(E,P,D,fe,ee,!1,!0,Sh,!1,q)}}(n,l,p,_,w):c.cj(p)?function(E,P,D,O,F){const q=D.paint.get("background-color"),U=D.paint.get("background-opacity");if(U===0)return;const{isRenderingToTexture:H}=F,ee=E.context,fe=ee.gl,he=E.style.projection,pe=E.transform,_e=pe.tileSize,Ae=D.paint.get("background-pattern");if(E.isPatternMissing(Ae))return;const be=!Ae&&q.a===1&&U===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==be)return;const Pe=ln.disabled,Le=E.getDepthModeForSublayer(0,be==="opaque"?mn.ReadWrite:mn.ReadOnly),xe=E.colorModeForRenderPass(),Ve=E.useProgram(Ae?"backgroundPattern":"background"),rt=O||st(pe,{tileSize:_e,terrain:E.style.map.terrain});Ae&&(ee.activeTexture.set(fe.TEXTURE0),E.imageManager.bind(E.context));const Ye=D.getCrossfadeParameters();for(const Qe of rt){const ot=pe.getProjectionData({overscaledTileID:Qe,applyGlobeMatrix:!H,applyTerrainMatrix:!0}),zt=Ae?Mg(U,E,Ae,{tileID:Qe,tileSize:_e},Ye):gd(U,q),Lt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Qe),bt=he.getMeshFromTileID(ee,Qe.canonical,!1,!0,"raster");Ve.draw(ee,fe.TRIANGLES,Le,Pe,xe,_n.backCCW,zt,Lt,ot,D.id,bt.vertexBuffer,bt.indexBuffer,bt.segments)}}(n,0,p,_,w):c.ck(p)&&function(E,P,D,O){const{isRenderingGlobe:F}=O,q=E.context,U=D.implementation,H=E.style.projection,ee=E.transform,fe=ee.getProjectionDataForCustomLayer(F),he={farZ:ee.farZ,nearZ:ee.nearZ,fov:ee.fov*Math.PI/180,modelViewProjectionMatrix:ee.modelViewProjectionMatrix,projectionMatrix:ee.projectionMatrix,shaderData:{variantName:H.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${H.shaderPreludeCode.vertexSource}`,define:H.shaderDefine},defaultProjectionData:fe},pe=U.renderingMode?U.renderingMode:"2d";if(E.renderPass==="offscreen"){const _e=U.prerender;_e&&(E.setCustomLayerDefaults(),q.setColorMode(E.colorModeForRenderPass()),_e.call(U,q.gl,he),q.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),q.setColorMode(E.colorModeForRenderPass()),q.setStencilMode(ln.disabled);const _e=pe==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,mn.ReadOnly);q.setDepthMode(_e),U.render(q.gl,he),q.setDirty(),E.setBaseState(),q.bindFramebuffer.set(null)}}(n,0,p,w))}saveTileTexture(n){const l=this._tileTextures[n.size[0]];l?l.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const l=this._tileTextures[n];return l&&l.length>0?l.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const l=this.imageManager.getPattern(n.from.toString()),p=this.imageManager.getPattern(n.to.toString());return!l||!p}useProgram(n,l,p=!1,_=[]){this.cache=this.cache||{};const w=!!this.style.map.terrain,E=this.style.projection,P=p?wa.projectionMercator:E.shaderPreludeCode,D=p?sl:E.shaderDefine,O=n+(l?l.cacheKey:"")+`/${p?mh:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(w?"/terrain":"")+(_?`/${_.join("/")}`:"");return this.cache[O]||(this.cache[O]=new Au(this.context,wa[n],l,es[n],this._showOverdrawInspector,w,P,D,_)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:l}=this.context.gl;return this.width!==n||this.height!==l}}function qo(b,n){let l,p=!1,_=null,w=null;const E=()=>{_=null,p&&(b.apply(w,l),_=setTimeout(E,n),p=!1)};return(...P)=>(p=!0,w=this,l=P,_||E(),_)}class bs{constructor(n){this._getCurrentHash=()=>{const l=window.location.hash.replace("#","");if(this._hashName){let p;return l.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(p=_)}),(p&&p[1]||"").split("/")}return l.split("/")},this._onHashChange=()=>{const l=this._getCurrentHash();if(!this._isValidHash(l))return!1;const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0},this._updateHashUnthrottled=()=>{const l=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,l)},this._removeHash=()=>{const l=this._getCurrentHash();if(l.length===0)return;const p=l.join("/");let _=p;_.split("&").length>0&&(_=_.split("&")[0]),this._hashName&&(_=`${this._hashName}=${p}`);let w=window.location.hash.replace(_,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let E=window.location.href.replace(/(#.+)?$/,w);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=qo(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const l=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,_),E=Math.round(l.lng*w)/w,P=Math.round(l.lat*w)/w,D=this._map.getBearing(),O=this._map.getPitch();let F="";if(F+=n?`/${E}/${P}/${p}`:`${p}/${P}/${E}`,(D||O)&&(F+="/"+Math.round(10*D)/10),O&&(F+=`/${Math.round(O)}`),this._hashName){const q=this._hashName;let U=!1;const H=window.location.hash.slice(1).split("&").map(ee=>{const fe=ee.split("=")[0];return fe===q?(U=!0,`${fe}=${F}`):ee}).filter(ee=>ee);return U||H.push(`${q}=${F}`),`#${H.join("&")}`}return`#${F}`}_isValidHash(n){if(n.length<3||n.some(isNaN))return!1;try{new c.S(+n[2],+n[1])}catch{return!1}const l=+n[0],p=+(n[3]||0),_=+(n[4]||0);return l>=this._map.getMinZoom()&&l<=this._map.getMaxZoom()&&p>=-180&&p<=180&&_>=this._map.getMinPitch()&&_<=this._map.getMaxPitch()}}const xs={linearity:.3,easing:c.cl(0,0,.3,1)},ns=c.e({deceleration:2500,maxSpeed:1400},xs),Ah=c.e({deceleration:20,maxSpeed:1400},xs),Bu=c.e({deceleration:1e3,maxSpeed:360},xs),Fu=c.e({deceleration:1e3,maxSpeed:90},xs),Ch=c.e({deceleration:1e3,maxSpeed:360},xs);class Kl{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:$.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,l=$.now();for(;n.length>0&&l-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)l.zoom+=w.zoomDelta||0,l.bearing+=w.bearingDelta||0,l.pitch+=w.pitchDelta||0,l.roll+=w.rollDelta||0,w.panDelta&&l.pan._add(w.panDelta),w.around&&(l.around=w.around),w.pinchAround&&(l.pinchAround=w.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(l.pan.mag()){const w=fl(l.pan.mag(),p,c.e({},ns,n||{})),E=l.pan.mult(w.amount/l.pan.mag()),P=this._map.cameraHelper.handlePanInertia(E,this._map.transform);_.center=P.easingCenter,_.offset=P.easingOffset,vi(_,w)}if(l.zoom){const w=fl(l.zoom,p,Ah);_.zoom=this._map.transform.zoom+w.amount,vi(_,w)}if(l.bearing){const w=fl(l.bearing,p,Bu);_.bearing=this._map.transform.bearing+c.ag(w.amount,-179,179),vi(_,w)}if(l.pitch){const w=fl(l.pitch,p,Fu);_.pitch=this._map.transform.pitch+w.amount,vi(_,w)}if(l.roll){const w=fl(l.roll,p,Ch);_.roll=this._map.transform.roll+c.ag(w.amount,-179,179),vi(_,w)}if(_.zoom||_.bearing){const w=l.pinchAround===void 0?l.around:l.pinchAround;_.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),c.e(_,{noMoveStart:!0})}}function vi(b,n){(!b.duration||b.duration<n.duration)&&(b.duration=n.duration,b.easing=n.easing)}function fl(b,n,l){const{maxSpeed:p,linearity:_,deceleration:w}=l,E=c.ag(b*_/(n/1e3),-p,p),P=Math.abs(E)/(w*_);return{easing:l.easing,duration:1e3*P,amount:E*(P/2)}}class qa extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,p,_={}){p=p instanceof MouseEvent?p:new MouseEvent(n,p);const w=W.mousePos(l.getCanvas(),p),E=l.unproject(w);super(n,c.e({point:w,lngLat:E,originalEvent:p},_)),this._defaultPrevented=!1,this.target=l}}class bo extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,p){const _=n==="touchend"?p.changedTouches:p.touches,w=W.touchPos(l.getCanvasContainer(),_),E=w.map(D=>l.unproject(D)),P=w.reduce((D,O,F,q)=>D.add(O.div(q.length)),new c.P(0,0));super(n,{points:w,point:P,lngLats:E,lngLat:l.unproject(P),originalEvent:p}),this._defaultPrevented=!1}}class jf extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,p){super(n,{originalEvent:p}),this._defaultPrevented=!1}}class nm{constructor(n,l){this._map=n,this._clickTolerance=l.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new jf(n.type,this._map,n))}mousedown(n,l){return this._mousedownPos=l,this._firePreventable(new qa(n.type,this._map,n))}mouseup(n){this._map.fire(new qa(n.type,this._map,n))}click(n,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||this._map.fire(new qa(n.type,this._map,n))}dblclick(n){return this._firePreventable(new qa(n.type,this._map,n))}mouseover(n){this._map.fire(new qa(n.type,this._map,n))}mouseout(n){this._map.fire(new qa(n.type,this._map,n))}touchstart(n){return this._firePreventable(new bo(n.type,this._map,n))}touchmove(n){this._map.fire(new bo(n.type,this._map,n))}touchend(n){this._map.fire(new bo(n.type,this._map,n))}touchcancel(n){this._map.fire(new bo(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bi{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new qa(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new qa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new qa(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xl{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.screenPointToLocation(c.P.convert(n),this._map.terrain)}}class Vu{constructor(n,l){this._map=n,this._tr=new Xl(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,l){this.isEnabled()&&n.shiftKey&&n.button===0&&(W.disableDrag(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(n,l){if(!this._active)return;const p=l;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=p,this._box||(this._box=W.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const w=Math.min(_.x,p.x),E=Math.max(_.x,p.x),P=Math.min(_.y,p.y),D=Math.max(_.y,p.y);W.setTransform(this._box,`translate(${w}px,${P}px)`),this._box.style.width=E-w+"px",this._box.style.height=D-P+"px"}mouseupWindow(n,l){if(!this._active||n.button!==0)return;const p=this._startPos,_=l;if(this.reset(),W.suppressClick(),p.x!==_.x||p.y!==_.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:n})),{cameraAnimation:w=>w.fitScreenCoordinates(p,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(W.remove(this._box),this._box=null),W.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,l){return this._map.fire(new c.l(n,{originalEvent:l}))}}function Yl(b,n){if(b.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${n.length}`);const l={};for(let p=0;p<b.length;p++)l[b[p].identifier]=n[p];return l}class Td{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const w=new c.P(0,0);for(const E of _)w._add(E);return w.div(_.length)}(l),this.touches=Yl(p,l)))}touchmove(n,l,p){if(this.aborted||!this.centroid)return;const _=Yl(p,l);for(const w in this.touches){const E=_[w];(!E||E.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(n,l,p){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class pl{constructor(n){this.singleTap=new Td(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,l,p){this.singleTap.touchstart(n,l,p)}touchmove(n,l,p){this.singleTap.touchmove(n,l,p)}touchend(n,l,p){const _=this.singleTap.touchend(n,l,p);if(_){const w=n.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(_)<30;if(w&&E||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class ml{constructor(n){this._tr=new Xl(n),this._zoomIn=new pl({numTouches:1,numTaps:2}),this._zoomOut=new pl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,l,p){this._zoomIn.touchstart(n,l,p),this._zoomOut.touchstart(n,l,p)}touchmove(n,l,p){this._zoomIn.touchmove(n,l,p),this._zoomOut.touchmove(n,l,p)}touchend(n,l,p){const _=this._zoomIn.touchend(n,l,p),w=this._zoomOut.touchend(n,l,p),E=this._tr;return _?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(_)},{originalEvent:n})}):w?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(w)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dc{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const l=this._moveFunction(...n);if(l.bearingDelta||l.pitchDelta||l.rollDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(n,l){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=Array.isArray(l)?l[0]:l,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,l){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const _=Array.isArray(l)?l[0]:l;return!this._moved&&_.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(p,_))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&W.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ws=0,xo=2,Uf={[ws]:1,[xo]:2};class bi{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const l=W.mouseButton(n);this._eventButton=l}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(l,p){const _=Uf[p];return l.buttons===void 0||(l.buttons&_)!==_}(n,this._eventButton)}isValidEndEvent(n){return W.mouseButton(n)===this._eventButton}}class Ql{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}class Sd{constructor(n=new bi({checkCorrectEvent:()=>!0}),l=new Ql){this.mouseMoveStateManager=n,this.oneFingerTouchMoveStateManager=l}_executeRelevantHandler(n,l,p){return n instanceof MouseEvent?l(n):typeof TouchEvent<"u"&&n instanceof TouchEvent?p(n):void 0}startMove(n){this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.startMove(l),l=>this.oneFingerTouchMoveStateManager.startMove(l))}endMove(n){this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.endMove(l),l=>this.oneFingerTouchMoveStateManager.endMove(l))}isValidStartEvent(n){return this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.isValidStartEvent(l),l=>this.oneFingerTouchMoveStateManager.isValidStartEvent(l))}isValidMoveEvent(n){return this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.isValidMoveEvent(l),l=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(l))}isValidEndEvent(n){return this._executeRelevantHandler(n,l=>this.mouseMoveStateManager.isValidEndEvent(l),l=>this.oneFingerTouchMoveStateManager.isValidEndEvent(l))}}const Ih=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=n=>{n.preventDefault()}};class Mh{constructor(n,l){this._clickTolerance=n.clickTolerance||1,this._map=l,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,l,p){return this._calculateTransform(n,l,p)}touchmove(n,l,p){if(this._active){if(!this._shouldBePrevented(p.length))return n.preventDefault(),this._calculateTransform(n,l,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,l,p){this._calculateTransform(n,l,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,l,p){p.length>0&&(this._active=!0);const _=Yl(p,l),w=new c.P(0,0),E=new c.P(0,0);let P=0;for(const O in _){const F=_[O],q=this._touches[O];q&&(w._add(F),E._add(F.sub(q)),P++,_[O]=F)}if(this._touches=_,this._shouldBePrevented(P)||!E.mag())return;const D=E.div(P);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(P),panDelta:D}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ed{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(n,l,p){if(!this._firstTwoTouches)return;n.preventDefault();const[_,w]=this._firstTwoTouches,E=Jl(p,l,_),P=Jl(p,l,w);if(!E||!P)return;const D=this._aroundCenter?null:E.add(P).div(2);return this._move([E,P],D,n)}touchend(n,l,p){if(!this._firstTwoTouches)return;const[_,w]=this._firstTwoTouches,E=Jl(p,l,_),P=Jl(p,l,w);E&&P||(this._active&&W.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Jl(b,n,l){for(let p=0;p<b.length;p++)if(b[p].identifier===l)return n[p]}function eu(b,n){return Math.log(b/n)/Math.LN2}class wo extends Ed{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,l){const p=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(eu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:eu(this._distance,p),pinchAround:l}}}function Ut(b,n){return 180*b.angleWith(n)/Math.PI}class Ad extends Ed{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,l,p){const _=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ut(this._vector,_),pinchAround:l}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const l=25/(Math.PI*this._minDiameter)*360,p=Ut(n,this._startVector);return Math.abs(p)<l}}function gl(b){return Math.abs(b.y)>Math.abs(b.x)}class Cd extends Ed{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,l,p){super.touchstart(n,l,p),this._currentTouchCount=p.length}_start(n){this._lastPoints=n,gl(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,l,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=n[0].sub(this._lastPoints[0]),w=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,w,p.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(_.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(n,l,p){if(this._valid!==void 0)return this._valid;const _=n.mag()>=2,w=l.mag()>=2;if(!_&&!w)return;if(!_||!w)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=n.y>0==l.y>0;return gl(n)&&gl(l)&&E}}const Lc={panStep:100,bearingStep:15,pitchStep:10};class Ts{constructor(n){this._tr=new Xl(n);const l=Lc;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let l=0,p=0,_=0,w=0,E=0;switch(n.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:n.shiftKey?p=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?p=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?_=1:(n.preventDefault(),E=-1);break;case 40:n.shiftKey?_=-1:(n.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:P=>{const D=this._tr;P.easeTo({duration:300,easeId:"keyboardHandler",easing:Ph,zoom:l?Math.round(D.zoom)+l*(n.shiftKey?2:1):D.zoom,bearing:D.bearing+p*this._bearingStep,pitch:D.pitch+_*this._pitchStep,offset:[-w*this._panStep,-E*this._panStep],center:D.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ph(b){return b*(2-b)}const On=4.000244140625,$o=1/450;class yl{constructor(n,l){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=n,this._tr=new Xl(n),this._triggerRenderFrame=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=$o}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let l=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const p=$.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%On==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(_*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),n.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=n,this._delta-=l,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=W.mousePos(this._map.getCanvas(),n),p=this._tr;this._aroundPoint=this._aroundCenter?p.transform.locationToScreenPoint(c.S.convert(p.center)):l,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const P=n.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=P),typeof this._targetZoom=="number"&&(this._targetZoom+=P)}if(this._delta!==0){const P=this._type==="wheel"&&Math.abs(this._delta)>On?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&D!==0&&(D=1/D);const O=typeof this._targetZoom!="number"?n.scale:c.ae(this._targetZoom);this._targetZoom=n.getConstrained(n.getCameraLngLat(),c.aj(O*D)).zoom,this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const l=typeof this._targetZoom!="number"?n.zoom:this._targetZoom,p=this._startZoom,_=this._easing;let w,E=!1;if(this._type==="wheel"&&p&&_){const P=$.now()-this._lastWheelEventTime,D=Math.min((P+5)/200,1),O=_(D);w=c.C.number(p,l,O),D<1?this._frameId||(this._frameId=!0):E=!0}else w=l,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!E,zoomDelta:w-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let l=c.cn;if(this._prevEase){const p=this._prevEase,_=($.now()-p.start)/p.duration,w=p.easing(_+.01)-p.easing(_),E=.27/Math.sqrt(w*w+1e-4)*.01,P=Math.sqrt(.0729-E*E);l=c.cl(E,P,.25,1)}return this._prevEase={start:$.now(),duration:n,easing:l},l}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class tu{constructor(n,l){this._clickZoom=n,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class qf{constructor(n){this._tr=new Xl(n),this.reset()}reset(){this._active=!1}dblclick(n,l){return n.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(l)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $f{constructor(){this._tap=new pl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,l,p){if(!this._swipePoint)if(this._tapTime){const _=l[0],w=n.timeStamp-this._tapTime<500,E=this._tapPoint.dist(_)<30;w&&E?p.length>0&&(this._swipePoint=_,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(n,l,p)}touchmove(n,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=l[0],w=_.y-this._swipePoint.y;return this._swipePoint=_,n.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(n,l,p)}touchend(n,l,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const _=this._tap.touchend(n,l,p);_&&(this._tapTime=n.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ju{constructor(n,l,p){this._el=n,this._mousePan=l,this._touchPan=p}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class nu{constructor(n,l,p,_){this._pitchWithRotate=n.pitchWithRotate,this._rollEnabled=n.rollEnabled,this._mouseRotate=l,this._mousePitch=p,this._mouseRoll=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Id{constructor(n,l,p,_){this._el=n,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Gf{constructor(n,l){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=l,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=W.create("div","maplibregl-cooperative-gesture-screen",n);let l=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(l=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=l,this._container.appendChild(_);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=p,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(W.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,l){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:n,originalEvent:l})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Go=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class Md extends c.l{}function Pd(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class Ho{constructor(n,l){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,w)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=_.type==="renderFrame"?void 0:_,P={needsRenderFrame:!1},D={},O={};for(const{handlerName:U,handler:H,allowed:ee}of this._handlers){if(!H.isEnabled())continue;let fe;if(this._blockedByActive(O,ee,U))H.reset();else if(H[w||_.type]){if(c.co(_,w||_.type)){const he=W.mousePos(this._map.getCanvas(),_);fe=H[w||_.type](_,he)}else if(c.cp(_,w||_.type)){const he=this._getMapTouches(_.touches),pe=W.touchPos(this._map.getCanvas(),he);fe=H[w||_.type](_,pe,he)}else c.cq(w||_.type)||(fe=H[w||_.type](_));this.mergeHandlerResult(P,D,fe,U,E),fe&&fe.needsRenderFrame&&this._triggerRenderFrame()}(fe||H.isActive())&&(O[U]=H)}const F={};for(const U in this._previousActiveHandlers)O[U]||(F[U]=E);this._previousActiveHandlers=O,(Object.keys(F).length||Pd(P))&&(this._changes.push([P,D,F]),this._triggerRenderFrame()),(Object.keys(O).length||Pd(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=P;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Kl(n),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(l);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,w,E]of this._listeners)W.addEventListener(_,w,_===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[n,l,p]of this._listeners)W.removeEventListener(n,l,n===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(n){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new nm(l,n));const _=l.boxZoom=new Vu(l,n);this._add("boxZoom",_),n.interactive&&n.boxZoom&&_.enable();const w=l.cooperativeGestures=new Gf(l,n.cooperativeGestures);this._add("cooperativeGestures",w),n.cooperativeGestures&&w.enable();const E=new ml(l),P=new qf(l);l.doubleClickZoom=new tu(P,E),this._add("tapZoom",E),this._add("clickZoom",P),n.interactive&&n.doubleClickZoom&&l.doubleClickZoom.enable();const D=new $f;this._add("tapDragZoom",D);const O=l.touchPitch=new Cd(l);this._add("touchPitch",O),n.interactive&&n.touchPitch&&l.touchPitch.enable(n.touchPitch);const F=()=>l.project(l.getCenter()),q=function({enable:be,clickTolerance:Pe,aroundCenter:Le=!0,minPixelCenterThreshold:xe=100,rotateDegreesPerPixelMoved:Ve=.8},rt){const Ye=new bi({checkCorrectEvent:Qe=>W.mouseButton(Qe)===0&&Qe.ctrlKey||W.mouseButton(Qe)===2&&!Qe.ctrlKey});return new Dc({clickTolerance:Pe,move:(Qe,ot)=>{const zt=rt();if(Le&&Math.abs(zt.y-Qe.y)>xe)return{bearingDelta:c.cm(new c.P(Qe.x,ot.y),ot,zt)};let Lt=(ot.x-Qe.x)*Ve;return Le&&ot.y<zt.y&&(Lt=-Lt),{bearingDelta:Lt}},moveStateManager:Ye,enable:be,assignEvents:Ih})}(n,F),U=function({enable:be,clickTolerance:Pe,pitchDegreesPerPixelMoved:Le=-.5}){const xe=new bi({checkCorrectEvent:Ve=>W.mouseButton(Ve)===0&&Ve.ctrlKey||W.mouseButton(Ve)===2});return new Dc({clickTolerance:Pe,move:(Ve,rt)=>({pitchDelta:(rt.y-Ve.y)*Le}),moveStateManager:xe,enable:be,assignEvents:Ih})}(n),H=function({enable:be,clickTolerance:Pe,rollDegreesPerPixelMoved:Le=.3},xe){const Ve=new bi({checkCorrectEvent:rt=>W.mouseButton(rt)===2&&rt.ctrlKey});return new Dc({clickTolerance:Pe,move:(rt,Ye)=>{const Qe=xe();let ot=(Ye.x-rt.x)*Le;return Ye.y<Qe.y&&(ot=-ot),{rollDelta:ot}},moveStateManager:Ve,enable:be,assignEvents:Ih})}(n,F);l.dragRotate=new nu(n,q,U,H),this._add("mouseRotate",q,["mousePitch"]),this._add("mousePitch",U,["mouseRotate","mouseRoll"]),this._add("mouseRoll",H,["mousePitch"]),n.interactive&&n.dragRotate&&l.dragRotate.enable();const ee=function({enable:be,clickTolerance:Pe}){const Le=new bi({checkCorrectEvent:xe=>W.mouseButton(xe)===0&&!xe.ctrlKey});return new Dc({clickTolerance:Pe,move:(xe,Ve)=>({around:Ve,panDelta:Ve.sub(xe)}),activateOnStart:!0,moveStateManager:Le,enable:be,assignEvents:Ih})}(n),fe=new Mh(n,l);l.dragPan=new ju(p,ee,fe),this._add("mousePan",ee),this._add("touchPan",fe,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&l.dragPan.enable(n.dragPan);const he=new Ad,pe=new wo;l.touchZoomRotate=new Id(p,pe,he,D),this._add("touchRotate",he,["touchPan","touchZoom"]),this._add("touchZoom",pe,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&l.touchZoomRotate.enable(n.touchZoomRotate);const _e=l.scrollZoom=new yl(l,()=>this._triggerRenderFrame());this._add("scrollZoom",_e,["mousePan"]),n.interactive&&n.scrollZoom&&l.scrollZoom.enable(n.scrollZoom);const Ae=l.keyboard=new Ts(l);this._add("keyboard",Ae),n.interactive&&n.keyboard&&l.keyboard.enable(),this._add("blockableMapEvent",new Bi(l))}_add(n,l,p){this._handlers.push({handlerName:n,handler:l,allowed:p}),this._handlersById[n]=l}stop(n){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Go(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,l,p){for(const _ in n)if(_!==p&&(!l||l.indexOf(_)<0))return!0;return!1}_getMapTouches(n){const l=[];for(const p of n)this._el.contains(p.target)&&l.push(p);return l}mergeHandlerResult(n,l,p,_,w){if(!p)return;c.e(n,p);const E={handlerName:_,originalEvent:p.originalEvent||w};p.zoomDelta!==void 0&&(l.zoom=E),p.panDelta!==void 0&&(l.drag=E),p.rollDelta!==void 0&&(l.roll=E),p.pitchDelta!==void 0&&(l.pitch=E),p.bearingDelta!==void 0&&(l.rotate=E)}_applyChanges(){const n={},l={},p={};for(const[_,w,E]of this._changes)_.panDelta&&(n.panDelta=(n.panDelta||new c.P(0,0))._add(_.panDelta)),_.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+_.pitchDelta),_.rollDelta&&(n.rollDelta=(n.rollDelta||0)+_.rollDelta),_.around!==void 0&&(n.around=_.around),_.pinchAround!==void 0&&(n.pinchAround=_.pinchAround),_.noInertia&&(n.noInertia=_.noInertia),c.e(l,w),c.e(p,E);this._updateMapTransform(n,l,p),this._changes=[]}_updateMapTransform(n,l,p){const _=this._map,w=_._getTransformForUpdate(),E=_.terrain;if(!(Pd(n)||E&&this._terrainMovement))return this._fireEvents(l,p,!0);_._stop(!0);let{panDelta:P,zoomDelta:D,bearingDelta:O,pitchDelta:F,rollDelta:q,around:U,pinchAround:H}=n;H!==void 0&&(U=H),U=U||_.transform.centerPoint,E&&!w.isPointOnMapSurface(U)&&(U=w.centerPoint);const ee={panDelta:P,zoomDelta:D,rollDelta:q,pitchDelta:F,bearingDelta:O,around:U};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(U)&&(U=w.centerPoint);const fe=U.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(P?U.sub(P):U);E?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ee,w),this._terrainMovement||!l.drag&&!l.zoom?l.drag&&this._terrainMovement?w.setCenter(w.screenPointToLocation(w.centerPoint.sub(P))):this._map.cameraHelper.handleMapControlsPan(ee,w,fe):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(ee,w,fe))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ee,w),this._map.cameraHelper.handleMapControlsPan(ee,w,fe)),_._applyUpdatedTransform(w),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(l,p,!0)}_fireEvents(n,l,p){const _=Go(this._eventsInProgress),w=Go(n),E={};for(const q in n){const{originalEvent:U}=n[q];this._eventsInProgress[q]||(E[`${q}start`]=U),this._eventsInProgress[q]=n[q]}!_&&w&&this._fireEvent("movestart",w.originalEvent);for(const q in E)this._fireEvent(q,E[q]);w&&this._fireEvent("move",w.originalEvent);for(const q in n){const{originalEvent:U}=n[q];this._fireEvent(q,U)}const P={};let D;for(const q in this._eventsInProgress){const{handlerName:U,originalEvent:H}=this._eventsInProgress[q];this._handlersById[U].isActive()||(delete this._eventsInProgress[q],D=l[U]||H,P[`${q}end`]=D)}for(const q in P)this._fireEvent(q,P[q]);const O=Go(this._eventsInProgress),F=(_||w)&&!O;if(F&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const q=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&q.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(q)}if(p&&F){this._updatingCamera=!0;const q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;!q||!q.essential&&$.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:D})),U(this._map.getBearing())&&this._map.resetNorth()):(U(q.bearing||this._map.getBearing())&&(q.bearing=0),q.freezeElevation=!0,this._map.easeTo(q,{originalEvent:D})),this._updatingCamera=!1}}_fireEvent(n,l){this._map.fire(new c.l(n,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new Md("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Lr extends c.E{constructor(n,l,p){super(),this._renderFrameCallback=()=>{const _=Math.min(($.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(_)),_<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=p.bearingSnap,this.cameraHelper=l,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(n,l){n.apply(this.transform),this.transform=n,this.cameraHelper=l}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(n,l){return this.jumpTo({center:n},l)}getCenterElevation(){return this.transform.elevation}setCenterElevation(n,l){return this.jumpTo({elevation:n},l),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(n){this._centerClampedToGround=n}panBy(n,l,p){return n=c.P.convert(n).mult(-1),this.panTo(this.transform.center,c.e({offset:n},l),p)}panTo(n,l,p){return this.easeTo(c.e({center:n},l),p)}getZoom(){return this.transform.zoom}setZoom(n,l){return this.jumpTo({zoom:n},l),this}zoomTo(n,l,p){return this.easeTo(c.e({zoom:n},l),p)}zoomIn(n,l){return this.zoomTo(this.getZoom()+1,n,l),this}zoomOut(n,l){return this.zoomTo(this.getZoom()-1,n,l),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(n,l){return n!=this.transform.fov&&(this.transform.setFov(n),this.fire(new c.l("movestart",l)).fire(new c.l("move",l)).fire(new c.l("moveend",l))),this}getBearing(){return this.transform.bearing}setBearing(n,l){return this.jumpTo({bearing:n},l),this}getPadding(){return this.transform.padding}setPadding(n,l){return this.jumpTo({padding:n},l),this}rotateTo(n,l,p){return this.easeTo(c.e({bearing:n},l),p)}resetNorth(n,l){return this.rotateTo(0,c.e({duration:1e3},n),l),this}resetNorthPitch(n,l){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},n),l),this}snapToNorth(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this}getPitch(){return this.transform.pitch}setPitch(n,l){return this.jumpTo({pitch:n},l),this}getRoll(){return this.transform.roll}setRoll(n,l){return this.jumpTo({roll:n},l),this}cameraForBounds(n,l){n=Tr.convert(n).adjustAntiMeridian();const p=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),p,l)}_cameraForBoxAndBearing(n,l,p,_){const w={top:0,bottom:0,right:0,left:0};if(typeof(_=c.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const O=_.padding;_.padding={top:O,bottom:O,right:O,left:O}}const E=c.e(w,_.padding);_.padding=E;const P=this.transform,D=new Tr(n,l);return this.cameraHelper.cameraForBoxAndBearing(_,E,D,p,P)}fitBounds(n,l,p){return this._fitInternal(this.cameraForBounds(n,l),l,p)}fitScreenCoordinates(n,l,p,_,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(n)),this.transform.screenPointToLocation(c.P.convert(l)),p,_),_,w)}_fitInternal(n,l,p){return n?(delete(l=c.e(n,l)).padding,l.linear?this.easeTo(l,p):this.flyTo(l,p)):this}jumpTo(n,l){this.stop();const p=this._getTransformForUpdate();let _=!1,w=!1,E=!1;const P=p.zoom;this.cameraHelper.handleJumpToCenterZoom(p,n);const D=p.zoom!==P;return"elevation"in n&&p.elevation!==+n.elevation&&p.setElevation(+n.elevation),"bearing"in n&&p.bearing!==+n.bearing&&(_=!0,p.setBearing(+n.bearing)),"pitch"in n&&p.pitch!==+n.pitch&&(w=!0,p.setPitch(+n.pitch)),"roll"in n&&p.roll!==+n.roll&&(E=!0,p.setRoll(+n.roll)),n.padding==null||p.isPaddingEqual(n.padding)||p.setPadding(n.padding),this._applyUpdatedTransform(p),this.fire(new c.l("movestart",l)).fire(new c.l("move",l)),D&&this.fire(new c.l("zoomstart",l)).fire(new c.l("zoom",l)).fire(new c.l("zoomend",l)),_&&this.fire(new c.l("rotatestart",l)).fire(new c.l("rotate",l)).fire(new c.l("rotateend",l)),w&&this.fire(new c.l("pitchstart",l)).fire(new c.l("pitch",l)).fire(new c.l("pitchend",l)),E&&this.fire(new c.l("rollstart",l)).fire(new c.l("roll",l)).fire(new c.l("rollend",l)),this.fire(new c.l("moveend",l))}calculateCameraOptionsFromTo(n,l,p,_=0){const w=c.a0.fromLngLat(n,l),E=c.a0.fromLngLat(p,_),P=E.x-w.x,D=E.y-w.y,O=E.z-w.z,F=Math.hypot(P,D,O);if(F===0)throw new Error("Can't calculate camera options with same From and To");const q=Math.hypot(P,D),U=c.aj(this.transform.cameraToCenterDistance/F/this.transform.tileSize),H=180*Math.atan2(P,-D)/Math.PI;let ee=180*Math.acos(q/F)/Math.PI;return ee=O<0?90-ee:90+ee,{center:E.toLngLat(),elevation:_,zoom:U,pitch:ee,bearing:H}}calculateCameraOptionsFromCameraLngLatAltRotation(n,l,p,_,w){const E=this.transform.calculateCenterFromCameraLngLatAlt(n,l,p,_);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:p,pitch:_,roll:w}}easeTo(n,l){this._stop(!1,n.easeId),((n=c.e({offset:[0,0],duration:500,easing:c.cn},n)).animate===!1||!n.essential&&$.prefersReducedMotion)&&(n.duration=0);const p=this._getTransformForUpdate(),_=this.getBearing(),w=p.pitch,E=p.roll,P="bearing"in n?this._normalizeBearing(n.bearing,_):_,D="pitch"in n?+n.pitch:w,O="roll"in n?this._normalizeBearing(n.roll,E):E,F="padding"in n?n.padding:p.padding,q=c.P.convert(n.offset);let U,H;n.around&&(U=c.S.convert(n.around),H=p.locationToScreenPoint(U));const ee={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},fe=this.cameraHelper.handleEaseTo(p,{bearing:P,pitch:D,roll:O,padding:F,around:U,aroundPoint:H,offsetAsPoint:q,offset:n.offset,zoom:n.zoom,center:n.center});return this._rotating=this._rotating||_!==P,this._pitching=this._pitching||D!==w,this._rolling=this._rolling||O!==E,this._padding=!p.isPaddingEqual(F),this._zooming=this._zooming||fe.isZooming,this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,ee),this.terrain&&this._prepareElevation(fe.elevationCenter),this._ease(he=>{fe.easeFunc(he),this.terrain&&!n.freezeElevation&&this._updateElevation(he),this._applyUpdatedTransform(p),this._fireMoveEvents(l)},he=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l,he)},n),this}_prepareEase(n,l,p={}){this._moving=!0,l||p.moving||this.fire(new c.l("movestart",n)),this._zooming&&!p.zooming&&this.fire(new c.l("zoomstart",n)),this._rotating&&!p.rotating&&this.fire(new c.l("rotatestart",n)),this._pitching&&!p.pitching&&this.fire(new c.l("pitchstart",n)),this._rolling&&!p.rolling&&this.fire(new c.l("rollstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const l=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&l!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(p-(l-(p*n+this._elevationStart))/(1-n)),this._elevationTarget=l}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,n))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){if(!this.terrain&&n.elevation>=0&&n.pitch<=90)return{};const l=n.getCameraLngLat(),p=n.getCameraAltitude(),_=this.terrain?this.terrain.getElevationForLngLatZoom(l,n.zoom):0;if(p<_){const w=this.calculateCameraOptionsFromTo(l,_,n.center,n.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(n){const l=[];if(l.push(_=>this._elevateCameraIfInsideTerrain(_)),this.transformCameraUpdate&&l.push(_=>this.transformCameraUpdate(_)),!l.length)return;const p=n.clone();for(const _ of l){const w=p.clone(),{center:E,zoom:P,roll:D,pitch:O,bearing:F,elevation:q}=_(w);E&&w.setCenter(E),q!==void 0&&w.setElevation(q),P!==void 0&&w.setZoom(P),D!==void 0&&w.setRoll(D),O!==void 0&&w.setPitch(O),F!==void 0&&w.setBearing(F),p.apply(w)}this.transform.apply(p)}_fireMoveEvents(n){this.fire(new c.l("move",n)),this._zooming&&this.fire(new c.l("zoom",n)),this._rotating&&this.fire(new c.l("rotate",n)),this._pitching&&this.fire(new c.l("pitch",n)),this._rolling&&this.fire(new c.l("roll",n))}_afterEase(n,l){if(this._easeId&&l&&this._easeId===l)return;delete this._easeId;const p=this._zooming,_=this._rotating,w=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,p&&this.fire(new c.l("zoomend",n)),_&&this.fire(new c.l("rotateend",n)),w&&this.fire(new c.l("pitchend",n)),E&&this.fire(new c.l("rollend",n)),this.fire(new c.l("moveend",n))}flyTo(n,l){if(!n.essential&&$.prefersReducedMotion){const ot=c.Q(n,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(ot,l)}this.stop(),n=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.cn},n);const p=this._getTransformForUpdate(),_=p.bearing,w=p.pitch,E=p.roll,P=p.padding,D="bearing"in n?this._normalizeBearing(n.bearing,_):_,O="pitch"in n?+n.pitch:w,F="roll"in n?this._normalizeBearing(n.roll,E):E,q="padding"in n?n.padding:p.padding,U=c.P.convert(n.offset);let H=p.centerPoint.add(U);const ee=p.screenPointToLocation(H),fe=this.cameraHelper.handleFlyTo(p,{bearing:D,pitch:O,roll:F,padding:q,locationAtOffset:ee,offsetAsPoint:U,center:n.center,minZoom:n.minZoom,zoom:n.zoom});let he=n.curve;const pe=Math.max(p.width,p.height),_e=pe/fe.scaleOfZoom,Ae=fe.pixelPathLength;typeof fe.scaleOfMinZoom=="number"&&(he=Math.sqrt(pe/fe.scaleOfMinZoom/Ae*2));const be=he*he;function Pe(ot){const zt=(_e*_e-pe*pe+(ot?-1:1)*be*be*Ae*Ae)/(2*(ot?_e:pe)*be*Ae);return Math.log(Math.sqrt(zt*zt+1)-zt)}function Le(ot){return(Math.exp(ot)-Math.exp(-ot))/2}function xe(ot){return(Math.exp(ot)+Math.exp(-ot))/2}const Ve=Pe(!1);let rt=function(ot){return xe(Ve)/xe(Ve+he*ot)},Ye=function(ot){return pe*((xe(Ve)*(Le(zt=Ve+he*ot)/xe(zt))-Le(Ve))/be)/Ae;var zt},Qe=(Pe(!0)-Ve)/he;if(Math.abs(Ae)<2e-6||!isFinite(Qe)){if(Math.abs(pe-_e)<1e-6)return this.easeTo(n,l);const ot=_e<pe?-1:1;Qe=Math.abs(Math.log(_e/pe))/he,Ye=()=>0,rt=zt=>Math.exp(ot*he*zt)}return n.duration="duration"in n?+n.duration:1e3*Qe/("screenSpeed"in n?+n.screenSpeed/he:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=_!==D,this._pitching=O!==w,this._rolling=F!==E,this._padding=!p.isPaddingEqual(q),this._prepareEase(l,!1),this.terrain&&this._prepareElevation(fe.targetCenter),this._ease(ot=>{const zt=ot*Qe,Lt=1/rt(zt),bt=Ye(zt);this._rotating&&p.setBearing(c.C.number(_,D,ot)),this._pitching&&p.setPitch(c.C.number(w,O,ot)),this._rolling&&p.setRoll(c.C.number(E,F,ot)),this._padding&&(p.interpolatePadding(P,q,ot),H=p.centerPoint.add(U)),fe.easeFunc(ot,Lt,bt,H),this.terrain&&!n.freezeElevation&&this._updateElevation(ot),this._applyUpdatedTransform(p),this._fireMoveEvents(l)},()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,l){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,l)}return n||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(n,l,p){p.animate===!1||p.duration===0?(n(1),l()):(this._easeStart=$.now(),this._easeOptions=p,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,l){n=c.aN(n,-180,180);const p=Math.abs(n-l);return Math.abs(n-360-l)<p&&(n-=360),Math.abs(n+360-l)<p&&(n+=360),n}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(n),this.transform.tileZoom):null}}const $s={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Nn{constructor(n=$s){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=l=>{!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=W.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=W.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=W.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){W.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,l){const p=this._map._getUIString(`AttributionControl.${l}`);n.title=p,n.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const l=this._map.style.sourceCaches;for(const _ in l){const w=l[_];if(w.used||w.usedForTerrain){const E=w.getSource();E.attribution&&n.indexOf(E.attribution)<0&&n.push(E.attribution)}}n=n.filter(_=>String(_).trim()),n.sort((_,w)=>_.length-w.length),n=n.filter((_,w)=>{for(let E=w+1;E<n.length;E++)if(n[E].indexOf(_)>=0)return!1;return!0});const p=n.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,n.length?(this._innerContainer.innerHTML=W.sanitize(p),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class mr{constructor(n={}){this._updateCompact=()=>{const l=this._container.children;if(l.length){const p=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=W.create("div","maplibregl-ctrl");const l=W.create("a","maplibregl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://maplibre.org/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){W.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class xi{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const l=++this._id;return this._queue.push({callback:n,id:l,cancelled:!1}),l}remove(n){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const _ of p)if(_.id===n)return void(_.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Rh=c.aI([{name:"a_pos3d",type:"Int16",components:3}]);class zc extends c.E{constructor(n){super(),this._lastTilesetChange=$.now(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=n._source.tileSize*2**this.deltaZoom,n.usedForTerrain=!0,n.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,l){this.sourceCache.update(n,l),this._renderableTilesKeys=[];const p={};for(const _ of st(n,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:l,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))p[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.terrainRttPosMatrix32f=new Float64Array(16),c.bX(_.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[_.key]=new di(_,this.tileSize),this._lastTilesetChange=$.now());for(const _ in this._tiles)p[_]||delete this._tiles[_]}freeRtt(n){for(const l in this._tiles){const p=this._tiles[l];(!n||p.tileID.equals(n)||p.tileID.isChildOf(n)||n.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n,l){return l?this._getTerrainCoordsForTileRanges(n,l):this._getTerrainCoordsForRegularTile(n)}_getTerrainCoordsForRegularTile(n){const l={};for(const p of this._renderableTilesKeys){const _=this._tiles[p].tileID,w=n.clone(),E=c.b9();if(_.canonical.equals(n.canonical))c.bX(E,0,c.$,c.$,0,0,1);else if(_.canonical.isChildOf(n.canonical)){const P=_.canonical.z-n.canonical.z,D=_.canonical.x-(_.canonical.x>>P<<P),O=_.canonical.y-(_.canonical.y>>P<<P),F=c.$>>P;c.bX(E,0,F,F,0,0,1),c.M(E,E,[-D*F,-O*F,0])}else{if(!n.canonical.isChildOf(_.canonical))continue;{const P=n.canonical.z-_.canonical.z,D=n.canonical.x-(n.canonical.x>>P<<P),O=n.canonical.y-(n.canonical.y>>P<<P),F=c.$>>P;c.bX(E,0,c.$,c.$,0,0,1),c.M(E,E,[D*F,O*F,0]),c.N(E,E,[1/2**P,1/2**P,0])}}w.terrainRttPosMatrix32f=new Float32Array(E),l[p]=w}return l}_getTerrainCoordsForTileRanges(n,l){const p={};for(const _ of this._renderableTilesKeys){const w=this._tiles[_].tileID;if(!this._isWithinTileRanges(w,l))continue;const E=n.clone(),P=c.b9();if(w.canonical.z===n.canonical.z){const D=n.canonical.x-w.canonical.x,O=n.canonical.y-w.canonical.y;c.bX(P,0,c.$,c.$,0,0,1),c.M(P,P,[D*c.$,O*c.$,0])}else if(w.canonical.z>n.canonical.z){const D=w.canonical.z-n.canonical.z,O=w.canonical.x-(w.canonical.x>>D<<D),F=w.canonical.y-(w.canonical.y>>D<<D),q=n.canonical.x-(w.canonical.x>>D),U=n.canonical.y-(w.canonical.y>>D),H=c.$>>D;c.bX(P,0,H,H,0,0,1),c.M(P,P,[-O*H+q*c.$,-F*H+U*c.$,0])}else{const D=n.canonical.z-w.canonical.z,O=n.canonical.x-(n.canonical.x>>D<<D),F=n.canonical.y-(n.canonical.y>>D<<D),q=(n.canonical.x>>D)-w.canonical.x,U=(n.canonical.y>>D)-w.canonical.y,H=c.$<<D;c.bX(P,0,H,H,0,0,1),c.M(P,P,[O*c.$+q*H,F*c.$+U*H,0])}E.terrainRttPosMatrix32f=new Float32Array(P),p[_]=E}return p}getSourceTile(n,l){const p=this.sourceCache._source;let _=n.overscaledZ-this.deltaZoom;if(_>p.maxzoom&&(_=p.maxzoom),_<p.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(_).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!w||!w.dem)&&l)for(;_>=p.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(n.scaledTo(_--).key);return w}anyTilesAfterTime(n=Date.now()){return this._lastTilesetChange>=n}_isWithinTileRanges(n,l){return l[n.canonical.z]&&n.canonical.x>=l[n.canonical.z].minTileX&&n.canonical.x<=l[n.canonical.z].maxTileX&&n.canonical.y>=l[n.canonical.z].minTileY&&n.canonical.y<=l[n.canonical.z].maxTileY}}class Ca{constructor(n,l,p){this._meshCache={},this.painter=n,this.sourceCache=new zc(l),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,l,p,_=c.$){var w;if(!(l>=0&&l<_&&p>=0&&p<_))return 0;const E=this.getTerrainData(n),P=(w=E.tile)===null||w===void 0?void 0:w.dem;if(!P)return 0;const D=c.cr([],[l/_*c.$,p/_*c.$],E.u_terrain_matrix),O=[D[0]*P.dim,D[1]*P.dim],F=Math.floor(O[0]),q=Math.floor(O[1]),U=O[0]-F,H=O[1]-q;return P.get(F,q)*(1-U)*(1-H)+P.get(F+1,q)*U*(1-H)+P.get(F,q+1)*(1-U)*H+P.get(F+1,q+1)*U*H}getElevationForLngLatZoom(n,l){if(!c.cs(l,n.wrap()))return 0;const{tileID:p,mercatorX:_,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(n,l);return this.getElevation(p,_%c.$,w%c.$,c.$)}getElevation(n,l,p,_=c.$){return this.getDEMElevation(n,l,p,_)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const _=this.painter.context,w=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(_,w,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(_,new c.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.af([])}const l=this.sourceCache.getSourceTile(n,!0);if(l&&l.dem&&(!l.demTexture||l.needsTerrainPrepare)){const _=this.painter.context;l.demTexture=this.painter.getTileTexture(l.dem.stride),l.demTexture?l.demTexture.update(l.dem.getPixels(),{premultiply:!1}):l.demTexture=new c.T(_,l.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),l.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),l.needsTerrainPrepare=!1}const p=l&&l+l.tileID.key+n.key;if(p&&!this._demMatrixCache[p]){const _=this.sourceCache.sourceCache._source.maxzoom;let w=n.canonical.z-l.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=_?w=n.canonical.z-_:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=n.canonical.x-(n.canonical.x>>w<<w),P=n.canonical.y-(n.canonical.y>>w<<w),D=c.ct(new Float64Array(16),[1/(c.$<<w),1/(c.$<<w),0]);c.M(D,D,[E*c.$,P*c.$,0]),this._demMatrixCache[n.key]={matrix:D,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:l&&l.dem&&l.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:l&&l.dem&&l.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(l&&l.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:l}}getFramebuffer(n){const l=this.painter,p=l.width/devicePixelRatio,_=l.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(l.context,{width:p,height:_,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(l.context,{width:p,height:_,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=l.context.createFramebuffer(p,_,!0,!1),this._fbo.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,p,_))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const l=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,E=0;w<this._coordsTextureSize;w++)for(let P=0;P<this._coordsTextureSize;P++,E+=4)l[E+0]=255&P,l[E+1]=255&w,l[E+2]=P>>8<<4|w>>8,l[E+3]=0;const p=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(l.buffer)),_=new c.T(n,p,n.gl.RGBA,{premultiply:!1});return _.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const l=new Uint8Array(4),p=this.painter.context,_=p.gl,w=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),P=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(w,P-E-1,1,1,_.RGBA,_.UNSIGNED_BYTE,l),p.bindFramebuffer.set(null);const D=l[0]+(l[2]>>4<<8),O=l[1]+((15&l[2])<<8),F=this.coordsIndex[255-l[3]],q=F&&this.sourceCache.getTileByID(F);if(!q)return null;const U=this._coordsTextureSize,H=(1<<q.tileID.canonical.z)*U;return new c.a0((q.tileID.canonical.x*U+D)/H+q.tileID.wrap,(q.tileID.canonical.y*U+O)/H,this.getElevation(q.tileID,D,O,U))}depthAtPoint(n){const l=new Uint8Array(4),p=this.painter.context,_=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,l),p.bindFramebuffer.set(null),(l[0]/16777216+l[1]/65536+l[2]/256+l[3])/256}getTerrainMesh(n){var l;const p=((l=this.painter.style.projection)===null||l===void 0?void 0:l.transitionState)>0,_=p&&n.canonical.y===0,w=p&&n.canonical.y===(1<<n.canonical.z)-1,E=`m_${_?"n":""}_${w?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const P=this.painter.context,D=new c.cu,O=new c.aM,F=this.meshSize,q=c.$/F,U=F*F;for(let xe=0;xe<=F;xe++)for(let Ve=0;Ve<=F;Ve++)D.emplaceBack(Ve*q,xe*q,0);for(let xe=0;xe<U;xe+=F+1)for(let Ve=0;Ve<F;Ve++)O.emplaceBack(Ve+xe,F+Ve+xe+1,F+Ve+xe+2),O.emplaceBack(Ve+xe,F+Ve+xe+2,Ve+xe+1);const H=D.length,ee=H+(F+1),fe=(F+1)*F,he=_?c.bg:0,pe=_?0:1,_e=w?c.bh:c.$,Ae=w?0:1;for(let xe=0;xe<=F;xe++)D.emplaceBack(xe*q,he,pe);for(let xe=0;xe<=F;xe++)D.emplaceBack(xe*q,_e,Ae);for(let xe=0;xe<F;xe++)O.emplaceBack(fe+xe,ee+xe,ee+xe+1),O.emplaceBack(fe+xe,ee+xe+1,fe+xe+1),O.emplaceBack(0+xe,H+xe+1,H+xe),O.emplaceBack(0+xe,0+xe+1,H+xe+1);const be=D.length,Pe=be+2*(F+1);for(const xe of[0,1])for(let Ve=0;Ve<=F;Ve++)for(const rt of[0,1])D.emplaceBack(xe*c.$,Ve*q,rt);for(let xe=0;xe<2*F;xe+=2)O.emplaceBack(be+xe,be+xe+1,be+xe+3),O.emplaceBack(be+xe,be+xe+3,be+xe+2),O.emplaceBack(Pe+xe,Pe+xe+3,Pe+xe+1),O.emplaceBack(Pe+xe,Pe+xe+2,Pe+xe+3);const Le=new cs(P.createVertexBuffer(D,Rh.members),P.createIndexBuffer(O),c.aL.simpleSegment(0,0,D.length,O.length));return this._meshCache[E]=Le,Le}getMeshFrameDelta(n){return 2*Math.PI*c.bt/Math.pow(2,Math.max(n,0))/5}getMinTileElevationForLngLatZoom(n,l){var p;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(n,l);return(p=this.getMinMaxElevation(_).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(n){const l=this.getTerrainData(n).tile,p={minElevation:null,maxElevation:null};return l&&l.dem&&(p.minElevation=l.dem.min*this.exaggeration,p.maxElevation=l.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(n,l){const p=c.a0.fromLngLat(n.wrap()),_=(1<<l)*c.$,w=p.x*_,E=p.y*_,P=Math.floor(w/c.$),D=Math.floor(E/c.$);return{tileID:new c.Z(l,0,l,P,D),mercatorX:w,mercatorY:E}}}class Uu{constructor(n,l,p){this._context=n,this._size=l,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const l=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),l.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),l.colorAttachment.set(p.texture),{id:n,fbo:l,texture:p,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(l=>n.id!==l),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const l of this._recentlyUsed)if(!this._objects[l].inUse)return this._objects[l];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const $t={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class rn{constructor(n,l){this.painter=n,this.terrain=l,this.pool=new Uu(n.context,30,l.sourceCache.tileSize*l.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,l){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(p=>!n._layers[p].isHidden(l)),this._coordsAscending={};for(const p in n.sourceCaches){this._coordsAscending[p]={};const _=n.sourceCaches[p].getVisibleCoordinates(),w=n.sourceCaches[p].getSource(),E=w instanceof na?w.terrainTileRanges:null;for(const P of _){const D=this.terrain.sourceCache.getTerrainCoords(P,E);for(const O in D)this._coordsAscending[p][O]||(this._coordsAscending[p][O]=[]),this._coordsAscending[p][O].push(D[O])}}this._coordsAscendingStr={};for(const p of n._order){const _=n._layers[p],w=_.source;if($t[_.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const E in this._coordsAscending[w])this._coordsAscendingStr[w][E]=this._coordsAscending[w][E].map(P=>P.key).sort().join()}}for(const p of this._renderableTiles)for(const _ in this._coordsAscendingStr){const w=this._coordsAscendingStr[_][p.tileID.key];w&&w!==p.rttCoords[_]&&(p.rtt=[])}}renderLayer(n,l){if(n.isHidden(this.painter.transform.zoom))return!1;const p=Object.assign(Object.assign({},l),{isRenderingToTexture:!0}),_=n.type,w=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if($t[_]&&(this._prevType&&$t[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(n.id),!E))return!0;if($t[this._prevType]||$t[_]&&E){this._prevType=_;const P=this._stacks.length-1,D=this._stacks[P]||[];for(const O of this._renderableTiles){if(this.pool.isFull()&&(ti(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(O),O.rtt[P]){const q=this.pool.getObjectForId(O.rtt[P].id);if(q.stamp===O.rtt[P].stamp){this.pool.useObject(q);continue}}const F=this.pool.getOrCreateFreeObject();this.pool.useObject(F),this.pool.stampObject(F),O.rtt[P]={id:F.id,stamp:F.stamp},w.context.bindFramebuffer.set(F.fbo.framebuffer),w.context.clear({color:c.be.transparent,stencil:0}),w.currentStencilSource=void 0;for(let q=0;q<D.length;q++){const U=w.style._layers[D[q]],H=U.source?this._coordsAscending[U.source][O.tileID.key]:[O.tileID];w.context.viewport.set([0,0,F.fbo.width,F.fbo.height]),w._renderTileClippingMasks(U,H,!0),w.renderLayer(w,w.style.sourceCaches[U.source],U,H,p),U.source&&(O.rttCoords[U.source]=this._coordsAscendingStr[U.source][O.tileID.key])}}return ti(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects(),$t[_]}return!1}}const Rd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},si=M,qu={hash:!1,interactive:!0,bearingSnap:7,attributionControl:$s,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},fa={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Hf{constructor(n,l,p=!1){this.mousedown=w=>{this.startMove(w,W.mousePos(this.element,w)),W.addEventListener(window,"mousemove",this.mousemove),W.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,W.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHanlder.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=W.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),W.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=W.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=l;const _=new Sd;this._rotatePitchHanlder=new Dc({clickTolerance:3,move:(w,E)=>{const P=l.getBoundingClientRect(),D=new c.P((P.bottom-P.top)/2,(P.right-P.left)/2);return{bearingDelta:c.cm(new c.P(w.x,E.y),E,D),pitchDelta:p?-.5*(E.y-w.y):void 0}},moveStateManager:_,enable:!0,assignEvents:()=>{}}),this.map=n,W.addEventListener(l,"mousedown",this.mousedown),W.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),W.addEventListener(l,"touchcancel",this.reset)}startMove(n,l){this._rotatePitchHanlder.dragStart(n,l),W.disableDrag()}move(n,l){const p=this.map,{bearingDelta:_,pitchDelta:w}=this._rotatePitchHanlder.dragMove(n,l)||{};_&&p.setBearing(p.getBearing()+_),w&&p.setPitch(p.getPitch()+w)}off(){const n=this.element;W.removeEventListener(n,"mousedown",this.mousedown),W.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend),W.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){W.enableDrag(),W.removeEventListener(window,"mousemove",this.mousemove),W.removeEventListener(window,"mouseup",this.mouseup),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend)}}let oa;function rm(b,n,l,p=!1){if(p||!l.getCoveringTilesDetailsProvider().allowWorldCopies())return b==null?void 0:b.wrap();const _=new c.S(b.lng,b.lat);if(b=new c.S(b.lng,b.lat),n){const w=new c.S(b.lng-360,b.lat),E=new c.S(b.lng+360,b.lat),P=l.locationToScreenPoint(b).distSqr(n);l.locationToScreenPoint(w).distSqr(n)<P?b=w:l.locationToScreenPoint(E).distSqr(n)<P&&(b=E)}for(;Math.abs(b.lng-l.center.lng)>180;){const w=l.locationToScreenPoint(b);if(w.x>=0&&w.y>=0&&w.x<=l.width&&w.y<=l.height)break;b.lng>l.center.lng?b.lng-=360:b.lng+=360}return b.lng!==_.lng&&l.isPointOnMapSurface(l.locationToScreenPoint(b))?b:_}const _l={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function $r(b,n,l){const p=b.classList;for(const _ in _l)p.remove(`maplibregl-${l}-anchor-${_}`);p.add(`maplibregl-${l}-anchor-${n}`)}class Yr extends c.E{constructor(n){if(super(),this._onKeyPress=l=>{const p=l.code,_=l.charCode||l.keyCode;p!=="Space"&&p!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=l=>{const p=l.originalEvent.target,_=this._element;this._popup&&(p===_||_.contains(p))&&this.togglePopup()},this._update=l=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((l==null?void 0:l.type)==="terrain"||(l==null?void 0:l.type)==="render"&&!p)&&this._map.once("render",this._update),this._lngLat=rm(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||l&&l.type!=="moveend"||(this._pos=this._pos.round()),W.setTransform(this._element,`${_l[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${_}`),$.frameAsync(new AbortController).then(()=>{this._updateOpacity(l&&l.type==="moveend")}).catch(()=>{})},this._onMove=l=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=l=>{this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(n==null?void 0:n.opacity,n==null?void 0:n.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=c.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=W.create("div");const l=W.createNS("http://www.w3.org/2000/svg","svg"),p=41,_=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${p}px`),l.setAttributeNS(null,"width",`${_}px`),l.setAttributeNS(null,"viewBox",`0 0 ${_} ${p}`);const w=W.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const E=W.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const P=W.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"transform","translate(3.0, 29.0)"),P.setAttributeNS(null,"fill","#000000");const D=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const pe of D){const _e=W.createNS("http://www.w3.org/2000/svg","ellipse");_e.setAttributeNS(null,"opacity","0.04"),_e.setAttributeNS(null,"cx","10.5"),_e.setAttributeNS(null,"cy","5.80029008"),_e.setAttributeNS(null,"rx",pe.rx),_e.setAttributeNS(null,"ry",pe.ry),P.appendChild(_e)}const O=W.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const F=W.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(F);const q=W.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"opacity","0.25"),q.setAttributeNS(null,"fill","#000000");const U=W.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),q.appendChild(U);const H=W.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const ee=W.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(8.0, 8.0)");const fe=W.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#000000"),fe.setAttributeNS(null,"opacity","0.25"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962");const he=W.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#FFFFFF"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962"),ee.appendChild(fe),ee.appendChild(he),E.appendChild(P),E.appendChild(O),E.appendChild(q),E.appendChild(H),E.appendChild(ee),l.appendChild(E),l.setAttributeNS(null,"height",p*this._scale+"px"),l.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(l),this._offset=c.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),$r(this._element,this._anchor,"marker"),n&&n.className)for(const l of n.className.split(" "))this._element.classList.add(l);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),n.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),W.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=c.S.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const _=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var l,p;const _=(l=this._map)===null||l===void 0?void 0:l.terrain,w=this._map.transform.isLocationOccluded(this._lngLat);if(!_||w){const H=w?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==H&&(this._element.style.opacity=H))}if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const E=this._map,P=E.terrain.depthAtPoint(this._pos),D=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,D)-P<.006)return void(this._element.style.opacity=this._opacity);const O=-this._offset.y/E.transform.pixelsPerMeter,F=Math.sin(E.getPitch()*Math.PI/180)*O,q=E.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),U=E.transform.lngLatToCameraDepth(this._lngLat,D+F)-q>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&U&&this._popup.remove(),this._element.style.opacity=U?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=c.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,l){return(this._opacity===void 0||n===void 0&&l===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),l!==void 0&&(this._opacityWhenCovered=l),this._map&&this._updateOpacity(!0),this}}const $a={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let zr=0,Zo=!1;const $u={maxWidth:100,unit:"metric"};function Gu(b,n,l){const p=l&&l.maxWidth||100,_=b._container.clientHeight/2,w=b._container.clientWidth/2,E=b.unproject([w-p/2,_]),P=b.unproject([w+p/2,_]),D=Math.round(b.project(P).x-b.project(E).x),O=Math.min(p,D,b._container.clientWidth),F=E.distanceTo(P);if(l&&l.unit==="imperial"){const q=3.2808*F;q>5280?vl(n,O,q/5280,b._getUIString("ScaleControl.Miles")):vl(n,O,q,b._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?vl(n,O,F/1852,b._getUIString("ScaleControl.NauticalMiles")):F>=1e3?vl(n,O,F/1e3,b._getUIString("ScaleControl.Kilometers")):vl(n,O,F,b._getUIString("ScaleControl.Meters"))}function vl(b,n,l,p){const _=function(w){const E=Math.pow(10,`${Math.floor(w)}`.length-1);let P=w/E;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(D){const O=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*O)/O}(P),E*P}(l);b.style.width=n*(_/l)+"px",b.innerHTML=`${_}&nbsp;${p}`}const Ss={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Oc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Nc(b){if(b){if(typeof b=="number"){const n=Math.round(Math.abs(b)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,b),"top-left":new c.P(n,n),"top-right":new c.P(-n,n),bottom:new c.P(0,-b),"bottom-left":new c.P(n,-n),"bottom-right":new c.P(-n,-n),left:new c.P(b,0),right:new c.P(-b,0)}}if(b instanceof c.P||Array.isArray(b)){const n=c.P.convert(b);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:c.P.convert(b.center||[0,0]),top:c.P.convert(b.top||[0,0]),"top-left":c.P.convert(b["top-left"]||[0,0]),"top-right":c.P.convert(b["top-right"]||[0,0]),bottom:c.P.convert(b.bottom||[0,0]),"bottom-left":c.P.convert(b["bottom-left"]||[0,0]),"bottom-right":c.P.convert(b["bottom-right"]||[0,0]),left:c.P.convert(b.left||[0,0]),right:c.P.convert(b.right||[0,0])}}return Nc(new c.P(0,0))}const kh=M;y.AJAXError=c.cy,y.Event=c.l,y.Evented=c.E,y.LngLat=c.S,y.MercatorCoordinate=c.a0,y.Point=c.P,y.addProtocol=c.cz,y.config=c.a,y.removeProtocol=c.cA,y.AttributionControl=Nn,y.BoxZoomHandler=Vu,y.CanvasSource=Xa,y.CooperativeGesturesHandler=Gf,y.DoubleClickZoomHandler=tu,y.DragPanHandler=ju,y.DragRotateHandler=nu,y.EdgeInsets=Li,y.FullscreenControl=class extends c.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var n;let l=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=l==null?void 0:l.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)l=l.shadowRoot.fullscreenElement;l===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){W.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=W.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);W.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},y.GeoJSONSource=Oa,y.GeolocateControl=class extends c.E{constructor(b){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",n)),this._finish()}},this._updateCamera=n=>{const l=new c.S(n.coords.longitude,n.coords.latitude),p=n.coords.accuracy,_=this._map.getBearing(),w=c.e({bearing:_},this.options.fitBoundsOptions),E=Tr.fromLngLat(l,p);this._map.fitBounds(E,w,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const l=new c.S(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Zo)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=W.create("button","maplibregl-ctrl-geolocate",this._container),W.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=W.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Yr({element:this._dotElement}),this._circleElement=W.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Yr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},$a,b)}onAdd(b){return this._map=b,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(n=!1){if(oa!==void 0&&!n)return oa;if(window.navigator.permissions===void 0)return oa=!!window.navigator.geolocation,oa;try{oa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{oa=!!window.navigator.geolocation}return oa})}().then(n=>this._finishSetupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),W.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,zr=0,Zo=!1}_isOutOfMapMaxBounds(b){const n=this._map.getMaxBounds(),l=b.coords;return n&&(l.longitude<n.getWest()||l.longitude>n.getEast()||l.latitude<n.getSouth()||l.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const b=this._map.getBounds(),n=b.getSouthEast(),l=b.getNorthEast(),p=n.distanceTo(l),_=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":zr--,Zo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),zr++,zr>1?(b={maximumAge:6e5,timeout:0},Zo=!0):(b=this.options.positionOptions,Zo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},y.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const n=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(n!=="mercator"&&n?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=W.create("button","maplibregl-ctrl-globe",this._container),W.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){W.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},y.Hash=bs,y.ImageSource=na,y.KeyboardHandler=Ts,y.LngLatBounds=Tr,y.LogoControl=mr,y.Map=class extends Lr{constructor(b){var n,l;c.cv.mark(c.cw.create);const p=Object.assign(Object.assign(Object.assign({},qu),b),{canvasContextAttributes:Object.assign(Object.assign({},qu.canvasContextAttributes),b.canvasContextAttributes)});if(p.minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const _=new Ur,w=new fs;if(p.minZoom!==void 0&&_.setMinZoom(p.minZoom),p.maxZoom!==void 0&&_.setMaxZoom(p.maxZoom),p.minPitch!==void 0&&_.setMinPitch(p.minPitch),p.maxPitch!==void 0&&_.setMaxPitch(p.maxPitch),p.renderWorldCopies!==void 0&&_.setRenderWorldCopies(p.renderWorldCopies),super(_,w,{bearingSnap:p.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new xi,this._controls=[],this._mapId=c.a6(),this._contextLost=P=>{P.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:P}))},this._contextRestored=P=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:P}))},this._onMapScroll=P=>{if(P.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},p.canvasContextAttributes),this._trackResize=p.trackResize===!0,this._bearingSnap=p.bearingSnap,this._centerClampedToGround=p.centerClampedToGround,this._refreshExpiredTiles=p.refreshExpiredTiles===!0,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions===!0,this._collectResourceTiming=p.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Rd),p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=p.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Ue.addThrottleControl(()=>this.isMoving()),this._requestManager=new Fe(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let P=!1;const D=qo(O=>{this._trackResize&&!this._removed&&(this.resize(O),this.redraw())},50);this._resizeObserver=new ResizeObserver(O=>{P?D(O):P=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ho(this,p),this._hash=p.hash&&new bs(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,elevation:p.elevation,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,roll:p.roll}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,c.e({},p.fitBoundsOptions,{duration:0}))));const E=typeof p.style=="string"||((l=(n=p.style)===null||n===void 0?void 0:n.projection)===null||l===void 0?void 0:l.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new Nn(typeof p.attributionControl=="boolean"?void 0:p.attributionControl)),p.maplibreLogo&&this.addControl(new mr,p.logoPosition),this.on("style.load",()=>{if(E||this._resizeTransform(),this.transform.unmodified){const P=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(P)}}),this.on("data",P=>{this._update(P.dataType==="style"),this.fire(new c.l(`${P.dataType}data`,P))}),this.on("dataloading",P=>{this.fire(new c.l(`${P.dataType}dataloading`,P))}),this.on("dataabort",P=>{this.fire(new c.l("sourcedataabort",P))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,n){return this.style.setGlobalStateProperty(b,n),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,n){if(n===void 0&&(n=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=b.onAdd(this);this._controls.push(b);const p=this._controlPositions[n];return n.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(b);return n>-1&&this._controls.splice(n,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}calculateCameraOptionsFromTo(b,n,l,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,n,l,p)}resize(b,n=!0){const[l,p]=this._containerDimensions(),_=this._getClampedPixelRatio(l,p);if(this._resizeCanvas(l,p,_),this.painter.resize(l,p,_),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const P=this._getClampedPixelRatio(l,p);this._resizeCanvas(l,p,P),this.painter.resize(l,p,P)}this._resizeTransform(n);const w=!this._moving;return w&&(this.stop(),this.fire(new c.l("movestart",b)).fire(new c.l("move",b))),this.fire(new c.l("resize",b)),w&&this.fire(new c.l("moveend",b)),this}_resizeTransform(b=!0){var n;const[l,p]=this._containerDimensions();this.transform.resize(l,p,b),(n=this._requestedCameraState)===null||n===void 0||n.resize(l,p,b)}_getClampedPixelRatio(b,n){const{0:l,1:p}=this._maxCanvasSize,_=this.getPixelRatio(),w=b*_,E=n*_;return Math.min(w>l?l/w:1,E>p?p/E:1)*_}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Tr.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(c.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(c.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,n,l){if(b==="mouseenter"||b==="mouseover"){let p=!1;return{layers:n,listener:l,delegates:{mousemove:w=>{const E=n.filter(D=>this.getLayer(D)),P=E.length!==0?this.queryRenderedFeatures(w.point,{layers:E}):[];P.length?p||(p=!0,l.call(this,new qa(b,this,w.originalEvent,{features:P}))):p=!1},mouseout:()=>{p=!1}}}}if(b==="mouseleave"||b==="mouseout"){let p=!1;return{layers:n,listener:l,delegates:{mousemove:E=>{const P=n.filter(D=>this.getLayer(D));(P.length!==0?this.queryRenderedFeatures(E.point,{layers:P}):[]).length?p=!0:p&&(p=!1,l.call(this,new qa(b,this,E.originalEvent)))},mouseout:E=>{p&&(p=!1,l.call(this,new qa(b,this,E.originalEvent)))}}}}{const p=_=>{const w=n.filter(P=>this.getLayer(P)),E=w.length!==0?this.queryRenderedFeatures(_.point,{layers:w}):[];E.length&&(_.features=E,l.call(this,_),delete _.features)};return{layers:n,listener:l,delegates:{[b]:p}}}}_saveDelegatedListener(b,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(n)}_removeDelegatedListener(b,n,l){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const p=this._delegatedListeners[b];for(let _=0;_<p.length;_++){const w=p[_];if(w.listener===l&&w.layers.length===n.length&&w.layers.every(E=>n.includes(E))){for(const E in w.delegates)this.off(E,w.delegates[E]);return void p.splice(_,1)}}}on(b,n,l){if(l===void 0)return super.on(b,n);const p=typeof n=="string"?[n]:n,_=this._createDelegatedListener(b,p,l);this._saveDelegatedListener(b,_);for(const w in _.delegates)this.on(w,_.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(b,p,l)}}}once(b,n,l){if(l===void 0)return super.once(b,n);const p=typeof n=="string"?[n]:n,_=this._createDelegatedListener(b,p,l);for(const w in _.delegates){const E=_.delegates[w];_.delegates[w]=(...P)=>{this._removeDelegatedListener(b,p,l),E(...P)}}this._saveDelegatedListener(b,_);for(const w in _.delegates)this.once(w,_.delegates[w]);return this}off(b,n,l){return l===void 0?super.off(b,n):(this._removeDelegatedListener(b,typeof n=="string"?[n]:n,l),this)}queryRenderedFeatures(b,n){if(!this.style)return[];let l;const p=b instanceof c.P||Array.isArray(b),_=p?b:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(p?{}:b)||{},_ instanceof c.P||typeof _[0]=="number")l=[c.P.convert(_)];else{const w=c.P.convert(_[0]),E=c.P.convert(_[1]);l=[w,new c.P(E.x,w.y),E,new c.P(w.x,E.y),w]}return this.style.queryRenderedFeatures(l,n,this.transform)}querySourceFeatures(b,n){return this.style.querySourceFeatures(b,n)}setStyle(b,n){return(n=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(b,n))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const n=this._locale[b];if(n==null)throw new Error(`Missing UI string '${b}'`);return n}_updateStyle(b,n){var l,p;if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,n));const _=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new Sc(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,n,_):this.style.loadJSON(b,n,_),this):((p=(l=this.style)===null||l===void 0?void 0:l.projection)===null||p===void 0||p.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Sc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,n){if(typeof b=="string"){const l=this._requestManager.transformRequest(b,"Style");c.j(l,new AbortController).then(p=>{this._updateDiff(p.data,n)}).catch(p=>{p&&this.fire(new c.k(p))})}else typeof b=="object"&&this._updateDiff(b,n)}_updateDiff(b,n){try{this.style.setState(b,n)&&this._update(!0)}catch(l){c.w(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(b,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(b,n){return this._lazyInitEmptyStyle(),this.style.addSource(b,n),this._update(!0)}isSourceLoaded(b){const n=this.style&&this.style.sourceCaches[b];if(n!==void 0)return n.loaded();this.fire(new c.k(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const n=this.style.sourceCaches[b.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&n.reload();for(const l in this.style._layers){const p=this.style._layers[l];p.type==="hillshade"&&p.source===b.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),p.type==="color-relief"&&p.source===b.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ca(this.painter,n,b),this.painter.renderToTexture=new rn(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=l=>{var p;l.dataType==="style"?this.terrain.sourceCache.freeRtt():l.dataType==="source"&&l.tile&&(l.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((p=l.source)===null||p===void 0?void 0:p.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(l.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:b})),this}getTerrain(){var b,n;return(n=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const n in b){const l=b[n]._tiles;for(const p in l){const _=l[p];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,n,l){if(l){const p=this.getSource(l);if(!p)throw new Error(`There is no source with ID "${l}", cannot set LOD parameters`);p.calculateTileZoom=tt(Math.max(1,b),Math.max(1,n))}else for(const p in this.style.sourceCaches)this.style.sourceCaches[p].getSource().calculateTileZoom=tt(Math.max(1,b),Math.max(1,n));return this._update(!0),this}refreshTiles(b,n){const l=this.style.sourceCaches[b];if(!l)throw new Error(`There is no source cache with ID "${b}", cannot refresh tile`);n===void 0?l.reload(!0):l.refreshTiles(n.map(p=>new c.a3(p.z,p.x,p.y)))}addImage(b,n,l={}){const{pixelRatio:p=1,sdf:_=!1,stretchX:w,stretchY:E,content:P,textFitWidth:D,textFitHeight:O}=l;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||c.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:F,height:q,data:U}=n,H=n;return this.style.addImage(b,{data:new c.R({width:F,height:q},new Uint8Array(U)),pixelRatio:p,stretchX:w,stretchY:E,content:P,textFitWidth:D,textFitHeight:O,sdf:_,version:0,userImage:H}),H.onAdd&&H.onAdd(this,b),this}}{const{width:F,height:q,data:U}=$.getImageData(n);this.style.addImage(b,{data:new c.R({width:F,height:q},U),pixelRatio:p,stretchX:w,stretchY:E,content:P,textFitWidth:D,textFitHeight:O,sdf:_,version:0})}}updateImage(b,n){const l=this.style.getImage(b);if(!l)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=n instanceof HTMLImageElement||c.b(n)?$.getImageData(n):n,{width:_,height:w,data:E}=p;if(_===void 0||w===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==l.data.width||w!==l.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const P=!(n instanceof HTMLImageElement||c.b(n));return l.data.replace(E,P),this.style.updateImage(b,l),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return Ue.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,n){return this._lazyInitEmptyStyle(),this.style.addLayer(b,n),this._update(!0)}moveLayer(b,n){return this.style.moveLayer(b,n),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,n,l){return this.style.setLayerZoomRange(b,n,l),this._update(!0)}setFilter(b,n,l={}){return this.style.setFilter(b,n,l),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,n,l,p={}){return this.style.setPaintProperty(b,n,l,p),this._update(!0)}getPaintProperty(b,n){return this.style.getPaintProperty(b,n)}setLayoutProperty(b,n,l,p={}){return this.style.setLayoutProperty(b,n,l,p),this._update(!0)}getLayoutProperty(b,n){return this.style.getLayoutProperty(b,n)}setGlyphs(b,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,n,l={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,n,l,p=>{p||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,n,l=>{l||this._update(!0)}),this}setLight(b,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,n={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,n),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,n){return this.style.setFeatureState(b,n),this._update()}removeFeatureState(b,n){return this.style.removeFeatureState(b,n),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,n=0;return this._container&&(b=this._container.clientWidth||400,n=this._container.clientHeight||300),[b,n]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const n=this._canvasContainer=W.create("div","maplibregl-canvas-container",b);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=W.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const l=this._containerDimensions(),p=this._getClampedPixelRatio(l[0],l[1]);this._resizeCanvas(l[0],l[1],p);const _=this._controlContainer=W.create("div","maplibregl-control-container",b),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{w[E]=W.create("div",`maplibregl-ctrl-${E} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,n,l){this._canvas.width=Math.floor(l*b),this._canvas.height=Math.floor(l*n),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let n=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{n={requestedAttributes:b},p&&(n.statusMessage=p.statusMessage,n.type=p.type)},{once:!0});let l=null;if(l=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!l){const p="Failed to initialize WebGL";throw n?(n.message=p,new Error(JSON.stringify(n))):new Error(p)}this.painter=new ts(l,this.transform),re.testSupport(l)}migrateProjection(b,n){super.migrateProjection(b,n),this.painter.transform=b,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var n,l,p,_,w;const E=this._idleTriggered?this._fadeDuration:0,P=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let D=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const q=this.transform.zoom,U=$.now();this.style.zoomHistory.update(q,U);const H=new c.F(q,{now:U,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),ee=H.crossFadingFactor();ee===1&&ee===this._crossFadingFactor||(D=!0,this._crossFadingFactor=ee),this.style.update(H)}const O=((l=this.style.projection)===null||l===void 0?void 0:l.transitionState)>0!==P;(p=this.style.projection)===null||p===void 0||p.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((_=this.style.projection)===null||_===void 0?void 0:_.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||O)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,O),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cv.mark(c.cw.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||D)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,c.cv.mark(c.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ue.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n!=null&&n.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),W.remove(this._canvasContainer),W.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cv.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,$.frame(this._frameRequest,b=>{c.cv.frame(b),this._frameRequest=null;try{this._render(b)}catch(n){if(!c.cx(n)&&!function(l){return l.message===Nf}(n))throw n}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return si}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},y.MapMouseEvent=qa,y.MapTouchEvent=bo,y.MapWheelEvent=jf,y.Marker=Yr,y.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const n=this._map.getZoom(),l=n===this._map.getMaxZoom(),p=n===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(n,l)=>{const p=this._map._getUIString(`NavigationControl.${l}`);n.title=p,n.setAttribute("aria-label",p)},this.options=c.e({},fa,b),this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),W.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),W.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=W.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Hf(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){W.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,n){const l=W.create("button",b,this._container);return l.type="button",l.addEventListener("click",n),l}},y.Popup=class extends c.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&W.remove(this._content),this._container&&(W.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=W.create("div","maplibregl-popup",this._map.getContainer()),this._tip=W.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=rm(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!n)return;const l=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationToScreenPoint(this._lngLat));let p=this.options.anchor;const _=Nc(this.options.offset);if(!p){const E=this._container.offsetWidth,P=this._container.offsetHeight;let D;D=l.y+_.bottom.y<P?["top"]:l.y>this._map.transform.height-P?["bottom"]:[],l.x<E/2?D.push("left"):l.x>this._map.transform.width-E/2&&D.push("right"),p=D.length===0?"bottom":D.join("-")}let w=l.add(_[p]);this.options.subpixelPositioning||(w=w.round()),W.setTransform(this._container,`${_l[p]} translate(${w.x}px,${w.y}px)`),$r(this._container,p,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Ss),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=c.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const n=document.createDocumentFragment(),l=document.createElement("body");let p;for(l.innerHTML=b;p=l.firstChild,p;)n.appendChild(p);return this.setDOMContent(n)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=W.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=W.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Oc);b&&b.focus()}},y.RasterDEMTileSource=Ir,y.RasterTileSource=rl,y.ScaleControl=class{constructor(b){this._onMove=()=>{Gu(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,Gu(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},$u),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){W.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},y.ScrollZoomHandler=yl,y.Style=Sc,y.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=W.create("button","maplibregl-ctrl-terrain",this._container),W.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){W.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},y.TwoFingersTouchPitchHandler=Cd,y.TwoFingersTouchRotateHandler=Ad,y.TwoFingersTouchZoomHandler=wo,y.TwoFingersTouchZoomRotateHandler=Id,y.VectorTileSource=_a,y.VideoSource=Ls,y.addSourceType=(b,n)=>c._(void 0,void 0,void 0,function*(){if(zs(b))throw new Error(`A source type called "${b}" already exists.`);((l,p)=>{bu[l]=p})(b,n)}),y.clearPrewarmedResources=function(){const b=St;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(Re),St=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},y.createTileMesh=wc,y.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},y.getRTLTextPluginStatus=function(){return Bn().getRTLTextPluginStatus()},y.getVersion=function(){return kh},y.getWorkerCount=function(){return _t.workerCount},y.getWorkerUrl=function(){return c.a.WORKER_URL},y.importScriptInWorkers=function(b){return ii().broadcast("IS",b)},y.prewarm=function(){En().acquire(Re)},y.setMaxParallelImageRequests=function(b){c.a.MAX_PARALLEL_IMAGE_REQUESTS=b},y.setRTLTextPlugin=function(b,n){return Bn().setRTLTextPlugin(b,n)},y.setWorkerCount=function(b){_t.workerCount=b},y.setWorkerUrl=function(b){c.a.WORKER_URL=b}});var m=t;return m})}(t0)),t0.exports}var v4=_4();const un=A_(v4);function b4(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class x4{constructor(){this._apiKey="",this._fetch=b4(),this.tileCacheSize=200}set apiKey(e){this._apiKey=e}get apiKey(){return this._apiKey}set fetch(e){this._fetch=e}get fetch(){return this._fetch}}const eg=new x4,w4={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1}},T4={ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!0},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!0},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!0},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!0},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!0},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!0},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!0},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!0},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!0},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!0},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!0},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!0},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!0},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!0},WELSH:{code:"cy",flag:"name:cy",name:"Welsh",latin:!0,isMode:!1,geocoding:!0}},U_={...w4,...T4};function S4(r,e=U_){return r in e?r[r]:null}function t1(r,e=U_){for(const t of Object.values(e))if(t.code===r)return t;return null}function n1(r,e=U_){for(const t of Object.values(e))if(t.flag===r)return t;return null}function E4(r){return r!==null&&typeof r=="object"&&"code"in r&&"flag"in r&&"name"in r&&"latin"in r&&"isMode"in r&&"geocoding"in r&&(typeof r.code=="string"||r.code===null)&&typeof r.flag=="string"&&typeof r.name=="string"&&typeof r.latin=="boolean"&&typeof r.isMode=="boolean"&&typeof r.geocoding=="boolean"}function bS(r,e=U_){return E4(r)?n1(r.flag,e):typeof r!="string"?null:S4(r,e)||t1(r,e)||n1(r,e)||null}async function A4(r,e={}){if(eg.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(r).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return eg.fetch(r,e)}const LI={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(LI);class C4 extends Error{constructor(e,t=""){super(`Call to enpoint ${e.url} failed with the status code ${e.status}. ${t}`),this.res=e}}const xS={403:"Key is missing, invalid or restricted"};async function I4(r={}){const e=new URL("geolocation/ip.json",LI.maptilerApiURL);e.searchParams.set("key",r.apiKey??eg.apiKey);const t=e.toString(),a=await A4(t);if(!a.ok)throw new C4(a,a.status in xS?xS[a.status]:"");return await a.json()}const wS={info:I4};function zI(r){const e=/^maptiler:\/\/(.*)/;let t;const a=r.trim();let d;return a.startsWith("http://")||a.startsWith("https://")?d=a:(t=e.exec(a))!==null?d=`https://api.maptiler.com/maps/${t[1]}/style.json`:d=`https://api.maptiler.com/maps/${a}/style.json`,d}class OI{constructor(e,t,a,d,m,y,c=!1){this.name=e,this.variantType=t,this.id=a,this.referenceStyle=d,this.description=m,this.imageURL=y,this.deprecated=c}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(e){return this.referenceStyle.hasVariant(e)}getVariant(e){const t=this.referenceStyle.getVariant(e);return this.warnIfDeprecated(t),t}getVariants(){return this.referenceStyle.getVariants().filter(e=>e!==this).map(e=>(this.warnIfDeprecated(e),e))}getImageURL(){return this.imageURL}getExpandedStyleURL(){return zI(this.getId())}warnIfDeprecated(e=this){if(!e.deprecated)return e;const t=e.getFullName();return console.warn(`Style "${t}" is deprecated and will be removed in a future version.`),e}}class NI{constructor(e,t){this.name=e,this.id=t,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(e){this.variants[e.getType()]=e,this.orderedVariants.push(e)}hasVariant(e){return e in this.variants}getVariant(e){return e in this.variants?this.variants[e]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0].warnIfDeprecated()}}const Jy=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",deprecated:!0,name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",deprecated:!0,variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",deprecated:!0,variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",deprecated:!0,variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",deprecated:!0,variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",deprecated:!0,variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",deprecated:!0,description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",deprecated:!0,description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"AQUARELLE",name:"Aquarelle",description:"Watercolor map for creative use",variants:[{id:"aquarelle",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"aquarelle-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"aquarelle-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]},{referenceStyleID:"LANDSCAPE",name:"Landscape",description:"Terrain map for data overlays and visualisations",variants:[{id:"landscape",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"landscape-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"landscape-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]}];function M4(r){return new Proxy(r,{get(e,t,a){return e.hasVariant(t)?e.getVariant(t):t.toString().toUpperCase()===t?r.getDefaultVariant():Reflect.get(e,t,a)}})}function P4(){const r={};for(let e=0;e<Jy.length;e+=1){const t=Jy[e],a=M4(new NI(t.name,t.referenceStyleID));for(let d=0;d<t.variants.length;d+=1){const m=t.variants[d],y=new OI(m.name,m.variantType,m.id,a,m.description,m.imageURL,m.deprecated);a.addVariant(y)}r[t.referenceStyleID]=a}return r}const e_=P4();var zv={exports:{}},TS;function R4(){if(TS)return zv.exports;TS=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(Fe,Ze,me){return Function.prototype.apply.call(Fe,Ze,me)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(Fe){return Object.getOwnPropertyNames(Fe).concat(Object.getOwnPropertySymbols(Fe))}:t=function(Fe){return Object.getOwnPropertyNames(Fe)};function a(Ue){console&&console.warn&&console.warn(Ue)}var d=Number.isNaN||function(Fe){return Fe!==Fe};function m(){m.init.call(this)}zv.exports=m,zv.exports.once=Be,m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var y=10;function c(Ue){if(typeof Ue!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Ue)}Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return y},set:function(Ue){if(typeof Ue!="number"||Ue<0||d(Ue))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Ue+".");y=Ue}}),m.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(Fe){if(typeof Fe!="number"||Fe<0||d(Fe))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Fe+".");return this._maxListeners=Fe,this};function M(Ue){return Ue._maxListeners===void 0?m.defaultMaxListeners:Ue._maxListeners}m.prototype.getMaxListeners=function(){return M(this)},m.prototype.emit=function(Fe){for(var Ze=[],me=1;me<arguments.length;me++)Ze.push(arguments[me]);var se=Fe==="error",ye=this._events;if(ye!==void 0)se=se&&ye.error===void 0;else if(!se)return!1;if(se){var we;if(Ze.length>0&&(we=Ze[0]),we instanceof Error)throw we;var Ee=new Error("Unhandled error."+(we?" ("+we.message+")":""));throw Ee.context=we,Ee}var ke=ye[Fe];if(ke===void 0)return!1;if(typeof ke=="function")e(ke,this,Ze);else for(var ve=ke.length,Bt=re(ke,ve),me=0;me<ve;++me)e(Bt[me],this,Ze);return!0};function R(Ue,Fe,Ze,me){var se,ye,we;if(c(Ze),ye=Ue._events,ye===void 0?(ye=Ue._events=Object.create(null),Ue._eventsCount=0):(ye.newListener!==void 0&&(Ue.emit("newListener",Fe,Ze.listener?Ze.listener:Ze),ye=Ue._events),we=ye[Fe]),we===void 0)we=ye[Fe]=Ze,++Ue._eventsCount;else if(typeof we=="function"?we=ye[Fe]=me?[Ze,we]:[we,Ze]:me?we.unshift(Ze):we.push(Ze),se=M(Ue),se>0&&we.length>se&&!we.warned){we.warned=!0;var Ee=new Error("Possible EventEmitter memory leak detected. "+we.length+" "+String(Fe)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ee.name="MaxListenersExceededWarning",Ee.emitter=Ue,Ee.type=Fe,Ee.count=we.length,a(Ee)}return Ue}m.prototype.addListener=function(Fe,Ze){return R(this,Fe,Ze,!1)},m.prototype.on=m.prototype.addListener,m.prototype.prependListener=function(Fe,Ze){return R(this,Fe,Ze,!0)};function B(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function K(Ue,Fe,Ze){var me={fired:!1,wrapFn:void 0,target:Ue,type:Fe,listener:Ze},se=B.bind(me);return se.listener=Ze,me.wrapFn=se,se}m.prototype.once=function(Fe,Ze){return c(Ze),this.on(Fe,K(this,Fe,Ze)),this},m.prototype.prependOnceListener=function(Fe,Ze){return c(Ze),this.prependListener(Fe,K(this,Fe,Ze)),this},m.prototype.removeListener=function(Fe,Ze){var me,se,ye,we,Ee;if(c(Ze),se=this._events,se===void 0)return this;if(me=se[Fe],me===void 0)return this;if(me===Ze||me.listener===Ze)--this._eventsCount===0?this._events=Object.create(null):(delete se[Fe],se.removeListener&&this.emit("removeListener",Fe,me.listener||Ze));else if(typeof me!="function"){for(ye=-1,we=me.length-1;we>=0;we--)if(me[we]===Ze||me[we].listener===Ze){Ee=me[we].listener,ye=we;break}if(ye<0)return this;ye===0?me.shift():Me(me,ye),me.length===1&&(se[Fe]=me[0]),se.removeListener!==void 0&&this.emit("removeListener",Fe,Ee||Ze)}return this},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(Fe){var Ze,me,se;if(me=this._events,me===void 0)return this;if(me.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):me[Fe]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete me[Fe]),this;if(arguments.length===0){var ye=Object.keys(me),we;for(se=0;se<ye.length;++se)we=ye[se],we!=="removeListener"&&this.removeAllListeners(we);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(Ze=me[Fe],typeof Ze=="function")this.removeListener(Fe,Ze);else if(Ze!==void 0)for(se=Ze.length-1;se>=0;se--)this.removeListener(Fe,Ze[se]);return this};function $(Ue,Fe,Ze){var me=Ue._events;if(me===void 0)return[];var se=me[Fe];return se===void 0?[]:typeof se=="function"?Ze?[se.listener||se]:[se]:Ze?Ce(se):re(se,se.length)}m.prototype.listeners=function(Fe){return $(this,Fe,!0)},m.prototype.rawListeners=function(Fe){return $(this,Fe,!1)},m.listenerCount=function(Ue,Fe){return typeof Ue.listenerCount=="function"?Ue.listenerCount(Fe):W.call(Ue,Fe)},m.prototype.listenerCount=W;function W(Ue){var Fe=this._events;if(Fe!==void 0){var Ze=Fe[Ue];if(typeof Ze=="function")return 1;if(Ze!==void 0)return Ze.length}return 0}m.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function re(Ue,Fe){for(var Ze=new Array(Fe),me=0;me<Fe;++me)Ze[me]=Ue[me];return Ze}function Me(Ue,Fe){for(;Fe+1<Ue.length;Fe++)Ue[Fe]=Ue[Fe+1];Ue.pop()}function Ce(Ue){for(var Fe=new Array(Ue.length),Ze=0;Ze<Fe.length;++Ze)Fe[Ze]=Ue[Ze].listener||Ue[Ze];return Fe}function Be(Ue,Fe){return new Promise(function(Ze,me){function se(we){Ue.removeListener(Fe,ye),me(we)}function ye(){typeof Ue.removeListener=="function"&&Ue.removeListener("error",se),Ze([].slice.call(arguments))}ut(Ue,Fe,ye,{once:!0}),Fe!=="error"&&He(Ue,se,{once:!0})})}function He(Ue,Fe,Ze){typeof Ue.on=="function"&&ut(Ue,"error",Fe,Ze)}function ut(Ue,Fe,Ze,me){if(typeof Ue.on=="function")me.once?Ue.once(Fe,Ze):Ue.on(Fe,Ze);else if(typeof Ue.addEventListener=="function")Ue.addEventListener(Fe,function se(ye){me.once&&Ue.removeEventListener(Fe,se),Ze(ye)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Ue)}return zv.exports}var k4=R4();const D4=A_(k4),Cs=[];for(let r=0;r<256;++r)Cs.push((r+256).toString(16).slice(1));function L4(r,e=0){return(Cs[r[e+0]]+Cs[r[e+1]]+Cs[r[e+2]]+Cs[r[e+3]]+"-"+Cs[r[e+4]]+Cs[r[e+5]]+"-"+Cs[r[e+6]]+Cs[r[e+7]]+"-"+Cs[r[e+8]]+Cs[r[e+9]]+"-"+Cs[r[e+10]]+Cs[r[e+11]]+Cs[r[e+12]]+Cs[r[e+13]]+Cs[r[e+14]]+Cs[r[e+15]]).toLowerCase()}let sx;const z4=new Uint8Array(16);function O4(){if(!sx){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");sx=crypto.getRandomValues.bind(crypto)}return sx(z4)}const N4=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),SS={randomUUID:N4};function B4(r,e,t){var d;if(SS.randomUUID&&!r)return SS.randomUUID();r=r||{};const a=r.random??((d=r.rng)==null?void 0:d.call(r))??O4();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,L4(a)}const BI="3.7.7",F4=BI,Sg=typeof Buffer=="function",ES=typeof TextDecoder=="function"?new TextDecoder:void 0,AS=typeof TextEncoder=="function"?new TextEncoder:void 0,V4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Gy=Array.prototype.slice.call(V4),Ov=(r=>{let e={};return r.forEach((t,a)=>e[t]=a),e})(Gy),j4=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Is=String.fromCharCode.bind(String),CS=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):r=>new Uint8Array(Array.prototype.slice.call(r,0)),FI=r=>r.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),VI=r=>r.replace(/[^A-Za-z0-9\+\/]/g,""),jI=r=>{let e,t,a,d,m="";const y=r.length%3;for(let c=0;c<r.length;){if((t=r.charCodeAt(c++))>255||(a=r.charCodeAt(c++))>255||(d=r.charCodeAt(c++))>255)throw new TypeError("invalid character found");e=t<<16|a<<8|d,m+=Gy[e>>18&63]+Gy[e>>12&63]+Gy[e>>6&63]+Gy[e&63]}return y?m.slice(0,y-3)+"===".substring(y):m},Uw=typeof btoa=="function"?r=>btoa(r):Sg?r=>Buffer.from(r,"binary").toString("base64"):jI,r1=Sg?r=>Buffer.from(r).toString("base64"):r=>{let t=[];for(let a=0,d=r.length;a<d;a+=4096)t.push(Is.apply(null,r.subarray(a,a+4096)));return Uw(t.join(""))},n0=(r,e=!1)=>e?FI(r1(r)):r1(r),U4=r=>{if(r.length<2){var e=r.charCodeAt(0);return e<128?r:e<2048?Is(192|e>>>6)+Is(128|e&63):Is(224|e>>>12&15)+Is(128|e>>>6&63)+Is(128|e&63)}else{var e=65536+(r.charCodeAt(0)-55296)*1024+(r.charCodeAt(1)-56320);return Is(240|e>>>18&7)+Is(128|e>>>12&63)+Is(128|e>>>6&63)+Is(128|e&63)}},q4=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,UI=r=>r.replace(q4,U4),IS=Sg?r=>Buffer.from(r,"utf8").toString("base64"):AS?r=>r1(AS.encode(r)):r=>Uw(UI(r)),tg=(r,e=!1)=>e?FI(IS(r)):IS(r),MS=r=>tg(r,!0),$4=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,G4=r=>{switch(r.length){case 4:var e=(7&r.charCodeAt(0))<<18|(63&r.charCodeAt(1))<<12|(63&r.charCodeAt(2))<<6|63&r.charCodeAt(3),t=e-65536;return Is((t>>>10)+55296)+Is((t&1023)+56320);case 3:return Is((15&r.charCodeAt(0))<<12|(63&r.charCodeAt(1))<<6|63&r.charCodeAt(2));default:return Is((31&r.charCodeAt(0))<<6|63&r.charCodeAt(1))}},qI=r=>r.replace($4,G4),$I=r=>{if(r=r.replace(/\s+/g,""),!j4.test(r))throw new TypeError("malformed base64.");r+="==".slice(2-(r.length&3));let e,t="",a,d;for(let m=0;m<r.length;)e=Ov[r.charAt(m++)]<<18|Ov[r.charAt(m++)]<<12|(a=Ov[r.charAt(m++)])<<6|(d=Ov[r.charAt(m++)]),t+=a===64?Is(e>>16&255):d===64?Is(e>>16&255,e>>8&255):Is(e>>16&255,e>>8&255,e&255);return t},qw=typeof atob=="function"?r=>atob(VI(r)):Sg?r=>Buffer.from(r,"base64").toString("binary"):$I,GI=Sg?r=>CS(Buffer.from(r,"base64")):r=>CS(qw(r).split("").map(e=>e.charCodeAt(0))),HI=r=>GI(ZI(r)),H4=Sg?r=>Buffer.from(r,"base64").toString("utf8"):ES?r=>ES.decode(GI(r)):r=>qI(qw(r)),ZI=r=>VI(r.replace(/[-_]/g,e=>e=="-"?"+":"/")),i1=r=>H4(ZI(r)),Z4=r=>{if(typeof r!="string")return!1;const e=r.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},WI=r=>({value:r,enumerable:!1,writable:!0,configurable:!0}),KI=function(){const r=(e,t)=>Object.defineProperty(String.prototype,e,WI(t));r("fromBase64",function(){return i1(this)}),r("toBase64",function(e){return tg(this,e)}),r("toBase64URI",function(){return tg(this,!0)}),r("toBase64URL",function(){return tg(this,!0)}),r("toUint8Array",function(){return HI(this)})},XI=function(){const r=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,WI(t));r("toBase64",function(e){return n0(this,e)}),r("toBase64URI",function(){return n0(this,!0)}),r("toBase64URL",function(){return n0(this,!0)})},W4=()=>{KI(),XI()},K4={version:BI,VERSION:F4,atob:qw,atobPolyfill:$I,btoa:Uw,btoaPolyfill:jI,fromBase64:i1,toBase64:tg,encode:tg,encodeURI:MS,encodeURL:MS,utob:UI,btou:qI,decode:i1,isValid:Z4,fromUint8Array:n0,toUint8Array:HI,extendString:KI,extendUint8Array:XI,extendBuiltins:W4};var X4=Object.defineProperty,YI=r=>{throw TypeError(r)},Y4=(r,e,t)=>e in r?X4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$n=(r,e,t)=>Y4(r,typeof e!="symbol"?e+"":e,t),$w=(r,e,t)=>e.has(r)||YI("Cannot "+t),dr=(r,e,t)=>($w(r,e,"read from private field"),t?t.call(r):e.get(r)),Tp=(r,e,t)=>e.has(r)?YI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Um=(r,e,t,a)=>($w(r,e,"write to private field"),e.set(r,t),t),Cl=(r,e,t)=>($w(r,e,"access private method"),t);const xr={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...U_};function PS(){if(typeof navigator>"u"){const r=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return t1(r)||xr.ENGLISH}return Array.from(new Set(navigator.languages.map(r=>r.split("-")[0]))).map(r=>t1(r)).filter(r=>r)[0]??xr.LOCAL}const Po={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",telemetryURL:"https://api.maptiler.com/metrics",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:xr.STYLE,secondaryLanguage:xr.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Po);const Gw=B4();class Q4 extends D4{constructor(){super(...arguments),$n(this,"primaryLanguage",Po.primaryLanguage),$n(this,"secondaryLanguage"),$n(this,"session",!0),$n(this,"caching",!0),$n(this,"telemetry",!0),$n(this,"_unit","metric"),$n(this,"_apiKey","")}set unit(e){this._unit=e,this.emit("unit",e)}get unit(){return this._unit}set apiKey(e){this._apiKey=e,eg.apiKey=e,this.emit("apiKey",e)}get apiKey(){return this._apiKey}set fetch(e){eg.fetch=e}get fetch(){return eg.fetch}}const Za=new Q4,a1="localcache_source",s1="localcache",J4="maptiler_sdk",eN=1e3,tN=100,o1=typeof caches<"u",{addProtocol:RS}=un;function nN(r,e){if(o1&&Za.caching&&Za.session&&r.host===Po.maptilerApiHost){if(e==="Source"&&r.href.includes("tiles.json"))return r.href.replace("https://",`${a1}://`);if(e==="Tile"||e==="Glyphs")return r.href.replace("https://",`${s1}://`)}return r.href}let ox;async function QI(){return ox||(ox=await caches.open(J4)),ox}let kS=0;async function rN(){const r=await QI(),e=await r.keys(),t=e.slice(0,Math.max(e.length-eN,0));for(const a of t)r.delete(a)}function iN(){RS(a1,async(r,e)=>{if(!r.url)throw new Error("");r.url=r.url.replace(`${a1}://`,"https://");const t=r;t.signal=e.signal;const a=await fetch(r.url,t),d=await a.json();return d.tiles&&d.tiles.length>0&&(d.tiles[0]+=`&last-modified=${a.headers.get("Last-Modified")}`),{data:d,cacheControl:a.headers.get("Cache-Control"),expires:a.headers.get("Expires")}}),RS(s1,async(r,e)=>{if(!r.url)throw new Error("");r.url=r.url.replace(`${s1}://`,"https://");const t=new URL(r.url),a=new URL(t);a.searchParams.delete("mtsid"),a.searchParams.delete("key");const d=a.toString(),m=new URL(t);m.searchParams.delete("last-modified");const y=m.toString(),c=async $=>({data:await $.arrayBuffer(),cacheControl:$.headers.get("Cache-Control"),expires:$.headers.get("Expires")}),M=await QI(),R=await M.match(d);if(R)return c(R);const B=r;B.signal=e.signal;const K=await fetch(y,B);return K.status>=200&&K.status<300&&(M.put(d,K.clone()).catch(()=>{}),++kS>tN&&(rN(),kS=0)),c(K)})}function aN(){if(typeof window>"u")return;const r=un.getRTLTextPluginStatus();if(r==="unavailable"||r==="requested")try{un.setRTLTextPlugin(Po.rtlPluginURL,!0)}catch{}}function sN(r,e){for(const t of r)typeof e[t]=="function"&&(e[t]=e[t].bind(e))}function DS(r,e){let t=null;try{t=new URL(r)}catch{return{url:r}}return t.host===Po.maptilerApiHost&&(t.searchParams.has("key")||t.searchParams.append("key",Za.apiKey),Za.session&&t.searchParams.append("mtsid",Gw)),{url:nN(t,e)}}function LS(r){return(e,t)=>{if(r!=null){const a=r(e,t),d=DS((a==null?void 0:a.url)??"",t);return{...a,...d}}return DS(e,t)}}function oN(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function lN(r){const e=oN();if(!e)return;let t=null;if(typeof r=="string"?t=document.getElementById(r):r instanceof HTMLElement&&(t=r),!t)throw new Error("The Map container must be provided.");const a=document.createElement("div");throw a.innerHTML=e,a.classList.add("webgl-warning-div"),t.appendChild(a),new Error(e)}function zS(r,e){return!(!Array.isArray(r)||r.length!==2||r[0]!=="get"||typeof r[1]!="string"||e&&!r[1].startsWith("name:")||!e&&r[1]!=="name")}function uN(r,e,t){const a=structuredClone(r),d=m=>{if(typeof m!="string")for(let y=0;y<m.length;y+=1)zS(m[y],t)?m[y]=structuredClone(e):d(m[y])};return zS(a,t)?e:(d(a),a)}function cN(r,e){const t=e?/\{name:\S+\}/:/\{name\}/;return{contains:t.test(r),exactMatch:new RegExp(`^${t.source}$`).test(r)}}function hN(r,e,t){const a=t?/\{name:\S+\}/:/\{name\}/,d=r.split(a);return["concat",...d.flatMap((m,y)=>y===d.length-1?[m]:[m,e])]}function dN(r){var e;const t=/\{name(?::(?<language>\S+))?\}/g,a=[];for(;;){const d=t.exec(r);if(!d)break;const m=((e=d.groups)==null?void 0:e.language)??null;a.push(m)}return a}function fN(r){return!Array.isArray(r)||r.length!==2||r[0]!=="get"||typeof r[1]!="string"?null:r[1].trim()==="name"?{isLanguage:!0,localization:null}:r[1].trim().startsWith("name:")?{isLanguage:!0,localization:r[1].trim().split(":").pop()}:null}function pN(r){const e=[],t=structuredClone(r),a=d=>{if(typeof d!="string")for(let m=0;m<d.length;m+=1){const y=fN(d[m]);y?e.push(y.localization):a(d[m])}};return a([t]),e}function mN(r,e){const t=[];for(const m of r){if(m.type!=="symbol")continue;const y=m,{id:c,layout:M}=y;if(!M||!("text-field"in M))continue;const R=e.getLayoutProperty(c,"text-field");if(R)if(typeof R=="string"){const B=dN(R);t.push(B)}else{const B=pN(R);t.push(B)}}const a=t.flat(),d={unlocalized:0,localized:{}};for(const m of a)m===null?d.unlocalized+=1:(m in d.localized||(d.localized[m]=0),d.localized[m]+=1);return d}let gN=class extends un.Marker{addTo(r){return super.addTo(r)}};class yN extends un.Popup{addTo(e){return super.addTo(e)}}class Pj extends un.Style{constructor(e,t={}){super(e,t)}}class Rj extends un.CanvasSource{onAdd(e){super.onAdd(e)}}class kj extends un.GeoJSONSource{onAdd(e){super.onAdd(e)}}class Dj extends un.ImageSource{onAdd(e){super.onAdd(e)}}class Lj extends un.RasterTileSource{onAdd(e){super.onAdd(e)}}class zj extends un.RasterDEMTileSource{onAdd(e){super.onAdd(e)}}class Oj extends un.VectorTileSource{onAdd(e){super.onAdd(e)}}class Nj extends un.VideoSource{onAdd(e){super.onAdd(e)}}class _N extends un.NavigationControl{onAdd(e){return super.onAdd(e)}}class vN extends un.GeolocateControl{onAdd(e){return super.onAdd(e)}}class Bj extends un.AttributionControl{onAdd(e){return super.onAdd(e)}}class bN extends un.LogoControl{onAdd(e){return super.onAdd(e)}}class xN extends un.ScaleControl{onAdd(e){return super.onAdd(e)}}class wN extends un.FullscreenControl{onAdd(e){return super.onAdd(e)}}class Fj extends un.TerrainControl{onAdd(e){return super.onAdd(e)}}class Vj extends un.BoxZoomHandler{constructor(e,t){super(e,t)}}class jj extends un.ScrollZoomHandler{constructor(e,t){super(e,t)}}class Uj extends un.CooperativeGesturesHandler{constructor(e,t){super(e,t)}}class qj extends un.KeyboardHandler{constructor(e){super(e)}}class $j extends un.TwoFingersTouchPitchHandler{constructor(e){super(e)}}class Gj extends un.MapWheelEvent{constructor(e,t,a){super(e,t,a)}}class Hj extends un.MapTouchEvent{constructor(e,t,a){super(e,t,a)}}class Zj extends un.MapMouseEvent{constructor(e,t,a,d={}){super(e,t,a,d)}}class OS extends bN{constructor(e={}){super(e),$n(this,"logoURL",""),$n(this,"linkURL",""),this.logoURL=e.logoURL??Po.maptilerLogoURL,this.linkURL=e.linkURL??Po.maptilerURL}onAdd(e){this._map=e,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const t=window.document.createElement("a");return t.style.backgroundRepeat="no-repeat",t.style.cursor="pointer",t.style.display="block",t.style.height="23px",t.style.margin="0 0 -4px -4px",t.style.overflow="hidden",t.style.width="88px",t.style.backgroundImage=`url(${this.logoURL})`,t.style.backgroundSize="100px 30px",t.style.width="100px",t.style.height="30px",t.target="_blank",t.rel="noopener",t.href=this.linkURL,t.setAttribute("aria-label","MapTiler logo"),t.setAttribute("rel","noopener"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var TN=8,SN={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},EN={"*":{type:"source"}},AN=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],CN={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},IN={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},MN={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},PN={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},RN={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},kN={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},DN={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},LN=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],zN={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ON={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},NN={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},BN={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},FN={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},VN={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},jN={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},UN={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},qN={type:"array",value:"*"},$N={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},GN={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},HN={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},ZN={type:"array",value:"*",minimum:1},WN={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},KN={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},XN={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},YN={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},QN=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],JN={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},e6={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},t6={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},n6={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},r6={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},i6={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},a6={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},s6={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},o6={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},l6={"*":{type:"string"}},u6={$version:TN,$root:SN,sources:EN,source:AN,source_vector:CN,source_raster:IN,source_raster_dem:MN,source_geojson:PN,source_video:RN,source_image:kN,layer:DN,layout:LN,layout_background:zN,layout_fill:ON,layout_circle:NN,layout_heatmap:BN,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:FN,layout_symbol:VN,layout_raster:jN,layout_hillshade:UN,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:qN,filter_operator:$N,geometry_type:GN,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:HN,expression:ZN,light:WN,sky:KN,terrain:XN,projection:YN,paint:QN,paint_fill:JN,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:e6,paint_circle:t6,paint_heatmap:n6,paint_symbol:r6,paint_raster:i6,paint_hillshade:a6,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:s6,transition:o6,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:l6};class Nt{constructor(e,t,a,d){this.message=(e?`${e}: `:"")+a,d&&(this.identifier=d),t!=null&&t.__line__&&(this.line=t.__line__)}}function C0(r,...e){for(const t of e)for(const a in t)r[a]=t[a];return r}class th extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class Hw{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[a,d]of t)this.bindings[a]=d}concat(e){return new Hw(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}}const ub={kind:"null"},qt={kind:"number"},Yn={kind:"string"},Wn={kind:"boolean"},lh={kind:"color"},cb={kind:"projectionDefinition"},Rp={kind:"object"},qn={kind:"value"},c6={kind:"error"},hb={kind:"collator"},db={kind:"formatted"},fb={kind:"padding"},g_={kind:"colorArray"},pb={kind:"numberArray"},q_={kind:"resolvedImage"},mb={kind:"variableAnchorOffsetCollection"};function Ml(r,e){return{kind:"array",itemType:r,N:e}}function qi(r){if(r.kind==="array"){const e=qi(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}else return r.kind}const h6=[ub,qt,Yn,Wn,lh,cb,db,Rp,Ml(qn),fb,pb,g_,q_,mb];function y_(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!y_(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const t of h6)if(!y_(t,e))return null}}return`Expected ${qi(r)} but found ${qi(e)} instead.`}function Zw(r,e){return e.some(t=>t.kind===r.kind)}function kp(r,e){return e.some(t=>t==="null"?r===null:t==="array"?Array.isArray(r):t==="object"?r&&!Array.isArray(r)&&typeof r=="object":t===typeof r)}function ef(r,e){return r.kind==="array"&&e.kind==="array"?r.itemType.kind===e.itemType.kind&&typeof r.N=="number":r.kind===e.kind}const JI=.96422,eM=1,tM=.82521,nM=4/29,ng=6/29,rM=3*ng*ng,d6=ng*ng*ng,f6=Math.PI/180,p6=180/Math.PI;function iM(r){return r=r%360,r<0&&(r+=360),r}function aM([r,e,t,a]){r=lx(r),e=lx(e),t=lx(t);let d,m;const y=ux((.2225045*r+.7168786*e+.0606169*t)/eM);r===e&&e===t?d=m=y:(d=ux((.4360747*r+.3850649*e+.1430804*t)/JI),m=ux((.0139322*r+.0971045*e+.7141733*t)/tM));const c=116*y-16;return[c<0?0:c,500*(d-y),200*(y-m),a]}function lx(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function ux(r){return r>d6?Math.pow(r,1/3):r/rM+nM}function sM([r,e,t,a]){let d=(r+16)/116,m=isNaN(e)?d:d+e/500,y=isNaN(t)?d:d-t/200;return d=eM*hx(d),m=JI*hx(m),y=tM*hx(y),[cx(3.1338561*m-1.6168667*d-.4906146*y),cx(-.9787684*m+1.9161415*d+.033454*y),cx(.0719453*m-.2289914*d+1.4052427*y),a]}function cx(r){return r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055,r<0?0:r>1?1:r}function hx(r){return r>ng?r*r*r:rM*(r-nM)}function m6(r){const[e,t,a,d]=aM(r),m=Math.sqrt(t*t+a*a);return[Math.round(m*1e4)?iM(Math.atan2(a,t)*p6):NaN,m,e,d]}function g6([r,e,t,a]){return r=isNaN(r)?0:r*f6,sM([t,Math.cos(r)*e,Math.sin(r)*e,a])}function y6([r,e,t,a]){r=iM(r),e/=100,t/=100;function d(m){const y=(m+r/30)%12,c=e*Math.min(t,1-t);return t-c*Math.max(-1,Math.min(y-3,9-y,1))}return[d(0),d(8),d(4),a]}const _6=Object.hasOwn||function(r,e){return Object.prototype.hasOwnProperty.call(r,e)};function t_(r,e){return _6(r,e)?r[e]:void 0}function v6(r){if(r=r.toLowerCase().trim(),r==="transparent")return[0,0,0,0];const e=t_(b6,r);if(e){const[d,m,y]=e;return[d/255,m/255,y/255,1]}if(r.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(r)){const d=r.length<6?1:2;let m=1;return[Nv(r.slice(m,m+=d)),Nv(r.slice(m,m+=d)),Nv(r.slice(m,m+=d)),Nv(r.slice(m,m+d)||"ff")]}if(r.startsWith("rgb")){const d=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,m=r.match(d);if(m){const[y,c,M,R,B,K,$,W,re,Me,Ce,Be]=m,He=[R||" ",$||" ",Me].join("");if(He==="  "||He==="  /"||He===",,"||He===",,,"){const ut=[M,K,re].join(""),Ue=ut==="%%%"?100:ut===""?255:0;if(Ue){const Fe=[qm(+c/Ue,0,1),qm(+B/Ue,0,1),qm(+W/Ue,0,1),Ce?NS(+Ce,Be):1];if(BS(Fe))return Fe}}return}}const t=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,a=r.match(t);if(a){const[d,m,y,c,M,R,B,K,$]=a,W=[y||" ",M||" ",B].join("");if(W==="  "||W==="  /"||W===",,"||W===",,,"){const re=[+m,qm(+c,0,100),qm(+R,0,100),K?NS(+K,$):1];if(BS(re))return y6(re)}}}function Nv(r){return parseInt(r.padEnd(2,r),16)/255}function NS(r,e){return qm(e?r/100:r,0,1)}function qm(r,e,t){return Math.min(Math.max(e,r),t)}function BS(r){return!r.some(Number.isNaN)}const b6={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Dp(r,e,t){return r+t*(e-r)}function __(r,e,t){return r.map((a,d)=>Dp(a,e[d],t))}let $i=class $m{constructor(e,t,a,d=1,m=!0){this.r=e,this.g=t,this.b=a,this.a=d,m||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[e,t,a,d]))}static parse(e){if(e instanceof $m)return e;if(typeof e!="string")return;const t=v6(e);if(t)return new $m(...t,!1)}get rgb(){const{r:e,g:t,b:a,a:d}=this,m=d||1/0;return this.overwriteGetter("rgb",[e/m,t/m,a/m,d])}get hcl(){return this.overwriteGetter("hcl",m6(this.rgb))}get lab(){return this.overwriteGetter("lab",aM(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,a,d]=this.rgb;return`rgba(${[e,t,a].map(m=>Math.round(m*255)).join(",")},${d})`}static interpolate(e,t,a,d="rgb"){switch(d){case"rgb":{const[m,y,c,M]=__(e.rgb,t.rgb,a);return new $m(m,y,c,M,!1)}case"hcl":{const[m,y,c,M]=e.hcl,[R,B,K,$]=t.hcl;let W,re;if(!isNaN(m)&&!isNaN(R)){let ut=R-m;R>m&&ut>180?ut-=360:R<m&&m-R>180&&(ut+=360),W=m+a*ut}else isNaN(m)?isNaN(R)?W=NaN:(W=R,(c===1||c===0)&&(re=B)):(W=m,(K===1||K===0)&&(re=y));const[Me,Ce,Be,He]=g6([W,re??Dp(y,B,a),Dp(c,K,a),Dp(M,$,a)]);return new $m(Me,Ce,Be,He,!1)}case"lab":{const[m,y,c,M]=sM(__(e.lab,t.lab,a));return new $m(m,y,c,M,!1)}}}};$i.black=new $i(0,0,0,1);$i.white=new $i(1,1,1,1);$i.transparent=new $i(0,0,0,0);$i.red=new $i(1,0,0,1);class Ww{constructor(e,t,a){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const x6=["bottom","center","top"];class l1{constructor(e,t,a,d,m,y){this.text=e,this.image=t,this.scale=a,this.fontStack=d,this.textColor=m,this.verticalAlign=y}}class Qh{constructor(e){this.sections=e}static fromString(e){return new Qh([new l1(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Qh?e:Qh.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class hc{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof hc)return e;if(typeof e=="number")return new hc([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if(typeof t!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new hc(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a){return new hc(__(e.values,t.values,a))}}class dc{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof dc)return e;if(typeof e=="number")return new dc([e]);if(Array.isArray(e)){for(const t of e)if(typeof t!="number")return;return new dc(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a){return new dc(__(e.values,t.values,a))}}class Rl{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Rl)return e;if(typeof e=="string"){const a=$i.parse(e);return a?new Rl([a]):void 0}if(!Array.isArray(e))return;const t=[];for(const a of e){if(typeof a!="string")return;const d=$i.parse(a);if(!d)return;t.push(d)}return new Rl(t)}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a,d="rgb"){const m=[];if(e.values.length!=t.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${t.values.length}), cannot interpolate.`);for(let y=0;y<e.values.length;y++)m.push($i.interpolate(e.values[y],t.values[y],a,d));return new Rl(m)}}class Ji extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const w6=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class uh{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof uh)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let t=0;t<e.length;t+=2){const a=e[t],d=e[t+1];if(typeof a!="string"||!w6.has(a)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new uh(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a){const d=e.values,m=t.values;if(d.length!==m.length)throw new Ji(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const y=[];for(let c=0;c<d.length;c+=2){if(d[c]!==m[c])throw new Ji(`Cannot interpolate values containing mismatched anchors. from[${c}]: ${d[c]}, to[${c}]: ${m[c]}`);y.push(d[c]);const[M,R]=d[c+1],[B,K]=m[c+1];y.push([Dp(M,B,a),Dp(R,K,a)])}return new uh(y)}}class Cf{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Cf({name:e,available:!1}):null}}class lc{constructor(e,t,a){this.from=e,this.to=t,this.transition=a}static interpolate(e,t,a){return new lc(e,t,a)}static parse(e){if(e instanceof lc)return e;if(Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number")return new lc(e[0],e[1],e[2]);if(typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number")return new lc(e.from,e.to,e.transition);if(typeof e=="string")return new lc(e,e,1)}}function oM(r,e,t,a){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255?typeof a>"u"||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[r,e,t,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[r,e,t,a]:[r,e,t]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function v_(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof lc||r instanceof $i||r instanceof Ww||r instanceof Qh||r instanceof hc||r instanceof dc||r instanceof Rl||r instanceof uh||r instanceof Cf)return!0;if(Array.isArray(r)){for(const e of r)if(!v_(e))return!1;return!0}else if(typeof r=="object"){for(const e in r)if(!v_(r[e]))return!1;return!0}else return!1}function za(r){if(r===null)return ub;if(typeof r=="string")return Yn;if(typeof r=="boolean")return Wn;if(typeof r=="number")return qt;if(r instanceof $i)return lh;if(r instanceof lc)return cb;if(r instanceof Ww)return hb;if(r instanceof Qh)return db;if(r instanceof hc)return fb;if(r instanceof dc)return pb;if(r instanceof Rl)return g_;if(r instanceof uh)return mb;if(r instanceof Cf)return q_;if(Array.isArray(r)){const e=r.length;let t;for(const a of r){const d=za(a);if(!t)t=d;else{if(t===d)continue;t=qn;break}}return Ml(t||qn,e)}else return Rp}function n_(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof $i||r instanceof lc||r instanceof Qh||r instanceof hc||r instanceof dc||r instanceof Rl||r instanceof uh||r instanceof Cf?r.toString():JSON.stringify(r)}class dg{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(e.length!==2)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!v_(e[1]))return t.error("invalid value");const a=e[1];let d=za(a);const m=t.expectedType;return d.kind==="array"&&d.N===0&&m&&m.kind==="array"&&(typeof m.N!="number"||m.N===0)&&(d=m),new dg(d,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Bv={string:Yn,number:qt,boolean:Wn,object:Rp};class uc{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let a=1,d;const m=e[0];if(m==="array"){let c;if(e.length>2){const R=e[1];if(typeof R!="string"||!(R in Bv)||R==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);c=Bv[R],a++}else c=qn;let M;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);M=e[2],a++}d=Ml(c,M)}else{if(!Bv[m])throw new Error(`Types doesn't contain name = ${m}`);d=Bv[m]}const y=[];for(;a<e.length;a++){const c=t.parse(e[a],a,qn);if(!c)return null;y.push(c)}return new uc(d,y)}evaluate(e){for(let t=0;t<this.args.length;t++){const a=this.args[t].evaluate(e);if(y_(this.type,za(a))){if(t===this.args.length-1)throw new Ji(`Expected value to be of type ${qi(this.type)}, but found ${qi(za(a))} instead.`)}else return a}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const FS={"to-boolean":Wn,"to-color":lh,"to-number":qt,"to-string":Yn};class lf{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const a=e[0];if(!FS[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&e.length!==2)return t.error("Expected one argument.");const d=FS[a],m=[];for(let y=1;y<e.length;y++){const c=t.parse(e[y],y,qn);if(!c)return null;m.push(c)}return new lf(d,m)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,a;for(const d of this.args){if(t=d.evaluate(e),a=null,t instanceof $i)return t;if(typeof t=="string"){const m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&(t.length<3||t.length>4?a=`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:a=oM(t[0],t[1],t[2],t[3]),!a))return new $i(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ji(a||`Could not parse color from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const a of this.args){t=a.evaluate(e);const d=hc.parse(t);if(d)return d}throw new Ji(`Could not parse padding from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"numberArray":{let t;for(const a of this.args){t=a.evaluate(e);const d=dc.parse(t);if(d)return d}throw new Ji(`Could not parse numberArray from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"colorArray":{let t;for(const a of this.args){t=a.evaluate(e);const d=Rl.parse(t);if(d)return d}throw new Ji(`Could not parse colorArray from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const a of this.args){t=a.evaluate(e);const d=uh.parse(t);if(d)return d}throw new Ji(`Could not parse variableAnchorOffsetCollection from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const a of this.args){if(t=a.evaluate(e),t===null)return 0;const d=Number(t);if(!isNaN(d))return d}throw new Ji(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Qh.fromString(n_(this.args[0].evaluate(e)));case"resolvedImage":return Cf.fromString(n_(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return n_(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const T6=["Unknown","Point","LineString","Polygon"];class lM{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?T6[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache.get(e);return t||(t=$i.parse(e),this._parseColorCache.set(e,t)),t}}class gb{constructor(e,t,a=[],d,m=new Hw,y=[]){this.registry=e,this.path=a,this.key=a.map(c=>`[${c}]`).join(""),this.scope=m,this.errors=y,this.expectedType=d,this._isConstant=t}parse(e,t,a,d,m={}){return t?this.concat(t,a,d)._parse(e,m):this._parse(e,m)}_parse(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function a(d,m,y){return y==="assert"?new uc(m,[d]):y==="coerce"?new lf(m,[d]):d}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const c=this.expectedType,M=y.type;if((c.kind==="string"||c.kind==="number"||c.kind==="boolean"||c.kind==="object"||c.kind==="array")&&M.kind==="value")y=a(y,c,t.typeAnnotation||"assert");else if(c.kind==="projectionDefinition"&&["string","array"].includes(M.kind)||["color","formatted","resolvedImage"].includes(c.kind)&&["value","string"].includes(M.kind)||["padding","numberArray"].includes(c.kind)&&["value","number","array"].includes(M.kind)||c.kind==="colorArray"&&["value","string","array"].includes(M.kind)||c.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(M.kind))y=a(y,c,t.typeAnnotation||"coerce");else if(this.checkSubtype(c,M))return null}if(!(y instanceof dg)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const c=new lM;try{y=new dg(y.type,y.evaluate(c))}catch(M){return this.error(M.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,a){const d=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new gb(this.registry,this._isConstant,d,t||null,m,this.errors)}error(e,...t){const a=`${this.key}${t.map(d=>`[${d}]`).join("")}`;this.errors.push(new th(a,e))}checkSubtype(e,t){const a=y_(e,t);return a&&this.error(a),a}}class yb{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return t.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return t.error("Variable names must contain only alphanumeric characters or '_'.",m);const c=t.parse(e[m+1],m+1);if(!c)return null;a.push([y,c])}const d=t.parse(e[e.length-1],e.length-1,t.expectedType,a);return d?new yb(a,d):null}outputDefined(){return this.result.outputDefined()}}class _b{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");const a=e[1];return t.scope.has(a)?new _b(a,t.scope.get(a)):t.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Kw{constructor(e,t,a){this.type=e,this.index=t,this.input=a}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,qt),d=t.parse(e[2],2,Ml(t.expectedType||qn));if(!a||!d)return null;const m=d.type;return new Kw(m.itemType,a,d)}evaluate(e){const t=this.index.evaluate(e),a=this.input.evaluate(e);if(t<0)throw new Ji(`Array index out of bounds: ${t} < 0.`);if(t>=a.length)throw new Ji(`Array index out of bounds: ${t} > ${a.length-1}.`);if(t!==Math.floor(t))throw new Ji(`Array index must be an integer, but found ${t} instead.`);return a[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Xw{constructor(e,t){this.type=Wn,this.needle=e,this.haystack=t}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,qn),d=t.parse(e[2],2,qn);return!a||!d?null:Zw(a.type,[Wn,Yn,qt,ub,qn])?new Xw(a,d):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${qi(a.type)} instead`)}evaluate(e){const t=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!kp(t,["boolean","string","number","null"]))throw new Ji(`Expected first argument to be of type boolean, string, number or null, but found ${qi(za(t))} instead.`);if(!kp(a,["string","array"]))throw new Ji(`Expected second argument to be of type array or string, but found ${qi(za(a))} instead.`);return a.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class I0{constructor(e,t,a){this.type=qt,this.needle=e,this.haystack=t,this.fromIndex=a}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,qn),d=t.parse(e[2],2,qn);if(!a||!d)return null;if(!Zw(a.type,[Wn,Yn,qt,ub,qn]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${qi(a.type)} instead`);if(e.length===4){const m=t.parse(e[3],3,qt);return m?new I0(a,d,m):null}else return new I0(a,d)}evaluate(e){const t=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!kp(t,["boolean","string","number","null"]))throw new Ji(`Expected first argument to be of type boolean, string, number or null, but found ${qi(za(t))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(e)),kp(a,["string"])){const m=a.indexOf(t,d);return m===-1?-1:[...a.slice(0,m)].length}else{if(kp(a,["array"]))return a.indexOf(t,d);throw new Ji(`Expected second argument to be of type array or string, but found ${qi(za(a))} instead.`)}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Yw{constructor(e,t,a,d,m,y){this.inputType=e,this.type=t,this.input=a,this.cases=d,this.outputs=m,this.otherwise=y}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!==1)return t.error("Expected an even number of arguments.");let a,d;t.expectedType&&t.expectedType.kind!=="value"&&(d=t.expectedType);const m={},y=[];for(let R=2;R<e.length-1;R+=2){let B=e[R];const K=e[R+1];Array.isArray(B)||(B=[B]);const $=t.concat(R);if(B.length===0)return $.error("Expected at least one branch label.");for(const re of B){if(typeof re!="number"&&typeof re!="string")return $.error("Branch labels must be numbers or strings.");if(typeof re=="number"&&Math.abs(re)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof re=="number"&&Math.floor(re)!==re)return $.error("Numeric branch labels must be integer values.");if(!a)a=za(re);else if($.checkSubtype(a,za(re)))return null;if(typeof m[String(re)]<"u")return $.error("Branch labels must be unique.");m[String(re)]=y.length}const W=t.parse(K,R,d);if(!W)return null;d=d||W.type,y.push(W)}const c=t.parse(e[1],1,qn);if(!c)return null;const M=t.parse(e[e.length-1],e.length-1,d);return!M||c.type.kind!=="value"&&t.concat(1).checkSubtype(a,c.type)?null:new Yw(a,d,c,m,y,M)}evaluate(e){const t=this.input.evaluate(e);return(za(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Qw{constructor(e,t,a){this.type=e,this.branches=t,this.otherwise=a}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!==0)return t.error("Expected an odd number of arguments.");let a;t.expectedType&&t.expectedType.kind!=="value"&&(a=t.expectedType);const d=[];for(let y=1;y<e.length-1;y+=2){const c=t.parse(e[y],y,Wn);if(!c)return null;const M=t.parse(e[y+1],y+1,a);if(!M)return null;d.push([c,M]),a=a||M.type}const m=t.parse(e[e.length-1],e.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new Qw(a,d,m)}evaluate(e){for(const[t,a]of this.branches)if(t.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,a]of this.branches)e(t),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}}class M0{constructor(e,t,a,d){this.type=e,this.input=t,this.beginIndex=a,this.endIndex=d}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,qn),d=t.parse(e[2],2,qt);if(!a||!d)return null;if(!Zw(a.type,[Ml(qn),Yn,qn]))return t.error(`Expected first argument to be of type array or string, but found ${qi(a.type)} instead`);if(e.length===4){const m=t.parse(e[3],3,qt);return m?new M0(a.type,a,d,m):null}else return new M0(a.type,a,d)}evaluate(e){const t=this.input.evaluate(e),a=this.beginIndex.evaluate(e);let d;if(this.endIndex&&(d=this.endIndex.evaluate(e)),kp(t,["string"]))return[...t].slice(a,d).join("");if(kp(t,["array"]))return t.slice(a,d);throw new Ji(`Expected first argument to be of type array or string, but found ${qi(za(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function uM(r,e){const t=r.length-1;let a=0,d=t,m=0,y,c;for(;a<=d;)if(m=Math.floor((a+d)/2),y=r[m],c=r[m+1],y<=e){if(m===t||e<c)return m;a=m+1}else if(y>e)d=m-1;else throw new Ji("Input is not a number.");return 0}class vb{constructor(e,t,a){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[d,m]of a)this.labels.push(d),this.outputs.push(m)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");const a=t.parse(e[1],1,qt);if(!a)return null;const d=[];let m=null;t.expectedType&&t.expectedType.kind!=="value"&&(m=t.expectedType);for(let y=1;y<e.length;y+=2){const c=y===1?-1/0:e[y],M=e[y+1],R=y,B=y+1;if(typeof c!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(d.length&&d[d.length-1][0]>=c)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const K=t.parse(M,B,m);if(!K)return null;m=m||K.type,d.push([c,K])}return new vb(m,a,d)}evaluate(e){const t=this.labels,a=this.outputs;if(t.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=t[0])return a[0].evaluate(e);const m=t.length;if(d>=t[m-1])return a[m-1].evaluate(e);const y=uM(t,d);return a[y].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function S6(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var dx,VS;function E6(){if(VS)return dx;VS=1,dx=r;function r(e,t,a,d){this.cx=3*e,this.bx=3*(a-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(d-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=a,this.p2y=d}return r.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var a=e,d=0;d<8;d++){var m=this.sampleCurveX(a)-e;if(Math.abs(m)<t)return a;var y=this.sampleCurveDerivativeX(a);if(Math.abs(y)<1e-6)break;a=a-m/y}var c=0,M=1;for(a=e,d=0;d<20&&(m=this.sampleCurveX(a),!(Math.abs(m-e)<t));d++)e>m?c=a:M=a,a=(M-c)*.5+c;return a},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},dx}var A6=E6(),C6=S6(A6);class ch{constructor(e,t,a,d,m){this.type=e,this.operator=t,this.interpolation=a,this.input=d,this.labels=[],this.outputs=[];for(const[y,c]of m)this.labels.push(y),this.outputs.push(c)}static interpolationFactor(e,t,a,d){let m=0;if(e.name==="exponential")m=fx(t,e.base,a,d);else if(e.name==="linear")m=fx(t,1,a,d);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new C6(y[0],y[1],y[2],y[3]).solve(fx(t,1,a,d))}return m}static parse(e,t){let[a,d,m,...y]=e;if(!Array.isArray(d)||d.length===0)return t.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const R=d[1];if(typeof R!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:R}}else if(d[0]==="cubic-bezier"){const R=d.slice(1);if(R.length!==4||R.some(B=>typeof B!="number"||B<0||B>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:R}}else return t.error(`Unknown interpolation type ${String(d[0])}`,1,0);if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(m=t.parse(m,2,qt),!m)return null;const c=[];let M=null;(a==="interpolate-hcl"||a==="interpolate-lab")&&t.expectedType!=g_?M=lh:t.expectedType&&t.expectedType.kind!=="value"&&(M=t.expectedType);for(let R=0;R<y.length;R+=2){const B=y[R],K=y[R+1],$=R+3,W=R+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(c.length&&c[c.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const re=t.parse(K,W,M);if(!re)return null;M=M||re.type,c.push([B,re])}return!ef(M,qt)&&!ef(M,cb)&&!ef(M,lh)&&!ef(M,fb)&&!ef(M,pb)&&!ef(M,g_)&&!ef(M,mb)&&!ef(M,Ml(qt))?t.error(`Type ${qi(M)} is not interpolatable.`):new ch(M,a,d,m,c)}evaluate(e){const t=this.labels,a=this.outputs;if(t.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=t[0])return a[0].evaluate(e);const m=t.length;if(d>=t[m-1])return a[m-1].evaluate(e);const y=uM(t,d),c=t[y],M=t[y+1],R=ch.interpolationFactor(this.interpolation,d,c,M),B=a[y].evaluate(e),K=a[y+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Dp(B,K,R);case"color":return $i.interpolate(B,K,R);case"padding":return hc.interpolate(B,K,R);case"colorArray":return Rl.interpolate(B,K,R);case"numberArray":return dc.interpolate(B,K,R);case"variableAnchorOffsetCollection":return uh.interpolate(B,K,R);case"array":return __(B,K,R);case"projectionDefinition":return lc.interpolate(B,K,R)}case"interpolate-hcl":switch(this.type.kind){case"color":return $i.interpolate(B,K,R,"hcl");case"colorArray":return Rl.interpolate(B,K,R,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return $i.interpolate(B,K,R,"lab");case"colorArray":return Rl.interpolate(B,K,R,"lab")}}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function fx(r,e,t,a){const d=a-t,m=r-t;return d===0?0:e===1?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}class b_{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let a=null;const d=t.expectedType;d&&d.kind!=="value"&&(a=d);const m=[];for(const y of e.slice(1)){const c=t.parse(y,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!c)return null;a=a||c.type,m.push(c)}if(!a)throw new Error("No output type");return d&&m.some(y=>y_(d,y.type))?new b_(qn,m):new b_(a,m)}evaluate(e){let t=null,a=0,d;for(const m of this.args)if(a++,t=m.evaluate(e),t&&t instanceof Cf&&!t.available&&(d||(d=t.name),t=null,a===this.args.length&&(t=d)),t!==null)break;return t}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function jS(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function I6(r,e,t){return e===t}function M6(r,e,t){return e!==t}function P6(r,e,t){return e<t}function R6(r,e,t){return e>t}function k6(r,e,t){return e<=t}function D6(r,e,t){return e>=t}function cM(r,e,t,a){return a.compare(e,t)===0}function L6(r,e,t,a){return!cM(r,e,t,a)}function z6(r,e,t,a){return a.compare(e,t)<0}function O6(r,e,t,a){return a.compare(e,t)>0}function N6(r,e,t,a){return a.compare(e,t)<=0}function B6(r,e,t,a){return a.compare(e,t)>=0}function Eg(r,e,t){const a=r!=="=="&&r!=="!=";return class hM{constructor(m,y,c){this.type=Wn,this.lhs=m,this.rhs=y,this.collator=c,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const c=m[0];let M=y.parse(m[1],1,qn);if(!M)return null;if(!jS(c,M.type))return y.concat(1).error(`"${c}" comparisons are not supported for type '${qi(M.type)}'.`);let R=y.parse(m[2],2,qn);if(!R)return null;if(!jS(c,R.type))return y.concat(2).error(`"${c}" comparisons are not supported for type '${qi(R.type)}'.`);if(M.type.kind!==R.type.kind&&M.type.kind!=="value"&&R.type.kind!=="value")return y.error(`Cannot compare types '${qi(M.type)}' and '${qi(R.type)}'.`);a&&(M.type.kind==="value"&&R.type.kind!=="value"?M=new uc(R.type,[M]):M.type.kind!=="value"&&R.type.kind==="value"&&(R=new uc(M.type,[R])));let B=null;if(m.length===4){if(M.type.kind!=="string"&&R.type.kind!=="string"&&M.type.kind!=="value"&&R.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(B=y.parse(m[3],3,hb),!B)return null}return new hM(M,R,B)}evaluate(m){const y=this.lhs.evaluate(m),c=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const M=za(y),R=za(c);if(M.kind!==R.kind||!(M.kind==="string"||M.kind==="number"))throw new Ji(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${M.kind}, ${R.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const M=za(y),R=za(c);if(M.kind!=="string"||R.kind!=="string")return e(m,y,c)}return this.collator?t(m,y,c,this.collator.evaluate(m)):e(m,y,c)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const F6=Eg("==",I6,cM),V6=Eg("!=",M6,L6),j6=Eg("<",P6,z6),U6=Eg(">",R6,O6),q6=Eg("<=",k6,N6),$6=Eg(">=",D6,B6);class bb{constructor(e,t,a){this.type=hb,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(e.length!==2)return t.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return t.error("Collator options argument must be an object.");const d=t.parse(a["case-sensitive"]===void 0?!1:a["case-sensitive"],1,Wn);if(!d)return null;const m=t.parse(a["diacritic-sensitive"]===void 0?!1:a["diacritic-sensitive"],1,Wn);if(!m)return null;let y=null;return a.locale&&(y=t.parse(a.locale,1,Yn),!y)?null:new bb(d,m,y)}evaluate(e){return new Ww(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Jw{constructor(e,t,a,d,m){this.type=Yn,this.number=e,this.locale=t,this.currency=a,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,t){if(e.length!==3)return t.error("Expected two arguments.");const a=t.parse(e[1],1,qt);if(!a)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return t.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=t.parse(d.locale,1,Yn),!m))return null;let y=null;if(d.currency&&(y=t.parse(d.currency,1,Yn),!y))return null;let c=null;if(d["min-fraction-digits"]&&(c=t.parse(d["min-fraction-digits"],1,qt),!c))return null;let M=null;return d["max-fraction-digits"]&&(M=t.parse(d["max-fraction-digits"],1,qt),!M)?null:new Jw(a,m,y,c,M)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class e2{constructor(e){this.type=db,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return t.error("First argument must be an image or text section.");const d=[];let m=!1;for(let y=1;y<=e.length-1;++y){const c=e[y];if(m&&typeof c=="object"&&!Array.isArray(c)){m=!1;let M=null;if(c["font-scale"]&&(M=t.parse(c["font-scale"],1,qt),!M))return null;let R=null;if(c["text-font"]&&(R=t.parse(c["text-font"],1,Ml(Yn)),!R))return null;let B=null;if(c["text-color"]&&(B=t.parse(c["text-color"],1,lh),!B))return null;let K=null;if(c["vertical-align"]){if(typeof c["vertical-align"]=="string"&&!x6.includes(c["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${c["vertical-align"]}' instead.`);if(K=t.parse(c["vertical-align"],1,Yn),!K)return null}const $=d[d.length-1];$.scale=M,$.font=R,$.textColor=B,$.verticalAlign=K}else{const M=t.parse(e[y],1,qn);if(!M)return null;const R=M.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:M,scale:null,font:null,textColor:null,verticalAlign:null})}}return new e2(d)}evaluate(e){const t=a=>{const d=a.content.evaluate(e);return za(d)===q_?new l1("",d,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(e):null):new l1(n_(d),null,a.scale?a.scale.evaluate(e):null,a.font?a.font.evaluate(e).join(","):null,a.textColor?a.textColor.evaluate(e):null,a.verticalAlign?a.verticalAlign.evaluate(e):null)};return new Qh(this.sections.map(t))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class t2{constructor(e){this.type=q_,this.input=e}static parse(e,t){if(e.length!==2)return t.error("Expected two arguments.");const a=t.parse(e[1],1,Yn);return a?new t2(a):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),a=Cf.fromString(t);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(t)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}}class n2{constructor(e){this.type=qt,this.input=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=t.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?t.error(`Expected argument of type string or array, but found ${qi(a.type)} instead.`):new n2(a):null}evaluate(e){const t=this.input.evaluate(e);if(typeof t=="string")return[...t].length;if(Array.isArray(t))return t.length;throw new Ji(`Expected value to be of type string or array, but found ${qi(za(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const hh=8192;function G6(r,e){const t=H6(r[0]),a=W6(r[1]),d=Math.pow(2,e.z);return[Math.round(t*d*hh),Math.round(a*d*hh)]}function r2(r,e){const t=Math.pow(2,e.z),a=(r[0]/hh+e.x)/t,d=(r[1]/hh+e.y)/t;return[Z6(a),K6(d)]}function H6(r){return(180+r)/360}function Z6(r){return r*360-180}function W6(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function K6(r){return 360/Math.PI*Math.atan(Math.exp((180-r*360)*Math.PI/180))-90}function $_(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function x_(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function X6(r,e,t){return e[1]>r[1]!=t[1]>r[1]&&r[0]<(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1])+e[0]}function Y6(r,e,t){const a=r[0]-e[0],d=r[1]-e[1],m=r[0]-t[0],y=r[1]-t[1];return a*y-m*d===0&&a*m<=0&&d*y<=0}function xb(r,e,t,a){const d=[e[0]-r[0],e[1]-r[1]],m=[a[0]-t[0],a[1]-t[1]];return tB(m,d)===0?!1:!!(US(r,e,t,a)&&US(t,a,r,e))}function Q6(r,e,t){for(const a of t)for(let d=0;d<a.length-1;++d)if(xb(r,e,a[d],a[d+1]))return!0;return!1}function Ag(r,e,t=!1){let a=!1;for(const d of e)for(let m=0;m<d.length-1;m++){if(Y6(r,d[m],d[m+1]))return t;X6(r,d[m],d[m+1])&&(a=!a)}return a}function J6(r,e){for(const t of e)if(Ag(r,t))return!0;return!1}function dM(r,e){for(const t of r)if(!Ag(t,e))return!1;for(let t=0;t<r.length-1;++t)if(Q6(r[t],r[t+1],e))return!1;return!0}function eB(r,e){for(const t of e)if(dM(r,t))return!0;return!1}function tB(r,e){return r[0]*e[1]-r[1]*e[0]}function US(r,e,t,a){const d=r[0]-t[0],m=r[1]-t[1],y=e[0]-t[0],c=e[1]-t[1],M=a[0]-t[0],R=a[1]-t[1],B=d*R-M*m,K=y*R-M*c;return B>0&&K<0||B<0&&K>0}function i2(r,e,t){const a=[];for(let d=0;d<r.length;d++){const m=[];for(let y=0;y<r[d].length;y++){const c=G6(r[d][y],t);$_(e,c),m.push(c)}a.push(m)}return a}function fM(r,e,t){const a=[];for(let d=0;d<r.length;d++){const m=i2(r[d],e,t);a.push(m)}return a}function pM(r,e,t,a){if(r[0]<t[0]||r[0]>t[2]){const d=a*.5;let m=r[0]-t[0]>d?-a:t[0]-r[0]>d?a:0;m===0&&(m=r[0]-t[2]>d?-a:t[2]-r[0]>d?a:0),r[0]+=m}$_(e,r)}function nB(r){r[0]=r[1]=1/0,r[2]=r[3]=-1/0}function qS(r,e,t,a){const d=Math.pow(2,a.z)*hh,m=[a.x*hh,a.y*hh],y=[];for(const c of r)for(const M of c){const R=[M.x+m[0],M.y+m[1]];pM(R,e,t,d),y.push(R)}return y}function $S(r,e,t,a){const d=Math.pow(2,a.z)*hh,m=[a.x*hh,a.y*hh],y=[];for(const c of r){const M=[];for(const R of c){const B=[R.x+m[0],R.y+m[1]];$_(e,B),M.push(B)}y.push(M)}if(e[2]-e[0]<=d/2){nB(e);for(const c of y)for(const M of c)pM(M,e,t,d)}return y}function rB(r,e){const t=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],d=r.canonicalID();if(e.type==="Polygon"){const m=i2(e.coordinates,a,d),y=qS(r.geometry(),t,a,d);if(!x_(t,a))return!1;for(const c of y)if(!Ag(c,m))return!1}if(e.type==="MultiPolygon"){const m=fM(e.coordinates,a,d),y=qS(r.geometry(),t,a,d);if(!x_(t,a))return!1;for(const c of y)if(!J6(c,m))return!1}return!0}function iB(r,e){const t=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],d=r.canonicalID();if(e.type==="Polygon"){const m=i2(e.coordinates,a,d),y=$S(r.geometry(),t,a,d);if(!x_(t,a))return!1;for(const c of y)if(!dM(c,m))return!1}if(e.type==="MultiPolygon"){const m=fM(e.coordinates,a,d),y=$S(r.geometry(),t,a,d);if(!x_(t,a))return!1;for(const c of y)if(!eB(c,m))return!1}return!0}class Lp{constructor(e,t){this.type=Wn,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(v_(e[1])){const a=e[1];if(a.type==="FeatureCollection"){const d=[];for(const m of a.features){const{type:y,coordinates:c}=m.geometry;y==="Polygon"&&d.push(c),y==="MultiPolygon"&&d.push(...c)}if(d.length){const m={type:"MultiPolygon",coordinates:d};return new Lp(a,m)}}else if(a.type==="Feature"){const d=a.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Lp(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Lp(a,a)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return rB(e,this.geometries);if(e.geometryType()==="LineString")return iB(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class mM{constructor(e=[],t=(a,d)=>a<d?-1:a>d?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:a}=this,d=t[e];for(;e>0;){const m=e-1>>1,y=t[m];if(a(d,y)>=0)break;t[e]=y,e=m}t[e]=d}_down(e){const{data:t,compare:a}=this,d=this.length>>1,m=t[e];for(;e<d;){let y=(e<<1)+1;const c=y+1;if(c<this.length&&a(t[c],t[y])<0&&(y=c),a(t[y],m)>=0)break;t[e]=t[y],e=y}t[e]=m}}function aB(r,e){if(r.length<=1)return[r];const t=[];let a,d;for(const m of r){const y=sB(m);y!==0&&(m.area=Math.abs(y),d===void 0&&(d=y<0),d===y<0?(a&&t.push(a),a=[m]):a.push(m))}return a&&t.push(a),t}function sB(r){let e=0;for(let t=0,a=r.length,d=a-1,m,y;t<a;d=t++)m=r[t],y=r[d],e+=(y.x-m.x)*(m.y+y.y);return e}const oB=6378.137,GS=1/298.257223563,HS=GS*(2-GS),ZS=Math.PI/180;class a2{constructor(e){const t=ZS*oB*1e3,a=Math.cos(e*ZS),d=1/(1-HS*(1-a*a)),m=Math.sqrt(d);this.kx=t*m*a,this.ky=t*m*d*(1-HS)}distance(e,t){const a=this.wrap(e[0]-t[0])*this.kx,d=(e[1]-t[1])*this.ky;return Math.sqrt(a*a+d*d)}pointOnLine(e,t){let a=1/0,d,m,y,c;for(let M=0;M<e.length-1;M++){let R=e[M][0],B=e[M][1],K=this.wrap(e[M+1][0]-R)*this.kx,$=(e[M+1][1]-B)*this.ky,W=0;(K!==0||$!==0)&&(W=(this.wrap(t[0]-R)*this.kx*K+(t[1]-B)*this.ky*$)/(K*K+$*$),W>1?(R=e[M+1][0],B=e[M+1][1]):W>0&&(R+=K/this.kx*W,B+=$/this.ky*W)),K=this.wrap(t[0]-R)*this.kx,$=(t[1]-B)*this.ky;const re=K*K+$*$;re<a&&(a=re,d=R,m=B,y=M,c=W)}return{point:[d,m],index:y,t:Math.max(0,Math.min(1,c))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}const u1=100,c1=50;function gM(r,e){return e[0]-r[0]}function P0(r){return r[1]-r[0]+1}function sd(r,e){return r[1]>=r[0]&&r[1]<e}function h1(r,e){if(r[0]>r[1])return[null,null];const t=P0(r);if(e){if(t===2)return[r,null];const d=Math.floor(t/2);return[[r[0],r[0]+d],[r[0]+d,r[1]]]}if(t===1)return[r,null];const a=Math.floor(t/2)-1;return[[r[0],r[0]+a],[r[0]+a+1,r[1]]]}function d1(r,e){if(!sd(e,r.length))return[1/0,1/0,-1/0,-1/0];const t=[1/0,1/0,-1/0,-1/0];for(let a=e[0];a<=e[1];++a)$_(t,r[a]);return t}function f1(r){const e=[1/0,1/0,-1/0,-1/0];for(const t of r)for(const a of t)$_(e,a);return e}function WS(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function s2(r,e,t){if(!WS(r)||!WS(e))return NaN;let a=0,d=0;return r[2]<e[0]&&(a=e[0]-r[2]),r[0]>e[2]&&(a=r[0]-e[2]),r[1]>e[3]&&(d=r[1]-e[3]),r[3]<e[1]&&(d=e[1]-r[3]),t.distance([0,0],[a,d])}function Mp(r,e,t){const a=t.pointOnLine(e,r);return t.distance(r,a.point)}function o2(r,e,t,a,d){const m=Math.min(Mp(r,[t,a],d),Mp(e,[t,a],d)),y=Math.min(Mp(t,[r,e],d),Mp(a,[r,e],d));return Math.min(m,y)}function lB(r,e,t,a,d){if(!(sd(e,r.length)&&sd(a,t.length)))return 1/0;let m=1/0;for(let y=e[0];y<e[1];++y){const c=r[y],M=r[y+1];for(let R=a[0];R<a[1];++R){const B=t[R],K=t[R+1];if(xb(c,M,B,K))return 0;m=Math.min(m,o2(c,M,B,K,d))}}return m}function uB(r,e,t,a,d){if(!(sd(e,r.length)&&sd(a,t.length)))return NaN;let m=1/0;for(let y=e[0];y<=e[1];++y)for(let c=a[0];c<=a[1];++c)if(m=Math.min(m,d.distance(r[y],t[c])),m===0)return m;return m}function cB(r,e,t){if(Ag(r,e,!0))return 0;let a=1/0;for(const d of e){const m=d[0],y=d[d.length-1];if(m!==y&&(a=Math.min(a,Mp(r,[y,m],t)),a===0))return a;const c=t.pointOnLine(d,r);if(a=Math.min(a,t.distance(r,c.point)),a===0)return a}return a}function hB(r,e,t,a){if(!sd(e,r.length))return NaN;for(let m=e[0];m<=e[1];++m)if(Ag(r[m],t,!0))return 0;let d=1/0;for(let m=e[0];m<e[1];++m){const y=r[m],c=r[m+1];for(const M of t)for(let R=0,B=M.length,K=B-1;R<B;K=R++){const $=M[K],W=M[R];if(xb(y,c,$,W))return 0;d=Math.min(d,o2(y,c,$,W,a))}}return d}function KS(r,e){for(const t of r)for(const a of t)if(Ag(a,e,!0))return!0;return!1}function dB(r,e,t,a=1/0){const d=f1(r),m=f1(e);if(a!==1/0&&s2(d,m,t)>=a)return a;if(x_(d,m)){if(KS(r,e))return 0}else if(KS(e,r))return 0;let y=1/0;for(const c of r)for(let M=0,R=c.length,B=R-1;M<R;B=M++){const K=c[B],$=c[M];for(const W of e)for(let re=0,Me=W.length,Ce=Me-1;re<Me;Ce=re++){const Be=W[Ce],He=W[re];if(xb(K,$,Be,He))return 0;y=Math.min(y,o2(K,$,Be,He,t))}}return y}function XS(r,e,t,a,d,m){if(!m)return;const y=s2(d1(a,m),d,t);y<e&&r.push([y,m,[0,0]])}function Fv(r,e,t,a,d,m,y){if(!m||!y)return;const c=s2(d1(a,m),d1(d,y),t);c<e&&r.push([c,m,y])}function R0(r,e,t,a,d=1/0){let m=Math.min(a.distance(r[0],t[0][0]),d);if(m===0)return m;const y=new mM([[0,[0,r.length-1],[0,0]]],gM),c=f1(t);for(;y.length>0;){const M=y.pop();if(M[0]>=m)continue;const R=M[1],B=e?c1:u1;if(P0(R)<=B){if(!sd(R,r.length))return NaN;if(e){const K=hB(r,R,t,a);if(isNaN(K)||K===0)return K;m=Math.min(m,K)}else for(let K=R[0];K<=R[1];++K){const $=cB(r[K],t,a);if(m=Math.min(m,$),m===0)return 0}}else{const K=h1(R,e);XS(y,m,a,r,c,K[0]),XS(y,m,a,r,c,K[1])}}return m}function k0(r,e,t,a,d,m=1/0){let y=Math.min(m,d.distance(r[0],t[0]));if(y===0)return y;const c=new mM([[0,[0,r.length-1],[0,t.length-1]]],gM);for(;c.length>0;){const M=c.pop();if(M[0]>=y)continue;const R=M[1],B=M[2],K=e?c1:u1,$=a?c1:u1;if(P0(R)<=K&&P0(B)<=$){if(!sd(R,r.length)&&sd(B,t.length))return NaN;let W;if(e&&a)W=lB(r,R,t,B,d),y=Math.min(y,W);else if(e&&!a){const re=r.slice(R[0],R[1]+1);for(let Me=B[0];Me<=B[1];++Me)if(W=Mp(t[Me],re,d),y=Math.min(y,W),y===0)return y}else if(!e&&a){const re=t.slice(B[0],B[1]+1);for(let Me=R[0];Me<=R[1];++Me)if(W=Mp(r[Me],re,d),y=Math.min(y,W),y===0)return y}else W=uB(r,R,t,B,d),y=Math.min(y,W)}else{const W=h1(R,e),re=h1(B,a);Fv(c,y,d,r,t,W[0],re[0]),Fv(c,y,d,r,t,W[0],re[1]),Fv(c,y,d,r,t,W[1],re[0]),Fv(c,y,d,r,t,W[1],re[1])}}return y}function fB(r,e){const t=r.geometry(),a=t.flat().map(y=>r2([y.x,y.y],r.canonical));if(t.length===0)return NaN;const d=new a2(a[0][1]);let m=1/0;for(const y of e){switch(y.type){case"Point":m=Math.min(m,k0(a,!1,[y.coordinates],!1,d,m));break;case"LineString":m=Math.min(m,k0(a,!1,y.coordinates,!0,d,m));break;case"Polygon":m=Math.min(m,R0(a,!1,y.coordinates,d,m));break}if(m===0)return m}return m}function pB(r,e){const t=r.geometry(),a=t.flat().map(y=>r2([y.x,y.y],r.canonical));if(t.length===0)return NaN;const d=new a2(a[0][1]);let m=1/0;for(const y of e){switch(y.type){case"Point":m=Math.min(m,k0(a,!0,[y.coordinates],!1,d,m));break;case"LineString":m=Math.min(m,k0(a,!0,y.coordinates,!0,d,m));break;case"Polygon":m=Math.min(m,R0(a,!0,y.coordinates,d,m));break}if(m===0)return m}return m}function mB(r,e){const t=r.geometry();if(t.length===0||t[0].length===0)return NaN;const a=aB(t).map(y=>y.map(c=>c.map(M=>r2([M.x,M.y],r.canonical)))),d=new a2(a[0][0][0][1]);let m=1/0;for(const y of e)for(const c of a){switch(y.type){case"Point":m=Math.min(m,R0([y.coordinates],!1,c,d,m));break;case"LineString":m=Math.min(m,R0(y.coordinates,!0,c,d,m));break;case"Polygon":m=Math.min(m,dB(c,y.coordinates,d,m));break}if(m===0)return m}return m}function px(r){return r.type==="MultiPolygon"?r.coordinates.map(e=>({type:"Polygon",coordinates:e})):r.type==="MultiLineString"?r.coordinates.map(e=>({type:"LineString",coordinates:e})):r.type==="MultiPoint"?r.coordinates.map(e=>({type:"Point",coordinates:e})):[r]}class zp{constructor(e,t){this.type=qt,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(v_(e[1])){const a=e[1];if(a.type==="FeatureCollection")return new zp(a,a.features.map(d=>px(d.geometry)).flat());if(a.type==="Feature")return new zp(a,px(a.geometry));if("type"in a&&"coordinates"in a)return new zp(a,px(a))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return fB(e,this.geometries);if(e.geometryType()==="LineString")return pB(e,this.geometries);if(e.geometryType()==="Polygon")return mB(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class G_{constructor(e){this.type=qn,this.key=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=e[1];return a==null?t.error("Global state property must be defined."):typeof a!="string"?t.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new G_(a)}evaluate(e){var t;const a=(t=e.globals)===null||t===void 0?void 0:t.globalState;return!a||Object.keys(a).length===0?null:t_(a,this.key)}eachChild(){}outputDefined(){return!1}}const l2={"==":F6,"!=":V6,">":U6,"<":j6,">=":$6,"<=":q6,array:uc,at:Kw,boolean:uc,case:Qw,coalesce:b_,collator:bb,format:e2,image:t2,in:Xw,"index-of":I0,interpolate:ch,"interpolate-hcl":ch,"interpolate-lab":ch,length:n2,let:yb,literal:dg,match:Yw,number:uc,"number-format":Jw,object:uc,slice:M0,step:vb,string:uc,"to-boolean":lf,"to-color":lf,"to-number":lf,"to-string":lf,var:_b,within:Lp,distance:zp,"global-state":G_};class fc{constructor(e,t,a,d){this.name=e,this.type=t,this._evaluate=a,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const a=e[0],d=fc.definitions[a];if(!d)return t.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,c=y.filter(([R])=>!Array.isArray(R)||R.length===e.length-1);let M=null;for(const[R,B]of c){M=new gb(t.registry,D0,t.path,null,t.scope);const K=[];let $=!1;for(let W=1;W<e.length;W++){const re=e[W],Me=Array.isArray(R)?R[W-1]:R.type,Ce=M.parse(re,1+K.length,Me);if(!Ce){$=!0;break}K.push(Ce)}if(!$){if(Array.isArray(R)&&R.length!==K.length){M.error(`Expected ${R.length} arguments, but found ${K.length} instead.`);continue}for(let W=0;W<K.length;W++){const re=Array.isArray(R)?R[W]:R.type,Me=K[W];M.concat(W+1).checkSubtype(re,Me.type)}if(M.errors.length===0)return new fc(a,m,B,K)}}if(c.length===1)t.errors.push(...M.errors);else{const R=(c.length?c:y).map(([K])=>yB(K)).join(" | "),B=[];for(let K=1;K<e.length;K++){const $=t.parse(e[K],1+B.length);if(!$)return null;B.push(qi($.type))}t.error(`Expected arguments of type ${R}, but found (${B.join(", ")}) instead.`)}return null}static register(e,t){fc.definitions=t;for(const a in t)e[a]=fc}}function YS(r,[e,t,a,d]){e=e.evaluate(r),t=t.evaluate(r),a=a.evaluate(r);const m=d?d.evaluate(r):1,y=oM(e,t,a,m);if(y)throw new Ji(y);return new $i(e/255,t/255,a/255,m,!1)}function QS(r,e){return r in e}function mx(r,e){const t=e[r];return typeof t>"u"?null:t}function gB(r,e,t,a){for(;t<=a;){const d=t+a>>1;if(e[d]===r)return!0;e[d]>r?a=d-1:t=d+1}return!1}function Sp(r){return{type:r}}fc.register(l2,{error:[c6,[Yn],(r,[e])=>{throw new Ji(e.evaluate(r))}],typeof:[Yn,[qn],(r,[e])=>qi(za(e.evaluate(r)))],"to-rgba":[Ml(qt,4),[lh],(r,[e])=>{const[t,a,d,m]=e.evaluate(r).rgb;return[t*255,a*255,d*255,m]}],rgb:[lh,[qt,qt,qt],YS],rgba:[lh,[qt,qt,qt,qt],YS],has:{type:Wn,overloads:[[[Yn],(r,[e])=>QS(e.evaluate(r),r.properties())],[[Yn,Rp],(r,[e,t])=>QS(e.evaluate(r),t.evaluate(r))]]},get:{type:qn,overloads:[[[Yn],(r,[e])=>mx(e.evaluate(r),r.properties())],[[Yn,Rp],(r,[e,t])=>mx(e.evaluate(r),t.evaluate(r))]]},"feature-state":[qn,[Yn],(r,[e])=>mx(e.evaluate(r),r.featureState||{})],properties:[Rp,[],r=>r.properties()],"geometry-type":[Yn,[],r=>r.geometryType()],id:[qn,[],r=>r.id()],zoom:[qt,[],r=>r.globals.zoom],"heatmap-density":[qt,[],r=>r.globals.heatmapDensity||0],elevation:[qt,[],r=>r.globals.elevation||0],"line-progress":[qt,[],r=>r.globals.lineProgress||0],accumulated:[qn,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[qt,Sp(qt),(r,e)=>{let t=0;for(const a of e)t+=a.evaluate(r);return t}],"*":[qt,Sp(qt),(r,e)=>{let t=1;for(const a of e)t*=a.evaluate(r);return t}],"-":{type:qt,overloads:[[[qt,qt],(r,[e,t])=>e.evaluate(r)-t.evaluate(r)],[[qt],(r,[e])=>-e.evaluate(r)]]},"/":[qt,[qt,qt],(r,[e,t])=>e.evaluate(r)/t.evaluate(r)],"%":[qt,[qt,qt],(r,[e,t])=>e.evaluate(r)%t.evaluate(r)],ln2:[qt,[],()=>Math.LN2],pi:[qt,[],()=>Math.PI],e:[qt,[],()=>Math.E],"^":[qt,[qt,qt],(r,[e,t])=>Math.pow(e.evaluate(r),t.evaluate(r))],sqrt:[qt,[qt],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[qt,[qt],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[qt,[qt],(r,[e])=>Math.log(e.evaluate(r))],log2:[qt,[qt],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[qt,[qt],(r,[e])=>Math.sin(e.evaluate(r))],cos:[qt,[qt],(r,[e])=>Math.cos(e.evaluate(r))],tan:[qt,[qt],(r,[e])=>Math.tan(e.evaluate(r))],asin:[qt,[qt],(r,[e])=>Math.asin(e.evaluate(r))],acos:[qt,[qt],(r,[e])=>Math.acos(e.evaluate(r))],atan:[qt,[qt],(r,[e])=>Math.atan(e.evaluate(r))],min:[qt,Sp(qt),(r,e)=>Math.min(...e.map(t=>t.evaluate(r)))],max:[qt,Sp(qt),(r,e)=>Math.max(...e.map(t=>t.evaluate(r)))],abs:[qt,[qt],(r,[e])=>Math.abs(e.evaluate(r))],round:[qt,[qt],(r,[e])=>{const t=e.evaluate(r);return t<0?-Math.round(-t):Math.round(t)}],floor:[qt,[qt],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[qt,[qt],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[Wn,[Yn,qn],(r,[e,t])=>r.properties()[e.value]===t.value],"filter-id-==":[Wn,[qn],(r,[e])=>r.id()===e.value],"filter-type-==":[Wn,[Yn],(r,[e])=>r.geometryType()===e.value],"filter-<":[Wn,[Yn,qn],(r,[e,t])=>{const a=r.properties()[e.value],d=t.value;return typeof a==typeof d&&a<d}],"filter-id-<":[Wn,[qn],(r,[e])=>{const t=r.id(),a=e.value;return typeof t==typeof a&&t<a}],"filter->":[Wn,[Yn,qn],(r,[e,t])=>{const a=r.properties()[e.value],d=t.value;return typeof a==typeof d&&a>d}],"filter-id->":[Wn,[qn],(r,[e])=>{const t=r.id(),a=e.value;return typeof t==typeof a&&t>a}],"filter-<=":[Wn,[Yn,qn],(r,[e,t])=>{const a=r.properties()[e.value],d=t.value;return typeof a==typeof d&&a<=d}],"filter-id-<=":[Wn,[qn],(r,[e])=>{const t=r.id(),a=e.value;return typeof t==typeof a&&t<=a}],"filter->=":[Wn,[Yn,qn],(r,[e,t])=>{const a=r.properties()[e.value],d=t.value;return typeof a==typeof d&&a>=d}],"filter-id->=":[Wn,[qn],(r,[e])=>{const t=r.id(),a=e.value;return typeof t==typeof a&&t>=a}],"filter-has":[Wn,[qn],(r,[e])=>e.value in r.properties()],"filter-has-id":[Wn,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Wn,[Ml(Yn)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[Wn,[Ml(qn)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[Wn,[Yn,Ml(qn)],(r,[e,t])=>t.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[Wn,[Yn,Ml(qn)],(r,[e,t])=>gB(r.properties()[e.value],t.value,0,t.value.length-1)],all:{type:Wn,overloads:[[[Wn,Wn],(r,[e,t])=>e.evaluate(r)&&t.evaluate(r)],[Sp(Wn),(r,e)=>{for(const t of e)if(!t.evaluate(r))return!1;return!0}]]},any:{type:Wn,overloads:[[[Wn,Wn],(r,[e,t])=>e.evaluate(r)||t.evaluate(r)],[Sp(Wn),(r,e)=>{for(const t of e)if(t.evaluate(r))return!0;return!1}]]},"!":[Wn,[Wn],(r,[e])=>!e.evaluate(r)],"is-supported-script":[Wn,[Yn],(r,[e])=>{const t=r.globals&&r.globals.isSupportedScript;return t?t(e.evaluate(r)):!0}],upcase:[Yn,[Yn],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[Yn,[Yn],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[Yn,Sp(qn),(r,e)=>e.map(t=>n_(t.evaluate(r))).join("")],"resolved-locale":[Yn,[hb],(r,[e])=>e.evaluate(r).resolvedLocale()]});function yB(r){return Array.isArray(r)?`(${r.map(qi).join(", ")})`:`(${qi(r.type)}...)`}function D0(r){if(r instanceof _b)return D0(r.boundExpression);if(r instanceof fc&&r.name==="error"||r instanceof bb||r instanceof Lp||r instanceof zp||r instanceof G_)return!1;const e=r instanceof lf||r instanceof uc;let t=!0;return r.eachChild(a=>{e?t=t&&D0(a):t=t&&a instanceof dg}),t?wb(r)&&Tb(r,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function wb(r){if(r instanceof fc&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Lp||r instanceof zp)return!1;let e=!0;return r.eachChild(t=>{e&&!wb(t)&&(e=!1)}),e}function w_(r){if(r instanceof fc&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(t=>{e&&!w_(t)&&(e=!1)}),e}function Tb(r,e){if(r instanceof fc&&e.indexOf(r.name)>=0)return!1;let t=!0;return r.eachChild(a=>{t&&!Tb(a,e)&&(t=!1)}),t}function p1(r){return{result:"success",value:r}}function Gm(r){return{result:"error",value:r}}function L0(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function yM(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function _M(r){return!!r.expression&&r.expression.interpolated}function sr(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function u2(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&za(r)===Rp}class _B{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new lM,this._defaultValue=t?xB(t):null,this._enumValues=t&&t.type==="enum"?t.values:null}evaluateWithoutErrorHandling(e,t,a,d,m,y){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=a,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,t,a,d,m,y){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=a||null,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const c=this.expression.evaluate(this._evaluator);if(c==null||typeof c=="number"&&c!==c)return this._defaultValue;if(this._enumValues&&!(c in this._enumValues))throw new Ji(`Expected value to be one of ${Object.keys(this._enumValues).map(M=>JSON.stringify(M)).join(", ")}, but found ${JSON.stringify(c)} instead.`);return c}catch(c){return this._warningHistory[c.message]||(this._warningHistory[c.message]=!0,typeof console<"u"&&console.warn(c.message)),this._defaultValue}}}function vM(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in l2}function bM(r,e){const t=new gb(l2,D0,[],e?bB(e):void 0),a=t.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?p1(new _B(a,e)):Gm(t.errors)}class JS{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!w_(t.expression),this.globalStateRefs=c2(t.expression)}evaluateWithoutErrorHandling(e,t,a,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,t,a,d,m,y)}evaluate(e,t,a,d,m,y){return this._styleExpression.evaluate(e,t,a,d,m,y)}}class eE{constructor(e,t,a,d){this.kind=e,this.zoomStops=a,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!w_(t.expression),this.globalStateRefs=c2(t.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,t,a,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,t,a,d,m,y)}evaluate(e,t,a,d,m,y){return this._styleExpression.evaluate(e,t,a,d,m,y)}interpolationFactor(e,t,a){return this.interpolationType?ch.interpolationFactor(this.interpolationType,e,t,a):0}}function vB(r,e){const t=bM(r,e);if(t.result==="error")return t;const a=t.value.expression,d=wb(a);if(!d&&!L0(e))return Gm([new th("","data expressions not supported")]);const m=Tb(a,["zoom"]);if(!m&&!yM(e))return Gm([new th("","zoom expressions not supported")]);const y=r0(a);if(!y&&!m)return Gm([new th("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(y instanceof th)return Gm([y]);if(y instanceof ch&&!_M(e))return Gm([new th("",'"interpolate" expressions cannot be used with this property')]);if(!y)return p1(d?new JS("constant",t.value):new JS("source",t.value));const c=y instanceof ch?y.interpolation:void 0;return p1(d?new eE("camera",t.value,y.labels,c):new eE("composite",t.value,y.labels,c))}function r0(r){let e=null;if(r instanceof yb)e=r0(r.result);else if(r instanceof b_){for(const t of r.args)if(e=r0(t),e)break}else(r instanceof vb||r instanceof ch)&&r.input instanceof fc&&r.input.name==="zoom"&&(e=r);return e instanceof th||r.eachChild(t=>{const a=r0(t);a instanceof th?e=a:!e&&a?e=new th("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new th("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function c2(r,e=new Set){return r instanceof G_&&e.add(r.key),r.eachChild(t=>{c2(t,e)}),e}function bB(r){const e={color:lh,string:Yn,number:qt,enum:Yn,boolean:Wn,formatted:db,padding:fb,numberArray:pb,colorArray:g_,projectionDefinition:cb,resolvedImage:q_,variableAnchorOffsetCollection:mb};return r.type==="array"?Ml(e[r.value]||qn,r.length):e[r.type]}function xB(r){if(r.type==="color"&&u2(r.default))return new $i(0,0,0,0);switch(r.type){case"color":return $i.parse(r.default)||null;case"padding":return hc.parse(r.default)||null;case"numberArray":return dc.parse(r.default)||null;case"colorArray":return Rl.parse(r.default)||null;case"variableAnchorOffsetCollection":return uh.parse(r.default)||null;case"projectionDefinition":return lc.parse(r.default)||null;default:return r.default===void 0?null:r.default}}function xM(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!xM(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function wM(r){const e=r.key,t=r.value;return t?[new Nt(e,t,"constants have been deprecated as of v8")]:[]}function ca(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Up(r){if(Array.isArray(r))return r.map(Up);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const t in r)e[t]=Up(r[t]);return e}return ca(r)}function yu(r){const e=r.key,t=r.value,a=r.valueSpec||{},d=r.objectElementValidators||{},m=r.style,y=r.styleSpec,c=r.validateSpec;let M=[];const R=sr(t);if(R!=="object")return[new Nt(e,t,`object expected, ${R} found`)];for(const B in t){const K=B.split(".")[0],$=t_(a,K)||a["*"];let W;if(t_(d,K))W=d[K];else if(t_(a,K))W=c;else if(d["*"])W=d["*"];else if(a["*"])W=c;else{M.push(new Nt(e,t[B],`unknown property "${B}"`));continue}M=M.concat(W({key:(e&&`${e}.`)+B,value:t[B],valueSpec:$,style:m,styleSpec:y,object:t,objectKey:B,validateSpec:c},t))}for(const B in a)d[B]||a[B].required&&a[B].default===void 0&&t[B]===void 0&&M.push(new Nt(e,t,`missing required property "${B}"`));return M}function h2(r){const e=r.value,t=r.valueSpec,a=r.validateSpec,d=r.style,m=r.styleSpec,y=r.key,c=r.arrayElementValidator||a;if(sr(e)!=="array")return[new Nt(y,e,`array expected, ${sr(e)} found`)];if(t.length&&e.length!==t.length)return[new Nt(y,e,`array length ${t.length} expected, length ${e.length} found`)];if(t["min-length"]&&e.length<t["min-length"])return[new Nt(y,e,`array length at least ${t["min-length"]} expected, length ${e.length} found`)];let M={type:t.value,values:t.values};m.$version<7&&(M.function=t.function),sr(t.value)==="object"&&(M=t.value);let R=[];for(let B=0;B<e.length;B++)R=R.concat(c({array:e,arrayIndex:B,value:e[B],valueSpec:M,validateSpec:r.validateSpec,style:d,styleSpec:m,key:`${y}[${B}]`}));return R}function Sb(r){const e=r.key,t=r.value,a=r.valueSpec;let d=sr(t);return d==="number"&&t!==t&&(d="NaN"),d!=="number"?[new Nt(e,t,`number expected, ${d} found`)]:"minimum"in a&&t<a.minimum?[new Nt(e,t,`${t} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&t>a.maximum?[new Nt(e,t,`${t} is greater than the maximum value ${a.maximum}`)]:[]}function TM(r){const e=r.valueSpec,t=ca(r.value.type);let a,d={},m,y;const c=t!=="categorical"&&r.value.property===void 0,M=!c,R=sr(r.value.stops)==="array"&&sr(r.value.stops[0])==="array"&&sr(r.value.stops[0][0])==="object",B=yu({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:K,default:re}});return t==="identity"&&c&&B.push(new Nt(r.key,r.value,'missing required property "property"')),t!=="identity"&&!r.value.stops&&B.push(new Nt(r.key,r.value,'missing required property "stops"')),t==="exponential"&&r.valueSpec.expression&&!_M(r.valueSpec)&&B.push(new Nt(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(M&&!L0(r.valueSpec)?B.push(new Nt(r.key,r.value,"property functions not supported")):c&&!yM(r.valueSpec)&&B.push(new Nt(r.key,r.value,"zoom functions not supported"))),(t==="categorical"||R)&&r.value.property===void 0&&B.push(new Nt(r.key,r.value,'"property" property is required')),B;function K(Me){if(t==="identity")return[new Nt(Me.key,Me.value,'identity function may not have a "stops" property')];let Ce=[];const Be=Me.value;return Ce=Ce.concat(h2({key:Me.key,value:Be,valueSpec:Me.valueSpec,validateSpec:Me.validateSpec,style:Me.style,styleSpec:Me.styleSpec,arrayElementValidator:$})),sr(Be)==="array"&&Be.length===0&&Ce.push(new Nt(Me.key,Be,"array must have at least one stop")),Ce}function $(Me){let Ce=[];const Be=Me.value,He=Me.key;if(sr(Be)!=="array")return[new Nt(He,Be,`array expected, ${sr(Be)} found`)];if(Be.length!==2)return[new Nt(He,Be,`array length 2 expected, length ${Be.length} found`)];if(R){if(sr(Be[0])!=="object")return[new Nt(He,Be,`object expected, ${sr(Be[0])} found`)];if(Be[0].zoom===void 0)return[new Nt(He,Be,"object stop key must have zoom")];if(Be[0].value===void 0)return[new Nt(He,Be,"object stop key must have value")];if(y&&y>ca(Be[0].zoom))return[new Nt(He,Be[0].zoom,"stop zoom values must appear in ascending order")];ca(Be[0].zoom)!==y&&(y=ca(Be[0].zoom),m=void 0,d={}),Ce=Ce.concat(yu({key:`${He}[0]`,value:Be[0],valueSpec:{zoom:{}},validateSpec:Me.validateSpec,style:Me.style,styleSpec:Me.styleSpec,objectElementValidators:{zoom:Sb,value:W}}))}else Ce=Ce.concat(W({key:`${He}[0]`,value:Be[0],validateSpec:Me.validateSpec,style:Me.style,styleSpec:Me.styleSpec},Be));return vM(Up(Be[1]))?Ce.concat([new Nt(`${He}[1]`,Be[1],"expressions are not allowed in function stops.")]):Ce.concat(Me.validateSpec({key:`${He}[1]`,value:Be[1],valueSpec:e,validateSpec:Me.validateSpec,style:Me.style,styleSpec:Me.styleSpec}))}function W(Me,Ce){const Be=sr(Me.value),He=ca(Me.value),ut=Me.value!==null?Me.value:Ce;if(!a)a=Be;else if(Be!==a)return[new Nt(Me.key,ut,`${Be} stop domain type must match previous stop domain type ${a}`)];if(Be!=="number"&&Be!=="string"&&Be!=="boolean")return[new Nt(Me.key,ut,"stop domain value must be a number, string, or boolean")];if(Be!=="number"&&t!=="categorical"){let Ue=`number expected, ${Be} found`;return L0(e)&&t===void 0&&(Ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Nt(Me.key,ut,Ue)]}return t==="categorical"&&Be==="number"&&(!isFinite(He)||Math.floor(He)!==He)?[new Nt(Me.key,ut,`integer expected, found ${He}`)]:t!=="categorical"&&Be==="number"&&m!==void 0&&He<m?[new Nt(Me.key,ut,"stop domain values must appear in ascending order")]:(m=He,t==="categorical"&&He in d?[new Nt(Me.key,ut,"stop domain values must be unique")]:(d[He]=!0,[]))}function re(Me){return Me.validateSpec({key:Me.key,value:Me.value,valueSpec:e,validateSpec:Me.validateSpec,style:Me.style,styleSpec:Me.styleSpec})}}function fg(r){const e=(r.expressionContext==="property"?vB:bM)(Up(r.value),r.valueSpec);if(e.result==="error")return e.value.map(a=>new Nt(`${r.key}${a.key}`,r.value,a.message));const t=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!t.outputDefined())return[new Nt(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!w_(t))return[new Nt(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!w_(t))return[new Nt(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Tb(t,["zoom","feature-state"]))return[new Nt(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!wb(t))return[new Nt(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function wB(r){const e=r.value,t=r.key,a=sr(e);return a!=="boolean"?[new Nt(t,e,`boolean expected, ${a} found`)]:[]}function m1(r){const e=r.key,t=r.value,a=sr(t);return a!=="string"?[new Nt(e,t,`color expected, ${a} found`)]:$i.parse(String(t))?[]:[new Nt(e,t,`color expected, "${t}" found`)]}function T_(r){const e=r.key,t=r.value,a=r.valueSpec,d=[];return Array.isArray(a.values)?a.values.indexOf(ca(t))===-1&&d.push(new Nt(e,t,`expected one of [${a.values.join(", ")}], ${JSON.stringify(t)} found`)):Object.keys(a.values).indexOf(ca(t))===-1&&d.push(new Nt(e,t,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(t)} found`)),d}function d2(r){return xM(Up(r.value))?fg(C0({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):SM(r)}function SM(r){const e=r.value,t=r.key;if(sr(e)!=="array")return[new Nt(t,e,`array expected, ${sr(e)} found`)];const a=r.styleSpec;let d,m=[];if(e.length<1)return[new Nt(t,e,"filter array must have at least 1 element")];switch(m=m.concat(T_({key:`${t}[0]`,value:e[0],valueSpec:a.filter_operator,style:r.style,styleSpec:r.styleSpec})),ca(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ca(e[1])==="$type"&&m.push(new Nt(t,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Nt(t,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=sr(e[1]),d!=="string"&&m.push(new Nt(`${t}[1]`,e[1],`string expected, ${d} found`)));for(let y=2;y<e.length;y++)d=sr(e[y]),ca(e[1])==="$type"?m=m.concat(T_({key:`${t}[${y}]`,value:e[y],valueSpec:a.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&m.push(new Nt(`${t}[${y}]`,e[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(SM({key:`${t}[${y}]`,value:e[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=sr(e[1]),e.length!==2?m.push(new Nt(t,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&m.push(new Nt(`${t}[1]`,e[1],`string expected, ${d} found`));break}return m}function EM(r,e){const t=r.key,a=r.validateSpec,d=r.style,m=r.styleSpec,y=r.value,c=r.objectKey,M=m[`${e}_${r.layerType}`];if(!M)return[];const R=c.match(/^(.*)-transition$/);if(e==="paint"&&R&&M[R[1]]&&M[R[1]].transition)return a({key:t,value:y,valueSpec:m.transition,style:d,styleSpec:m});const B=r.valueSpec||M[c];if(!B)return[new Nt(t,y,`unknown property "${c}"`)];let K;if(sr(y)==="string"&&L0(B)&&!B.tokens&&(K=/^{([^}]+)}$/.exec(y)))return[new Nt(t,y,`"${c}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(K[1])} }\`.`)];const $=[];return r.layerType==="symbol"&&(c==="text-field"&&d&&!d.glyphs&&$.push(new Nt(t,y,'use of "text-field" requires a style "glyphs" property')),c==="text-font"&&u2(Up(y))&&ca(y.type)==="identity"&&$.push(new Nt(t,y,'"text-font" does not support identity functions'))),$.concat(a({key:r.key,value:y,valueSpec:B,style:d,styleSpec:m,expressionContext:"property",propertyType:e,propertyKey:c}))}function AM(r){return EM(r,"paint")}function CM(r){return EM(r,"layout")}function IM(r){let e=[];const t=r.value,a=r.key,d=r.style,m=r.styleSpec;if(sr(t)!=="object")return[new Nt(a,t,`object expected, ${sr(t)} found`)];!t.type&&!t.ref&&e.push(new Nt(a,t,'either "type" or "ref" is required'));let y=ca(t.type);const c=ca(t.ref);if(t.id){const M=ca(t.id);for(let R=0;R<r.arrayIndex;R++){const B=d.layers[R];ca(B.id)===M&&e.push(new Nt(a,t.id,`duplicate layer id "${t.id}", previously used at line ${B.id.__line__}`))}}if("ref"in t){["type","source","source-layer","filter","layout"].forEach(R=>{R in t&&e.push(new Nt(a,t[R],`"${R}" is prohibited for ref layers`))});let M;d.layers.forEach(R=>{ca(R.id)===c&&(M=R)}),M?M.ref?e.push(new Nt(a,t.ref,"ref cannot reference another ref layer")):y=ca(M.type):e.push(new Nt(a,t.ref,`ref layer "${c}" not found`))}else if(y!=="background")if(!t.source)e.push(new Nt(a,t,'missing required property "source"'));else{const M=d.sources&&d.sources[t.source],R=M&&ca(M.type);M?R==="vector"&&y==="raster"?e.push(new Nt(a,t.source,`layer "${t.id}" requires a raster source`)):R!=="raster-dem"&&y==="hillshade"?e.push(new Nt(a,t.source,`layer "${t.id}" requires a raster-dem source`)):R!=="raster-dem"&&y==="color-relief"?e.push(new Nt(a,t.source,`layer "${t.id}" requires a raster-dem source`)):R==="raster"&&y!=="raster"?e.push(new Nt(a,t.source,`layer "${t.id}" requires a vector source`)):R==="vector"&&!t["source-layer"]?e.push(new Nt(a,t,`layer "${t.id}" must specify a "source-layer"`)):R==="raster-dem"&&y!=="hillshade"&&y!=="color-relief"?e.push(new Nt(a,t.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):y==="line"&&t.paint&&t.paint["line-gradient"]&&(R!=="geojson"||!M.lineMetrics)&&e.push(new Nt(a,t,`layer "${t.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Nt(a,t.source,`source "${t.source}" not found`))}return e=e.concat(yu({key:a,value:t,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*"(){return[]},type(){return r.validateSpec({key:`${a}.type`,value:t.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:t,objectKey:"type"})},filter:d2,layout(M){return yu({layer:t,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,validateSpec:M.validateSpec,objectElementValidators:{"*"(R){return CM(C0({layerType:y},R))}}})},paint(M){return yu({layer:t,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,validateSpec:M.validateSpec,objectElementValidators:{"*"(R){return AM(C0({layerType:y},R))}}})}}})),e}function qp(r){const e=r.value,t=r.key,a=sr(e);return a!=="string"?[new Nt(t,e,`string expected, ${a} found`)]:[]}function TB(r){var e;const t=(e=r.sourceName)!==null&&e!==void 0?e:"",a=r.value,d=r.styleSpec,m=d.source_raster_dem,y=r.style;let c=[];const M=sr(a);if(a===void 0)return c;if(M!=="object")return c.push(new Nt("source_raster_dem",a,`object expected, ${M} found`)),c;const R=ca(a.encoding)==="custom",B=["redFactor","greenFactor","blueFactor","baseShift"],K=r.value.encoding?`"${r.value.encoding}"`:"Default";for(const $ in a)!R&&B.includes($)?c.push(new Nt($,a[$],`In "${t}": "${$}" is only valid when "encoding" is set to "custom". ${K} encoding found`)):m[$]?c=c.concat(r.validateSpec({key:$,value:a[$],valueSpec:m[$],validateSpec:r.validateSpec,style:y,styleSpec:d})):c.push(new Nt($,a[$],`unknown property "${$}"`));return c}const tE={promoteId:SB};function MM(r){const e=r.value,t=r.key,a=r.styleSpec,d=r.style,m=r.validateSpec;if(!e.type)return[new Nt(t,e,'"type" is required')];const y=ca(e.type);let c;switch(y){case"vector":case"raster":return c=yu({key:t,value:e,valueSpec:a[`source_${y.replace("-","_")}`],style:r.style,styleSpec:a,objectElementValidators:tE,validateSpec:m}),c;case"raster-dem":return c=TB({sourceName:t,value:e,style:r.style,styleSpec:a,validateSpec:m}),c;case"geojson":if(c=yu({key:t,value:e,valueSpec:a.source_geojson,style:d,styleSpec:a,validateSpec:m,objectElementValidators:tE}),e.cluster)for(const M in e.clusterProperties){const[R,B]=e.clusterProperties[M],K=typeof R=="string"?[R,["accumulated"],["get",M]]:R;c.push(...fg({key:`${t}.${M}.map`,value:B,expressionContext:"cluster-map"})),c.push(...fg({key:`${t}.${M}.reduce`,value:K,expressionContext:"cluster-reduce"}))}return c;case"video":return yu({key:t,value:e,valueSpec:a.source_video,style:d,validateSpec:m,styleSpec:a});case"image":return yu({key:t,value:e,valueSpec:a.source_image,style:d,validateSpec:m,styleSpec:a});case"canvas":return[new Nt(t,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return T_({key:`${t}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function SB({key:r,value:e}){if(sr(e)==="string")return qp({key:r,value:e});{const t=[];for(const a in e)t.push(...qp({key:`${r}.${a}`,value:e[a]}));return t}}function PM(r){const e=r.value,t=r.styleSpec,a=t.light,d=r.style;let m=[];const y=sr(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Nt("light",e,`object expected, ${y} found`)]),m;for(const c in e){const M=c.match(/^(.*)-transition$/);M&&a[M[1]]&&a[M[1]].transition?m=m.concat(r.validateSpec({key:c,value:e[c],valueSpec:t.transition,validateSpec:r.validateSpec,style:d,styleSpec:t})):a[c]?m=m.concat(r.validateSpec({key:c,value:e[c],valueSpec:a[c],validateSpec:r.validateSpec,style:d,styleSpec:t})):m=m.concat([new Nt(c,e[c],`unknown property "${c}"`)])}return m}function RM(r){const e=r.value,t=r.styleSpec,a=t.sky,d=r.style,m=sr(e);if(e===void 0)return[];if(m!=="object")return[new Nt("sky",e,`object expected, ${m} found`)];let y=[];for(const c in e)a[c]?y=y.concat(r.validateSpec({key:c,value:e[c],valueSpec:a[c],style:d,styleSpec:t})):y=y.concat([new Nt(c,e[c],`unknown property "${c}"`)]);return y}function kM(r){const e=r.value,t=r.styleSpec,a=t.terrain,d=r.style;let m=[];const y=sr(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Nt("terrain",e,`object expected, ${y} found`)]),m;for(const c in e)a[c]?m=m.concat(r.validateSpec({key:c,value:e[c],valueSpec:a[c],validateSpec:r.validateSpec,style:d,styleSpec:t})):m=m.concat([new Nt(c,e[c],`unknown property "${c}"`)]);return m}function EB(r){return qp(r).length===0?[]:fg(r)}function AB(r){return qp(r).length===0?[]:fg(r)}function CB(r){const e=r.key,t=r.value;if(sr(t)==="array"){if(t.length<1||t.length>4)return[new Nt(e,t,`padding requires 1 to 4 values; ${t.length} values found`)];const a={type:"number"};let d=[];for(let m=0;m<t.length;m++)d=d.concat(r.validateSpec({key:`${e}[${m}]`,value:t[m],validateSpec:r.validateSpec,valueSpec:a}));return d}else return Sb({key:e,value:t,valueSpec:{}})}function IB(r){const e=r.key,t=r.value;if(sr(t)==="array"){const a={type:"number"};if(t.length<1)return[new Nt(e,t,"array length at least 1 expected, length 0 found")];let d=[];for(let m=0;m<t.length;m++)d=d.concat(r.validateSpec({key:`${e}[${m}]`,value:t[m],validateSpec:r.validateSpec,valueSpec:a}));return d}else return Sb({key:e,value:t,valueSpec:{}})}function MB(r){const e=r.key,t=r.value;if(sr(t)==="array"){if(t.length<1)return[new Nt(e,t,"array length at least 1 expected, length 0 found")];let a=[];for(let d=0;d<t.length;d++)a=a.concat(m1({key:`${e}[${d}]`,value:t[d]}));return a}else return m1({key:e,value:t})}function PB(r){const e=r.key,t=r.value,a=sr(t),d=r.styleSpec;if(a!=="array"||t.length<1||t.length%2!==0)return[new Nt(e,t,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let y=0;y<t.length;y+=2)m=m.concat(T_({key:`${e}[${y}]`,value:t[y],valueSpec:d.layout_symbol["text-anchor"]})),m=m.concat(h2({key:`${e}[${y+1}]`,value:t[y+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:d}));return m}function DM(r){let e=[];const t=r.value,a=r.key;if(Array.isArray(t)){const d=[],m=[];for(const y in t){t[y].id&&d.includes(t[y].id)&&e.push(new Nt(a,t,`all the sprites' ids must be unique, but ${t[y].id} is duplicated`)),d.push(t[y].id),t[y].url&&m.includes(t[y].url)&&e.push(new Nt(a,t,`all the sprites' URLs must be unique, but ${t[y].url} is duplicated`)),m.push(t[y].url);const c={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(yu({key:`${a}[${y}]`,value:t[y],valueSpec:c,validateSpec:r.validateSpec}))}return e}else return qp({key:a,value:t})}function RB(r){const e=r.value,t=r.styleSpec,a=t.projection,d=r.style,m=sr(e);if(e===void 0)return[];if(m!=="object")return[new Nt("projection",e,`object expected, ${m} found`)];let y=[];for(const c in e)a[c]?y=y.concat(r.validateSpec({key:c,value:e[c],valueSpec:a[c],style:d,styleSpec:t})):y=y.concat([new Nt(c,e[c],`unknown property "${c}"`)]);return y}function kB(r){const e=r.key;let t=r.value;t=t instanceof String?t.valueOf():t;const a=sr(t);return a==="array"&&!LB(t)&&!DB(t)?[new Nt(e,t,`projection expected, invalid array ${JSON.stringify(t)} found`)]:["array","string"].includes(a)?[]:[new Nt(e,t,`projection expected, invalid type "${a}" found`)]}function DB(r){return!!["interpolate","step","literal"].includes(r[0])}function LB(r){return Array.isArray(r)&&r.length===3&&typeof r[0]=="string"&&typeof r[1]=="string"&&typeof r[2]=="number"}function zB(r){return!!r&&r.constructor===Object}function LM(r){return zB(r.value)?[]:[new Nt(r.key,r.value,`object expected, ${sr(r.value)} found`)]}const nE={"*"(){return[]},array:h2,boolean:wB,number:Sb,color:m1,constants:wM,enum:T_,filter:d2,function:TM,layer:IM,object:yu,source:MM,light:PM,sky:RM,terrain:kM,projection:RB,projectionDefinition:kB,string:qp,formatted:EB,resolvedImage:AB,padding:CB,numberArray:IB,colorArray:MB,variableAnchorOffsetCollection:PB,sprite:DM,state:LM};function z0(r){const e=r.value,t=r.valueSpec,a=r.styleSpec;return r.validateSpec=z0,t.expression&&u2(ca(e))?TM(r):t.expression&&vM(Up(e))?fg(r):t.type&&nE[t.type]?nE[t.type](r):yu(C0({},r,{valueSpec:t.type?a[t.type]:t}))}function zM(r){const e=r.value,t=r.key,a=qp(r);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Nt(t,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Nt(t,e,'"glyphs" url must include a "{range}" token'))),a}function kl(r,e=u6){let t=[];return t=t.concat(z0({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,validateSpec:z0,objectElementValidators:{glyphs:zM,"*"(){return[]}}})),r.constants&&(t=t.concat(wM({key:"constants",value:r.constants}))),OM(t)}kl.source=vc(_c(MM));kl.sprite=vc(_c(DM));kl.glyphs=vc(_c(zM));kl.light=vc(_c(PM));kl.sky=vc(_c(RM));kl.terrain=vc(_c(kM));kl.state=vc(_c(LM));kl.layer=vc(_c(IM));kl.filter=vc(_c(d2));kl.paintProperty=vc(_c(AM));kl.layoutProperty=vc(_c(CM));function _c(r){return function(e){return r({...e,validateSpec:z0})}}function OM(r){return[].concat(r).sort((e,t)=>e.line-t.line)}function vc(r){return function(...e){return OM(r.apply(this,e))}}function rE(r){if(!r)return{style:e_[Jy[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0};if(typeof r=="string"){const e=NB(r);return e.isValidStyle?{style:e.styleObject,requiresUrlMonitoring:!1,isFallback:!1}:e.isValidJSON?{style:e_[Jy[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}:r.startsWith("http")?{style:r,requiresUrlMonitoring:!0,isFallback:!1}:r.toLowerCase().includes(".json")?{style:OB(r),requiresUrlMonitoring:!0,isFallback:!1}:{style:zI(r),requiresUrlMonitoring:!0,isFallback:!1}}return r instanceof OI?{style:r.getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:r instanceof NI?{style:r.getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:kl(r).length===0?{style:r,requiresUrlMonitoring:!1,isFallback:!1}:{style:e_[Jy[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}}function OB(r){try{return new URL(r).href}catch{}return new URL(r,location.origin).href}function NB(r){try{const e=JSON.parse(r),t=kl(e);return{isValidJSON:!0,isValidStyle:t.length===0,styleObject:t.length===0?e:null}}catch{return{isValidJSON:!1,isValidStyle:!1,styleObject:null}}}function Jh(r,e,t){const a=window.document.createElement(r);return e!==void 0&&(a.className=e),t&&t.appendChild(a),a}function f2(r){r.parentNode&&r.parentNode.removeChild(r)}class BB{constructor(){$n(this,"_map"),$n(this,"_container"),$n(this,"_terrainButton"),sN(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(e){return this._map=e,this._container=Jh("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Jh("button","maplibregl-ctrl-terrain",this._container),Jh("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){f2(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class FB extends _N{constructor(e={}){super({showCompass:e.showCompass??!0,showZoom:e.showZoom??!0,visualizePitch:e.visualizePitch??!0}),$n(this,"_rotateCompassArrow",()=>{const t=this._map.getBearing(),a=this._map.getPitch(),d=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(a*(Math.PI/180))**.5)}) rotateX(${Math.min(70,a)}deg) rotateZ(${-t}deg)`:`rotate(${-t}deg)`;this._compassIcon.style.transform=d}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",t=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}))}_createButton(e,t){const a=super._createButton(e,t);return a.clickFunction=t,a}}const iE=un.Marker,aE=un.LngLat,VB=un.LngLatBounds;class jB extends vN{constructor(){super(...arguments),$n(this,"lastUpdatedCenter",new aE(0,0)),$n(this,"_updateCamera",e=>{var t;const a=new aE(e.coords.longitude,e.coords.latitude),d=e.coords.accuracy,m={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},y=this._map.getZoom();y>(((t=this.options.fitBoundsOptions)==null?void 0:t.maxZoom)??30)&&(m.zoom=y),this._map.fitBounds(VB.fromLngLat(a,d),m,{geolocateSource:!0});let c=!1;const M=()=>{c=!0};this._map.once("click",M),this._map.once("dblclick",M),this._map.once("dragstart",M),this._map.once("mousedown",M),this._map.once("touchstart",M),this._map.once("wheel",M),this._map.once("moveend",()=>{this._map.off("click",M),this._map.off("dblclick",M),this._map.off("dragstart",M),this._map.off("mousedown",M),this._map.off("touchstart",M),this._map.off("wheel",M),!c&&(this.lastUpdatedCenter=this._map.getCenter())})}),$n(this,"_finishSetupUI",e=>{if(this._map){if(e===!1){const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Jh("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new iE({element:this._dotElement}),this._circleElement=Jh("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new iE({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",t=>{const a=t.originalEvent&&t.originalEvent.type==="resize",d=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!t.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!a&&d>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),$n(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const e=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],t=this._map.project(e),a=this._map.unproject([t.x,t.y]),d=this._map.unproject([t.x+20,t.y]),m=a.distanceTo(d)/20,y=Math.ceil(2*this._accuracy/m);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;case"BACKGROUND_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}}var Il,Qc,Ap,Cp,pu,i0,Io,NM,mu,BM;class gx{constructor(e,t){Tp(this,Io),Tp(this,Il),$n(this,"map"),Tp(this,Qc),Tp(this,Ap),Tp(this,Cp),Tp(this,pu,!1),Tp(this,i0),e.style!==void 0&&Um(this,pu,!0),Um(this,Il,{zoomAdjust:-4,position:"top-right",...t,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...e,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...e.containerStyle??{}}}),e.lockZoom!==void 0&&(dr(this,Il).minZoom=e.lockZoom,dr(this,Il).maxZoom=e.lockZoom)}setStyle(e,t){dr(this,pu)||this.map.setStyle(e,t),Cl(this,Io,mu).call(this)}addLayer(e,t){return dr(this,pu)||this.map.addLayer(e,t),Cl(this,Io,mu).call(this),this.map}moveLayer(e,t){return dr(this,pu)||this.map.moveLayer(e,t),Cl(this,Io,mu).call(this),this.map}removeLayer(e){return dr(this,pu)||this.map.removeLayer(e),Cl(this,Io,mu).call(this),this}setLayerZoomRange(e,t,a){return dr(this,pu)||this.map.setLayerZoomRange(e,t,a),Cl(this,Io,mu).call(this),this}setFilter(e,t,a){return dr(this,pu)||this.map.setFilter(e,t,a),Cl(this,Io,mu).call(this),this}setPaintProperty(e,t,a,d){return dr(this,pu)||this.map.setPaintProperty(e,t,a,d),Cl(this,Io,mu).call(this),this}setLayoutProperty(e,t,a,d){return dr(this,pu)||this.map.setLayoutProperty(e,t,a,d),Cl(this,Io,mu).call(this),this}setGlyphs(e,t){return dr(this,pu)||this.map.setGlyphs(e,t),Cl(this,Io,mu).call(this),this}onAdd(e){Um(this,Qc,e),Um(this,Ap,Jh("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[t,a]of Object.entries(dr(this,Il).containerStyle))dr(this,Ap).style.setProperty(t,a);return dr(this,Il).container=dr(this,Ap),dr(this,Il).zoom=e.getZoom()+dr(this,Il).zoomAdjust,this.map=new FM(dr(this,Il)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{Cl(this,Io,NM).call(this,dr(this,Il).parentRect),Um(this,i0,Cl(this,Io,BM).call(this))}),dr(this,Ap)}onRemove(){var e;(e=dr(this,i0))==null||e.call(this),f2(dr(this,Ap))}}Il=new WeakMap,Qc=new WeakMap,Ap=new WeakMap,Cp=new WeakMap,pu=new WeakMap,i0=new WeakMap,Io=new WeakSet,NM=function(r){r===void 0||r.linePaint===void 0&&r.fillPaint===void 0||(Um(this,Cp,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:dr(this,Cp)}),(r.lineLayout!==void 0||r.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...r.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...r.linePaint}}),r.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...r.fillPaint}}),Cl(this,Io,mu).call(this))},mu=function(){if(dr(this,Cp)===void 0)return;const{devicePixelRatio:r}=window,e=dr(this,Qc).getCanvas(),t=e.width/r,a=e.height/r,d=dr(this,Qc).unproject.bind(dr(this,Qc)),m=d([0,0]),y=d([t,0]),c=d([0,a]),M=d([t,a]);dr(this,Cp).geometry.coordinates=[[c.toArray(),M.toArray(),y.toArray(),m.toArray(),c.toArray()]];const R=this.map.getSource("parentRect");R!==void 0&&R.setData(dr(this,Cp))},BM=function(){const{pitchAdjust:r}=dr(this,Il),e=()=>{m("parent")},t=()=>{m("minimap")},a=()=>{dr(this,Qc).on("move",e),this.map.on("move",t)},d=()=>{dr(this,Qc).off("move",e),this.map.off("move",t)},m=y=>{d();const c=y==="parent"?dr(this,Qc):this.map,M=y==="parent"?this.map:dr(this,Qc),R=c.getCenter(),B=c.getZoom()+dr(this,Il).zoomAdjust*(y==="parent"?1:-1),K=c.getBearing(),$=c.getPitch();M.jumpTo({center:R,zoom:B,bearing:K,pitch:r?$:0}),Cl(this,Io,mu).call(this),a()};return a(),()=>{d()}};class UB{constructor(){$n(this,"map"),$n(this,"container"),$n(this,"projectionButton")}onAdd(e){return this.map=e,this.container=Jh("div","maplibregl-ctrl maplibregl-ctrl-group"),this.projectionButton=Jh("button","maplibregl-ctrl-projection",this.container),Jh("span","maplibregl-ctrl-icon",this.projectionButton).setAttribute("aria-hidden","true"),this.projectionButton.type="button",this.projectionButton.addEventListener("click",this.toggleProjection.bind(this)),e.on("projectiontransition",this.updateProjectionIcon.bind(this)),this.updateProjectionIcon(),this.container}onRemove(){f2(this.container),this.map.off("projectiontransition",this.updateProjectionIcon),this.map=void 0}toggleProjection(){this.map.getProjection()===void 0&&this.map.setProjection({type:"mercator"}),this.map.isGlobeProjection()?this.map.enableMercatorProjection():this.map.enableGlobeProjection(),this.updateProjectionIcon()}updateProjectionIcon(){this.projectionButton.classList.remove("maplibregl-ctrl-projection-globe"),this.projectionButton.classList.remove("maplibregl-ctrl-projection-mercator"),this.map.isGlobeProjection()?(this.projectionButton.classList.add("maplibregl-ctrl-projection-mercator"),this.projectionButton.title="Enable Mercator projection"):(this.projectionButton.classList.add("maplibregl-ctrl-projection-globe"),this.projectionButton.title="Enable Globe projection")}}const qB="3.3.0",$B={version:qB};class GB{constructor(e,t=2e3){$n(this,"map"),$n(this,"registeredModules",new Set),this.map=e,setTimeout(async()=>{if(!Za.telemetry)return;const a=this.preparePayload();try{(await fetch(a,{method:"POST"})).ok||console.warn("The metrics could not be sent to MapTiler Cloud")}catch(d){console.warn("The metrics could not be sent to MapTiler Cloud",d)}},Math.max(1e3,t))}registerModule(e,t){this.registeredModules.add(`${e}:${t}`)}preparePayload(){const e=new URL(Po.telemetryURL);return e.searchParams.append("sdk",$B.version),e.searchParams.append("key",Za.apiKey),e.searchParams.append("mtsid",Gw),e.searchParams.append("session",Za.session?"1":"0"),e.searchParams.append("caching",Za.caching?"1":"0"),e.searchParams.append("lang-updated",this.map.isLanguageUpdated()?"1":"0"),e.searchParams.append("terrain",this.map.getTerrain()?"1":"0"),e.searchParams.append("globe",this.map.isGlobeProjection()?"1":"0"),this.registeredModules.size>0&&e.searchParams.append("modules",Array.from(this.registeredModules).join("|")),e.href}}const HB={POINT:"POINT",COUNTRY:"COUNTRY"};let FM=class VM extends un.Map{constructor(e){lN(e.container),e.apiKey&&(Za.apiKey=e.apiKey);const{style:t,requiresUrlMonitoring:a,isFallback:d}=rE(e.style);d&&console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style."),Za.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");const m=location.hash;let y={compact:!1};e.customAttribution?y.customAttribution=e.customAttribution:e.attributionControl&&typeof e.attributionControl=="object"&&(y={...y,...e.attributionControl});const c={...e,style:t,maplibreLogo:!1,transformRequest:LS(e.transformRequest),attributionControl:e.forceNoAttributionControl===!0?!1:y};delete c.style,super(c),$n(this,"options"),$n(this,"telemetry"),$n(this,"isTerrainEnabled",!1),$n(this,"terrainExaggeration",1),$n(this,"primaryLanguage"),$n(this,"terrainGrowing",!1),$n(this,"terrainFlattening",!1),$n(this,"minimap"),$n(this,"forceLanguageUpdate"),$n(this,"languageAlwaysBeenStyle"),$n(this,"isReady",!1),$n(this,"terrainAnimationDuration",1e3),$n(this,"monitoredStyleUrls"),$n(this,"styleInProcess",!1),$n(this,"curentProjection"),$n(this,"originalLabelStyle",new window.Map),$n(this,"isStyleLocalized",!1),$n(this,"languageIsUpdated",!1),this.options=e,this.setStyle(t),a&&this.monitorStyleUrl(t);const M=()=>{let W="The distant style could not be loaded.";this.getStyle()?W+="Leaving the style as is.":(this.setStyle(e_.STREETS),W+=`Loading default MapTiler Cloud style "${e_.STREETS.getDefaultVariant().getId()}" as a fallback.`),console.warn(W)};if(this.on("style.load",()=>{this.styleInProcess=!1}),this.on("error",W=>{if(W.error instanceof un.AJAXError){const re=W.error.url,Me=new URL(re);Me.search="";const Ce=Me.href;this.monitoredStyleUrls&&this.monitoredStyleUrls.has(Ce)&&(this.monitoredStyleUrls.delete(Ce),M());return}if(this.styleInProcess){M();return}}),Za.caching&&!o1&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),Za.caching&&o1&&iN(),typeof e.language>"u")this.primaryLanguage=Za.primaryLanguage;else{const W=bS(e.language,xr);this.primaryLanguage=W??Za.primaryLanguage}this.forceLanguageUpdate=!(this.primaryLanguage===xr.STYLE||this.primaryLanguage===xr.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===xr.STYLE,this.terrainExaggeration=e.terrainExaggeration??this.terrainExaggeration,this.curentProjection=e.projection,this.on("styledata",()=>{this.curentProjection==="mercator"?this.setProjection({type:"mercator"}):this.curentProjection==="globe"&&this.setProjection({type:"globe"})}),this.once("styledata",async()=>{if(!e.geolocate||e.center||e.hash&&m)return;try{if(e.geolocate===HB.COUNTRY){await this.fitToIpBounds();return}}catch(re){console.warn(re.message)}let W;try{await this.centerOnIpPoint(e.zoom),W=this.getCameraHash()}catch(re){console.warn(re.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(re=>{W===this.getCameraHash()&&(this.terrain?this.easeTo({center:[re.coords.longitude,re.coords.latitude],zoom:e.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[re.coords.longitude,re.coords.latitude],zoom:e.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let W={logo:null};try{const re=Object.keys(this.style.sourceCaches).map(Ce=>this.getSource(Ce)).filter(Ce=>Ce&&"url"in Ce&&typeof Ce.url=="string"&&Ce.url.includes("tiles.json")),Me=new URL(re[0].url);Me.searchParams.has("key")||Me.searchParams.append("key",Za.apiKey),W=await(await fetch(Me.href)).json()}catch{}if(e.forceNoAttributionControl!==!0)if("logo"in W&&W.logo){const re=W.logo;this.addControl(new OS({logoURL:re}),e.logoPosition)}else e.maptilerLogo&&this.addControl(new OS,e.logoPosition);if(e.scaleControl){const re=e.scaleControl===!0||e.scaleControl===void 0?"bottom-right":e.scaleControl,Me=new xN({unit:Za.unit});this.addControl(Me,re),Za.on("unit",Ce=>{Me.setUnit(Ce)})}if(e.navigationControl!==!1){const re=e.navigationControl===!0||e.navigationControl===void 0?"top-right":e.navigationControl;this.addControl(new FB,re)}if(e.geolocateControl!==!1){const re=e.geolocateControl===!0||e.geolocateControl===void 0?"top-right":e.geolocateControl;this.addControl(new jB({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),re)}if(e.terrainControl){const re=e.terrainControl===!0||e.terrainControl===void 0?"top-right":e.terrainControl;this.addControl(new BB,re)}if(e.projectionControl){const re=e.projectionControl===!0||e.projectionControl===void 0?"top-right":e.projectionControl;this.addControl(new UB,re)}if(e.fullscreenControl){const re=e.fullscreenControl===!0||e.fullscreenControl===void 0?"top-right":e.fullscreenControl;this.addControl(new wN({}),re)}this.isReady=!0,this.fire("ready",{target:this})});let R=!1,B=!1,K;this.once("ready",()=>{R=!0,B&&this.fire("loadWithTerrain",K)}),this.once("style.load",()=>{const{minimap:W}=e;if(typeof W=="object"){const{zoom:re,center:Me,style:Ce,language:Be,apiKey:He,maptilerLogo:ut,canvasContextAttributes:Ue,refreshExpiredTiles:Fe,maxBounds:Ze,scrollZoom:me,minZoom:se,maxZoom:ye,boxZoom:we,locale:Ee,fadeDuration:ke,crossSourceCollisions:ve,clickTolerance:Bt,bounds:Kt,fitBoundsOptions:et,pixelRatio:Mt,validateStyle:Tt}=e;this.minimap=new gx(W,{zoom:re,center:Me,style:Ce,language:Be,apiKey:He,container:"null",maptilerLogo:ut,canvasContextAttributes:Ue,refreshExpiredTiles:Fe,maxBounds:Ze,scrollZoom:me,minZoom:se,maxZoom:ye,boxZoom:we,locale:Ee,fadeDuration:ke,crossSourceCollisions:ve,clickTolerance:Bt,bounds:Kt,fitBoundsOptions:et,pixelRatio:Mt,validateStyle:Tt}),this.addControl(this.minimap,W.position??"bottom-left")}else W===!0?(this.minimap=new gx({},e),this.addControl(this.minimap,"bottom-left")):W!==void 0&&W!==!1&&(this.minimap=new gx({},e),this.addControl(this.minimap,W))});const $=W=>{W.terrain&&(B=!0,K={type:"loadWithTerrain",target:this,terrain:W.terrain},this.off("terrain",$),R&&this.fire("loadWithTerrain",K))};this.on("terrain",$),e.terrain&&this.enableTerrain(e.terrainExaggeration??this.terrainExaggeration),this.once("load",()=>{this.getCanvas().addEventListener("webglcontextlost",W=>{if(this._removed===!0){console.warn("[webglcontextlost]","WebGL context lost after map removal. This is harmless.");return}console.warn("[webglcontextlost]","Unexpected loss of WebGL context!"),this.fire("webglContextLost",W)})}),this.telemetry=new GB(this)}recreate(){const e={center:this.getCenter(),zoom:this.getZoom(),bearing:this.getBearing(),pitch:this.getPitch()};this.remove(),Object.assign(this,new VM({...this.options})),this.once("load",()=>{this.jumpTo(e)})}setTerrainAnimationDuration(e){this.terrainAnimationDuration=Math.max(e,0)}async onLoadAsync(){return new Promise(e=>{if(this.loaded()){e(this);return}this.once("load",()=>{e(this)})})}async onReadyAsync(){return new Promise(e=>{if(this.isReady){e(this);return}this.once("ready",()=>{e(this)})})}async onLoadWithTerrainAsync(){return new Promise(e=>{if(this.isReady&&this.terrain){e(this);return}this.once("loadWithTerrain",()=>{e(this)})})}monitorStyleUrl(e){typeof this.monitoredStyleUrls>"u"&&(this.monitoredStyleUrls=new Set);const t=new URL(e);t.search="",this.monitoredStyleUrls.add(t.href)}setStyle(e,t){var a;this.originalLabelStyle.clear(),(a=this.minimap)==null||a.setStyle(e),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1});const d=rE(e);if(d.requiresUrlMonitoring&&this.monitorStyleUrl(d.style),d.isFallback){if(this.getStyle())return console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Keeping the curent style instead."),this;console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style.")}return this.styleInProcess=!0,super.setStyle(d.style,t),this}addLayer(e,t){var a;return(a=this.minimap)==null||a.addLayer(e,t),super.addLayer(e,t)}moveLayer(e,t){var a;return(a=this.minimap)==null||a.moveLayer(e,t),super.moveLayer(e,t)}removeLayer(e){var t;return(t=this.minimap)==null||t.removeLayer(e),super.removeLayer(e)}setLayerZoomRange(e,t,a){var d;return(d=this.minimap)==null||d.setLayerZoomRange(e,t,a),super.setLayerZoomRange(e,t,a)}setFilter(e,t,a){var d;return(d=this.minimap)==null||d.setFilter(e,t,a),super.setFilter(e,t,a)}setPaintProperty(e,t,a,d){var m;return(m=this.minimap)==null||m.setPaintProperty(e,t,a,d),super.setPaintProperty(e,t,a,d)}setLayoutProperty(e,t,a,d){var m;return(m=this.minimap)==null||m.setLayoutProperty(e,t,a,d),super.setLayoutProperty(e,t,a,d)}setGlyphs(e,t){var a;return(a=this.minimap)==null||a.setGlyphs(e,t),super.setGlyphs(e,t)}getStyleLanguage(){return!this.style||!this.style.stylesheet||!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?n1(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(e){var t;(t=this.minimap)==null||t.map.setLanguage(e),this.onStyleReady(()=>{this.setPrimaryLanguage(e)})}setPrimaryLanguage(e){const t=this.getStyleLanguage(),a=bS(e,xr);if(!a){console.warn(`The language "${a}" is not supported.`);return}if(!(a.flag===xr.STYLE.flag&&t&&(t.flag===xr.AUTO.flag||t.flag===xr.VISITOR.flag))&&(a.flag!==xr.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===a&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===xr.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=a;let d=a;if(a.flag===xr.STYLE.flag){if(!t){console.warn("The style has no default languages or has an invalid one.");return}d=t}let m=xr.LOCAL.flag,y=["get",m];d.flag===xr.VISITOR.flag?(m=PS().flag,y=["case",["all",["has",m],["has",xr.LOCAL.flag]],["case",["==",["get",m],["get",xr.LOCAL.flag]],["get",xr.LOCAL.flag],["format",["get",m],{"font-scale":.8},`
`,["get",xr.LOCAL.flag],{"font-scale":1.1}]],["get",xr.LOCAL.flag]]):d.flag===xr.VISITOR_ENGLISH.flag?(m=xr.ENGLISH.flag,y=["case",["all",["has",m],["has",xr.LOCAL.flag]],["case",["==",["get",m],["get",xr.LOCAL.flag]],["get",xr.LOCAL.flag],["format",["get",m],{"font-scale":.8},`
`,["get",xr.LOCAL.flag],{"font-scale":1.1}]],["get",xr.LOCAL.flag]]):d.flag===xr.AUTO.flag?(m=PS().flag,y=["coalesce",["get",m],["get",xr.LOCAL.flag]]):d===xr.LOCAL?(m=xr.LOCAL.flag,y=["get",m]):(m=d.flag,y=["coalesce",["get",m],["get",xr.LOCAL.flag]]);const{layers:c}=this.getStyle(),M=this.originalLabelStyle.size===0;if(M){const R=mN(c,this);this.isStyleLocalized=Object.keys(R.localized).length>0}for(const R of c){if(R.type!=="symbol")continue;const B=R,K=this.getSource(B.source);if(!K||!("url"in K&&typeof K.url=="string")||new URL(K.url).host!==Po.maptilerApiHost)continue;const{id:$,layout:W}=B;if(!W||!("text-field"in W))continue;let re;if(M?(re=this.getLayoutProperty($,"text-field"),this.originalLabelStyle.set($,re)):re=this.originalLabelStyle.get($),typeof re=="string"){const{contains:Me,exactMatch:Ce}=cN(re,this.isStyleLocalized);if(!Me)continue;if(Ce)this.setLayoutProperty($,"text-field",y);else{const Be=hN(re,y,this.isStyleLocalized);this.setLayoutProperty($,"text-field",Be)}}else{const Me=uN(re,y,this.isStyleLocalized);this.setLayoutProperty($,"text-field",Me)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(e){if(!this.terrain)return;const t=performance.now(),a=this.terrain.exaggeration,d=e-a,m=()=>{if(!this.terrain||this.terrainFlattening)return;const y=(performance.now()-t)/this.terrainAnimationDuration;if(y<.99){const c=1-(1-y)**4,M=a+c*d;this.terrain.exaggeration=M,requestAnimationFrame(m)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=e,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(m)}enableTerrain(e=this.terrainExaggeration){if(e<0){console.warn("Terrain exaggeration cannot be negative.");return}const t=d=>{!this.terrain||d.type!=="data"||d.dataType!=="source"||!("source"in d)||d.sourceId!=="maptiler-terrain"||d.source.type!=="raster-dem"||d.isSourceLoaded&&(this.off("data",t),this.growTerrain(e))},a=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=e,this.on("data",t),this.addSource(Po.terrainSourceId,{type:"raster-dem",url:Po.terrainSourceURL}),this.setTerrain({source:Po.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(e);return}this.loaded()||this.isTerrainEnabled?a():this.once("load",()=>{this.getTerrain()&&this.getSource(Po.terrainSourceId)||a()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const e=performance.now(),t=this.terrain.exaggeration,a=()=>{if(!this.terrain||this.terrainGrowing)return;const d=(performance.now()-e)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,d<.99){const m=(1-d)**4,y=t*m;this.terrain.exaggeration=y,requestAnimationFrame(a)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Po.terrainSourceId)&&this.removeSource(Po.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(a)}setTerrainExaggeration(e,t=!0){!t&&this.terrain?(this.terrainExaggeration=e,this.terrain.exaggeration=e,this.triggerRepaint()):this.enableTerrain(e)}onStyleReady(e){this.isStyleLoaded()?e():this.once("styledata",()=>{e()})}async fitToIpBounds(){const e=await wS.info();this.fitBounds(e.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(e){const t=await wS.info();this.jumpTo({center:[t.longitude??0,t.latitude??0],zoom:e||11})}getCameraHash(){const e=new Float32Array(5),t=this.getCenter();return e[0]=t.lng,e[1]=t.lat,e[2]=this.getZoom(),e[3]=this.getPitch(),e[4]=this.getBearing(),K4.fromUint8Array(new Uint8Array(e.buffer))}getSdkConfig(){return Za}getMaptilerSessionId(){return Gw}setTransformRequest(e){return super.setTransformRequest(LS(e)),this}isGlobeProjection(){const e=this.getProjection();return e?e.type==="globe":!1}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}};function Vv(r){const e=r.toString(16);return e.length===1?`0${e}`:e}function ZB(r){return`#${Vv(r[0])}${Vv(r[1])}${Vv(r[2])}${r.length===4?Vv(r[3]):""}`}let Pn=class Hm extends Array{constructor(e={}){super(),$n(this,"min",0),$n(this,"max",1),"min"in e&&(this.min=e.min),"max"in e&&(this.max=e.max),"stops"in e&&this.setStops(e.stops,{clone:!1})}static fromArrayDefinition(e){return new Hm({stops:e.map(t=>({value:t[0],color:t[1]}))})}setStops(e,t={clone:!0}){const a=t.clone?this.clone():this;a.length=0;let d=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY;for(let y=0;y<e.length;y+=1)d=Math.min(d,e[y].value),m=Math.max(m,e[y].value),a.push({value:e[y].value,color:e[y].color.slice()});return a.sort((y,c)=>y.value<c.value?-1:1),this.min=d,this.max=m,a}scale(e,t,a={clone:!0}){const d=a.clone,m=this[0].value,y=this.at(-1).value-m,c=t-e,M=[];for(let R=0;R<this.length;R+=1){const B=(this[R].value-m)/y*c+e;d?M.push({value:B,color:this[R].color.slice()}):this[R].value=B}return d?new Hm({stops:M}):this}at(e){return e<0?this[this.length+e]:this[e]}clone(){return new Hm({stops:this.getRawColorStops()})}getRawColorStops(){const e=[];for(let t=0;t<this.length;t+=1)e.push({value:this[t].value,color:this[t].color});return e}reverse(e={clone:!0}){const t=e.clone?this.clone():this;for(let a=0;a<~~(t.length/2);a+=1){const d=t[a].color;t[a].color=t.at(-(a+1)).color,t.at(-(a+1)).color=d}return t}getBounds(){return{min:this.min,max:this.max}}getColor(e,t={smooth:!0}){if(e<=this[0].value)return this[0].color;if(e>=this.at(-1).value)return this.at(-1).color;for(let a=0;a<this.length-1;a+=1){if(e>this[a+1].value)continue;const d=this[a].color;if(!t.smooth)return d.slice();const m=this[a].value,y=this[a+1].value,c=this[a+1].color,M=(y-e)/(y-m);return d.map((R,B)=>Math.round(R*M+c[B]*(1-M)))}return[0,0,0]}getColorHex(e,t={smooth:!0,withAlpha:!1}){return ZB(this.getColor(e,t))}getColorRelative(e,t={smooth:!0}){const a=this.getBounds();return this.getColor(a.min+e*(a.max-a.min),t)}getCanvasStrip(e={horizontal:!0,size:512,smooth:!0}){const t=document.createElement("canvas");t.width=e.horizontal?e.size:1,t.height=e.horizontal?1:e.size;const a=t.getContext("2d");if(!a)throw new Error("Canvs context is missing");const d=a.getImageData(0,0,t.width,t.height),m=d.data,y=e.size,c=this[0].value,M=(this.at(-1).value-c)/y;for(let R=0;R<y;R+=1){const B=this.getColor(c+R*M,{smooth:e.smooth});m[R*4]=B[0],m[R*4+1]=B[1],m[R*4+2]=B[2],m[R*4+3]=B.length>3?B[3]:255}return a.putImageData(d,0,0),t}resample(e,t=15){const a=this.getBounds(),d=this.scale(0,1),m=1/(t-1);let y;if(e==="ease-in-square")y=Array.from({length:t},(c,M)=>{const R=M*m,B=R**2,K=d.getColor(B);return{value:R,color:K}});else if(e==="ease-out-square")y=Array.from({length:t},(c,M)=>{const R=M*m,B=1-(1-R)**2,K=d.getColor(B);return{value:R,color:K}});else if(e==="ease-out-sqrt")y=Array.from({length:t},(c,M)=>{const R=M*m,B=R**.5,K=d.getColor(B);return{value:R,color:K}});else if(e==="ease-in-sqrt")y=Array.from({length:t},(c,M)=>{const R=M*m,B=1-(1-R)**.5,K=d.getColor(B);return{value:R,color:K}});else if(e==="ease-out-exp")y=Array.from({length:t},(c,M)=>{const R=M*m,B=1-2**(-10*R),K=d.getColor(B);return{value:R,color:K}});else if(e==="ease-in-exp")y=Array.from({length:t},(c,M)=>{const R=M*m,B=2**(10*R-10),K=d.getColor(B);return{value:R,color:K}});else throw new Error("Invalid ressampling method.");return new Hm({stops:y}).scale(a.min,a.max)}transparentStart(){const e=this.getRawColorStops();e.unshift({value:e[0].value,color:e[0].color.slice()}),e[1].value+=.001;for(const t of e)t.color.length===3&&t.color.push(255);return e[0].color[3]=0,new Hm({stops:e})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}};new Pn({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),new Pn({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new Pn({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),new Pn({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),new Pn({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),new Pn({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),new Pn({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),new Pn({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),new Pn({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),new Pn({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),new Pn({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),new Pn({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new Pn({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),new Pn({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),new Pn({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),new Pn({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),new Pn({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),new Pn({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),new Pn({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),new Pn({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),new Pn({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),new Pn({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),new Pn({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),new Pn({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),new Pn({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),new Pn({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),new Pn({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),new Pn({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),new Pn({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),new Pn({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),new Pn({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),new Pn({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),new Pn({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),new Pn({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),new Pn({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),new Pn({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),new Pn({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),new Pn({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),new Pn({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),new Pn({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),new Pn({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),new Pn({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),new Pn({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),new Pn({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),new Pn({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),new Pn({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),new Pn({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),new Pn({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),new Pn({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]});aN();un.Map;un.Marker;un.Popup;un.Style;un.CanvasSource;un.GeoJSONSource;un.ImageSource;un.RasterTileSource;un.RasterDEMTileSource;un.VectorTileSource;un.VideoSource;un.NavigationControl;un.GeolocateControl;un.AttributionControl;un.LogoControl;un.ScaleControl;un.FullscreenControl;un.TerrainControl;un.BoxZoomHandler;un.ScrollZoomHandler;un.CooperativeGesturesHandler;un.KeyboardHandler;un.TwoFingersTouchPitchHandler;un.MapWheelEvent;un.MapTouchEvent;un.MapMouseEvent;un.config;un.getVersion;const{setRTLTextPlugin:Wj,getRTLTextPluginStatus:Kj,LngLat:Xj,LngLatBounds:Yj,MercatorCoordinate:Qj,Evented:Jj,AJAXError:eU,prewarm:tU,clearPrewarmedResources:nU,Hash:rU,Point:iU,EdgeInsets:aU,DragRotateHandler:sU,DragPanHandler:oU,TwoFingersTouchZoomRotateHandler:lU,DoubleClickZoomHandler:uU,TwoFingersTouchZoomHandler:cU,TwoFingersTouchRotateHandler:hU,getWorkerCount:dU,setWorkerCount:fU,getMaxParallelImageRequests:pU,setMaxParallelImageRequests:mU,getWorkerUrl:gU,setWorkerUrl:yU,addSourceType:_U,importScriptInWorkers:vU,addProtocol:bU,removeProtocol:xU}=un;function WB(){const[r,e]=We.useState([]),[t,a]=We.useState([]),[d,m]=We.useState(!0),[y,c]=We.useState(null),[M,R]=We.useState(null),[B,K]=We.useState(""),[$,W]=We.useState(0),[re,Me]=We.useState(0),[Ce,Be]=We.useState(!1),He=We.useRef(null),ut=We.useRef(null),Ue=We.useRef({}),Fe="Tx0tJslnlndsHe3hs95w",Ze=5,me=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),se=Ee=>{const ke=[...Ee];for(let ve=ke.length-1;ve>0;ve--){const Bt=Math.floor(Math.random()*(ve+1));[ke[ve],ke[Bt]]=[ke[Bt],ke[ve]]}return ke},ye=()=>{Be(Ee=>!Ee)};We.useEffect(()=>{let Ee=!0;return(async()=>{try{const Bt=(await Tg(ad(La,"Airports"))).docs.map(Kt=>({id:Kt.id,...Kt.data()}));if(Ee){if(e(Bt),Bt.length>0){const Kt=se(Bt);a(Kt),R(Kt[0]),Me(1)}else console.warn("Nincsenek replterek az adatbzisban."),c("Nincsenek replterek az adatbzisban.");m(!1)}}catch(ve){Ee&&(console.error("Hiba a replterek betltsekor:",ve),c("Nem sikerlt betlteni a repltereket: "+ve.message),m(!1))}})(),()=>{Ee=!1}},[]),We.useEffect(()=>{if(!(!He.current||r.length===0))return Za.apiKey=Fe,ut.current=new FM({container:He.current,style:"https://api.maptiler.com/maps/01974fe0-7e99-7127-b3bd-efa9385fdb1e/style.json?key=Tx0tJslnlndsHe3hs95w",center:[0,20],zoom:2}),r.forEach(Ee=>{const{Lat:ke,Long:ve,"ICAO Code":Bt,Airport:Kt}=Ee;if(ke&&ve){const et=new yN({offset:25}).setHTML(`<h3>${Bt}</h3><p>${Kt}</p>`),Mt=document.createElement("div");Mt.style.backgroundColor="red",Mt.style.width="12px",Mt.style.height="12px",Mt.style.borderRadius="50%",Mt.style.border="2px solid white",Mt.style.cursor="pointer";const Tt=new gN({element:Mt}).setLngLat([parseFloat(ve),parseFloat(ke)]).setPopup(et).addTo(ut.current);Ue.current[Bt]={marker:Tt,element:Mt},Tt.getElement().addEventListener("click",()=>{M&&Bt===M["ICAO Code"]&&(Mt.style.backgroundColor="green",ut.current.flyTo({center:[parseFloat(ve),me?parseFloat(ke)-2:parseFloat(ke)],zoom:Ze,duration:2e3}),ut.current.once("moveend",()=>{const Gt=re;if(Gt<t.length)R(t[Gt]),Me(Re=>Re+1);else{const Re=se(r);a(Re),R(Re[0]),Me(1)}}))})}}),()=>{ut.current&&ut.current.remove()}},[r]);const we=Ee=>{var Bt;Ee.preventDefault();const ke=B.trim().toLowerCase(),ve=Ce?M==null?void 0:M["ICAO Code"].toLowerCase():M==null?void 0:M.Airport.toLowerCase();if(ke===ve){const Kt=r.find(et=>et["ICAO Code"]===M["ICAO Code"]);if(Kt&&Kt.Lat&&Kt.Long){const et=(Bt=Ue.current[Kt["ICAO Code"]])==null?void 0:Bt.element;et&&(et.style.backgroundColor="green"),ut.current.flyTo({center:[parseFloat(Kt.Long),me?parseFloat(Kt.Lat)-2:parseFloat(Kt.Lat)],zoom:Ze,duration:2e3}),ut.current.once("moveend",()=>{const Mt=re;if(Mt<t.length)R(t[Mt]),Me(Tt=>Tt+1);else{Object.values(Ue.current).forEach(({element:Gt})=>{Gt.style.backgroundColor="red"});const Tt=se(r);a(Tt),R(Tt[0]),Me(1),W(0)}})}}else W(Kt=>Kt+1);K("")};return d?de.jsx("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:de.jsx("p",{children:"Betlts..."})}):y?de.jsx("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:de.jsx("p",{className:"text-red-500",children:y})}):de.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gray-100",children:de.jsxs("div",{className:"relative w-full max-w-7xl p-4",children:[M&&de.jsxs("div",{className:"absolute top-8 left-1/2 transform -translate-x-1/2 bg-white p-4 rounded-lg shadow z-10 flex flex-col items-center gap-2",children:[de.jsx("button",{onClick:ye,className:"absolute top-2 left-2 bg-white p-2 rounded-lg shadow z-10 hover:bg-gray-300 transition-colors",title:"Krds sorrend vltsa",children:de.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:de.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),de.jsx("p",{className:"text-lg font-bold text-center",children:Ce?M.Airport:M["ICAO Code"]}),de.jsxs("form",{onSubmit:we,className:"flex gap-2",children:[de.jsx("input",{type:"text",value:B,onChange:Ee=>K(Ee.target.value),placeholder:Ce?"rd be az ICAO kdot!":"rd be a repltr nevt!",className:"p-2 border rounded",autoFocus:!0}),de.jsx("button",{type:"submit",className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Ellenrzs"})]})]}),de.jsxs("div",{className:"relative w-full h-[800px] rounded-lg shadow",children:[de.jsx("div",{ref:He,className:"w-full h-full"}),de.jsx("div",{className:"absolute bottom-4 left-4 bg-white p-2 rounded-lg shadow z-10",children:de.jsxs("p",{className:"text-lg font-bold text-red-600",children:["Hibk: ",$]})}),de.jsx("div",{className:"absolute bottom-4 right-4 bg-white p-2 rounded-lg shadow z-10",children:de.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[re,"/",r.length]})})]})]})})}/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */function KB(r,e,t){return(e=YB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function sE(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),t.push.apply(t,a)}return t}function Ft(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sE(Object(t),!0).forEach(function(a){KB(r,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):sE(Object(t)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(t,a))})}return r}function XB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var a=t.call(r,e);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function YB(r){var e=XB(r,"string");return typeof e=="symbol"?e:e+""}const oE=()=>{};let p2={},jM={},UM=null,qM={mark:oE,measure:oE};try{typeof window<"u"&&(p2=window),typeof document<"u"&&(jM=document),typeof MutationObserver<"u"&&(UM=MutationObserver),typeof performance<"u"&&(qM=performance)}catch{}const{userAgent:lE=""}=p2.navigator||{},bf=p2,Pi=jM,uE=UM,jv=qM;bf.document;const hd=!!Pi.documentElement&&!!Pi.head&&typeof Pi.addEventListener=="function"&&typeof Pi.createElement=="function",$M=~lE.indexOf("MSIE")||~lE.indexOf("Trident/");var QB=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,JB=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,GM={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},eF={GROUP:"duotone-group",PRIMARY:"primary",SECONDARY:"secondary"},HM=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],io="classic",Eb="duotone",tF="sharp",nF="sharp-duotone",ZM=[io,Eb,tF,nF],rF={classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}},iF={"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}},aF=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),sF={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}},oF=["fak","fa-kit","fakd","fa-kit-duotone"],cE={kit:{fak:"kit","fa-kit":"kit"},"kit-duotone":{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"}},lF=["kit"],uF={kit:{"fa-kit":"fak"}},cF=["fak","fakd"],hF={kit:{fak:"fa-kit"}},hE={kit:{kit:"fak"},"kit-duotone":{"kit-duotone":"fakd"}},Uv={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},dF=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],fF=["fak","fa-kit","fakd","fa-kit-duotone"],pF={"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},mF={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}},gF={classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]},g1={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},yF=["fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],y1=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt",...dF,...yF],_F=["solid","regular","light","thin","duotone","brands"],WM=[1,2,3,4,5,6,7,8,9,10],vF=WM.concat([11,12,13,14,15,16,17,18,19,20]),bF=[...Object.keys(gF),..._F,"2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",Uv.GROUP,Uv.SWAP_OPACITY,Uv.PRIMARY,Uv.SECONDARY].concat(WM.map(r=>"".concat(r,"x"))).concat(vF.map(r=>"w-".concat(r))),xF={"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}};const od="___FONT_AWESOME___",_1=16,KM="fa",XM="svg-inline--fa",$p="data-fa-i2svg",v1="data-fa-pseudo-element",wF="data-fa-pseudo-element-pending",m2="data-prefix",g2="data-icon",dE="fontawesome-i2svg",TF="async",SF=["HTML","HEAD","STYLE","SCRIPT"],YM=(()=>{try{return!0}catch{return!1}})();function H_(r){return new Proxy(r,{get(e,t){return t in e?e[t]:e[io]}})}const QM=Ft({},GM);QM[io]=Ft(Ft(Ft(Ft({},{"fa-duotone":"duotone"}),GM[io]),cE.kit),cE["kit-duotone"]);const EF=H_(QM),b1=Ft({},sF);b1[io]=Ft(Ft(Ft(Ft({},{duotone:"fad"}),b1[io]),hE.kit),hE["kit-duotone"]);const fE=H_(b1),x1=Ft({},g1);x1[io]=Ft(Ft({},x1[io]),hF.kit);const y2=H_(x1),w1=Ft({},mF);w1[io]=Ft(Ft({},w1[io]),uF.kit);H_(w1);const AF=QB,JM="fa-layers-text",CF=JB,IF=Ft({},rF);H_(IF);const MF=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],yx=eF,PF=[...lF,...bF],r_=bf.FontAwesomeConfig||{};function RF(r){var e=Pi.querySelector("script["+r+"]");if(e)return e.getAttribute(r)}function kF(r){return r===""?!0:r==="false"?!1:r==="true"?!0:r}Pi&&typeof Pi.querySelector=="function"&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(e=>{let[t,a]=e;const d=kF(RF(t));d!=null&&(r_[a]=d)});const eP={styleDefault:"solid",familyDefault:io,cssPrefix:KM,replacementClass:XM,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};r_.familyPrefix&&(r_.cssPrefix=r_.familyPrefix);const pg=Ft(Ft({},eP),r_);pg.autoReplaceSvg||(pg.observeMutations=!1);const pn={};Object.keys(eP).forEach(r=>{Object.defineProperty(pn,r,{enumerable:!0,set:function(e){pg[r]=e,i_.forEach(t=>t(pn))},get:function(){return pg[r]}})});Object.defineProperty(pn,"familyPrefix",{enumerable:!0,set:function(r){pg.cssPrefix=r,i_.forEach(e=>e(pn))},get:function(){return pg.cssPrefix}});bf.FontAwesomeConfig=pn;const i_=[];function DF(r){return i_.push(r),()=>{i_.splice(i_.indexOf(r),1)}}const tf=_1,nh={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function LF(r){if(!r||!hd)return;const e=Pi.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=r;const t=Pi.head.childNodes;let a=null;for(let d=t.length-1;d>-1;d--){const m=t[d],y=(m.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(y)>-1&&(a=m)}return Pi.head.insertBefore(e,a),r}const zF="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function S_(){let r=12,e="";for(;r-- >0;)e+=zF[Math.random()*62|0];return e}function Cg(r){const e=[];for(let t=(r||[]).length>>>0;t--;)e[t]=r[t];return e}function _2(r){return r.classList?Cg(r.classList):(r.getAttribute("class")||"").split(" ").filter(e=>e)}function tP(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function OF(r){return Object.keys(r||{}).reduce((e,t)=>e+"".concat(t,'="').concat(tP(r[t]),'" '),"").trim()}function Ab(r){return Object.keys(r||{}).reduce((e,t)=>e+"".concat(t,": ").concat(r[t].trim(),";"),"")}function v2(r){return r.size!==nh.size||r.x!==nh.x||r.y!==nh.y||r.rotate!==nh.rotate||r.flipX||r.flipY}function NF(r){let{transform:e,containerWidth:t,iconWidth:a}=r;const d={transform:"translate(".concat(t/2," 256)")},m="translate(".concat(e.x*32,", ").concat(e.y*32,") "),y="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),c="rotate(".concat(e.rotate," 0 0)"),M={transform:"".concat(m," ").concat(y," ").concat(c)},R={transform:"translate(".concat(a/2*-1," -256)")};return{outer:d,inner:M,path:R}}function BF(r){let{transform:e,width:t=_1,height:a=_1,startCentered:d=!1}=r,m="";return d&&$M?m+="translate(".concat(e.x/tf-t/2,"em, ").concat(e.y/tf-a/2,"em) "):d?m+="translate(calc(-50% + ".concat(e.x/tf,"em), calc(-50% + ").concat(e.y/tf,"em)) "):m+="translate(".concat(e.x/tf,"em, ").concat(e.y/tf,"em) "),m+="scale(".concat(e.size/tf*(e.flipX?-1:1),", ").concat(e.size/tf*(e.flipY?-1:1),") "),m+="rotate(".concat(e.rotate,"deg) "),m}var FF=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}`;function nP(){const r=KM,e=XM,t=pn.cssPrefix,a=pn.replacementClass;let d=FF;if(t!==r||a!==e){const m=new RegExp("\\.".concat(r,"\\-"),"g"),y=new RegExp("\\--".concat(r,"\\-"),"g"),c=new RegExp("\\.".concat(e),"g");d=d.replace(m,".".concat(t,"-")).replace(y,"--".concat(t,"-")).replace(c,".".concat(a))}return d}let pE=!1;function _x(){pn.autoAddCss&&!pE&&(LF(nP()),pE=!0)}var VF={mixout(){return{dom:{css:nP,insertCss:_x}}},hooks(){return{beforeDOMElementCreation(){_x()},beforeI2svg(){_x()}}}};const ld=bf||{};ld[od]||(ld[od]={});ld[od].styles||(ld[od].styles={});ld[od].hooks||(ld[od].hooks={});ld[od].shims||(ld[od].shims=[]);var rh=ld[od];const rP=[],iP=function(){Pi.removeEventListener("DOMContentLoaded",iP),O0=1,rP.map(r=>r())};let O0=!1;hd&&(O0=(Pi.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Pi.readyState),O0||Pi.addEventListener("DOMContentLoaded",iP));function jF(r){hd&&(O0?setTimeout(r,0):rP.push(r))}function Z_(r){const{tag:e,attributes:t={},children:a=[]}=r;return typeof r=="string"?tP(r):"<".concat(e," ").concat(OF(t),">").concat(a.map(Z_).join(""),"</").concat(e,">")}function mE(r,e,t){if(r&&r[e]&&r[e][t])return{prefix:e,iconName:t,icon:r[e][t]}}var vx=function(e,t,a,d){var m=Object.keys(e),y=m.length,c=t,M,R,B;for(a===void 0?(M=1,B=e[m[0]]):(M=0,B=a);M<y;M++)R=m[M],B=c(B,e[R],R,e);return B};function UF(r){const e=[];let t=0;const a=r.length;for(;t<a;){const d=r.charCodeAt(t++);if(d>=55296&&d<=56319&&t<a){const m=r.charCodeAt(t++);(m&64512)==56320?e.push(((d&1023)<<10)+(m&1023)+65536):(e.push(d),t--)}else e.push(d)}return e}function T1(r){const e=UF(r);return e.length===1?e[0].toString(16):null}function qF(r,e){const t=r.length;let a=r.charCodeAt(e),d;return a>=55296&&a<=56319&&t>e+1&&(d=r.charCodeAt(e+1),d>=56320&&d<=57343)?(a-55296)*1024+d-56320+65536:a}function gE(r){return Object.keys(r).reduce((e,t)=>{const a=r[t];return!!a.icon?e[a.iconName]=a.icon:e[t]=a,e},{})}function S1(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{skipHooks:a=!1}=t,d=gE(e);typeof rh.hooks.addPack=="function"&&!a?rh.hooks.addPack(r,gE(e)):rh.styles[r]=Ft(Ft({},rh.styles[r]||{}),d),r==="fas"&&S1("fa",e)}const{styles:E_,shims:$F}=rh,aP=Object.keys(y2),GF=aP.reduce((r,e)=>(r[e]=Object.keys(y2[e]),r),{});let b2=null,sP={},oP={},lP={},uP={},cP={};function HF(r){return~PF.indexOf(r)}function ZF(r,e){const t=e.split("-"),a=t[0],d=t.slice(1).join("-");return a===r&&d!==""&&!HF(d)?d:null}const hP=()=>{const r=a=>vx(E_,(d,m,y)=>(d[y]=vx(m,a,{}),d),{});sP=r((a,d,m)=>(d[3]&&(a[d[3]]=m),d[2]&&d[2].filter(c=>typeof c=="number").forEach(c=>{a[c.toString(16)]=m}),a)),oP=r((a,d,m)=>(a[m]=m,d[2]&&d[2].filter(c=>typeof c=="string").forEach(c=>{a[c]=m}),a)),cP=r((a,d,m)=>{const y=d[2];return a[m]=m,y.forEach(c=>{a[c]=m}),a});const e="far"in E_||pn.autoFetchSvg,t=vx($F,(a,d)=>{const m=d[0];let y=d[1];const c=d[2];return y==="far"&&!e&&(y="fas"),typeof m=="string"&&(a.names[m]={prefix:y,iconName:c}),typeof m=="number"&&(a.unicodes[m.toString(16)]={prefix:y,iconName:c}),a},{names:{},unicodes:{}});lP=t.names,uP=t.unicodes,b2=Cb(pn.styleDefault,{family:pn.familyDefault})};DF(r=>{b2=Cb(r.styleDefault,{family:pn.familyDefault})});hP();function x2(r,e){return(sP[r]||{})[e]}function WF(r,e){return(oP[r]||{})[e]}function Pp(r,e){return(cP[r]||{})[e]}function dP(r){return lP[r]||{prefix:null,iconName:null}}function KF(r){const e=uP[r],t=x2("fas",r);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}function xf(){return b2}const fP=()=>({prefix:null,iconName:null,rest:[]});function XF(r){let e=io;const t=aP.reduce((a,d)=>(a[d]="".concat(pn.cssPrefix,"-").concat(d),a),{});return ZM.forEach(a=>{(r.includes(t[a])||r.some(d=>GF[a].includes(d)))&&(e=a)}),e}function Cb(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{family:t=io}=e,a=EF[t][r];if(t===Eb&&!r)return"fad";const d=fE[t][r]||fE[t][a],m=r in rh.styles?r:null;return d||m||null}function YF(r){let e=[],t=null;return r.forEach(a=>{const d=ZF(pn.cssPrefix,a);d?t=d:a&&e.push(a)}),{iconName:t,rest:e}}function yE(r){return r.sort().filter((e,t,a)=>a.indexOf(e)===t)}function Ib(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{skipLookups:t=!1}=e;let a=null;const d=y1.concat(fF),m=yE(r.filter(K=>d.includes(K))),y=yE(r.filter(K=>!y1.includes(K))),c=m.filter(K=>(a=K,!HM.includes(K))),[M=null]=c,R=XF(m),B=Ft(Ft({},YF(y)),{},{prefix:Cb(M,{family:R})});return Ft(Ft(Ft({},B),tV({values:r,family:R,styles:E_,config:pn,canonical:B,givenPrefix:a})),QF(t,a,B))}function QF(r,e,t){let{prefix:a,iconName:d}=t;if(r||!a||!d)return{prefix:a,iconName:d};const m=e==="fa"?dP(d):{},y=Pp(a,d);return d=m.iconName||y||d,a=m.prefix||a,a==="far"&&!E_.far&&E_.fas&&!pn.autoFetchSvg&&(a="fas"),{prefix:a,iconName:d}}const JF=ZM.filter(r=>r!==io||r!==Eb),eV=Object.keys(g1).filter(r=>r!==io).map(r=>Object.keys(g1[r])).flat();function tV(r){const{values:e,family:t,canonical:a,givenPrefix:d="",styles:m={},config:y={}}=r,c=t===Eb,M=e.includes("fa-duotone")||e.includes("fad"),R=y.familyDefault==="duotone",B=a.prefix==="fad"||a.prefix==="fa-duotone";if(!c&&(M||R||B)&&(a.prefix="fad"),(e.includes("fa-brands")||e.includes("fab"))&&(a.prefix="fab"),!a.prefix&&JF.includes(t)&&(Object.keys(m).find($=>eV.includes($))||y.autoFetchSvg)){const $=aF.get(t).defaultShortPrefixId;a.prefix=$,a.iconName=Pp(a.prefix,a.iconName)||a.iconName}return(a.prefix==="fa"||d==="fa")&&(a.prefix=xf()||"fas"),a}class nV{constructor(){this.definitions={}}add(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];const d=t.reduce(this._pullDefinitions,{});Object.keys(d).forEach(m=>{this.definitions[m]=Ft(Ft({},this.definitions[m]||{}),d[m]),S1(m,d[m]);const y=y2[io][m];y&&S1(y,d[m]),hP()})}reset(){this.definitions={}}_pullDefinitions(e,t){const a=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(a).map(d=>{const{prefix:m,iconName:y,icon:c}=a[d],M=c[2];e[m]||(e[m]={}),M.length>0&&M.forEach(R=>{typeof R=="string"&&(e[m][R]=c)}),e[m][y]=c}),e}}let _E=[],Wm={};const rg={},rV=Object.keys(rg);function iV(r,e){let{mixoutsTo:t}=e;return _E=r,Wm={},Object.keys(rg).forEach(a=>{rV.indexOf(a)===-1&&delete rg[a]}),_E.forEach(a=>{const d=a.mixout?a.mixout():{};if(Object.keys(d).forEach(m=>{typeof d[m]=="function"&&(t[m]=d[m]),typeof d[m]=="object"&&Object.keys(d[m]).forEach(y=>{t[m]||(t[m]={}),t[m][y]=d[m][y]})}),a.hooks){const m=a.hooks();Object.keys(m).forEach(y=>{Wm[y]||(Wm[y]=[]),Wm[y].push(m[y])})}a.provides&&a.provides(rg)}),t}function E1(r,e){for(var t=arguments.length,a=new Array(t>2?t-2:0),d=2;d<t;d++)a[d-2]=arguments[d];return(Wm[r]||[]).forEach(y=>{e=y.apply(null,[e,...a])}),e}function Gp(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),a=1;a<e;a++)t[a-1]=arguments[a];(Wm[r]||[]).forEach(m=>{m.apply(null,t)})}function wf(){const r=arguments[0],e=Array.prototype.slice.call(arguments,1);return rg[r]?rg[r].apply(null,e):void 0}function A1(r){r.prefix==="fa"&&(r.prefix="fas");let{iconName:e}=r;const t=r.prefix||xf();if(e)return e=Pp(t,e)||e,mE(pP.definitions,t,e)||mE(rh.styles,t,e)}const pP=new nV,aV=()=>{pn.autoReplaceSvg=!1,pn.observeMutations=!1,Gp("noAuto")},sV={i2svg:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return hd?(Gp("beforeI2svg",r),wf("pseudoElements2svg",r),wf("i2svg",r)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e}=r;pn.autoReplaceSvg===!1&&(pn.autoReplaceSvg=!0),pn.observeMutations=!0,jF(()=>{lV({autoReplaceSvgRoot:e}),Gp("watch",r)})}},oV={icon:r=>{if(r===null)return null;if(typeof r=="object"&&r.prefix&&r.iconName)return{prefix:r.prefix,iconName:Pp(r.prefix,r.iconName)||r.iconName};if(Array.isArray(r)&&r.length===2){const e=r[1].indexOf("fa-")===0?r[1].slice(3):r[1],t=Cb(r[0]);return{prefix:t,iconName:Pp(t,e)||e}}if(typeof r=="string"&&(r.indexOf("".concat(pn.cssPrefix,"-"))>-1||r.match(AF))){const e=Ib(r.split(" "),{skipLookups:!0});return{prefix:e.prefix||xf(),iconName:Pp(e.prefix,e.iconName)||e.iconName}}if(typeof r=="string"){const e=xf();return{prefix:e,iconName:Pp(e,r)||r}}}},Dl={noAuto:aV,config:pn,dom:sV,parse:oV,library:pP,findIconDefinition:A1,toHtml:Z_},lV=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e=Pi}=r;(Object.keys(rh.styles).length>0||pn.autoFetchSvg)&&hd&&pn.autoReplaceSvg&&Dl.dom.i2svg({node:e})};function Mb(r,e){return Object.defineProperty(r,"abstract",{get:e}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(t=>Z_(t))}}),Object.defineProperty(r,"node",{get:function(){if(!hd)return;const t=Pi.createElement("div");return t.innerHTML=r.html,t.children}}),r}function uV(r){let{children:e,main:t,mask:a,attributes:d,styles:m,transform:y}=r;if(v2(y)&&t.found&&!a.found){const{width:c,height:M}=t,R={x:c/M/2,y:.5};d.style=Ab(Ft(Ft({},m),{},{"transform-origin":"".concat(R.x+y.x/16,"em ").concat(R.y+y.y/16,"em")}))}return[{tag:"svg",attributes:d,children:e}]}function cV(r){let{prefix:e,iconName:t,children:a,attributes:d,symbol:m}=r;const y=m===!0?"".concat(e,"-").concat(pn.cssPrefix,"-").concat(t):m;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Ft(Ft({},d),{},{id:y}),children:a}]}]}function w2(r){const{icons:{main:e,mask:t},prefix:a,iconName:d,transform:m,symbol:y,title:c,maskId:M,titleId:R,extra:B,watchable:K=!1}=r,{width:$,height:W}=t.found?t:e,re=cF.includes(a),Me=[pn.replacementClass,d?"".concat(pn.cssPrefix,"-").concat(d):""].filter(Fe=>B.classes.indexOf(Fe)===-1).filter(Fe=>Fe!==""||!!Fe).concat(B.classes).join(" ");let Ce={children:[],attributes:Ft(Ft({},B.attributes),{},{"data-prefix":a,"data-icon":d,class:Me,role:B.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat($," ").concat(W)})};const Be=re&&!~B.classes.indexOf("fa-fw")?{width:"".concat($/W*16*.0625,"em")}:{};K&&(Ce.attributes[$p]=""),c&&(Ce.children.push({tag:"title",attributes:{id:Ce.attributes["aria-labelledby"]||"title-".concat(R||S_())},children:[c]}),delete Ce.attributes.title);const He=Ft(Ft({},Ce),{},{prefix:a,iconName:d,main:e,mask:t,maskId:M,transform:m,symbol:y,styles:Ft(Ft({},Be),B.styles)}),{children:ut,attributes:Ue}=t.found&&e.found?wf("generateAbstractMask",He)||{children:[],attributes:{}}:wf("generateAbstractIcon",He)||{children:[],attributes:{}};return He.children=ut,He.attributes=Ue,y?cV(He):uV(He)}function vE(r){const{content:e,width:t,height:a,transform:d,title:m,extra:y,watchable:c=!1}=r,M=Ft(Ft(Ft({},y.attributes),m?{title:m}:{}),{},{class:y.classes.join(" ")});c&&(M[$p]="");const R=Ft({},y.styles);v2(d)&&(R.transform=BF({transform:d,startCentered:!0,width:t,height:a}),R["-webkit-transform"]=R.transform);const B=Ab(R);B.length>0&&(M.style=B);const K=[];return K.push({tag:"span",attributes:M,children:[e]}),m&&K.push({tag:"span",attributes:{class:"sr-only"},children:[m]}),K}function hV(r){const{content:e,title:t,extra:a}=r,d=Ft(Ft(Ft({},a.attributes),t?{title:t}:{}),{},{class:a.classes.join(" ")}),m=Ab(a.styles);m.length>0&&(d.style=m);const y=[];return y.push({tag:"span",attributes:d,children:[e]}),t&&y.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),y}const{styles:bx}=rh;function C1(r){const e=r[0],t=r[1],[a]=r.slice(4);let d=null;return Array.isArray(a)?d={tag:"g",attributes:{class:"".concat(pn.cssPrefix,"-").concat(yx.GROUP)},children:[{tag:"path",attributes:{class:"".concat(pn.cssPrefix,"-").concat(yx.SECONDARY),fill:"currentColor",d:a[0]}},{tag:"path",attributes:{class:"".concat(pn.cssPrefix,"-").concat(yx.PRIMARY),fill:"currentColor",d:a[1]}}]}:d={tag:"path",attributes:{fill:"currentColor",d:a}},{found:!0,width:e,height:t,icon:d}}const dV={found:!1,width:512,height:512};function fV(r,e){!YM&&!pn.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(e,'" is missing.'))}function I1(r,e){let t=e;return e==="fa"&&pn.styleDefault!==null&&(e=xf()),new Promise((a,d)=>{if(t==="fa"){const m=dP(r)||{};r=m.iconName||r,e=m.prefix||e}if(r&&e&&bx[e]&&bx[e][r]){const m=bx[e][r];return a(C1(m))}fV(r,e),a(Ft(Ft({},dV),{},{icon:pn.showMissingIcons&&r?wf("missingIconAbstract")||{}:{}}))})}const bE=()=>{},M1=pn.measurePerformance&&jv&&jv.mark&&jv.measure?jv:{mark:bE,measure:bE},Hy='FA "6.7.2"',pV=r=>(M1.mark("".concat(Hy," ").concat(r," begins")),()=>mP(r)),mP=r=>{M1.mark("".concat(Hy," ").concat(r," ends")),M1.measure("".concat(Hy," ").concat(r),"".concat(Hy," ").concat(r," begins"),"".concat(Hy," ").concat(r," ends"))};var T2={begin:pV,end:mP};const a0=()=>{};function xE(r){return typeof(r.getAttribute?r.getAttribute($p):null)=="string"}function mV(r){const e=r.getAttribute?r.getAttribute(m2):null,t=r.getAttribute?r.getAttribute(g2):null;return e&&t}function gV(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(pn.replacementClass)}function yV(){return pn.autoReplaceSvg===!0?s0.replace:s0[pn.autoReplaceSvg]||s0.replace}function _V(r){return Pi.createElementNS("http://www.w3.org/2000/svg",r)}function vV(r){return Pi.createElement(r)}function gP(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{ceFn:t=r.tag==="svg"?_V:vV}=e;if(typeof r=="string")return Pi.createTextNode(r);const a=t(r.tag);return Object.keys(r.attributes||[]).forEach(function(m){a.setAttribute(m,r.attributes[m])}),(r.children||[]).forEach(function(m){a.appendChild(gP(m,{ceFn:t}))}),a}function bV(r){let e=" ".concat(r.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}const s0={replace:function(r){const e=r[0];if(e.parentNode)if(r[1].forEach(t=>{e.parentNode.insertBefore(gP(t),e)}),e.getAttribute($p)===null&&pn.keepOriginalSource){let t=Pi.createComment(bV(e));e.parentNode.replaceChild(t,e)}else e.remove()},nest:function(r){const e=r[0],t=r[1];if(~_2(e).indexOf(pn.replacementClass))return s0.replace(r);const a=new RegExp("".concat(pn.cssPrefix,"-.*"));if(delete t[0].attributes.id,t[0].attributes.class){const m=t[0].attributes.class.split(" ").reduce((y,c)=>(c===pn.replacementClass||c.match(a)?y.toSvg.push(c):y.toNode.push(c),y),{toNode:[],toSvg:[]});t[0].attributes.class=m.toSvg.join(" "),m.toNode.length===0?e.removeAttribute("class"):e.setAttribute("class",m.toNode.join(" "))}const d=t.map(m=>Z_(m)).join(`
`);e.setAttribute($p,""),e.innerHTML=d}};function wE(r){r()}function yP(r,e){const t=typeof e=="function"?e:a0;if(r.length===0)t();else{let a=wE;pn.mutateApproach===TF&&(a=bf.requestAnimationFrame||wE),a(()=>{const d=yV(),m=T2.begin("mutate");r.map(d),m(),t()})}}let S2=!1;function _P(){S2=!0}function P1(){S2=!1}let N0=null;function TE(r){if(!uE||!pn.observeMutations)return;const{treeCallback:e=a0,nodeCallback:t=a0,pseudoElementsCallback:a=a0,observeMutationsRoot:d=Pi}=r;N0=new uE(m=>{if(S2)return;const y=xf();Cg(m).forEach(c=>{if(c.type==="childList"&&c.addedNodes.length>0&&!xE(c.addedNodes[0])&&(pn.searchPseudoElements&&a(c.target),e(c.target)),c.type==="attributes"&&c.target.parentNode&&pn.searchPseudoElements&&a(c.target.parentNode),c.type==="attributes"&&xE(c.target)&&~MF.indexOf(c.attributeName))if(c.attributeName==="class"&&mV(c.target)){const{prefix:M,iconName:R}=Ib(_2(c.target));c.target.setAttribute(m2,M||y),R&&c.target.setAttribute(g2,R)}else gV(c.target)&&t(c.target)})}),hd&&N0.observe(d,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function xV(){N0&&N0.disconnect()}function wV(r){const e=r.getAttribute("style");let t=[];return e&&(t=e.split(";").reduce((a,d)=>{const m=d.split(":"),y=m[0],c=m.slice(1);return y&&c.length>0&&(a[y]=c.join(":").trim()),a},{})),t}function TV(r){const e=r.getAttribute("data-prefix"),t=r.getAttribute("data-icon"),a=r.innerText!==void 0?r.innerText.trim():"";let d=Ib(_2(r));return d.prefix||(d.prefix=xf()),e&&t&&(d.prefix=e,d.iconName=t),d.iconName&&d.prefix||(d.prefix&&a.length>0&&(d.iconName=WF(d.prefix,r.innerText)||x2(d.prefix,T1(r.innerText))),!d.iconName&&pn.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(d.iconName=r.firstChild.data)),d}function SV(r){const e=Cg(r.attributes).reduce((d,m)=>(d.name!=="class"&&d.name!=="style"&&(d[m.name]=m.value),d),{}),t=r.getAttribute("title"),a=r.getAttribute("data-fa-title-id");return pn.autoA11y&&(t?e["aria-labelledby"]="".concat(pn.replacementClass,"-title-").concat(a||S_()):(e["aria-hidden"]="true",e.focusable="false")),e}function EV(){return{iconName:null,title:null,titleId:null,prefix:null,transform:nh,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function SE(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0};const{iconName:t,prefix:a,rest:d}=TV(r),m=SV(r),y=E1("parseNodeAttributes",{},r);let c=e.styleParser?wV(r):[];return Ft({iconName:t,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:a,transform:nh,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:d,styles:c,attributes:m}},y)}const{styles:AV}=rh;function vP(r){const e=pn.autoReplaceSvg==="nest"?SE(r,{styleParser:!1}):SE(r);return~e.extra.classes.indexOf(JM)?wf("generateLayersText",r,e):wf("generateSvgReplacementMutation",r,e)}function CV(){return[...oF,...y1]}function EE(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!hd)return Promise.resolve();const t=Pi.documentElement.classList,a=B=>t.add("".concat(dE,"-").concat(B)),d=B=>t.remove("".concat(dE,"-").concat(B)),m=pn.autoFetchSvg?CV():HM.concat(Object.keys(AV));m.includes("fa")||m.push("fa");const y=[".".concat(JM,":not([").concat($p,"])")].concat(m.map(B=>".".concat(B,":not([").concat($p,"])"))).join(", ");if(y.length===0)return Promise.resolve();let c=[];try{c=Cg(r.querySelectorAll(y))}catch{}if(c.length>0)a("pending"),d("complete");else return Promise.resolve();const M=T2.begin("onTree"),R=c.reduce((B,K)=>{try{const $=vP(K);$&&B.push($)}catch($){YM||$.name==="MissingIcon"&&console.error($)}return B},[]);return new Promise((B,K)=>{Promise.all(R).then($=>{yP($,()=>{a("active"),a("complete"),d("pending"),typeof e=="function"&&e(),M(),B()})}).catch($=>{M(),K($)})})}function IV(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;vP(r).then(t=>{t&&yP([t],e)})}function MV(r){return function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(e||{}).icon?e:A1(e||{});let{mask:d}=t;return d&&(d=(d||{}).icon?d:A1(d||{})),r(a,Ft(Ft({},t),{},{mask:d}))}}const PV=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:t=nh,symbol:a=!1,mask:d=null,maskId:m=null,title:y=null,titleId:c=null,classes:M=[],attributes:R={},styles:B={}}=e;if(!r)return;const{prefix:K,iconName:$,icon:W}=r;return Mb(Ft({type:"icon"},r),()=>(Gp("beforeDOMElementCreation",{iconDefinition:r,params:e}),pn.autoA11y&&(y?R["aria-labelledby"]="".concat(pn.replacementClass,"-title-").concat(c||S_()):(R["aria-hidden"]="true",R.focusable="false")),w2({icons:{main:C1(W),mask:d?C1(d.icon):{found:!1,width:null,height:null,icon:{}}},prefix:K,iconName:$,transform:Ft(Ft({},nh),t),symbol:a,title:y,maskId:m,titleId:c,extra:{attributes:R,styles:B,classes:M}})))};var RV={mixout(){return{icon:MV(PV)}},hooks(){return{mutationObserverCallbacks(r){return r.treeCallback=EE,r.nodeCallback=IV,r}}},provides(r){r.i2svg=function(e){const{node:t=Pi,callback:a=()=>{}}=e;return EE(t,a)},r.generateSvgReplacementMutation=function(e,t){const{iconName:a,title:d,titleId:m,prefix:y,transform:c,symbol:M,mask:R,maskId:B,extra:K}=t;return new Promise(($,W)=>{Promise.all([I1(a,y),R.iconName?I1(R.iconName,R.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(re=>{let[Me,Ce]=re;$([e,w2({icons:{main:Me,mask:Ce},prefix:y,iconName:a,transform:c,symbol:M,maskId:B,title:d,titleId:m,extra:K,watchable:!0})])}).catch(W)})},r.generateAbstractIcon=function(e){let{children:t,attributes:a,main:d,transform:m,styles:y}=e;const c=Ab(y);c.length>0&&(a.style=c);let M;return v2(m)&&(M=wf("generateAbstractTransformGrouping",{main:d,transform:m,containerWidth:d.width,iconWidth:d.width})),t.push(M||d.icon),{children:t,attributes:a}}}},kV={mixout(){return{layer(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{classes:t=[]}=e;return Mb({type:"layer"},()=>{Gp("beforeDOMElementCreation",{assembler:r,params:e});let a=[];return r(d=>{Array.isArray(d)?d.map(m=>{a=a.concat(m.abstract)}):a=a.concat(d.abstract)}),[{tag:"span",attributes:{class:["".concat(pn.cssPrefix,"-layers"),...t].join(" ")},children:a}]})}}}},DV={mixout(){return{counter(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{title:t=null,classes:a=[],attributes:d={},styles:m={}}=e;return Mb({type:"counter",content:r},()=>(Gp("beforeDOMElementCreation",{content:r,params:e}),hV({content:r.toString(),title:t,extra:{attributes:d,styles:m,classes:["".concat(pn.cssPrefix,"-layers-counter"),...a]}})))}}}},LV={mixout(){return{text(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:t=nh,title:a=null,classes:d=[],attributes:m={},styles:y={}}=e;return Mb({type:"text",content:r},()=>(Gp("beforeDOMElementCreation",{content:r,params:e}),vE({content:r,transform:Ft(Ft({},nh),t),title:a,extra:{attributes:m,styles:y,classes:["".concat(pn.cssPrefix,"-layers-text"),...d]}})))}}},provides(r){r.generateLayersText=function(e,t){const{title:a,transform:d,extra:m}=t;let y=null,c=null;if($M){const M=parseInt(getComputedStyle(e).fontSize,10),R=e.getBoundingClientRect();y=R.width/M,c=R.height/M}return pn.autoA11y&&!a&&(m.attributes["aria-hidden"]="true"),Promise.resolve([e,vE({content:e.innerHTML,width:y,height:c,transform:d,title:a,extra:m,watchable:!0})])}}};const zV=new RegExp('"',"ug"),AE=[1105920,1112319],CE=Ft(Ft(Ft(Ft({},{FontAwesome:{normal:"fas",400:"fas"}}),iF),xF),pF),R1=Object.keys(CE).reduce((r,e)=>(r[e.toLowerCase()]=CE[e],r),{}),OV=Object.keys(R1).reduce((r,e)=>{const t=R1[e];return r[e]=t[900]||[...Object.entries(t)][0][1],r},{});function NV(r){const e=r.replace(zV,""),t=qF(e,0),a=t>=AE[0]&&t<=AE[1],d=e.length===2?e[0]===e[1]:!1;return{value:T1(d?e[0]:e),isSecondary:a||d}}function BV(r,e){const t=r.replace(/^['"]|['"]$/g,"").toLowerCase(),a=parseInt(e),d=isNaN(a)?"normal":a;return(R1[t]||{})[d]||OV[t]}function IE(r,e){const t="".concat(wF).concat(e.replace(":","-"));return new Promise((a,d)=>{if(r.getAttribute(t)!==null)return a();const y=Cg(r.children).filter($=>$.getAttribute(v1)===e)[0],c=bf.getComputedStyle(r,e),M=c.getPropertyValue("font-family"),R=M.match(CF),B=c.getPropertyValue("font-weight"),K=c.getPropertyValue("content");if(y&&!R)return r.removeChild(y),a();if(R&&K!=="none"&&K!==""){const $=c.getPropertyValue("content");let W=BV(M,B);const{value:re,isSecondary:Me}=NV($),Ce=R[0].startsWith("FontAwesome");let Be=x2(W,re),He=Be;if(Ce){const ut=KF(re);ut.iconName&&ut.prefix&&(Be=ut.iconName,W=ut.prefix)}if(Be&&!Me&&(!y||y.getAttribute(m2)!==W||y.getAttribute(g2)!==He)){r.setAttribute(t,He),y&&r.removeChild(y);const ut=EV(),{extra:Ue}=ut;Ue.attributes[v1]=e,I1(Be,W).then(Fe=>{const Ze=w2(Ft(Ft({},ut),{},{icons:{main:Fe,mask:fP()},prefix:W,iconName:He,extra:Ue,watchable:!0})),me=Pi.createElementNS("http://www.w3.org/2000/svg","svg");e==="::before"?r.insertBefore(me,r.firstChild):r.appendChild(me),me.outerHTML=Ze.map(se=>Z_(se)).join(`
`),r.removeAttribute(t),a()}).catch(d)}else a()}else a()})}function FV(r){return Promise.all([IE(r,"::before"),IE(r,"::after")])}function VV(r){return r.parentNode!==document.head&&!~SF.indexOf(r.tagName.toUpperCase())&&!r.getAttribute(v1)&&(!r.parentNode||r.parentNode.tagName!=="svg")}function ME(r){if(hd)return new Promise((e,t)=>{const a=Cg(r.querySelectorAll("*")).filter(VV).map(FV),d=T2.begin("searchPseudoElements");_P(),Promise.all(a).then(()=>{d(),P1(),e()}).catch(()=>{d(),P1(),t()})})}var jV={hooks(){return{mutationObserverCallbacks(r){return r.pseudoElementsCallback=ME,r}}},provides(r){r.pseudoElements2svg=function(e){const{node:t=Pi}=e;pn.searchPseudoElements&&ME(t)}}};let PE=!1;var UV={mixout(){return{dom:{unwatch(){_P(),PE=!0}}}},hooks(){return{bootstrap(){TE(E1("mutationObserverCallbacks",{}))},noAuto(){xV()},watch(r){const{observeMutationsRoot:e}=r;PE?P1():TE(E1("mutationObserverCallbacks",{observeMutationsRoot:e}))}}}};const RE=r=>{let e={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return r.toLowerCase().split(" ").reduce((t,a)=>{const d=a.toLowerCase().split("-"),m=d[0];let y=d.slice(1).join("-");if(m&&y==="h")return t.flipX=!0,t;if(m&&y==="v")return t.flipY=!0,t;if(y=parseFloat(y),isNaN(y))return t;switch(m){case"grow":t.size=t.size+y;break;case"shrink":t.size=t.size-y;break;case"left":t.x=t.x-y;break;case"right":t.x=t.x+y;break;case"up":t.y=t.y-y;break;case"down":t.y=t.y+y;break;case"rotate":t.rotate=t.rotate+y;break}return t},e)};var qV={mixout(){return{parse:{transform:r=>RE(r)}}},hooks(){return{parseNodeAttributes(r,e){const t=e.getAttribute("data-fa-transform");return t&&(r.transform=RE(t)),r}}},provides(r){r.generateAbstractTransformGrouping=function(e){let{main:t,transform:a,containerWidth:d,iconWidth:m}=e;const y={transform:"translate(".concat(d/2," 256)")},c="translate(".concat(a.x*32,", ").concat(a.y*32,") "),M="scale(".concat(a.size/16*(a.flipX?-1:1),", ").concat(a.size/16*(a.flipY?-1:1),") "),R="rotate(".concat(a.rotate," 0 0)"),B={transform:"".concat(c," ").concat(M," ").concat(R)},K={transform:"translate(".concat(m/2*-1," -256)")},$={outer:y,inner:B,path:K};return{tag:"g",attributes:Ft({},$.outer),children:[{tag:"g",attributes:Ft({},$.inner),children:[{tag:t.icon.tag,children:t.icon.children,attributes:Ft(Ft({},t.icon.attributes),$.path)}]}]}}}};const xx={x:0,y:0,width:"100%",height:"100%"};function kE(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r.attributes&&(r.attributes.fill||e)&&(r.attributes.fill="black"),r}function $V(r){return r.tag==="g"?r.children:[r]}var GV={hooks(){return{parseNodeAttributes(r,e){const t=e.getAttribute("data-fa-mask"),a=t?Ib(t.split(" ").map(d=>d.trim())):fP();return a.prefix||(a.prefix=xf()),r.mask=a,r.maskId=e.getAttribute("data-fa-mask-id"),r}}},provides(r){r.generateAbstractMask=function(e){let{children:t,attributes:a,main:d,mask:m,maskId:y,transform:c}=e;const{width:M,icon:R}=d,{width:B,icon:K}=m,$=NF({transform:c,containerWidth:B,iconWidth:M}),W={tag:"rect",attributes:Ft(Ft({},xx),{},{fill:"white"})},re=R.children?{children:R.children.map(kE)}:{},Me={tag:"g",attributes:Ft({},$.inner),children:[kE(Ft({tag:R.tag,attributes:Ft(Ft({},R.attributes),$.path)},re))]},Ce={tag:"g",attributes:Ft({},$.outer),children:[Me]},Be="mask-".concat(y||S_()),He="clip-".concat(y||S_()),ut={tag:"mask",attributes:Ft(Ft({},xx),{},{id:Be,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[W,Ce]},Ue={tag:"defs",children:[{tag:"clipPath",attributes:{id:He},children:$V(K)},ut]};return t.push(Ue,{tag:"rect",attributes:Ft({fill:"currentColor","clip-path":"url(#".concat(He,")"),mask:"url(#".concat(Be,")")},xx)}),{children:t,attributes:a}}}},HV={provides(r){let e=!1;bf.matchMedia&&(e=bf.matchMedia("(prefers-reduced-motion: reduce)").matches),r.missingIconAbstract=function(){const t=[],a={fill:"currentColor"},d={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};t.push({tag:"path",attributes:Ft(Ft({},a),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const m=Ft(Ft({},d),{},{attributeName:"opacity"}),y={tag:"circle",attributes:Ft(Ft({},a),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||y.children.push({tag:"animate",attributes:Ft(Ft({},d),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Ft(Ft({},m),{},{values:"1;0;1;1;0;1;"})}),t.push(y),t.push({tag:"path",attributes:Ft(Ft({},a),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:Ft(Ft({},m),{},{values:"1;0;0;0;0;1;"})}]}),e||t.push({tag:"path",attributes:Ft(Ft({},a),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Ft(Ft({},m),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:t}}}},ZV={hooks(){return{parseNodeAttributes(r,e){const t=e.getAttribute("data-fa-symbol"),a=t===null?!1:t===""?!0:t;return r.symbol=a,r}}}},WV=[VF,RV,kV,DV,LV,jV,UV,qV,GV,HV,ZV];iV(WV,{mixoutsTo:Dl});Dl.noAuto;Dl.config;Dl.library;Dl.dom;const k1=Dl.parse;Dl.findIconDefinition;Dl.toHtml;const KV=Dl.icon;Dl.layer;Dl.text;Dl.counter;var wx={exports:{}},Tx,DE;function XV(){if(DE)return Tx;DE=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Tx=r,Tx}var Sx,LE;function YV(){if(LE)return Sx;LE=1;var r=XV();function e(){}function t(){}return t.resetWarningCache=e,Sx=function(){function a(y,c,M,R,B,K){if(K!==r){var $=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw $.name="Invariant Violation",$}}a.isRequired=a;function d(){return a}var m={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:d,element:a,elementType:a,instanceOf:d,node:a,objectOf:d,oneOf:d,oneOfType:d,shape:d,exact:d,checkPropTypes:t,resetWarningCache:e};return m.PropTypes=m,m},Sx}var zE;function QV(){return zE||(zE=1,wx.exports=YV()()),wx.exports}var JV=QV();const ar=A_(JV);function OE(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),t.push.apply(t,a)}return t}function eh(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?OE(Object(t),!0).forEach(function(a){Km(r,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):OE(Object(t)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(t,a))})}return r}function B0(r){"@babel/helpers - typeof";return B0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B0(r)}function Km(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ej(r,e){if(r==null)return{};var t={},a=Object.keys(r),d,m;for(m=0;m<a.length;m++)d=a[m],!(e.indexOf(d)>=0)&&(t[d]=r[d]);return t}function tj(r,e){if(r==null)return{};var t=ej(r,e),a,d;if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(r);for(d=0;d<m.length;d++)a=m[d],!(e.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(r,a)&&(t[a]=r[a])}return t}function D1(r){return nj(r)||rj(r)||ij(r)||aj()}function nj(r){if(Array.isArray(r))return L1(r)}function rj(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ij(r,e){if(r){if(typeof r=="string")return L1(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return L1(r,e)}}function L1(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=r[t];return a}function aj(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sj(r){var e,t=r.beat,a=r.fade,d=r.beatFade,m=r.bounce,y=r.shake,c=r.flash,M=r.spin,R=r.spinPulse,B=r.spinReverse,K=r.pulse,$=r.fixedWidth,W=r.inverse,re=r.border,Me=r.listItem,Ce=r.flip,Be=r.size,He=r.rotation,ut=r.pull,Ue=(e={"fa-beat":t,"fa-fade":a,"fa-beat-fade":d,"fa-bounce":m,"fa-shake":y,"fa-flash":c,"fa-spin":M,"fa-spin-reverse":B,"fa-spin-pulse":R,"fa-pulse":K,"fa-fw":$,"fa-inverse":W,"fa-border":re,"fa-li":Me,"fa-flip":Ce===!0,"fa-flip-horizontal":Ce==="horizontal"||Ce==="both","fa-flip-vertical":Ce==="vertical"||Ce==="both"},Km(e,"fa-".concat(Be),typeof Be<"u"&&Be!==null),Km(e,"fa-rotate-".concat(He),typeof He<"u"&&He!==null&&He!==0),Km(e,"fa-pull-".concat(ut),typeof ut<"u"&&ut!==null),Km(e,"fa-swap-opacity",r.swapOpacity),e);return Object.keys(Ue).map(function(Fe){return Ue[Fe]?Fe:null}).filter(function(Fe){return Fe})}function oj(r){return r=r-0,r===r}function bP(r){return oj(r)?r:(r=r.replace(/[\-_\s]+(.)?/g,function(e,t){return t?t.toUpperCase():""}),r.substr(0,1).toLowerCase()+r.substr(1))}var lj=["style"];function uj(r){return r.charAt(0).toUpperCase()+r.slice(1)}function cj(r){return r.split(";").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,t){var a=t.indexOf(":"),d=bP(t.slice(0,a)),m=t.slice(a+1).trim();return d.startsWith("webkit")?e[uj(d)]=m:e[d]=m,e},{})}function xP(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string")return e;var a=(e.children||[]).map(function(M){return xP(r,M)}),d=Object.keys(e.attributes||{}).reduce(function(M,R){var B=e.attributes[R];switch(R){case"class":M.attrs.className=B,delete e.attributes.class;break;case"style":M.attrs.style=cj(B);break;default:R.indexOf("aria-")===0||R.indexOf("data-")===0?M.attrs[R.toLowerCase()]=B:M.attrs[bP(R)]=B}return M},{attrs:{}}),m=t.style,y=m===void 0?{}:m,c=tj(t,lj);return d.attrs.style=eh(eh({},d.attrs.style),y),r.apply(void 0,[e.tag,eh(eh({},d.attrs),c)].concat(D1(a)))}var wP=!1;try{wP=!0}catch{}function hj(){if(!wP&&console&&typeof console.error=="function"){var r;(r=console).error.apply(r,arguments)}}function NE(r){if(r&&B0(r)==="object"&&r.prefix&&r.iconName&&r.icon)return r;if(k1.icon)return k1.icon(r);if(r===null)return null;if(r&&B0(r)==="object"&&r.prefix&&r.iconName)return r;if(Array.isArray(r)&&r.length===2)return{prefix:r[0],iconName:r[1]};if(typeof r=="string")return{prefix:"fas",iconName:r}}function Ex(r,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?Km({},r,e):{}}var BE={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},fh=O1.forwardRef(function(r,e){var t=eh(eh({},BE),r),a=t.icon,d=t.mask,m=t.symbol,y=t.className,c=t.title,M=t.titleId,R=t.maskId,B=NE(a),K=Ex("classes",[].concat(D1(sj(t)),D1((y||"").split(" ")))),$=Ex("transform",typeof t.transform=="string"?k1.transform(t.transform):t.transform),W=Ex("mask",NE(d)),re=KV(B,eh(eh(eh(eh({},K),$),W),{},{symbol:m,title:c,titleId:M,maskId:R}));if(!re)return hj("Could not find icon",B),null;var Me=re.abstract,Ce={ref:e};return Object.keys(t).forEach(function(Be){BE.hasOwnProperty(Be)||(Ce[Be]=t[Be])}),dj(Me[0],Ce)});fh.displayName="FontAwesomeIcon";fh.propTypes={beat:ar.bool,border:ar.bool,beatFade:ar.bool,bounce:ar.bool,className:ar.string,fade:ar.bool,flash:ar.bool,mask:ar.oneOfType([ar.object,ar.array,ar.string]),maskId:ar.string,fixedWidth:ar.bool,inverse:ar.bool,flip:ar.oneOf([!0,!1,"horizontal","vertical","both"]),icon:ar.oneOfType([ar.object,ar.array,ar.string]),listItem:ar.bool,pull:ar.oneOf(["right","left"]),pulse:ar.bool,rotation:ar.oneOf([0,90,180,270]),shake:ar.bool,size:ar.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:ar.bool,spinPulse:ar.bool,spinReverse:ar.bool,symbol:ar.oneOfType([ar.bool,ar.string]),title:ar.string,titleId:ar.string,transform:ar.oneOfType([ar.string,ar.object]),swapOpacity:ar.bool};var dj=xP.bind(null,O1.createElement);/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const fj={prefix:"fas",iconName:"pencil",icon:[512,512,[9999,61504,"pencil-alt"],"f303","M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1 0 32c0 8.8 7.2 16 16 16l32 0zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"]},E2=fj,pj={prefix:"fas",iconName:"arrows-rotate",icon:[512,512,[128472,"refresh","sync"],"f021","M105.1 202.6c7.7-21.8 20.2-42.3 37.8-59.8c62.5-62.5 163.8-62.5 226.3 0L386.3 160 352 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l111.5 0c0 0 0 0 0 0l.4 0c17.7 0 32-14.3 32-32l0-112c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 35.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5zM39 289.3c-5 1.5-9.8 4.2-13.7 8.2c-4 4-6.7 8.8-8.1 14c-.3 1.2-.6 2.5-.8 3.8c-.3 1.7-.4 3.4-.4 5.1L16 432c0 17.7 14.3 32 32 32s32-14.3 32-32l0-35.1 17.6 17.5c0 0 0 0 0 0c87.5 87.4 229.3 87.4 316.7 0c24.4-24.4 42.1-53.1 52.9-83.8c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.5 62.5-163.8 62.5-226.3 0l-.1-.1L125.6 352l34.4 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L48.4 288c-1.6 0-3.2 .1-4.8 .3s-3.1 .5-4.6 1z"]},TP=pj,A2={prefix:"fas",iconName:"trash",icon:[448,512,[],"f1f8","M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z"]};function mj(){const[r,e]=We.useState([]),[t,a]=We.useState([]),[d,m]=We.useState(0),[y,c]=We.useState(""),[M,R]=We.useState(""),[B,K]=We.useState(""),[$,W]=We.useState(""),[re,Me]=We.useState(!1),[Ce,Be]=We.useState(0),[He,ut]=We.useState(!0),[Ue,Fe]=We.useState(null),[Ze,me]=We.useState(!0),se=Ee=>{const ke=[...Ee];for(let ve=ke.length-1;ve>0;ve--){const Bt=Math.floor(Math.random()*(ve+1));[ke[ve],ke[Bt]]=[ke[Bt],ke[ve]]}return ke};We.useEffect(()=>{(async()=>{try{const ve=(await Tg(ad(La,"Aircrafts"))).docs.map(Bt=>({id:Bt.id,...Bt.data()}));e(ve),a(se(ve)),ut(!1)}catch(ke){Fe("Failed to fetch aircrafts: "+ke.message),ut(!1)}})()},[]);const ye=()=>{me(!Ze),c(""),R(""),K(""),W(""),m(0),Be(0),a(se(r))},we=Ee=>{Ee.preventDefault();const ke=t[d],ve=y.trim().replace(/\s/g,"").toLowerCase(),Bt=Ze?ke.Name.replace(/\s/g,"").toLowerCase():ke["ICAO Code"].replace(/\s/g,"").toLowerCase(),Kt=ke.WTC.trim().toUpperCase();let et=ve===Bt&&M===Kt;if(re){const Mt=String(ke["Max Level"]).trim(),Tt=String(ke["Cruising Speed"]).trim();et=et&&B.trim()===Mt&&$.trim()===Tt}et?d+1<t.length?(m(d+1),c(""),R(""),K(""),W("")):(a(se(r)),m(0),Be(0),c(""),R(""),K(""),W("")):Be(Ce+1)};return He?de.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[de.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Aircraft Quiz"}),de.jsx("p",{children:"Loading..."})]}):Ue?de.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[de.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Aircraft Quiz"}),de.jsx("p",{className:"text-red-500",children:Ue})]}):r.length===0?de.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[de.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Aircraft Quiz"}),de.jsx("p",{children:"No aircrafts found."})]}):de.jsx("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:de.jsxs("div",{className:"bg-white p-6 rounded-lg shadow max-w-md w-full flex flex-col gap-4 relative",children:[de.jsx("input",{type:"checkbox",checked:re,onChange:Ee=>Me(Ee.target.checked),className:"absolute top-2 left-2 h-5 w-5"}),de.jsx("button",{onClick:ye,title:"Toggle Question Type",className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",children:de.jsx(fh,{icon:TP})}),de.jsx("div",{children:de.jsx("p",{className:"text-lg font-bold flex justify-center",children:Ze?t[d]["ICAO Code"]:t[d].Name})}),de.jsxs("form",{onSubmit:we,className:"flex flex-col gap-4",children:[de.jsxs("div",{className:"flex flex-row gap-2",children:[de.jsx("input",{type:"text",value:y,onChange:Ee=>c(Ee.target.value),placeholder:Ze?"Enter Aircraft Name":"Enter ICAO Code",className:"p-2 border rounded flex-grow basis-4/5",autoFocus:!0}),de.jsxs("select",{value:M,onChange:Ee=>R(Ee.target.value),className:"p-2 border rounded basis-1/5",children:[de.jsx("option",{value:"",disabled:!0,children:"Select WTC"}),de.jsx("option",{value:"L",children:"L"}),de.jsx("option",{value:"M",children:"M"}),de.jsx("option",{value:"H",children:"H"}),de.jsx("option",{value:"J",children:"J"})]})]}),de.jsxs("div",{className:"flex flex-row gap-2",children:[de.jsx("input",{type:"text",value:B,onChange:Ee=>K(Ee.target.value),placeholder:"Enter Max Level",className:`p-2 border rounded flex-1 ${re?"":"bg-gray-200"}`,disabled:!re}),de.jsx("input",{type:"text",value:$,onChange:Ee=>W(Ee.target.value),placeholder:"Enter Cruising Speed",className:`p-2 border rounded flex-1 ${re?"":"bg-gray-200"}`,disabled:!re})]}),de.jsx("button",{type:"submit",className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Next Aircraft"})]}),de.jsxs("div",{className:"flex justify-between",children:[de.jsxs("p",{className:"text-lg font-bold text-gray-500",children:["Errors: ",Ce]}),de.jsxs("p",{className:"text-lg font-bold text-gray-500",children:["Question: ",d+1,"/",t.length]})]})]})})}function gj(){const[r,e]=We.useState([]),[t,a]=We.useState([]),[d,m]=We.useState(0),[y,c]=We.useState(""),[M,R]=We.useState(0),[B,K]=We.useState(!0),[$,W]=We.useState(null),[re,Me]=We.useState(!0),Ce=ut=>{const Ue=[...ut];for(let Fe=Ue.length-1;Fe>0;Fe--){const Ze=Math.floor(Math.random()*(Fe+1));[Ue[Fe],Ue[Ze]]=[Ue[Ze],Ue[Fe]]}return Ue};We.useEffect(()=>{(async()=>{try{const Fe=(await Tg(ad(La,"Callsigns"))).docs.map(Ze=>({id:Ze.id,...Ze.data()}));e(Fe),a(Ce(Fe)),K(!1)}catch(Ue){W("Failed to fetch callsigns: "+Ue.message),K(!1)}})()},[]);const Be=()=>{Me(!re),c(""),m(0),R(0),a(Ce(r))},He=ut=>{ut.preventDefault();const Ue=t[d],Fe=y.trim().replace(/\s/g,"").toLowerCase(),Ze=re?Ue.Callsign.replace(/\s/g,"").toLowerCase():Ue["ICAO Code"].replace(/\s/g,"").toLowerCase();Fe===Ze?d+1<t.length?(m(d+1),c("")):(a(Ce(r)),m(0),R(0),c("")):R(M+1)};return B?de.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[de.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Callsign Quiz"}),de.jsx("p",{children:"Loading..."})]}):$?de.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[de.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Callsign Quiz"}),de.jsx("p",{className:"text-red-500",children:$})]}):r.length===0?de.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[de.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Callsign Quiz"}),de.jsx("p",{children:"No callsigns found."})]}):de.jsx("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:de.jsxs("div",{className:"bg-white p-6 rounded-lg shadow max-w-md w-full flex flex-col gap-4 relative",children:[de.jsx("button",{onClick:Be,title:"Toggle Question Type",className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",children:de.jsx(fh,{icon:TP})}),de.jsx("div",{children:de.jsx("p",{className:"text-lg font-bold flex justify-center",children:re?t[d]["ICAO Code"]:t[d].Callsign})}),de.jsxs("form",{onSubmit:He,className:"flex flex-col gap-4",children:[de.jsx("input",{type:"text",value:y,onChange:ut=>c(ut.target.value),placeholder:re?"Enter Callsign":"Enter ICAO Code",className:"p-2 border rounded",autoFocus:!0}),de.jsx("button",{type:"submit",className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Next Callsign"})]}),de.jsxs("div",{className:"flex justify-between",children:[de.jsxs("p",{className:"text-lg font-bold text-gray-500",children:["Errors: ",M]}),de.jsxs("p",{className:"text-lg font-bold text-gray-500",children:["Question: ",d+1,"/",t.length]})]})]})})}function yj(){return de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h1",{className:"text-2xl font-bold",children:"Constraints"}),de.jsx("p",{children:"This is the Constraints page."})]})}function _j(){return de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h1",{className:"text-2xl font-bold",children:"External Points"}),de.jsx("p",{children:"This is the External Points page."})]})}function vj(){return de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h1",{className:"text-2xl font-bold",children:"Internal Points"}),de.jsx("p",{children:"This is the Internal Points page."})]})}function bj(){const[r,e]=We.useState(""),[t,a]=We.useState(""),[d,m]=We.useState(null),[y,c]=We.useState(null),[M,R]=We.useState(!1);We.useEffect(()=>{const W=Hh.onAuthStateChanged(async re=>{if(re)try{const Me=await ob(vu(La,"users",re.uid));if(Me.exists()){const Ce=Me.data().role;m(Ce)}else m(null)}catch(Me){c(Me.message)}else m(null)});return()=>W()},[]);const B=async W=>{W.preventDefault();try{await FA(Hh,r,t),c(null),e(""),a("")}catch(re){c(re.message)}},K=async W=>{W.preventDefault();try{const re=await $5(Hh,r,t);await p4(vu(La,"users",re.user.uid),{role:"ATCO"}),m("ATCO"),c(null),e(""),a(""),R(!1)}catch(re){c(re.message)}},$=async()=>{try{await Z5(Hh),m(null),c(null)}catch(W){c(W.message)}};return Hh.currentUser?de.jsxs("div",{className:"container mx-auto p-4 min-h-screen bg-gray-100",children:[de.jsx("h1",{className:"text-2xl font-bold mb-8 text-center",children:"Dashboard"}),d==="Supervisor"?de.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[de.jsx(Mo,{to:"/dashboard/aircrafts",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:de.jsx("h3",{className:"text-lg font-semibold text-center",children:"Aircrafts"})}),de.jsx(Mo,{to:"/dashboard/Airports",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:de.jsx("h3",{className:"text-lg font-semibold text-center",children:"Airports"})}),de.jsx(Mo,{to:"/dashboard/callsigns",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:de.jsx("h3",{className:"text-lg font-semibold text-center",children:"Callsigns"})}),de.jsx(Mo,{to:"/dashboard/constraints",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:de.jsx("h3",{className:"text-lg font-semibold text-center",children:"Constraints"})}),de.jsx(Mo,{to:"/dashboard/ext_points",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:de.jsx("h3",{className:"text-lg font-semibold text-center",children:"External Points"})}),de.jsx(Mo,{to:"/dashboard/int_points",className:"bg-white p-6 rounded-lg shadow hover:bg-gray-50 transition duration-200",children:de.jsx("h3",{className:"text-lg font-semibold text-center",children:"Internal Points"})})]}):de.jsx("div",{className:"bg-white p-6 rounded-lg shadow max-w-md w-full mx-auto",children:de.jsx("p",{className:"text-lg mb-4 text-center",children:"Nincs jogosultsgod mdostani az adatbzist"})}),de.jsx("div",{className:"flex justify-center mt-6",children:de.jsx("button",{onClick:$,className:"p-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Logout"})}),y&&de.jsx("p",{className:"mt-4 text-red-500 text-center",children:y})]}):de.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100",children:[de.jsx("h1",{className:"text-2xl font-bold mb-8",children:"Dashboard"}),de.jsxs("div",{className:"bg-white p-6 rounded-lg shadow max-w-md w-full",children:[de.jsx("h2",{className:"text-xl font-semibold mb-4",children:M?"Register":"Login"}),de.jsxs("form",{onSubmit:M?K:B,className:"flex flex-col gap-4",children:[de.jsx("input",{type:"email",value:r,onChange:W=>e(W.target.value),placeholder:"Email",className:"p-2 border rounded"}),de.jsx("input",{type:"password",value:t,onChange:W=>a(W.target.value),placeholder:"Password",className:"p-2 border rounded"}),de.jsx("button",{type:"submit",className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:M?"Register":"Login"})]}),de.jsx("button",{onClick:()=>R(!M),className:"mt-4 text-blue-500 hover:underline",children:M?"Switch to Login":"Switch to Register"}),y&&de.jsx("p",{className:"mt-4 text-red-500",children:y})]})]})}function xj(){const[r,e]=We.useState([]),[t,a]=We.useState(!0),[d,m]=We.useState(null),[y,c]=We.useState(""),[M,R]=We.useState(""),[B,K]=We.useState(""),[$,W]=We.useState(""),[re,Me]=We.useState(""),[Ce,Be]=We.useState(!1),[He,ut]=We.useState(null),[Ue,Fe]=We.useState(""),[Ze,me]=We.useState(""),[se,ye]=We.useState(""),[we,Ee]=We.useState(""),[ke,ve]=We.useState("");We.useEffect(()=>{(async()=>{try{const Gt=Hh.currentUser;if(Gt){const St=await ob(vu(La,"users",Gt.uid));St.exists()&&Be(St.data().role==="Supervisor")}const Re=Lw(ad(La,"Aircrafts"),Bw("ICAO Code","asc")),At=(await Tg(Re)).docs.map(St=>({id:St.id,...St.data()}));e(At),a(!1)}catch(Gt){m("Failed to fetch data: "+Gt.message),a(!1)}})()},[]);const Bt=async Tt=>{if(Tt.key!=="Enter")return;const Gt=y.trim().toUpperCase();if(Gt.length!==3&&Gt.length!==4){m("ICAO Code must be 3 or 4 characters.");return}if(!M.trim()){m("Name is required.");return}if(!["L","M","H","J"].includes(B.trim().toUpperCase())){m("WTC must be L, M, H, or J.");return}if(!$.trim()){m("Max Level is required.");return}if(!re.trim()){m("Cruising Speed is required.");return}if(!Ce){m("Only Supervisors can add aircrafts.");return}try{const Re=await jw(ad(La,"Aircrafts"),{"ICAO Code":Gt,Name:M.trim(),WTC:B.trim().toUpperCase(),"Max Level":$.trim(),"Cruising Speed":re.trim()});e(_t=>[..._t,{id:Re.id,"ICAO Code":Gt,Name:M.trim(),WTC:B.trim().toUpperCase(),"Max Level":$.trim(),"Cruising Speed":re.trim()}].sort((St,Qt)=>St.Name.localeCompare(Qt.Name))),c(""),R(""),K(""),W(""),Me(""),m(null)}catch(Re){m("Failed to add aircraft: "+Re.message)}},Kt=Tt=>{if(!Ce){m("Only Supervisors can edit aircrafts.");return}ut(Tt.id),Fe(Tt["ICAO Code"]),me(Tt.Name),ye(Tt.WTC),Ee(Tt["Max Level"]),ve(Tt["Cruising Speed"])},et=async Tt=>{if(Tt.key!=="Enter")return;const Gt=Ue.trim().toUpperCase();if(Gt.length!==3&&Gt.length!==4){m("ICAO Code must be 3 or 4 characters.");return}if(!Ze.trim()){m("Name is required.");return}if(!["L","M","H","J"].includes(se.trim().toUpperCase())){m("WTC must be L, M, H, or J.");return}if(!we.trim()){m("Max Level is required.");return}if(!ke.trim()){m("Cruising Speed is required.");return}try{const Re=vu(La,"Aircrafts",He);await Fw(Re,{"ICAO Code":Gt,Name:Ze.trim(),WTC:se.trim().toUpperCase(),"Max Level":we.trim(),"Cruising Speed":ke.trim()}),e(_t=>_t.map(St=>St.id===He?{...St,"ICAO Code":Gt,Name:Ze.trim(),WTC:se.trim().toUpperCase(),"Max Level":we.trim(),"Cruising Speed":ke.trim()}:St).sort((St,Qt)=>St.Name.localeCompare(Qt.Name))),ut(null),Fe(""),me(""),ye(""),Ee(""),ve(""),m(null)}catch(Re){m("Failed to update aircraft: "+Re.message)}},Mt=async Tt=>{if(!Ce){m("Only Supervisors can delete aircrafts.");return}try{await Vw(vu(La,"Aircrafts",Tt)),e(Gt=>Gt.filter(Re=>Re.id!==Tt)),m(null)}catch(Gt){m("Failed to delete aircraft: "+Gt.message)}};return t?de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Aircrafts"}),de.jsx("p",{children:"Loading..."})]}):d?de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Aircrafts"}),de.jsx("p",{className:"text-red-600",children:d})]}):de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Aircrafts"}),de.jsx("div",{className:"overflow-x-auto",children:de.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[de.jsx("thead",{children:de.jsxs("tr",{className:"bg-blue-100",children:[de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"ID"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"ICAO Code"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Name"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"WTC"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Max Level"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Cruising Speed"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Actions"})]})}),de.jsxs("tbody",{children:[r.map((Tt,Gt)=>de.jsxs("tr",{className:"hover:bg-gray-50",children:[de.jsx("td",{className:"py-2 px-3 border-b",children:Gt+1}),de.jsx("td",{className:"py-2 px-3 border-b",children:He===Tt.id?de.jsx("input",{type:"text",value:Ue,onChange:Re=>Fe(Re.target.value),onKeyDown:et,maxLength:4,className:"w-full p-2 border rounded"}):Tt["ICAO Code"]}),de.jsx("td",{className:"py-2 px-3 border-b",children:He===Tt.id?de.jsx("input",{type:"text",value:Ze,onChange:Re=>me(Re.target.value),onKeyDown:et,className:"w-full p-2 border rounded"}):Tt.Name}),de.jsx("td",{className:"py-2 px-3 border-b",children:He===Tt.id?de.jsxs("select",{value:se,onChange:Re=>ye(Re.target.value),onKeyDown:et,className:"w-full p-2 border rounded",children:[de.jsx("option",{value:"",disabled:!0,children:"Select WTC"}),de.jsx("option",{value:"L",children:"L"}),de.jsx("option",{value:"M",children:"M"}),de.jsx("option",{value:"H",children:"H"}),de.jsx("option",{value:"J",children:"J"})]}):Tt.WTC}),de.jsx("td",{className:"py-2 px-3 border-b",children:He===Tt.id?de.jsx("input",{type:"text",value:we,onChange:Re=>Ee(Re.target.value),onKeyDown:et,className:"w-full p-2 border rounded"}):Tt["Max Level"]}),de.jsx("td",{className:"py-2 px-3 border-b",children:He===Tt.id?de.jsx("input",{type:"text",value:ke,onChange:Re=>ve(Re.target.value),onKeyDown:et,className:"w-full p-2 border rounded"}):Tt["Cruising Speed"]}),de.jsx("td",{className:"py-2 px-3 border-b flex space-x-2",children:Ce&&de.jsxs(de.Fragment,{children:[de.jsx("button",{onClick:()=>Kt(Tt),title:"Edit",className:"text-yellow-500 hover:text-yellow-700 mr-2",disabled:He!==null,children:de.jsx(fh,{icon:E2})}),de.jsx("button",{onClick:()=>Mt(Tt.id),title:"Delete",className:"text-red-500 hover:text-red-700",disabled:He!==null,children:de.jsx(fh,{icon:A2})})]})})]},Tt.id)),de.jsxs("tr",{children:[de.jsx("td",{className:"py-2 px-3 border-b",children:r.length+1}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:y,onChange:Tt=>c(Tt.target.value),onKeyDown:Bt,placeholder:"Enter ICAO Code",maxLength:4,className:"w-full p-2 border rounded",disabled:!Ce||He!==null})}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:M,onChange:Tt=>R(Tt.target.value),onKeyDown:Bt,placeholder:"Enter Name",className:"w-full p-2 border rounded",disabled:!Ce||He!==null})}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsxs("select",{value:B,onChange:Tt=>K(Tt.target.value),onKeyDown:Bt,className:"w-full p-2 border rounded",disabled:!Ce||He!==null,children:[de.jsx("option",{value:"",disabled:!0,children:"Select WTC"}),de.jsx("option",{value:"L",children:"L"}),de.jsx("option",{value:"M",children:"M"}),de.jsx("option",{value:"H",children:"H"}),de.jsx("option",{value:"J",children:"J"})]})}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:$,onChange:Tt=>W(Tt.target.value),onKeyDown:Bt,placeholder:"Enter Max Level",className:"w-full p-2 border rounded",disabled:!Ce||He!==null})}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:re,onChange:Tt=>Me(Tt.target.value),onKeyDown:Bt,placeholder:"Enter Cruising Speed",className:"w-full p-2 border rounded",disabled:!Ce||He!==null})}),de.jsx("td",{className:"py-2 px-3 border-b"})]})]})]})}),d&&de.jsx("p",{className:"mt-4 text-red-600",children:d})]})}function wj(){const[r,e]=We.useState([]),[t,a]=We.useState(!0),[d,m]=We.useState(null),[y,c]=We.useState(""),[M,R]=We.useState(""),[B,K]=We.useState(""),[$,W]=We.useState(""),[re,Me]=We.useState(!1),[Ce,Be]=We.useState(null),[He,ut]=We.useState(""),[Ue,Fe]=We.useState(""),[Ze,me]=We.useState(""),[se,ye]=We.useState("");We.useEffect(()=>{(async()=>{try{const Kt=Hh.currentUser;if(Kt){const Gt=await ob(vu(La,"users",Kt.uid));Gt.exists()&&Me(Gt.data().role==="Supervisor")}const et=Lw(ad(La,"Airports"),Bw("Airport","asc")),Tt=(await Tg(et)).docs.map(Gt=>({id:Gt.id,...Gt.data()}));e(Tt),a(!1)}catch(Kt){m("Failed to fetch data: "+Kt.message),a(!1)}})()},[]);const we=async Bt=>{if(Bt.key!=="Enter")return;const Kt=y.trim().toUpperCase();if(Kt.length!==4){m("ICAO Code must be exactly 4 characters.");return}if(!M.trim()){m("Airport name is required.");return}if(!B.trim()||isNaN(parseFloat(B))){m("Valid latitude is required.");return}if(!$.trim()||isNaN(parseFloat($))){m("Valid longitude is required.");return}if(!re){m("Only Supervisors can add airports.");return}try{const et=await jw(ad(La,"Airports"),{"ICAO Code":Kt,Airport:M.trim(),Lat:parseFloat(B),Long:parseFloat($)});e(Mt=>[...Mt,{id:et.id,"ICAO Code":Kt,Airport:M.trim(),Lat:parseFloat(B),Long:parseFloat($)}].sort((Gt,Re)=>Gt.Airport.localeCompare(Re.Airport))),c(""),R(""),K(""),W(""),m(null)}catch(et){m("Failed to add airport: "+et.message)}},Ee=Bt=>{if(!re){m("Only Supervisors can edit airports.");return}Be(Bt.id),ut(Bt["ICAO Code"]),Fe(Bt.Airport),me(Bt.Lat.toString()),ye(Bt.Long.toString())},ke=async Bt=>{if(Bt.key!=="Enter")return;const Kt=He.trim().toUpperCase();if(Kt.length!==4){m("ICAO Code must be exactly 4 characters.");return}if(!Ue.trim()){m("Airport name is required.");return}if(!Ze.trim()||isNaN(parseFloat(Ze))){m("Valid latitude is required.");return}if(!se.trim()||isNaN(parseFloat(se))){m("Valid longitude is required.");return}try{const et=vu(La,"Airports",Ce);await Fw(et,{"ICAO Code":Kt,Airport:Ue.trim(),Lat:parseFloat(Ze),Long:parseFloat(se)}),e(Mt=>Mt.map(Gt=>Gt.id===Ce?{...Gt,"ICAO Code":Kt,Airport:Ue.trim(),Lat:parseFloat(Ze),Long:parseFloat(se)}:Gt).sort((Gt,Re)=>Gt.Airport.localeCompare(Re.Airport))),Be(null),ut(""),Fe(""),me(""),ye(""),m(null)}catch(et){m("Failed to update airport: "+et.message)}},ve=async Bt=>{if(!re){m("Only Supervisors can delete airports.");return}try{await Vw(vu(La,"Airports",Bt)),e(Kt=>Kt.filter(et=>et.id!==Bt)),m(null)}catch(Kt){m("Failed to delete airport: "+Kt.message)}};return t?de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Airports"}),de.jsx("p",{children:"Loading..."})]}):d?de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Airports"}),de.jsx("p",{className:"text-red-600",children:d})]}):de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Airports"}),de.jsx("div",{className:"overflow-x-auto",children:de.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[de.jsx("thead",{children:de.jsxs("tr",{className:"bg-blue-100",children:[de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"ID"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"ICAO Code"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Airport"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Latitude"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Longitude"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Actions"})]})}),de.jsxs("tbody",{children:[r.map((Bt,Kt)=>de.jsxs("tr",{className:"hover:bg-gray-50",children:[de.jsx("td",{className:"py-2 px-3 border-b",children:Kt+1}),de.jsx("td",{className:"py-2 px-3 border-b",children:Ce===Bt.id?de.jsx("input",{type:"text",value:He,onChange:et=>ut(et.target.value),onKeyDown:ke,maxLength:4,className:"w-full p-2 border rounded"}):Bt["ICAO Code"]}),de.jsx("td",{className:"py-2 px-3 border-b",children:Ce===Bt.id?de.jsx("input",{type:"text",value:Ue,onChange:et=>Fe(et.target.value),onKeyDown:ke,className:"w-full p-2 border rounded"}):Bt.Airport}),de.jsx("td",{className:"py-2 px-3 border-b",children:Ce===Bt.id?de.jsx("input",{type:"text",value:Ze,onChange:et=>me(et.target.value),onKeyDown:ke,className:"w-full p-2 border rounded"}):Bt.Lat}),de.jsx("td",{className:"py-2 px-3 border-b",children:Ce===Bt.id?de.jsx("input",{type:"text",value:se,onChange:et=>ye(et.target.value),onKeyDown:ke,className:"w-full p-2 border rounded"}):Bt.Long}),de.jsx("td",{className:"py-2 px-3 border-b flex space-x-2",children:re&&de.jsxs(de.Fragment,{children:[de.jsx("button",{onClick:()=>Ee(Bt),title:"Edit",className:"text-yellow-500 hover:text-yellow-700 mr-2",disabled:Ce!==null,children:de.jsx(fh,{icon:E2})}),de.jsx("button",{onClick:()=>ve(Bt.id),title:"Delete",className:"text-red-500 hover:text-red-700",disabled:Ce!==null,children:de.jsx(fh,{icon:A2})})]})})]},Bt.id)),de.jsxs("tr",{children:[de.jsx("td",{className:"py-2 px-3 border-b",children:r.length+1}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:y,onChange:Bt=>c(Bt.target.value),onKeyDown:we,placeholder:"Enter ICAO Code",maxLength:4,className:"w-full p-2 border rounded",disabled:!re||Ce!==null})}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:M,onChange:Bt=>R(Bt.target.value),onKeyDown:we,placeholder:"Enter Airport Name",className:"w-full p-2 border rounded",disabled:!re||Ce!==null})}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:B,onChange:Bt=>K(Bt.target.value),onKeyDown:we,placeholder:"Enter Latitude",className:"w-full p-2 border rounded",disabled:!re||Ce!==null})}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:$,onChange:Bt=>W(Bt.target.value),onKeyDown:we,placeholder:"Enter Longitude",className:"w-full p-2 border rounded",disabled:!re||Ce!==null})}),de.jsx("td",{className:"py-2 px-3 border-b"})]})]})]})}),d&&de.jsx("p",{className:"mt-4 text-red-600",children:d})]})}function Tj(){const[r,e]=We.useState([]),[t,a]=We.useState(!0),[d,m]=We.useState(null),[y,c]=We.useState(""),[M,R]=We.useState(""),[B,K]=We.useState(!1),[$,W]=We.useState(null),[re,Me]=We.useState(""),[Ce,Be]=We.useState("");We.useEffect(()=>{(async()=>{try{const me=Hh.currentUser;if(me){const Ee=await ob(vu(La,"users",me.uid));Ee.exists()&&K(Ee.data().role==="Supervisor")}const se=Lw(ad(La,"Callsigns"),Bw("Callsign","asc")),we=(await Tg(se)).docs.map(Ee=>({id:Ee.id,...Ee.data()}));e(we),a(!1)}catch(me){m("Failed to fetch data: "+me.message),a(!1)}})()},[]);const He=async Ze=>{if(Ze.key!=="Enter")return;const me=y.trim().toUpperCase();if(me.length!==3){m("ICAO Code must be exactly 3 characters.");return}if(!M.trim()){m("Callsign is required.");return}if(!B){m("Only Supervisors can add callsigns.");return}try{const se=await jw(ad(La,"Callsigns"),{"ICAO Code":me,Callsign:M.trim()});e(ye=>[...ye,{id:se.id,"ICAO Code":me,Callsign:M.trim()}].sort((Ee,ke)=>Ee.Callsign.localeCompare(ke.Callsign))),c(""),R(""),m(null)}catch(se){m("Failed to add callsign: "+se.message)}},ut=Ze=>{if(!B){m("Only Supervisors can edit callsigns.");return}W(Ze.id),Me(Ze["ICAO Code"]),Be(Ze.Callsign)},Ue=async Ze=>{if(Ze.key!=="Enter")return;const me=re.trim().toUpperCase();if(me.length!==3){m("ICAO Code must be exactly 3 characters.");return}if(!Ce.trim()){m("Callsign is required.");return}try{const se=vu(La,"Callsigns",$);await Fw(se,{"ICAO Code":me,Callsign:Ce.trim()}),e(ye=>ye.map(Ee=>Ee.id===$?{...Ee,"ICAO Code":me,Callsign:Ce.trim()}:Ee).sort((Ee,ke)=>Ee.Callsign.localeCompare(ke.Callsign))),W(null),Me(""),Be(""),m(null)}catch(se){m("Failed to update callsign: "+se.message)}},Fe=async Ze=>{if(!B){m("Only Supervisors can delete callsigns.");return}try{await Vw(vu(La,"Callsigns",Ze)),e(me=>me.filter(se=>se.id!==Ze)),m(null)}catch(me){m("Failed to delete callsign: "+me.message)}};return t?de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Callsigns"}),de.jsx("p",{children:"Loading..."})]}):d?de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Callsigns"}),de.jsx("p",{className:"text-red-600",children:d})]}):de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Callsigns"}),de.jsx("div",{className:"overflow-x-auto",children:de.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[de.jsx("thead",{children:de.jsxs("tr",{className:"bg-blue-100",children:[de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"ID"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"ICAO Code"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Callsign"}),de.jsx("th",{className:"py-2 px-3 border-b text-left",children:"Actions"})]})}),de.jsxs("tbody",{children:[r.map((Ze,me)=>de.jsxs("tr",{className:"hover:bg-gray-50",children:[de.jsx("td",{className:"py-2 px-3 border-b",children:me+1}),de.jsx("td",{className:"py-2 px-3 border-b",children:$===Ze.id?de.jsx("input",{type:"text",value:re,onChange:se=>Me(se.target.value),onKeyDown:Ue,maxLength:3,className:"w-full p-2 border rounded"}):Ze["ICAO Code"]}),de.jsx("td",{className:"py-2 px-3 border-b",children:$===Ze.id?de.jsx("input",{type:"text",value:Ce,onChange:se=>Be(se.target.value),onKeyDown:Ue,className:"w-full p-2 border rounded"}):Ze.Callsign}),de.jsx("td",{className:"py-2 px-3 border-b flex space-x-2",children:B&&de.jsxs(de.Fragment,{children:[de.jsx("button",{onClick:()=>ut(Ze),title:"Edit",className:"text-yellow-500 hover:text-yellow-700 mr-2",disabled:$!==null,children:de.jsx(fh,{icon:E2})}),de.jsx("button",{onClick:()=>Fe(Ze.id),title:"Delete",className:"text-red-500 hover:text-red-700",disabled:$!==null,children:de.jsx(fh,{icon:A2})})]})})]},Ze.id)),de.jsxs("tr",{children:[de.jsx("td",{className:"py-2 px-3 border-b",children:r.length+1}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:y,onChange:Ze=>c(Ze.target.value),onKeyDown:He,placeholder:"Enter ICAO Code",maxLength:3,className:"w-full p-2 border rounded",disabled:!B||$!==null})}),de.jsx("td",{className:"py-2 px-3 border-b",children:de.jsx("input",{type:"text",value:M,onChange:Ze=>R(Ze.target.value),onKeyDown:He,placeholder:"Enter Callsign",className:"w-full p-2 border rounded",disabled:!B||$!==null})}),de.jsx("td",{className:"py-2 px-3 border-b"})]})]})]})}),d&&de.jsx("p",{className:"mt-4 text-red-600",children:d})]})}function Sj(){return de.jsx("div",{className:"container mx-auto p-4",children:de.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard Constraints"})})}function Ej(){return de.jsx("div",{className:"container mx-auto p-4",children:de.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard External Points"})})}function Aj(){return de.jsx("div",{className:"container mx-auto p-4",children:de.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard Internal Points"})})}function Cj(){const[r,e]=We.useState(""),[t,a]=We.useState(""),d=async m=>{m.preventDefault();try{await FA(Hh,r,t),alert("Successfully logged in!")}catch(y){alert(y.message)}};return de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Login"}),de.jsxs("form",{onSubmit:d,className:"flex flex-col gap-4 max-w-sm",children:[de.jsx("input",{type:"email",value:r,onChange:m=>e(m.target.value),placeholder:"Email",className:"p-2 border rounded"}),de.jsx("input",{type:"password",value:t,onChange:m=>a(m.target.value),placeholder:"Password",className:"p-2 border rounded"}),de.jsx("button",{type:"submit",className:"p-2 bg-blue-500 text-white rounded",children:"Login"})]})]})}function Ij(){return de.jsx("div",{className:"min-h-screen bg-gray-100",children:de.jsxs(IR,{children:[de.jsx(eo,{path:"/login",element:de.jsx(Cj,{})}),de.jsx(eo,{path:"/",element:de.jsxs("div",{className:"container mx-auto p-4",children:[de.jsx("h1",{className:"text-3xl font-bold text-center mb-8 text-blue-600",children:"ATCO Training"}),de.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[de.jsx(Mo,{to:"/Airports",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:de.jsx("h2",{className:"text-xl font-semibold text-center",children:"Airports"})}),de.jsx(Mo,{to:"/aircrafts",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:de.jsx("h2",{className:"text-xl font-semibold text-center",children:"Aircrafts"})}),de.jsx(Mo,{to:"/callsigns",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:de.jsx("h2",{className:"text-xl font-semibold text-center",children:"Callsigns"})}),de.jsx(Mo,{to:"/constraints",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:de.jsx("h2",{className:"text-xl font-semibold text-center",children:"Constraints"})}),de.jsx(Mo,{to:"/ext_points",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:de.jsx("h2",{className:"text-xl font-semibold text-center",children:"External Points"})}),de.jsx(Mo,{to:"/int_points",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:de.jsx("h2",{className:"text-xl font-semibold text-center",children:"Internal Points"})}),de.jsx(Mo,{to:"/dashboard",className:"p-6 bg-white rounded-lg shadow hover:bg-gray-50",children:de.jsx("h2",{className:"text-xl font-semibold text-center",children:"Dashboard"})})]})]})}),de.jsx(eo,{path:"/Airports",element:de.jsx(WB,{})}),de.jsx(eo,{path:"/aircrafts",element:de.jsx(mj,{})}),de.jsx(eo,{path:"/callsigns",element:de.jsx(gj,{})}),de.jsx(eo,{path:"/constraints",element:de.jsx(yj,{})}),de.jsx(eo,{path:"/ext_points",element:de.jsx(_j,{})}),de.jsx(eo,{path:"/int_points",element:de.jsx(vj,{})}),de.jsx(eo,{path:"/dashboard",element:de.jsx(bj,{})}),de.jsx(eo,{path:"/dashboard/aircrafts",element:de.jsx(xj,{})}),de.jsx(eo,{path:"/dashboard/Airports",element:de.jsx(wj,{})}),de.jsx(eo,{path:"/dashboard/callsigns",element:de.jsx(Tj,{})}),de.jsx(eo,{path:"/dashboard/constraints",element:de.jsx(Sj,{})}),de.jsx(eo,{path:"/dashboard/ext_points",element:de.jsx(Ej,{})}),de.jsx(eo,{path:"/dashboard/int_points",element:de.jsx(Aj,{})})]})})}OP.createRoot(document.getElementById("root")).render(de.jsx(O1.StrictMode,{children:de.jsx(QR,{children:de.jsx(Ij,{})})}));
